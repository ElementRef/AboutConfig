// Wed Sep 24 2025 10:48:01 GMT+0000 (Coordinated Universal Time) https://raw.githubusercontent.com/ElementRef/AboutConfig/main/script/bili.universe.adblock.request.js
(()=>{var J={21:function(D,C,l){var A;D.exports=A||(function(E,O){if(typeof window<"u"&&window.crypto&&(b=window.crypto),typeof self<"u"&&self.crypto&&(b=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(b=globalThis.crypto),!b&&typeof window<"u"&&window.msCrypto&&(b=window.msCrypto),!b&&l.g!==void 0&&l.g.crypto&&(b=l.g.crypto),!b)try{b=l(656)}catch{}var b,T=function(){if(b){if(typeof b.getRandomValues=="function")try{return b.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof b.randomBytes=="function")try{return b.randomBytes(4).readInt32LE()}catch{}}throw Error("Native crypto module could not be used to get secure random number.")},j=Object.create||(function(){function t(){}return function(f){var h;return t.prototype=f,h=new t,t.prototype=null,h}})(),c={},v=c.lib={},B=v.Base={extend:function(t){var f=j(this);return t&&f.mixIn(t),f.hasOwnProperty("init")&&this.init!==f.init||(f.init=function(){f.$super.init.apply(this,arguments)}),f.init.prototype=f,f.$super=this,f},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var f in t)t.hasOwnProperty(f)&&(this[f]=t[f]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},$=v.WordArray=B.extend({init:function(t,f){t=this.words=t||[],O!=f?this.sigBytes=f:this.sigBytes=4*t.length},toString:function(t){return(t||e).stringify(this)},concat:function(t){var f=this.words,h=t.words,p=this.sigBytes,y=t.sigBytes;if(this.clamp(),p%4)for(var m=0;m<y;m++){var x=h[m>>>2]>>>24-m%4*8&255;f[p+m>>>2]|=x<<24-(p+m)%4*8}else for(var k=0;k<y;k+=4)f[p+k>>>2]=h[k>>>2];return this.sigBytes+=y,this},clamp:function(){var t=this.words,f=this.sigBytes;t[f>>>2]&=4294967295<<32-f%4*8,t.length=E.ceil(f/4)},clone:function(){var t=B.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var f=[],h=0;h<t;h+=4)f.push(T());return new $.init(f,t)}}),u=c.enc={},e=u.Hex={stringify:function(t){for(var f=t.words,h=t.sigBytes,p=[],y=0;y<h;y++){var m=f[y>>>2]>>>24-y%4*8&255;p.push((m>>>4).toString(16)),p.push((15&m).toString(16))}return p.join("")},parse:function(t){for(var f=t.length,h=[],p=0;p<f;p+=2)h[p>>>3]|=parseInt(t.substr(p,2),16)<<24-p%8*4;return new $.init(h,f/2)}},s=u.Latin1={stringify:function(t){for(var f=t.words,h=t.sigBytes,p=[],y=0;y<h;y++){var m=f[y>>>2]>>>24-y%4*8&255;p.push(String.fromCharCode(m))}return p.join("")},parse:function(t){for(var f=t.length,h=[],p=0;p<f;p++)h[p>>>2]|=(255&t.charCodeAt(p))<<24-p%4*8;return new $.init(h,f)}},r=u.Utf8={stringify:function(t){try{return decodeURIComponent(escape(s.stringify(t)))}catch{throw Error("Malformed UTF-8 data")}},parse:function(t){return s.parse(unescape(encodeURIComponent(t)))}},d=v.BufferedBlockAlgorithm=B.extend({reset:function(){this._data=new $.init,this._nDataBytes=0},_append:function(t){typeof t=="string"&&(t=r.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var f,h=this._data,p=h.words,y=h.sigBytes,m=this.blockSize,x=y/(4*m),k=(x=t?E.ceil(x):E.max((0|x)-this._minBufferSize,0))*m,S=E.min(4*k,y);if(k){for(var w=0;w<k;w+=m)this._doProcessBlock(p,w);f=p.splice(0,k),h.sigBytes-=S}return new $.init(f,S)},clone:function(){var t=B.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});v.Hasher=d.extend({cfg:B.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(f,h){return new t.init(h).finalize(f)}},_createHmacHelper:function(t){return function(f,h){return new g.HMAC.init(t,h).finalize(f)}}});var g=c.algo={};return c})(Math)},636:function(D,C,l){var A;A=l(21),(function(E){for(var O=A.lib,b=O.WordArray,T=O.Hasher,j=A.algo,c=[],v=0;v<64;v++)c[v]=4294967296*E.abs(E.sin(v+1))|0;var B=j.MD5=T.extend({_doReset:function(){this._hash=new b.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(r,d){for(var g=0;g<16;g++){var t=d+g,f=r[t];r[t]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360}var h=this._hash.words,p=r[d+0],y=r[d+1],m=r[d+2],x=r[d+3],k=r[d+4],S=r[d+5],w=r[d+6],N=r[d+7],R=r[d+8],P=r[d+9],L=r[d+10],F=r[d+11],q=r[d+12],I=r[d+13],M=r[d+14],H=r[d+15],a=h[0],n=h[1],i=h[2],o=h[3];a=$(a,n,i,o,p,7,c[0]),o=$(o,a,n,i,y,12,c[1]),i=$(i,o,a,n,m,17,c[2]),n=$(n,i,o,a,x,22,c[3]),a=$(a,n,i,o,k,7,c[4]),o=$(o,a,n,i,S,12,c[5]),i=$(i,o,a,n,w,17,c[6]),n=$(n,i,o,a,N,22,c[7]),a=$(a,n,i,o,R,7,c[8]),o=$(o,a,n,i,P,12,c[9]),i=$(i,o,a,n,L,17,c[10]),n=$(n,i,o,a,F,22,c[11]),a=$(a,n,i,o,q,7,c[12]),o=$(o,a,n,i,I,12,c[13]),i=$(i,o,a,n,M,17,c[14]),n=$(n,i,o,a,H,22,c[15]),a=u(a,n,i,o,y,5,c[16]),o=u(o,a,n,i,w,9,c[17]),i=u(i,o,a,n,F,14,c[18]),n=u(n,i,o,a,p,20,c[19]),a=u(a,n,i,o,S,5,c[20]),o=u(o,a,n,i,L,9,c[21]),i=u(i,o,a,n,H,14,c[22]),n=u(n,i,o,a,k,20,c[23]),a=u(a,n,i,o,P,5,c[24]),o=u(o,a,n,i,M,9,c[25]),i=u(i,o,a,n,x,14,c[26]),n=u(n,i,o,a,R,20,c[27]),a=u(a,n,i,o,I,5,c[28]),o=u(o,a,n,i,m,9,c[29]),i=u(i,o,a,n,N,14,c[30]),n=u(n,i,o,a,q,20,c[31]),a=e(a,n,i,o,S,4,c[32]),o=e(o,a,n,i,R,11,c[33]),i=e(i,o,a,n,F,16,c[34]),n=e(n,i,o,a,M,23,c[35]),a=e(a,n,i,o,y,4,c[36]),o=e(o,a,n,i,k,11,c[37]),i=e(i,o,a,n,N,16,c[38]),n=e(n,i,o,a,L,23,c[39]),a=e(a,n,i,o,I,4,c[40]),o=e(o,a,n,i,p,11,c[41]),i=e(i,o,a,n,x,16,c[42]),n=e(n,i,o,a,w,23,c[43]),a=e(a,n,i,o,P,4,c[44]),o=e(o,a,n,i,q,11,c[45]),i=e(i,o,a,n,H,16,c[46]),n=e(n,i,o,a,m,23,c[47]),a=s(a,n,i,o,p,6,c[48]),o=s(o,a,n,i,N,10,c[49]),i=s(i,o,a,n,M,15,c[50]),n=s(n,i,o,a,S,21,c[51]),a=s(a,n,i,o,q,6,c[52]),o=s(o,a,n,i,x,10,c[53]),i=s(i,o,a,n,L,15,c[54]),n=s(n,i,o,a,y,21,c[55]),a=s(a,n,i,o,R,6,c[56]),o=s(o,a,n,i,H,10,c[57]),i=s(i,o,a,n,w,15,c[58]),n=s(n,i,o,a,I,21,c[59]),a=s(a,n,i,o,k,6,c[60]),o=s(o,a,n,i,F,10,c[61]),i=s(i,o,a,n,m,15,c[62]),n=s(n,i,o,a,P,21,c[63]),h[0]=h[0]+a|0,h[1]=h[1]+n|0,h[2]=h[2]+i|0,h[3]=h[3]+o|0},_doFinalize:function(){var r=this._data,d=r.words,g=8*this._nDataBytes,t=8*r.sigBytes;d[t>>>5]|=128<<24-t%32;var f=E.floor(g/4294967296);d[(t+64>>>9<<4)+15]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360,d[(t+64>>>9<<4)+14]=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,r.sigBytes=(d.length+1)*4,this._process();for(var h=this._hash,p=h.words,y=0;y<4;y++){var m=p[y];p[y]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360}return h},clone:function(){var r=T.clone.call(this);return r._hash=this._hash.clone(),r}});function $(r,d,g,t,f,h,p){var y=r+(d&g|~d&t)+f+p;return(y<<h|y>>>32-h)+d}function u(r,d,g,t,f,h,p){var y=r+(d&t|g&~t)+f+p;return(y<<h|y>>>32-h)+d}function e(r,d,g,t,f,h,p){var y=r+(d^g^t)+f+p;return(y<<h|y>>>32-h)+d}function s(r,d,g,t,f,h,p){var y=r+(g^(d|~t))+f+p;return(y<<h|y>>>32-h)+d}A.MD5=T._createHelper(B),A.HmacMD5=T._createHmacHelper(B)})(Math),D.exports=A.MD5},656:function(){}},V={};function U(D){var C=V[D];if(C!==void 0)return C.exports;var l=V[D]={exports:{}};return J[D].call(l.exports,l,l.exports,U),l.exports}U.g=(()=>{if(typeof globalThis=="object")return globalThis;try{return this||Function("return this")()}catch{if(typeof window=="object")return window}})(),(()=>{"use strict";let D,C=(()=>{let u=Object.keys(globalThis);switch(!0){case u.includes("$task"):return"Quantumult X";case u.includes("$loon"):return"Loon";case u.includes("$rocket"):return"Shadowrocket";case typeof module<"u":return"Node.js";case u.includes("Egern"):return"Egern";case u.includes("$environment"):return $environment["surge-version"]?"Surge":$environment["stash-version"]?"Stash":void 0;default:return}})();class l{static#e=new Map([]);static#s=[];static#r=new Map([]);static clear=()=>{};static count=(e="default")=>{switch(l.#e.has(e)){case!0:l.#e.set(e,l.#e.get(e)+1);break;case!1:l.#e.set(e,0)}l.log(`${e}: ${l.#e.get(e)}`)};static countReset=(e="default")=>{switch(l.#e.has(e)){case!0:l.#e.set(e,0),l.log(`${e}: ${l.#e.get(e)}`);break;case!1:l.warn(`Counter "${e}" doesn\u2019t exist`)}};static debug=(...e)=>{l.#t<4||(e=e.map(s=>`\u{1F171}\uFE0F ${s}`),l.log(...e))};static error(...e){if(!(l.#t<1)){switch(C){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":case"Quantumult X":default:e=e.map(s=>`\u274C ${s}`);break;case"Node.js":e=e.map(s=>`\u274C ${s.stack}`)}l.log(...e)}}static exception=(...e)=>l.error(...e);static group=e=>l.#s.unshift(e);static groupEnd=()=>l.#s.shift();static info(...e){l.#t<3||(e=e.map(s=>`\u2139\uFE0F ${s}`),l.log(...e))}static#t=3;static get logLevel(){switch(l.#t){case 0:return"OFF";case 1:return"ERROR";case 2:return"WARN";case 3:default:return"INFO";case 4:return"DEBUG";case 5:return"ALL"}}static set logLevel(e){switch(typeof e){case"string":e=e.toLowerCase();break;case"number":break;default:e="warn"}switch(e){case 0:case"off":l.#t=0;break;case 1:case"error":l.#t=1;break;case 2:case"warn":case"warning":default:l.#t=2;break;case 3:case"info":l.#t=3;break;case 4:case"debug":l.#t=4;break;case 5:case"all":l.#t=5}}static log=(...e)=>{l.#t!==0&&(e=e.map(s=>{switch(typeof s){case"object":s=JSON.stringify(s);break;case"bigint":case"number":case"boolean":case"string":s=s.toString()}return s}),l.#s.forEach(s=>{(e=e.map(r=>`  ${r}`)).unshift(`\u25BC ${s}:`)}))};static time=(e="default")=>l.#r.set(e,Date.now());static timeEnd=(e="default")=>l.#r.delete(e);static timeLog=(e="default")=>{let s=l.#r.get(e);s?l.log(`${e}: ${Date.now()-s}ms`):l.warn(`Timer "${e}" doesn\u2019t exist`)};static warn(...e){l.#t<2||(e=e.map(s=>`\u26A0\uFE0F ${s}`),l.log(...e))}}class A{static escape(e){let s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return e.replace(/[&<>"']/g,r=>s[r])}static get(e={},s="",r){Array.isArray(s)||(s=A.toPath(s));let d=s.reduce((g,t)=>Object(g)[t],e);return d===void 0?r:d}static omit(e={},s=[]){return Array.isArray(s)||(s=[s.toString()]),s.forEach(r=>A.unset(e,r)),e}static pick(e={},s=[]){return Array.isArray(s)||(s=[s.toString()]),Object.fromEntries(Object.entries(e).filter(([r,d])=>s.includes(r)))}static set(e,s,r){return Array.isArray(s)||(s=A.toPath(s)),s.slice(0,-1).reduce((d,g,t)=>Object(d[g])===d[g]?d[g]:d[g]=/^\d+$/.test(s[t+1])?[]:{},e)[s[s.length-1]]=r,e}static toPath(e){return e.replace(/\[(\d+)\]/g,".$1").split(".").filter(Boolean)}static unescape(e){let s={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};return e.replace(/&amp;|&lt;|&gt;|&quot;|&#39;/g,r=>s[r])}static unset(e={},s=""){return Array.isArray(s)||(s=A.toPath(s)),s.reduce((r,d,g)=>g===s.length-1?(delete r[d],!0):Object(r)[d],e)}}let E={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",304:"Not Modified",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Content Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"};function O(u={}){switch(C){case"Surge":u.policy&&A.set(u,"headers.X-Surge-Policy",u.policy),l.log("\u{1F6A9} \u6267\u884C\u7ED3\u675F!",`\u{1F55B} ${new Date().getTime()/1e3-$script.startTime} \u79D2`),$done(u);break;case"Loon":u.policy&&(u.node=u.policy),l.log("\u{1F6A9} \u6267\u884C\u7ED3\u675F!",`\u{1F55B} ${(new Date-$script.startTime)/1e3} \u79D2`),$done(u);break;case"Stash":u.policy&&A.set(u,"headers.X-Stash-Selected-Proxy",encodeURI(u.policy)),l.log("\u{1F6A9} \u6267\u884C\u7ED3\u675F!",`\u{1F55B} ${(new Date-$script.startTime)/1e3} \u79D2`),$done(u);break;case"Egern":case"Shadowrocket":l.log("\u{1F6A9} \u6267\u884C\u7ED3\u675F!"),$done(u);break;case"Quantumult X":switch(u.policy&&A.set(u,"opts.policy",u.policy),typeof(u=A.pick(u,["status","url","headers","body","bodyBytes"])).status){case"number":u.status=`HTTP/1.1 ${u.status} ${E[u.status]}`;break;case"string":case"undefined":break;default:throw TypeError(`${Function.name}: \u53C2\u6570\u7C7B\u578B\u9519\u8BEF, status \u5FC5\u987B\u4E3A\u6570\u5B57\u6216\u5B57\u7B26\u4E32`)}u.body instanceof ArrayBuffer?(u.bodyBytes=u.body,u.body=void 0):ArrayBuffer.isView(u.body)?(u.bodyBytes=u.body.buffer.slice(u.body.byteOffset,u.body.byteLength+u.body.byteOffset),u.body=void 0):u.body&&(u.bodyBytes=void 0),l.log("\u{1F6A9} \u6267\u884C\u7ED3\u675F!"),$done(u);break;default:l.log("\u{1F6A9} \u6267\u884C\u7ED3\u675F!"),process.exit(1)}}class b{static data=null;static dataFile="box.dat";static#e=/^@(?<key>[^.]+)(?:\.(?<path>.*))?$/;static getItem(e,s=null){let r=s;if(e.startsWith("@")===!0){let{key:d,path:g}=e.match(b.#e)?.groups;e=d;let t=b.getItem(e,{});typeof t!="object"&&(t={}),r=A.get(t,g);try{r=JSON.parse(r)}catch{}}else{switch(C){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":r=$persistentStore.read(e);break;case"Quantumult X":r=$prefs.valueForKey(e);break;case"Node.js":b.data=b.#s(b.dataFile),r=b.data?.[e];break;default:r=b.data?.[e]||null}try{r=JSON.parse(r)}catch{}}return r??s}static setItem(e=new String,s=new String){let r=!1;if(s=typeof s=="object"?JSON.stringify(s):String(s),e.startsWith("@")===!0){let{key:d,path:g}=e.match(b.#e)?.groups;e=d;let t=b.getItem(e,{});typeof t!="object"&&(t={}),A.set(t,g,s),r=b.setItem(e,t)}else switch(C){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":r=$persistentStore.write(s,e);break;case"Quantumult X":r=$prefs.setValueForKey(s,e);break;case"Node.js":b.data=b.#s(b.dataFile),b.data[e]=s,b.#r(b.dataFile),r=!0;break;default:r=b.data?.[e]||null}return r}static removeItem(e){let s=!1;if(e.startsWith("@")===!0){let{key:r,path:d}=e.match(b.#e)?.groups;e=r;let g=b.getItem(e);typeof g!="object"&&(g={}),keyValue=A.unset(g,d),s=b.setItem(e,g)}else switch(C){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":case"Node.js":default:s=!1;break;case"Quantumult X":s=$prefs.removeValueForKey(e)}return s}static clear(){let e=!1;switch(C){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":case"Node.js":default:e=!1;break;case"Quantumult X":e=$prefs.removeAllValues()}return e}static#s=e=>{if(C!=="Node.js")return{};{this.fs=this.fs?this.fs:require("node:fs"),this.path=this.path?this.path:require("node:path");let s=this.path.resolve(e),r=this.path.resolve(process.cwd(),e),d=this.fs.existsSync(s),g=!d&&this.fs.existsSync(r);if(!d&&!g)return{};try{return JSON.parse(this.fs.readFileSync(d?s:r))}catch{return{}}}};static#r=(e=this.dataFile)=>{if(C==="Node.js"){this.fs=this.fs?this.fs:require("node:fs"),this.path=this.path?this.path:require("node:path");let s=this.path.resolve(e),r=this.path.resolve(process.cwd(),e),d=this.fs.existsSync(s),g=!d&&this.fs.existsSync(r),t=JSON.stringify(this.data);d?this.fs.writeFileSync(s,t):g?this.fs.writeFileSync(r,t):this.fs.writeFileSync(s,t)}}}function T(u){return/^\d+$/.test(u)&&(u=Number.parseInt(u,10)),u}let j={ADBlock:{Settings:{Splash:!0,Feed:{AD:!0,Activity:!1,Vertical:!1,BlockUpLiveList:"",Story:!0},Search:{AD:!0,HotSearch:!0},PGC:{AD:!0},Xlive:{AD:!0},Dynamic:{HotTopics:!0,MostVisited:!1,AdCard:!0},View:{AD:!0},DM:{Command:!1,Colorful:!1},Reply:{AD:!0}}},Default:{Settings:{LogLevel:"WARN"}}};var c=U(636);let v=new URL($request.url);l.info(`url: ${v.toJSON()}`);let B=v.pathname.split("/").filter(Boolean);l.info(`PATHs: ${B}`);let $=($request.headers?.["Content-Type"]??$request.headers?.["content-type"])?.split(";")?.[0];l.info(`FORMAT: ${$}`),(async()=>{let{Settings:u,Caches:e,Configs:s}=(function(r,d,g){l.log("\u2611\uFE0F Set Environment Variables");let{Settings:t,Caches:f,Configs:h}=(function(p,y,m){y=[y].flat(1/0);let x={Settings:m?.Default?.Settings||{},Configs:m?.Default?.Configs||{},Caches:{}};switch(y.forEach(S=>{x.Settings={...x.Settings,...m?.[S]?.Settings},x.Configs={...x.Configs,...m?.[S]?.Configs}}),typeof $argument){case"string":$argument=Object.fromEntries($argument.split("&").map(S=>S.split("=",2).map(w=>w.replace(/\"/g,""))));case"object":{let S={};Object.keys($argument).forEach(w=>A.set(S,w,$argument[w])),x.Settings={...x.Settings,...S}}}let k=b.getItem(p);return k&&y.forEach(S=>{switch(typeof k?.[S]?.Settings){case"string":k[S].Settings=JSON.parse(k[S].Settings||"{}");case"object":x.Settings={...x.Settings,...k[S].Settings}}switch(typeof k?.[S]?.Caches){case"string":k[S].Caches=JSON.parse(k[S].Caches||"{}");case"object":x.Caches={...x.Caches,...k[S].Caches}}}),(function S(w,N){for(let R in w){let P=w[R];w[R]=typeof P=="object"&&P!==null?S(P,N):N(R,P)}return w})(x.Settings,(S,w)=>(w==="true"||w==="false"?w=JSON.parse(w):typeof w=="string"&&(w=w.includes(",")?w.split(",").map(N=>T(N)):T(w)),w)),x})(r,d,g);return l.info(`typeof Settings: ${typeof t}`,`Settings: ${JSON.stringify(t,null,2)}`),l.log("\u2705 Set Environment Variables"),{Settings:t,Caches:f,Configs:h}})("BiliBili","ADBlock",j);switch(l.logLevel=u.LogLevel,$request.method){case"POST":case"PUT":case"PATCH":case"DELETE":case"GET":case"HEAD":case"OPTIONS":default:switch(v.hostname){case"www.bilibili.com":case"search.bilibili.com":break;case"app.bilibili.com":case"app.biliapi.net":switch(v.pathname){case"/x/v2/splash/show":case"/x/v2/splash/list":case"/x/v2/splash/brand/list":case"/x/v2/splash/event/list2":case"/x/v2/feed/index/story":case"/x/v2/search/square":case"/x/v2/search":case"/x/v2/search/type":break;case"/x/v2/feed/index":switch(u?.Feed?.Activity){case!0:default:if(v.searchParams.has("banner_hash")&&v.searchParams.get("login_event")!=="0"){v.searchParams.delete("sign"),v.searchParams.set("open_event",""),v.searchParams.set("pull",0),e.banner_hash&&(v.searchParams.set("banner_hash",e.banner_hash),l.log("\u2705 \u8BFB\u53D6hash\u7F13\u5B58\u6210\u529F"));let r=c(`${v.search.substring(1)}c2ed53a74eeefe3cf99fbd01d8c9c375`).toString();v.searchParams.set("sign",r)}break;case!1:l.warn("\u7528\u6237\u8BBE\u7F6E\u63A8\u8350\u9875\u6D3B\u52A8\u5927\u56FE\u4E0D\u53BB\u9664")}}break;case"api.bilibili.com":case"api.biliapi.net":case"api.live.bilibili.com":v.pathname}case"CONNECT":case"TRACE":}$request.url=v.toString(),l.debug(`$request.url: ${$request.url}`)})().catch(u=>l.error(u)).finally(()=>{switch(typeof D){case"object":D.headers?.["Content-Encoding"]&&(D.headers["Content-Encoding"]="identity"),D.headers?.["content-encoding"]&&(D.headers["content-encoding"]="identity"),C==="Quantumult X"?(D.status||(D.status="HTTP/1.1 200 OK"),delete D.headers?.["Content-Length"],delete D.headers?.["content-length"],delete D.headers?.["Transfer-Encoding"],O(D)):O({response:D});break;case"undefined":O($request);break;default:l.error(`\u4E0D\u5408\u6CD5\u7684 $response \u7C7B\u578B: ${typeof D}`)}})})()})();
