// 2026/2/15 05:29:02 https://raw.githubusercontent.com/ElementRef/AboutConfig/main/script/bili.universe.adblock.request.js
(()=>{var V={21(D,E,r){var v;D.exports=v||(function(O,j){if("u">typeof window&&window.crypto&&(b=window.crypto),"u">typeof self&&self.crypto&&(b=self.crypto),"u">typeof globalThis&&globalThis.crypto&&(b=globalThis.crypto),!b&&"u">typeof window&&window.msCrypto&&(b=window.msCrypto),!b&&r.g!==void 0&&r.g.crypto&&(b=r.g.crypto),!b)try{b=r(298)}catch{}var b,C=function(){if(b){if(typeof b.getRandomValues=="function")try{return b.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof b.randomBytes=="function")try{return b.randomBytes(4).readInt32LE()}catch{}}throw Error("Native crypto module could not be used to get secure random number.")},R=Object.create||(function(){function t(){}return function(d){var g;return t.prototype=d,g=new t,t.prototype=null,g}})(),l={},$=l.lib={},B=$.Base={extend:function(t){var d=R(this);return t&&d.mixIn(t),d.hasOwnProperty("init")&&this.init!==d.init||(d.init=function(){d.$super.init.apply(this,arguments)}),d.init.prototype=d,d.$super=this,d},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var d in t)t.hasOwnProperty(d)&&(this[d]=t[d]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},k=$.WordArray=B.extend({init:function(t,d){t=this.words=t||[],j!=d?this.sigBytes=d:this.sigBytes=4*t.length},toString:function(t){return(t||e).stringify(this)},concat:function(t){var d=this.words,g=t.words,p=this.sigBytes,y=t.sigBytes;if(this.clamp(),p%4)for(var S=0;S<y;S++){var w=g[S>>>2]>>>24-S%4*8&255;d[p+S>>>2]|=w<<24-(p+S)%4*8}else for(var L=0;L<y;L+=4)d[p+L>>>2]=g[L>>>2];return this.sigBytes+=y,this},clamp:function(){var t=this.words,d=this.sigBytes;t[d>>>2]&=4294967295<<32-d%4*8,t.length=O.ceil(d/4)},clone:function(){var t=B.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var d=[],g=0;g<t;g+=4)d.push(C());return new k.init(d,t)}}),u=l.enc={},e=u.Hex={stringify:function(t){for(var d=t.words,g=t.sigBytes,p=[],y=0;y<g;y++){var S=d[y>>>2]>>>24-y%4*8&255;p.push((S>>>4).toString(16)),p.push((15&S).toString(16))}return p.join("")},parse:function(t){for(var d=t.length,g=[],p=0;p<d;p+=2)g[p>>>3]|=parseInt(t.substr(p,2),16)<<24-p%8*4;return new k.init(g,d/2)}},s=u.Latin1={stringify:function(t){for(var d=t.words,g=t.sigBytes,p=[],y=0;y<g;y++){var S=d[y>>>2]>>>24-y%4*8&255;p.push(String.fromCharCode(S))}return p.join("")},parse:function(t){for(var d=t.length,g=[],p=0;p<d;p++)g[p>>>2]|=(255&t.charCodeAt(p))<<24-p%4*8;return new k.init(g,d)}},a=u.Utf8={stringify:function(t){try{return decodeURIComponent(escape(s.stringify(t)))}catch{throw Error("Malformed UTF-8 data")}},parse:function(t){return s.parse(unescape(encodeURIComponent(t)))}},f=$.BufferedBlockAlgorithm=B.extend({reset:function(){this._data=new k.init,this._nDataBytes=0},_append:function(t){typeof t=="string"&&(t=a.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var d,g=this._data,p=g.words,y=g.sigBytes,S=this.blockSize,w=y/(4*S),L=(w=t?O.ceil(w):O.max((0|w)-this._minBufferSize,0))*S,A=O.min(4*L,y);if(L){for(var m=0;m<L;m+=S)this._doProcessBlock(p,m);d=p.splice(0,L),g.sigBytes-=A}return new k.init(d,A)},clone:function(){var t=B.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});$.Hasher=f.extend({cfg:B.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(d,g){return new t.init(g).finalize(d)}},_createHmacHelper:function(t){return function(d,g){return new h.HMAC.init(t,g).finalize(d)}}});var h=l.algo={};return l})(Math)},636(D,E,r){var v;v=r(21),(function(O){for(var j=v.lib,b=j.WordArray,C=j.Hasher,R=v.algo,l=[],$=0;$<64;$++)l[$]=4294967296*O.abs(O.sin($+1))|0;var B=R.MD5=C.extend({_doReset:function(){this._hash=new b.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(a,f){for(var h=0;h<16;h++){var t=f+h,d=a[t];a[t]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360}var g=this._hash.words,p=a[f+0],y=a[f+1],S=a[f+2],w=a[f+3],L=a[f+4],A=a[f+5],m=a[f+6],x=a[f+7],N=a[f+8],P=a[f+9],T=a[f+10],F=a[f+11],q=a[f+12],M=a[f+13],I=a[f+14],J=a[f+15],i=g[0],n=g[1],o=g[2],c=g[3];i=k(i,n,o,c,p,7,l[0]),c=k(c,i,n,o,y,12,l[1]),o=k(o,c,i,n,S,17,l[2]),n=k(n,o,c,i,w,22,l[3]),i=k(i,n,o,c,L,7,l[4]),c=k(c,i,n,o,A,12,l[5]),o=k(o,c,i,n,m,17,l[6]),n=k(n,o,c,i,x,22,l[7]),i=k(i,n,o,c,N,7,l[8]),c=k(c,i,n,o,P,12,l[9]),o=k(o,c,i,n,T,17,l[10]),n=k(n,o,c,i,F,22,l[11]),i=k(i,n,o,c,q,7,l[12]),c=k(c,i,n,o,M,12,l[13]),o=k(o,c,i,n,I,17,l[14]),n=k(n,o,c,i,J,22,l[15]),i=u(i,n,o,c,y,5,l[16]),c=u(c,i,n,o,m,9,l[17]),o=u(o,c,i,n,F,14,l[18]),n=u(n,o,c,i,p,20,l[19]),i=u(i,n,o,c,A,5,l[20]),c=u(c,i,n,o,T,9,l[21]),o=u(o,c,i,n,J,14,l[22]),n=u(n,o,c,i,L,20,l[23]),i=u(i,n,o,c,P,5,l[24]),c=u(c,i,n,o,I,9,l[25]),o=u(o,c,i,n,w,14,l[26]),n=u(n,o,c,i,N,20,l[27]),i=u(i,n,o,c,M,5,l[28]),c=u(c,i,n,o,S,9,l[29]),o=u(o,c,i,n,x,14,l[30]),n=u(n,o,c,i,q,20,l[31]),i=e(i,n,o,c,A,4,l[32]),c=e(c,i,n,o,N,11,l[33]),o=e(o,c,i,n,F,16,l[34]),n=e(n,o,c,i,I,23,l[35]),i=e(i,n,o,c,y,4,l[36]),c=e(c,i,n,o,L,11,l[37]),o=e(o,c,i,n,x,16,l[38]),n=e(n,o,c,i,T,23,l[39]),i=e(i,n,o,c,M,4,l[40]),c=e(c,i,n,o,p,11,l[41]),o=e(o,c,i,n,w,16,l[42]),n=e(n,o,c,i,m,23,l[43]),i=e(i,n,o,c,P,4,l[44]),c=e(c,i,n,o,q,11,l[45]),o=e(o,c,i,n,J,16,l[46]),n=e(n,o,c,i,S,23,l[47]),i=s(i,n,o,c,p,6,l[48]),c=s(c,i,n,o,x,10,l[49]),o=s(o,c,i,n,I,15,l[50]),n=s(n,o,c,i,A,21,l[51]),i=s(i,n,o,c,q,6,l[52]),c=s(c,i,n,o,w,10,l[53]),o=s(o,c,i,n,T,15,l[54]),n=s(n,o,c,i,y,21,l[55]),i=s(i,n,o,c,N,6,l[56]),c=s(c,i,n,o,J,10,l[57]),o=s(o,c,i,n,m,15,l[58]),n=s(n,o,c,i,M,21,l[59]),i=s(i,n,o,c,L,6,l[60]),c=s(c,i,n,o,F,10,l[61]),o=s(o,c,i,n,S,15,l[62]),n=s(n,o,c,i,P,21,l[63]),g[0]=g[0]+i|0,g[1]=g[1]+n|0,g[2]=g[2]+o|0,g[3]=g[3]+c|0},_doFinalize:function(){var a=this._data,f=a.words,h=8*this._nDataBytes,t=8*a.sigBytes;f[t>>>5]|=128<<24-t%32;var d=O.floor(h/4294967296);f[(t+64>>>9<<4)+15]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,f[(t+64>>>9<<4)+14]=(h<<8|h>>>24)&16711935|(h<<24|h>>>8)&4278255360,a.sigBytes=(f.length+1)*4,this._process();for(var g=this._hash,p=g.words,y=0;y<4;y++){var S=p[y];p[y]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360}return g},clone:function(){var a=C.clone.call(this);return a._hash=this._hash.clone(),a}});function k(a,f,h,t,d,g,p){var y=a+(f&h|~f&t)+d+p;return(y<<g|y>>>32-g)+f}function u(a,f,h,t,d,g,p){var y=a+(f&t|h&~t)+d+p;return(y<<g|y>>>32-g)+f}function e(a,f,h,t,d,g,p){var y=a+(f^h^t)+d+p;return(y<<g|y>>>32-g)+f}function s(a,f,h,t,d,g,p){var y=a+(h^(f|~t))+d+p;return(y<<g|y>>>32-g)+f}v.MD5=C._createHelper(B),v.HmacMD5=C._createHmacHelper(B)})(Math),D.exports=v.MD5},298(){}},U={};function H(D){var E=U[D];if(E!==void 0)return E.exports;var r=U[D]={exports:{}};return V[D].call(r.exports,r,r.exports,H),r.exports}H.g=(()=>{if(typeof globalThis=="object")return globalThis;try{return this||Function("return this")()}catch{if(typeof window=="object")return window}})(),(()=>{"use strict";let D,E=(()=>{let u=Object.keys(globalThis);switch(!0){case u.includes("$task"):return"Quantumult X";case u.includes("$loon"):return"Loon";case u.includes("$rocket"):return"Shadowrocket";case"u">typeof module:return"Node.js";case u.includes("Egern"):return"Egern";case u.includes("$environment"):return $environment["surge-version"]?"Surge":$environment["stash-version"]?"Stash":void 0;default:return}})();class r{static#e=new Map([]);static#s=[];static#a=new Map([]);static clear=()=>{};static count=(e="default")=>{switch(r.#e.has(e)){case!0:r.#e.set(e,r.#e.get(e)+1);break;case!1:r.#e.set(e,0)}r.log(`${e}: ${r.#e.get(e)}`)};static countReset=(e="default")=>{switch(r.#e.has(e)){case!0:r.#e.set(e,0),r.log(`${e}: ${r.#e.get(e)}`);break;case!1:r.warn(`Counter "${e}" doesn\u2019t exist`)}};static debug=(...e)=>{r.#t<4||(e=e.map(s=>`\u{1F171}\uFE0F ${s}`),r.log(...e))};static error(...e){if(!(r.#t<1)){switch(E){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":case"Quantumult X":default:e=e.map(s=>`\u274C ${s}`);break;case"Node.js":e=e.map(s=>`\u274C ${s.stack}`)}r.log(...e)}}static exception=(...e)=>r.error(...e);static group=e=>r.#s.unshift(e);static groupEnd=()=>r.#s.shift();static info(...e){r.#t<3||(e=e.map(s=>`\u2139\uFE0F ${s}`),r.log(...e))}static#t=3;static get logLevel(){switch(r.#t){case 0:return"OFF";case 1:return"ERROR";case 2:return"WARN";case 3:default:return"INFO";case 4:return"DEBUG";case 5:return"ALL"}}static set logLevel(e){switch(typeof e){case"string":e=e.toLowerCase();break;case"number":break;default:e="warn"}switch(e){case 0:case"off":r.#t=0;break;case 1:case"error":r.#t=1;break;case 2:case"warn":case"warning":default:r.#t=2;break;case 3:case"info":r.#t=3;break;case 4:case"debug":r.#t=4;break;case 5:case"all":r.#t=5}}static log=(...e)=>{r.#t!==0&&(e=e.map(s=>{switch(typeof s){case"object":s=JSON.stringify(s);break;case"bigint":case"number":case"boolean":case"string":s=s.toString()}return s}),r.#s.forEach(s=>{(e=e.map(a=>`  ${a}`)).unshift(`\u25BC ${s}:`)}))};static time=(e="default")=>r.#a.set(e,Date.now());static timeEnd=(e="default")=>r.#a.delete(e);static timeLog=(e="default")=>{let s=r.#a.get(e);s?r.log(`${e}: ${Date.now()-s}ms`):r.warn(`Timer "${e}" doesn\u2019t exist`)};static warn(...e){r.#t<2||(e=e.map(s=>`\u26A0\uFE0F ${s}`),r.log(...e))}}class v{static escape(e){let s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return e.replace(/[&<>"']/g,a=>s[a])}static get(e={},s="",a){Array.isArray(s)||(s=v.toPath(s));let f=s.reduce((h,t)=>Object(h)[t],e);return f===void 0?a:f}static merge(e,...s){if(e==null)return e;for(let a of s)if(a!=null)for(let f of Object.keys(a)){let h=a[f],t=e[f];switch(!0){case(v.#e(h)&&v.#e(t)):e[f]=v.merge(t,h);break;case(h instanceof Map&&t instanceof Map):if(h.size>0)for(let[d,g]of h)t.set(d,g);break;case(h instanceof Set&&t instanceof Set):if(h.size>0)for(let d of h)t.add(d);break;case(Array.isArray(h)&&h.length===0&&t!==void 0):case(h instanceof Map&&h.size===0&&t!==void 0):case(h instanceof Set&&h.size===0&&t!==void 0):break;case h!==void 0:e[f]=h}}return e}static#e(e){if(e===null||typeof e!="object")return!1;let s=Object.getPrototypeOf(e);return s===null||s===Object.prototype}static omit(e={},s=[]){return Array.isArray(s)||(s=[s.toString()]),s.forEach(a=>v.unset(e,a)),e}static pick(e={},s=[]){return Array.isArray(s)||(s=[s.toString()]),Object.fromEntries(Object.entries(e).filter(([a,f])=>s.includes(a)))}static set(e,s,a){return Array.isArray(s)||(s=v.toPath(s)),s.slice(0,-1).reduce((f,h,t)=>Object(f[h])===f[h]?f[h]:f[h]=/^\d+$/.test(s[t+1])?[]:{},e)[s[s.length-1]]=a,e}static toPath(e){return e.replace(/\[(\d+)\]/g,".$1").split(".").filter(Boolean)}static unescape(e){let s={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};return e.replace(/&amp;|&lt;|&gt;|&quot;|&#39;/g,a=>s[a])}static unset(e={},s=""){return Array.isArray(s)||(s=v.toPath(s)),s.reduce((a,f,h)=>h===s.length-1?(delete a[f],!0):Object(a)[f],e)}}let O={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",304:"Not Modified",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Content Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"};function j(u={}){switch(E){case"Surge":u.policy&&v.set(u,"headers.X-Surge-Policy",u.policy),r.log("\u{1F6A9} \u6267\u884C\u7ED3\u675F!",`\u{1F55B} ${new Date().getTime()/1e3-$script.startTime} \u79D2`),$done(u);break;case"Loon":u.policy&&(u.node=u.policy),r.log("\u{1F6A9} \u6267\u884C\u7ED3\u675F!",`\u{1F55B} ${(new Date-$script.startTime)/1e3} \u79D2`),$done(u);break;case"Stash":u.policy&&v.set(u,"headers.X-Stash-Selected-Proxy",encodeURI(u.policy)),r.log("\u{1F6A9} \u6267\u884C\u7ED3\u675F!",`\u{1F55B} ${(new Date-$script.startTime)/1e3} \u79D2`),$done(u);break;case"Egern":case"Shadowrocket":r.log("\u{1F6A9} \u6267\u884C\u7ED3\u675F!"),$done(u);break;case"Quantumult X":switch(u.policy&&v.set(u,"opts.policy",u.policy),typeof(u=v.pick(u,["status","url","headers","body","bodyBytes"])).status){case"number":u.status=`HTTP/1.1 ${u.status} ${O[u.status]}`;break;case"string":case"undefined":break;default:throw TypeError(`${Function.name}: \u53C2\u6570\u7C7B\u578B\u9519\u8BEF, status \u5FC5\u987B\u4E3A\u6570\u5B57\u6216\u5B57\u7B26\u4E32`)}u.body instanceof ArrayBuffer?(u.bodyBytes=u.body,u.body=void 0):ArrayBuffer.isView(u.body)?(u.bodyBytes=u.body.buffer.slice(u.body.byteOffset,u.body.byteLength+u.body.byteOffset),u.body=void 0):u.body&&(u.bodyBytes=void 0),r.log("\u{1F6A9} \u6267\u884C\u7ED3\u675F!"),$done(u);break;default:r.log("\u{1F6A9} \u6267\u884C\u7ED3\u675F!"),process.exit(1)}}class b{static data=null;static dataFile="box.dat";static#e=/^@(?<key>[^.]+)(?:\.(?<path>.*))?$/;static getItem(e,s=null){let a=s;if(e.startsWith("@")===!0){let{key:f,path:h}=e.match(b.#e)?.groups;e=f;let t=b.getItem(e,{});typeof t!="object"&&(t={}),a=v.get(t,h);try{a=JSON.parse(a)}catch{}}else{switch(E){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":a=$persistentStore.read(e);break;case"Quantumult X":a=$prefs.valueForKey(e);break;case"Node.js":b.data=b.#s(b.dataFile),a=b.data?.[e];break;default:a=b.data?.[e]||null}try{a=JSON.parse(a)}catch{}}return a??s}static setItem(e=new String,s=new String){let a=!1;if(s=typeof s=="object"?JSON.stringify(s):String(s),e.startsWith("@")===!0){let{key:f,path:h}=e.match(b.#e)?.groups;e=f;let t=b.getItem(e,{});typeof t!="object"&&(t={}),v.set(t,h,s),a=b.setItem(e,t)}else switch(E){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":a=$persistentStore.write(s,e);break;case"Quantumult X":a=$prefs.setValueForKey(s,e);break;case"Node.js":b.data=b.#s(b.dataFile),b.data[e]=s,b.#a(b.dataFile),a=!0;break;default:a=b.data?.[e]||null}return a}static removeItem(e){let s=!1;if(e.startsWith("@")===!0){let{key:a,path:f}=e.match(b.#e)?.groups;e=a;let h=b.getItem(e);typeof h!="object"&&(h={}),keyValue=v.unset(h,f),s=b.setItem(e,h)}else switch(E){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":case"Node.js":default:s=!1;break;case"Quantumult X":s=$prefs.removeValueForKey(e)}return s}static clear(){let e=!1;switch(E){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":case"Node.js":default:e=!1;break;case"Quantumult X":e=$prefs.removeAllValues()}return e}static#s=e=>{if(E!=="Node.js")return{};{this.fs=this.fs?this.fs:require("node:fs"),this.path=this.path?this.path:require("node:path");let s=this.path.resolve(e),a=this.path.resolve(process.cwd(),e),f=this.fs.existsSync(s),h=!f&&this.fs.existsSync(a);if(!f&&!h)return{};try{return JSON.parse(this.fs.readFileSync(f?s:a))}catch{return{}}}};static#a=(e=this.dataFile)=>{if(E==="Node.js"){this.fs=this.fs?this.fs:require("node:fs"),this.path=this.path?this.path:require("node:path");let s=this.path.resolve(e),a=this.path.resolve(process.cwd(),e),f=this.fs.existsSync(s),h=!f&&this.fs.existsSync(a),t=JSON.stringify(this.data);f?this.fs.writeFileSync(s,t):h?this.fs.writeFileSync(a,t):this.fs.writeFileSync(s,t)}}}function C(u){return/^\d+$/.test(u)&&(u=Number.parseInt(u,10)),u}let R={ADBlock:{Settings:{Splash:!0,Feed:{AD:!0,Activity:!1,Vertical:!1,BlockUpLiveList:"",Story:!0},Search:{AD:!0,HotSearch:!0},PGC:{AD:!0},Xlive:{AD:!0},Dynamic:{HotTopics:!0,MostVisited:!1,MostVisitedLiveOnly:!1,AdCard:!0},View:{AD:!0},DM:{Command:!1,Colorful:!1},Reply:{AD:!0}}},Default:{Settings:{LogLevel:"WARN"}}};var l=H(636);let $=new URL($request.url);r.info(`url: ${$.toJSON()}`);let B=$.pathname.split("/").filter(Boolean);r.info(`PATHs: ${B}`);let k=($request.headers?.["Content-Type"]??$request.headers?.["content-type"])?.split(";")?.[0];r.info(`FORMAT: ${k}`),(async()=>{let{Settings:u,Caches:e,Configs:s}=(function(a,f,h){r.log("\u2611\uFE0F Set Environment Variables");let{Settings:t,Caches:d,Configs:g}=(function(p,y,S){S?.Default?.Settings?.LogLevel&&(r.logLevel=S.Default.Settings.LogLevel),r.debug("\u2611\uFE0F getStorage"),y=[y].flat(1/0);let w={Settings:S?.Default?.Settings||{},Configs:S?.Default?.Configs||{},Caches:{}};r.debug("Default",`Store.Settings\u7C7B\u578B: ${typeof w.Settings}`,`Store.Settings: ${JSON.stringify(w.Settings)}`),r.debug("\u2611\uFE0F $argument");let L={};switch(typeof $argument){case"string":$argument=Object.fromEntries($argument.split("&").map(m=>m.split("=",2).map(x=>x.replace(/\"/g,""))));case"object":Object.keys($argument).forEach(m=>v.set(L,m,$argument[m]))}L.LogLevel&&(r.logLevel=L.LogLevel),r.debug("\u2705 $argument",`argument: ${JSON.stringify(L)}`);let A=b.getItem(p);return A&&(r.debug("\u2611\uFE0F BoxJs",`BoxJs\u7C7B\u578B: ${typeof A}`,`BoxJs\u5185\u5BB9: ${JSON.stringify(A||{})}`),y.forEach(m=>{typeof A?.[m]?.Settings=="string"&&(A[m].Settings=JSON.parse(A[m].Settings||"{}")),typeof A?.[m]?.Caches=="string"&&(A[m].Caches=JSON.parse(A[m].Caches||"{}"))}),A.LogLevel&&(r.logLevel=A.LogLevel),r.debug("\u2705 BoxJs",`Store.Settings\u7C7B\u578B: ${typeof w.Settings}`,`Store.Settings: ${JSON.stringify(w.Settings)}`)),y.forEach(m=>{v.merge(w.Settings,S?.[m]?.Settings,A?.[m]?.Settings),v.merge(w.Configs,S?.[m]?.Configs),v.merge(w.Caches,A?.[m]?.Caches)}),v.merge(w.Settings,L),w.Settings.LogLevel&&(r.logLevel=w.Settings.LogLevel),r.debug("\u2705 Merge",`Store.Settings\u7C7B\u578B: ${typeof w.Settings}`,`Store.Settings: ${JSON.stringify(w.Settings)}`),(function m(x,N){for(let P in x){let T=x[P];x[P]=typeof T=="object"&&T!==null?m(T,N):N(P,T)}return x})(w.Settings,(m,x)=>(r.debug("\u2611\uFE0F traverseObject",`${m}: ${typeof x}`,`${m}: ${JSON.stringify(x)}`),x==="true"||x==="false"?x=JSON.parse(x):typeof x=="string"&&(x=x.includes(",")?x.split(",").map(N=>C(N)):C(x)),x)),r.debug("\u2705 traverseObject",`Store.Settings\u7C7B\u578B: ${typeof w.Settings}`,`Store.Settings: ${JSON.stringify(w.Settings)}`),r.debug("\u2705 getStorage"),w})(a,f,h);return r.info(`typeof Settings: ${typeof t}`,`Settings: ${JSON.stringify(t,null,2)}`),r.log("\u2705 Set Environment Variables"),{Settings:t,Caches:d,Configs:g}})("BiliBili","ADBlock",R);switch(r.logLevel=u.LogLevel,$request.method){case"POST":case"PUT":case"PATCH":case"DELETE":case"GET":case"HEAD":case"OPTIONS":default:switch($.hostname){case"www.bilibili.com":case"search.bilibili.com":break;case"app.bilibili.com":case"app.biliapi.net":switch($.pathname){case"/x/v2/splash/show":case"/x/v2/splash/list":case"/x/v2/splash/brand/list":case"/x/v2/splash/event/list2":case"/x/v2/feed/index/story":case"/x/v2/search/square":case"/x/v2/search":case"/x/v2/search/type":break;case"/x/v2/feed/index":switch(u?.Feed?.Activity){case!0:default:if($.searchParams.has("banner_hash")&&$.searchParams.get("login_event")!=="0"){$.searchParams.delete("sign"),$.searchParams.set("open_event",""),$.searchParams.set("pull",0),e.banner_hash&&($.searchParams.set("banner_hash",e.banner_hash),r.log("\u2705 \u8BFB\u53D6hash\u7F13\u5B58\u6210\u529F"));let a=l(`${$.search.substring(1)}c2ed53a74eeefe3cf99fbd01d8c9c375`).toString();$.searchParams.set("sign",a)}break;case!1:r.warn("\u7528\u6237\u8BBE\u7F6E\u63A8\u8350\u9875\u6D3B\u52A8\u5927\u56FE\u4E0D\u53BB\u9664")}}break;case"api.bilibili.com":case"api.biliapi.net":case"api.live.bilibili.com":$.pathname}case"CONNECT":case"TRACE":}$request.url=$.toString(),r.debug(`$request.url: ${$request.url}`)})().catch(u=>r.error(u)).finally(()=>{switch(typeof D){case"object":D.headers?.["Content-Encoding"]&&(D.headers["Content-Encoding"]="identity"),D.headers?.["content-encoding"]&&(D.headers["content-encoding"]="identity"),E==="Quantumult X"?(D.status||(D.status="HTTP/1.1 200 OK"),delete D.headers?.["Content-Length"],delete D.headers?.["content-length"],delete D.headers?.["Transfer-Encoding"],j(D)):j({response:D});break;case"undefined":j($request);break;default:r.error(`\u4E0D\u5408\u6CD5\u7684 $response \u7C7B\u578B: ${typeof D}`)}})})()})();
