// Mon Oct 27 2025 21:19:41 GMT+0000 (Coordinated Universal Time) https://raw.githubusercontent.com/ElementRef/AboutConfig/main/script/ddgksf2013.weibo.js
const version="V2.0.142",mainConfig={isDebug:!1,author:"ddgksf2013",removeHomeVip:!0,removeHomeCreatorTask:!0,removeRelate:!0,removeGood:!0,removeFollow:!0,modifyMenus:!0,removeRelateItem:!1,removeRecommendItem:!0,removeRewardItem:!0,removeLiveMedia:!0,removeNextVideo:!1,removePinedTrending:!0,removeInterestFriendInTopic:!1,removeInterestTopic:!1,removeInterestUser:!0,removeLvZhou:!0,removeSearchWindow:!0,profileSkin1:null,profileSkin2:null,tabIconVersion:0,tabIconPath:""},itemMenusConfig={creator_task:!1,mblog_menus_custom:!1,mblog_menus_video_later:!0,mblog_menus_comment_manager:!0,mblog_menus_avatar_widget:!1,mblog_menus_card_bg:!1,mblog_menus_long_picture:!0,mblog_menus_delete:!0,mblog_menus_edit:!0,mblog_menus_edit_history:!0,mblog_menus_edit_video:!0,mblog_menus_sticking:!0,mblog_menus_open_reward:!0,mblog_menus_novelty:!1,mblog_menus_favorite:!0,mblog_menus_promote:!0,mblog_menus_modify_visible:!0,mblog_menus_copy_url:!0,mblog_menus_follow:!0,mblog_menus_video_feedback:!0,mblog_menus_shield:!0,mblog_menus_report:!0,mblog_menus_apeal:!0,mblog_menus_home:!0},modifyCardsUrls=["/cardlist","video/community_tab","searchall"],modifyStatusesUrls=["statuses/friends/timeline","statuses_unread_hot_timeline","statuses/unread_friends_timeline","statuses/unread_hot_timeline","groups/timeline","statuses/friends_timeline"],otherUrls={"/profile/me":"removeHome","/statuses/extend":"itemExtendHandler","/video/remind_info":"removeVideoRemind","/checkin/show":"removeCheckin","/live/media_homelist":"removeMediaHomelist","/container_detail":"removeComments","/container/get_item":"containerHandler","/profile/container_timeline":"userHandler","/video/tiny_stream_video_list":"nextVideoHandler","/2/statuses/video_mixtimeline":"nextVideoHandler","video/tiny_stream_mid_detail":"nextVideoHandler","/!/client/light_skin":"tabSkinHandler","/littleskin/preview":"skinPreviewHandler","/search/finder":"removeSearchMain","/search/container_timeline":"removeSearch","/search/container_discover":"removeSearch","/2/flowpage":"removeMsgAd","/2/page?":"removePage","/statuses/unread_topic_timeline":"topicHandler","/square&pageDataType/":"squareHandler","/statuses/container_timeline_topic":"removeMain","/statuses/container_timeline":"removeMainTab","wbapplua/wbpullad.lua":"removeLuaScreenAds","interface/sdk/sdkad.php":"removePhpScreenAds","a=trends":"removeTopics",user_center:"modifiedUserCenter","a=get_coopen_ads":"removeIntlOpenAds","php?a=search_topic":"removeSearchTopic","ad/realtime":"removeRealtimeAd","ad/preload":"removeAdPreload","php?a=open_app":"removeAdBanner"};function getModifyMethod(e){for(const i of modifyCardsUrls)if(-1<e.indexOf(i))return"removeCards";for(const i of modifyStatusesUrls)if(-1<e.indexOf(i))return"removeTimeLine";for(var[a,o]of Object.entries(otherUrls))if(-1<e.indexOf(a))return o;return null}function removeRealtimeAd(e){return delete e.ads,e.code=4016,e}function removeAdBanner(e){return e.data.close_ad_setting&&delete e.data.close_ad_setting,e.data.detail_banner_ad&&(e.data.detail_banner_ad=[]),e}function removeAdPreload(e){if(e.ads){e.last_ad_show_interval=86400;for(var a of e.ads)a.start_time=2681574400,a.end_time=2681660799,a.display_duration=0,a.daily_display_cnt=0,a.total_display_cnt=0}return e}function removeIntlOpenAds(e){return e.data&&(e.data={display_ad:1}),e}function removeSearchTopic(e){return e.data&&e.data.search_topic?.cards.length!==0&&(e.data.search_topic.cards=Object.values(e.data.search_topic.cards).filter(a=>a.type!="searchtop"),e.data.trending_topic)&&delete e.data.trending_topic,e}function modifiedUserCenter(e){return e.data&&e.data.length!==0&&e.data.cards&&(e.data.cards=Object.values(e.data.cards).filter(a=>a.items[0].type!="personal_vip")),e}function removeTopics(e){return e.data&&(e.data.order=["search_topic"]),e}function isAd(e){return!!e&&(e.mblogtypename=="\u5E7F\u544A"||e.mblogtypename=="\u70ED\u63A8"||e.promotion?.type=="ad"||e.page_info?.actionlog?.source=="ad"||e.content_auth_info?.content_auth_title=="\u5E7F\u544A")}function squareHandler(e){return e.items,e}function removeMainTab(e){if(e.loadedInfo&&e.loadedInfo.headers&&delete e.loadedInfo.headers,e.items){var a,o=[];for(a of e.items)isAd(a.data)||(a.data?.page_info?.video_limit&&delete a.data.page_info.video_limit,a.data?.common_struct&&delete a.data.common_struct,a.category&&a.category=="group"&&JSON.stringify(a.items).indexOf("profile_top")==-1)||o.push(a);e.items=o,log("removeMainTab success")}return e}function removeMain(e){if(e.loadedInfo&&e.loadedInfo.headers&&delete e.loadedInfo.headers,e.items){var a,o=[];for(a of e.items)a.category=="feed"?isAd(a.data)||o.push(a):a.category=="group"?0<a.items.length&&a.items[0].data?.itemid?.includes("search_input")?(a.items=a.items.filter(i=>i?.data?.itemid?.includes("mine_topics")||i?.data?.itemid?.includes("search_input")||i?.data?.card_type==202),a.items[0].data.hotwords=[{word:"\u641C\u7D22\u8D85\u8BDD",tip:""}],o.push(a)):0<a.items.length&&a.items[0].data?.itemid?.includes("top_title")||(0<a.items.length&&(a.items=Object.values(a.items).filter(i=>i.category==="feed"||i.category==="card")),o.push(a)):a.data?.card_type&&-1<[202,200].indexOf(a.data.card_type)||o.push(a);e.items=o,log("removeMain success")}return e}function topicHandler(e){var a=e.cards;if(a&&(mainConfig.removeUnfollowTopic||mainConfig.removeUnusedPart)){var o,i=[];for(o of a){let d=!0;if(o.mblog){var t=o.mblog.buttons;mainConfig.removeUnfollowTopic&&t&&t[0].type=="follow"&&(d=!1)}else{if(!mainConfig.removeUnusedPart)continue;if(o.itemid=="bottom_mix_activity")d=!1;else if(o?.top?.title=="\u6B63\u5728\u6D3B\u8DC3")d=!1;else if(o.card_type==200&&o.group)d=!1;else{if(t=o.card_group,!t)continue;var r=t[0];if(-1<["guess_like_title","cats_top_title","chaohua_home_readpost_samecity_title"].indexOf(r.itemid))d=!1;else if(1<t.length){var n,s=[];for(n of t)["chaohua_discovery_banner_1","bottom_mix_activity"].indexOf(n.itemid)==-1&&s.push(n);o.card_group=s}}}d&&i.push(o)}e.cards=i,log("topicHandler success")}return e}function removeSearchMain(e){var a=e.channelInfo.channels;if(a){var o,i=[];for(o of a)o.payload&&(o.payload?.items&&(o.payload.items=[]),o.payload?.loadedInfo?.searchBarContent&&(o.payload.loadedInfo.searchBarContent=[{}]),o.payload?.loadedInfo?.headerBack&&(o.payload.loadedInfo.headerBack.channelStyleMap={}),delete o.titleInfoAbsorb,delete o.titleInfo,delete o.title,i.push(o));e.channelInfo.channels=i,e.header?.data&&removeHeader(e.header.data),e.channelInfo?.moreChannels&&(delete e.channelInfo.moreChannels,delete e.channelInfo.channelConfig),log("remove_search main success")}return e}function removeHeader(e){if(e.items){var a,o=[];for(a of e.items)a.category=="group"&&(a.items=a.items.filter(i=>i.data?.card_type===void 0||i.data?.card_type===101||i.data?.card_type===17).map(i=>(i.data?.card_type===17&&(i.data.col=1),i)),0<a.items.length)&&o.push(a);log("remove Header success"),e.items=o}return e}function checkSearchWindow(e){return!!mainConfig.removeSearchWindow&&e.category=="card"&&(e.data?.itemid=="finder_window"||e.data?.itemid=="discover_gallery"||e.data?.itemid=="more_frame"||e.data?.card_type==208||e.data?.card_type==236||e.data?.card_type==247||e.data?.card_type==217||e.data?.card_type==101||e.data?.card_type==19||e.data?.mblog?.page_info?.actionlog?.source?.includes("ad")||e.data?.pic?.includes("ads"))}function removeSearch(e){if(e.items){var a,o=[];for(a of e.items)a.category=="feed"?isAd(a.data)||(a.data?.page_info?.video_limit&&delete a.data.page_info.video_limit,o.push(a)):a.category=="group"?a.header?.type==="guess"&&a.itemExt?.filterType!="search"||(a.items=a.items.filter(i=>(i.data?.card_type===void 0||i.data?.card_type===17||i.data?.card_type===10)&&i.data?.content_auth_info?.content_auth_title!=="\u5E7F\u544A").map(i=>(i.data?.card_type===17&&(i.data.col=1),i)),0<a.items.length&&o.push(a)):checkSearchWindow(a)||o.push(a);e.items=o,e.loadedInfo&&(e.loadedInfo.searchBarContent=[],e.loadedInfo.headerBack)&&(e.loadedInfo.headerBack.channelStyleMap={}),log("remove_search success")}return e}function removeMsgAd(e){if(e.items){var a,o=[];for(a of e.items)a.itemId=="hotword"?(a.items=a.items.filter(i=>i?.data?.pic?.includes("com/wb_search")),o.push(a)):a.type=="text"&&a?.text?.content?.includes("\u5B9E\u65F6\u70ED\u70B9")&&o.push(a);e.items=o,e.channelInfo&&delete e.channelInfo,log("remove_search success")}return e}function removePage(e){return removeCards(e),mainConfig.removePinedTrending&&e.cards&&0<e.cards.length&&e.cards[0].card_group&&(e.cards[0].card_group=e.cards[0].card_group.filter(a=>!(a?.actionlog?.ext?.includes("ads_word")||a?.itemid?.includes("t:51")||a?.itemid?.includes("ads_word")))),e}function removeCards(e){if(e.hotwords&&(e.hotwords=[]),e.cards){var a,o=[];for(a of e.cards){e.cardlistInfo?.containerid!="232082type=1"||a.card_type!=17&&a.card_type!=58&&a.card_type!=11||(i=a.card_type+1,a={card_type:i});var i=a.card_group;if(i&&0<i.length){var t=[];for(const n of i)n.card_type==118||isAd(n.mblog)||JSON.stringify(n).indexOf("res_from:ads")==-1&&t.push(n);a.card_group=t,o.push(a)}else{var r=a.card_type;-1<[9,165].indexOf(r)?isAd(a.mblog)||o.push(a):-1<[1007,180].indexOf(r)||o.push(a)}}e.cards=o}e.items&&(log("data.items"),removeSearch(e))}function lvZhouHandler(e){if(mainConfig.removeLvZhou&&e){var a=e.common_struct;if(a){var o=[];for(const i of a)i.name!="\u7EFF\u6D32"&&o.push(i);e.common_struct=o}}}function isBlock(e){var a=mainConfig.blockIds||[];if(a.length!==0){var o=e.user.id;for(const i of a)if(i==o)return!0}return!1}function removeTimeLine(e){for(const o of["ad","advertises","trends","headers"])e[o]&&delete e[o];if(e.statuses){var a=[];for(const o of e.statuses)isAd(o)||(lvZhouHandler(o),o.common_struct&&delete o.common_struct,o.category&&o.category=="group")||a.push(o);e.statuses=a}}function removeHomeVip(e){return e.header&&e.header.vipView&&(e.header.vipView=null),e}function removeVideoRemind(e){e.bubble_dismiss_time=0,e.exist_remind=!1,e.image_dismiss_time=0,e.image="",e.tag_image_english="",e.tag_image_english_dark="",e.tag_image_normal="",e.tag_image_normal_dark=""}function itemExtendHandler(e){var a;(mainConfig.removeRelate||mainConfig.removeGood)&&e.trend&&e.trend.titles&&(a=e.trend.titles.title,mainConfig.removeRelate&&a==="\u76F8\u5173\u63A8\u8350"||mainConfig.removeGood&&a==="\u535A\u4E3B\u597D\u7269\u79CD\u8349")&&delete e.trend,mainConfig.removeFollow&&e.follow_data&&(e.follow_data=null),mainConfig.removeRewardItem&&e.reward_info&&(e.reward_info=null),e.head_cards&&delete e.head_cards,e.page_alerts&&(e.page_alerts=null);try{-1<e.trend.extra_struct.extBtnInfo.btn_picurl.indexOf("timeline_icon_ad_delete")&&delete e.trend}catch{}if(mainConfig.modifyMenus&&e.custom_action_list){var o=[];for(const r of e.custom_action_list){var i=r.type,t=itemMenusConfig[i];t===void 0?o.push(r):i==="mblog_menus_copy_url"?o.unshift(r):t&&o.push(r)}e.custom_action_list=o}}function updateFollowOrder(e){try{for(var a of e.items){var o;if(a.itemId==="mainnums_friends")return o=a.click.modules[0].scheme,a.click.modules[0].scheme=o.replace("231093_-_selfrecomm","231093_-_selffollowed"),void log("updateFollowOrder success")}}catch{}}function updateProfileSkin(e,a){try{var o=mainConfig[a];if(o){let t=0;for(var i of e.items)if(i.image)try{(dm=i.image.style.darkMode)!="alpha"&&(i.image.style.darkMode="alpha"),i.image.iconUrl=o[t++],i.dot&&(i.dot=[])}catch{}log("updateProfileSkin success")}}catch{}}function removeHome(e){if(e.items){var a,o=[];for(a of e.items){var i=a.itemId;i=="profileme_mine"?((a=mainConfig.removeHomeVip?removeHomeVip(a):a).header?.vipIcon&&delete a.header.vipIcon,updateFollowOrder(a),o.push(a)):i=="100505_-_top8"?(updateProfileSkin(a,"profileSkin1"),o.push(a)):i=="100505_-_newcreator"?a.type=="grid"?(updateProfileSkin(a,"profileSkin2"),o.push(a)):mainConfig.removeHomeCreatorTask||o.push(a):i!="100505_-_chaohua"&&i!="100505_-_manage"&&i!="100505_-_recentlyuser"||(0<a.images?.length&&(a.images=a.images.filter(t=>t.itemId=="100505_-_chaohua"||t.itemId=="100505_-_recentlyuser")),o.push(a))}e.items=o}return e}function removeCheckin(e){log("remove tab1\u7B7E\u5230"),e.show=0}function removeMediaHomelist(e){mainConfig.removeLiveMedia&&(log("remove \u9996\u9875\u76F4\u64AD"),e.data={})}function removeComments(e){var a=["\u5E7F\u544A","\u5EE3\u544A","\u76F8\u5173\u5185\u5BB9","\u63A8\u8350","\u70ED\u63A8","\u63A8\u85A6","\u8350\u8BFB"],o=(e.pageHeader&&(e.pageHeader.data.items=e.pageHeader.data.items.filter(r=>r.category=="detail")),e.items||[]);if(o.length!==0){var i=[];for(const r of o){var t=r.data.adType||"";a.indexOf(t)==-1&&r.data.card_type!=6&&r.data.card_type!=236&&i.push(r)}log("remove \u8BC4\u8BBA\u533A\u76F8\u5173\u548C\u63A8\u8350\u5185\u5BB9"),e.items=i,e.tip_msg&&delete e.tip_msg}}function containerHandler(e){mainConfig.removeInterestFriendInTopic&&e.card_type_name==="\u8D85\u8BDD\u91CC\u7684\u597D\u53CB"&&(log("remove \u8D85\u8BDD\u91CC\u7684\u597D\u53CB"),e.card_group=[]),mainConfig.removeInterestTopic&&e.itemid&&(-1<e.itemid.indexOf("infeed_may_interest_in")?(log("remove \u611F\u5174\u8DA3\u7684\u8D85\u8BDD"),e.card_group=[]):-1<e.itemid.indexOf("infeed_friends_recommend")&&(log("remove \u8D85\u8BDD\u597D\u53CB\u5173\u6CE8"),e.card_group=[]))}function userHandler(e){if(e=removeMainTab(e),mainConfig.removeInterestUser&&e.items){var a,o=[];for(a of e.items){let i=!0;if(a.category=="group")try{a.items[0].data.desc=="\u53EF\u80FD\u611F\u5174\u8DA3\u7684\u4EBA"&&(i=!1)}catch{}i&&(a.data?.common_struct&&delete a.data.common_struct,o.push(a))}e.items=o,log("removeMain sub success")}return e}function nextVideoHandler(e){if(e.statuses){var a,o=[];for(a of e.statuses)if(!isAd(a)){for(const i of["forward_redpacket_info","shopping","float_info","tags"])a.video_info?.[i]&&delete a.video_info[i];o.push(a)}e.statuses=o,log("removeMainTab Success")}return e}function tabSkinHandler(e){try{var a,o=mainConfig.tabIconVersion;if(e.data.canUse=1,o&&mainConfig.tabIconPath&&!(o<100)){for(a of e.data.list)a.version=o,a.downloadlink=mainConfig.tabIconPath;log("tabSkinHandler success")}}catch{log("tabSkinHandler fail")}}function skinPreviewHandler(e){e.data.skin_info.status=1}function removeLuaScreenAds(e){if(e.cached_ad)for(var a of e.cached_ad.ads)a.start_date=1893254400,a.show_count=0,a.duration=0,a.end_date=1893340799;return e}function removePhpScreenAds(e){if(e.ads){e.show_push_splash_ad=!1,e.background_delay_display_time=0,e.lastAdShow_delay_display_time=0,e.realtime_ad_video_stall_time=0,e.realtime_ad_timeout_duration=0;for(var a of e.ads)a.displaytime=0,a.displayintervel=86400,a.allowdaydisplaynum=0,a.displaynum=0,a.displaytime=1,a.begintime="2029-12-30 00:00:00",a.endtime="2029-12-30 23:59:59"}return e}function log(e){mainConfig.isDebug}var body=$response.body,url=$request.url;let method=getModifyMethod(url);if(method){log(method);var func=eval(method);let data=JSON.parse(body.match(/\{.*\}/)[0]);new func(data),body=JSON.stringify(data),method=="removePhpScreenAds"&&(body=JSON.stringify(data)+"OK")}$done({body});
