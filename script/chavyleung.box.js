// Fri Aug 01 2025 21:23:42 GMT+0000 (Coordinated Universal Time) https://raw.githubusercontent.com/ElementRef/AboutConfig/main/script/chavyleung.box.js
const $=new Env("BoxJs"),$eval_env={};$.version="0.19.21";$.versionType="beta";$.isNeedRewrite=!0;$.KEY_usercfgs="chavy_boxjs_userCfgs";$.KEY_sessions="chavy_boxjs_sessions";$.KEY_web_cache="chavy_boxjs_web_cache";$.KEY_app_subCaches="chavy_boxjs_app_subCaches";$.KEY_globalBaks="chavy_boxjs_globalBaks";$.KEY_backups="chavy_boxjs_backups";$.KEY_cursessions="chavy_boxjs_cur_sessions";$.KEY_boxjs_host="boxjs_host";$.json=$.name;$.html=$.name;$.web=`https://cdn.jsdelivr.net/gh/chavyleung/scripts@${$.version}/box/chavy.boxjs.html?_=${new Date().getTime()}`;$.ver="https://raw.githubusercontent.com/chavyleung/scripts/master/box/release/box.release.json";(async()=>{$.isMute=[!0,"true"].includes($.getdata("@chavy_boxjs_userCfgs.isMute")),$.path=getPath($request.url);const[,t]=$.path.split("?");$.queries=t?t.split("&").reduce((a,i)=>{const[e,s]=i.split("=");return a[e]=s,a},{}):{},$.isGet=$request.method==="GET",$.isPost=$request.method==="POST",$.isOptions=$request.method==="OPTIONS",$.type="page",$.isQuery=$.isGet&&/^\/query\/.*?/.test($.path),$.isApi=$.isPost&&/^\/api\/.*?/.test($.path),$.isPage=$.isGet&&!$.isQuery&&!$.isApi,upgradeUserData(),upgradeGlobalBaks(),$.isOptions?($.type="options",await handleOptions()):$.isPage?($.type="page",await handlePage()):$.isQuery?($.type="query",await handleQuery()):$.isApi&&($.type="api",await handleApi())})().catch(t=>$.logErr(t)).finally(()=>doneBox());function getHost(t){return t.slice(0,t.indexOf("/",8))}function getPath(t){const a=t.lastIndexOf("/")===t.length-1?-1:void 0;return t.slice(t.indexOf("/",8),a)}async function handlePage(){const t=getBoxData();t.syscfgs.isDebugMode=!1;const a=[!0,"true"].includes($.getdata("@chavy_boxjs_userCfgs.isDebugWeb")),i=$.getdata("@chavy_boxjs_userCfgs.debugger_web"),e=$.getjson($.KEY_web_cache,null);if(!a&&e&&e.version===$.version)$.html=e.cache;else{if(a&&i){const n=i.includes("?");$.web=`${i}${n?"&":"?"}_=${new Date().getTime()}`,t.syscfgs.isDebugMode=!0}const o=()=>(t.syscfgs.isDebugMode=!1,$.getjson($.KEY_web_cache).cache);await $.http.get($.web).then(n=>{if(/<title>BoxJs<\/title>/.test(n.body)){$.html=n.body;const c={version:$.version,cache:$.html};$.setjson(c,$.KEY_web_cache)}else $.html=o()},()=>$.html=o())}const s=$.getdata("@chavy_boxjs_userCfgs.theme");s==="light"?$.html=$.html.replace("#121212","#fff"):s==="dark"&&($.html=$.html.replace("#fff","#121212")),$.html=$.html.replace("boxServerData: null","boxServerData:"+JSON.stringify(t)),a&&i&&($.html=$.html.replace("vue.min.js","vue.js"))}async function handleQuery(){const t=$request.headers.referer||$request.headers.Referer;if(!/^https?:\/\/(.+\.)?boxjs\.(com|net)\//.test(t)){if(![!0,"true"].includes($.getdata("@chavy_boxjs_userCfgs.isMuteQueryAlert"))){const e=$.isMute;$.isMute=!1,$.msg($.name,"\u2757\uFE0F\u53D1\u73B0\u6709\u811A\u672C\u6216\u4EBA\u6B63\u5728\u8BFB\u53D6\u4F60\u7684\u6570\u636E",["\u8BF7\u6CE8\u610F\u6570\u636E\u5B89\u5168, \u4F60\u53EF\u4EE5: ","1. \u5728 BoxJs \u7684\u811A\u672C\u65E5\u5FD7\u4E2D\u67E5\u770B\u8BE6\u60C5",'2. \u5728 BoxJs \u7684\u9875\u9762 (\u4FA7\u680F) \u4E2D "\u4E0D\u663E\u793A\u67E5\u8BE2\u8B66\u544A"'].join(`
`)),$.isMute=e}$.log(["","\u2757\uFE0F\u2757\uFE0F\u2757\uFE0F \u53D1\u73B0\u6709\u811A\u672C\u6216\u4EBA\u6B63\u5728\u8BFB\u53D6\u4F60\u7684\u6570\u636E \u2757\uFE0F\u2757\uFE0F\u2757\uFE0F",JSON.stringify($request),""].join(`
`))}const[,a]=$.path.split("/query");if(/^\/boxdata/.test(a))$.json=getBoxData();else if(/^\/baks/.test(a)){const[,i]=a.split("/baks/");$.json=$.getjson(i)}else if(/^\/versions$/.test(a))await getVersions(!0);else if(/^\/data/.test(a)){const[,i]=a.split("/data/");$.json={key:i,val:$.getdata(i)}}}async function handleApi(){const[,t]=$.path.split("/api"),a={"/save":apiSave,"/addAppSub":apiAddAppSub,"/deleteAppSub":apiDeleteAppSub,"/reloadAppSub":apiReloadAppSub,"/delGlobalBak":apiDelGlobalBak,"/updateGlobalBak":apiUpdateGlobalBak,"/saveGlobalBak":apiSaveGlobalBak,"/impGlobalBak":apiImpGlobalBak,"/revertGlobalBak":apiRevertGlobalBak,"/runScript":apiRunScript,"/saveData":apiSaveData,"/surge":apiSurge,"/update":apiUpdate};for(const[i,e]of Object.entries(a))if(t===i||t.startsWith(`${i}?`)){await e();break}}async function handleOptions(){}function getBoxData(){const t={};($.getdata(`${$.KEY_usercfgs.replace("#","@")}.gist_cache_key`)||[]).forEach(l=>{t[l]=$.getdata(l)});const i=getUserCfgs(),e=getAppSessions(),s=getCurSessions(),o=getSystemApps(),n=getSystemCfgs(),c=getAppSubCaches(),r=getGlobalBaks();return o.forEach(l=>{const u=getAppDatas(l);Object.assign(t,u)}),i.appsubs.forEach(l=>{const u=c[l.url];u&&u.apps&&Array.isArray(u.apps)&&u.apps.forEach(b=>{const p=getAppDatas(b);Object.assign(t,p)})}),{datas:t,usercfgs:i,sessions:e,curSessions:s,sysapps:o,syscfgs:n,appSubCaches:c,globalbaks:r}}function getSystemCfgs(){return{env:$.isStash()?"Stash":$.isShadowrocket()?"Shadowrocket":$.isLoon()?"Loon":$.isQuanX()?"QuanX":$.isSurge()?"Surge":"Node",version:$.version,versionType:$.versionType,envs:[{id:"Surge",icons:["https://raw.githubusercontent.com/Orz-3/mini/none/surge.png","https://raw.githubusercontent.com/Orz-3/mini/master/Color/surge.png"]},{id:"QuanX",icons:["https://raw.githubusercontent.com/Orz-3/mini/none/quanX.png","https://raw.githubusercontent.com/Orz-3/mini/master/Color/quantumultx.png"]},{id:"Loon",icons:["https://raw.githubusercontent.com/Orz-3/mini/none/loon.png","https://raw.githubusercontent.com/Orz-3/mini/master/Color/loon.png"]},{id:"Shadowrocket",icons:["https://raw.githubusercontent.com/Orz-3/mini/master/Alpha/shadowrocket.png","https://raw.githubusercontent.com/Orz-3/mini/master/Color/shadowrocket.png"]},{id:"Stash",icons:["https://raw.githubusercontent.com/Orz-3/mini/master/Alpha/stash.png","https://raw.githubusercontent.com/Orz-3/mini/master/Color/stash.png"]}],chavy:{id:"ChavyLeung",icon:"https://avatars3.githubusercontent.com/u/29748519",repo:"https://github.com/chavyleung/scripts"},senku:{id:"GideonSenku",icon:"https://avatars1.githubusercontent.com/u/39037656",repo:"https://github.com/GideonSenku"},id77:{id:"id77",icon:"https://avatars0.githubusercontent.com/u/9592236",repo:"https://github.com/id77"},orz3:{id:"Orz-3",icon:"https://raw.githubusercontent.com/Orz-3/mini/master/Color/Orz-3.png",repo:"https://github.com/Orz-3/"},boxjs:{id:"BoxJs",show:!1,icon:"https://raw.githubusercontent.com/Orz-3/mini/master/Color/box.png",icons:["https://raw.githubusercontent.com/Orz-3/mini/master/Alpha/box.png","https://raw.githubusercontent.com/Orz-3/mini/master/Color/box.png"],repo:"https://github.com/chavyleung/scripts"},defaultIcons:["https://raw.githubusercontent.com/Orz-3/mini/master/Alpha/appstore.png","https://raw.githubusercontent.com/Orz-3/mini/master/Color/appstore.png"]}}function getSystemApps(){return[{id:"BoxSetting",name:"\u504F\u597D\u8BBE\u7F6E",descs:["\u53EF\u624B\u52A8\u6267\u884C\u4E00\u4E9B\u62B9\u6389\u6570\u636E\u7684\u811A\u672C","\u53EF\u8BBE\u7F6E\u660E\u6697\u4E24\u79CD\u4E3B\u9898\u4E0B\u7684\u4E3B\u8272\u8C03","\u53EF\u8BBE\u7F6E\u58C1\u7EB8\u6E05\u5355"],keys:["@chavy_boxjs_userCfgs.httpapi","@chavy_boxjs_userCfgs.bgimg","@chavy_boxjs_userCfgs.http_backend","@chavy_boxjs_userCfgs.color_dark_primary","@chavy_boxjs_userCfgs.color_light_primary"],settings:[{id:"@chavy_boxjs_userCfgs.httpapis",name:"HTTP-API (Surge)",val:"",type:"textarea",placeholder:",examplekey@127.0.0.1:6166",autoGrow:!0,rows:2,persistentHint:!0,desc:"\u793A\u4F8B: ,examplekey@127.0.0.1:6166! \u6CE8\u610F: \u4EE5\u9017\u53F7\u5F00\u5934, \u9017\u53F7\u5206\u9694\u591A\u4E2A\u5730\u5740, \u53EF\u52A0\u56DE\u8F66"},{id:"@chavy_boxjs_userCfgs.httpapi_timeout",name:"HTTP-API Timeout (Surge)",val:20,type:"number",persistentHint:!0,desc:"\u5982\u679C\u811A\u672C\u4F5C\u8005\u6307\u5B9A\u4E86\u8D85\u65F6\u65F6\u95F4, \u4F1A\u4F18\u5148\u4F7F\u7528\u811A\u672C\u6307\u5B9A\u7684\u8D85\u65F6\u65F6\u95F4."},{id:"@chavy_boxjs_userCfgs.http_backend",name:"HTTP Backend (Quantumult X)",val:"",type:"text",placeholder:"http://127.0.0.1:9999",persistentHint:!0,desc:"\u793A\u4F8B: http://127.0.0.1:9999 ! \u6CE8\u610F: \u5FC5\u987B\u662F\u4EE5 http \u5F00\u5934\u7684\u5B8C\u6574\u8DEF\u5F84, \u4E0D\u80FD\u662F / \u7ED3\u5C3E"},{id:"@chavy_boxjs_userCfgs.debugger_webs",name:"\u8C03\u8BD5\u5730\u5740",val:"Dev\u4F53\u9A8C,https://raw.githubusercontent.com/chavyleung/scripts/boxjs.dev/box/chavy.boxjs.html",type:"textarea",placeholder:"\u6BCF\u884C\u4E00\u4E2A\u914D\u7F6E\uFF0C\u7528\u9017\u53F7\u5206\u5272\u6BCF\u4E2A\u914D\u7F6E\u7684\u540D\u5B57\u548C\u94FE\u63A5\uFF1A\u914D\u7F6E,url",persistentHint:!0,autoGrow:!0,rows:2,desc:"\u9017\u53F7\u5206\u9694\u540D\u5B57\u548C\u94FE\u63A5, \u56DE\u8F66\u5206\u9694\u591A\u4E2A\u5730\u5740"},{id:"@chavy_boxjs_userCfgs.bgimgs",name:"\u80CC\u666F\u56FE\u7247\u6E05\u5355",val:`\u65E0,
\u8DDF\u968F\u7CFB\u7EDF,\u8DDF\u968F\u7CFB\u7EDF
light,http://api.btstu.cn/sjbz/zsy.php
dark,https://uploadbeta.com/api/pictures/random
\u59B9\u5B50,http://api.btstu.cn/sjbz/zsy.php`,type:"textarea",placeholder:"\u65E0,{\u56DE\u8F66} \u8DDF\u968F\u7CFB\u7EDF,\u8DDF\u968F\u7CFB\u7EDF{\u56DE\u8F66} light,\u56FE\u7247\u5730\u5740{\u56DE\u8F66} dark,\u56FE\u7247\u5730\u5740{\u56DE\u8F66} \u59B9\u5B50,\u56FE\u7247\u5730\u5740",persistentHint:!0,autoGrow:!0,rows:2,desc:"\u9017\u53F7\u5206\u9694\u540D\u5B57\u548C\u94FE\u63A5, \u56DE\u8F66\u5206\u9694\u591A\u4E2A\u5730\u5740"},{id:"@chavy_boxjs_userCfgs.bgimg",name:"\u80CC\u666F\u56FE\u7247",val:"",type:"text",placeholder:"http://api.btstu.cn/sjbz/zsy.php",persistentHint:!0,desc:"\u8F93\u5165\u80CC\u666F\u56FE\u6807\u7684\u5728\u7EBF\u94FE\u63A5"},{id:"@chavy_boxjs_userCfgs.changeBgImgEnterDefault",name:"\u624B\u52BF\u8FDB\u5165\u58C1\u7EB8\u6A21\u5F0F\u9ED8\u8BA4\u80CC\u666F\u56FE\u7247",val:"",type:"text",placeholder:"\u586B\u5199\u4E0A\u9762\u80CC\u666F\u56FE\u7247\u6E05\u5355\u7684\u503C",persistentHint:!0,desc:""},{id:"@chavy_boxjs_userCfgs.changeBgImgOutDefault",name:"\u624B\u52BF\u9000\u51FA\u58C1\u7EB8\u6A21\u5F0F\u9ED8\u8BA4\u80CC\u666F\u56FE\u7247",val:"",type:"text",placeholder:"\u586B\u5199\u4E0A\u9762\u80CC\u666F\u56FE\u7247\u6E05\u5355\u7684\u503C",persistentHint:!0,desc:""},{id:"@chavy_boxjs_userCfgs.color_light_primary",name:"\u660E\u4EAE\u8272\u8C03",canvas:!0,val:"#F7BB0E",type:"colorpicker",desc:""},{id:"@chavy_boxjs_userCfgs.color_dark_primary",name:"\u6697\u9ED1\u8272\u8C03",canvas:!0,val:"#2196F3",type:"colorpicker",desc:""}],scripts:[{name:"\u62B9\u6389\uFF1A\u6240\u6709\u7F13\u5B58",script:"https://raw.githubusercontent.com/chavyleung/scripts/master/box/scripts/boxjs.revert.caches.js"},{name:"\u62B9\u6389\uFF1A\u6536\u85CF\u5E94\u7528",script:"https://raw.githubusercontent.com/chavyleung/scripts/master/box/scripts/boxjs.revert.usercfgs.favapps.js"},{name:"\u62B9\u6389\uFF1A\u7528\u6237\u504F\u597D",script:"https://raw.githubusercontent.com/chavyleung/scripts/master/box/scripts/boxjs.revert.usercfgs.js"},{name:"\u62B9\u6389\uFF1A\u6240\u6709\u4F1A\u8BDD",script:"https://raw.githubusercontent.com/chavyleung/scripts/master/box/scripts/boxjs.revert.usercfgs.sessions.js"},{name:"\u62B9\u6389\uFF1A\u6240\u6709\u5907\u4EFD",script:"https://raw.githubusercontent.com/chavyleung/scripts/master/box/scripts/boxjs.revert.baks.js"},{name:"\u62B9\u6389\uFF1ABoxJs (\u6CE8\u610F\u5907\u4EFD)",script:"https://raw.githubusercontent.com/chavyleung/scripts/master/box/scripts/boxjs.revert.boxjs.js"}],author:"@chavyleung",repo:"https://github.com/chavyleung/scripts/blob/master/box/switcher/box.switcher.js",icons:["https://raw.githubusercontent.com/chavyleung/scripts/master/box/icons/BoxSetting.mini.png","https://raw.githubusercontent.com/chavyleung/scripts/master/box/icons/BoxSetting.png"]},{id:"BoxSwitcher",name:"\u4F1A\u8BDD\u5207\u6362",desc:`\u6253\u5F00\u9759\u9ED8\u8FD0\u884C\u540E, \u5207\u6362\u4F1A\u8BDD\u5C06\u4E0D\u518D\u53D1\u51FA\u7CFB\u7EDF\u901A\u77E5 
\u6CE8: \u4E0D\u5F71\u54CD\u65E5\u5FD7\u8BB0\u5F55`,keys:[],settings:[{id:"CFG_BoxSwitcher_isSilent",name:"\u9759\u9ED8\u8FD0\u884C",val:!1,type:"boolean",desc:"\u5207\u6362\u4F1A\u8BDD\u65F6\u4E0D\u53D1\u51FA\u7CFB\u7EDF\u901A\u77E5!"}],author:"@chavyleung",repo:"https://github.com/chavyleung/scripts/blob/master/box/switcher/box.switcher.js",icons:["https://raw.githubusercontent.com/chavyleung/scripts/master/box/icons/BoxSwitcher.mini.png","https://raw.githubusercontent.com/chavyleung/scripts/master/box/icons/BoxSwitcher.png"],script:"https://raw.githubusercontent.com/chavyleung/scripts/master/box/switcher/box.switcher.js"},{id:"BoxGist",name:"Gist\u5907\u4EFD",keys:["@gist.token","@gist.username","@gist.split","@gist.revision_options","@gist.backup_type"],author:"@dompling",repo:"https://github.com/dompling/Script/tree/master/gist",icons:["https://raw.githubusercontent.com/Former-Years/icon/master/github-bf.png","https://raw.githubusercontent.com/Former-Years/icon/master/github-bf.png"],descs_html:["<h2>Token\u7684\u83B7\u53D6\u65B9\u5F0F</h2>","<ol>\u5934\u50CF\u83DC\u5355 -></ol>","<ol>Settings -></ol>","<ol>Developer settings -></ol>","<ol>Personal access tokens -></ol>","<ol>Generate new token -></ol>","<ol>\u5728\u91CC\u9762\u627E\u5230 gist \u52FE\u9009\u63D0\u4EA4</ol>","<h2>Gist Revision Id</h2>","<ol>\u6253\u5F00Gist\u9879\u76EE</ol>","<ol>\u9ED8\u8BA4\u4E3ACode\uFF0C\u9009\u62E9Revisions</ol>","<ol>\u627E\u5230\u9700\u8981\u6062\u590D\u7684\u7248\u672C\u6587\u4EF6</ol>","<ol>\u70B9\u51FB\u53F3\u4E0A\u89D2\u3010...\u3011>\u3010View file\u3011</ol>","<ol>\u6D4F\u89C8\u5668\u5730\u5740\u6700\u540E\u4E00\u4E32\u4E3A RevisionId</ol>"],scripts:[{name:"\u5907\u4EFD Gist",script:"https://raw.githubusercontent.com/dompling/Script/master/gist/backup.js"},{name:"\u4ECE Gist \u6062\u590D",script:"https://raw.githubusercontent.com/dompling/Script/master/gist/restore.js"},{name:"\u66F4\u65B0\u5386\u53F2\u7248\u672C",script:"https://raw.githubusercontent.com/dompling/Script/master/gist/commit.js"}],settings:[{id:"@gist.split",name:"\u7528\u6237\u6570\u636E\u5206\u6BB5",val:null,type:"number",placeholder:"\u7528\u6237\u6570\u636E\u8FC7\u5927\u65F6\uFF0C\u8BF7\u8FDB\u884C\u62C6\u5206\u9632\u6B62\u5185\u5B58\u8B66\u544A\u26A0\uFE0F",desc:"\u503C\u4E3A\u6570\u5B57\uFF0C\u62C6\u5206\u6BB5\u6570\u6BD4\u5982 2 \u5C31\u62C6\u5206\u6210\u4E24\u4E2A datas."},{id:"@gist.revision_id",type:"modalSelects",name:"\u5386\u53F2\u7248\u672CRevisionId",desc:"\u4E0D\u586B\u5199\u65F6\uFF0C\u9ED8\u8BA4\u83B7\u53D6\u6700\u65B0\uFF0C\u6062\u590D\u540E\u4F1A\u81EA\u52A8\u6E05\u7A7A\u3002\u9009\u62E9\u65E0\u5185\u5BB9\u65F6\uFF0C\u8BF7\u8FD0\u884C\u4E0A\u65B9\u66F4\u65B0\u5386\u53F2\u7248\u672C",items:"@gist.revision_options"},{id:"@gist.backup_type",name:"\u5907\u4EFD/\u6062\u590D\u5185\u5BB9",val:"usercfgs,datas,sessions,curSessions,backups,appSubCaches",type:"checkboxes",items:[{key:"usercfgs",label:"\u7528\u6237\u504F\u597D"},{key:"datas",label:"\u7528\u6237\u6570\u636E"},{key:"sessions",label:"\u5E94\u7528\u4F1A\u8BDD"},{key:"curSessions",label:"\u5F53\u524D\u4F1A\u8BDD"},{key:"backups",label:"\u5907\u4EFD\u7D22\u5F15"},{key:"appSubCaches",label:"\u5E94\u7528\u8BA2\u9605\u7F13\u5B58"}]},{id:"@gist.username",name:"\u7528\u6237\u540D",val:null,type:"text",placeholder:"github \u7528\u6237\u540D",desc:"\u5FC5\u586B"},{id:"@gist.token",name:"Personal access tokens",val:null,type:"text",placeholder:"github personal access tokens",desc:"\u5FC5\u586B"}]}]}function getUserCfgs(){const a=Object.assign({gist_cache_key:[],favapps:[],appsubs:[],viewkeys:[],isPinedSearchBar:!0,httpapi:"examplekey@127.0.0.1:6166",http_backend:""},$.getjson($.KEY_usercfgs,{}));return a.appsubs.includes(null)&&(a.appsubs=a.appsubs.filter(i=>i),$.setjson(a,$.KEY_usercfgs)),a}function getAppSubCaches(){return $.getjson($.KEY_app_subCaches,{})}function getGlobalBaks(){let t=$.getjson($.KEY_backups,[]);return t.includes(null)&&(t=t.filter(a=>a),$.setjson(t,$.KEY_backups)),t}function getVersions(){return $.http.get($.ver).then(t=>{try{$.json=$.toObj(t.body)}catch{$.json={}}},()=>$.json={})}function getAppSessions(){return $.getjson($.KEY_sessions,[])||[]}function getCurSessions(){return $.getjson($.KEY_cursessions,{})||{}}function getAppDatas(t){const a={},i=[null,void 0,"null","undefined"];return t.keys&&Array.isArray(t.keys)&&t.keys.forEach(e=>{const s=$.getdata(e);a[e]=i.includes(s)?null:s}),t.settings&&Array.isArray(t.settings)&&t.settings.forEach(e=>{const s=e.id,o=$.getdata(s);a[s]=i.includes(o)?null:o,e.type==="boolean"?e.val=i.includes(o)?e.val:o==="true"||o===!0:e.type==="int"?e.val=o*1||e.val:e.type==="checkboxes"?!i.includes(o)&&typeof o=="string"?e.val=o?o.split(","):[]:e.val=Array.isArray(e.val)?e.val:e.val.split(","):e.val=o||e.val,e.type==="modalSelects"&&(e.items=a?.[e.items]||[])}),a}function dealKey(t){const[a,i]=t.split(".");if(a&&a.indexOf("@")>-1&&i!==void 0){const e=a.replace("@",""),s=JSON.parse($.getdata(e));Array.isArray(s)&&i<=s.length-1&&(s.splice(i,1),$.setdata(JSON.stringify(s),e))}}async function apiSave(){const t=$.toObj($request.body);Array.isArray(t)?t.forEach(i=>{i.val===null?dealKey(i.key):$.setdata(i.val,i.key)}):t.val===null?dealKey(t.key):$.setdata(t.val,t.key);const a=$.queries.appid;a&&updateCurSesssions(a,t),$.json=getBoxData()}async function apiUpdate(){const t=$.toObj($request.body),a=t.path.split("."),i=t.val,e=a.shift();if(t.val&&a.join("."))switch(e){case"usercfgs":const s=getUserCfgs();update(s,a.join("."),i),$.setjson(s,$.KEY_usercfgs);break;default:break}$.json=getBoxData()}async function apiAddAppSub(){const t=$.toObj($request.body),a=getUserCfgs();a.appsubs.push(t),$.setjson(a,$.KEY_usercfgs),await reloadAppSubCache(t.url),$.json=getBoxData()}async function apiDeleteAppSub(){const t=$.toObj($request.body),a=getUserCfgs();a.appsubs=a.appsubs.filter(i=>i.url!==t.url),$.setjson(a,$.KEY_usercfgs),$.json=getBoxData()}async function apiReloadAppSub(){const t=$.toObj($request.body);t?await reloadAppSubCache(t.url):await reloadAppSubCaches(),$.json=getBoxData()}async function apiDelGlobalBak(){const t=$.toObj($request.body),a=$.getjson($.KEY_backups,[]),i=a.findIndex(e=>e.id===t.id);i>-1&&(a.splice(i,1),$.setdata("",t.id),$.setjson(a,$.KEY_backups)),$.json=getBoxData()}async function apiUpdateGlobalBak(){const{id:t,name:a}=$.toObj($request.body),i=$.getjson($.KEY_backups,[]),e=i.find(s=>s.id===t);e&&(e.name=a,$.setjson(i,$.KEY_backups)),$.json=getBoxData()}async function apiRevertGlobalBak(){const{id:t}=$.toObj($request.body),a=$.getjson(t);if(a){const{chavy_boxjs_sysCfgs:e,chavy_boxjs_sysApps:s,chavy_boxjs_sessions:o,chavy_boxjs_userCfgs:n,chavy_boxjs_cur_sessions:c,chavy_boxjs_app_subCaches:r,...h}=a;$.setdata(JSON.stringify(o),$.KEY_sessions),$.setdata(JSON.stringify(n),$.KEY_usercfgs),$.setdata(JSON.stringify(c),$.KEY_cursessions),$.setdata(JSON.stringify(r),$.KEY_app_subCaches);const l=u=>[void 0,null,"null","undefined",""].includes(u);Object.keys(h).forEach(u=>$.setdata(l(h[u])?"":`${h[u]}`,u))}const i=getBoxData();$.json=i}async function apiSaveGlobalBak(){const t=$.getjson($.KEY_backups,[]),a=getBoxData(),i=$.toObj($request.body),e={};e.chavy_boxjs_userCfgs=a.usercfgs,e.chavy_boxjs_sessions=a.sessions,e.chavy_boxjs_cur_sessions=a.curSessions,e.chavy_boxjs_app_subCaches=a.appSubCaches,Object.assign(e,a.datas),t.push(i),$.setjson(t,$.KEY_backups),$.setjson(e,i.id),$.json=getBoxData()}async function apiImpGlobalBak(){const t=$.getjson($.KEY_backups,[]),a=$.toObj($request.body),i=a.bak;delete a.bak,t.push(a),$.setjson(t,$.KEY_backups),$.setjson(i,a.id),$.json=getBoxData()}async function apiRunScript(){$.isMute=!1;const opts=$.toObj($request.body),httpapi=$.getdata("@chavy_boxjs_userCfgs.httpapi"),ishttpapi=/.*?@.*?:[0-9]+/.test(httpapi);let script_text=null;if(opts.isRemote?await $.getScript(opts.url).then(t=>script_text=t):script_text=opts.script,opts.argument&&(script_text=`globalThis.$argument=\`${opts.argument}\`;${script_text}`),$.isSurge()&&!$.isLoon()&&!$.isShadowrocket()&&!$.isStash()&&ishttpapi){const t={timeout:opts.timeout};await $.runScript(script_text,t).then(a=>$.json=JSON.parse(a))}else{const result=await new Promise(resolve=>{$eval_env.resolve=resolve,$eval_env.request=$request,$request=void 0,$eval_env.cached_logs=[],console.cloned_log=console.log,console.log=t=>{$eval_env.cached_logs.push(t)},script_text=script_text.replace(/\$done/g,"$eval_env.resolve"),script_text=script_text.replace(/\$\.done/g,"$eval_env.resolve");try{eval(script_text)}catch(t){$eval_env.cached_logs.push(t),resolve()}});console.log=console.cloned_log,$request=$eval_env.request,$.json={result,output:$eval_env.cached_logs.join(`
`)}}}async function apiSurge(){const t=$.toObj($request.body),a=$.getdata("@chavy_boxjs_userCfgs.httpapi"),i=/.*?@.*?:[0-9]+/.test(a);if($.isSurge()&&!$.isLoon()&&!$.isShadowrocket()&&!$.isStash()&&i){const[e,s]=a.split("@");t.url=`http://${s}/${t.url}`,t.headers={"X-Key":e,Accept:"application/json, text/plain, */*"},await new Promise(o=>{$[t.method.toLowerCase()](t,(n,c,r)=>{$.json=JSON.parse(r),o($.json)})})}}async function apiSaveData(){const{key:t,val:a}=$.toObj($request.body);$.setdata(a,t),$.json={key:t,val:$.getdata(t)}}function reloadAppSubCache(t){const a=`${t}${t.includes("?")?"&":"?"}_=${new Date().getTime()}`;return $.http.get(a).then(i=>{try{const e=getAppSubCaches();e[t]=$.toObj(i.body),e[t].updateTime=new Date,Object.keys(e).forEach(s=>{e[s].hasOwnProperty("id")||delete e[s]}),$.setjson(e,$.KEY_app_subCaches),$.log(`\u66F4\u65B0\u8BA2\u9605, \u6210\u529F! ${t}`)}catch(e){$.logErr(e),$.log(`\u66F4\u65B0\u8BA2\u9605, \u5931\u8D25! ${t}`)}})}function update(t,a,i){const e=a.split(".");let s=t;for(let o=0;o<e.length-1;o++)s[e[o]]||(s[e[o]]={}),s=s[e[o]];s[e[e.length-1]]=i}async function limitConcurrency(t,a){const i=[],e=[];for(const s of t){const o=s();i.push(o),e.length>=a&&await Promise.race(e),e.push(o),o.then(()=>{const n=e.indexOf(o);n!==-1&&e.splice(n,1)}).catch(()=>{const n=e.indexOf(o);n!==-1&&e.splice(n,1)})}return Promise.all(i)}async function reloadAppSubCaches(){$.msg($.name,"\u66F4\u65B0\u8BA2\u9605: \u5F00\u59CB!");const t=[];getUserCfgs().appsubs.forEach(s=>{t.push(()=>reloadAppSubCache(s.url))}),await limitConcurrency(t,20),$.log("\u5168\u90E8\u8BA2\u9605, \u5B8C\u6210!");const e=(new Date().getTime()-$.startTime)/1e3;$.msg($.name,`\u66F4\u65B0\u8BA2\u9605: \u5B8C\u6210! \u{1F55B} ${e} \u79D2`)}function upgradeUserData(){const t=getUserCfgs(),a=!!t.appsubCaches;a&&($.setjson(t.appsubCaches,$.KEY_app_subCaches),delete t.appsubCaches,t.appsubs.forEach(i=>{delete i._raw,delete i.apps,delete i.isErr,delete i.updateTime})),a&&$.setjson(t,$.KEY_usercfgs)}function upgradeGlobalBaks(){let t=$.getdata($.KEY_globalBaks),a=$.getjson($.KEY_backups,[]);const i=s=>[void 0,null,""].includes(s),e=s=>a.find(o=>o.id===s);i(t)||(t=JSON.parse(t),t.forEach(s=>{if(i(s)||i(s.bak)||e(s.id))return;const o=s.id,n=s.bak;delete s.bak,a.push(s),$.setjson(n,o)}),$.setjson(a,$.KEY_backups)),$.setdata("",$.KEY_globalBaks)}function updateCurSesssions(t,a){if(!t)return;const e=getCurSessions()[t];if(!e)return;const s=getAppSessions(),o=s.find(n=>n.id===e);o&&(o.datas=a,$.setjson(s,$.KEY_sessions))}function doneBox(){$.setdata(getHost($request.url),$.KEY_boxjs_host),$.isOptions?doneOptions():$.isPage?donePage():$.isQuery?doneQuery():$.isApi?doneApi():$.done()}function getBaseDoneHeaders(t={}){return Object.assign({"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST,GET,OPTIONS,PUT,DELETE","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept"},t)}function getHtmlDoneHeaders(){return getBaseDoneHeaders({"Content-Type":"text/html;charset=UTF-8"})}function getJsonDoneHeaders(){return getBaseDoneHeaders({"Content-Type":"application/json; charset=utf-8"})}function doneOptions(){const t=getBaseDoneHeaders();$.isQuanX()?$.done({headers:t}):$.done({response:{headers:t}})}function donePage(){const t=getHtmlDoneHeaders();$.isQuanX()?$.done({status:"HTTP/1.1 200",headers:t,body:$.html}):$.done({response:{status:200,headers:t,body:$.html}})}function doneQuery(){$.json=$.toStr($.json);const t=getJsonDoneHeaders();$.isQuanX()?$.done({status:"HTTP/1.1 200",headers:t,body:$.json}):$.done({response:{status:200,headers:t,body:$.json}})}function doneApi(){$.json=$.toStr($.json);const t=getJsonDoneHeaders();$.isQuanX()?$.done({status:"HTTP/1.1 200",headers:t,body:$.json}):$.done({response:{status:200,headers:t,body:$.json}})}function Env(t,a){class i{constructor(s){this.env=s}send(s,o="GET"){s=typeof s=="string"?{url:s}:s;let n=this.get;o==="POST"&&(n=this.post);const c=new Promise((r,h)=>{n.call(this,s,(l,u,b)=>{l?h(l):r(u)})});return s.timeout?((r,h=1e3)=>Promise.race([r,new Promise((l,u)=>{setTimeout(()=>{u(new Error("\u8BF7\u6C42\u8D85\u65F6"))},h)})]))(c,s.timeout):c}get(s){return this.send.call(this.env,s)}post(s){return this.send.call(this.env,s,"POST")}}return new class{constructor(e,s){this.logLevels={debug:0,info:1,warn:2,error:3},this.logLevelPrefixs={debug:"[DEBUG] ",info:"[INFO] ",warn:"[WARN] ",error:"[ERROR] "},this.logLevel="info",this.name=e,this.http=new i(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator=`
`,this.encoding="utf-8",this.startTime=new Date().getTime(),Object.assign(this,s),this.log("",`\u{1F514}${this.name}, \u5F00\u59CB!`)}getEnv(){return typeof $environment<"u"&&$environment["surge-version"]?"Surge":typeof $environment<"u"&&$environment["stash-version"]?"Stash":typeof module<"u"&&module.exports?"Node.js":typeof $task<"u"?"Quantumult X":typeof $loon<"u"?"Loon":typeof $rocket<"u"?"Shadowrocket":void 0}isNode(){return this.getEnv()==="Node.js"}isQuanX(){return this.getEnv()==="Quantumult X"}isSurge(){return this.getEnv()==="Surge"}isLoon(){return this.getEnv()==="Loon"}isShadowrocket(){return this.getEnv()==="Shadowrocket"}isStash(){return this.getEnv()==="Stash"}toObj(e,s=null){try{return JSON.parse(e)}catch{return s}}toStr(e,s=null,...o){try{return JSON.stringify(e,...o)}catch{return s}}getjson(e,s){let o=s;if(this.getdata(e))try{o=JSON.parse(this.getdata(e))}catch{}return o}setjson(e,s){try{return this.setdata(JSON.stringify(e),s)}catch{return!1}}getScript(e){return new Promise(s=>{this.get({url:e},(o,n,c)=>s(c))})}runScript(e,s){return new Promise(o=>{let n=this.getdata("@chavy_boxjs_userCfgs.httpapi");n=n&&n.replace(/\n/g,"").trim();let c=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");c=c?1*c:20,c=s&&s.timeout?s.timeout:c;const[r,h]=n.split("@"),l={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:e,mock_type:"cron",timeout:c},headers:{"X-Key":r,Accept:"*/*"},policy:"DIRECT",timeout:c};this.post(l,(u,b,p)=>o(p))}).catch(o=>this.logErr(o))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const e=this.path.resolve(this.dataFile),s=this.path.resolve(process.cwd(),this.dataFile),o=this.fs.existsSync(e),n=!o&&this.fs.existsSync(s);if(!o&&!n)return{};{const c=o?e:s;try{return JSON.parse(this.fs.readFileSync(c))}catch{return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const e=this.path.resolve(this.dataFile),s=this.path.resolve(process.cwd(),this.dataFile),o=this.fs.existsSync(e),n=!o&&this.fs.existsSync(s),c=JSON.stringify(this.data);o?this.fs.writeFileSync(e,c):n?this.fs.writeFileSync(s,c):this.fs.writeFileSync(e,c)}}lodash_get(e,s,o){const n=s.replace(/\[(\d+)\]/g,".$1").split(".");let c=e;for(const r of n)if(c=Object(c)[r],c===void 0)return o;return c}lodash_set(e,s,o){return Object(e)!==e||(Array.isArray(s)||(s=s.toString().match(/[^.[\]]+/g)||[]),s.slice(0,-1).reduce((n,c,r)=>Object(n[c])===n[c]?n[c]:n[c]=Math.abs(s[r+1])>>0==+s[r+1]?[]:{},e)[s[s.length-1]]=o),e}getdata(e){let s=this.getval(e);if(/^@/.test(e)){const[,o,n]=/^@(.*?)\.(.*?)$/.exec(e),c=o?this.getval(o):"";if(c)try{const r=JSON.parse(c);s=r?this.lodash_get(r,n,""):s}catch{s=""}}return s}setdata(e,s){let o=!1;if(/^@/.test(s)){const[,n,c]=/^@(.*?)\.(.*?)$/.exec(s),r=this.getval(n),h=n?r==="null"?null:r||"{}":"{}";try{const l=JSON.parse(h);this.lodash_set(l,c,e),o=this.setval(JSON.stringify(l),n)}catch{const u={};this.lodash_set(u,c,e),o=this.setval(JSON.stringify(u),n)}}else o=this.setval(e,s);return o}getval(e){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.read(e);case"Quantumult X":return $prefs.valueForKey(e);case"Node.js":return this.data=this.loaddata(),this.data[e];default:return this.data&&this.data[e]||null}}setval(e,s){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.write(e,s);case"Quantumult X":return $prefs.setValueForKey(e,s);case"Node.js":return this.data=this.loaddata(),this.data[s]=e,this.writedata(),!0;default:return this.data&&this.data[s]||null}}initGotEnv(e){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,e&&(e.headers=e.headers?e.headers:{},e&&(e.headers=e.headers?e.headers:{},e.headers.cookie===void 0&&e.headers.Cookie===void 0&&e.cookieJar===void 0&&(e.cookieJar=this.ckjar)))}get(e,s=()=>{}){switch(e.headers&&(delete e.headers["Content-Type"],delete e.headers["Content-Length"],delete e.headers["content-type"],delete e.headers["content-length"]),e.params&&(e.url+="?"+this.queryStr(e.params)),e.followRedirect===void 0||e.followRedirect||((this.isSurge()||this.isLoon())&&(e["auto-redirect"]=!1),this.isQuanX()&&(e.opts?e.opts.redirection=!1:e.opts={redirection:!1})),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(e.headers=e.headers||{},Object.assign(e.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(e,(n,c,r)=>{!n&&c&&(c.body=r,c.statusCode=c.status?c.status:c.statusCode,c.status=c.statusCode),s(n,c,r)});break;case"Quantumult X":this.isNeedRewrite&&(e.opts=e.opts||{},Object.assign(e.opts,{hints:!1})),$task.fetch(e).then(n=>{const{statusCode:c,statusCode:r,headers:h,body:l,bodyBytes:u}=n;s(null,{status:c,statusCode:r,headers:h,body:l,bodyBytes:u},l,u)},n=>s(n&&n.error||"UndefinedError"));break;case"Node.js":let o=require("iconv-lite");this.initGotEnv(e),this.got(e).on("redirect",(n,c)=>{try{if(n.headers["set-cookie"]){const r=n.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();r&&this.ckjar.setCookieSync(r,null),c.cookieJar=this.ckjar}}catch(r){this.logErr(r)}}).then(n=>{const{statusCode:c,statusCode:r,headers:h,rawBody:l}=n,u=o.decode(l,this.encoding);s(null,{status:c,statusCode:r,headers:h,rawBody:l,body:u},u)},n=>{const{message:c,response:r}=n;s(c,r,r&&o.decode(r.rawBody,this.encoding))});break}}post(e,s=()=>{}){const o=e.method?e.method.toLocaleLowerCase():"post";switch(e.body&&e.headers&&!e.headers["Content-Type"]&&!e.headers["content-type"]&&(e.headers["content-type"]="application/x-www-form-urlencoded"),e.headers&&(delete e.headers["Content-Length"],delete e.headers["content-length"]),e.followRedirect===void 0||e.followRedirect||((this.isSurge()||this.isLoon())&&(e["auto-redirect"]=!1),this.isQuanX()&&(e.opts?e.opts.redirection=!1:e.opts={redirection:!1})),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(e.headers=e.headers||{},Object.assign(e.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient[o](e,(h,l,u)=>{!h&&l&&(l.body=u,l.statusCode=l.status?l.status:l.statusCode,l.status=l.statusCode),s(h,l,u)});break;case"Quantumult X":e.method=o,this.isNeedRewrite&&(e.opts=e.opts||{},Object.assign(e.opts,{hints:!1})),$task.fetch(e).then(h=>{const{statusCode:l,statusCode:u,headers:b,body:p,bodyBytes:d}=h;s(null,{status:l,statusCode:u,headers:b,body:p,bodyBytes:d},p,d)},h=>s(h&&h.error||"UndefinedError"));break;case"Node.js":let n=require("iconv-lite");this.initGotEnv(e);const{url:c,...r}=e;this.got[o](c,r).then(h=>{const{statusCode:l,statusCode:u,headers:b,rawBody:p}=h,d=n.decode(p,this.encoding);s(null,{status:l,statusCode:u,headers:b,rawBody:p,body:d},d)},h=>{const{message:l,response:u}=h;s(l,u,u&&n.decode(u.rawBody,this.encoding))});break}}time(e,s=null){const o=s?new Date(s):new Date;let n={"M+":o.getMonth()+1,"d+":o.getDate(),"H+":o.getHours(),"m+":o.getMinutes(),"s+":o.getSeconds(),"q+":Math.floor((o.getMonth()+3)/3),S:o.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(o.getFullYear()+"").substr(4-RegExp.$1.length)));for(let c in n)new RegExp("("+c+")").test(e)&&(e=e.replace(RegExp.$1,RegExp.$1.length==1?n[c]:("00"+n[c]).substr((""+n[c]).length)));return e}queryStr(e){let s="";for(const o in e){let n=e[o];n!=null&&n!==""&&(typeof n=="object"&&(n=JSON.stringify(n)),s+=`${o}=${n}&`)}return s=s.substring(0,s.length-1),s}msg(e=t,s="",o="",n={}){const c=r=>{const{$open:h,$copy:l,$media:u,$mediaMime:b}=r;switch(typeof r){case void 0:return r;case"string":switch(this.getEnv()){case"Surge":case"Stash":default:return{url:r};case"Loon":case"Shadowrocket":return r;case"Quantumult X":return{"open-url":r};case"Node.js":return}case"object":switch(this.getEnv()){case"Surge":case"Stash":case"Shadowrocket":default:{const p={};let d=r.openUrl||r.url||r["open-url"]||h;d&&Object.assign(p,{action:"open-url",url:d});let g=r["update-pasteboard"]||r.updatePasteboard||l;if(g&&Object.assign(p,{action:"clipboard",text:g}),u){let f,y,v;if(u.startsWith("http"))f=u;else if(u.startsWith("data:")){const[_]=u.split(";"),[,m]=u.split(",");y=m,v=_.replace("data:","")}else y=u,v=(_=>{const m={JVBERi0:"application/pdf",R0lGODdh:"image/gif",R0lGODlh:"image/gif",iVBORw0KGgo:"image/png","/9j/":"image/jpg"};for(var j in m)if(_.indexOf(j)===0)return m[j];return null})(u);Object.assign(p,{"media-url":f,"media-base64":y,"media-base64-mime":b??v})}return Object.assign(p,{"auto-dismiss":r["auto-dismiss"],sound:r.sound}),p}case"Loon":{const p={};let d=r.openUrl||r.url||r["open-url"]||h;d&&Object.assign(p,{openUrl:d});let g=r.mediaUrl||r["media-url"];return u?.startsWith("http")&&(g=u),g&&Object.assign(p,{mediaUrl:g}),p}case"Quantumult X":{const p={};let d=r["open-url"]||r.url||r.openUrl||h;d&&Object.assign(p,{"open-url":d});let g=r["media-url"]||r.mediaUrl;u?.startsWith("http")&&(g=u),g&&Object.assign(p,{"media-url":g});let f=r["update-pasteboard"]||r.updatePasteboard||l;return f&&Object.assign(p,{"update-pasteboard":f}),p}case"Node.js":return}default:return}};if(!this.isMute)switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:$notification.post(e,s,o,c(n));break;case"Quantumult X":$notify(e,s,o,c(n));break;case"Node.js":break}if(!this.isMuteLog){let r=["","==============\u{1F4E3}\u7CFB\u7EDF\u901A\u77E5\u{1F4E3}=============="];r.push(e),s&&r.push(s),o&&r.push(o),this.logs=this.logs.concat(r)}}debug(...e){this.logLevels[this.logLevel]<=this.logLevels.debug&&(e.length>0&&(this.logs=[...this.logs,...e]))}info(...e){this.logLevels[this.logLevel]<=this.logLevels.info&&(e.length>0&&(this.logs=[...this.logs,...e]))}warn(...e){this.logLevels[this.logLevel]<=this.logLevels.warn&&(e.length>0&&(this.logs=[...this.logs,...e]))}error(...e){this.logLevels[this.logLevel]<=this.logLevels.error&&(e.length>0&&(this.logs=[...this.logs,...e]))}log(...e){e.length>0&&(this.logs=[...this.logs,...e])}logErr(e,s){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:this.log("",`\u2757\uFE0F${this.name}, \u9519\u8BEF!`,s,e);break;case"Node.js":this.log("",`\u2757\uFE0F${this.name}, \u9519\u8BEF!`,s,e.message!==void 0?e.message:e,e.stack);break}}wait(e){return new Promise(s=>setTimeout(s,e))}done(e={}){const s=(new Date().getTime()-this.startTime)/1e3;switch(this.log("",`\u{1F514}${this.name}, \u7ED3\u675F! \u{1F55B} ${s} \u79D2`),this.log(),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:$done(e);break;case"Node.js":process.exit(1)}}}(t,a)}
