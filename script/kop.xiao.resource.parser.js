// Thu Aug 07 2025 21:22:55 GMT+0000 (Coordinated Universal Time) https://raw.githubusercontent.com/ElementRef/AboutConfig/main/script/kop.xiao.resource.parser.js
let[link0,content0,subinfo]=[$resource.link,$resource.content,$resource.info],version=typeof $environment<"u"?Number($environment.version.split("build")[1]):0,Perror=0;const ADDRes="quantumult-x:///add-resource?remote-resource=url-encoded-json";var RLink0={filter_remote:[],rewrite_remote:[],server_remote:[]};const Field={filter:"filter_remote",rewrite:"rewrite_remote",server:"server_remote"},subtag=typeof $resource.tag<"u"?$resource.tag:"";content0=content0.indexOf("DOCTYPE html")!=-1&&link0.indexOf("github.com")!=-1?ToRaw(content0):content0;content0=link0.indexOf("nsloon.com/openloon/import?plugin=")!=-1?ToLink(link0):content0;var para=/^(http|https)\:\/\//.test(link0)?link0:content0.split(`
`)[0],para1=para.slice(para.indexOf("#")+1).replace(/\$type/g,"node_type_para_prefix").replace(/\$emoji/g,"node_emoji_flag_prefix").replace(/\$tag/g,"node_tag_prefix").replace(/\$index/g,"node_index_prefix"),mark0=para.indexOf("#")!=-1,Pinfo=mark0&&para1.indexOf("info=")!=-1?para1.split("info=")[1].split("&")[0]:0,ntf_flow=0;const Base64=new Base64Code,escapeRegExp=e=>e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");var link1=link0.split("#")[0];const qxpng="https://raw.githubusercontent.com/crossutility/Quantumult-X/master/quantumult-x.png",subinfo_link={"open-url":"https://t.me/QuanX_API","media-url":"https://shrtm.nu/ebAr"},subinfo_link1={"open-url":link1,"media-url":"https://shrtm.nu/uo13"},rwrite_link={"open-url":link1,"media-url":"https://shrtm.nu/x3o2"},rwhost_link={"open-url":link1,"media-url":"https://shrtm.nu/0n5J"},rule_link={"open-url":link1,"media-url":"https://shrtm.nu/cpHD"},nan_link={"open-url":link1,"media-url":qxpng},bug_link={"open-url":"https://t.me/Shawn_Parser_Bot","media-url":"https://shrtm.nu/obcB"},sub_link={"open-url":link1,"media-url":"https://shrtm.nu/ebAr"},update_link={"open-url":"https://apps.apple.com/us/app/quantumult-x/id1443988620","media-url":qxpng},plink0={"open-url":link0,"media-url":qxpng};version==0&&$notify(`\u26A0\uFE0F \u8BF7\u66F4\u65B0 Quantumult X \u81F3\u6700\u65B0\u5546\u5E97\u7248\u672C
`,"\u{1F6A6} \u5F53\u524D\u7248\u672C\u53EF\u80FD\u65E0\u6CD5\u6B63\u5E38\u4F7F\u7528\u90E8\u5206\u529F\u80FD",`
\u{1F449} \u70B9\u51FB\u8DF3\u8F6C\u5546\u5E97\u94FE\u63A5\u66F4\u65B0`,update_link);SubFlow();var Pin0=mark0&&para1.indexOf("in=")!=-1?para1.split("in=")[1].split("&")[0].split("+").map(decodeURIComponent):null,Pout0=mark0&&(para.indexOf("#out=")!=-1||para.indexOf("&out=")!=-1)?(para.indexOf("#out=")!=-1?para.split("#out="):para.split("&out="))[1].split("&")[0].split("+").map(decodeURIComponent):null,Psfilter=mark0&&para1.indexOf("sfilter=")!=-1?Base64.decode(para1.split("sfilter=")[1].split("&")[0]):null,Preg=mark0&&para1.indexOf("regex=")!=-1?decodeURIComponent(para1.split("regex=")[1].split("&")[0]).replace(/\，/g,","):null,Pregout=mark0&&para1.indexOf("regout=")!=-1?decodeURIComponent(para1.split("regout=")[1].split("&")[0]).replace(/\，/g,","):null,Pregdel=mark0&&para1.indexOf("delreg=")!=-1?decodeURIComponent(para1.split("delreg=")[1].split("&")[0]).replace(/\，/g,","):null,Phin0=mark0&&para1.indexOf("inhn=")!=-1?para1.split("inhn=")[1].split("&")[0].split("+").map(decodeURIComponent):null,Phout0=mark0&&para1.indexOf("outhn=")!=-1?para1.split("outhn=")[1].split("&")[0].split("+").map(decodeURIComponent):null,Preplace=mark0&&para1.indexOf("replace=")!=-1?para1.split("replace=")[1].split("&")[0]:null,Pemoji=mark0&&para1.indexOf("emoji=")!=-1?para1.split("emoji=")[1].split("&")[0]:null,Pdbg=mark0&&para1.indexOf("dbg=")!=-1?para1.split("dbg=")[1].split("&")[0]:null,Pudp0=mark0&&para1.indexOf("udp=")!=-1?para1.split("udp=")[1].split("&")[0]:0,Ptfo0=mark0&&para1.indexOf("tfo=")!=-1?para1.split("tfo=")[1].split("&")[0]:0,Prname=mark0&&/(^|\&)rename=/.test(para1)?para1.split(/(^|\&)rename\=/)[2].split("&")[0].split("+"):null,Psrename=mark0&&para1.indexOf("srename=")!=-1?Base64.decode(para1.split("srename=")[1].split("&")[0]):null,Prrname=mark0&&para1.indexOf("rrname=")!=-1?para1.split("rrname=")[1].split("&")[0].split("+"):null,Psuffix=mark0&&para1.indexOf("suffix=")!=-1?para1.split("suffix=")[1].split("&")[0]:0,Ppolicy=mark0&&para1.indexOf("policy=")!=-1?decodeURIComponent(para1.split("policy=")[1].split("&")[0]):"Shawn",Ppolicyset=mark0&&para1.indexOf("pset=")!=-1?decodeURIComponent(para1.split("pset=")[1].split("&")[0]):"",Pcert0=mark0&&para1.indexOf("cert=")!=-1?para1.split("cert=")[1].split("&")[0]:0,Psort0=mark0&&para1.indexOf("sort=")!=-1?para1.split("sort=")[1].split("&")[0]:0,PsortX=mark0&&para1.indexOf("sortx=")!=-1?para1.split("sortx=")[1].split("&")[0]:0,PTls13=mark0&&para1.indexOf("tls13=")!=-1?para1.split("tls13=")[1].split("&")[0]:0,Pntf0=mark0&&para1.indexOf("ntf=")!=-1?para1.split("ntf=")[1].split("&")[0]:2,Phide=mark0&&para1.indexOf("hide=")!=-1?para1.split("hide=")[1].split("&")[0]:1,Pb64=mark0&&para1.indexOf("b64=")!=-1?para1.split("b64=")[1].split("&")[0]:0,emojino=[" 0\uFE0F\u20E3 "," 1\u20E3\uFE0F "," 2\u20E3\uFE0F "," 3\u20E3\uFE0F "," 4\u20E3\uFE0F "," 5\u20E3\uFE0F "," 6\u20E3\uFE0F "," 7\u20E3\uFE0F "," 8\u20E3\uFE0F "," 9\u20E3\uFE0F "," \u{1F51F} "],pfi=mark0&&Pin0?"in="+Pin0.join(", ")+",  ":"",pfo=mark0&&Pout0?"out="+Pout0.join(", "):"",pfihn=mark0&&Phin0?"inhn="+Phin0.join(", ")+",  ":"",pfohn=mark0&&Phout0?"outhn="+Phout0.join(", "):"",Pcnt=mark0&&para1.indexOf("cnt=")!=-1?para1.split("cnt=")[1].split("&")[0]:0,Pcap=mark0&&para1.indexOf("cap=")!=-1?para1.split("cap=")[1].split("&")[0]:"",Pptn=mark0&&para1.indexOf("ptn=")!=-1?para1.split("ptn=")[1].split("&")[0]:"",Pnptn=mark0&&para1.indexOf("npt=")!=-1?para1.split("npt=")[1].split("&")[0]:"",Pcdn=mark0&&para1.indexOf("cdn=")!=-1?para1.split("cdn=")[1].split("&")[0]:"";let[flow,exptime,errornode,total]="";var Pdel=mark0&&para1.indexOf("del=")!=-1?para1.split("del=")[1].split("&")[0]:0,typeU=mark0&&para1.indexOf("type=")!=-1?para1.split("type=")[1].split("&")[0]:"",Pfcr=mark0&&para1.indexOf("fcr=")!=-1?para1.split("fcr=")[1].split("&")[0]:"",Pvia=mark0&&para1.indexOf("via=")!=-1?para1.split("via=")[1].split("&")[0]:"",Paead=mark0&&para1.indexOf("aead=")!=-1?para1.split("aead=")[1].split("&")[0]:"",Phost=mark0&&(para.indexOf("#host=")!=-1||para.indexOf("&host=")!=-1)?(para.indexOf("#host=")!=-1?para.split("#host="):para.split("&host="))[1].split("&")[0]:"",Pcsha256=mark0&&para1.indexOf("csha=")!=-1&&version>=646?para1.split("csha=")[1].split("&")[0]:"",Ppsha256=mark0&&para1.indexOf("psha=")!=-1&&version>=646?para1.split("psha=")[1].split("&")[0]:"",typeQ=$resource.type?$resource.type:"unsupported",PRelay=mark0&&para1.indexOf("relay=")!=-1?decodeURIComponent(para1.split("relay=")[1].split("&")[0]):"",PUOT=mark0&&para1.indexOf("uot=")!=-1&&version>=665?para1.split("uot=")[1].split("&")[0]:"",PcheckU=mark0&&para1.indexOf("checkurl=")!=-1?decodeURIComponent(para1.split("checkurl=")[1].split("&")[0]):"";typeQ=PRelay!=""?"server":typeQ;var typec="",Pflow=mark0&&para1.indexOf("flow=")!=-1?para1.split("flow=")[1].split("&")[0]:0,PProfile=mark0&&para1.indexOf("profile=")!=-1?para1.split("profile=")[1].split("&")[0]:0,Palpn=mark0&&para1.indexOf("alpn=")!=-1&&version>=712?para1.split("alpn=")[1].split("&")[0]:"",Pobfs=mark0&&para1.indexOf("obfs=")!=-1&&version>=770?para1.split("obfs=")[1].split("&")[0]:"",Psession=mark0&&para1.indexOf("tsession=")!=-1&&version>=771?para1.split("tsession=")[1].split("&")[0]:"",Pmix=version>=844?1:0,Pjsonjq=version>=845?0:1,RegoutList=[],ADDres="quantumult-x:///add-resource?remote-resource=url-encoded-json",RLink=`{
  "server_remote": [
    sremoteposition
  ],
  "filter_remote": [
    fremoteposition
  ],
  "rewrite_remote": [
    rremoteposition
  ]
}`,ProfileInfo={server:"",filter:"",rewrite:""};function VCheck(e){return cnts=e.split(`
`).filter(Boolean).map(t=>t.trim()).filter(t=>/^http/.test(t)).map(t=>'"'+t+'"'),cnts=cnts.join(`,
`),cnts}function Profile_Handle(){let e=content0;PProfile=PProfile==1?"001":PProfile,PProfile=PProfile==8?"010":PProfile,PProfile=PProfile==9?"011":PProfile,srm=e.split("[server_remote]")[1]&&String(PProfile)[0]=="1"?VCheck(e.split("[server_remote]")[1].split("[")[0]):"",frm=e.split("[filter_remote]")[1]&&String(PProfile)[1]=="1"?VCheck(e.split("[filter_remote]")[1].split("[")[0]):"",rrm=e.split("[rewrite_remote]")[1]&&String(PProfile)[2]=="1"?VCheck(e.split("[rewrite_remote]")[1].split("[")[0]):"",RLink=RLink.replace("sremoteposition",srm).replace("fremoteposition",frm).replace("rremoteposition",rrm),ADDres=ADDres.replace("url-encoded-json",encodeURIComponent(RLink))}var Finfo={};if(Pflow!=0){Pflow=Pflow.split(":");var Bdate=Date.parse(new Date(Pflow[0]))/1e3,Btotal=Pflow[1]?Pflow[1]*1024*1024*1024:0,Bused=Pflow[2]?Pflow[2]*1024*1024*1024:0,Bremain=Btotal!=0?Btotal-Bused:1,BJson={bytes_used:Bused,bytes_remaining:Bremain,expire_date:Bdate};Finfo=BJson}var pat=[];pat[0]=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","k","r","s","t","u","v","w","x","y","z"];pat[1]=["\u{1F170}","\u{1F171}","\u{1F172}","\u{1F173}","\u{1F174}","\u{1F175}","\u{1F176}","\u{1F177}","\u{1F178}","\u{1F179}","\u{1F17A}","\u{1F17B}","\u{1F17C}","\u{1F17D}","\u{1F17E}","\u{1F17F}","\u{1F17A}","\u{1F181}","\u{1F182}","\u{1F183}","\u{1F184}","\u{1F185}","\u{1F186}","\u{1F187}","\u{1F188}","\u{1F189}"];pat[2]=["\u{1F130}","\u{1F131}","\u{1F132}","\u{1F133}","\u{1F134}","\u{1F135}","\u{1F136}","\u{1F137}","\u{1F138}","\u{1F139}","\u{1F13A}","\u{1F13B}","\u{1F13C}","\u{1F13D}","\u{1F13E}","\u{1F13F}","\u{1F13A}","\u{1F141}","\u{1F142}","\u{1F143}","\u{1F144}","\u{1F145}","\u{1F146}","\u{1F147}","\u{1F148}","\u{1F149}"];pat[3]=["\u{1D400}","\u{1D401}","\u{1D402}","\u{1D403}","\u{1D404}","\u{1D405}","\u{1D406}","\u{1D407}","\u{1D408}","\u{1D409}","\u{1D40A}","\u{1D40B}","\u{1D40C}","\u{1D40D}","\u{1D40E}","\u{1D40F}","\u{1D40A}","\u{1D411}","\u{1D412}","\u{1D413}","\u{1D414}","\u{1D415}","\u{1D416}","\u{1D417}","\u{1D418}","\u{1D419}"];pat[4]=["\u{1D5EE}","\u{1D5EF}","\u{1D5F0}","\u{1D5F1}","\u{1D5F2}","\u{1D5F3}","\u{1D5F4}","\u{1D5F5}","i","\u{1D5F7}","\u{1D5F8}","\u{1D5F9}","\u{1D5FA}","\u{1D5FB}","\u{1D5FC}","\u{1D5FD}","\u{1D5F8}","\u{1D5FF}","\u{1D600}","\u{1D42D}","\u{1D602}","\u{1D603}","\u{1D604}","\u{1D605}","\u{1D606}","\u{1D607}"];pat[5]=["\u{1D538}","\u{1D539}","\u2102","\u{1D53B}","\u{1D53C}","\u{1D53D}","\u{1D53E}","\u210D","\u{1D540}","\u{1D541}","\u{1D542}","\u{1D543}","\u{1D544}","\u2115","\u{1D546}","\u2119","\u{1D542}","\u211D","\u{1D54A}","\u{1D54B}","\u{1D54C}","\u{1D54D}","\u{1D54E}","\u{1D54F}","\u{1D550}","\u2124"];pat[6]=["\u{1D552}","\u{1D553}","\u{1D554}","\u{1D555}","\u{1D556}","\u{1D557}","\u{1D558}","\u{1D559}","\u{1D55A}","\u{1D55B}","\u{1D55C}","\u{1D55D}","\u{1D55E}","\u{1D55F}","\u{1D560}","\u{1D561}","\u{1D55C}","\u{1D563}","\u{1D564}","\u{1D565}","\u{1D566}","\u{1D567}","\u{1D568}","\u{1D569}","\u{1D56A}","\u{1D56B}"];pat[7]=["\u1D43","\u1D47","\u1D9C","\u1D48","\u1D49","\u1DA0","\u1D4D","\u02B0","\u2071","\u02B2","\u1D4F","\u02E1","\u1D50","\u207F","\u1D52","\u1D56","\u1D52\u20D2","\u02B3","\u02E2","\u1D57","\u1D58","\u1D5B","\u02B7","\u02E3","\u02B8","\u1646"];pat[8]=["\u1D2C","\u1D2E","\u14BC","\u1D30","\u1D31","\u1DA0","\u1D33","\u1D34","\u1D35","\u1D36","\u1D37","\u1D38","\u1D39","\u1D3A","\u1D3C","\u1D3E","\u1D3C\u0334","\u1D3F","\u02E2","\u1D40","\u1D41","\u1D5B","\u1D42","\u02E3","\u02B8","\u1646"];var patn=[];patn[0]=["0","1","2","3","4","5","6","7","8","9"];patn[1]=["\u24EA","\u2460","\u2461","\u2462","\u2463","\u2464","\u2465","\u2466","\u2467","\u2468"];patn[2]=["\u24EA","\u2776","\u2777","\u2778","\u2779","\u277A","\u277B","\u277C","\u277D","\u277E"];patn[3]=["\u24EA","\u24F5","\u24F6","\u24F7","\u24F8","\u24F9","\u24FA","\u24FC","\u24FB","\u24FD"];patn[4]=["\u{1D7D8}","\u{1D7D9}","\u{1D7DA}","\u{1D7DB}","\u{1D7DC}","\u{1D7DD}","\u{1D7DE}","\u{1D7DF}","\u{1D7E0}","\u{1D7E1}"];patn[5]=["\u2070","\xB9","\xB2","\xB3","\u2074","\u2075","\u2076","\u2077","\u2078","\u2079"];patn[6]=["\u2080","\u2081","\u2082","\u2083","\u2084","\u2085","\u2086","\u2087","\u2088","\u2089"];patn[7]=["\u{1D7CE}","\u{1D7CF}","\u{1D7D0}","\u{1D7D1}","\u{1D7D2}","\u{1D7D3}","\u{1D7D4}","\u{1D7F3}","\u{1D7D6}","\u{1D7D7}"];patn[8]=["\u{1D7F6}","\u{1D7F7}","\u{1D7F8}","\u{1D7F9}","\u{1D7FA}","\u{1D7FB}","\u{1D7FC}","\u{1D7FD}","\u{1D7FE}","\u{1D7FF}"];const getValue=(e,t)=>{try{return e()}catch{return t}};var type0="",flag=1;function Parser(){if(type0=Type_Check(content0),type0!="web"&&type0!="wrong-field"&&type0!="JS-0"&&type0!="wrong-link")try{Pdbg&&$notify(link0,type0,content0),total=ResourceParse()}catch(t){Perror==0&&$notify("\u274C \u89E3\u6790\u51FA\u73B0\u9519\u8BEF","\u26A0\uFE0F \u8BF7\u70B9\u51FB\u901A\u77E5\uFF0C\u53D1\u9001\u8BA2\u9605\u94FE\u63A5\u8FDB\u884C\u53CD\u9988",t,bug_link)}else if(type0=="wrong-field"){if(version>=670&&typec!=""){RLink0[Field[typec]].push($resource.link+", opt-parser=true, tag=\u4E0B\u6B21\u6DFB\u52A0\u8D44\u6E90\u{1F251}\uFE0F\u957F\u70B9\u2764\uFE0F8\u20E3\uFE0F");var e=ADDRes.replace(/url-encoded-json/,encodeURIComponent(JSON.stringify(RLink0)));const t={"open-url":e,"media-url":"https://shrtm.nu/obcB"};$notify("\u26A0\uFE0F \u8BF7\u70B9\u51FB\u901A\u77E5\u8DF3\u8F6C\u5C1D\u8BD5\u6DFB\u52A0\u5230\u6B63\u786E\u7C7B\u578B\u4E2D","\u274C \u68C0\u6D4B\u7C7B\u578B["+typec+"]\u4E0E\u586B\u5165\u7C7B\u578B["+typeQ+"]\u51B2\u7A81",`\u5982\u679C\u8DF3\u8F6C\u6DFB\u52A0\u4ECD\u65E7\u5931\u8D25\uFF0C\u8BF7\u53D1\u9001\u94FE\u63A5\u53CD\u9988\u89E3\u6790\u5668bot
`+$resource.link,t)}else $notify("\u274C \u68C0\u6D4B\u7C7B\u578B\u300C"+typec+" \u300D\u4E0E\u76EE\u6807\u7C7B\u578B \u300C"+typeQ+" \u300D\u51B2\u7A81","\u26A0\uFE0F \u8BF7\u81EA\u884C\u68C0\u67E5\u94FE\u63A5\u5185\u5BB9\uFF0C\u6216\u70B9\u51FB\u901A\u77E5\u53D1\u9001\u94FE\u63A5\u8FDB\u884C\u53CD\u9988",$resource.link,bug_link);total=""}else total="";$done({content:total})}if(typeof $resource<"u"&&PProfile==0)Parser(),$done({content:total,info:Finfo});else if(PProfile!=0){try{Profile_Handle()}catch(e){Perror==0&&$notify("\u274C \u89E3\u6790\u51FA\u73B0\u9519\u8BEF","\u26A0\uFE0F \u8BF7\u70B9\u51FB\u901A\u77E5\uFF0C\u53D1\u9001\u8BA2\u9605\u94FE\u63A5\u8FDB\u884C\u53CD\u9988",e,bug_link)}openlink={"open-url":ADDres},$notify("\u26A0\uFE0F\u8BF7\u5FFD\u7565\u62A5\u9519\u63D0\u793A, \u70B9\u51FB\u6B64\u901A\u77E5\u8DF3\u8F6C","\u6DFB\u52A0\u914D\u7F6E\u4E2D\u7684\u6709\u6548\u8FDC\u7A0B\u8D44\u6E90\u{1F447} ["+PProfile+"]",ADDres,openlink),total=ProfileInfo[typeQ],$done({content:total})}function ParseUnknown(e){try{e=JSON.parse(e),e&&$notify("\u26A0\uFE0F \u94FE\u63A5\u8FD4\u56DE\u5185\u5BB9\u5E76\u975E\u6709\u6548\u8BA2\u9605\u27E6"+subtag+"\u27E7","\u2049\uFE0F \u8BF7\u81EA\u884C\u68C0\u67E5\u539F\u59CB\u94FE\u63A5\uFF0C\u8FD4\u56DE\u5185\u5BB9 \u{1F447}\uFE0F\u{1F447}\uFE0F",JSON.stringify(e),bug_link)}catch{/error|block|invalid|support/.test(e.toLowerCase())?$notify("\u{1F4A2} \u27E6"+subtag+"\u27E7 \u8FD4\u56DE\u5185\u5BB9\u65E0\u6548","\u{1F620} \u8BF7\u81EA\u884C\u68C0\u67E5\u8BA2\u9605\uFF0C\u4E0D\u8981\u8DD1\u6765\u53CD\u9988",`\u8BA2\u9605\u8FD4\u56DE\u5185\u5BB9: \u{1F447} 
`+e,plink0):$notify("\u{1F62D} \u672A\u80FD\u8BC6\u522B\u8BA2\u9605 \u27E6"+subtag+"\u27E7 \u7684\u5185\u5BB9",`\u26A0\uFE0F \u5C06\u5C1D\u8BD5\u76F4\u63A5\u5BFC\u5165Quantumult X 
 \u5982\u8BA4\u4E3A\u662F BUG, \u8BF7\u70B9\u901A\u77E5\u8DF3\u8F6C\u5E76 [\u53D1\u9001\u94FE\u63A5] \u53CD\u9988`,`\u8BA2\u9605\u8FD4\u56DE\u5185\u5BB9: \u{1F447} 
`+e,bug_link)}}function ResourceParse(){if(type0=="Subs-B64Encode")Pdbg&&$notify("original content","node-b64",content0),total=Subs2QX(Base64.decode(content0),Pudp0,Ptfo0,Pcert0,PTls13);else if(type0=="Subs")total=Subs2QX(content0,Pudp0,Ptfo0,Pcert0,PTls13);else if(type0=="QuanX"||type0=="Clash"||type0=="Surge")total=Subs2QX(isQuanX(content0).join(`
`),Pudp0,Ptfo0,Pcert0,PTls13);else if(type0=="sgmodule")flag=2,total=Rewrite_Filter(isQuanXRewrite(content0.split(`
`)),Pin0,Pout0,Preg,Pregout),Preplace&&(total=ReplaceReg(total,Preplace)),total=total.filter((e,t)=>total.indexOf(e)==t),Pcdn?total=CDN(total):total=total.join(`
`);else if(type0=="rewrite")flag=2,total=Rewrite_Filter(isQuanXRewrite(content0.split(`
`)),Pin0,Pout0,Preg,Pregout),Preplace&&(total=ReplaceReg(total,Preplace)),total=total.filter((e,t)=>total.indexOf(e)==t),Pcdn?total=CDN(total):total=total.join(`
`);else if(type0=="Rule")flag=3,total=Rule_Handle(content0.split(`
`).map(e=>e.trim()).filter(Boolean),Pout0,Pin0).filter(Boolean),Preg&&total.length!=0&&(total=total.map(Regex).filter(Boolean),RegCheck(total,"\u5206\u6D41\u5F15\u7528","regex",Preg)),Pregout&&total.length!=0&&(total=total.map(RegexOut).filter(Boolean),RegCheck(total,"\u5206\u6D41\u5F15\u7528","regout",Pregout)),Preplace&&(total=ReplaceReg(total,Preplace)),Ppolicyset&&(total=policy_sets(total,Ppolicyset)),total=total.length<100?total.filter((e,t)=>total.indexOf(e)==t):total,total=total.join(`
`);else if(content0.trim()=="")$notify("\u203C\uFE0F \u5F15\u7528\u27E6"+subtag+"\u27E7 \u8FD4\u56DE\u5167\u5BB9\u4E3A\u7A7A","\u2049\uFE0F \u70B9\u901A\u77E5\u8DF3\u8F6C\u4EE5\u786E\u8BA4\u94FE\u63A5\u662F\u5426\u5931\u6548",para.split("#")[0],nan_link),flag=0;else if(type0=="sub-http"){let e=VCheck(Base64.decode(content0.split("sub://")[1].split("#")[0])+", opt-parser=true, tag="+new Date().getTime());RLink=RLink.replace("sremoteposition",e).replace("fremoteposition","").replace("rremoteposition","");let t=ADDres.replace("url-encoded-json",encodeURIComponent(RLink));openlink={"open-url":t},$notify("\u26A0\uFE0F \u8BE5\u94FE\u63A5\u4E3A\u8282\u70B9\u8BA2\u9605, \u8BF7\u70B9\u51FB\u6B64\u901A\u77E5\u8DF3\u8F6C\u6DFB\u52A0",e,t,openlink),flag=-1,total=""}else type0=="unknown"?(ParseUnknown(content0),flag=-1):type0=="profile"?(PProfile="111",Profile_Handle(),openlink={"open-url":ADDres},$notify("\u26A0\uFE0F \u8BE5\u94FE\u63A5\u4E3A\u5B8C\u6574\u914D\u7F6E\u6587\u4EF6, \u8BF7\u70B9\u51FB\u6B64\u901A\u77E5\u8DF3\u8F6C","\u6DFB\u52A0\u914D\u7F6E\u4E2D\u7684\u6709\u6548\u8FDC\u7A0B\u8D44\u6E90\u{1F447} ["+PProfile+"]",ADDres,openlink),flag=-1,total=""):type0=="JS-0"&&(total="");return flag==1?(total=isQuanX(total.filter(Boolean).join(`
`)),Pinfo==1&&ntf_flow==0&&flowcheck(total),(Pin0||Pout0)&&(total=Filter(total,Pin0,Pout0)),Preg&&(total=total.map(Regex).filter(Boolean),RegCheck(total,"\u8282\u70B9\u8BA2\u9605","regex",Preg)),Pregout&&(total=total.map(RegexOut).filter(Boolean),RegCheck(total,"\u8282\u70B9\u8BA2\u9605","regout",Pregout)),Psfilter&&(total=FilterScript(total,Psfilter)),Prrname&&(Prn=Prrname,total=total.map(Rename)),Pregdel&&(delreg=Pregdel,total=total.map(DelReg)),Psrename&&(total=RenameScript(total,Psrename)),Preplace&&(total=ReplaceReg(total,Preplace)),Prname&&(Prn=Prname,total=total.map(Rename),Pdbg==1&&$notify("rename","content",total)),Pemoji&&(total=emoji_handle(total,Pemoji)),total.length>0?((Psuffix==1||Psuffix==-1)&&(total=Psuffix==1?total.map(type_suffix):total.map(type_prefix)),total=total.map(type_handle).map(emoji_prefix_handle).map(tag_handle),Psort0&&(total=QXSort(total,Psort0)),total=para1.indexOf("node_index_prefix")!=-1?index_handle(total):total,total=TagCheck_QX(total).join(`
`),PUOT==1&&(total=total.split(`
`).map(UOT).join(`
`)),Pcnt==1&&$notify("\u27E6"+subtag+"\u27E7\u89E3\u6790\u540E\u6700\u7EC8\u8FD4\u56DE\u5185\u5BB9","\u8282\u70B9\u6570\u91CF: "+total.split(`
`).length,total),total=PRelay==""?Base64.encode(total):ServerRelay(total.split(`
`),PRelay),Pflow==1?$done({content:total,info:{bytes_used:3073741824,bytes_remaining:2147483648,expire_date:1854193966}}):$done({content:total})):(Perror==0&&$notify("\u2753\u2753 \u53CB\u60C5\u63D0\u793A \u279F \u27E6"+subtag+"\u27E7","\u26A0\uFE0F\u26A0\uFE0F \u89E3\u6790\u540E\u65E0\u6709\u6548\u5185\u5BB9","\u{1F6A5}\u{1F6A5} \u8BF7\u81EA\u884C\u68C0\u67E5\u76F8\u5173\u53C2\u6570, \u6216\u8005\u70B9\u51FB\u901A\u77E5\u8DF3\u8F6C\u5E76\u53D1\u9001\u94FE\u63A5\u53CD\u9988",bug_link),total=errornode,$done({content:errornode}))):flag==0?(total=errornode,$done({content:errornode})):flag==-1&&(total=content0,$done({content:content0})),Pcnt==1&&flag!=1&&$notify("\u89E3\u6790\u540E\u6700\u7EC8\u8FD4\u56DE\u5185\u5BB9","\u603B\u6570\u91CF\uFF1A "+total.split(`
`).length,total),total}function SubFlow(){if(Pinfo==1&&subinfo){var e=subinfo.replace(/ /g,"").toLowerCase(),t="\u603B\u6D41\u91CF: "+(parseFloat(e.split("total=")[1].split(",")[0])/1024**3).toFixed(2)+"GB",a="\u5DF2\u7528\u6D41\u91CF: "+((parseFloat(e.indexOf("upload")!=-1?e.split("upload=")[1].split(",")[0]:"0")+parseFloat(e.split("download=")[1].split(",")[0]))/1024**3).toFixed(2)+"GB",r="\u5269\u4F59\u6D41\u91CF: "+(parseFloat(e.split("total=")[1].split(",")[0])/1024**3-(parseFloat(e.indexOf("upload")!=-1?e.split("upload=")[1].split(",")[0]:"0")+parseFloat(e.split("download=")[1].split(",")[0]))/1024**3).toFixed(2)+"GB";if(e.indexOf("expire=")!=-1){var s=new Date(parseFloat(e.split("expire=")[1].split(",")[0])*1e3),o=s.getFullYear(),l=s.getMonth()+1<10?"0"+(s.getMonth()+1):s.getMonth()+1,n=s.getDate()<10?"0"+s.getDate():s.getDate();s="\u8FC7\u671F\u65F6\u95F4: "+o+"-"+l+"-"+n}else s="";var h=t+`
`+a+", "+r;ntf_flow=1,$notify("\u6D41\u91CF\u4FE1\u606F: \u27E6"+subtag+"\u27E7",s,h,subinfo_link)}}function flowcheck(e){for(var t=0;t<e.length;t++){var a=e[t],r=a.slice(a.indexOf("tag")),s=r.slice(r.indexOf("=")+1);a.indexOf("\u5269\u4F59\u6D41\u91CF")!=-1?flow=s:a.indexOf("\u671F\u65F6\u95F4")!=-1&&(exptime=s)}flow=flow||"\u26A0\uFE0F \u8BE5\u8BA2\u9605\u672A\u8FD4\u56DE\u4EFB\u4F55\u6D41\u91CF\u4FE1\u606F",exptime=exptime||"\u26A0\uFE0F \u8BE5\u8BA2\u9605\u672A\u8FD4\u56DE\u5957\u9910\u65F6\u95F4\u4FE1\u606F",flow!=""&&$notify("\u6D41\u91CF\u4FE1\u606F: \u27E6"+subtag+"\u27E7",flow,exptime,subinfo_link1)}function RegCheck(e,t,a,r){if(e.length==0)$notify("\u203C\uFE0F "+t+"  \u279F \u27E6"+subtag+"\u27E7","\u26D4\uFE0F \u7B5B\u9009\u6B63\u5219: "+a+"="+r,"\u26A0\uFE0F \u7B5B\u9009\u540E\u5269\u4F59\u9879\u4E3A 0\uFE0F\u20E3 , \u8BF7\u68C0\u67E5\u6B63\u5219\u53C2\u6570\u53CA\u539F\u59CB\u94FE\u63A5",nan_link);else if(t!="\u8282\u70B9\u8BA2\u9605"&&Pntf0!=0||t=="\u8282\u70B9\u8BA2\u9605"&&Pntf0==1){var s=e.length<=10?emojino[e.length]:e.length;$notify("\u{1F916} "+t+"  \u279F \u27E6"+subtag+"\u27E7","\u26D4\uFE0F \u7B5B\u9009\u6B63\u5219: "+a+"="+r,"\u26A0\uFE0F \u7B5B\u9009\u540E\u5269\u4F59\u4EE5\u4E0B"+s+`\u4E2A\u5339\u914D\u9879 
 \u2A37 `+e.join(`
 \u2A37 `),sub_link)}}function Type_Check(e){var t="unknown",a=["host,","-suffix,","domain,","-keyword,","ip-cidr,","ip-cidr6,","geoip,","user-agent,","ip6-cidr,","ip-asn"],r=["domain-set,"],s=["shadowsocks=","trojan=","vmess=","http=","socks5="],o=["=ss,","=vmess,","=trojan,","=http,","=custom,","=https,","=shadowsocks","=shadowsocksr","=sock5","=sock5-tls"],l=["proxies:"],n=["dm1lc3M","c3NyOi8v","CnNzOi8","dHJvamFu","c3M6Ly","c3NkOi8v","c2hhZG93","aHR0cDovLw","aHR0cHM6L","CnRyb2phbjo","aHR0cD0","aHR0cCA","U1RBVFVT"],h=[" url 302"," url 307"," url reject"," url script"," url req"," url res"," url echo"," url-and-header 302"," url-and-header 307"," url-and-header reject"," url-and-header script"," url-and-header req"," url-and-header res"," url-and-header echo"," url jsonjq"],m=["ss://","vmess://","ssr://","trojan://","ssd://",`
https://`,`
http://`,"socks://","ssocks://","vless://"],x=["[Script]","[Rule]","[URL Rewrite]","[Map Local]",`
http-r`,"script-path"],u=["[filter_local]","[filter_remote]","[server_local]","[server_remote]"],p="DOCTYPE html",v=e.replace(/ /g,"");const g=O=>v.toLowerCase().indexOf(O)!=-1,c=O=>v.toLowerCase().indexOf(O.toLowerCase())!=-1,w=O=>v.toLowerCase().indexOf(O.toLowerCase())!=-1,f=O=>v.toLowerCase().indexOf(O.toLowerCase())!=-1,d=O=>e.indexOf(O)!=-1,y=O=>e.indexOf(O)!=-1;var b=e.split(`
`);if((e.indexOf(p)!=-1||e.indexOf("doctype html")!=-1)&&link0.indexOf("github.com"==-1))$notify("\u203C\uFE0F \u8BE5\u94FE\u63A5\u8FD4\u56DE\u4E3A\u65E0\u6548\u7F51\u9875\u5185\u5BB9 \u279F \u27E6"+subtag+"\u27E7",`\u2049\uFE0F \u70B9\u901A\u77E5\u8DF3\u8F6C\u4EE5\u786E\u8BA4\u94FE\u63A5\u662F\u5426\u5931\u6548
`+link0,`\u8FD4\u56DE\u5185\u5BB9\u5982\u4E0B\u2B07\uFE0F\uFF1A
`+e,nan_link),t="web";else if(typeU=="nodes"&&typeQ=="server")t=typeQ=="unsupported"||typeQ=="server"?"Subs":"wrong-field";else if(l.some(c)||typeU=="clash")t=typeQ=="unsupported"||typeQ=="server"?"Clash":"wrong-field",typec="server",content0=Clash2QX(e);else if(((x.some(d)||para1.indexOf("dst=rewrite")!=-1)&&para1.indexOf("dst=filter")==-1&&e.indexOf("[Proxy]")==-1||typeU=="module")&&typeU!="nodes"&&typeU!="rule"&&typeQ!="filter")typec="rewrite",t=typeQ=="unsupported"||typeQ=="rewrite"?"sgmodule":"wrong-field";else if((/(^hostname|\nhostname)\s*\=/.test(v)||h.some(d))&&para1.indexOf("dst=filter")==-1&&v.indexOf("securehostname")==-1&&!/module|nodes|rule/.test(typeU)&&!(a.some(g)&&typeQ=="filter")&&!(typeQ!="rewrite"&&u.some(y)))typec="rewrite",t=typeQ=="unsupported"||typeQ=="rewrite"?"rewrite":"wrong-field";else if((a.some(g)&&e.indexOf(p)==-1||typeU=="rule"||para1.indexOf("dst=filter")!=-1)&&typeU!="nodes"&&!(typeQ=="server"&&(s.some(c)||o.some(c))))typec="filter",t=typeQ=="unsupported"||typeQ=="filter"?"Rule":"wrong-field";else if(typeU=="domain-set")typec="filter-domain-set",t=typeQ=="unsupported"||typeQ=="filter"?"Rule":"wrong-field",content0=Domain2Rule(content0);else if(typeQ=="filter"&&e.indexOf("payload:")==-1)typec="filter-list",t=typeQ=="unsupported"||typeQ=="filter"?"Rule":"wrong-field",content0=content0.split(`
`).map(rule_list_handle).join(`
`);else if(v.indexOf("sub://")==0)typec="sub-http",t="sub-http";else if(typeQ=="filter"&&e.indexOf("payload:")!=-1)typec="Clash-Provider",t=typeQ=="unsupported"||typeQ=="filter"?"Rule":"wrong-field";else if(b.length>=1&&m.some(f)&&!/\[(Proxy|filter_local)\]/.test(e))typec="server-uri",t=typeQ=="unsupported"||typeQ=="server"||typeQ=="uri"?"Subs":"wrong-field";else if(v.indexOf("tag=")!=-1&&s.some(c)&&!/\[(Proxy|filter_local)\]/.test(e)||typeU=="list")typec="server-quanx",t=typeQ=="unsupported"||typeQ=="server"||typeQ=="uri"?"Subs":"wrong-field";else if(e.indexOf("[Proxy]")!=-1)typec="server-surge",t=typeQ=="unsupported"||typeQ=="server"||typeQ=="uri"?"Surge":"wrong-field",content0=Surge2QX(content0).join(`
`);else if(o.some(c)&&!/\[(Proxy|filter_local)\]/.test(e)||typeU=="list")typec="server-surge",t=typeQ=="unsupported"||typeQ=="server"||typeQ=="uri"?"Subs":"wrong-field";else if(e.indexOf("[server_local]")!=-1&&s.some(c))typec="server-quanx",t=typeQ=="unsupported"||typeQ=="server"||typeQ=="uri"?"Subs":"wrong-field";else if(content0.indexOf("server")!=-1&&content0.indexOf("server_port")!=-1)typec="server-sip008",t=typeQ=="unsupported"||typeQ=="server"?"Subs":"wrong-field",content0=SIP2QuanX(content0);else if(n.some(w)){if(typec="server-b64",t=typeQ=="unsupported"||typeQ=="server"?"Subs-B64Encode":"wrong-field",content0.split(`
`).length>=2){let O=content0.split(`
`)[1];Pdbg&&$notify("local","node",`
tmp:
`+O),n.some(k=>O.toLowerCase().indexOf(k.toLowerCase())!=-1)&&(content0=O)}}else u.every(y)?(typec="profile",t="profile"):/\.js/.test(link0)?(Perror=1,$notify("\u26A0\uFE0F \u4F60\u5BFC\u5165\u7684\u94FE\u63A5\u5185\u5BB9\u4E3A JS \u811A\u672C","\u{1F6A5} \u811A\u672C\u5185\u672A\u6709\u91CD\u5199\u89C4\u5219\uFF0C\u65E0\u6CD5\u89E3\u6790\u4F7F\u7528",` \u8BF7\u26A0\uFE0F\u4E0D\u8981\u26A0\uFE0F\u8DD1\u6765\u89E3\u6790\u5668\u{1F916}\uFE0F\u53CD\u9988 
`+link0),t="JS-0"):typeQ=="server"&&e.length>100?(typec="server-b64-unknown",t=typeQ=="unsupported"||typeQ=="server"?"Subs-B64Encode":"wrong-field"):e=="wrong-link"&&(t="wrong-link");return typeU=="X"&&$notify("\u8BE5\u94FE\u63A5\u5224\u5B9A\u7C7B\u578B",t+" : "+typec,e),t}function TagCheck_QX(e){typefix={shadowsocks:["\u{1D42C}\u{1D42C}","\u{1D412}\u{1D412}","\u{1F162}\u{1F162}","\u{1F182}\u{1F182}","\u24E2\u24E2","\u{1F142}\u{1F142}","SS"],shadowsocksr:["\u{1D42C}\u{1D42C}\u{1D42B}","\u{1D412}\u{1D412}\u{1D411}","\u{1F162}\u{1F162}\u{1F161}","\u{1F182}\u{1F182}\u{1F181}","\u24E2\u24E2\u24E1","\u{1F142}\u{1F142}\u{1F141}","SSR"],vmess:["\u{1D42F}\u{1D426}\u{1D41E}\u{1D42C}\u{1D42C}","\u{1D415}\u{1D40C}\u{1D404}\u{1D412}\u{1D412}","\u{1F165}\u{1F15C}\u{1F154}\u{1F162}\u{1F162}","\u{1F185}\u{1F17C}\u{1F174}\u{1F182}\u{1F182}","\u24E5\u24DC\u24D4\u24E2\u24E2","\u{1F145}\u{1F13C}\u{1F134}\u{1F142}\u{1F142}","VMESS"],trojan:["\u{1D42D}\u{1D42B}\u{1D428}\u{1D423}\u{1D41A}\u{1D427}","\u{1D413}\u{1D411}\u{1D40E}\u{1D409}\u{1D400}\u{1D40D}","\u{1F163}\u{1F161}\u{1F15E}\u{1F159}\u{1F150}\u{1F15D}","\u{1F183}\u{1F181}\u{1F17E}\u{1F179}\u{1F170}\u{1F17D}","\u24E3\u24E1\u24DE\u24D9\u24D0\u24DD","\u{1F143}\u{1F141}\u{1F13E}\u{1F139}\u{1F130}\u{1F13D}","TROJAN"],http:["\u{1D421}\u{1D42D}\u{1D42D}\u{1D429}","\u{1D407}\u{1D413}\u{1D413}\u{1D40F}","\u{1F157}\u{1F163}\u{1F163}\u{1F15F}","\u{1F177}\u{1F183}\u{1F183}\u{1F17F}","\u24D7\u24E3\u24E3\u24DF","\u{1F137}\u{1F143}\u{1F143}\u{1F13F}","HTTP"],socks5:["\u{1D42C}\u{1D428}\u{1D5F0}\u{1D5F8}\u{1D42C}","\u{1D412}\u{1D40E}\u{1D402}\u{1D40A}\u{1D412}","\u{1F162}\u{1F15E}\u{1F152}\u{1F15A}\u{1F162}","\u{1F182}\u{1F17E}\u{1F172}\u{1F17A}\u{1F182}","\u24E2\u24C4\u24B8\u24C0\u24E2","\u{1F142}\u{1F13E}\u{1F132}\u{1F13A}\u{1F142}","SOCKS"],vless:["\u{1D42F}\u{1D425}\u{1D41E}\u{1D42C}\u{1D42C}","\u{1D415}\u{1D40B}\u{1D404}\u{1D412}\u{1D412}","\u{1F165}\u{1F15B}\u{1F154}\u{1F162}\u{1F162}","\u{1F185}\u{1F17B}\u{1F174}\u{1F182}\u{1F182}","\u24E5\u24DB\u24D4\u24E2\u24E2","\u{1F145}\u{1F13B}\u{1F134}\u{1F142}\u{1F142}","VLESS"]};for(var t=e.map(p=>p.trim()),[a,r]=[[],[]],[s,o]=[[],[]],l=0,n=0;n<t.length;n++){var h=t[n]?t[n]:"";if(typefix.shadowsocks=h.indexOf("ssr-protocol")!=-1?typefix.shadowsocksr:typefix.shadowsocks,h.replace(/ /gm,"").indexOf("tag=")!=-1){var m=h.slice(h.indexOf("tag")),x=m.slice(m.indexOf("=")+1);x==""&&(tp=typefix[h.split("=")[0].trim()][3],x=tp+" | "+h.split("=")[1].split(",")[0].split(":")[0],h=h.split("tag")[0]+"tag="+x.replace("shadowsocks","ss"),s.push(x.replace("shadowsocks","ss")));for(var u=0;r.indexOf(x)!=-1;)x=u==0?x+NoReplace(u+1):x.split(" ").slice(0,x.split(" ").length-2).join(" ")+NoReplace(u+1),h=Pdel!=1?h.split("tag")[0]+"tag="+x:"",u=u+1;u!=0&&o.push(x),r.push(x),Pcap&&(h=Capitalize(h,Pcap)),(Pptn||Pnptn)&&(h=Pattern(h,Pptn,Pnptn)),u=0,h&&a.push(h)}}return PcheckU!=""&&(a=a.map(Add_URL)),s.length>=1&&(l=s.length<=10?emojino[s.length]:s.length,$notify("\u26A0\uFE0F \u5F15\u7528\u27E6"+subtag+"\u27E7 \u5185\u6709"+l+"\u4E2A\u7A7A\u8282\u70B9\u540D ","\u2705 \u5DF2\u5C06\u8282\u70B9\u201C\u7C7B\u578B+IP\u201D\u8BBE\u4E3A\u8282\u70B9\u540D"," \u2A01 "+s.join(`
 \u2A01 `),nan_link)),o.length>=1&&(l=o.length<=10?emojino[o.length]:o.length,Pdel!=1&&Pntf0!=0?$notify("\u26A0\uFE0F \u5F15\u7528\u27E6"+subtag+"\u27E7 \u5185\u6709"+l+"\u4E2A\u540D\u5B57\u91CD\u590D\u7684\u8282\u70B9 ","\u2705 \u5DF2\u6DFB\u52A0\u6570\u5B57\u533A\u5206, \u5220\u9664\u8BF7\u6DFB\u52A0\u53C2\u6570 del=1:"," \u2A01 "+o.join(`
 \u2A01 `),nan_link):Pdel==1&&Pntf0!=0&&$notify("\u26A0\uFE0F \u5F15\u7528\u27E6"+subtag+"\u27E7 \u5185\u6709"+l+"\u4E2A\u540D\u5B57\u91CD\u590D\u7684\u8282\u70B9 ","\u274C\uFE0F \u5DF2\u5168\u90E8\u5220\u9664\uFF0C\u5982\u9700\u4FDD\u7559\u8BF7\u53BB\u9664\u53C2\u6570 del=1:"," \u2A01 "+o.join(`
 \u2A01 `),nan_link)),a}function Add_URL(e){return e&&(e=e+", server_check_url="+PcheckU),e}function NoReplace(e){if(e){for(var t=0;t<10;t++)e=e.toString().replace(new RegExp(patn[0][t],"gmi"),patn[5][t]);return" "+e+" "}}function PatternN(e,t,a){if(e){if(t!="")for(var r=0;r<26;r++)e=e.toLowerCase(),e=e.replace(new RegExp(pat[0][r],"gmi"),pat[t][r]);if(a!="")for(var r=0;r<10;r++)e=e.replace(new RegExp(patn[0][r],"gmi"),patn[a][r]);return e}}function Pattern(e,t,a){return(t!=""||a!="")&&(e=e.split("tag=")[0]+"tag="+PatternN(e.split("tag=")[1],t,a)),e}function Capitalize(e,t){return t==1?e=e.split("tag=")[0]+"tag="+e.split("tag=")[1].toUpperCase():t==-1?e=e.split("tag=")[0]+"tag="+e.split("tag=")[1].toLowerCase():t==0&&(e=e.split("tag=")[0]+"tag="+titleCase(e.split("tag=")[1])),e}function titleCase(e){for(var t=e.split(" "),a=0;a<t.length;a++)t[a]=t[a].slice(0,1).toUpperCase()+t[a].slice(1).toLowerCase();return t.join(" ")}function type_prefix(e){if(e.trim()!="")return typefix={shadowsocks:"\u300C\u{1D42C}\u{1D42C}\u300D",vmess:"\u300C\u{1D42F}\u{1D426}\u{1D41E}\u{1D42C}\u{1D42C}\u300D",trojan:"\u300C\u{1D42D}\u{1D42B}\u{1D428}\u{1D423}\u{1D41A}\u{1D427}\u300D",http:"\u300C\u{1D421}\u{1D42D}\u{1D42D}\u{1D429}\u300D",socks5:"\u300C\u{1D42C}\u{1D428}\u{1D5F0}\u{1D5F8}\u{1D42C}\u300D",vless:"\u300C\u{1D42F}\u{1D425}\u{1D41E}\u{1D42C}\u{1D42C}\u300D"},typefix.shadowsocks=e.indexOf("ssr-protocol")!=-1?"\u300C\u{1D42C}\u{1D42C}\u{1D42B}\u300D":"\u300C\u{1D42C}\u{1D42C}\u300D",tp=typefix[e.split("=")[0].trim()],[[e.split("tag=")[0]+"tag=",tp,e.split("tag=")[1]].join(" ")].join(" ")}function type_suffix(e){if(e.trim()!="")return typefix={shadowsocks:"\u300C\u{1D42C}\u{1D42C}\u300D",vmess:"\u300C\u{1D42F}\u{1D426}\u{1D41E}\u{1D42C}\u{1D42C}\u300D",trojan:"\u300C\u{1D42D}\u{1D42B}\u{1D428}\u{1D423}\u{1D41A}\u{1D427}\u300D",http:"\u300C\u{1D421}\u{1D42D}\u{1D42D}\u{1D429}\u300D",vless:"\u300C\u{1D42F}\u{1D425}\u{1D41E}\u{1D42C}\u{1D42C}\u300D"},typefix.shadowsocks=e.indexOf("ssr-protocol")!=-1?"\u300C\u{1D42C}\u{1D42C}\u{1D42B}\u300D":"\u300C\u{1D42C}\u{1D42C}\u300D",tp=typefix[e.split("=")[0].trim()],[e,tp].join(" ")}function getnode_type(e,t){if(e.trim()!=""&&e.indexOf("tag=")!=-1)return t=/^(0|1|2|3|4|5|6|7)$/.test(t)?t:8,typefix={shadowsocks:["\u{1D42C}\u{1D42C}","\u{1D412}\u{1D412}","\u{1F162}\u{1F162}","\u{1F182}\u{1F182}","\u24E2\u24E2","\u{1F142}\u{1F142}","\u{1D54A}\u{1D54A}","\u02E2\u02E2","SS"],shadowsocksr:["\u{1D42C}\u{1D42C}\u{1D42B}","\u{1D412}\u{1D412}\u{1D411}","\u{1F162}\u{1F162}\u{1F161}","\u{1F182}\u{1F182}\u{1F181}","\u24E2\u24E2\u24E1","\u{1F142}\u{1F142}\u{1F141}","\u{1D54A}\u{1D54A}\u211D","\u02E2\u02E2\u02B3","SSR"],vmess:["\u{1D42F}\u{1D426}\u{1D41E}\u{1D42C}\u{1D42C}","\u{1D415}\u{1D40C}\u{1D404}\u{1D412}\u{1D412}","\u{1F165}\u{1F15C}\u{1F154}\u{1F162}\u{1F162}","\u{1F185}\u{1F17C}\u{1F174}\u{1F182}\u{1F182}","\u24E5\u24DC\u24D4\u24E2\u24E2","\u{1F145}\u{1F13C}\u{1F134}\u{1F142}\u{1F142}","\u{1D54D}\u{1D55E}\u{1D556}\u{1D564}\u{1D564}","\u1D5B\u1D50\u1D49\u02E2\u02E2","VMESS"],trojan:["\u{1D42D}\u{1D42B}\u{1D428}\u{1D423}\u{1D41A}\u{1D427}","\u{1D413}\u{1D411}\u{1D40E}\u{1D409}\u{1D400}\u{1D40D}","\u{1F163}\u{1F161}\u{1F15E}\u{1F159}\u{1F150}\u{1F15D}","\u{1F183}\u{1F181}\u{1F17E}\u{1F179}\u{1F170}\u{1F17D}","\u24E3\u24E1\u24DE\u24D9\u24D0\u24DD","\u{1F143}\u{1F141}\u{1F13E}\u{1F139}\u{1F130}\u{1F13D}","\u{1D54B}\u{1D563}\u{1D560}\u{1D55B}\u{1D552}\u{1D55F}","\u1D40\u02B3\u1D52\u02B2\u1D43\u207F","TROJAN"],http:["\u{1D421}\u{1D42D}\u{1D42D}\u{1D429}","\u{1D407}\u{1D413}\u{1D413}\u{1D40F}","\u{1F157}\u{1F163}\u{1F163}\u{1F15F}","\u{1F177}\u{1F183}\u{1F183}\u{1F17F}","\u24D7\u24E3\u24E3\u24DF","\u{1F137}\u{1F143}\u{1F143}\u{1F13F}","\u{1D559}\u{1D565}\u{1D565}\u{1D561}","\u02B0\u1D57\u1D57\u1D56","HTTP"],socks5:["\u{1D42C}\u{1D428}\u{1D5F0}\u{1D5F8}\u{1D42C}","\u{1D412}\u{1D40E}\u{1D402}\u{1D40A}\u{1D412}","\u{1F162}\u{1F15E}\u{1F152}\u{1F15A}\u{1F162}","\u{1F182}\u{1F17E}\u{1F172}\u{1F17A}\u{1F182}","\u24E2\u24DE\u24D2\u24DA\u24E2","\u{1F142}\u{1F13E}\u{1F132}\u{1F13A}\u{1F142}","\u{1D564}\u{1D560}\u{1D554}\u{1D55C}\u{1D564}","\u02E2\u1D52\u1D9C\u1D4F\u02E2","SOCKS"],vless:["\u{1D42F}\u{1D425}\u{1D41E}\u{1D42C}\u{1D42C}","\u{1D415}\u{1D40B}\u{1D404}\u{1D412}\u{1D412}","\u{1F165}\u{1F15B}\u{1F154}\u{1F162}\u{1F162}","\u{1F185}\u{1F17B}\u{1F174}\u{1F182}\u{1F182}","\u24E5\u24DB\u24D4\u24E2\u24E2","\u{1F145}\u{1F13B}\u{1F134}\u{1F142}\u{1F142}","\u{1D54D}\u{1D55D}\u{1D556}\u{1D564}\u{1D564}","\u1D5B\u02E1\u1D49\u02E2\u02E2","VLESS"]},typefix.shadowsocks=e.indexOf("ssr-protocol")!=-1?typefix.shadowsocksr:typefix.shadowsocks,tp=typefix[e.split("=")[0].trim()][t],tp}function type_handle(e){return e.indexOf("node_type_para_prefix")!=-1&&(e=e.replace(/node_type_para_prefix(\d{0,1})/g,getnode_type(e,e.split("node_type_para_prefix")[1][0]))),e}function index_handle(e){items=e.map(r=>r.trim()).filter(Boolean);let t=Array.from(new Array(items.length),(r,s)=>s+1);for(var a=0;a<items.length;a++)items[a].indexOf("node_index_prefix")!=-1&&(ind=items[a].split("node_index_prefix")[1][0],ind=/^(0|1|2|3|4|5|6|7|8)$/.test(ind)?ind:0,items[a]=items[a].replace(/node_index_prefix(\d{0,1})/g,PatternN((a+1).toString(),"",ind)));return items}function emoji_prefix_handle(e){return e.indexOf("node_emoji_flag_prefix")!=-1&&(e=e.replace(/node_emoji_flag_prefix\d{0,1}/g,getnode_emoji(e,e.split("node_emoji_flag_prefix")[1][0]))),e}function getnode_emoji(e,t){if(t=/^(1|2)$/.test(t)?t:2,e.indexOf("tag=")!=-1)return get_emoji(t,e.split("tag=")[1])[1]}function tag_handle(e){return e.indexOf("node_tag_prefix")!=-1&&(ptnn=/\d/.test(e.split("node_tag_prefix")[1][0])?e.split("node_tag_prefix")[1][0]:"",nptnn=/\d/.test(e.split("node_tag_prefix")[1][1])?e.split("node_tag_prefix")[1][1]:"",e=e.replace(/node_tag_prefix\d{0,2}/g,PatternN(subtag,ptnn,nptnn))),e}function URI_TAG(e,t){return e=e.split("tag=")[0]+"tag="+t,e}function ServerRelay(e,t){for(var a=[],r=0;r<e.length;r++)serverA=e[r].indexOf("-host")==-1?e[r].split("=")[1].split(":")[0].trim():e[r].split("-host")[1].split("=")[1].split(",")[0].trim(),type=/^[a-z]/.test(serverA)||/[a-z]$/.test(serverA)?"host":"ip",rst=type=="ip"?"ip-cidr,"+serverA+"/32,"+t:"host-suffix,"+serverA+","+t,a.push(rst);return a.join(`
`)}function rawtest(e){var t=RegExp('.*js-file-line".*?</td>',"i");if(t.test(e))return e.replace(/(.*js-file-line\"\>)(.*?)(\<\/td\>)/g,"$2").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").trim()}function ToRaw(e){e=e.split(`
`).map(rawtest).filter(Boolean).join(`
`);var t=link0.replace("github.com","raw.githubusercontent.com").replace("/blob","");return e?$notify("\u26A0\uFE0F\u26A0\uFE0F \u5C06\u5C1D\u8BD5\u89E3\u6790\u8BE5\u8D44\u6E90\u27E6"+subtag+"\u27E7","\u{1F6A5} \u8BF7\u6B63\u786E\u4F7F\u7528GitHub\u7684 raw \u94FE\u63A5","\u274C \u4F60\u7684\u94FE\u63A5\uFF1A"+link0+`
\u2705 \u6B63\u786E\u94FE\u63A5\uFF1A`+t,{"open-url":t}):content0.indexOf("gridcell")!=-1&&$notify("\u26A0\uFE0F\u26A0\uFE0F \u89E3\u6790\u8BE5\u8D44\u6E90 \u27E6"+subtag+"\u27E7 \u5931\u8D25","\u{1F6A5} \u4F60\u7684\u94FE\u63A5\u4F3C\u4E4E\u662F\u76EE\u5F55\uFF0C\u800C\u4E0D\u662F\u6587\u4EF6","\u274C \u4F60\u7684\u94FE\u63A5\uFF1A"+link0,{"open-url":link0}),e}function ToLink(e){return cnt=e.split("nsloon.com/openloon/import?plugin=")[1],cnt&&(typ=$resource.type,RLink0[Field[typ]].push(cnt+", opt-parser=true, tag=\u{1F251}\uFE0F\u957F\u70B9\u2764\uFE0F8\u20E3\uFE0F"),flink=ADDRes.replace(/url-encoded-json/,encodeURIComponent(JSON.stringify(RLink0))),$notify("\u26A0\uFE0F \u8BF7\u70B9\u51FB\u901A\u77E5\u8DF3\u8F6C\u5C1D\u8BD5\u6DFB\u52A0\u6B63\u786E\u94FE\u63A5","\u{1F6A5} \u8BF7\u6B63\u786E\u4F7F\u7528\u539F\u59CB\u94FE\u63A5","\u274C \u4F60\u7684\u94FE\u63A5\uFF1A"+link0+`
\u2705 \u6B63\u786E\u94FE\u63A5\uFF1A`+cnt,{"open-url":flink})),"wrong-link"}function CDN(e){return e=e.join(`
`).replace(/https:\/\/raw.githubusercontent.com\/(.*?)\/(.*?)\/(.*)/gmi,"https://fastly.jsdelivr.net/gh/$1/$2@$3"),e}function HOST_Handle(e,t){return t="host="+t+",",t.indexOf("\u2620\uFE0F")==-1?e=e.replace(/host\s*\=(.*?)\,/,t):(t=t.split("\u2620\uFE0F")[0],/-host\s*\=/.test(e)?e=e.replace(/host\s*\=(.*?)\,/,t+", "):/over-tls\s*\=\s*true/.test(e)?e=e+", tls-"+t:/obfs\s*\=/.test(e)&&(e=e+", obfs-"+t)),e}function OBFS_Handle(e,t){return t=="shttp"?t="obfs=shadowsocks-http":t=="vhttp"?t="obfs=vmess-http":t="invalid",/obfs\s*\=\s*http/.test(e)&&t!="invalid"&&(e=e.replace(/obfs\s*\=\s*http/,t)),e}function Session_Handle(e,t){let a=", tls-no-session-ticket=true",r=", tls-no-session-reuse=true";return t==0?e=e+a:t==1?e=e+r:t==2&&(e=e+a+r),e}function SHA256_Handle(e,t,a){return(e.indexOf("over-tls=true")!=-1||e.indexOf("obfs=wss")!=-1)&&(e=e.replace(/tls-verification\s*\=\s*false(\s*)\,/,""),e=t!=""?e.replace(/tag\s*\=/,"tls-cert-sha256="+t+", tag="):e,e=a!=""?e.replace(/tag\s*\=/,"tls-pubkey-sha256="+a+", tag="):e),e}function ALPN_Handle(e,t){return cnti=e.replace(/\s/gmi,""),(cnti.indexOf("obfs=over-tls")!=-1||cnti.indexOf("over-tls=true")!=-1)&&(e=e+", tls-alpn="+t),e}function Mock2QXReject(e,t){return/dict/i.test(t)?e.replace(/ /g,"").split("data=")[0].split("data-type=")[0]+" url reject-dict":/array/i.test(t)?e.replace(/ /g,"").split("data=")[0].split("data-type=")[0]+" url reject-array":/(txt|html)/i.test(t)||t==null?e.replace(/ /g,"").split("data=")[0].split("data-type=")[0]+" url reject-200":/(png|jpg|gif)/i.test(t)?e.replace(/ /g,"").split("data=")[0].split("data-type=")[0]+" url reject-img":e.replace(/ /g,"").split("data=")[0].split("data-type=")[0]+" url reject"}function URX2QX(e){var t=[],a="";e=e.split(`
`);for(var r=["//","#",";"],s=0;s<e.length;s++){const o=l=>e[s].indexOf(l)==0;if(!r.some(o)){if(e[s].slice(0,9)=="URL-REGEX")(e[s].indexOf("REJECT")!=-1||e[s].split(",").length==2)&&e[s].replace(/ /g,"").split(",REJECT")[0].split("GEX,")[1].slice(0,1)!="*"&&(a=e[s].replace(/ /g,"").split(",REJECT")[0].split("GEX,")[1]+" url reject-200",t.push(a));else if(e[s].indexOf("data=")!=-1&&e.indexOf("[Map Local]")!=-1){let l=e[s].match(/data=.+\/(.+)"/)?e[s].match(/data=.+\/(.+)"/)[1]:null;if(!/header=".*content-type/i.test(e[s])&&/blank/i.test(l)||l==null)a=Mock2QXReject(e[s],l);else if(a=e[s].replace(/ /g,"").split("data=")[0].split("data-type=")[0].replace(/\"/g,"")+" url echo-response text/html echo-response "+e[s].split("data=")[1].split(" ")[0].replace(/\"/g,"").replace(/ /g,""),e[s].indexOf("header=")!=-1&&e[s].indexOf("Content-Type:")!=-1){let n=e[s].split("header=")[1].split("Content-Type:")[1].split(",")[0].replace(/\"/g,"");a=a.replace(/text\/html/g,n)}t.push(a)}}}return t}function SCP2QX(e){var t=[],a="",r=[" url 302"," url 307"," url reject"," url script"," url req"," url res"," url echo"," url-and-header 302"," url-and-header 307"," url-and-header reject"," url-and-header script"," url-and-header req"," url-and-header res"," url-and-header echo"," url jsonjq"];e=e.split(`
`).map(m=>m.trim().replace(/\s+/g," "));for(var s=0;s<e.length;s++)try{e[s]=e[s].replace("^http","http"),e[s].slice(0,8)=="hostname"&&(hn=e[s].replace(/\%.*\%/g,"").replace(/\:\d*/g,""),t.push(hn));var o=["type=",".js","pattern=","script-path="],l=["//","#",";"];const m=p=>e[s].indexOf(p)!=-1,x=p=>e[s].indexOf(p)==0,u=p=>e[s].indexOf(p)!=-1;if(!l.some(x)&&!r.some(u))if(Pdbg==1&&$notify("rewrite-check","",e[s]),o.every(m))ptn=e[s].replace(/\s/gi,"").split("pattern=")[1].split(/\,[a-zA-Z]/)[0],js=e[s].replace(/\s/gi,"").split("script-path=")[1].split(",")[0],type=e[s].replace(/\s/gi,"").split("type=")[1].split(",")[0].trim(),subsi=e[s].replace(/ /g,"").replace(/\=true/g,"=1"),type=="http-response"&&subsi.indexOf("requires-body=1")!=-1?type="script-response-body ":type=="http-response"&&subsi.indexOf("requires-body=1")==-1?type="script-response-header ":type=="http-request"&&subsi.indexOf("requires-body=1")!=-1?type="script-request-body ":type=="http-request"&&subsi.indexOf("requires-body=1")==-1?type="script-request-header ":type="",type!=""&&(a=ptn+" url "+type+js,t.push(a));else if(/\d\s30(7|2)$/.test(e[s]))a=e[s].split(" ")[0]+" url "+e[s].split(" ")[2]+" "+e[s].split(" ")[1].trim(),t.push(a);else if(/\d\s\-\s30(2|7)\s/.test(e[s]))a=e[s].replace(" - "," url "),t.push(a);else if(e[s].split(" ")[2]=="header"){var n=e[s].split(" ")[0].split(".com")[1],h=e[s].split(" ")[1].split(".com")[1];a=e[s].split(" ")[0]+" url 302 "+e[s].split(" ")[1],t.push(a)}else if(e[s].split(" ")[1]=="header-replace"){var n=e[s].split("header-replace")[1].split(":")[0].trim(),h=e[s].split("header-replace")[1].trim();a=e[s].split(" ")[0]+" url request-header (.+\\r\\n)"+n+":.+(\\r\\n) request-header $1"+h+"$2",t.push(a)}else e[s].indexOf(" _ reject")!=-1?(a=e[s].split(" ")[0]+" url reject-200",t.push(a)):e[s].indexOf(" - reject")!=-1||e[s].indexOf(" - REJECT")!=-1?(a=e[s].replace(" - "," url ").toLowerCase(),t.push(a)):e[s].split(" ").length==2&&(/\s(reject)$/.test(e[s])||/\s(reject\-)/.test(e[s]))?(a=e[s].replace(" reject"," url reject"),t.push(a)):e[s].indexOf("script-path")!=-1&&(type=e[s].replace(/\s+/g," ").split(" ")[0],js=e[s].split("script-path")[1].split("=")[1].split(",")[0],ptn=e[s].replace(/\s+/g," ").split(" ")[1],subsi=e[s].replace(/ /g,"").replace(/\=true/g,"=1"),type=="http-response"&&subsi.indexOf("requires-body=1")!=-1?type="script-response-body ":type=="http-response"&&subsi.indexOf("requires-body=1")==-1?type="script-response-header ":type=="http-request"&&subsi.indexOf("requires-body=1")!=-1?type="script-request-body ":type=="http-request"&&subsi.indexOf("requires-body=1")==-1?type="script-request-header ":type="",type!=""&&(a=ptn+" url "+type+js,t.push(a)));else r.some(u)&&t.push(e[s])}catch(m){$notify("\u274C\uFE0F\u89E3\u6790\u6B64\u6761\u65F6\u51FA\u73B0\u9519\u8BEF\uFF0C\u5DF2\u5FFD\u7565",e[s],m)}return t}function SGMD2QX(e){var t=URX2QX(e),a=SCP2QX(e),r=[...t,...a];return r}function Rewrite_Filter(e,t,a,r,s){for(var o=[],l=["//","#",";"],n=0,h=[],m="",x=0;x<e.length;x++){subi=e[x].trim();var u=subi.replace(/ /g,"");if(subi!=""&&(subi.indexOf(" url ")!=-1||subi.indexOf("host")!=-1||subi.indexOf(" url-and-header ")!=-1||/^hostname\=/.test(u))){const g=c=>subi.indexOf(c)==0;if(l.some(g))continue;if(n==0&&u.indexOf("hostname=")==0)m=Phin0||Phout0||r||s?HostNamecheck(subi,Phin0,Phout0):subi;else if(u.indexOf("hostname=")!=0){var p=Rcheck(subi,t),v=Rcheck(subi,a);v==1||p==0?h.push(subi.replace(" url "," - ").replace(" url-and-header "," - ")):(v==0&&p!=0||v==2&&p!=0)&&o.push(subi)}}}return Pntf0!=0&&(nowrite=h.length<=10?emojino[h.length]:h.length,no1write=o.length<=10?emojino[o.length]:o.length,Pin0&&no1write!=" 0\uFE0F\u20E3 "?a!=0&&$notify("\u{1F916} \u91CD\u5199\u5F15\u7528  \u279F \u27E6"+subtag+"\u27E7","\u26D4\uFE0F \u7B5B\u9009\u53C2\u6570: "+pfi+pfo,"\u2620\uFE0F \u91CD\u5199 rewrite \u4E2D\u4FDD\u7559\u4EE5\u4E0B"+no1write+`\u4E2A\u5339\u914D\u9879:
 \u2A37 `+o.join(`
 \u2A37 `),rwrite_link):h.length>0&&Pout0!=0&&$notify("\u{1F916} \u91CD\u5199\u5F15\u7528  \u279F \u27E6"+subtag+"\u27E7","\u26D4\uFE0F \u7B5B\u9009\u53C2\u6570: "+pfi+pfo,"\u2620\uFE0F \u91CD\u5199 rewrite \u4E2D\u5DF2\u7981\u7528\u4EE5\u4E0B"+nowrite+`\u4E2A\u5339\u914D\u9879:
 \u2A37 `+h.join(`
 \u2A37 `),rwrite_link)),o.length==0&&(Pin0||Pout0||Phin0||Phout0||s||r?$notify("\u{1F916} \u91CD\u5199\u5F15\u7528  \u279F \u27E6"+subtag+"\u27E7","\u26D4\uFE0F \u7B5B\u9009\u53C2\u6570: "+pfi+pfo,"\u26A0\uFE0F \u7B5B\u9009\u540E\u5269\u4F59rewrite\u89C4\u5219\u6570\u4E3A 0\uFE0F\u20E3 \u6761, \u8BF7\u68C0\u67E5\u53C2\u6570\u53CA\u539F\u59CB\u94FE\u63A5",nan_link):$notify("\u{1F916} \u91CD\u5199\u5F15\u7528  \u279F \u27E6"+subtag+"\u27E7","\u26D4\uFE0F \u89E3\u6790\u540E rewrite \u89C4\u5219\u6570\u4E3A 0\uFE0F\u20E3 \u6761 ","\u26A0\uFE0F \u8BF7\u68C0\u67E5\u53C2\u6570\u53CA\u539F\u59CB\u94FE\u63A5\u5185\u5BB9",nan_link)),r&&(o=o.map(Regex).filter(Boolean),RegCheck(o,"\u91CD\u5199\u5F15\u7528","regex",r)),s&&(o=o.map(RegexOut).filter(Boolean),RegCheck(o,"\u91CD\u5199\u5F15\u7528","regout",s)),m!=""&&o.push(m),o=Phide==1?o:[...h,...o],o}function HostNamecheck(e,t,a){for(var r=e.replace(/ /g,"").split("=")[1].split(","),s=[],o=[],l=0;l<r.length;l++){dd=r[l];const m=x=>dd.indexOf(x)!=-1;a&&a!=""&&a.some(m)?o.push(r[l]):t&&t!=""?t.some(m)?s.push(r[l]):o.push(r[l]):s.push(r[l])}if(Pntf0!=0&&(a||t)){var n=o.length<=10?emojino[o.length]:o.length,h=s.length<=10?emojino[s.length]:s.length;t&&h!=" 0\uFE0F\u20E3 "?$notify("\u{1F916} \u91CD\u5199\u5F15\u7528  \u279F \u27E6"+subtag+"\u27E7","\u26D4\uFE0F \u7B5B\u9009\u53C2\u6570: "+pfihn+pfohn,"\u2620\uFE0F \u4E3B\u673A\u540D hostname \u4E2D\u5DF2\u4FDD\u7559\u4EE5\u4E0B"+h+`\u4E2A\u5339\u914D\u9879:
 \u2A37 `+s.join(","),rwhost_link):o.length>0&&$notify("\u{1F916} \u91CD\u5199\u5F15\u7528  \u279F \u27E6"+subtag+"\u27E7","\u26D4\uFE0F \u7B5B\u9009\u53C2\u6570: "+pfihn+pfohn,"\u2620\uFE0F \u4E3B\u673A\u540D hostname \u4E2D\u5DF2\u5220\u9664\u4EE5\u4E0B"+n+`\u4E2A\u5339\u914D\u9879:
 \u2A37 `+o.join(","),rwhost_link)}return s.length==0&&$notify("\u{1F916} \u91CD\u5199\u5F15\u7528  \u279F \u27E6"+subtag+"\u27E7","\u26D4\uFE0F \u7B5B\u9009\u53C2\u6570: "+pfihn+pfohn,"\u26A0\uFE0F \u4E3B\u673A\u540D hostname \u4E2D\u5269\u4F59 0\uFE0F\u20E3 \u9879, \u8BF7\u68C0\u67E5\u53C2\u6570\u53CA\u539F\u59CB\u94FE\u63A5",nan_link),Preg&&(s=s.map(Regex).filter(Boolean),RegCheck(s,"\u4E3B\u673A\u540Dhostname","regex",Preg)),Pregout&&(s=s.map(RegexOut).filter(Boolean),RegCheck(s,"\u4E3B\u673A\u540Dhostname","regout",Pregout)),r="hostname="+s.join(", "),r}function Rcheck(e,t){if(name=e.toUpperCase(),t){var a=0;const r=s=>name.indexOf(s.toUpperCase())!=-1;return t.some(r)&&(a=1),a}else return 2}function Rule_Handle(e,t,a){cnt=e,Tin=a,Tout=t,ply=Ppolicy;var r=[],s=["//","#",";","[","^"],o=["host,","-suffix,","domain,","-keyword,","ip-cidr,","ip-cidr6,","geoip,","user-agent,","ip6-cidr,","ip-asn"];if(Tout!=""&&Tout!=null){for(var l=[],n=0;n<cnt.length;n++){cc=cnt[n].replace(/^\s*\-\s/g,"").replace(/\"|\'/g,"").trim();const u=g=>cc.indexOf(g)!=-1,p=g=>cc.toLowerCase().indexOf(g)!=-1,v=g=>cc.toLowerCase().indexOf(g)==0;if(Tout.some(u)&&!s.some(v))l.push("-"+Rule_Policy(cc));else if(!s.some(v)&&cc)if(dd=Rule_Policy(cc),Tin!=""&&Tin!=null){const g=c=>dd.indexOf(c)!=-1;Tin.some(g)&&r.push(dd)}else r.push(dd)}var h=l.length<=10?emojino[l.length]:l.length;if(l.length>0?Pntf0!=0&&$notify("\u{1F916} \u5206\u6D41\u5F15\u7528  \u279F \u27E6"+subtag+"\u27E7","\u26D4\uFE0F \u7981\u7528: "+Tout,"\u2620\uFE0F \u5DF2\u7981\u7528\u4EE5\u4E0B"+h+`\u6761\u5339\u914D\u89C4\u5219:
 \u2A37 `+l.join(`
 \u2A37 `),rule_link):$notify("\u{1F916} \u5206\u6D41\u5F15\u7528  \u279F \u27E6"+subtag+"\u27E7","\u26D4\uFE0F \u7981\u7528: "+Tout,"\u26A0\uFE0F \u672A\u53D1\u73B0\u4EFB\u4F55\u5339\u914D\u9879, \u8BF7\u68C0\u67E5\u53C2\u6570\u6216\u539F\u59CB\u94FE\u63A5",nan_link),Tin!=""&&Tin!=null)if(r.length>0){var m=r.length<=10?emojino[r.length]:r.length;Pntf0!=0&&$notify("\u{1F916} \u5206\u6D41\u5F15\u7528  \u279F \u27E6"+subtag+"\u27E7","\u2705 \u4FDD\u7559:"+Tin,"\u{1F3AF} \u5DF2\u4FDD\u7559\u4EE5\u4E0B "+m+`\u6761\u5339\u914D\u89C4\u5219:
 \u2A01 `+r.join(`
 \u2A01 `),rule_link)}else $notify("\u{1F916} \u5206\u6D41\u5F15\u7528  \u279F \u27E6"+subtag+"\u27E7","\u2705 \u4FDD\u7559:"+Tin+",\u26D4\uFE0F \u7981\u7528: "+Tout,"\u26A0\uFE0F \u7B5B\u9009\u540E\u5269\u4F59\u89C4\u5219\u6570\u4E3A 0\uFE0F\u20E3 \u6761, \u8BF7\u68C0\u67E5\u53C2\u6570\u53CA\u539F\u59CB\u94FE\u63A5",nan_link);else r.length==0&&$notify("\u{1F916} \u5206\u6D41\u5F15\u7528  \u279F \u27E6"+subtag+"\u27E7","\u26D4\uFE0F \u7981\u7528: "+Tout,"\u26A0\uFE0F \u7B5B\u9009\u540E\u5269\u4F59\u89C4\u5219\u6570\u4E3A 0\uFE0F\u20E3 \u6761, \u8BF7\u68C0\u67E5\u53C2\u6570\u53CA\u539F\u59CB\u94FE\u63A5",nan_link);r=Phide==1?r:[...l,...r]}else if(Tin!=""&&Tin!=null){for(var l=[],n=0;n<cnt.length;n++){cc=cnt[n].replace(/^\s*\-\s/g,"").trim();const v=c=>cc.indexOf(c)!=-1,g=c=>cc.toLowerCase().indexOf(c)==0;if(!s.some(g)&&cc){dd=Rule_Policy(cc);const c=w=>dd.indexOf(w)!=-1;Tin.some(c)?r.push(dd):l.push("-"+dd)}}if(r.length>0){var x=r.length<=10?emojino[r.length]:r.length;Pntf0!=0&&$notify("\u{1F916} \u5206\u6D41\u5F15\u7528  \u279F \u27E6"+subtag+"\u27E7","\u2705 \u4FDD\u7559:"+Tin,"\u{1F3AF} \u5DF2\u4FDD\u7559\u4EE5\u4E0B "+x+`\u6761\u5339\u914D\u89C4\u5219:
 \u2A01 `+r.join(`
 \u2A01 `),rule_link)}else $notify("\u{1F916} \u5206\u6D41\u5F15\u7528  \u279F \u27E6"+subtag+"\u27E7","\u2705 \u4FDD\u7559:"+Tin,"\u26A0\uFE0F \u7B5B\u9009\u540E\u5269\u4F59\u89C4\u5219\u6570\u4E3A 0\uFE0F\u20E3 \u6761, \u8BF7\u68C0\u67E5\u53C2\u6570\u53CA\u539F\u59CB\u94FE\u63A5",nan_link);r=Phide==1?r:[...l,...r]}else r=cnt.map(Rule_Policy);return r=Pfcr==1?r.filter(Boolean).map(u=>u+", force-cellular"):r.filter(Boolean),r=Pfcr==2?r.filter(Boolean).map(u=>u+", multi-interface"):r.filter(Boolean),r=Pfcr==3?r.filter(Boolean).map(u=>u+", multi-interface-balance"):r.filter(Boolean),Pvia!=""&&(r=Pvia==0?r.filter(Boolean).map(u=>u+", via-interface=%TUN%"):r.filter(Boolean).map(u=>u+", via-interface="+Pvia)),r=r.map(u=>u.replace(/:\d*\s*,/g,",").replace(/(\'|\")/g,"").replace(/(\-suffix|\-SUFFIX)\s*\,\s*\./g,"$1, ")),r}function Rule_Policy(e){var t=e.replace(/^\s*\-\s/g,"").replace(/REJECT-TINYGIF/gi,"reject").replace(/REJECT-DROP/gi,"reject").trim().split("//")[0].trim().split(","),a=["//","#",";","[","/","hostname","no-ipv6","no-system","<","{","}","]","^"],r=["host","domain","ip-cidr","geoip","user-agent","ip6-cidr","ip-asn"];const s=l=>t[0].trim().toLowerCase().indexOf(l)==0,o=l=>t[0].trim().toLowerCase().indexOf(l)==0;if(r.some(o)&&!a.some(s)){if(t.length==3&&t.indexOf("no-resolve")==-1)ply0=Ppolicy!="Shawn"?Ppolicy:t[2],nn=t[0]+", "+t[1]+", "+ply0;else if(t.length==4&&t.indexOf("no-resolve")!=-1)nn=t.join(",").replace(",no-resolve","");else if(t.length==2)ply0=Ppolicy!="Shawn"?Ppolicy:"Shawn",nn=t[1].trim()!=""?t[0]+", "+t[1]+", "+ply0:"";else if(t.length==3&&t[2].indexOf("no-resolve")!=-1)ply0=Ppolicy!="Shawn"?Ppolicy:"Shawn",nn=t[0]+", "+t[1]+", "+ply0;else if(t.length==4&&t[3].indexOf("no-resolve")!=-1)ply0=Ppolicy!="Shawn"?Ppolicy:t[2],nn=t[0]+", "+t[1]+", "+ply0;else return!a.some(s)&&e,"";return t[0].indexOf("URL-REGEX")!=-1||t[0].indexOf("PROCESS")!=-1?nn="":nn=nn.replace("IP-CIDR6","ip6-cidr").replace(/^(domain|Domain|DOMAIN)/,"host"),nn}else return t.length==1&&!a.some(s)&&t[0]!=""&&t[0].indexOf("payload:")==-1&&t[0].indexOf("=")==-1&&t[0].trim()!="https:"?rule_list_handle(t[0]):""}function rule_list_handle(e){var t=["//","#",";","[","!","/"];const a=s=>e.trim().indexOf(s)==0,r=s=>/^\d+$/.test(s);return e=e.split("#")[0].trim(),e.trim().indexOf(" ")==-1&&e.trim()!=""&&!t.some(a)&&(e.indexOf("::")!=-1&&e.indexOf("/")!=-1?(e="ip6-cidr, "+e,e=Ppolicy=="Shawn"?e+", Shawn":e+", "+Ppolicy):e.split("/").length==2?(e="ip-cidr, "+e,e=Ppolicy=="Shawn"?e+", Shawn":e+", "+Ppolicy):e.split(".").length==4&&e.split(".").every(r)?(e="ip-cidr, "+e+"/32",e=Ppolicy=="Shawn"?e+", Shawn":e+", "+Ppolicy):e.indexOf("payload:")==-1&&(/^('|")/.test(e)?(e=e.replace(/'|"/g,"").trim(),/^\.|\*\./.test(e)||e.indexOf("*")!=-1?e="host-wildcard, "+e.replace(/^\.|\*\./,"*."):e="host-suffix, "+e.replace(/^(\+\.)/,"")):/\*|\+/.test(e[0])?e="host-wildcard, "+e:(e=e[0]=="."?e.replace(".",""):e,e="host-suffix, "+e),e=Ppolicy=="Shawn"?e+", Shawn":e+", "+Ppolicy)),e}function Domain2Rule(e){for(var t=e.split(`
`),a=["//","#",";","["],r=[],s=0;s<t.length;s++){cc=t[s].trim();const o=l=>cc.indexOf(l)!=-1;!a.some(o)&&cc&&(cc[0]=="."?r.push("host-suffix, "+cc.slice(1,cc.length)):r.push("host, "+cc))}return r.join(`
`)}function policy_sets(e,t){for(pcnt=t.split("+"),e=e,i=0;i<pcnt.length;i++)pcnt[i].indexOf("@")!=-1&&(e=e.map(a=>filter_set(a,pcnt[i])));return e=e.filter(Boolean),e}function filter_set(e,t){if(e)return paras=[t.split("@")[0],t.slice(t.split("@")[0].length+1)],e=e.split(","),reg=RegExp(paras[0]),e.length==3&&(reg.test(e[1])||reg.test(e[2]))&&(e[2]=paras[1]),e.join(",")}function ReplaceReg(e,t){for(var a=e,r=t.replace(/\\\@/g,"atsymbol").replace(/\\\+/g,"plussymbol").split("+"),s=0;s<r.length;s++){var o=decodeURIComponent(r[s].split("@")[0]).replace(/atsymbol/g,"@").replace(/plussymbol/g,"\\+").replace(/\，/g,","),l=decodeURIComponent(r[s].split("@")[1]).replace(/atsymbol/g,"@").replace(/plussymbol/g,"+").replace(/\，/g,",");o=new RegExp(o,"gmi"),a=a.map(n=>n.replace(o,l))}return a}function Subs2QX(e,t,a,r,s){Pdbg&&$notify("subs","node",e);for(var o=e.split(`
`),l=["shadowsocks=","trojan=","vmess=","http=","socks5="],n=["=ss,","=vmess,","=trojan,","=http,","=https,","=custom,","=socks5","=socks5-tls"],h=["=shadowsocks","=shadowsocksr","=vless"],m=[],x=[],u=0;u<o.length;u++){var p="";if(o[u].trim().length>3&&!/\;|\/|\#/.test(o[u][0])&&o[u].indexOf(" url ")==-1){var v=o[u].split("://")[0].trim(),g=o[u].replace(/ /g,""),c=o[u].indexOf("tag=")!=-1?o[u].split(/\&*(emoji|udp|tfo|cert|rename|replace)\=/)[0].split("tag=")[1]:"";o[u]=v=="ssr"?o[u].split(/#|,|，/)[0]:o[u];const y=O=>g.toLowerCase().indexOf(O)!=-1,b=O=>g.toLowerCase().indexOf(O)==0;try{if(Pdbg&&$notify(u,v,o[u]),v=="vmess"&&o[u].indexOf("remark=")==-1&&o[u].indexOf("remarks=")==-1&&!/(obfs|alterId|type|\@)\=/.test(o[u])){var w=Base64.decode(o[u].split("vmess://")[1]);w.indexOf("over-tls=")==-1?p=V2QX(o[u],t,a,r,s):p=VQ2QX(o[u],t,a,r,s),p=c!=""?URI_TAG(p,c):p}else if(v=="vmess"&&(o[u].indexOf("remark=")!=-1||o[u].indexOf("remarks=")!=-1||/(obfs|alterId|type|\@)\=/.test(o[u])))p=VR2QX(o[u],t,a,r,s),p=c!=""?URI_TAG(p,c):p;else if(v=="socks"&&o[u].indexOf("remarks=")!=-1)p=S5R2QX(o[u]),p=c!=""?URI_TAG(p,c):p;else if(v=="ssocks"&&o[u].indexOf("remarks=")!=-1)p=S5R2QX(o[u],tlsp="over-tls"),p=c!=""?URI_TAG(p,c):p;else if(v=="ssr")p=SSR2QX(o[u],t,a),p=c!=""?URI_TAG(p,c):p;else if(v=="ss")p=SS2QX(o[u],t,a),p=c!=""?URI_TAG(p,c):p;else if(v=="ssd")p=SSD2QX(o[u],t,a);else if(v=="trojan")p=TJ2QX(o[u],t,a,r,s),p=c!=""?URI_TAG(p,c):p;else if((v=="https"||v=="http")&&o[u].indexOf(",")==-1)if(g.indexOf("@")!=-1)p=HPS2QX(o[u],a,r,s),p=c!=""?URI_TAG(p,c):p;else{var f=Base64.decode(g.split(v+"://")[1].split("#")[0].split("?")[0]);f=o[u].replace(g.split(v+"://")[1].split("#")[0].split("?")[0],f),p=HPS2QX(f,a,r,s),p=c!=""?URI_TAG(p,c):p}else v=="vless"&&version<821?(Perror=1,$notify("\u26A0\uFE0F \u4F60\u7684 Quantumult X \u7248\u672C\u6682\u672A\u652F\u6301 Vless \u8282\u70B9","\u8BF7 \u26A0\uFE0F\u4E0D\u8981\u26A0\uFE0F \u8DD1\u6765 \u89E3\u6790\u5668\u{1F916}\uFE0F \u53CD\u9988",o[u])):v=="vless"?p=VL2QX(o[u],t,a,r,s):l.some(b)?p=QX_TLS(isQuanX(o[u])[0],r,s):n.some(y)?p=QX_TLS(Surge2QX(o[u])[0],r,s):h.some(y)&&(p=Loon2QX(o[u]))}catch(O){x.push(`<<<
Content: ${o[u]}
Error: ${O}`)}if(Paead!=""&&(p=AeadVmess(p,Paead)),Phost!=""&&(p=HOST_Handle(p,Phost)),Pobfs!=""&&(p=OBFS_Handle(p,Pobfs)),Psession!=""&&(p=Session_Handle(p,Psession)),(Pcsha256!=""||Ppsha256!="")&&(p=SHA256_Handle(p,Pcsha256,Ppsha256)),Palpn!=""&&(p=ALPN_Handle(p,Palpn)),p=TLS_Check(p),p instanceof Array)for(var d in p)p[d]=t!=0?XUDP(p[d],t):p[d],p[d]=a!=0?XTFO(p[d],a):p[d],m.push(p[d]);else p!=""&&p&&(p=t!=0?XUDP(p,t):p,p=a!=0?XTFO(p,a):p,m.push(p))}}return x.length>0&&Pntf0!=0&&$notify(`\u26A0\uFE0F \u6709 ${x.length} \u6761\u6570\u636E\u89E3\u6790\u5931\u8D25, \u5DF2\u5FFD\u7565`,"\u51FA\u9519\u5185\u5BB9\u{1F447}",x.join(`
`)),m}function AeadVmess(e,t){let a=t==-1?"aead=false":"aead=true";return/^vmess\s*\=/.test(e)&&(/aead\s*\=/.test(e)?e=e.replace(/aead\s*\=.*\,/,a+","):(cnts=e.split(","),cnts.push(a),e=cnts.join(", "))),e}function TLS_Check(e){return e=e.indexOf("tls-cert-sha256")!=-1||e.indexOf("tls-pubkey-sha256")!=-1?e.replace(/tls-verification\s*\=\s*false.*?\,/,"tls-verification=true,"):e,e}function QX_TLS(e,t,a){e=e.replace(/tag\s*\=/gm,"tag=");var r=t==1?"tls-verification=true, ":"tls-verification=false, ",s=a==1?"tls13=true, ":"";if(e.indexOf("tls-verification")!=-1?e=t==-1||t==1?e.replace(RegExp("tls-verification.*?,","gmi"),r):e:(e.indexOf("obfs=over-tls")!=-1||/over\-tls\s*\=\s*true/.test(e)||e.indexOf("obfs=wss")!=-1)&&(e=e.replace(new RegExp("tag.*?=","gmi"),r+"tag=")),s!=""&&(e.indexOf("tls13")!=-1?e=e.replace(RegExp("tls13.*?,","gmi"),s):(e.indexOf("obfs=over-tls")!=-1||/over\-tls\s*\=\s*true/.test(e)||e.indexOf("obfs=wss")!=-1)&&(e=e.replace(new RegExp("tag.*?=","gmi"),s+"tag="))),!/^(shadowsocks|trojan|vmess)/.test(e.trim()))if(udp="udp-relay=false, ",e.indexOf("udp-relay")!=-1)var e=e.replace(RegExp("udp-relay.*?,","gmi"),udp);else var e=e.replace(new RegExp("tag.*?=","gmi"),udp+"tag=");return e}function SIP2QuanX(e){for(e=JSON.parse(e),ll=e.length,nodes=[],i=0;i<ll;i++)node="shadowsocks= ",cnti=e[i],ip=cnti.server+":"+cnti.server_port,mtd="method="+cnti.method,pwd="password="+cnti.password,obfs=cnti.plugin_opts?cnti.plugin_opts.replace(";",", "):"",tag="tag="+cnti.remarks,node=node+[ip,pwd,mtd,obfs,tag].filter(Boolean).join(", "),nodes.push(node);return nodes.join(`
`)}function HPS2QX(e,t,a,r){var s=e.indexOf("https://")!=-1?"https":"http",o=e.replace("https://","").replace("http://","").trim(),l=[];if(o!=""){if(o.indexOf("@")!=-1)var n="http="+o.split("@")[1].split("#")[0].split("/")[0].split("?")[0],h="username="+o.split(":")[0],m="password="+o.split("@")[0].split(":")[1];else var n=o.split("#")[0].indexOf(":")==-1?"http="+Base64.decode(o.split("#")[0].split("?")[0]):"http="+o.split("#")[0].split("?")[0];var x="tag="+decodeURIComponent(o.split("#")[1]),u=s=="https"?"over-tls=true":"",p=e.indexOf("peer=")!=-1?"tls-host="+e.split("peer=")[1].split("#")[0].split("&")[0]:"",v=a!=0?"tls-verification=true":"tls-verification=false",g=t==1?"fast-open=true":"fast-open=false",c=r==1?"tls13=true":"tls13=false";u==""&&(v="",c=""),l.push(n,h,m,u,p,v,g,c,x)}var w=l.filter(Boolean).join(",");return w}function VQ2QX(e,t,a,r,s){var o=String(Base64.decode(e.replace("vmess://","").trim()).split("\0")[0]),l="",n="vmess="+o.split(",")[1].trim()+":"+o.split(",")[2].trim()+", method=aes-128-gcm, password="+o.split(",")[4].split('"')[1]+", ",h="tag="+o.split("=")[0],m=e.indexOf("tfo=1")!=-1?"fast-open=true, ":"fast-open=false, ",x=(t==1,"udp-relay=false, ");l=n+m+x;var u="";if(o.indexOf("obfs=")==-1){u=o.indexOf("over-tls=true")!=-1?"obfs=over-tls, ":"";var p=o.indexOf("tls-host")!=-1?"obfs-host="+o.split("tls-host=")[1].split(",")[0]+", ":"";u=u+p}else if(o.indexOf("obfs=ws")!=-1){u=o.indexOf("over-tls=true")!=-1?"obfs=wss, ":"obfs=ws, ";var v=o.indexOf("obfs-path=")!=-1?"obfs-uri="+o.split("obfs-path=")[1].split('"')[1]+", ":"obfs-uri=/, ";u=u+v;var p=o.indexOf("obfs-header=")!=-1?"obfs-host="+o.split('obfs-header="Host:')[1].split("[")[0].trim()+", ":"";u=u+p}else if(o.indexOf("obfs=http")!=-1){u="obfs=http, ";var v=o.indexOf("obfs-path=")!=-1?"obfs-uri="+o.split("obfs-path=")[1].split('"')[1]+", ":"obfs-uri=/, ";u=u+v;var p=o.indexOf("obfs-header=")!=-1?"obfs-host="+o.split('obfs-header="Host:')[1].split("[")[0].trim()+", ":"";u=u+p}if(u.indexOf("obfs=over-tls")!=-1||u.indexOf("obfs=wss")!=-1){var g=r!=0||e.indexOf("allowInsecure=1")!=-1?"tls-verification=false, ":"tls-verification=true, ",c=s==1?"tls13=true, ":"";u=u+g+c}return l=l+u+h,l}function VR2QX(e,t,a,r,s){var o=String(Base64.decode(e.replace("vmess://","").split("?remark")[0].split("&remark")[0].split("?")[0]).trim()).split("\0")[0];Pdbg==1&&$notify("Shadowrocket-Vmess-URI","..",e+`

`+o),o.indexOf("@")==-1&&e.indexOf("@")!=-1&&(o=e.replace("vmess://","").split("?")[0]);var l="",n="vmess="+o.split("@")[1]+", method=aes-128-gcm, ",h=o.split("@")[0].split(":")[1]?"password="+o.split("@")[0].split(":")[1]+", ":"password="+o.split("@")[0]+", ";e.indexOf("#")==-1?tag=/remarks*=/.test(e)?"tag="+decodeURIComponent(e.split(/remarks*=/)[1].split("&")[0]):"tag="+o.split("@")[1]:tag="tag="+e.split("#")[1];var m=e.indexOf("tfo=1")!=-1?"fast-open=true, ":"fast-open=false, ",x=(t==1,"udp-relay=false, "),u=0;l=n+h+m+x;var p=e.indexOf("obfs=")!=-1?e.split("obfs=")[1].split("&")[0].trim():"none";if(p=="none")p=e.indexOf("tls=1")!=-1?"obfs=over-tls, ":"";else if(p=="websocket"||p=="http"){p=p=="http"?"obfs=http, ":"obfs=ws, ",p=e.indexOf("tls=1")!=-1?"obfs=wss, ":p;var v=e.indexOf("&path=")!=-1?decodeURIComponent(e.split("&path=")[1].split("&")[0]):"/";p=p+"obfs-uri="+v+", ";var g=e.indexOf("&obfsParam=")!=-1?decodeURIComponent(e.split("&obfsParam=")[1].split("&")[0].split(`
`)[0]).split(`
`)[0].trim():"";g.indexOf('"Host"')!=-1&&g.indexOf("{")!=-1&&(g=JSON.parse(g).Host),g=g!="{}"&&g?"obfs-host="+g+", ":"",p=p+g}else(p=="grpc"||p=="h2")&&(Perror=1,Pntf0!=0&&$notify("\u26A0\uFE0F Quantumult X \u6682\u4E0D\u652F\u6301\u8BE5\u7C7B\u578B\u8282\u70B9","\u5DF2\u5FFD\u7565\u4EE5\u4E0B grpc|h2 vmess \u8282\u70B9",e),u=1);if(p.indexOf("obfs=over-tls")!=-1||p.indexOf("obfs=wss")!=-1){var c=r!=0||e.indexOf("allowInsecure=1")!=-1?"tls-verification=false, ":"tls-verification=true, ",w=s==1?"tls13=true, ":"";p=p+c+w}return caead="aead=false, ",e.indexOf("alterId=")!=-1&&(caead=Number(e.split("alterId=")[1].split("&")[0])!=0?"aead=false, ":""),l=u==0?l+p+caead+tag:"",l}function S5R2QX(e,t="false"){var a=Base64.decode(e.split("socks://")[1].split("#")[0].split("?")[0]);server=a+"#"+e.split("?")[1];var r=[];if(server!=""){var s="socks5="+server.split("@")[1].split("#")[0].split("/")[0],o="username="+server.split(":")[0],l="password="+server.split("@")[0].split(":")[1],n="tag="+decodeURIComponent(server.split("remarks=")[1].split("&")[0]),h=t=="false"?"":"over-tls=true",m=Pcert0!=0?"tls-verification=true":"tls-verification=false";m=h==""?"":m;var x=Ptfo0==1?"fast-open=true":"fast-open=false";r.push(s,o,l,h,m,x,n)}var u=r.filter(Boolean).join(",");return u}function V2QX(e,t,a,r,s){var o=r,l=s,n=String(Base64.decode(e.replace("vmess://","")).trim()).split("\0")[0],h=[];if(n!=""){ss=JSON.parse(n),Pdbg&&$notify("Vmess-URI","",JSON.stringify(ss)),ip="vmess="+ss.add+":"+ss.port,pwd="password="+ss.id,mtd="method=aes-128-gcm";try{tag="tag="+decodeURIComponent(ss.ps)}catch{tag="tag="+ss.ps}udp=(t==1,"udp-relay=false"),tfo=a==1?"fast-open=true":"fast-open=false",obfs=Fobfs(ss,o,l),caead=ss.aid&&ss.aid!="0"?"aead=false":"aead=true",obfs==""||obfs==null?h.push(ip,mtd,pwd,tfo,udp,caead,tag):obfs!="NOT-SUPPORTTED"&&h.push(ip,mtd,pwd,obfs,tfo,udp,caead,tag),QX=h.join(", ")}return QX}function Fobfs(e,t,a){var r=[],s=t;return tcert=s==0?"tls-verification=false":"tls-verification=true",tls13=a==1?"tls13=true":"tls13=false",e.net=="ws"&&e.tls=="tls"?(obfs0="obfs=wss, "+tcert+", "+tls13+", ",uri0=e.path&&e.path!=""?"obfs-uri="+e.path:"obfs-uri=/",uri0=uri0.indexOf("uri=/")!=-1?uri0:uri0.replace("uri=","uri=/"),host0=e.host&&e.host!=""?"obfs-host="+e.host+", ":"",r.push(obfs0+host0+uri0),r.join(", ")):e.net=="ws"?(obfs0="obfs=ws",uri0=e.path&&e.path!=""?"obfs-uri="+e.path:"obfs-uri=/",uri0=uri0.indexOf("uri=/")!=-1?uri0:uri0.replace("uri=","uri=/"),host0=e.host&&e.host!=""?"obfs-host="+e.host+", ":"",r.push(obfs0,host0+uri0),r.join(", ")):e.tls=="tls"&&(e.net=="tcp"||e.net=="none")?(obfs0="obfs=over-tls, "+tcert+", "+tls13,uri0=e.path&&e.path!=""?"obfs-uri="+e.path:"",uri0=uri0.indexOf("uri=/")!=-1?uri0:uri0.replace("uri=","uri=/"),host0=e.host&&e.host!=""?", obfs-host="+e.host:"",r.push(obfs0+host0),r.join(", ")):(e.net=="tcp"||e.net=="none")&&e.type=="http"?(obfs0="obfs=http",uri0=e.path&&e.path!=""?"obfs-uri="+e.path:"obfs-uri=/",uri0=uri0.indexOf("uri=/")!=-1?uri0:uri0.replace("uri=","uri=/"),host0=e.host&&e.host!=""?"obfs-host="+e.host+", ":"",r.push(obfs0,host0+uri0),r.join(", ")):e.net!="tcp"&&e.net!="none"&&e.net!=null?(Perror=1,$notify("\u26A0\uFE0F Quantumult X \u4E0D\u652F\u6301\u8BE5\u7C7B\u578B\u8282\u70B9","vmess + "+e.net,JSON.stringify(e)),"NOT-SUPPORTTED"):(e.net=="tcp"||e.net=="none")&&e.type!=null&&e.type!="none"&&e.type!=""&&e.type!="vmess"?"NOT-SUPPORTTED":""}function Dot2(e){return e=e?e.replace(/\\\./g,"\u8FD9\u662F\u4E2A\u70B9"):"",e}function ToDot(e){return e=e?e.replace(/这是个点/g,"."):"",e}function Regex(e){var t=RegExp(Preg,"i");if(cnt=e,t.test(cnt))return e}function RegexOut(e){var t=RegExp(Pregout,"i");if(cnt=e,t.test(cnt))RegoutList.push(cnt);else return e}function Scheck(e,t){if(name=e.replace(/tag\s*\=/g,"tag=").split("tag=")[1].toUpperCase(),t=t&&t.map(Dot2),t){for(var a=0,r=0;r<t.length;r++){var s=t[r].split(".").map(ToDot);const o=l=>name.indexOf(l.toUpperCase())!=-1;s.every(o)&&(a=1)}return a}else return 2}function Filter(e,t,a){var r=[],s=[],o=[];e=e.filter(Boolean);for(var l=0;l<e.length;l++)Scheck(e[l],t)!=0&&Scheck(e[l],a)!=1?(r.push(e[l]),o.push(e[l].replace(/ /g,"").split("tag=")[1])):s.push(e[l].replace(/ /g,"").split("tag=")[1]);var n=s.length<=10?emojino[s.length]:s.length,h=r.length<=10?emojino[r.length]:r.length;return Pntf0==1&&s.length>=1?t&&h>0?$notify("\u{1F465} \u5F15\u7528\u27E6"+subtag+"\u27E7 \u5F00\u59CB\u8282\u70B9\u7B5B\u9009","\u{1F579} \u7B5B\u9009\u5173\u952E\u5B57: "+pfi+pfo,"\u2620\uFE0F \u5DF2\u4FDD\u7559\u4EE5\u4E0B "+h+`\u4E2A\u8282\u70B9
`+o.join(", "),sub_link):a&&n>0&&$notify("\u{1F465} \u5F15\u7528\u27E6"+subtag+"\u27E7 \u5F00\u59CB\u8282\u70B9\u7B5B\u9009","\u{1F579} \u7B5B\u9009\u5173\u952E\u5B57: "+pfi+pfo,"\u2620\uFE0F \u5DF2\u5220\u9664\u4EE5\u4E0B "+n+`\u4E2A\u8282\u70B9
`+s.join(", "),sub_link):(h==0||h==null)&&$notify("\u203C\uFE0F \u27E6"+subtag+"\u27E7\u7B5B\u9009\u540E\u8282\u70B9\u6570\u4E3A0\uFE0F\u20E3","\u26A0\uFE0F \u8BF7\u81EA\u884C\u68C0\u67E5\u539F\u59CB\u94FE\u63A5\u4EE5\u53CA\u7B5B\u9009\u53C2\u6570",link0,sub_link),r}function FilterScript(servers,script){$notify("\u{1F916} \u542F\u7528\u811A\u672C\u8FDB\u884C\u7B5B\u9009","",script);try{const $=Tools();eval(script);const nodes=Tools().getNodeInfo(servers),IN=filter(nodes),res=servers.filter((e,t)=>IN[t]);return res.length===0&&$notify("\u203C\uFE0F \u27E6"+subtag+"\u27E7\u7B5B\u9009\u540E\u8282\u70B9\u6570\u4E3A0\uFE0F\u20E3","\u26A0\uFE0F \u8BF7\u81EA\u884C\u68C0\u67E5\u539F\u59CB\u94FE\u63A5\u4EE5\u53CA\u7B5B\u9009\u53C2\u6570",link0,sub_link),res}catch(e){return $notify("\u274C \u811A\u672C\u7B5B\u9009\u51FA\u73B0\u9519\u8BEF","",e),servers}}function SSR2QX(e,t,a){var r=[],s=Base64.decode(e.split("ssr://")[1].replace(/-/g,"+").replace(/_/g,"/")).split("\0")[0],o="",l="";return Pdbg==1&&$notify("ssr","content",s),s.split(":").length<=8?(type="shadowsocks=",ip=s.split(":")[0]+":"+s.split(":")[1],pwd="password="+Base64.decode(s.split("/?")[0].split(":")[5].replace(/-/g,"+").replace(/_/g,"/")).split("\0")[0],mtd="method="+s.split(":")[3],obfs=s.split(":")[4]!="plain"?"obfs="+s.split(":")[4]:"",ssrp=s.split(":")[2]!="origin"?"ssr-protocol="+s.split(":")[2]:"",s.indexOf("obfsparam=")!=-1&&obfs!=""&&(o=s.split("obfsparam=")[1].split("&")[0]!=""?"obfs-host="+Base64.decode(s.split("obfsparam=")[1].split("&")[0].replace(/-/g,"+").replace(/_/g,"/")).split(",")[0].split("\0")[0]:""),s.indexOf("protoparam=")!=-1&&(l=s.split("protoparam=")[1].split("&")[0]!=""?"ssr-protocol-param="+Base64.decode(s.split("protoparam=")[1].split("&")[0].replace(/-/g,"+").replace(/_/g,"/")).split(",")[0].split("\0")[0]:""),tag="tag="+Base64.decode(s.split("remarks=")[1].split("&")[0].replace(/-/g,"+").replace(/_/g,"/")).split("\0")[0],pudp=t==1?"udp-relay=true":"udp-relay=false",ptfo=a==1?"fast-open=true":"fast-open=false",r.push(type+ip,pwd,mtd,obfs,o,l,ssrp,pudp,ptfo,tag),QX=r.filter(Boolean).join(", ")):QX="",QX}function VL2QX(e,t,a,r,s){var o=[],l=e.split("vless://")[1];return type="vless=",mtd="method=none",obfs="",thost="",l.indexOf("remarks=")==-1&&l.indexOf("@")!=-1?(typeU="URI",ip=l.split("@")[1].split("encry")[0].split("?")[0],pwd=l.split("@")[0]?"password="+l.split("@")[0]:"",pcert=l.indexOf("allowInsecure=0")!=-1?"tls-verification=true":"tls-verification=false",thost=l.indexOf("sni=")!=-1?"tls-host="+l.split("sni=")[1].split(/&|#/)[0]:"",thost=l.indexOf("peer=")!=-1?"tls-host="+l.split("peer=")[1].split(/&|#/)[0]:thost,tag=l.indexOf("#")!=-1?"tag="+decodeURIComponent(l.split("#").slice(-1)[0]):"tag= [vless]"+ip):(typeU="SR-URI",tag=l.indexOf("remarks=")!=-1?"tag="+decodeURIComponent(l.split("remarks=")[1].split("&")[0]):"tag= [vless]"+ip,b64part=Base64.decode(l.split("?")[0]),ip=b64part.split("@")[1],pwd="password="+b64part.split("@")[0].split(":")[1]),puri="",pudp=t==1||l.indexOf("udp=1")!=-1?"udp-relay=true":"udp-relay=false",ptfo=a==1||l.indexOf("tfo=1")!=-1?"fast-open=true":"fast-open=false",typeU=="SR-URI"?(l.indexOf("obfs=none")!=-1&&l.indexOf("tls=1")==-1?obfs="":l.indexOf("obfs=none")!=-1&&l.indexOf("tls=1")!=-1?obfs="obfs=over-tls":l.indexOf("obfs=http")!=-1?obfs="obfs=http":l.indexOf("obfs=websocket")!=-1&&(obfs=l.indexOf("tls=1")!=-1?"obfs=wss":"obfs=ws"),thost=l.indexOf("obfsParam=")==-1?thost:"obfs-host="+decodeURIComponent(l.split("obfsParam=")[1].split("&")[0].split("#")[0]).replace(/\"|(Host\":)|\{|\}/g,""),puri=l.indexOf("path=")==-1?puri:"obfs-uri="+decodeURIComponent(l.split("path=")[1].split("&")[0].split("#")[0])):l.indexOf("&type=ws")!=-1||l.indexOf("?type=ws")!=-1||l.indexOf("type=http")!=-1||l.indexOf("security=tls")!=-1?(l.indexOf("type=http")!=-1?obfs="obfs=http":l.indexOf("type=ws")!=-1?obfs=l.indexOf("security=tls")!=-1?"obfs=wss":"obfs=ws":l.indexOf("security=tls")!=-1&&(obfs="obfs=over-tls"),thost=l.indexOf("&host=")==-1?thost:"obfs-host="+decodeURIComponent(l.split("&host=")[1].split("&")[0].split("#")[0]),puri=l.indexOf("&path=")==-1?puri:"obfs-uri="+decodeURIComponent(l.split("&path=")[1].split("&")[0].split("#")[0])):(l.indexOf("security=xtls")!=-1||l.indexOf("type=")!=-1&&l.indexOf("type=tcp")==-1)&&(type="NS"),obfs=="obfs=wss"&&obfs=="obfs=over-tls"?(ptls13=s==1?"tls13=true":"tls13=false",r==0?pcert="tls-verification=false":r==1&&(pcert="tls-verification=true")):(pcert="",ptls13=""),o.push(type+ip,pwd,mtd,obfs,pcert,thost,puri,pudp,ptfo,tag),QX=type!="NS"?o.filter(Boolean).join(", "):"",QX}function TJ2QX(e,t,a,r,s){var o=[],l=e.split("trojan://")[1];return type="trojan=",l.indexOf(":443")!=-1?ip=l.split("@")[1].split(":443")[0]+":443":ip=l.split("@")[1].split("?")[0].split(`
`)[0].split("#")[0].trim(),pwd=l.split("@")[0]?"password="+decodeURIComponent(l.split("@")[0]):"",obfs="over-tls=true",pcert=l.indexOf("allowInsecure=0")!=-1?"tls-verification=true":"tls-verification=false",thost=l.indexOf("sni=")!=-1?"tls-host="+l.split("sni=")[1].split(/&|#/)[0]:"",thost=l.indexOf("peer=")!=-1?"tls-host="+l.split("peer=")[1].split(/&|#/)[0]:thost,ptls13=s==1?"tls13=true":"tls13=false",puri="",r==0?pcert="tls-verification=false":r==1&&(pcert="tls-verification=true"),pudp=t==1||l.indexOf("udp=1")!=-1?"udp-relay=true":"udp-relay=false",ptfo=a==1||l.indexOf("tfo=1")!=-1?"fast-open=true":"fast-open=false",tag=l.indexOf("#")!=-1?"tag="+decodeURIComponent(l.split("#").slice(-1)[0]):"tag= [trojan]"+ip,l.indexOf("&plugin=obfs-local")!=-1?(obfs=l.indexOf("obfs=websocket")!=-1?"obfs=wss":obfs,thost=l.indexOf("obfs-host=")==-1?thost:"obfs-host="+decodeURIComponent(l.split("obfs-host=")[1].split(";")[0].split("#")[0]),puri=l.indexOf("obfs-uri=")==-1?puri:"obfs-uri="+decodeURIComponent(l.split("obfs-uri=")[1].split(";")[0].split("#")[0])):(l.indexOf("&type=ws")!=-1||l.indexOf("?type=ws")!=-1)&&(obfs=l.indexOf("security=tls")!=-1?"obfs=wss":obfs,thost=l.indexOf("&host=")==-1?thost:"obfs-host="+decodeURIComponent(l.split("&host=")[1].split("&")[0].split("#")[0]),puri=l.indexOf("&path=")==-1?puri:"obfs-uri="+decodeURIComponent(l.split("&path=")[1].split("&")[0].split("#")[0])),o.push(type+ip,pwd,obfs,pcert,thost,puri,pudp,ptfo,tag),QX=o.filter(Boolean).join(", "),QX}function joinx(e,t){return e+":"+t}function SS2QX(e,t,a){var r=[],s=e.split("ss://")[1];if(QX="",s.split(":").length<=10){type="shadowsocks=";let n=s.split("#")[0];if(n.indexOf("@")!=-1&&n.indexOf(":")!=-1)ip=s.split("@")[1].split("#")[0].split("/")[0].split("?")[0],n.indexOf("%")==-1||n.split("@")[0].indexOf(":")==-1?pwdmtd=Base64.decode(s.split("@")[0].replace(/-/g,"+").replace(/_/g,"/")).split("\0")[0].split(":"):pwdmtd=decodeURIComponent(s.split("@")[0]).split(":");else if(n.indexOf("?")==-1){var o=Base64.decode(s.split("#")[0].replace(/-/g,"+").replace(/_/g,"/").split("\0")[0]);ip=o.split("@")[1].split("#")[0].split("/")[0],pwdmtd=o.split("@")[0].split(":")}else if(n.indexOf("?")!=-1){var o=Base64.decode(s.split("#")[0].split("?")[0].replace(/-/g,"+").replace(/_/g,"/").split("\0")[0]),l=Base64.decode(s.split("#")[0].split("?")[1].split("=")[1].replace(/-/g,"+").replace(/_/g,"/").split("\0")[0]);ip=o.split("@")[1].split("#")[0].split("/")[0],pwdmtd=o.split("@")[0].split(":")}Pdbg&&$notify("dd","",pwdmtd),mtd="method="+pwdmtd[0],pwdmtd.splice(0,1),pwd="password="+pwdmtd.reduce(joinx),n.indexOf("v2ray-plugin")==-1&&n.indexOf("plugin=v2ray")==-1?(obfs=s.split("obfs%3D")[1]!=null?", obfs="+s.split("obfs%3D")[1].split("%3B")[0].split("#")[0]:"",obfshost=s.split("obfs-host%3D")[1]!=null?", obfs-host="+s.split("obfs-host%3D")[1].split("&")[0].split("#")[0]:""):l!=null?(l=JSON.parse(l),obfs=l.tls?", obfs=wss":", obfs=ws",obfshost=l.host?", obfs-host="+l.host+", tls-verification=false":""):n.indexOf("v2ray-plugin")!=-1?(l=decodeURIComponent(n.split("v2ray-plugin")[1]),obfs=l.indexOf("tls")!=-1?", obfs=wss":", obfs=ws",obfshost=l.indexOf("host=")!=-1?", obfs-host="+l.split("host=")[1].split(";")[0].split("#")[0].trim():"",obfshost=obfshost!="obfs-host="?obfshost:""):n.indexOf("plugin=v2ray")!=-1&&(l=decodeURIComponent(n.split("plugin=v2ray")[1]),obfs=l.indexOf("tls")!=-1?", obfs=wss":", obfs=ws",obfshost=l.indexOf("host=")!=-1?", obfs-host="+l.split("host=")[1].split(";")[0].split("#")[0].trim():"",obfshost=obfshost!="obfs-host="?obfshost:""),tag=decodeURIComponent(s.split("#")[1])!="undefined"?"tag="+decodeURIComponent(s.split("#")[1]):"tag="+ip,pudp=t==1?"udp-relay=true":"udp-relay=false",ptfo=a==1?"fast-open=true":"fast-open=false",r.push(type+ip,pwd,mtd+obfs+obfshost,pudp,ptfo,tag),QX=r.join(", "),Pdbg==1&&$notify("SS","content",s+`
`+QX)}return QX}function SSD2QX(e,t,a){var r=0,s=[],o=JSON.parse(Base64.decode(e.split("ssd://")[1])),l="shadowsocks=",n="password="+o.password,h="method="+o.encryption,m="",x="",u=o.port?":"+o.port:"";o.plugin_options&&(m=o.plugin_options.split(";")[0]!=null?", "+o.plugin_options.split(";")[0]:"",x=o.plugin_options.split(";")[1]!=null?", "+o.plugin_options.split(";")[1]:""),pudp=t==1?"udp-relay=true":"udp-relay=false",ptfo=a==1?"fast-open=true":"fast-open=false";for(var p in o.servers)if(ip=o.servers[p].server,o.servers[p].plugin_options&&(m=o.servers[p].plugin_options.split(";")[0]!=null?", "+o.servers[p].plugin_options.split(";")[0]:"",x=o.servers[p].plugin_options.split(";")[1]!=null?", "+o.servers[p].plugin_options.split(";")[1]:""),o.servers[p].encryption&&(h="method="+o.servers[p].encryption),o.servers[p].password&&(n="password="+o.servers[p].password),ip.indexOf(".")>0){u=o.servers[p].port?":"+o.servers[p].port:u,tag="tag="+o.servers[p].remarks,s[r]=l+ip+u+", "+n+", "+h+m+x+", "+pudp+", "+ptfo+", "+tag;var r=r+1}return s}function QXFix(e){var t=e.replace(/\s*tag\s*\=/g,"tag=").replace("chacha20-poly","chacha20-ietf-poly");try{var a=t.split(",tag=")[0],r="tag="+t.split(",tag=")[1].split(",")[0].trim(),s=t.split(r+",");t=s.length<=1?t:a+","+s[1].split("\r")[0]+","+r,cntis=t.split(",").filter(Boolean).map(o=>o.trim()),tagfix="",cntii="";for(i in cntis)cntis[i].indexOf("=")==-1&&cntis[i].trim()!=""?tagfix+=","+cntis[i]:cntis[i].indexOf("tag=")!=0?cntii+=cntis[i]+", ":cntii=cntii;return cntii=cntii+r+tagfix,cntii}catch(o){Perror==0&&$notify("\u274C \u89E3\u6790\u51FA\u73B0\u9519\u8BEF,\u5DF2\u5FFD\u7565\u8BE5\u6761\u76EE","\u26A0\uFE0F \u8BF7\u70B9\u51FB\u901A\u77E5\uFF0C\u53D1\u9001\u8BA2\u9605\u94FE\u63A5\u8FDB\u884C\u53CD\u9988",e+`
`+o,bug_link)}return""}function isQuanX(e){for(var t=e.split(`
`),a=[],r=0;r<t.length;r++){var s=t[r];if(s.indexOf("=")!=-1&&s.indexOf("tag")!=-1){var o=s.split("=")[0].trim();(o=="http"||o=="shadowsocks"||o=="trojan"||o=="vmess"||o=="socks5"||o=="vless")&&a.push(QXFix(s))}}return a}function isQuanXRewrite(e){cnt=e.filter(Boolean),cnt0=[];for(var t=["host,","-suffix,","DOMAIN","domain,","-keyword,","ip-cidr,","ip-cidr6,","geoip,","user-agent,","ip6-cidr,","force-http","ip-asn"],a=0;a<cnt.length;a++)if(cnt[a]){var r=cnt[a].trim();const s=o=>r.toLowerCase().indexOf(o)!=-1;r.indexOf("pattern")!=-1&&r.indexOf("type")!=-1||r.indexOf("http-r")!=-1||(r.indexOf(" 302")!=-1||r.indexOf(" 307")!=-1||/\s(_|-)\s(reject|REJECT)/.test(r)||/\sreject$/.test(r)||/\sreject-/.test(r))&&r.indexOf(" url ")==-1&&r.indexOf(" url-and-header ")==-1?r=SGMD2QX(r)[0]?SGMD2QX(r)[0]:"":r.indexOf(" data=")!=-1?r=SGMD2QX(`[Map Local]
`+r)[0]?SGMD2QX(`[Map Local]
`+r)[0]:"":r.indexOf("URL-REGEX")!=-1||r.indexOf(" header")!=-1||r.replace(/ /g,"").indexOf("hostname=")!=-1?r=SGMD2QX(r)[0]?SGMD2QX(r)[0]:"":r.indexOf(" url ")!=-1&&r.indexOf(" simple-response ")==-1&&r.indexOf(" url = ")==-1?(r=r.replace("^http","http"),r=r.split(" ")[1]=="url"?r:""):r.indexOf(" url-and-header ")!=-1?r=r:t.some(s)&&Pmix==1?r=Rule_Policy(r):(Pjsonjq==0&&r.indexOf(" url jsonjq-")!=-1,r=""),r!=""&&r.trim()[0]!="["&&r.indexOf("RULE-SET")==-1&&!/cronexp\=|type\=cron/.test(r.replace(/ /g,""))&&(/\;$/.test(r)||cnt0.push(r))}return cnt0}function QXSort(e,t){var a=e;return t==1?a.sort(ToTag):t==-1?a.sort(ToTagR):t=="x"?shuffle(a):t=="0"?a:Sort_KWD(a,t)}function ToTag(e,t){var a=e.split("tag")[1].split("=")[1].trim(),r=t.split("tag")[1].split("=")[1].trim();return res=a>r?1:-1,res}function ToTagR(e,t){var a=e.split("tag")[1].split("=")[1].trim(),r=t.split("tag")[1].split("=")[1].trim();return res=a>r?-1:1,res}function shuffle(e){for(var t=e,a=t.length-1;a>=0;a--){var r=Math.floor(Math.random()*(a+1)),s=t[r];t[r]=t[a],t[a]=s}return t}function Sort_KWD(e,t){strlist=t.indexOf("<")!=-1?t.split("<"):t.split(">"),regj=strlist.map(o=>RegExp(o,"i")),dir=t.indexOf("<")!=-1?-1:1;for(var a=new Array(strlist.length+1),r=0;r<a.length;r++)a[r]=[];for(var r=0;r<e.length;r++){flag=0;for(var s=0;s<strlist.length;s++)if(regj[s].test(e[r])){a[s].push(e[r]),flag=1;break}flag!=1&&a[strlist.length].push(e[r])}return a=PsortX==-1?a.map(o=>o.sort(ToTagR)):a,a=PsortX==1?a.map(o=>o.sort(ToTag)):a,newarr=MixArr(a,dir),newarr}function MixArr(e,t){var a=[];for(i=0;i<e.length-1;i++)a=t==1?a.concat(e[i]):a.concat(e[e.length-2-i]);return a=t==1?a.concat(e[e.length-1].sort(ToTag)):e[e.length-1].sort(ToTagR).concat(a),a}function DelReg(e){return delreg=RegExp(delreg,"gmi"),e=e.replace(/tag\s*\=\s*/,"tag="),cnt0=e.split("tag=")[0],cnt1=e.split("tag=")[1].split(",")[0],cnt2=e.split("tag=")[1].split(",").length==1?"":e.split(cnt1)[1],cnt=cnt0+"tag="+cnt1.replace(delreg,"")+cnt2,cnt}function Rename(e){var t=e;if(t.indexOf("tag=")!=-1){hd=t.split("tag=")[0],name=t.split("tag=")[1].split(",")[0].trim(),tail=t.split("tag=")[1].split(",").length<=1?"":t.split("tag=")[1].split(name)[1];for(var a=0;a<Prn.length;a++){if(nname=Prn[a].split("@")[1]?decodeURIComponent(Prn[a].split("@")[1]):Prn[a].split("@")[1],oname=Prn[a].split("@")[0]?decodeURIComponent(Prn[a].split("@")[0]):Prn[a].split("@")[0],oname&&nname){var r=escapeRegExp(oname);name=name.replace(new RegExp(r,"gm"),nname)}else if(oname&&nname==""){var s=emoji_del(name);(Pemoji==1||Pemoji==2)&&Prname?name=oname+s:name=oname+name.trim()}else if(nname&&oname=="")name=name.trim()+nname;else if(oname&&oname.indexOf("\u2620\uFE0F")!=-1)for(hh=Dot2(oname.slice(0,oname.length-2)).split("."),j=0;j<hh.length;j++){var o=escapeRegExp(ToDot(hh[j])),l=new RegExp(o,"gm");name=name.replace(l,"")}else oname==""&&nname==""?name=name.replace(/@/g,""):name=name;nserver=hd+"tag="+name+tail}return nserver}else return t}function RenameScript(servers,script){$notify("\u{1F916} \u542F\u7528\u811A\u672C\u8FDB\u884C\u91CD\u547D\u540D","",script);try{const $=Tools().rename,nodes=Tools().getNodeInfo(servers);eval(script);const newNames=rename(nodes);return servers.map((e,t)=>e.split("tag=")[0]+"tag="+newNames[t])}catch(e){return $notify("\u274C \u811A\u672C\u91CD\u547D\u540D\u51FA\u73B0\u9519\u8BEF","",e),servers}}function emoji_del(e){return e.replace(/[\uD83C][\uDDE6-\uDDFF][\uD83C][\uDDE6-\uDDFF]/g,"").trim()}function get_emoji(e,t){var a={"\u{1F3F3}\uFE0F\u200D\u{1F308}":["\u6D41\u91CF","\u5957\u9910","\u5269\u4F59","\u91CD\u7F6E","\u5230\u671F","\u65F6\u95F4","\u5E94\u6025","\u8FC7\u671F","Bandwidth","expire","Traffic","traffic"],"\u{1F1F4}\u{1F1F2}":["\u963F\u66FC"," OM "],"\u{1F1E6}\u{1F1E9}":["\u5B89\u9053\u5C14","\u5B89\u9053\u723E","Andorra"],"\u{1F1E6}\u{1F1F4}":["\u5B89\u54E5\u62C9"],"\u{1F1E6}\u{1F1EB}":["\u963F\u5BCC\u6C57"],"\u{1F1E9}\u{1F1FF}":["\u963F\u5C14\u53CA\u5229\u4E9A","\u963F\u723E\u53CA\u5229\u4E9E"],"\u{1F1EB}\u{1F1F4}":["\u6CD5\u7F85\u7FA4\u5CF6","\u6CD5\u7F57\u7FA4\u5C9B"],"\u{1F1E7}\u{1F1F2}":["\u767E\u6155\u5927"],"\u{1F1E6}\u{1F1FD}":["\u5967\u862D\u7FA4\u5CF6","\u5965\u5170\u7FA4\u5C9B"],"\u{1F1E6}\u{1F1FF}":["\u963F\u585E\u62DC\u7586","Azerbaijan"],"\u{1F1E6}\u{1F1F9}":["\u5965\u5730\u5229","\u5967\u5730\u5229","Austria","\u7EF4\u4E5F\u7EB3"],"\u{1F1E6}\u{1F1FA}":["AU","Australia","Sydney","\u6FB3\u5927\u5229\u4E9A","\u6FB3\u6D32","\u58A8\u5C14\u672C","\u6089\u5C3C","\u571F\u6FB3","\u4EAC\u6FB3","\u5EE3\u6FB3","\u6EEC\u6FB3","\u6CAA\u6FB3","\u5E7F\u6FB3"],"\u{1F1E7}\u{1F1EA}":["BE","\u6BD4\u5229\u6642","\u6BD4\u5229\u65F6","Belgium"],"\u{1F1E7}\u{1F1EC}":["\u4FDD\u52A0\u5229\u4E9A","\u4FDD\u52A0\u5229\u4E9E","Bulgaria"],"\u{1F1F5}\u{1F1F0}":["\u5DF4\u57FA\u65AF\u5766","Pakistan","PAKISTAN"],"\u{1F1E7}\u{1F1ED}":["\u5DF4\u6797","Bahrain"],"\u{1F1F5}\u{1F1FE}":["\u5DF4\u62C9\u572D","Paraguay"],"\u{1F1E7}\u{1F1E7}":["\u5DF4\u5DF4\u591A\u65AF"],"\u{1F1EC}\u{1F1F6}":["\u8D64\u9053\u51E0\u5185\u4E9A","\u8D64\u9053\u5E7E\u5167\u4E9E"],"\u{1F1F9}\u{1F1F1}":["\u4E1C\u5E1D\u6C76","\u6771\u5E1D\u6C76"],"\u{1F1F0}\u{1F1ED}":["\u67EC\u57D4\u5BE8","Cambodia"],"\u{1F1FF}\u{1F1FC}":["\u6D25\u5DF4\u5E03\u97E6","\u6D25\u5DF4\u5E03\u97CB"],"\u{1F1FA}\u{1F1E6}":["\u70CF\u514B\u862D","\u4E4C\u514B\u5170","Ukraine"],"\u{1F1FA}\u{1F1FF}":["\u4E4C\u5179\u522B\u514B\u65AF\u5766","\u70CF\u8332\u5225\u514B\u65AF\u5766","Uzbekistan"],"\u{1F1ED}\u{1F1F7}":["\u514B\u7F57\u5730\u4E9A","HR","\u514B\u7F85\u5730\u4E9E","Croatia"],"\u{1F1E8}\u{1F1E6}":["CA","Canada","CANADA","CAN","Waterloo","\u52A0\u62FF\u5927","\u8499\u7279\u5229\u5C14","\u6E29\u54E5\u534E","\u6953\u8449","\u67AB\u53F6","\u6ED1\u94C1\u5362","\u591A\u4F26\u591A"],"\u{1F1E8}\u{1F1ED}":["\u745E\u58EB","\u82CF\u9ECE\u4E16","Switzerland","CH "],"\u{1F1F3}\u{1F1EC}":["\u5C3C\u65E5\u5229\u4E9A","NG","\u5C3C\u65E5\u5229\u4E9E","\u62C9\u5404\u65AF","Nigeria"],"\u{1F1E8}\u{1F1FF}":["Czechia","\u6377\u514B"],"\u{1F1F8}\u{1F1F0}":["\u65AF\u6D1B\u4F10\u514B","SK","Slovakia"],"\u{1F1F8}\u{1F1EE}":["\u65AF\u6D1B\u6587\u5C3C\u4E9A","\u65AF\u6D1B\u6587\u5C3C\u4E9E","Slovenia"],"\u{1F1E6}\u{1F1F2}":["\u4E9A\u7F8E\u5C3C\u4E9A","\u4E9E\u7F8E\u5C3C\u4E9E","Armenia"],"\u{1F1F7}\u{1F1F8}":["RS ","RS_","\u585E\u5C14\u7EF4\u4E9A","\u585E\u723E\u7DAD\u4E9E","Seville","Sevilla"],"\u{1F1F2}\u{1F1E9}":["\u6469\u723E\u591A\u74E6"," MD-","\u6469\u5C14\u591A\u74E6","Moldova"," MD "],"\u{1F1E9}\u{1F1EA}":["DE ","DE-","DE_","German","GERMAN","\u5FB7\u56FD","\u5FB7\u570B","\u6CD5\u5170\u514B\u798F","\u4EAC\u5FB7","\u6EEC\u5FB7","\u5EE3\u5FB7","\u6CAA\u5FB7","\u5E7F\u5FB7"],"\u{1F1E9}\u{1F1F0}":["DK","DNK","\u4E39\u9EA6","\u4E39\u9EA5","Denmark"],"\u{1F1EA}\u{1F1F8}":["ES","\u897F\u73ED\u7259","Spain"],"\u{1F1EA}\u{1F1FA}":["EU","\u6B27\u76DF","\u6B27\u7F57\u5DF4","\u6B27\u6D32","European"],"\u{1F1EB}\u{1F1EE}":["Finland","\u82AC\u5170","\u82AC\u862D","\u8D6B\u5C14\u8F9B\u57FA"],"\u{1F1EB}\u{1F1F7}":["FR","France","\u6CD5\u56FD","\u6CD5\u570B","\u5DF4\u9ECE"],"\u{1F1F7}\u{1F1EA}":["\u7559\u5C3C\u6C6A","\u7559\u5C3C\u65FA","R\xE9union","Reunion"],"\u{1F1E8}\u{1F1FC}":["\u5E93\u62C9\u7D22","\u5EAB\u62C9\u7D22","Cura\xE7ao"],"\u{1F1EC}\u{1F1E7}":["UK","GB ","England","United Kingdom","\u82F1\u56FD","\u4F26\u6566","\u82F1","Britain"],"\u{1F1F2}\u{1F1F4}":["MO","Macao","Macau","MAC","\u6FB3\u95E8","\u6FB3\u9580","CTM"],"\u{1F1F0}\u{1F1FF}":["\u54C8\u8428\u514B\u65AF\u5766","\u54C8\u85A9\u514B\u65AF\u5766","Kazakhstan"],"\u{1F1F1}\u{1F1E6}":["\u8001\u631D","\u8001\u631D","Laos"],"\u{1F1ED}\u{1F1FA}":["\u5308\u7259\u5229","Hungary"],"\u{1F1ED}\u{1F1F3}":["\u6D2A\u90FD\u62C9\u65AF"],"\u{1F1F1}\u{1F1F9}":["\u7ACB\u9676\u5B9B","Lithuania"],"\u{1F1F1}\u{1F1F0}":["\u65AF\u91CC\u5170\u5361","\u65AF\u91CC\u862D\u5361","Sri Lanka"],"\u{1F1E7}\u{1F1FE}":["BY","\u767D\u4FC4\u7F57\u65AF","\u767D\u4FC4\u7F85\u65AF","White Russia","Republic of Belarus","Belarus"],"\u{1F1F7}\u{1F1FA}":["RU ","RU-","RU_","RUS","Russia","\u4FC4\u7F57\u65AF","\u6BDB\u5B50","\u4FC4\u56FD","\u4FC4\u7F85\u65AF","\u4F2F\u529B","\u83AB\u65AF\u79D1","\u5723\u5F7C\u5F97\u5821","\u897F\u4F2F\u5229\u4E9A","\u65B0\u897F\u4F2F\u5229\u4E9A","\u4EAC\u4FC4","\u676D\u4FC4","\u5EE3\u4FC4","\u6EEC\u4FC4","\u5E7F\u4FC4","\u6CAA\u4FC4"],"\u{1F1F8}\u{1F1EC}":["SG","Singapore","SINGAPORE","\u65B0\u52A0\u5761","\u72EE\u57CE","\u7345\u57CE","\u6CAA\u65B0","\u4EAC\u65B0","\u6CC9\u65B0","\u7A57\u65B0","\u6DF1\u65B0","\u676D\u65B0","\u5E7F\u65B0","\u5EE3\u65B0","\u6EEC\u65B0"],"\u{1F1FA}\u{1F1F8}":["US","USA","America","United States","\u7F8E\u56FD","\u7F8E","\u4EAC\u7F8E","\u6CE2\u7279\u5170","\u8FBE\u62C9\u65AF","\u4FC4\u52D2\u5188","\u51E4\u51F0\u57CE","\u8D39\u5229\u8499","\u7845\u8C37","\u77FD\u8C37","\u62C9\u65AF\u7EF4\u52A0\u65AF","\u6D1B\u6749\u77F6","\u5723\u4F55\u585E","\u5723\u8377\u897F","\u5723\u514B\u62C9\u62C9","\u897F\u96C5\u56FE","\u829D\u52A0\u54E5","\u6CAA\u7F8E","\u54E5\u4F26\u5E03","\u7EBD\u7EA6"],"\u{1F1F9}\u{1F1FC}":["TW","Taiwan","TAIWAN","\u53F0\u6E7E","\u53F0\u5317","\u53F0\u4E2D","\u65B0\u5317","\u5F70\u5316","CHT","\u53F0","HINET"],"\u{1F1EE}\u{1F1E9}":["ID ","IDN ","Indonesia","\u5370\u5C3C","\u5370\u5EA6\u5C3C\u897F\u4E9A","\u96C5\u52A0\u8FBE"],"\u{1F1EE}\u{1F1EA}":["Ireland","IRELAND","IE ","\u7231\u5C14\u5170","\u611B\u723E\u862D","\u90FD\u67CF\u6797"],"\u{1F1EE}\u{1F1F1}":["Israel","\u4EE5\u8272\u5217"],"\u{1F1EE}\u{1F1F3}":["India","IND","INDIA","\u5370\u5EA6","\u5B5F\u4E70","Mumbai","IN "],"\u{1F1EE}\u{1F1F8}":["IS","ISL","\u51B0\u5C9B","\u51B0\u5CF6","Iceland"],"\u{1F1F0}\u{1F1F5}":["KP","\u671D\u9C9C","North Korea","\u671D\u9BAE"],"\u{1F1F0}\u{1F1F7}":["KR","Korea","KOR","\u97E9\u56FD","\u9996\u5C14","\u97E9","\u97D3","\u6625\u5DDD"],"\u{1F1EC}\u{1F1ED}":["\u52A0\u7EB3","Ghana","\u8FE6\u7D0D"],"\u{1F1F1}\u{1F1FA}":["\u5362\u68EE\u5821","\u76E7\u68EE\u5821","LU ","Luxembourg"],"\u{1F1F1}\u{1F1FB}":["Latvia","Latvija","\u62C9\u8131\u7EF4\u4E9A"],"\u{1F1E7}\u{1F1E9}":["\u5B5F\u52A0\u62C9","Bengal"],"\u{1F1F2}\u{1F1FD}\uFE0F":[" MEX","MX","\u58A8\u897F\u54E5","Mexico","MEXICO"],"\u{1F1F2}\u{1F1FE}":[" MY","Malaysia","MALAYSIA","\u9A6C\u6765\u897F\u4E9A","\u9A6C\u6765","\u99AC\u4F86","\u5927\u9A6C","\u5927\u99AC","\u99AC\u4F86\u897F\u4E9E","\u5409\u9686\u5761"],"\u{1F1F2}\u{1F1F2}":["\u7F05\u7538","\u7DEC\u7538"],"\u{1F1F3}\u{1F1EE}":["\u5C3C\u52A0\u62C9\u74DC"],"\u{1F1F3}\u{1F1F1}":[" NL","Netherlands","\u8377\u5170","\u8377\u862D","\u5C3C\u5FB7\u862D","\u963F\u59C6\u65AF\u7279\u4E39"],"\u{1F1F5}\u{1F1ED}":[" PH","Philippines","\u83F2\u5F8B\u5BBE","\u83F2\u5F8B\u8CD3"],"\u{1F1F7}\u{1F1F4}":[" RO ","\u7F57\u9A6C\u5C3C\u4E9A","Rumania","\u7F85\u99AC\u5C3C\u4E9E"],"\u{1F1F8}\u{1F1E6}":["\u6C99\u7279","\u5229\u96C5\u5F97","Saudi Arabia","Saudi"],"\u{1F1F8}\u{1F1EA}":["SE","Sweden","\u745E\u5178"],"\u{1F1F9}\u{1F1ED}":[" TH","Thailand","\u6CF0\u56FD","\u6CF0\u570B","\u66FC\u8C37"],"\u{1F1F9}\u{1F1F7}":["TR ","TR-","TR_","TUR","Turkey","\u571F\u8033\u5176","\u4F0A\u65AF\u5766\u5E03\u5C14"],"\u{1F1FB}\u{1F1F3}":["VN","\u8D8A\u5357","\u80E1\u5FD7\u660E\u5E02","Vietnam"],"\u{1F1EE}\u{1F1F9}":["Italy"," IT ","Nachash","\u610F\u5927\u5229","\u7C73\u5170","\u7FA9\u5927\u5229"],"\u{1F1FF}\u{1F1E6}":["South Africa","\u5357\u975E","Johannesburg"],"\u{1F1E6}\u{1F1EA}":["United Arab Emirates","\u963F\u8054\u914B","AE ","\u8FEA\u62DC","\u963F\u806F\u914B","Dubai"],"\u{1F1E7}\u{1F1F7}":["BR","Brazil","\u5DF4\u897F","\u5723\u4FDD\u7F57"],"\u{1F1EF}\u{1F1F5}":["JP","Japan","JAPAN","\u65E5\u672C","\u4E1C\u4EAC","\u5927\u962A","\u57FC\u7389","\u4EAC\u65E5","\u82CF\u65E5","\u6CAA\u65E5","\u4E0A\u65E5","\u7A57\u65E5","\u5DDD\u65E5","\u4E2D\u65E5","\u6CC9\u65E5","\u676D\u65E5","\u6DF1\u65E5","\u8FBD\u65E5","\u5E7F\u65E5","Tokyo"],"\u{1F1E6}\u{1F1F7}":["AR ","Argentina","\u963F\u6839\u5EF7","AR-"],"\u{1F1F3}\u{1F1F4}":["Norway","\u632A\u5A01","NO"],"\u{1F1F5}\u{1F1F1}":[" PL","POL","\u6CE2\u5170","\u6CE2\u862D","Poland"],"\u{1F1E8}\u{1F1F1}":["\u667A\u5229","Chile","CHILE"],"\u{1F1F3}\u{1F1FF}":["\u65B0\u897F\u862D","\u65B0\u897F\u5170","New Zealand"],"\u{1F1EC}\u{1F1F7}":["\u5E0C\u814A","\u5E0C\u81D8","Greece"],"\u{1F1EA}\u{1F1EC}":["\u57C3\u53CA","Egypt"],"\u{1F1EE}\u{1F1F2}":["\u9A6C\u6069\u5C9B","\u99AC\u6069\u5CF6","Isle of Man","Mannin"],"\u{1F1F5}\u{1F1F9}":["\u8461\u8404\u7259","Portugal"],"\u{1F1F2}\u{1F1F3}":["\u8499\u53E4","Mongolia"],"\u{1F1F5}\u{1F1EA}":["\u79D8\u9C81","\u7955\u9B6F","Peru"],"\u{1F1E8}\u{1F1F4}":["\u54E5\u4F26\u6BD4\u4E9A","\u54E5\u502B\u6BD4\u4E9E","Colombia"],"\u{1F1EA}\u{1F1EA}":["\u7231\u6C99\u5C3C\u4E9A","\u611B\u6C99\u5C3C\u4E9E","Estonia"],"\u{1F1F1}\u{1F1FE}":["\u5229\u6BD4\u4E9A","\u5229\u6BD4\u4E9E","Libya"],"\u{1F1F2}\u{1F1F0}":["\u9A6C\u5176\u987F","\u99AC\u5176\u9813","Macedonia"],"\u{1F1F2}\u{1F1F9}":["\u9A6C\u8033\u4ED6","\u99AC\u5176\u4ED6","Malta"],"\u{1F1FB}\u{1F1EA}":["\u59D4\u5185\u745E\u62C9","Venezuela"],"\u{1F1E7}\u{1F1E6}":["\u6CE2\u9ED1\u5171\u548C\u56FD","\u6CE2\u9ED1","Bosnia and Herzegovina"],"\u{1F1EC}\u{1F1EA}":["\u683C\u9B6F\u5409\u4E9E","\u683C\u9C81\u5409\u4E9A","Georgia"],"\u{1F1E6}\u{1F1F1}":["\u963F\u723E\u5DF4\u5C3C\u4E9E","\u963F\u5C14\u5DF4\u5C3C\u4E9A","Albania"],"\u{1F1E8}\u{1F1FE}":["CY","\u585E\u6D66\u8DEF\u65AF","Cyprus"],"\u{1F1E8}\u{1F1F7}":["\u54E5\u65AF\u8FBE\u9ECE\u52A0","\u54E5\u65AF\u9054\u5C3C\u52A0","Costa Rica"],"\u{1F1F9}\u{1F1F3}":["\u7A81\u5C3C\u65AF","Tunisia"],"\u{1F1FB}\u{1F1E6}":["\u68B5\u8482\u5188","\u68B5\u8482\u5CA1"],"\u{1F1F7}\u{1F1FC}":["\u5362\u65FA\u8FBE","\u76E7\u65FA\u9054"],"\u{1F1F5}\u{1F1E6}":["\u5DF4\u62FF\u9A6C","\u5DF4\u62FF\u99AC","Panama"],"\u{1F1EE}\u{1F1F7}":["\u4F0A\u6717","Iran"],"\u{1F1EF}\u{1F1F4}":["\u7EA6\u65E6","\u7D04\u65E6","Jordan"],"\u{1F1FA}\u{1F1FE}":["\u4E4C\u62C9\u572D","\u70CF\u62C9\u572D","Uruguay"],"\u{1F1F0}\u{1F1EA}":["\u80AF\u5C3C\u4E9A","\u80AF\u5C3C\u4E9E","Kenya"],"\u{1F1F0}\u{1F1EC}":["\u5409\u5C14\u5409\u65AF\u5766","\u5409\u5C14\u5409\u65AF\u65AF\u5766","Kyrghyzstan"],"\u{1F1F3}\u{1F1F5}":["\u5C3C\u6CCA\u5C14","\u5C3C\u6CCA\u723E","Nepal"],"\u{1F1FD}\u{1F1F0}":["\u79D1\u7D22\u6C83","Kosovo"],"\u{1F1F2}\u{1F1E6}":["\u6469\u6D1B\u54E5","Morocco"],"\u{1F1EA}\u{1F1E8}":["\u5384\u74DC\u591A\u5C14","\u5384\u74DC\u591A\u723E","EC","Ecuador"],"\u{1F1F2}\u{1F1FA}":["\u6BDB\u91CC\u6C42\u65AF","Mauritius"],"\u{1F1F5}\u{1F1F7}":["\u6CE2\u591A\u9ECE\u5404","PR ","PR-","Puerto Rico"],"\u{1F1EC}\u{1F1F9}":["\u5371\u5730\u9A6C\u62C9","\u5371\u5730\u99AC\u62C9"," GT "],"\u{1F1ED}\u{1F1F0}":["HK","Hongkong","Hong Kong","HongKong","HONG KONG","\u9999\u6E2F","\u6DF1\u6E2F","\u6CAA\u6E2F","\u547C\u6E2F","HKT","HKBN","HGC","WTT","CMI","\u7A57\u6E2F","\u4EAC\u6E2F","\u6E2F"],"\u{1F1E8}\u{1F1F3}":["CN","China","\u56DE\u56FD","\u4E2D\u56FD","\u4E2D\u570B","\u6C5F\u82CF","\u5317\u4EAC","\u4E0A\u6D77","\u5E7F\u5DDE","\u6DF1\u5733","\u676D\u5DDE","\u5F90\u5DDE","\u9752\u5C9B","\u5B81\u6CE2","\u9547\u6C5F","back"],"\u{1F1E8}\u{1F1FA}":["\u53E4\u5DF4"],"\u{1F1F8}\u{1F1F2}":["\u5723\u9A6C\u529B\u8BFA","\u8056\u99AC\u5229\u8AFE"],"\u{1F1F0}\u{1F1FE}":["\u5F00\u66FC\u7FA4\u5C9B","\u958B\u66FC\u7FA4\u5CF6"],"\u{1F1EB}\u{1F1EF}":["\u6590\u6D4E","\u6590\u6FDF"],"\u{1F1EC}\u{1F1F1}":["\u683C\u9675\u5170","\u683C\u9675\u862D"],"\u{1F1EC}\u{1F1EE}":["\u76F4\u5E03\u7F57\u9640","\u76F4\u5E03\u7F85\u9640"],"\u{1F1F2}\u{1F1EA}":["\u9ED1\u5C71"],"\u{1F1F1}\u{1F1EE}":["\u5217\u652F\u6566\u58EB\u767B"],"\u{1F1EC}\u{1F1FA}":["\u5173\u5C9B","\u95DC\u5CF6"],"\u{1F1E6}\u{1F1F6}":["\u5357\u6781","\u5357\u6975"],"\u{1F1E7}\u{1F1F9}":["\u4E0D\u4E39"],"\u{1F1F2}\u{1F1FB}":["\u9A6C\u5C14\u4EE3\u592B","\u99AC\u723E\u4EE3\u592B"],"\u{1F1EE}\u{1F1F6}":["\u4F0A\u62C9\u514B"],"\u{1F1F8}\u{1F1E8}":["\u585E\u820C\u5C14","\u585E\u820C\u723E"],"\u{1F1F6}\u{1F1E6}":["\u5361\u5854\u5C14","\u5361\u5854\u723E"," QA "],"\u{1F1F8}\u{1F1FE}":["\u53D9\u5229\u4E9A","\u6558\u5229\u4E9E"," SY "],"\u{1F1F1}\u{1F1E7}":["\u9ECE\u5DF4\u5AE9","LB","Lebanon"],"\u{1F1E7}\u{1F1F3}":["\u6587\u83B1","\u6C76\u840A","BRN","Negara Brunei Darussalam"],"\u{1F1E8}\u{1F1FB}":["\u4F5B\u5F97\u89D2"],"\u{1F1F8}\u{1F1F7}":["\u82CF\u91CC\u5357","\u8607\u91CC\u5357"],"\u{1F1F2}\u{1F1E8}":["\u6469\u7EB3\u54E5","\u6469\u7D0D\u54E5"],"\u{1F1EF}\u{1F1F2}":["\u7259\u4E70\u52A0","\u7259\u8CB7\u52A0 "],"\u{1F30F}":["\u4E9A\u6D32","Asia"],"\u{1F1F9}\u{1F1EC}":["\u591A\u54E5"],"\u{1F1F5}\u{1F1F8}":["\u5DF4\u52D2\u65AF\u5766"],"\u{1F1EC}\u{1F1EB}":["\u6CD5\u5C6C\u572D\u4E9E\u90A3","\u6CD5\u5C5E\u572D\u4E9A\u90A3"],"\u{1F1F9}\u{1F1F9}":["\u7279\u7ACB\u5C3C\u8FBE\u548C\u591A\u5DF4\u54E5","\u7279\u7ACB\u5C3C\u9054\u548C\u591A\u5DF4\u54E5"]};str1=JSON.stringify(a),aa=JSON.parse(str1),bb=JSON.parse(str1.replace(/🇹🇼/g," \u{1F1E8}\u{1F1F3}"));var r=e==1?aa:bb,s=0;for(var o in r){dd=r[o];for(i in dd)if(t.indexOf(dd[i])!=-1)return s=1,nname=o+" "+t.replace(/[\uD83C][\uDDE6-\uDDFF][\uD83C][\uDDE6-\uDDFF]/g,"").trim(),[nname,o]}if(s==0)return["\u{1F3F4}\u200D\u2620\uFE0F "+t.replace(/[\uD83C][\uDDE6-\uDDFF][\uD83C][\uDDE6-\uDDFF]/g,"").trim(),"\u{1F3F4}\u200D\u2620\uFE0F"]}function emoji_handle(e,t){for(var a=[],r=e,s=0;s<r.length;s++)if(r[s].indexOf("tag=")!=-1){var o=r[s].split("tag=")[1].trim(),l=r[s].split("tag=")[0],n=o;if(t==1)var n=get_emoji(1,n)[0];else if(t==2)var n=get_emoji(2,n)[0];else t==-1&&(n=emoji_del(o));var h=l+"tag="+n.replace("  "," ").trim();a.push(h)}return a}function Surge2QX(e){for(var t=e.split(`
`).map(isSurge).filter(Boolean),a=[],r="",s=0;s<t.length;s++){var o=t[s];if(o.split("=")[1].split(",")[0].indexOf("trojan")!=-1?r=Strojan2QX(o):o.split("=")[1].split(",")[0].indexOf("http")!=-1?r=Shttp2QX(o):o.split("=")[1].split(",")[0].indexOf("vmess")!=-1?r=SVmess2QX(o):o.split("=")[1].split(",")[0].indexOf("ss")!=-1?r=SSS2QX(o):o.split("=")[1].split(",")[0].indexOf("socks5")!=-1?r=SS52QX(o):o.split("=")[1].split(",")[0].indexOf("custom")!=-1&&(r=SCT2QX(o)),r=Pudp0!=0?XUDP(r,Pudp0):r,r=Ptfo0!=0?XTFO(r,Ptfo0):r,o.indexOf("test-url")!=-1){var l=", server_check_url"+o.split("test-url")[1].split(",")[0];r=r.replace(/\,(\s)*tag/,l+", tag")}a.push(r)}return a}function SCT2QX(e){var t=e,a="tag="+t.split("=")[0].trim(),r=t.split(",")[1].trim()+":"+t.split(",")[2].trim(),s="method="+t.split(",")[3].trim(),o="password="+t.split(",")[4].trim();t.indexOf("obfs")!=-1?pobfs="obfs="+t.replace(/obfs-host/,"").split("obfs")[1].split(",")[0].split("=")[1]:pobfs="";var l=t.indexOf("obfs-host")!=-1?"obfs-host"+t.split("obfs-host")[1].split(",")[0].trim():"";l!=""&&(pobfs=pobfs+", "+l);var n=paraCheck(t,"tfo")=="true"?"fast-open=true":"fast-open=false",h=paraCheck(t,"udp-relay")=="true"?"udp-relay=true":"udp-relay=false",m=pobfs!=""?"shadowsocks= "+[r,s,o,pobfs,n,h,a].join(", "):"shadowsocks= "+[r,s,o,n,h,a].join(", ");return m}function SSS2QX(e){var t=e,a=t.replace(" ","").replace('"',""),r="tag="+t.split("=")[0].trim(),s=t.split(",")[1].trim()+":"+t.split(",")[2].trim(),o="method="+t.split("encrypt-method")[1].split(",")[0].split("=")[1],l="password="+a.split("password=")[1].split(",")[0].replace('"',"");t.indexOf("obfs")!=-1?pobfs="obfs="+t.replace(/obfs-host/,"").split("obfs")[1].split(",")[0].split("=")[1]:pobfs="";var n=t.indexOf("obfs-host")!=-1?"obfs-host"+t.split("obfs-host")[1].split(",")[0].trim():"";n!=""&&(pobfs=pobfs+", "+n);var h=paraCheck(t,"tfo")=="true"?"fast-open=true":"fast-open=false",m=paraCheck(t,"udp-relay")=="true"?"udp-relay=true":"udp-relay=false",x=pobfs!=""?"shadowsocks= "+[s,o,l,pobfs,h,m,r].join(", "):"shadowsocks= "+[s,o,l,h,m,r].join(", ");return x}function SVmess2QX(e){var t=e,a="tag="+t.split("=")[0].trim(),r=t.split(",")[1].trim()+":"+t.split(",")[2].trim(),s=t.indexOf("username")!=-1?"password="+t.split("username")[1].split(",")[0].split("=")[1].trim():"",o="method=aes-128-gcm",l=paraCheck(t,"tls13")=="true"?"tls13=true":"tls13=false",n=t.replace(/ /g,"").indexOf("skip-cert-verify=false")!=-1?"tls-verification=true":"tls-verification=false";pvefify=Pcert0==1?"tls-verification=true":n,paraCheck(t.replace(/tls13/,""),"tls")=="true"&&paraCheck(t.replace(/ws-header/,""),"ws")=="true"?pobfs="obfs=wss, "+l+", "+n:paraCheck(t.replace(/ws-header/,""),"ws")=="true"?pobfs="obfs=ws":paraCheck(t.replace(/tls13/,""),"tls")!="false"?pobfs="obfs=over-tls, "+l+", "+n:paraCheck(t.replace(/ws-header/,""),"ws")=="false"&&(pobfs="");var h=paraCheck(t,"ws-path")!="false"?"obfs-uri="+t.split("ws-path")[1].split(",")[0].split("=")[1].trim():"obfs-uri=/",m=t.indexOf("ws-headers")!=-1?"obfs-host="+t.split("ws-headers")[1].split(",")[0].split("=")[1].split(":")[1].trim():"";pobfs.indexOf("ws")!=-1&&(m!=""?pobfs=pobfs+", "+h+", "+m:pobfs=pobfs+", "+h);var x=paraCheck(t,"tfo")=="true"?"fast-open=true":"fast-open=false",u=pobfs!=""?"vmess= "+[r,s,o,pobfs,x,a].join(", "):"vmess= "+[r,s,o,x,a].join(", ");return u}function isSurge(e){if(e.indexOf("=")!=-1&&(cnt=e.split("=")[1].split(",")[0].trim(),cnt=="http"||cnt=="ss"||cnt=="trojan"||cnt=="vmess"||cnt=="custom"||cnt=="https"||cnt=="socks5"||cnt=="socks5-tls"))return e}function paraCheck(e,t){return e=e.replace(/ /g,""),e.indexOf(t+"=")==-1?"false":e.split(t+"=")[1].split(",")[0].trim()}function Strojan2QX(e){var t=e,a="tag="+t.split("=")[0].trim(),r=t.split(",")[1].trim()+":"+t.split(",")[2].trim(),s="password="+t.split("password")[1].split(",")[0].split("=")[1].trim(),o="over-tls=true",l=paraCheck(t,"tfo")=="true"?"fast-open=true":"fast-open=false",n=t.replace(/ /g,"").indexOf("skip-cert-verify=false")!=-1?"tls-verification=true":"tls-verification=false",h=t.indexOf("sni")!=-1?"tls-host="+t.split("sni")[1].split(",")[0].split("=")[1]:"";pvefify=Pcert0==1?"tls-verification=true":n;var m=paraCheck(t,"tls13")=="true"?"tls13=true":"tls13=false",x="trojan= "+[r,s,o,l,m,h,n,a].filter(Boolean).join(", ");return x}function Shttp2QX(e){var t=e,a="tag="+t.split("=")[0].trim(),r=t.split(",")[1].trim()+":"+t.split(",")[2].trim(),s=t.indexOf("username")!=-1?"username="+t.split("username")[1].split(",")[0].split("=")[1].trim():"",o=t.indexOf("password")!=-1?"password="+t.split("password")[1].split(",")[0].split("=")[1].trim():"",l=t.split("=")[1].split(",")[0].trim()=="https"?"over-tls=true":"over-tls=false",n=paraCheck(t,"tfo")=="true"?"fast-open=true":"fast-open=false";if(l=="over-tls=true"){var h=t.replace(/ /g,"").indexOf("skip-cert-verify=false")!=-1?"tls-verification=true":"tls-verification=false";pvefify=Pcert0==1?"tls-verification=true":h;var m=paraCheck(t,"tls13")=="true"?"tls13=true":"tls13=false";l=l+", "+h+", "+m}var x=s!=""?"http= "+[r,s,o,l,n,a].join(", "):"http= "+[r,l,n,a].join(", ");return x}function SS52QX(e){var t=e,a="tag="+t.split("=")[0].trim(),r=t.split(",")[1].trim()+":"+t.split(",")[2].trim(),s=t.indexOf("username")!=-1?"username="+t.split("username")[1].split(",")[0].split("=")[1].trim():"",o=t.indexOf("password")!=-1?"password="+t.split("password")[1].split(",")[0].split("=")[1].trim():"",l=t.split("=")[1].split(",")[0].trim()=="socks5-tls"?"over-tls=true":"over-tls=false",n=paraCheck(t,"tfo")=="true"?"fast-open=true":"fast-open=false";if(l=="over-tls=true"){var h=t.replace(/ /g,"").indexOf("skip-cert-verify=false")!=-1?"tls-verification=true":"tls-verification=false";pvefify=Pcert0==1?"tls-verification=true":h;var m=paraCheck(t,"tls13")=="true"?"tls13=true":"tls13=false";l=l+", "+h+", "+m}var x=s!=""?"socks5= "+[r,s,o,l,n,a].join(", "):"socks5= "+[r,l,n,a].join(", ");return x}function Loon2QX(e){var t=e.split("=")[1].split(",")[0].trim(),a="";return t=="Shadowsocks"?a=LoonSS2QX(e):t=="ShadowsocksR"?a=LoonSSR2QX(e):t=="VLESS"&&(a=LoonVL2QX(e)),a}function LoonSS2QX(e){var t="shadowsocks=",a=[e.split(",")[1].trim(),e.split(",")[2].trim()].join(":"),r="method="+e.split(",")[3].trim(),s="password="+e.split(",")[4].trim().split('"')[1],o=e.split(",").length==7?", "+["obfs="+e.split(",")[5].trim(),"obfs-host="+e.split(",")[6].trim()].join(","):"",l=", tag="+e.split("=")[0].trim();return t=t+[a,r,s].join(", ")+o+l,t}function LoonSSR2QX(e){var t="shadowsocks=",a=[e.split(",")[1].trim(),e.split(",")[2].trim()].join(":"),r="method="+e.split(",")[3].trim(),s="password="+e.split(",")[4].trim().split('"')[1],o="ssr-protocol="+e.split(",")[5].trim(),l="ssr-protocol-param="+e.split(",")[6].replace(/\{|\}/g,"").trim(),n="obfs="+e.split(",")[7].trim(),h="obfs-host="+e.split(",")[8].replace(/\{|\}/g,"").trim(),m=", tag="+e.split("=")[0].trim();return t=t+[a,r,s,o,l,n,h].join(", ")+m,t}function LoonVL2QX(e){var t=", tag="+e.split("=")[0].trim();e=e.replace(" ","");var a="vless=",r=[e.split(",")[1].trim(),e.split(",")[2].trim()].join(":"),s="method=none",o="password="+e.split(",")[3].trim().split('"')[1];return e.indexOf("transport=tcp")!=-1?obfs=e.indexOf("over-tls=true")=="-1"?"":"obfs=over-tls":e.indexOf("transport=http")!=-1?obfs="obfs=http":e.indexOf("transport=ws")!=-1&&(obfs=e.indexOf("over-tls=true")=="-1"?"obfs=ws":"obfs=wss"),vpath=e.indexOf("path=")==-1?"":"obfs-uri="+e.split("path=")[1].split(",")[0],e.indexOf("host=")!=-1?obfshost="obfs-host="+e.split("host=")[1].split(",")[0]:e.indexOf("tls-name=")!=-1&&(obfshost="obfs-host="+e.split("tls-name=")[1].split(",")[0]),a=a+[r,s,o,obfs,obfshost,vpath].join(", ")+t,a}function YAMLFix(e){return e=e.replace(/\[/g,"yaml@bug1").replace(/\\r/g,"").replace(/\*/g,"yaml@bug2"),e.indexOf("{")!=-1&&/\{\s*\"*(name|type|server)/.test(e)&&(e=e.replace(/(^|\n)- /g,"$1  - ").replace(/    - /g,"  - ").replace(/:(?!\s)/g,": ").replace(/\,\"/g,', "').replace(/: {/g,": {,   ").replace(/, (Host|host|path|mux)/g,",   $1"),e=e.replace(/{\s*name: (.*?), (.*?):/g,'{name: "$1", $2:'),e=e.replace(/{\s*|\s*}/g,"").replace(/,/g,`
   `)),e=e.replace(/\n\s*\-\s*\n.*name/g,`
  - name`).replace(/\$|\`/g,"").split("proxy-providers:")[0].split("proxy-groups:")[0].replace(/\"(name|type|server|port|cipher|password|uuid|alterId|udp)(\"*)/g,"$1"),Pdbg==1&&$notify("part-fix0:","",`part-fix0:
proxies:
`+e.split("proxies:")[1]),e=e.replace(/\n\s{2}([a-zA-Z]+.*\:)/g,`
    $1`).replace(/\n(\-.*)/g,`
  $1`),Pdbg==1&&$notify("part-fix1:","",`part-fix1:
proxies:
`+e.split("proxies:")[1]),e=e.replace(/name\:(.*?)\:(.*?)\n/gmi,`name:$1\u5192\u53F7$2
`).replace(/\s{6}Host\:/g,"      Host:"),items=e.split(`
`).map(yamlcheck),e=items.join(`
`),e=e.indexOf("proxies:")!=-1&&/\n\s{4}server/.test(e)?e.replace(/\n\s{4}(headers|path)/g,`
      $1`).replace(/\n\s{6}Host/g,`
        Host`).replace(/\t/g,""):e,e=e.indexOf("proxies:")==-1?`proxies:
`+e:"proxies:"+e.split("proxies:")[1],Pdbg==1&&$notify("After-Fix","this is",`After-fix:
`+e),e}function yamlcheck(e){if(e.indexOf("name")!=-1)for(var t=0;t<10;t++)e=e.replace(new RegExp(patn[0][t],"gmi"),patn[4][t]);if(/(:|-)/.test(e))return e}function Clash2QX(e){const t=new YAML;Pdbg==1&&$notify(" Before YAML Parse","content",e);for(var a=JSON.stringify(t.parse(YAMLFix(e))).replace(/yaml@bug𝟙/g,"[").replace(/冒号/gmi,":").replace(/yaml@bug𝟚/g,"*"),r=0;r<10;r++)a=a.replace(new RegExp(patn[4][r],"gmi"),patn[0][r]);var s=JSON.parse(a).proxies;Pdbg==1&&$notify("After YAML Parse","content",JSON.stringify(s));var o=s.length,l=[],n="";for(r=0;r<o;r++)try{n=s[r],typecc=n.type,typecc=="ss"?n=CSS2QX(n):typecc=="ssr"?n=CSSR2QX(n):typecc=="vmess"?n=CV2QX(n):typecc=="trojan"?n=CT2QX(n):typecc=="http"?n=CH2QX(n):typecc=="socks5"&&(n=CS52QX(n)),n=Pudp0!=0?XUDP(n,Pudp0):n,n=Ptfo0!=0?XTFO(n,Ptfo0):n,l.push(n)}catch(h){$notify("\u26A0\uFE0F\u8BE5\u8282\u70B9\u89E3\u6790\u9519\u8BEF, \u6682\u65F6\u5DF2\u5FFD\u7565\u5904\u7406","\u53EF\u70B9\u51FB\u901A\u77E5\u5E76\u53D1\u9001\u94FE\u63A5\u53CD\u9988\u81F3 bot",JSON.stringify(n),bug_link),$notify("\u26A0\uFE0F\u9519\u8BEF\u5185\u5BB9\u5982\u4E0B","\u53EF\u590D\u5236\u9519\u8BEF\u5185\u5BB9\u5230\u53CD\u9988 bot",JSON.stringify(n)+`

`+h)}return l.join(`
`)}function CSS2QX(e){return tag="tag="+e.name.replace(/\\U.+?\s{1}/gi,""),ipt=e.server+":"+e.port,pwd="password="+e.password,mtd="method="+e.cipher,udp=e.udp?"udp-relay=true":"udp-relay=false",uot=e["udp-over-tcp"]?"udp-over-tcp=true":"udp-over-tcp=false",tfo=e.tfo?"fast-open=true":"fast-open=false",obfs=e["plugin-opts"]?"obfs="+e["plugin-opts"].mode:"",ohost=e["plugin-opts"]?"obfs-host="+e["plugin-opts"].host:"",ouri="",cert="",obfs.indexOf("websocket")!=-1&&(obfs=e["plugin-opts"].tls?"obfs=wss":"obfs=ws",ohost=e["plugin-opts"].host?"obfs-host="+e["plugin-opts"].host:"",ouri=e["plugin-opts"].path?"obfs-uri="+e["plugin-opts"].path:"",obfs=="obfs=wss"&&(cert=Pcert0==1?"":"tls-verification =false")),node="shadowsocks="+[ipt,pwd,mtd,udp,uot,tfo,obfs,ohost,ouri,cert,tag].filter(Boolean).join(", "),node}function CSSR2QX(e){return tag="tag="+e.name.replace(/\\U.+?\s{1}/gi,""),ipt=e.server+":"+e.port,pwd="password="+e.password,mtd="method="+e.cipher,udp=e.udp?"udp-relay=true":"udp-relay=false",tfo=e.tfo?"fast-open=true":"fast-open=false",prot="ssr-protocol="+e.protocol,ohost="",ppara="",e.protocolparam&&(e["protocol-param"]=e.protocolparam),typeof e["protocol-param"]=="string"?ppara="ssr-protocol-param="+e["protocol-param"]:typeof e["protocol-param"]=="object"&&(ppara="ssr-protocol-param="+JSON.stringify(e["protocol-param"]).replace(/{|}|\s|"/g,"")),obfs="obfs="+e.obfs,e["obfs-param"]?ohost="obfs-host="+e["obfs-param"]:e.obfsparam&&(ohost="obfs-host="+e.obfsparam),node="shadowsocks="+[ipt,pwd,mtd,udp,tfo,prot,ppara,obfs,ohost,tag].filter(Boolean).join(", "),node}function CV2QX(e){tag="tag="+e.name.replace(/\\U.+?\s{1}/gi," "),ipt=e.server+":"+e.port,pwd="password="+e.uuid,mtd="method=aes-128-gcm",udp=(e.udp,"udp-relay=false"),tfo=e.tfo?"fast-open=true":"fast-open=false",obfs="",e.network=="ws"&&e.tls?obfs="obfs=wss":e.network=="ws"?obfs="obfs=ws":e.network=="http"?obfs="obfs=http":e.tls&&(obfs="obfs=over-tls");const t=getValue(()=>e["ws-opts"].headers.Host);return ohost=e["ws-headers"]?"obfs-host="+e["ws-headers"].Host:"",ohost=t?"obfs-host="+t:ohost,ohost=e.servername?"obfs-host="+e.servername:ohost,ouri=e["ws-path"]?"obfs-uri="+e["ws-path"]:"",ouri=e["ws-opts"]?"obfs-uri="+e["ws-opts"].path:ouri,cert=e["skip-cert-verify"]&&e.tls?"tls-verification=false":"",caead=e.alterId&&e.alterId!=0?"aead=false":"",Pcert0==1&&e.tls?cert="tls-verification=true":Pcert0!=1&&e.tls&&(cert="tls-verification=false"),node="vmess="+[ipt,pwd,mtd,udp,tfo,obfs,ohost,ouri,cert,caead,tag].filter(Boolean).join(", "),node}function CT2QX(e){return tag="tag="+e.name.replace(/\\U.+?\s{1}/gi," "),ipt=e.server+":"+e.port,pwd="password="+e.password,otls="over-tls=true",opath="",ohost="",cert=e["skip-cert-verify"]?"tls-verification=false":"tls-verification=true",cert=Pcert0==1?"tls-verification=true":"tls-verification=false",tls13=PTls13==1?"tls13=true":"tls13=false",udp=(e.udp,"udp-relay=false"),tfo=e.tfo?"fast-open=true":"fast-open=false",e.network=="ws"&&(otls="obfs=wss",e["ws-opts"]&&(opath=e["ws-opts"].path?"obfs-uri="+e["ws-opts"].path:"",ohost=e["ws-opts"].headers?"obfs-host="+e["ws-opts"].headers.Host:"")),node="trojan="+[ipt,pwd,otls,opath,ohost,cert,tls13,udp,tfo,tag].filter(Boolean).join(", "),node}function CH2QX(e){return tag="tag="+e.name.replace(/\\U.+?\s{1}/gi," "),ipt=e.server+":"+e.port,uname=e.username?"username="+e.username:"",pwd=e.password&&typeof e.password=="string"?"password="+e.password:"",tls=e.tls?"over-tls=true":"",cert=e["skip-cert-verify"]&&e.tls?"tls-verification=false":"",Pcert0==1&&e.tls?cert="tls-verification=true":Pcert0!=1&&e.tls&&(cert="tls-verification=false"),node="http="+[ipt,uname,pwd,tls,cert,tag].filter(Boolean).join(", "),node}function CS52QX(e){return tag="tag="+e.name.replace(/\\U.+?\s{1}/gi," "),ipt=e.server+":"+e.port,uname=e.username?"username="+e.username:"",pwd=e.password&&typeof e.password=="string"?"password="+e.password:"",tls=e.tls?"over-tls=true":"",cert=e["skip-cert-verify"]&&e.tls?"tls-verification=false":"",Pcert0==1&&e.tls?cert="tls-verification=true":Pcert0!=1&&e.tls&&(cert="tls-verification=false"),node="socks5="+[ipt,uname,pwd,tls,cert,tag].filter(Boolean).join(", "),node}function XUDP(e,t){var a=t==1&&/^(shadowsocks|trojan|vmess)/.test(e.trim())?"udp-relay=true, ":"udp-relay=false, ";if(e.indexOf("udp-relay")!=-1)var r=e.replace(RegExp("udp-relay.*?,","gmi"),a);else var r=e.replace(new RegExp("tag.*?=","gmi"),a+"tag=");return r}function XTFO(e,t){var a=t==1?"fast-open=true, ":"fast-open=false, ";if(e.indexOf("fast-open")!=-1)var r=e.replace(RegExp("fast-open.*?,","gmi"),a);else var r=e.replace(RegExp("tag.*?=","gmi"),a+"tag=");return r}function UOT(e){return cnts=e.replace(/\s*/g,""),/^shadowsocks=/.test(cnts)&&(e=cnts.indexOf("udp-over-tcp")!=-1?e.replace(/udp-over-tcp\s*\=\s*false/g,"udp-over-tcp=true"):e+", udp-over-tcp=true"),e}function Base64Code(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=function(f){for(var d={},y=0,b=f.length;y<b;y++)d[f.charAt(y)]=y;return d}(e),a=String.fromCharCode,r=function(f){if(f.length<2){var d=f.charCodeAt(0);return d<128?f:d<2048?a(192|d>>>6)+a(128|d&63):a(224|d>>>12&15)+a(128|d>>>6&63)+a(128|d&63)}else{var d=65536+(f.charCodeAt(0)-55296)*1024+(f.charCodeAt(1)-56320);return a(240|d>>>18&7)+a(128|d>>>12&63)+a(128|d>>>6&63)+a(128|d&63)}},s=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,o=function(f){return f.replace(s,r)},l=function(f){var d=[0,2,1][f.length%3],y=f.charCodeAt(0)<<16|(f.length>1?f.charCodeAt(1):0)<<8|(f.length>2?f.charCodeAt(2):0),b=[e.charAt(y>>>18),e.charAt(y>>>12&63),d>=2?"=":e.charAt(y>>>6&63),d>=1?"=":e.charAt(y&63)];return b.join("")},n=function(f){return f.replace(/[\s\S]{1,3}/g,l)};this.encode=function(f){var d=Object.prototype.toString.call(f)==="[object Uint8Array]";return d?f.toString("base64"):n(o(String(f)))};var h=function(f,d){return d?_encode(String(f)).replace(/[+\/]/g,function(y){return y=="+"?"-":"_"}).replace(/=/g,""):_encode(f)},m=function(f){return h(f,!0)},x=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,u=function(f){switch(f.length){case 4:var d=(7&f.charCodeAt(0))<<18|(63&f.charCodeAt(1))<<12|(63&f.charCodeAt(2))<<6|63&f.charCodeAt(3),y=d-65536;return a((y>>>10)+55296)+a((y&1023)+56320);case 3:return a((15&f.charCodeAt(0))<<12|(63&f.charCodeAt(1))<<6|63&f.charCodeAt(2));default:return a((31&f.charCodeAt(0))<<6|63&f.charCodeAt(1))}},p=function(f){return f.replace(x,u)},v=function(f){var d=f.length,y=d%4,b=(d>0?t[f.charAt(0)]<<18:0)|(d>1?t[f.charAt(1)]<<12:0)|(d>2?t[f.charAt(2)]<<6:0)|(d>3?t[f.charAt(3)]:0),O=[a(b>>>16),a(b>>>8&255),a(b&255)];return O.length-=[0,0,2,1][y],O.join("")},g=function(f){return f.replace(/\S{1,4}/g,v)},c=function(f){return g(String(f).replace(/[^A-Za-z0-9\+\/]/g,""))},w=function(f){return p(g(f))};this.decode=function(f){return w(String(f).replace(/[-_]/g,function(d){return d=="-"?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,"")).replace(/&gt;/g,">").replace(/&lt;/g,"<")}}function YAML(){var e=[],t=[],a=0,r={regLevel:new RegExp("^([\\s\\-]+)"),invalidLine:new RegExp("^\\-\\-\\-|^\\.\\.\\.|^\\s*#.*|^\\s*$"),dashesString:new RegExp('^\\s*\\"([^\\"]*)\\"\\s*$'),quotesString:new RegExp("^\\s*\\'([^\\']*)\\'\\s*$"),float:new RegExp("^[+-]?[0-9]+\\.[0-9]+(e[+-]?[0-9]+(\\.[0-9]+)?)?$"),integer:new RegExp("^[+-]?[0-9]+$"),array:new RegExp("\\[\\s*(.*)\\s*\\]"),map:new RegExp("\\{\\s*(.*)\\s*\\}"),key_value:new RegExp("([a-z0-9_-][ a-z0-9_-]*):( .+)","i"),single_key_value:new RegExp("^([a-z0-9_-][ a-z0-9_-]*):( .+?)$","i"),key:new RegExp("([a-z0-9_-][ a-z0-9_-]+):( .+)?","i"),item:new RegExp("^-\\s+"),trim:new RegExp("^\\s+|\\s+$"),comment:new RegExp(`([^\\'\\"#]+([\\'\\"][^\\'\\"]*[\\'\\"])*)*(#.*)?`)};function s(v){return{parent:null,length:0,level:v,lines:[],children:[],addChild:function(g){this.children.push(g),g.parent=this,++this.length}}}function o(v,g){var c=createXMLHTTPRequest();c.onreadystatechange=function(){if(this.readyState==4||this.status==200){var w=this.responseText;g(YAML.eval0(w))}},c.open("GET",v),c.send()}function l(v){var g=r.regLevel,c=r.invalidLine,w=v.split(`
`),f,d=0,y=0,b=[],O=new s(-1),k=new s(0);O.addChild(k);var C=[],_="";b.push(k),C.push(d);for(var Q=0,X=w.length;Q<X;++Q)if(_=w[Q],!_.match(c)){if((f=g.exec(_))?d=f[1].length:d=0,d>y){var P=k;k=new s(d),P.addChild(k),b.push(k),C.push(d)}else if(d<y){for(var R=!1,S=C.length-1;S>=0;--S)if(C[S]==d){k=new s(d),b.push(k),C.push(d),b[S].parent!=null&&b[S].parent.addChild(k),R=!0;break}if(!R){e.push("Error: Invalid indentation at line "+Q+": "+_);return}}k.lines.push(_.replace(r.trim,"")),y=d}return O}function n(v){v=v.replace(r.trim,"");var g=null;if(v=="true")return!0;if(v=="false")return!1;if(v==".NaN")return Number.NaN;if(v=="null")return null;if(v==".inf")return Number.POSITIVE_INFINITY;if(v=="-.inf")return Number.NEGATIVE_INFINITY;if(g=v.match(r.dashesString))return g[1];if(g=v.match(r.quotesString))return g[1];if(g=v.match(r.float))return parseFloat(g[0]);if(g=v.match(r.integer))return parseInt(g[0]);if(isNaN(g=Date.parse(v)))if(g=v.match(r.single_key_value)){var c={};return c[g[1]]=n(g[2]),c}else if(g=v.match(r.array)){for(var w=0,f=" ",c=[],d="",y=!1,b=0,O=g[1].length;b<O;++b){if(f=g[1][b],f=="'"||f=='"'){if(y===!1){y=f,d+=f;continue}else if(f=="'"&&y=="'"||f=='"'&&y=='"'){y=!1,d+=f;continue}}else if(y===!1&&(f=="["||f=="{"))++w;else if(y===!1&&(f=="]"||f=="}"))--w;else if(y===!1&&w==0&&f==","){c.push(n(d)),d="";continue}d+=f}return d.length>0&&c.push(n(d)),c}else if(g=v.match(r.map)){for(var w=0,f=" ",c=[],d="",y=!1,b=0,O=g[1].length;b<O;++b){if(f=g[1][b],f=="'"||f=='"'){if(y===!1){y=f,d+=f;continue}else if(f=="'"&&y=="'"||f=='"'&&y=='"'){y=!1,d+=f;continue}}else if(y===!1&&(f=="["||f=="{"))++w;else if(y===!1&&(f=="]"||f=="}"))--w;else if(y===!1&&w==0&&f==","){c.push(d),d="";continue}d+=f}d.length>0&&c.push(d);for(var k={},b=0,O=c.length;b<O;++b)(g=c[b].match(r.key_value))&&(k[g[1]]=n(g[2]));return k}else return v;else return new Date(g)}function h(v){for(var g=v.lines,c=v.children,w=g.join(" "),f=[w],d=0,y=c.length;d<y;++d)f.push(h(c[d]));return f.join(`
`)}function m(v){for(var g=v.lines,c=v.children,w=g.join(`
`),f=0,d=c.length;f<d;++f)w+=m(c[f]);return w}function x(v){for(var g=null,c={},w=null,f=null,d=null,y=-1,b=[],O=!0,k=0,C=v.length;k<C;++k)if(!(y!=-1&&y!=v[k].level)){b.push(k),y=v[k].level,w=v[k].lines,f=v[k].children,d=null;for(var _=0,Q=w.length;_<Q;++_){var X=w[_];if(g=X.match(r.key)){var P=g[1];if(P[0]=="-"&&(P=P.replace(r.item,""),O&&(O=!1,typeof c.length>"u"&&(c=[])),d!=null&&c.push(d),d={},O=!0),typeof g[2]<"u"){var R=g[2].replace(r.trim,"");if(R[0]=="&"){var S=x(f);d!=null?d[P]=S:c[P]=S,t[R.substr(1)]=S}else if(R[0]=="|")d!=null?d[P]=m(f.shift()):c[P]=m(f.shift());else if(R[0]=="*"){var T=R.substr(1),D={};if(typeof t[T]>"u")e.push("Reference '"+T+"' not found!");else{for(var U in t[T])D[U]=t[T][U];d!=null?d[P]=D:c[P]=D}}else R[0]==">"?d!=null?d[P]=h(f.shift()):c[P]=h(f.shift()):d!=null?d[P]=n(R):c[P]=n(R)}else d!=null?d[P]=x(f):c[P]=x(f)}else if(X.match(/^-\s*$/)){O&&(O=!1,typeof c.length>"u"&&(c=[])),d!=null&&c.push(d),d={},O=!0;continue}else if(g=X.match(/^-\s*(.*)/)){d!=null?d.push(n(g[1])):(O&&(O=!1,typeof c.length>"u"&&(c=[])),c.push(n(g[1])));continue}}d!=null&&(O&&(O=!1,typeof c.length>"u"&&(c=[])),c.push(d))}for(var k=b.length-1;k>=0;--k)v.splice.call(v,b[k],1);return c}function u(v){var g=x(v.children);return g}function p(v){var g,c=v.split(`
`),w=r.comment;for(var f in c)(g=c[f].match(w))&&typeof g[3]<"u"&&(c[f]=g[0].substr(0,g[0].length-g[3].length));return c.join(`
`)}this.parse=function(g){e=[],t=[],a=new Date().getTime();var c=p(g),w=l(c),f=u(w);return a=new Date().getTime()-a,f}}function Tools(){return{filter:(r,...s)=>{const o=[...Array(r.length).keys()].map(()=>!1);return s.reduce((l,n)=>OR(l,r.map(h=>n.test(h))),o)},rename:{replace:(r,s,o)=>r.map(l=>l.replace(s,o)),delete:(r,...s)=>r.map(o=>s.reduce((l,n)=>l.replace(n,""),o)),trim:r=>r.map(s=>s.trim().replace(/[^\S\r\n]{2,}/g," "))},getNodeInfo:r=>({names:r.map(o=>o.split("tag=")[1]),types:r.map(o=>{const l=o.match(/^(vmess|trojan|shadowsocks|http)=/);return l?l[1]:"unknown"})})}}function AND(...e){return e.reduce((t,a)=>t.map((r,s)=>a[s]&&r))}function OR(...e){return e.reduce((t,a)=>t.map((r,s)=>a[s]||r))}function NOT(e){return e.map(t=>!t)}
