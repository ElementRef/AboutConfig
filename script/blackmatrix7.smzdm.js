// Thu Jul 03 2025 21:21:21 GMT+0000 (Coordinated Universal Time) https://raw.githubusercontent.com/ElementRef/AboutConfig/main/script/blackmatrix7.smzdm.js
const scriptName="\u4EC0\u4E48\u503C\u5F97\u4E70";let magicJS=MagicJS(scriptName,"INFO");(()=>{let d=null;if(magicJS.isResponse)switch(!0){case/^https?:\/\/app-api\.smzdm\.com\/util\/loading/.test(magicJS.request.url):try{let r=JSON.parse(magicJS.response.body);r.data.forEach(t=>{t.start_date="2030-12-24 00:00:00",t.end_date="2030-12-24 23:59:59",t.unix_start_date="1924272000",t.unix_end_date="1924358399",t.is_show_ad="0"}),d={body:JSON.stringify(r)}}catch(r){magicJS.logError(`\u53BB\u9664APP\u542F\u52A8\u5E7F\u544A\u51FA\u73B0\u5F02\u5E38\uFF1A${r}`)}break;case/^https?:\/\/homepage-api\.smzdm\.com\/v3\/home/.test(magicJS.request.url):try{let r=JSON.parse(magicJS.response.body),t=[];r.data.component.forEach(s=>{if(s.zz_type==="banner"){let e=s.zz_content.filter(o=>o.tag!=="\u5E7F\u544A");s.zz_content=e}else if(s.zz_type==="list"){let e=s.zz_content.filter(o=>o.zz_content.model_type!=="ads");s.zz_content=e}else s.zz_type==="circular_banner"&&(s.zz_content.circular_banner_option.background="1",s.zz_content.circular_banner_option.color_card="#ffffff",s.zz_content.circular_banner_option.img="");s.zz_type!=="top_banner"&&s.zz_type!=="hongbao"&&t.push(s)}),r.data.component=t,d={body:JSON.stringify(r)}}catch(r){magicJS.logError(`\u9996\u9875\u53BB\u5E7F\u544A\u51FA\u73B0\u5F02\u5E38\uFF1A${r}`)}break;case/^https?:\/\/haojia-api\.smzdm\.com\/home\/list/.test(magicJS.request.url):try{let r=JSON.parse(magicJS.response.body),t=r.data.banner.big_banner.filter(e=>e.ad_banner_id=="");r.data.banner.big_banner=t;let s=r.data.rows.filter(e=>!e.hasOwnProperty("ad_banner_id"));r.data.banner.hongbao_banner=[],r.data.banner.module_banner.hongbao={},r.data.rows=s,d={body:JSON.stringify(r)}}catch(r){magicJS.logError(`\u597D\u4EF7\u53BB\u5E7F\u544A\u51FA\u73B0\u5F02\u5E38\uFF1A${r}`)}break;case/^https?:\/\/haojia\.m\.smzdm\.com\/detail_modul\/article_releated_modul/.test(magicJS.request.url):try{let r=JSON.parse(magicJS.response.body);r.data.lanmu_qikan={},d={body:JSON.stringify(r)}}catch(r){magicJS.logError(`\u597D\u4EF7\u8BE6\u60C5\u9875\u53BB\u5E7F\u544A\u51FA\u73B0\u5F02\u5E38\uFF1A${r}`)}break;case/^https?:\/\/baike-api\.smzdm\.com\/home_v3\/list/.test(magicJS.request.url):try{let r=JSON.parse(magicJS.response.body);r.data.rows=r.data.rows.filter(t=>!t.hasOwnProperty("ad_banner_id")||t.ad_banner_id==""),d={body:JSON.stringify(r)}}catch(r){magicJS.logError(`\u767E\u79D1\u53BB\u5E7F\u544A\u51FA\u73B0\u5F02\u5E38\uFF1A${r}`)}break;case/^https?:\/\/s-api\.smzdm\.com\/sou\/filter\/tags\/hot_tags/.test(magicJS.request.url):try{let r=JSON.parse(magicJS.response.body);r.data.hongbao={},d={body:JSON.stringify(r)}}catch(r){magicJS.logError(`\u641C\u7D22\u6807\u7B7E\u53BB\u5E7F\u544A\u51FA\u73B0\u5F02\u5E38\uFF1A${r}`)}break;case/^https?:\/\/s-api\.smzdm\.com\/sou\/list_v10/.test(magicJS.request.url):try{let r=JSON.parse(magicJS.response.body);r.data.rows=r.data.rows.filter(t=>t.article_tag!=="\u5E7F\u544A"),d={body:JSON.stringify(r)}}catch(r){magicJS.logError(`\u641C\u7D22\u7ED3\u679C\u53BB\u5E7F\u544A\u51FA\u73B0\u5F02\u5E38\uFF1A${r}`)}break;case/^https?:\/\/zhiyou\.m\.smzdm\.com\/user\/vip\/ajax_get_banner/.test(magicJS.request.url):try{let r=JSON.parse(magicJS.response.body);r.data.big_banner=r.data.big_banner.filter(t=>t.logo_title!=="\u5E7F\u544A"),d={body:JSON.stringify(r)}}catch(r){magicJS.logError(`\u503C\u4F1A\u5458\u6743\u76CA\u4E2D\u5FC3banner\u53BB\u5E7F\u544A\u51FA\u73B0\u5F02\u5E38\uFF1A${r}`)}break;default:magicJS.notify("\u89E6\u53D1\u610F\u5916\u7684\u8BF7\u6C42\u5904\u7406\uFF0C\u8BF7\u786E\u8BA4\u811A\u672C\u6216\u590D\u5199\u914D\u7F6E\u6B63\u5E38\u3002");break}else magicJS.notify("\u89E6\u53D1\u610F\u5916\u7684\u8BF7\u6C42\u5904\u7406\uFF0C\u8BF7\u786E\u8BA4\u811A\u672C\u6216\u590D\u5199\u914D\u7F6E\u6B63\u5E38\u3002");d?magicJS.done(d):magicJS.done()})();function MagicJS(d="MagicJS",r="INFO"){return new class{constructor(){if(this.version="2.2.3.3",this.scriptName=d,this.logLevels={DEBUG:5,INFO:4,NOTIFY:3,WARNING:2,ERROR:1,CRITICAL:0,NONE:-1},this.isLoon=typeof $loon<"u",this.isQuanX=typeof $task<"u",this.isJSBox=typeof $drive<"u",this.isNode=typeof module<"u"&&!this.isJSBox,this.isSurge=typeof $httpClient<"u"&&!this.isLoon,this.node={request:void 0,fs:void 0,data:{}},this.iOSUserAgent="Mozilla/5.0 (iPhone; CPU iPhone OS 13_3_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.5 Mobile/15E148 Safari/604.1",this.pcUserAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.125 Safari/537.36 Edg/84.0.522.59",this.logLevel=r,this._barkUrl="",this.isNode){this.node.fs=require("fs"),this.node.request=require("request");try{this.node.fs.accessSync("./magic.json",this.node.fs.constants.R_OK|this.node.fs.constants.W_OK)}catch{this.node.fs.writeFileSync("./magic.json","{}",{encoding:"utf8"})}this.node.data=require("./magic.json")}else this.isJSBox&&($file.exists("drive://MagicJS")||$file.mkdir("drive://MagicJS"),$file.exists("drive://MagicJS/magic.json")||$file.write({data:$data({string:"{}"}),path:"drive://MagicJS/magic.json"}))}set barkUrl(t){this._barkUrl=t.replace(/\/+$/g,"")}set logLevel(t){this._logLevel=typeof t=="string"?t.toUpperCase():"DEBUG"}get logLevel(){return this._logLevel}get isRequest(){return typeof $request<"u"&&typeof $response>"u"}get isResponse(){return typeof $response<"u"}get request(){return typeof $request<"u"?$request:void 0}get response(){return typeof $response<"u"?($response.hasOwnProperty("status")&&($response.statusCode=$response.status),$response.hasOwnProperty("statusCode")&&($response.status=$response.statusCode),$response):void 0}get platform(){return this.isSurge?"Surge":this.isQuanX?"Quantumult X":this.isLoon?"Loon":this.isJSBox?"JSBox":this.isNode?"Node.js":"Unknown"}read(t,s=""){let e="";this.isSurge||this.isLoon?e=$persistentStore.read(t):this.isQuanX?e=$prefs.valueForKey(t):this.isNode?e=this.node.data:this.isJSBox&&(e=$file.read("drive://MagicJS/magic.json").string);try{this.isNode&&(e=e[t]),this.isJSBox&&(e=JSON.parse(e)[t]),s&&(typeof e=="string"&&(e=JSON.parse(e)),e=e&&typeof e=="object"?e[s]:null)}catch(o){this.logError(o),e=s?{}:null,this.del(t)}e===void 0&&(e=null);try{e&&typeof e=="string"&&(e=JSON.parse(e))}catch{}return this.logDebug(`READ DATA [${t}]${s?`[${s}]`:""}(${typeof e})
${JSON.stringify(e)}`),e}write(t,s,e=""){let o=e?{}:"";if(e&&(this.isSurge||this.isLoon)?o=$persistentStore.read(t):e&&this.isQuanX?o=$prefs.valueForKey(t):this.isNode?o=this.node.data:this.isJSBox&&(o=JSON.parse($file.read("drive://MagicJS/magic.json").string)),e){try{typeof o=="string"&&(o=JSON.parse(o)),o=typeof o=="object"&&o?o:{}}catch(n){this.logError(n),this.del(t),o={}}this.isJSBox||this.isNode?(o[t]&&typeof o[t]=="object"||(o[t]={}),o[t].hasOwnProperty(e)||(o[t][e]=null),s===void 0?delete o[t][e]:o[t][e]=s):s===void 0?delete o[e]:o[e]=s}else this.isNode||this.isJSBox?s===void 0?delete o[t]:o[t]=s:o=s===void 0?null:s;typeof o=="object"&&(o=JSON.stringify(o)),this.isSurge||this.isLoon?$persistentStore.write(o,t):this.isQuanX?$prefs.setValueForKey(o,t):this.isNode?this.node.fs.writeFileSync("./magic.json",o):this.isJSBox&&$file.write({data:$data({string:o}),path:"drive://MagicJS/magic.json"}),this.logDebug(`WRITE DATA [${t}]${e?`[${e}]`:""}(${typeof s})
${JSON.stringify(s)}`)}del(t,s=""){this.logDebug(`DELETE KEY [${t}]${s?`[${s}]`:""}`),this.write(t,null,s)}notify(t=this.scriptName,s="",e="",o=""){let n;if(o=(i=>{let a={};if(typeof i=="string")this.isLoon?a={openUrl:i}:this.isQuanX?a={"open-url":i}:this.isSurge&&(a={url:i});else if(typeof i=="object"){if(this.isLoon)a.openUrl=i["open-url"]?i["open-url"]:"",a.mediaUrl=i["media-url"]?i["media-url"]:"";else if(this.isQuanX)a=i["open-url"]||i["media-url"]?i:{};else if(this.isSurge){let c=i["open-url"]||i.openUrl;a=c?{url:c}:{}}}return a})(o),arguments.length==1&&(t=this.scriptName,s="",e=arguments[0]),this.logNotify(`title:${t}
subTitle:${s}
body:${e}
options:${typeof o=="object"?JSON.stringify(o):o}`),this.isSurge)$notification.post(t,s,e,o);else if(this.isLoon)o?$notification.post(t,s,e,o):$notification.post(t,s,e);else if(this.isQuanX)$notify(t,s,e,o);else if(this.isNode){if(this._barkUrl){let i=encodeURI(`${t}/${s}
${e}`);this.get(`${this._barkUrl}/${i}`,()=>{})}}else if(this.isJSBox){let i={title:t,body:s?`${s}
${e}`:e};$push.schedule(i)}}notifyDebug(t=this.scriptName,s="",e="",o=""){this.logLevel==="DEBUG"&&(arguments.length==1&&(t=this.scriptName,s="",e=arguments[0]),this.notify(t,s,e,o))}log(t,s="INFO"){this.logLevels[this._logLevel]<this.logLevels[s.toUpperCase()]}logDebug(t){this.log(t,"DEBUG")}logInfo(t){this.log(t,"INFO")}logNotify(t){this.log(t,"NOTIFY")}logWarning(t){this.log(t,"WARNING")}logError(t){this.log(t,"ERROR")}logRetry(t){this.log(t,"RETRY")}adapterHttpOptions(t,s){let e=typeof t=="object"?Object.assign({},t):{url:t,headers:{}};e.hasOwnProperty("header")&&!e.hasOwnProperty("headers")&&(e.headers=e.header,delete e.header);const o={accept:"Accept","accept-ch":"Accept-CH","accept-charset":"Accept-Charset","accept-features":"Accept-Features","accept-encoding":"Accept-Encoding","accept-language":"Accept-Language","accept-ranges":"Accept-Ranges","access-control-allow-credentials":"Access-Control-Allow-Credentials","access-control-allow-origin":"Access-Control-Allow-Origin","access-control-allow-methods":"Access-Control-Allow-Methods","access-control-allow-headers":"Access-Control-Allow-Headers","access-control-max-age":"Access-Control-Max-Age","access-control-expose-headers":"Access-Control-Expose-Headers","access-control-request-method":"Access-Control-Request-Method","access-control-request-headers":"Access-Control-Request-Headers",age:"Age",allow:"Allow",alternates:"Alternates",authorization:"Authorization","cache-control":"Cache-Control",connection:"Connection","content-encoding":"Content-Encoding","content-language":"Content-Language","content-length":"Content-Length","content-location":"Content-Location","content-md5":"Content-MD5","content-range":"Content-Range","content-security-policy":"Content-Security-Policy","content-type":"Content-Type",cookie:"Cookie",dnt:"DNT",date:"Date",etag:"ETag",expect:"Expect",expires:"Expires",from:"From",host:"Host","if-match":"If-Match","if-modified-since":"If-Modified-Since","if-none-match":"If-None-Match","if-range":"If-Range","if-unmodified-since":"If-Unmodified-Since","last-event-id":"Last-Event-ID","last-modified":"Last-Modified",link:"Link",location:"Location","max-forwards":"Max-Forwards",negotiate:"Negotiate",origin:"Origin",pragma:"Pragma","proxy-authenticate":"Proxy-Authenticate","proxy-authorization":"Proxy-Authorization",range:"Range",referer:"Referer","retry-after":"Retry-After","sec-websocket-extensions":"Sec-Websocket-Extensions","sec-websocket-key":"Sec-Websocket-Key","sec-websocket-origin":"Sec-Websocket-Origin","sec-websocket-protocol":"Sec-Websocket-Protocol","sec-websocket-version":"Sec-Websocket-Version",server:"Server","set-cookie":"Set-Cookie","set-cookie2":"Set-Cookie2","strict-transport-security":"Strict-Transport-Security",tcn:"TCN",te:"TE",trailer:"Trailer","transfer-encoding":"Transfer-Encoding",upgrade:"Upgrade","user-agent":"User-Agent","variant-vary":"Variant-Vary",vary:"Vary",via:"Via",warning:"Warning","www-authenticate":"WWW-Authenticate","x-content-duration":"X-Content-Duration","x-content-security-policy":"X-Content-Security-Policy","x-dnsprefetch-control":"X-DNSPrefetch-Control","x-frame-options":"X-Frame-Options","x-requested-with":"X-Requested-With","x-surge-skip-scripting":"X-Surge-Skip-Scripting"};if(typeof e.headers=="object")for(let i in e.headers)o[i]&&(e.headers[o[i]]=e.headers[i],delete e.headers[i]);e.headers&&typeof e.headers=="object"&&e.headers["User-Agent"]||(e.headers&&typeof e.headers=="object"||(e.headers={}),this.isNode?e.headers["User-Agent"]=this.pcUserAgent:e.headers["User-Agent"]=this.iOSUserAgent);let n=!1;if((typeof e.opts=="object"&&(e.opts.hints===!0||e.opts["Skip-Scripting"]===!0)||typeof e.headers=="object"&&e.headers["X-Surge-Skip-Scripting"]===!0)&&(n=!0),n||(this.isSurge?e.headers["X-Surge-Skip-Scripting"]=!1:this.isLoon?e.headers["X-Requested-With"]="XMLHttpRequest":this.isQuanX&&(typeof e.opts!="object"&&(e.opts={}),e.opts.hints=!1)),this.isSurge&&!n||delete e.headers["X-Surge-Skip-Scripting"],!this.isQuanX&&e.hasOwnProperty("opts")&&delete e.opts,this.isQuanX&&e.hasOwnProperty("opts")&&delete e.opts["Skip-Scripting"],s==="GET"&&!this.isNode&&e.body){let i=Object.keys(e.body).map(a=>e.body===void 0?"":`${encodeURIComponent(a)}=${encodeURIComponent(e.body[a])}`).join("&");e.url.indexOf("?")<0&&(e.url+="?"),e.url.lastIndexOf("&")+1!=e.url.length&&e.url.lastIndexOf("?")+1!=e.url.length&&(e.url+="&"),e.url+=i,delete e.body}return this.isQuanX?(e.hasOwnProperty("body")&&typeof e.body!="string"&&(e.body=JSON.stringify(e.body)),e.method=s):this.isNode?(delete e.headers["Accept-Encoding"],typeof e.body=="object"&&(s==="GET"?(e.qs=e.body,delete e.body):s==="POST"&&(e.json=!0,e.body=e.body))):this.isJSBox&&(e.header=e.headers,delete e.headers),e}adapterHttpResponse(t){let s={body:t.body,headers:t.headers,json:()=>JSON.parse(s.body)};return t.hasOwnProperty("statusCode")&&t.statusCode&&(s.status=t.statusCode),s}get(t,s){let e=this.adapterHttpOptions(t,"GET");this.logDebug(`HTTP GET: ${JSON.stringify(e)}`),this.isSurge||this.isLoon?$httpClient.get(e,s):this.isQuanX?$task.fetch(e).then(o=>{o.status=o.statusCode,s(null,o,o.body)},o=>s(o.error,null,null)):this.isNode?this.node.request.get(e,(o,n,i)=>{n=this.adapterHttpResponse(n),s(o,n,i)}):this.isJSBox&&(e.handler=o=>{let n=o.error?JSON.stringify(o.error):void 0,i=typeof o.data=="object"?JSON.stringify(o.data):o.data;s(n,o.response,i)},$http.get(e))}getPromise(t){return new Promise((s,e)=>{magicJS.get(t,(o,n)=>{o?e(o):s(n)})})}post(t,s){let e=this.adapterHttpOptions(t,"POST");if(this.logDebug(`HTTP POST: ${JSON.stringify(e)}`),this.isSurge||this.isLoon)$httpClient.post(e,s);else if(this.isQuanX)$task.fetch(e).then(o=>{o.status=o.statusCode,s(null,o,o.body)},o=>{s(o.error,null,null)});else if(this.isNode){let o=this.node.request.post(e,s);o.status=o.statusCode,delete o.statusCode}else this.isJSBox&&(e.handler=o=>{let n=o.error?JSON.stringify(o.error):void 0,i=typeof o.data=="object"?JSON.stringify(o.data):o.data;s(n,o.response,i)},$http.post(e))}get http(){return{get:this.getPromise,post:this.post}}done(t={}){typeof $done<"u"&&$done(t)}isToday(t){if(t==null)return!1;{let s=new Date;return typeof t=="string"&&(t=new Date(t)),s.getFullYear()==t.getFullYear()&&s.getMonth()==t.getMonth()&&s.getDay()==t.getDay()}}isNumber(t){return parseFloat(t).toString()!=="NaN"}attempt(t,s=null){return t.then(e=>[null,e]).catch(e=>(this.logError(e),[e,s]))}retry(t,s=5,e=0,o=null){return(...n)=>new Promise((i,a)=>{function c(...l){Promise.resolve().then(()=>t.apply(this,l)).then(h=>{typeof o=="function"?Promise.resolve().then(()=>o(h)).then(()=>{i(h)}).catch(g=>{s>=1?e>0?setTimeout(()=>c.apply(this,l),e):c.apply(this,l):a(g),s--}):i(h)}).catch(h=>{this.logRetry(h),s>=1&&e>0?setTimeout(()=>c.apply(this,l),e):s>=1?c.apply(this,l):a(h),s--})}c.apply(this,n)})}formatTime(t,s="yyyy-MM-dd hh:mm:ss"){var e={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};/(y+)/.test(s)&&(s=s.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(let o in e)new RegExp("("+o+")").test(s)&&(s=s.replace(RegExp.$1,RegExp.$1.length==1?e[o]:("00"+e[o]).substr((""+e[o]).length)));return s}now(){return this.formatTime(new Date,"yyyy-MM-dd hh:mm:ss")}today(){return this.formatTime(new Date,"yyyy-MM-dd")}sleep(t){return new Promise(s=>setTimeout(s,t))}}(d)}
