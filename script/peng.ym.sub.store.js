// https://raw.githubusercontent.com/ElementRef/AboutConfig/main/script/peng.ym.sub.store.js
(function(){var createModuleFactory=function(t){var e;return function(n){return e||t(e={exports:{},parent:n},e.exports),e.exports}},_$sync_131=createModuleFactory(function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(dt){n.default.read(_$constants_86.ARTIFACTS_KEY)||n.default.write({},_$constants_86.ARTIFACTS_KEY),dt.get("/api/sync/artifacts",at),dt.get("/api/sync/artifact/:name",mt)},e.produceArtifact=Z,e.syncArtifacts=nt;var n=f(_$app_87),r=f(_$download_135),o=_$proxyUtils_88({});function f(dt){return dt&&dt.__esModule?dt:{default:dt}}function d(dt){return(d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ht){return typeof ht}:function(ht){return ht&&typeof Symbol=="function"&&ht.constructor===Symbol&&ht!==Symbol.prototype?"symbol":typeof ht})(dt)}function h(dt){return function(ht){if(Array.isArray(ht))return S(ht)}(dt)||function(ht){if(typeof Symbol<"u"&&ht[Symbol.iterator]!=null||ht["@@iterator"]!=null)return Array.from(ht)}(dt)||F(dt)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function y(dt,ht){var xt=typeof Symbol<"u"&&dt[Symbol.iterator]||dt["@@iterator"];if(!xt){if(Array.isArray(dt)||(xt=F(dt))||ht&&dt&&typeof dt.length=="number"){xt&&(dt=xt);var l=0,s=function(){};return{s,n:function(){return l>=dt.length?{done:!0}:{done:!1,value:dt[l++]}},e:function(rt){throw rt},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var v,$=!0,E=!1;return{s:function(){xt=xt.call(dt)},n:function(){var rt=xt.next();return $=rt.done,rt},e:function(rt){E=!0,v=rt},f:function(){try{$||xt.return==null||xt.return()}finally{if(E)throw v}}}}function F(dt,ht){if(dt){if(typeof dt=="string")return S(dt,ht);var xt=Object.prototype.toString.call(dt).slice(8,-1);return xt==="Object"&&dt.constructor&&(xt=dt.constructor.name),xt==="Map"||xt==="Set"?Array.from(dt):xt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(xt)?S(dt,ht):void 0}}function S(dt,ht){(ht==null||ht>dt.length)&&(ht=dt.length);for(var xt=0,l=new Array(ht);xt<ht;xt++)l[xt]=dt[xt];return l}function T(dt,ht,xt){return ht in dt?Object.defineProperty(dt,ht,{value:xt,enumerable:!0,configurable:!0,writable:!0}):dt[ht]=xt,dt}function U(){U=function(){return dt};var dt={},ht=Object.prototype,xt=ht.hasOwnProperty,l=typeof Symbol=="function"?Symbol:{},s=l.iterator||"@@iterator",v=l.asyncIterator||"@@asyncIterator",$=l.toStringTag||"@@toStringTag";function E(Zt,Vt,pe){return Object.defineProperty(Zt,Vt,{value:pe,enumerable:!0,configurable:!0,writable:!0}),Zt[Vt]}try{E({},"")}catch{E=function(Vt,pe,ge){return Vt[pe]=ge}}function rt(Zt,Vt,pe,ge){var jt=Vt&&Vt.prototype instanceof Ct?Vt:Ct,Bt=Object.create(jt.prototype),ie=new _e(ge||[]);return Bt._invoke=function(ee,Kt,be){var b="suspendedStart";return function(Be,ce){if(b==="executing")throw new Error("Generator is already running");if(b==="completed"){if(Be==="throw")throw ce;return{value:void 0,done:!0}}for(be.method=Be,be.arg=ce;;){var Gt=be.delegate;if(Gt){var ze=yt(Gt,be);if(ze){if(ze===Et)continue;return ze}}if(be.method==="next")be.sent=be._sent=be.arg;else if(be.method==="throw"){if(b==="suspendedStart")throw b="completed",be.arg;be.dispatchException(be.arg)}else be.method==="return"&&be.abrupt("return",be.arg);b="executing";var We=gt(ee,Kt,be);if(We.type==="normal"){if(b=be.done?"completed":"suspendedYield",We.arg===Et)continue;return{value:We.arg,done:be.done}}We.type==="throw"&&(b="completed",be.method="throw",be.arg=We.arg)}}}(Zt,pe,ie),Bt}function gt(Zt,Vt,pe){try{return{type:"normal",arg:Zt.call(Vt,pe)}}catch(ge){return{type:"throw",arg:ge}}}dt.wrap=rt;var Et={};function Ct(){}function x(){}function N(){}var G={};E(G,s,function(){return this});var A=Object.getPrototypeOf,C=A&&A(A(me([])));C&&C!==ht&&xt.call(C,s)&&(G=C);var j=N.prototype=Ct.prototype=Object.create(G);function K(Zt){["next","throw","return"].forEach(function(Vt){E(Zt,Vt,function(pe){return this._invoke(Vt,pe)})})}function J(Zt,Vt){var pe;this._invoke=function(ge,jt){function Bt(){return new Vt(function(ie,ee){(function Kt(be,b,Be,ce){var Gt=gt(Zt[be],Zt,b);if(Gt.type!=="throw"){var ze=Gt.arg,We=ze.value;return We&&d(We)=="object"&&xt.call(We,"__await")?Vt.resolve(We.__await).then(function(Xe){Kt("next",Xe,Be,ce)},function(Xe){Kt("throw",Xe,Be,ce)}):Vt.resolve(We).then(function(Xe){ze.value=Xe,Be(ze)},function(Xe){return Kt("throw",Xe,Be,ce)})}ce(Gt.arg)})(ge,jt,ie,ee)})}return pe=pe?pe.then(Bt,Bt):Bt()}}function yt(Zt,Vt){var pe=Zt.iterator[Vt.method];if(pe===void 0){if(Vt.delegate=null,Vt.method==="throw"){if(Zt.iterator.return&&(Vt.method="return",Vt.arg=void 0,yt(Zt,Vt),Vt.method==="throw"))return Et;Vt.method="throw",Vt.arg=new TypeError("The iterator does not provide a 'throw' method")}return Et}var ge=gt(pe,Zt.iterator,Vt.arg);if(ge.type==="throw")return Vt.method="throw",Vt.arg=ge.arg,Vt.delegate=null,Et;var jt=ge.arg;return jt?jt.done?(Vt[Zt.resultName]=jt.value,Vt.next=Zt.nextLoc,Vt.method!=="return"&&(Vt.method="next",Vt.arg=void 0),Vt.delegate=null,Et):jt:(Vt.method="throw",Vt.arg=new TypeError("iterator result is not an object"),Vt.delegate=null,Et)}function Dt(Zt){var Vt={tryLoc:Zt[0]};1 in Zt&&(Vt.catchLoc=Zt[1]),2 in Zt&&(Vt.finallyLoc=Zt[2],Vt.afterLoc=Zt[3]),this.tryEntries.push(Vt)}function Xt(Zt){var Vt=Zt.completion||{};Vt.type="normal",delete Vt.arg,Zt.completion=Vt}function _e(Zt){this.tryEntries=[{tryLoc:"root"}],Zt.forEach(Dt,this),this.reset(!0)}function me(Zt){if(Zt){var Vt=Zt[s];if(Vt)return Vt.call(Zt);if(typeof Zt.next=="function")return Zt;if(!isNaN(Zt.length)){var pe=-1,ge=function jt(){for(;++pe<Zt.length;)if(xt.call(Zt,pe))return jt.value=Zt[pe],jt.done=!1,jt;return jt.value=void 0,jt.done=!0,jt};return ge.next=ge}}return{next:de}}function de(){return{value:void 0,done:!0}}return x.prototype=N,E(j,"constructor",N),E(N,"constructor",x),x.displayName=E(N,$,"GeneratorFunction"),dt.isGeneratorFunction=function(Zt){var Vt=typeof Zt=="function"&&Zt.constructor;return!!Vt&&(Vt===x||(Vt.displayName||Vt.name)==="GeneratorFunction")},dt.mark=function(Zt){return Object.setPrototypeOf?Object.setPrototypeOf(Zt,N):(Zt.__proto__=N,E(Zt,$,"GeneratorFunction")),Zt.prototype=Object.create(j),Zt},dt.awrap=function(Zt){return{__await:Zt}},K(J.prototype),E(J.prototype,v,function(){return this}),dt.AsyncIterator=J,dt.async=function(Zt,Vt,pe,ge,jt){jt===void 0&&(jt=Promise);var Bt=new J(rt(Zt,Vt,pe,ge),jt);return dt.isGeneratorFunction(Vt)?Bt:Bt.next().then(function(ie){return ie.done?ie.value:Bt.next()})},K(j),E(j,$,"Generator"),E(j,s,function(){return this}),E(j,"toString",function(){return"[object Generator]"}),dt.keys=function(Zt){var Vt=[];for(var pe in Zt)Vt.push(pe);return Vt.reverse(),function ge(){for(;Vt.length;){var jt=Vt.pop();if(jt in Zt)return ge.value=jt,ge.done=!1,ge}return ge.done=!0,ge}},dt.values=me,_e.prototype={constructor:_e,reset:function(Zt){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Xt),!Zt)for(var Vt in this)Vt.charAt(0)==="t"&&xt.call(this,Vt)&&!isNaN(+Vt.slice(1))&&(this[Vt]=void 0)},stop:function(){this.done=!0;var Zt=this.tryEntries[0].completion;if(Zt.type==="throw")throw Zt.arg;return this.rval},dispatchException:function(Zt){if(this.done)throw Zt;var Vt=this;function pe(Kt,be){return Bt.type="throw",Bt.arg=Zt,Vt.next=Kt,be&&(Vt.method="next",Vt.arg=void 0),!!be}for(var ge=this.tryEntries.length-1;ge>=0;--ge){var jt=this.tryEntries[ge],Bt=jt.completion;if(jt.tryLoc==="root")return pe("end");if(jt.tryLoc<=this.prev){var ie=xt.call(jt,"catchLoc"),ee=xt.call(jt,"finallyLoc");if(ie&&ee){if(this.prev<jt.catchLoc)return pe(jt.catchLoc,!0);if(this.prev<jt.finallyLoc)return pe(jt.finallyLoc)}else if(ie){if(this.prev<jt.catchLoc)return pe(jt.catchLoc,!0)}else{if(!ee)throw new Error("try statement without catch or finally");if(this.prev<jt.finallyLoc)return pe(jt.finallyLoc)}}}},abrupt:function(Zt,Vt){for(var pe=this.tryEntries.length-1;pe>=0;--pe){var ge=this.tryEntries[pe];if(ge.tryLoc<=this.prev&&xt.call(ge,"finallyLoc")&&this.prev<ge.finallyLoc){var jt=ge;break}}jt&&(Zt==="break"||Zt==="continue")&&jt.tryLoc<=Vt&&Vt<=jt.finallyLoc&&(jt=null);var Bt=jt?jt.completion:{};return Bt.type=Zt,Bt.arg=Vt,jt?(this.method="next",this.next=jt.finallyLoc,Et):this.complete(Bt)},complete:function(Zt,Vt){if(Zt.type==="throw")throw Zt.arg;return Zt.type==="break"||Zt.type==="continue"?this.next=Zt.arg:Zt.type==="return"?(this.rval=this.arg=Zt.arg,this.method="return",this.next="end"):Zt.type==="normal"&&Vt&&(this.next=Vt),Et},finish:function(Zt){for(var Vt=this.tryEntries.length-1;Vt>=0;--Vt){var pe=this.tryEntries[Vt];if(pe.finallyLoc===Zt)return this.complete(pe.completion,pe.afterLoc),Xt(pe),Et}},catch:function(Zt){for(var Vt=this.tryEntries.length-1;Vt>=0;--Vt){var pe=this.tryEntries[Vt];if(pe.tryLoc===Zt){var ge=pe.completion;if(ge.type==="throw"){var jt=ge.arg;Xt(pe)}return jt}}throw new Error("illegal catch attempt")},delegateYield:function(Zt,Vt,pe){return this.delegate={iterator:me(Zt),resultName:Vt,nextLoc:pe},this.method==="next"&&(this.arg=void 0),Et}},dt}function M(dt,ht,xt,l,s,v,$){try{var E=dt[v]($),rt=E.value}catch(gt){return void xt(gt)}E.done?ht(rt):Promise.resolve(rt).then(l,s)}function Y(dt){return function(){var ht=this,xt=arguments;return new Promise(function(l,s){var v=dt.apply(ht,xt);function $(rt){M(v,l,s,$,E,"next",rt)}function E(rt){M(v,l,s,$,E,"throw",rt)}$(void 0)})}}function Z(dt){return D.apply(this,arguments)}function D(){return(D=Y(U().mark(function dt(ht){var xt,l,s,v,$,E,rt,gt,Et,Ct,x,N,G,A,C,j,K,J,yt,Dt,Xt,_e,me,de,Zt,Vt,pe,ge,jt,Bt,ie,ee,Kt,be,b,Be,ce,Gt,ze,We,Xe,nr,lr,ur,Me,Ke,Ir,Le,qr,hr,Sr,Xr,Kr,Qe,Je,tr,an,Vr,Gr,Yr,Jr,sn;return U().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:if(xt=ht.type,l=ht.name,s=ht.platform,v=ht.url,$=ht.ua,E=ht.content,rt=ht.mergeSources,gt=ht.ignoreFailedRemoteSub,Et=ht.ignoreFailedRemoteFile,Ct=ht.produceType,x=ht.produceOpts,N=x===void 0?{}:x,G=ht.subscription,A=ht.awaitCustomCache,C=ht.$options,j=ht.proxy,K=ht.noCache,s=s||"JSON",xt!=="subscription"){se.next=74;break}if(!l){se.next=10;break}if(yt=n.default.read(_$constants_86.SUBS_KEY),J=(0,_$database_133.findByName)(yt,l)){se.next=8;break}throw new Error("\u627E\u4E0D\u5230\u8BA2\u9605 ".concat(l));case 8:se.next=15;break;case 10:if(!G){se.next=14;break}J=G,se.next=15;break;case 14:throw new Error("\u672A\u63D0\u4F9B\u8BA2\u9605\u540D\u79F0\u6216\u8BA2\u9605\u6570\u636E");case 15:if(!E||["localFirst","remoteFirst"].includes(rt)){se.next=19;break}Dt=E,se.next=44;break;case 19:if(!v){se.next=31;break}return Xt={},se.next=23,Promise.all(v.split(/[\r\n]+/).map(function(ye){return ye.trim()}).filter(function(ye){return ye.length}).map(function(){var ye=Y(U().mark(function Re(ar){return U().wrap(function(he){for(;;)switch(he.prev=he.next){case 0:return he.prev=0,he.next=3,(0,r.default)(ar,$||J.ua,void 0,j||J.proxy,void 0,A,K||J.noCache,!0);case 3:return he.abrupt("return",he.sent);case 6:return he.prev=6,he.t0=he.catch(0),Xt[ar]=he.t0,n.default.error("\u8BA2\u9605 ".concat(J.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(ar," \u53D1\u751F\u9519\u8BEF: ").concat(he.t0)),he.abrupt("return","");case 11:case"end":return he.stop()}},Re,null,[[0,6]])}));return function(Re){return ye.apply(this,arguments)}}()));case 23:if(Dt=se.sent,_e=J.ignoreFailedRemoteSub,gt!=null&&gt!==""&&(_e=gt),_e||!(Object.keys(Xt).length>0)){se.next=28;break}throw new Error("\u8BA2\u9605 ".concat(J.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(Object.keys(Xt).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 28:rt==="localFirst"?Dt.unshift(E):rt==="remoteFirst"&&Dt.push(E),se.next=44;break;case 31:if(J.source!=="local"||["localFirst","remoteFirst"].includes(J.mergeSources)){se.next=35;break}Dt=J.content,se.next=44;break;case 35:return me={},se.next=38,Promise.all(J.url.split(/[\r\n]+/).map(function(ye){return ye.trim()}).filter(function(ye){return ye.length}).map(function(){var ye=Y(U().mark(function Re(ar){return U().wrap(function(he){for(;;)switch(he.prev=he.next){case 0:return he.prev=0,he.next=3,(0,r.default)(ar,$||J.ua,void 0,j||J.proxy,void 0,A,K||J.noCache,!0);case 3:return he.abrupt("return",he.sent);case 6:return he.prev=6,he.t0=he.catch(0),me[ar]=he.t0,n.default.error("\u8BA2\u9605 ".concat(J.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(ar," \u53D1\u751F\u9519\u8BEF: ").concat(he.t0)),he.abrupt("return","");case 11:case"end":return he.stop()}},Re,null,[[0,6]])}));return function(Re){return ye.apply(this,arguments)}}()));case 38:if(Dt=se.sent,de=J.ignoreFailedRemoteSub,gt!=null&&gt!==""&&(de=gt),de||!(Object.keys(me).length>0)){se.next=43;break}throw new Error("\u8BA2\u9605 ".concat(J.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(Object.keys(me).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 43:J.mergeSources==="localFirst"?Dt.unshift(J.content):J.mergeSources==="remoteFirst"&&Dt.push(J.content);case 44:return(Zt=(Array.isArray(Dt)?Dt:[Dt]).map(function(ye){return o.ProxyUtils.parse(ye)}).flat()).forEach(function(ye){ye._subName=J.name,ye._subDisplayName=J.displayName}),se.next=48,o.ProxyUtils.process(Zt,J.process||[],s,T({},J.name,J),C);case 48:if((Zt=se.sent).length!==0){se.next=51;break}throw new Error("\u8BA2\u9605 ".concat(l," \u4E2D\u4E0D\u542B\u6709\u6548\u8282\u70B9"));case 51:Vt={},pe=y(Zt),se.prev=53,pe.s();case 55:if((ge=pe.n()).done){se.next=63;break}if(jt=ge.value,!Vt[jt.name]){se.next=60;break}return n.default.notify("\u{1F30D} Sub-Store","\u26A0\uFE0F \u8BA2\u9605 ".concat(l," \u5305\u542B\u91CD\u590D\u8282\u70B9 ").concat(jt.name,"\uFF01"),"\u8BF7\u4ED4\u7EC6\u68C0\u6D4B\u914D\u7F6E\uFF01",{"media-url":"https://cdn3.iconfinder.com/data/icons/seo-outline-1/512/25_code_program_programming_develop_bug_search_developer-512.png"}),se.abrupt("break",63);case 60:Vt[jt.name]=!0;case 61:se.next=55;break;case 63:se.next=68;break;case 65:se.prev=65,se.t0=se.catch(53),pe.e(se.t0);case 68:return se.prev=68,pe.f(),se.finish(68);case 71:return se.abrupt("return",o.ProxyUtils.produce(Zt,s,Ct,N));case 74:if(xt!=="collection"){se.next=122;break}if(Bt=n.default.read(_$constants_86.SUBS_KEY),ie=n.default.read(_$constants_86.COLLECTIONS_KEY),ee=(0,_$database_133.findByName)(ie,l)){se.next=80;break}throw new Error("\u627E\u4E0D\u5230\u7EC4\u5408\u8BA2\u9605 ".concat(l));case 80:return Kt=h(ee.subscriptions),be=ee.subscriptionTags,Array.isArray(be)&&be.length>0&&Bt.forEach(function(ye){Array.isArray(ye.tag)&&ye.tag.length>0&&!Kt.includes(ye.name)&&ye.tag.some(function(Re){return be.includes(Re)})&&Kt.push(ye.name)}),b={},Be={},ce=0,se.next=88,Promise.all(Kt.map(function(){var ye=Y(U().mark(function Re(ar){var he,Zr,Ar,un,or;return U().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:if(he=(0,_$database_133.findByName)(Bt,ar),X.prev=1,n.default.info("\u6B63\u5728\u5904\u7406\u5B50\u8BA2\u9605\uFF1A".concat(he.name,"...")),he.source!=="local"||["localFirst","remoteFirst"].includes(he.mergeSources)){X.next=7;break}Ar=he.content,X.next=16;break;case 7:return un={},X.next=10,Promise.all(he.url.split(/[\r\n]+/).map(function(xe){return xe.trim()}).filter(function(xe){return xe.length}).map(function(){var xe=Y(U().mark(function Tr(gr){return U().wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Ve.prev=0,Ve.next=3,(0,r.default)(gr,he.ua,void 0,j||he.proxy||ee.proxy,void 0,void 0,K||he.noCache,!0);case 3:return Ve.abrupt("return",Ve.sent);case 6:return Ve.prev=6,Ve.t0=Ve.catch(0),un[gr]=Ve.t0,n.default.error("\u8BA2\u9605 ".concat(he.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(gr," \u53D1\u751F\u9519\u8BEF: ").concat(Ve.t0)),Ve.abrupt("return","");case 11:case"end":return Ve.stop()}},Tr,null,[[0,6]])}));return function(Tr){return xe.apply(this,arguments)}}()));case 10:return X.next=12,X.sent;case 12:if(Ar=X.sent,he.ignoreFailedRemoteSub||!(Object.keys(un).length>0)){X.next=15;break}throw new Error("\u8BA2\u9605 ".concat(he.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(Object.keys(un).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 15:he.mergeSources==="localFirst"?Ar.unshift(he.content):he.mergeSources==="remoteFirst"&&Ar.push(he.content);case 16:return(or=(Array.isArray(Ar)?Ar:[Ar]).map(function(xe){return o.ProxyUtils.parse(xe)}).flat()).forEach(function(xe){xe._subName=he.name,xe._subDisplayName=he.displayName,xe._collectionName=ee.name,xe._collectionDisplayName=ee.displayName}),X.next=20,o.ProxyUtils.process(or,he.process||[],s,(T(Zr={},he.name,he),T(Zr,"_collection",ee),T(Zr,"$options",C),Zr));case 20:or=X.sent,b[ar]=or,ce++,n.default.info("\u2705 \u5B50\u8BA2\u9605\uFF1A".concat(he.name,"\u52A0\u8F7D\u6210\u529F\uFF0C\u8FDB\u5EA6--").concat(100*(ce/Kt.length).toFixed(1),"% ")),X.next=31;break;case 26:X.prev=26,X.t0=X.catch(1),ce++,Be[ar]=X.t0,n.default.error("\u274C \u5904\u7406\u7EC4\u5408\u8BA2\u9605\u4E2D\u7684\u5B50\u8BA2\u9605: ".concat(he.name,"\u65F6\u51FA\u73B0\u9519\u8BEF\uFF1A").concat(X.t0,"\uFF01\u8FDB\u5EA6--").concat(100*(ce/Kt.length).toFixed(1),"%"));case 31:case"end":return X.stop()}},Re,null,[[1,26]])}));return function(Re){return ye.apply(this,arguments)}}()));case 88:if(Gt=ee.ignoreFailedRemoteSub,gt!=null&&gt!==""&&(Gt=gt),Gt||!(Object.keys(Be).length>0)){se.next=92;break}throw new Error("\u7EC4\u5408\u8BA2\u9605 ".concat(l," \u4E2D\u7684\u5B50\u8BA2\u9605 ").concat(Object.keys(Be).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 92:return(ze=Array.prototype.concat.apply([],Kt.map(function(ye){return b[ye]||[]}))).forEach(function(ye){ye._collectionName=ee.name,ye._collectionDisplayName=ee.displayName}),se.next=96,o.ProxyUtils.process(ze,ee.process||[],s,{_collection:ee},C);case 96:if((ze=se.sent).length!==0){se.next=99;break}throw new Error("\u7EC4\u5408\u8BA2\u9605 ".concat(l," \u4E2D\u4E0D\u542B\u6709\u6548\u8282\u70B9"));case 99:We={},Xe=y(ze),se.prev=101,Xe.s();case 103:if((nr=Xe.n()).done){se.next=111;break}if(lr=nr.value,!We[lr.name]){se.next=108;break}return n.default.notify("\u{1F30D} Sub-Store","\u26A0\uFE0F \u7EC4\u5408\u8BA2\u9605 ".concat(l," \u5305\u542B\u91CD\u590D\u8282\u70B9 ").concat(lr.name,"\uFF01"),"\u8BF7\u4ED4\u7EC6\u68C0\u6D4B\u914D\u7F6E\uFF01",{"media-url":"https://cdn3.iconfinder.com/data/icons/seo-outline-1/512/25_code_program_programming_develop_bug_search_developer-512.png"}),se.abrupt("break",111);case 108:We[lr.name]=!0;case 109:se.next=103;break;case 111:se.next=116;break;case 113:se.prev=113,se.t1=se.catch(101),Xe.e(se.t1);case 116:return se.prev=116,Xe.f(),se.finish(116);case 119:return se.abrupt("return",o.ProxyUtils.produce(ze,s,Ct,N));case 122:if(xt!=="rule"){se.next=153;break}if(ur=n.default.read(_$constants_86.RULES_KEY),Me=(0,_$database_133.findByName)(ur,l)){se.next=127;break}throw new Error("\u627E\u4E0D\u5230\u89C4\u5219 ".concat(l));case 127:Ke=[],Ir=0;case 129:if(!(Ir<Me.urls.length)){se.next=147;break}return Le=Me.urls[Ir],n.default.info("\u6B63\u5728\u5904\u7406URL\uFF1A".concat(Le,"\uFF0C\u8FDB\u5EA6--").concat(100*((Ir+1)/Me.urls.length).toFixed(1),"% ")),se.prev=132,se.next=135,(0,r.default)(Le);case 135:qr=se.sent,hr=qr.body,Sr=_$ruleUtils_111.RuleUtils.parse(hr),Ke=Ke.concat(Sr),se.next=144;break;case 141:se.prev=141,se.t2=se.catch(132),n.default.error("\u5904\u7406\u5206\u6D41\u8BA2\u9605\u4E2D\u7684URL: ".concat(Le,"\u65F6\u51FA\u73B0\u9519\u8BEF\uFF1A").concat(se.t2,"! \u8BE5\u8BA2\u9605\u5DF2\u88AB\u8DF3\u8FC7\u3002"));case 144:Ir++,se.next=129;break;case 147:return se.next=149,_$ruleUtils_111.RuleUtils.process(Ke,[{type:"Remove Duplicate Filter"}]);case 149:return Ke=se.sent,se.abrupt("return",_$ruleUtils_111.RuleUtils.produce(Ke,s));case 153:if(xt!=="file"){se.next=198;break}if(Kr=n.default.read(_$constants_86.FILES_KEY),Qe=(0,_$database_133.findByName)(Kr,l)){se.next=158;break}throw new Error("\u627E\u4E0D\u5230\u6587\u4EF6 ".concat(l));case 158:if(!E||["localFirst","remoteFirst"].includes(rt)){se.next=162;break}Je=E,se.next=187;break;case 162:if(!v){se.next=174;break}return tr={},se.next=166,Promise.all(v.split(/[\r\n]+/).map(function(ye){return ye.trim()}).filter(function(ye){return ye.length}).map(function(){var ye=Y(U().mark(function Re(ar){return U().wrap(function(he){for(;;)switch(he.prev=he.next){case 0:return he.prev=0,he.next=3,(0,r.default)(ar,$||Qe.ua,void 0,Qe.proxy||j,void 0,void 0,K);case 3:return he.abrupt("return",he.sent);case 6:return he.prev=6,he.t0=he.catch(0),tr[ar]=he.t0,n.default.error("\u6587\u4EF6 ".concat(Qe.name," \u7684\u8FDC\u7A0B\u6587\u4EF6 ").concat(ar," \u53D1\u751F\u9519\u8BEF: ").concat(he.t0)),he.abrupt("return","");case 11:case"end":return he.stop()}},Re,null,[[0,6]])}));return function(Re){return ye.apply(this,arguments)}}()));case 166:if(Je=se.sent,an=Qe.ignoreFailedRemoteFile,Et!=null&&Et!==""&&(an=Et),an||!(Object.keys(tr).length>0)){se.next=171;break}throw new Error("\u6587\u4EF6 ".concat(Qe.name," \u7684\u8FDC\u7A0B\u6587\u4EF6 ").concat(Object.keys(tr).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 171:rt==="localFirst"?Je.unshift(E):rt==="remoteFirst"&&Je.push(E),se.next=187;break;case 174:if(Qe.source!=="local"||["localFirst","remoteFirst"].includes(Qe.mergeSources)){se.next=178;break}Je=Qe.content,se.next=187;break;case 178:return Vr={},se.next=181,Promise.all(Qe.url.split(/[\r\n]+/).map(function(ye){return ye.trim()}).filter(function(ye){return ye.length}).map(function(){var ye=Y(U().mark(function Re(ar){return U().wrap(function(he){for(;;)switch(he.prev=he.next){case 0:return he.prev=0,he.next=3,(0,r.default)(ar,$||Qe.ua,void 0,Qe.proxy||j,void 0,void 0,K);case 3:return he.abrupt("return",he.sent);case 6:return he.prev=6,he.t0=he.catch(0),Vr[ar]=he.t0,n.default.error("\u6587\u4EF6 ".concat(Qe.name," \u7684\u8FDC\u7A0B\u6587\u4EF6 ").concat(ar," \u53D1\u751F\u9519\u8BEF: ").concat(he.t0)),he.abrupt("return","");case 11:case"end":return he.stop()}},Re,null,[[0,6]])}));return function(Re){return ye.apply(this,arguments)}}()));case 181:if(Je=se.sent,Gr=Qe.ignoreFailedRemoteFile,Et!=null&&Et!==""&&(Gr=Et),Gr||!(Object.keys(Vr).length>0)){se.next=186;break}throw new Error("\u6587\u4EF6 ".concat(Qe.name," \u7684\u8FDC\u7A0B\u6587\u4EF6 ").concat(Object.keys(Vr).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 186:Qe.mergeSources==="localFirst"?Je.unshift(Qe.content):Qe.mergeSources==="remoteFirst"&&Je.push(Qe.content);case 187:if(Yr=(Array.isArray(Je)?Je:[Je]).flat(),Jr=Yr.filter(function(ye){return ye!=null&&ye!==""}).join(`
`),!(Array.isArray(Qe.process)&&Qe.process.length>0)){se.next=195;break}return se.next=192,o.ProxyUtils.process({$files:Yr,$content:Jr,$options:C,$file:Qe},Qe.process);case 192:se.t3=se.sent,se.next=196;break;case 195:se.t3={$content:Jr,$files:Yr,$options:C};case 196:return sn=se.t3,se.abrupt("return",(Xr=sn?.$content)!==null&&Xr!==void 0?Xr:"");case 198:case"end":return se.stop()}},dt,null,[[53,65,68,71],[101,113,116,119],[132,141]])}))).apply(this,arguments)}function nt(){return ct.apply(this,arguments)}function ct(){return(ct=Y(U().mark(function dt(){var ht,xt,l,s,v,$,E,rt,gt,Et,Ct,x,N,G,A,C,j;return U().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(n.default.info("\u5F00\u59CB\u540C\u6B65\u6240\u6709\u8FDC\u7A0B\u914D\u7F6E..."),ht=n.default.read(_$constants_86.ARTIFACTS_KEY),xt={},K.prev=3,l=[],s=n.default.read(_$constants_86.SUBS_KEY),v=n.default.read(_$constants_86.COLLECTIONS_KEY),$=[],ht.map(function(J){if(J.sync&&J.source){if(J.type==="subscription"){var yt=J.source,Dt=(0,_$database_133.findByName)(s,yt);Dt&&Dt.url&&!$.includes(yt)&&$.push(yt)}else if(J.type==="collection"){var Xt=(0,_$database_133.findByName)(v,J.source);Xt&&Array.isArray(Xt.subscriptions)&&Xt.subscriptions.map(function(_e){var me=(0,_$database_133.findByName)(s,_e);me&&me.url&&!$.includes(_e)&&$.push(_e)})}}}),!($.length>0)){K.next=12;break}return K.next=12,Promise.all($.map(function(){var J=Y(U().mark(function yt(Dt){return U().wrap(function(Xt){for(;;)switch(Xt.prev=Xt.next){case 0:return Xt.prev=0,Xt.next=3,Z({type:"subscription",name:Dt,awaitCustomCache:!0});case 3:Xt.next=7;break;case 5:Xt.prev=5,Xt.t0=Xt.catch(0);case 7:case"end":return Xt.stop()}},yt,null,[[0,5]])}));return function(yt){return J.apply(this,arguments)}}()));case 12:return K.next=14,Promise.all(ht.map(function(){var J=Y(U().mark(function yt(Dt){var Xt,_e,me;return U().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:if(de.prev=0,!Dt.sync||!Dt.source){de.next=9;break}return n.default.info("\u6B63\u5728\u540C\u6B65\u4E91\u914D\u7F6E\uFF1A".concat(Dt.name,"...")),(Xt=Dt.platform==="SurgeMac")&&n.default.info("\u624B\u52A8\u6307\u5B9A\u4E86 target \u4E3A SurgeMac, \u5C06\u4F7F\u7528 Mihomo External"),de.next=7,Z({type:Dt.type,name:Dt.source,platform:Dt.platform,produceOpts:{"include-unsupported-proxy":Dt.includeUnsupportedProxy,useMihomoExternal:Xt}});case 7:_e=de.sent,xt[encodeURIComponent(Dt.name)]={content:_e};case 9:de.next=15;break;case 11:de.prev=11,de.t0=de.catch(0),n.default.error("\u540C\u6B65\u914D\u7F6E ".concat(Dt.name," \u53D1\u751F\u9519\u8BEF: ").concat((me=de.t0.message)!==null&&me!==void 0?me:de.t0)),l.push(Dt.name);case 15:case"end":return de.stop()}},yt,null,[[0,11]])}));return function(yt){return J.apply(this,arguments)}}()));case 14:if(!(l.length>0)){K.next=16;break}throw new Error("\u540C\u6B65\u914D\u7F6E ".concat(l.join(", ")," \u53D1\u751F\u9519\u8BEF \u8BE6\u60C5\u8BF7\u67E5\u770B\u65E5\u5FD7"));case 16:return K.next=18,(0,_$artifacts_116.syncToGist)(xt);case 18:E=K.sent,delete(rt=JSON.parse(E.body)).history,delete rt.forks,delete rt.owner,Object.values(rt.files).forEach(function(J){delete J.content}),n.default.info("\u4E0A\u4F20\u914D\u7F6E\u54CD\u5E94:"),n.default.info(JSON.stringify(rt,null,2)),gt=y(ht);try{for(gt.s();!(Et=gt.n()).done;)(Ct=Et.value).sync&&(Ct.updated=new Date().getTime(),N=rt.files,G=void 0,Array.isArray(N)&&(G=!0,N=Object.fromEntries(N.map(function(J){return[J.path,J]}))),A=(x=N[encodeURIComponent(Ct.name)])===null||x===void 0?void 0:x.raw_url,C=G?A:A?.replace(/\/raw\/[^/]*\/(.*)/,"/raw/$1"),n.default.info(`\u4E0A\u4F20\u914D\u7F6E\u5B8C\u6210
\u6587\u4EF6\u5217\u8868: `.concat(Object.keys(N).join(", "),`
\u5F53\u524D\u6587\u4EF6: `).concat(encodeURIComponent(Ct.name),`
\u54CD\u5E94\u8FD4\u56DE\u7684\u539F\u59CB\u94FE\u63A5: `).concat(A,`
\u5904\u7406\u5B8C\u7684\u65B0\u94FE\u63A5: `).concat(C)),Ct.url=C)}catch(J){gt.e(J)}finally{gt.f()}n.default.write(ht,_$constants_86.ARTIFACTS_KEY),n.default.info("\u5168\u90E8\u8BA2\u9605\u540C\u6B65\u6210\u529F\uFF01"),K.next=36;break;case 32:throw K.prev=32,K.t0=K.catch(3),n.default.error("\u540C\u6B65\u8BA2\u9605\u5931\u8D25\uFF0C\u539F\u56E0\uFF1A".concat((j=K.t0.message)!==null&&j!==void 0?j:K.t0)),K.t0;case 36:case"end":return K.stop()}},dt,null,[[3,32]])}))).apply(this,arguments)}function at(dt,ht){return et.apply(this,arguments)}function et(){return(et=Y(U().mark(function dt(ht,xt){var l,s;return U().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return n.default.info("\u5F00\u59CB\u540C\u6B65\u6240\u6709\u8FDC\u7A0B\u914D\u7F6E..."),v.prev=1,v.next=4,nt();case 4:(0,_$response_127.success)(xt),v.next=11;break;case 7:v.prev=7,v.t0=v.catch(1),n.default.error("\u540C\u6B65\u8BA2\u9605\u5931\u8D25\uFF0C\u539F\u56E0\uFF1A".concat((l=v.t0.message)!==null&&l!==void 0?l:v.t0)),(0,_$response_127.failed)(xt,new _$errors_119.InternalServerError("FAILED_TO_SYNC_ARTIFACTS","Failed to sync all artifacts","Reason: ".concat((s=v.t0.message)!==null&&s!==void 0?s:v.t0)));case 11:case"end":return v.stop()}},dt,null,[[1,7]])}))).apply(this,arguments)}function mt(dt,ht){return At.apply(this,arguments)}function At(){return(At=Y(U().mark(function dt(ht,xt){var l,s,v,$,E,rt,gt,Et,Ct,x,N,G,A;return U().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(l=ht.params.name,l=decodeURIComponent(l),n.default.info("\u5F00\u59CB\u540C\u6B65\u8FDC\u7A0B\u914D\u7F6E ".concat(l,"...")),s=n.default.read(_$constants_86.ARTIFACTS_KEY),v=(0,_$database_133.findByName)(s,l)){C.next=9;break}return n.default.error("\u627E\u4E0D\u5230\u8FDC\u7A0B\u914D\u7F6E ".concat(l)),(0,_$response_127.failed)(xt,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","\u627E\u4E0D\u5230\u8FDC\u7A0B\u914D\u7F6E ".concat(l)),404),C.abrupt("return");case 9:if(v.source){C.next=13;break}return n.default.error("\u8FDC\u7A0B\u914D\u7F6E ".concat(l," \u672A\u8BBE\u7F6E\u6765\u6E90")),(0,_$response_127.failed)(xt,new _$errors_119.ResourceNotFoundError("RESOURCE_HAS_NO_SOURCE","\u8FDC\u7A0B\u914D\u7F6E ".concat(l," \u672A\u8BBE\u7F6E\u6765\u6E90")),404),C.abrupt("return");case 13:return C.prev=13,(E=v.platform==="SurgeMac")&&n.default.info("\u624B\u52A8\u6307\u5B9A\u4E86 target \u4E3A SurgeMac, \u5C06\u4F7F\u7528 Mihomo External"),C.next=18,Z({type:v.type,name:v.source,platform:v.platform,produceOpts:{"include-unsupported-proxy":v.includeUnsupportedProxy,useMihomoExternal:E}});case 18:return rt=C.sent,n.default.info("\u6B63\u5728\u4E0A\u4F20\u914D\u7F6E\uFF1A".concat(v.name,`
>>>`).concat(JSON.stringify(v,null,2))),C.next=22,(0,_$artifacts_116.syncToGist)(T({},encodeURIComponent(v.name),{content:rt}));case 22:gt=C.sent,v.updated=new Date().getTime(),delete(Et=JSON.parse(gt.body)).history,delete Et.forks,delete Et.owner,Object.values(Et.files).forEach(function(j){delete j.content}),n.default.info("\u4E0A\u4F20\u914D\u7F6E\u54CD\u5E94:"),n.default.info(JSON.stringify(Et,null,2)),Ct=Et.files,Array.isArray(Ct)&&(x=!0,Ct=Object.fromEntries(Ct.map(function(j){return[j.path,j]}))),N=($=Ct[encodeURIComponent(v.name)])===null||$===void 0?void 0:$.raw_url,G=x?N:N?.replace(/\/raw\/[^/]*\/(.*)/,"/raw/$1"),n.default.info(`\u4E0A\u4F20\u914D\u7F6E\u5B8C\u6210
\u6587\u4EF6\u5217\u8868: `.concat(Object.keys(Ct).join(", "),`
\u5F53\u524D\u6587\u4EF6: `).concat(encodeURIComponent(v.name),`
\u54CD\u5E94\u8FD4\u56DE\u7684\u539F\u59CB\u94FE\u63A5: `).concat(N,`
\u5904\u7406\u5B8C\u7684\u65B0\u94FE\u63A5: `).concat(G)),v.url=G,n.default.write(s,_$constants_86.ARTIFACTS_KEY),(0,_$response_127.success)(xt,v),C.next=45;break;case 41:C.prev=41,C.t0=C.catch(13),n.default.error("\u8FDC\u7A0B\u914D\u7F6E ".concat(v.name," \u53D1\u751F\u9519\u8BEF: ").concat((A=C.t0.message)!==null&&A!==void 0?A:C.t0)),(0,_$response_127.failed)(xt,new _$errors_119.InternalServerError("FAILED_TO_SYNC_ARTIFACT","Failed to sync artifact ".concat(l),"Reason: ".concat(C.t0)));case 45:case"end":return C.stop()}},dt,null,[[13,41]])}))).apply(this,arguments)}}),_$proxyUtils_88=createModuleFactory(function(t,e){"use strict";function n(s){return(n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v})(s)}Object.defineProperty(e,"__esModule",{value:!0}),e.ProxyUtils=void 0;var r=_$buffer_3({}),o=Y(_$rs_145),f=Y(_$yaml_148),d=Y(_$download_135),h=function(s,v){if(s&&s.__esModule)return s;if(s===null||n(s)!=="object"&&typeof s!="function")return{default:s};var $=function(Ct){if(typeof WeakMap!="function")return null;var x=new WeakMap,N=new WeakMap;return function(G){return G?N:x}(Ct)}(void 0);if($&&$.has(s))return $.get(s);var E={},rt=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var gt in s)if(gt!=="default"&&Object.prototype.hasOwnProperty.call(s,gt)){var Et=rt?Object.getOwnPropertyDescriptor(s,gt):null;Et&&(Et.get||Et.set)?Object.defineProperty(E,gt,Et):E[gt]=s[gt]}return E.default=s,$&&$.set(s,E),E}(_$processors_95({})),y=Y(_$preprocessors_94),F=Y(_$producers_99),S=Y(_$parsers_89),T=Y(_$app_87),U=_$sync_131({}),M=Y(_$gist_139);function Y(s){return s&&s.__esModule?s:{default:s}}function Z(){Z=function(){return s};var s={},v=Object.prototype,$=v.hasOwnProperty,E=typeof Symbol=="function"?Symbol:{},rt=E.iterator||"@@iterator",gt=E.asyncIterator||"@@asyncIterator",Et=E.toStringTag||"@@toStringTag";function Ct(jt,Bt,ie){return Object.defineProperty(jt,Bt,{value:ie,enumerable:!0,configurable:!0,writable:!0}),jt[Bt]}try{Ct({},"")}catch{Ct=function(Bt,ie,ee){return Bt[ie]=ee}}function x(jt,Bt,ie,ee){var Kt=Bt&&Bt.prototype instanceof A?Bt:A,be=Object.create(Kt.prototype),b=new Vt(ee||[]);return be._invoke=function(Be,ce,Gt){var ze="suspendedStart";return function(We,Xe){if(ze==="executing")throw new Error("Generator is already running");if(ze==="completed"){if(We==="throw")throw Xe;return{value:void 0,done:!0}}for(Gt.method=We,Gt.arg=Xe;;){var nr=Gt.delegate;if(nr){var lr=me(nr,Gt);if(lr){if(lr===G)continue;return lr}}if(Gt.method==="next")Gt.sent=Gt._sent=Gt.arg;else if(Gt.method==="throw"){if(ze==="suspendedStart")throw ze="completed",Gt.arg;Gt.dispatchException(Gt.arg)}else Gt.method==="return"&&Gt.abrupt("return",Gt.arg);ze="executing";var ur=N(Be,ce,Gt);if(ur.type==="normal"){if(ze=Gt.done?"completed":"suspendedYield",ur.arg===G)continue;return{value:ur.arg,done:Gt.done}}ur.type==="throw"&&(ze="completed",Gt.method="throw",Gt.arg=ur.arg)}}}(jt,ie,b),be}function N(jt,Bt,ie){try{return{type:"normal",arg:jt.call(Bt,ie)}}catch(ee){return{type:"throw",arg:ee}}}s.wrap=x;var G={};function A(){}function C(){}function j(){}var K={};Ct(K,rt,function(){return this});var J=Object.getPrototypeOf,yt=J&&J(J(pe([])));yt&&yt!==v&&$.call(yt,rt)&&(K=yt);var Dt=j.prototype=A.prototype=Object.create(K);function Xt(jt){["next","throw","return"].forEach(function(Bt){Ct(jt,Bt,function(ie){return this._invoke(Bt,ie)})})}function _e(jt,Bt){var ie;this._invoke=function(ee,Kt){function be(){return new Bt(function(b,Be){(function ce(Gt,ze,We,Xe){var nr=N(jt[Gt],jt,ze);if(nr.type!=="throw"){var lr=nr.arg,ur=lr.value;return ur&&n(ur)=="object"&&$.call(ur,"__await")?Bt.resolve(ur.__await).then(function(Me){ce("next",Me,We,Xe)},function(Me){ce("throw",Me,We,Xe)}):Bt.resolve(ur).then(function(Me){lr.value=Me,We(lr)},function(Me){return ce("throw",Me,We,Xe)})}Xe(nr.arg)})(ee,Kt,b,Be)})}return ie=ie?ie.then(be,be):be()}}function me(jt,Bt){var ie=jt.iterator[Bt.method];if(ie===void 0){if(Bt.delegate=null,Bt.method==="throw"){if(jt.iterator.return&&(Bt.method="return",Bt.arg=void 0,me(jt,Bt),Bt.method==="throw"))return G;Bt.method="throw",Bt.arg=new TypeError("The iterator does not provide a 'throw' method")}return G}var ee=N(ie,jt.iterator,Bt.arg);if(ee.type==="throw")return Bt.method="throw",Bt.arg=ee.arg,Bt.delegate=null,G;var Kt=ee.arg;return Kt?Kt.done?(Bt[jt.resultName]=Kt.value,Bt.next=jt.nextLoc,Bt.method!=="return"&&(Bt.method="next",Bt.arg=void 0),Bt.delegate=null,G):Kt:(Bt.method="throw",Bt.arg=new TypeError("iterator result is not an object"),Bt.delegate=null,G)}function de(jt){var Bt={tryLoc:jt[0]};1 in jt&&(Bt.catchLoc=jt[1]),2 in jt&&(Bt.finallyLoc=jt[2],Bt.afterLoc=jt[3]),this.tryEntries.push(Bt)}function Zt(jt){var Bt=jt.completion||{};Bt.type="normal",delete Bt.arg,jt.completion=Bt}function Vt(jt){this.tryEntries=[{tryLoc:"root"}],jt.forEach(de,this),this.reset(!0)}function pe(jt){if(jt){var Bt=jt[rt];if(Bt)return Bt.call(jt);if(typeof jt.next=="function")return jt;if(!isNaN(jt.length)){var ie=-1,ee=function Kt(){for(;++ie<jt.length;)if($.call(jt,ie))return Kt.value=jt[ie],Kt.done=!1,Kt;return Kt.value=void 0,Kt.done=!0,Kt};return ee.next=ee}}return{next:ge}}function ge(){return{value:void 0,done:!0}}return C.prototype=j,Ct(Dt,"constructor",j),Ct(j,"constructor",C),C.displayName=Ct(j,Et,"GeneratorFunction"),s.isGeneratorFunction=function(jt){var Bt=typeof jt=="function"&&jt.constructor;return!!Bt&&(Bt===C||(Bt.displayName||Bt.name)==="GeneratorFunction")},s.mark=function(jt){return Object.setPrototypeOf?Object.setPrototypeOf(jt,j):(jt.__proto__=j,Ct(jt,Et,"GeneratorFunction")),jt.prototype=Object.create(Dt),jt},s.awrap=function(jt){return{__await:jt}},Xt(_e.prototype),Ct(_e.prototype,gt,function(){return this}),s.AsyncIterator=_e,s.async=function(jt,Bt,ie,ee,Kt){Kt===void 0&&(Kt=Promise);var be=new _e(x(jt,Bt,ie,ee),Kt);return s.isGeneratorFunction(Bt)?be:be.next().then(function(b){return b.done?b.value:be.next()})},Xt(Dt),Ct(Dt,Et,"Generator"),Ct(Dt,rt,function(){return this}),Ct(Dt,"toString",function(){return"[object Generator]"}),s.keys=function(jt){var Bt=[];for(var ie in jt)Bt.push(ie);return Bt.reverse(),function ee(){for(;Bt.length;){var Kt=Bt.pop();if(Kt in jt)return ee.value=Kt,ee.done=!1,ee}return ee.done=!0,ee}},s.values=pe,Vt.prototype={constructor:Vt,reset:function(jt){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Zt),!jt)for(var Bt in this)Bt.charAt(0)==="t"&&$.call(this,Bt)&&!isNaN(+Bt.slice(1))&&(this[Bt]=void 0)},stop:function(){this.done=!0;var jt=this.tryEntries[0].completion;if(jt.type==="throw")throw jt.arg;return this.rval},dispatchException:function(jt){if(this.done)throw jt;var Bt=this;function ie(ce,Gt){return be.type="throw",be.arg=jt,Bt.next=ce,Gt&&(Bt.method="next",Bt.arg=void 0),!!Gt}for(var ee=this.tryEntries.length-1;ee>=0;--ee){var Kt=this.tryEntries[ee],be=Kt.completion;if(Kt.tryLoc==="root")return ie("end");if(Kt.tryLoc<=this.prev){var b=$.call(Kt,"catchLoc"),Be=$.call(Kt,"finallyLoc");if(b&&Be){if(this.prev<Kt.catchLoc)return ie(Kt.catchLoc,!0);if(this.prev<Kt.finallyLoc)return ie(Kt.finallyLoc)}else if(b){if(this.prev<Kt.catchLoc)return ie(Kt.catchLoc,!0)}else{if(!Be)throw new Error("try statement without catch or finally");if(this.prev<Kt.finallyLoc)return ie(Kt.finallyLoc)}}}},abrupt:function(jt,Bt){for(var ie=this.tryEntries.length-1;ie>=0;--ie){var ee=this.tryEntries[ie];if(ee.tryLoc<=this.prev&&$.call(ee,"finallyLoc")&&this.prev<ee.finallyLoc){var Kt=ee;break}}Kt&&(jt==="break"||jt==="continue")&&Kt.tryLoc<=Bt&&Bt<=Kt.finallyLoc&&(Kt=null);var be=Kt?Kt.completion:{};return be.type=jt,be.arg=Bt,Kt?(this.method="next",this.next=Kt.finallyLoc,G):this.complete(be)},complete:function(jt,Bt){if(jt.type==="throw")throw jt.arg;return jt.type==="break"||jt.type==="continue"?this.next=jt.arg:jt.type==="return"?(this.rval=this.arg=jt.arg,this.method="return",this.next="end"):jt.type==="normal"&&Bt&&(this.next=Bt),G},finish:function(jt){for(var Bt=this.tryEntries.length-1;Bt>=0;--Bt){var ie=this.tryEntries[Bt];if(ie.finallyLoc===jt)return this.complete(ie.completion,ie.afterLoc),Zt(ie),G}},catch:function(jt){for(var Bt=this.tryEntries.length-1;Bt>=0;--Bt){var ie=this.tryEntries[Bt];if(ie.tryLoc===jt){var ee=ie.completion;if(ee.type==="throw"){var Kt=ee.arg;Zt(ie)}return Kt}}throw new Error("illegal catch attempt")},delegateYield:function(jt,Bt,ie){return this.delegate={iterator:pe(jt),resultName:Bt,nextLoc:ie},this.method==="next"&&(this.arg=void 0),G}},s}function D(s,v,$,E,rt,gt,Et){try{var Ct=s[gt](Et),x=Ct.value}catch(N){return void $(N)}Ct.done?v(x):Promise.resolve(x).then(E,rt)}function nt(s,v){return function($){if(Array.isArray($))return $}(s)||function($,E){var rt=$==null?null:typeof Symbol<"u"&&$[Symbol.iterator]||$["@@iterator"];if(rt!=null){var gt,Et,Ct=[],x=!0,N=!1;try{for(rt=rt.call($);!(x=(gt=rt.next()).done)&&(Ct.push(gt.value),!E||Ct.length!==E);x=!0);}catch(G){N=!0,Et=G}finally{try{x||rt.return==null||rt.return()}finally{if(N)throw Et}}return Ct}}(s,v)||at(s,v)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ct(s,v){var $=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(!$){if(Array.isArray(s)||($=at(s))||v&&s&&typeof s.length=="number"){$&&(s=$);var E=0,rt=function(){};return{s:rt,n:function(){return E>=s.length?{done:!0}:{done:!1,value:s[E++]}},e:function(x){throw x},f:rt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var gt,Et=!0,Ct=!1;return{s:function(){$=$.call(s)},n:function(){var x=$.next();return Et=x.done,x},e:function(x){Ct=!0,gt=x},f:function(){try{Et||$.return==null||$.return()}finally{if(Ct)throw gt}}}}function at(s,v){if(s){if(typeof s=="string")return et(s,v);var $=Object.prototype.toString.call(s).slice(8,-1);return $==="Object"&&s.constructor&&($=s.constructor.name),$==="Map"||$==="Set"?Array.from(s):$==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test($)?et(s,v):void 0}}function et(s,v){(v==null||v>s.length)&&(v=s.length);for(var $=0,E=new Array(v);$<v;$++)E[$]=s[$];return E}function mt(){var s;return s=Z().mark(function v($){var E,rt,gt,Et,Ct,x,N,G,A,C,j,K,J,yt,Dt,Xt,_e,me,de,Zt,Vt,pe,ge,jt,Bt,ie,ee=arguments;return Z().wrap(function(Kt){for(;;)switch(Kt.prev=Kt.next){case 0:E=ee.length>1&&ee[1]!==void 0?ee[1]:[],rt=ee.length>2?ee[2]:void 0,gt=ee.length>3?ee[3]:void 0,Et=ee.length>4?ee[4]:void 0,Ct=ct(E),Kt.prev=5,Ct.s();case 7:if((x=Ct.n()).done){Kt.next=75;break}if(!(N=x.value).disabled){Kt.next=12;break}return T.default.log('Skipping disabled operator: "'.concat(N.type,`" with arguments:
 >>> `).concat(JSON.stringify(N.args,null,2)||"None")),Kt.abrupt("continue",73);case 12:if(G=void 0,A={},N.type.indexOf("Script")===-1){Kt.next=64;break}if(C=N.args,j=C.mode,K=C.content,j!=="link"){Kt.next=63;break}if(J=void 0,(yt=K||"").endsWith("#noCache")&&(yt=yt.replace(/#noCache$/,""),J=!0),(Dt=yt.split("#")).length>1)try{A=JSON.parse(decodeURIComponent(Dt[1]))}catch{Xt=ct(Dt[1].split("&"));try{for(Xt.s();!(_e=Xt.n()).done;)me=_e.value,de=me.split("=")[0],Zt=me.split("=")[1],A[de]=Zt==null||Zt===""||decodeURIComponent(Zt)}catch(b){Xt.e(b)}finally{Xt.f()}}if(yt="".concat(yt.split("#")[0]).concat(J?"#noCache":""),!(Vt=yt.match(/^\/api\/(file|module)\/(.+)/))){Kt.next=51;break}if(pe="",Kt.prev=26,pe=Vt?.[1],(ge=Vt?.[2])!=null){Kt.next=31;break}throw new Error("\u672C\u5730 ".concat(pe," URL \u65E0\u6548: ").concat(yt));case 31:if(ge=decodeURIComponent(ge),jt=pe==="module"?_$constants_86.MODULES_KEY:_$constants_86.FILES_KEY,Bt=(0,_$database_133.findByName)(T.default.read(jt),ge)){Kt.next=36;break}throw new Error("\u627E\u4E0D\u5230 ".concat(pe,": ").concat(ge));case 36:if(pe!=="module"){Kt.next=40;break}G=Bt.content,Kt.next=43;break;case 40:return Kt.next=42,(0,U.produceArtifact)({type:"file",name:ge});case 42:G=Kt.sent;case 43:Kt.next=49;break;case 45:throw Kt.prev=45,Kt.t0=Kt.catch(26),T.default.error("Error when loading ".concat(pe,": ").concat(N.args.content,`.
 Reason: `).concat(Kt.t0)),new Error("\u65E0\u6CD5\u52A0\u8F7D ".concat(pe,": ").concat(yt));case 49:Kt.next=61;break;case 51:return Kt.prev=51,Kt.next=54,(0,d.default)(yt);case 54:G=Kt.sent,Kt.next=61;break;case 57:throw Kt.prev=57,Kt.t1=Kt.catch(51),T.default.error("Error when downloading remote script: ".concat(N.args.content,`.
 Reason: `).concat(Kt.t1)),new Error("\u65E0\u6CD5\u4E0B\u8F7D\u811A\u672C: ".concat(yt));case 61:Kt.next=64;break;case 63:G=K;case 64:if(h.default[N.type]){Kt.next=67;break}return T.default.error('Unknown operator: "'.concat(N.type,'"')),Kt.abrupt("continue",73);case 67:return T.default.log('Applying "'.concat(N.type,`" with arguments:
 >>> `).concat(JSON.stringify(N.args,null,2)||"None")),ie=void 0,ie=N.type.indexOf("Script")!==-1?h.default[N.type](G,rt,A,gt,Et):h.default[N.type](N.args||{}),Kt.next=72,(0,h.ApplyProcessor)(ie,$);case 72:$=Kt.sent;case 73:Kt.next=7;break;case 75:Kt.next=80;break;case 77:Kt.prev=77,Kt.t2=Kt.catch(5),Ct.e(Kt.t2);case 80:return Kt.prev=80,Ct.f(),Kt.finish(80);case 83:return Kt.abrupt("return",$);case 84:case"end":return Kt.stop()}},v,null,[[5,77,80,83],[26,45],[51,57]])}),(mt=function(){var v=this,$=arguments;return new Promise(function(E,rt){var gt=s.apply(v,$);function Et(x){D(gt,E,rt,Et,Ct,"next",x)}function Ct(x){D(gt,E,rt,Et,Ct,"throw",x)}Et(void 0)})}).apply(this,arguments)}var At={parse:function(s){s=function(K){var J,yt=ct(y.default);try{for(yt.s();!(J=yt.n()).done;){var Dt=J.value;try{if(Dt.test(K))return T.default.info("Pre-processor [".concat(Dt.name,"] activated")),Dt.parse(K)}catch(Xt){T.default.error("Parser [".concat(Dt.name,`] failed
 Reason: `).concat(Xt))}}}catch(Xt){yt.e(Xt)}finally{yt.f()}return K}(s);var v,$,E=[],rt=ct(s.split(`
`));try{for(rt.s();!($=rt.n()).done;){var gt=$.value;if((gt=gt.trim()).length!==0){var Et=!1;if(v){var Ct=nt(dt(v,gt),2),x=Ct[0];Ct[1]||(E.push(xt(x)),Et=!0)}if(!Et){var N,G=ct(S.default);try{for(G.s();!(N=G.n()).done;){var A=N.value,C=nt(dt(A,gt),2),j=C[0];if(!C[1]){E.push(xt(j)),v=A,Et=!0,T.default.info("".concat(A.name," is activated"));break}}}catch(K){G.e(K)}finally{G.f()}}Et||T.default.error("Failed to parse line: ".concat(gt))}}}catch(K){rt.e(K)}finally{rt.f()}return E},process:function(s){return mt.apply(this,arguments)},produce:function(s,v,$){var E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},rt=F.default[v];if(!rt)throw new Error("Target platform: ".concat(v," is not supported!"));var gt=/Surge|SurgeMac|Shadowrocket/i.test(v);if(s=(s=s.filter(function(C){return!(C.supported&&C.supported[v]===!1)})).map(function(C){return C._resolved=C.resolved,(0,_$utils_141.isNotBlank)(C.name)||(C.name="".concat(C.type," ").concat(C.server,":").concat(C.port)),C["disable-sni"]&&(gt?C.sni="off":["tuic"].includes(C.type)||(T.default.error("Target platform ".concat(v," does not support sni off. Proxy's fields (sni, tls-fingerprint and skip-cert-verify) will be modified.")),C.sni="",C["skip-cert-verify"]=!0,delete C["tls-fingerprint"])),C.ports&&(C.ports=String(C.ports),["ClashMeta"].includes(v)||(C.ports=C.ports.replace(/\//g,",")),C.port||(C.port=(0,_$utils_141.getRandomPort)(C.ports))),C}),T.default.log("Producing proxies for target: ".concat(v)),rt.type===void 0||rt.type==="SINGLE"){var Et,Ct,x,N,G,A=s.map(function(C){try{return rt.produce(C,$,E)}catch(j){return T.default.error("Cannot produce proxy: ".concat(JSON.stringify(C,null,2),`
Reason: `).concat(j)),""}}).filter(function(C){return C.length>0});return A=$==="internal"?A:A.join(`
`),v.startsWith("Surge")&&s.length>0&&s.every(function(C){return C.type==="wireguard"})&&(A="#!name=".concat((Et=s[0])===null||Et===void 0?void 0:Et._subName,`
#!desc=`).concat((Ct=(x=s[0])===null||x===void 0?void 0:x._desc)!==null&&Ct!==void 0?Ct:"",`
#!category=`).concat((N=(G=s[0])===null||G===void 0?void 0:G._category)!==null&&N!==void 0?N:"",`
`).concat(A)),A}if(rt.type==="ALL")return rt.produce(s,$,E)},ipAddress:_$utils_141.ipAddress,getRandomPort:_$utils_141.getRandomPort,isIPv4:_$utils_141.isIPv4,isIPv6:_$utils_141.isIPv6,isIP:l,yaml:f.default,getFlag:_$geo_138.getFlag,removeFlag:_$geo_138.removeFlag,getISO:_$geo_138.getISO,MMDB:_$geo_138.MMDB,Gist:M.default,download:d.default};function dt(s,v){if(!function($,E){try{return $.test(E)}catch{return!1}}(s,v))return[null,new Error("Parser mismatch")];try{return[s.parse(v),null]}catch($){return[null,$]}}function ht(s){if(typeof s=="string"||typeof s=="number"){if((s=String(s).trim())==="")return"/";if(!s.startsWith("/"))return"/"+s}return s}function xt(s){var v,$,E;typeof s.cipher=="string"&&(s.cipher=s.cipher.toLowerCase()),typeof s.password=="number"&&(s.password=(0,_$utils_141.numberToString)(s.password)),s.interface&&(s["interface-name"]=s.interface,delete s.interface),(0,_$utils_141.isValidPortNumber)(s.port)&&(s.port=parseInt(s.port,10)),s.server&&(s.server="".concat(s.server).trim().replace(/^\[/,"").replace(/\]$/,"")),s.network==="ws"&&(s["ws-opts"]||!s["ws-path"]&&!s["ws-headers"]||(s["ws-opts"]={},s["ws-path"]&&(s["ws-opts"].path=s["ws-path"]),s["ws-headers"]&&(s["ws-opts"].headers=s["ws-headers"])),delete s["ws-path"],delete s["ws-headers"]);var rt,gt,Et,Ct,x=(v=s["".concat(s.network,"-opts")])===null||v===void 0?void 0:v.path;if(Array.isArray(x)?s["".concat(s.network,"-opts")].path=x.map(function(Kt){return ht(Kt)}):x!=null&&(s["".concat(s.network,"-opts")].path=ht(x)),s.type==="trojan"&&s.network==="tcp"&&delete s.network,["vless"].includes(s.type)&&(s.network||(s.network="tcp")),["trojan","tuic","hysteria","hysteria2","juicity"].includes(s.type)&&(s.tls=!0),s.network){var N,G,A,C,j=(N=s["".concat(s.network,"-opts")])===null||N===void 0||(G=N.headers)===null||G===void 0?void 0:G.Host,K=(A=s["".concat(s.network,"-opts")])===null||A===void 0||(C=A.headers)===null||C===void 0?void 0:C.host;s.network==="h2"?!K&&j&&(s["".concat(s.network,"-opts")].headers.host=j,delete s["".concat(s.network,"-opts")].headers.Host):K&&!j&&(s["".concat(s.network,"-opts")].headers.Host=K,delete s["".concat(s.network,"-opts")].headers.host)}if(s.network==="h2"){var J,yt,Dt,Xt=(J=s["h2-opts"])===null||J===void 0||(yt=J.headers)===null||yt===void 0?void 0:yt.host,_e=(Dt=s["h2-opts"])===null||Dt===void 0?void 0:Dt.path;Xt&&!Array.isArray(Xt)&&(s["h2-opts"].headers.host=[Xt]),Array.isArray(_e)&&(s["h2-opts"].path=_e[0])}if(s.tls||!["ws","http"].includes(s.network)||($=s["".concat(s.network,"-opts")])!==null&&$!==void 0&&(E=$.headers)!==null&&E!==void 0&&E.Host||l(s.server)||(s["".concat(s.network,"-opts")]=s["".concat(s.network,"-opts")]||{},s["".concat(s.network,"-opts")].headers=s["".concat(s.network,"-opts")].headers||{},s["".concat(s.network,"-opts")].headers.Host=["vmess","vless"].includes(s.type)&&s.network==="http"?[s.server]:s.server),["vmess","vless"].includes(s.type)&&s.network==="http"){var me,de,Zt,Vt=(me=s["".concat(s.network,"-opts")])===null||me===void 0?void 0:me.path,pe=(de=s["".concat(s.network,"-opts")])===null||de===void 0||(Zt=de.headers)===null||Zt===void 0?void 0:Zt.Host;pe&&!Array.isArray(pe)&&(s["".concat(s.network,"-opts")].headers.Host=[pe]),Vt&&!Array.isArray(Vt)&&(s["".concat(s.network,"-opts")].path=[Vt])}if(s.tls&&!s.sni&&(l(s.server)||(s.sni=s.server),!s.sni&&s.network)){var ge,jt,Bt=(ge=s["".concat(s.network,"-opts")])===null||ge===void 0||(jt=ge.headers)===null||jt===void 0?void 0:jt.Host;(Bt=Array.isArray(Bt)?Bt[0]:Bt)&&(s.sni=Bt)}if(s.ports?s.ports=String(s.ports).replace(/\//g,","):delete s.ports,["hysteria2"].includes(s.type)&&s.obfs&&!["salamander"].includes(s.obfs)&&!s["obfs-password"]&&(s["obfs-password"]=s.obfs,s.obfs="salamander"),["vless"].includes(s.type)&&(s["reality-opts"]&&Object.keys(s["reality-opts"]).length===0&&delete s["reality-opts"],s["grpc-opts"]&&Object.keys(s["grpc-opts"]).length===0&&delete s["grpc-opts"],s["reality-opts"]||s.flow||delete s.flow,["http"].includes(s.network)&&(!((rt=s["".concat(s.network,"-opts")])===null||rt===void 0)&&rt.path||(s["".concat(s.network,"-opts")]||(s["".concat(s.network,"-opts")]={}),s["".concat(s.network,"-opts")].path=["/"]))),typeof s.name!="string")if(/^\d+$/.test(s.name))s.name="".concat(s.name);else try{var ie;(ie=s.name)!==null&&ie!==void 0&&ie.data?s.name=r.Buffer.from(s.name.data).toString("utf8"):s.name=r.Buffer.from(s.name).toString("utf8")}catch(Kt){T.default.error(`proxy.name decode failed
Reason: `.concat(Kt)),s.name="".concat(s.type," ").concat(s.server,":").concat(s.port)}["ws","http","h2"].includes(s.network)&&(!["ws","h2"].includes(s.network)||(gt=s["".concat(s.network,"-opts")])!==null&&gt!==void 0&&gt.path?s.network==="http"&&(!Array.isArray((Et=s["".concat(s.network,"-opts")])===null||Et===void 0?void 0:Et.path)||(Ct=s["".concat(s.network,"-opts")])!==null&&Ct!==void 0&&Ct.path.every(function(Kt){return!Kt}))&&(s["".concat(s.network,"-opts")]=s["".concat(s.network,"-opts")]||{},s["".concat(s.network,"-opts")].path=["/"]):(s["".concat(s.network,"-opts")]=s["".concat(s.network,"-opts")]||{},s["".concat(s.network,"-opts")].path="/")),["","off"].includes(s.sni)&&(s["disable-sni"]=!0);var ee=s.ca_str;s["ca-str"]?ee=s["ca-str"]:ee&&(delete s.ca_str,s["ca-str"]=ee);try{T.default.env.isNode&&!ee&&s._ca&&(ee=T.default.node.fs.readFileSync(s._ca,{encoding:"utf8"}))}catch(Kt){T.default.error(`Read ca file failed
Reason: `.concat(Kt))}return!s["tls-fingerprint"]&&ee&&(s["tls-fingerprint"]=o.default.generateFingerprint(ee)),s}function l(s){return(0,_$utils_141.isIPv4)(s)||(0,_$utils_141.isIPv6)(s)}e.ProxyUtils=At}),_$processors_95=createModuleFactory(function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApplyProcessor=ApplyProcessor,exports.default=void 0;var _resourceCache=_interopRequireDefault(_$resourceCache_144),_scriptResourceCache=_interopRequireDefault(_$scriptResourceCache_146),_lodash=_interopRequireDefault(_$lodash_53),_app=_interopRequireDefault(_$app_87),_2=_$proxyUtils_88({}),_sync=_$sync_131({}),_yaml=_interopRequireDefault(_$yaml_148),_env=_interopRequireDefault(_$env_136);function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=typeof Symbol=="function"?Symbol:{},o=r.iterator||"@@iterator",f=r.asyncIterator||"@@asyncIterator",d=r.toStringTag||"@@toStringTag";function h(l,s,v){return Object.defineProperty(l,s,{value:v,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,v,$){return s[v]=$}}function y(l,s,v,$){var E=s&&s.prototype instanceof T?s:T,rt=Object.create(E.prototype),gt=new dt($||[]);return rt._invoke=function(Et,Ct,x){var N="suspendedStart";return function(G,A){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(G==="throw")throw A;return{value:void 0,done:!0}}for(x.method=G,x.arg=A;;){var C=x.delegate;if(C){var j=et(C,x);if(j){if(j===S)continue;return j}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var K=F(Et,Ct,x);if(K.type==="normal"){if(N=x.done?"completed":"suspendedYield",K.arg===S)continue;return{value:K.arg,done:x.done}}K.type==="throw"&&(N="completed",x.method="throw",x.arg=K.arg)}}}(l,v,gt),rt}function F(l,s,v){try{return{type:"normal",arg:l.call(s,v)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var S={};function T(){}function U(){}function M(){}var Y={};h(Y,o,function(){return this});var Z=Object.getPrototypeOf,D=Z&&Z(Z(ht([])));D&&D!==e&&n.call(D,o)&&(Y=D);var nt=M.prototype=T.prototype=Object.create(Y);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(v){return this._invoke(s,v)})})}function at(l,s){var v;this._invoke=function($,E){function rt(){return new s(function(gt,Et){(function Ct(x,N,G,A){var C=F(l[x],l,N);if(C.type!=="throw"){var j=C.arg,K=j.value;return K&&_typeof(K)=="object"&&n.call(K,"__await")?s.resolve(K.__await).then(function(J){Ct("next",J,G,A)},function(J){Ct("throw",J,G,A)}):s.resolve(K).then(function(J){j.value=J,G(j)},function(J){return Ct("throw",J,G,A)})}A(C.arg)})($,E,gt,Et)})}return v=v?v.then(rt,rt):rt()}}function et(l,s){var v=l.iterator[s.method];if(v===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,et(l,s),s.method==="throw"))return S;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var $=F(v,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,S;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,S):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,S)}function mt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function At(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function dt(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(mt,this),this.reset(!0)}function ht(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var v=-1,$=function E(){for(;++v<l.length;)if(n.call(l,v))return E.value=l[v],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:xt}}function xt(){return{value:void 0,done:!0}}return U.prototype=M,h(nt,"constructor",M),h(M,"constructor",U),U.displayName=h(M,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===U||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,M):(l.__proto__=M,h(l,d,"GeneratorFunction")),l.prototype=Object.create(nt),l},t.awrap=function(l){return{__await:l}},ct(at.prototype),h(at.prototype,f,function(){return this}),t.AsyncIterator=at,t.async=function(l,s,v,$,E){E===void 0&&(E=Promise);var rt=new at(y(l,s,v,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(gt){return gt.done?gt.value:rt.next()})},ct(nt),h(nt,d,"Generator"),h(nt,o,function(){return this}),h(nt,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var v in l)s.push(v);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=ht,dt.prototype={constructor:dt,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(At),!l)for(var s in this)s.charAt(0)==="t"&&n.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function v(Ct,x){return rt.type="throw",rt.arg=l,s.next=Ct,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return v("end");if(E.tryLoc<=this.prev){var gt=n.call(E,"catchLoc"),Et=n.call(E,"finallyLoc");if(gt&&Et){if(this.prev<E.catchLoc)return v(E.catchLoc,!0);if(this.prev<E.finallyLoc)return v(E.finallyLoc)}else if(gt){if(this.prev<E.catchLoc)return v(E.catchLoc,!0)}else{if(!Et)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return v(E.finallyLoc)}}}},abrupt:function(l,s){for(var v=this.tryEntries.length-1;v>=0;--v){var $=this.tryEntries[v];if($.tryLoc<=this.prev&&n.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,S):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),S},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.finallyLoc===l)return this.complete(v.completion,v.afterLoc),At(v),S}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.tryLoc===l){var $=v.completion;if($.type==="throw"){var E=$.arg;At(v)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,v){return this.delegate={iterator:ht(l),resultName:s,nextLoc:v},this.method==="next"&&(this.arg=void 0),S}},t}function asyncGeneratorStep(t,e,n,r,o,f,d){try{var h=t[f](d),y=h.value}catch(F){return void n(F)}h.done?e(y):Promise.resolve(y).then(r,o)}function _asyncToGenerator(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var f=t.apply(e,n);function d(y){asyncGeneratorStep(f,r,o,d,h,"next",y)}function h(y){asyncGeneratorStep(f,r,o,d,h,"throw",y)}d(void 0)})}}function _createForOfIteratorHelper(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=_unsupportedIterableToArray(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){n=n.call(t)},n:function(){var y=n.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||n.return==null||n.return()}finally{if(h)throw f}}}}function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(r){_defineProperty(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray(t,e){if(t){if(typeof t=="string")return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _typeof(t){return(_typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function isObject(t){return t&&_typeof(t)==="object"&&!Array.isArray(t)}function trimWrap(t){return t.startsWith("<")&&t.endsWith(">")?t.slice(1,-1):t}function deepMerge(t,e){var n=typeof e=="string"?JSON.parse(e):e;for(var r in n)if(isObject(n[r]))if(r.endsWith("!"))t[trimWrap(r.slice(0,-1))]=n[r];else{var o=trimWrap(r);t[o]||Object.assign(t,_defineProperty({},o,{})),deepMerge(t[o],n[o])}else if(Array.isArray(n[r]))if(r.startsWith("+")){var f=trimWrap(r.slice(1));t[f]||Object.assign(t,_defineProperty({},f,[])),t[f]=[].concat(_toConsumableArray(n[r]),_toConsumableArray(t[f]))}else if(r.endsWith("+")){var d=trimWrap(r.slice(0,-1));t[d]||Object.assign(t,_defineProperty({},d,[])),t[d]=[].concat(_toConsumableArray(t[d]),_toConsumableArray(n[r]))}else{var h=trimWrap(r);Object.assign(t,_defineProperty({},h,n[r]))}else Object.assign(t,_defineProperty({},r,n[r]));return t}function ConditionalFilter(t){var e=t.rule;return{name:"Conditional Filter",func:function(n){return n.map(function(r){return isMatch(e,r)})}}}function isMatch(t,e){if(!t.operator)switch(t.proposition){case"IN":return t.value.indexOf(e[t.attr])!==-1;case"CONTAINS":return typeof e[t.attr]=="string"&&e[t.attr].indexOf(t.value)!==-1;case"EQUALS":return e[t.attr]===t.value;case"EXISTS":return e[t.attr]!==null||e[t.attr]!==void 0;default:throw new Error("Unknown proposition: ".concat(t.proposition))}switch(t.operator){case"AND":return t.child.every(function(n){return isMatch(n,e)});case"OR":return t.child.some(function(n){return isMatch(n,e)});case"NOT":return!isMatch(t.child,e);default:throw new Error("Unknown operator: ".concat(t.operator))}}function QuickSettingOperator(t){return{name:"Quick Setting Operator",func:function(n){if(e(t.useless)){var r=UselessFilter().func(n);n=n.filter(function(o,f){return r[f]&&o.port>0&&o.port<=65535})}return n.map(function(o){return o.udp=e(t.udp,o.udp),o.tfo=e(t.tfo,o.tfo),o["fast-open"]=e(t.tfo,o["fast-open"]),o["skip-cert-verify"]=e(t.scert,o["skip-cert-verify"]),o.type==="vmess"&&(o.aead=e(t["vmess aead"],o.aead)),o})}};function e(n,r){switch(n){case"ENABLED":return!0;case"DISABLED":return!1;default:return r}}}function FlagOperator(t){var e=t.mode,n=t.tw;return{name:"Flag Operator",func:function(r){return r.map(function(o){if(e==="remove")o.name=(0,_$geo_138.removeFlag)(o.name);else{var f=(0,_$geo_138.getFlag)(o.name);o.name=(0,_$geo_138.removeFlag)(o.name),o.name=f+" "+o.name,n=="ws"?o.name=o.name.replace(/\ud83c\uddf9\ud83c\uddfc/g,"\u{1F1FC}\u{1F1F8}"):n=="tw"||(o.name=o.name.replace(/\ud83c\uddf9\ud83c\uddfc/g,"\u{1F1E8}\u{1F1F3}"))}return o})}}}function HandleDuplicateOperator(t){var e=_objectSpread(_objectSpread({},{action:"rename",template:"0 1 2 3 4 5 6 7 8 9",link:"-",position:"back"}),t),n=e.action,r=e.template,o=e.link,f=e.position;return{name:"Handle Duplicate Operator",func:function(d){if(n==="delete"){var h={};return d.filter(function(U){return!h[U.name]&&(h[U.name]=!0,!0)})}if(n==="rename"){var y=r.split(" "),F={},S=0;d.forEach(function(U){F[U.name]===void 0?F[U.name]=1:F[U.name]++,S=Math.max(F[U.name].toString().length,S)});var T={};return d.map(function(U){if(F[U.name]>1){T[U.name]===void 0&&(T[U.name]=1);for(var M="",Y=T[U.name]++,Z=0;Y>0;)M=y[Y%10]+M,Y=parseInt(Y/10),Z++;for(;Z++<S;)M=y[0]+M;f==="front"?U.name=M+o+U.name:f==="back"&&(U.name=U.name+o+M)}return U})}}}}function SortOperator(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"asc";return{name:"Sort Operator",func:function(e){switch(t){case"asc":case"desc":return e.sort(function(n,r){return(n.name>r.name?1:-1)*(t==="desc"?-1:1)});case"random":return shuffle(e);default:throw new Error("Unknown sort option: "+t)}}}}function RegexSortOperator(t){return{name:"Regex Sort Operator",func:function(e){return t=t.map(function(n){return buildRegex(n)}),e.sort(function(n,r){var o=getRegexOrder(t,n.name),f=getRegexOrder(t,r.name);return o&&!f?-1:f&&!o?1:o&&f?o<f?-1:1:!o&&!f||o&&f&&o===f?n.name<r.name?-1:1:void 0})}}}function getRegexOrder(t,e){for(var n=null,r=0;r<t.length;r++)if(t[r].test(e)){n=r+1;break}return n}function RegexRenameOperator(t){return{name:"Regex Rename Operator",func:function(e){return e.map(function(n){var r,o=_createForOfIteratorHelper(t);try{for(o.s();!(r=o.n()).done;){var f=r.value,d=f.expr,h=f.now;n.name=n.name.replace(buildRegex(d,"g"),h).trim()}}catch(y){o.e(y)}finally{o.f()}return n})}}}function RegexDeleteOperator(t){return{name:"Regex Delete Operator",func:RegexRenameOperator(t.map(function(e){return{expr:e,now:""}})).func}}function ScriptOperator(t,e,n,r,o){return{name:"Script Operator",func:(d=_asyncToGenerator(_regeneratorRuntime().mark(function h(y){var F,S,T,U,M,Y,Z,D;return _regeneratorRuntime().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:if(((F=T=y)===null||F===void 0||(S=F.$file)===null||S===void 0?void 0:S.type)!=="mihomoProfile"){nt.next=19;break}return nt.prev=2,_typeof(D=_yaml.default.safeLoad(t))!=="object"&&(D={}),nt.t0=_2.ProxyUtils.yaml,nt.t1=deepMerge,nt.next=9,(0,_sync.produceArtifact)({type:((U=T)===null||U===void 0||(M=U.$file)===null||M===void 0?void 0:M.sourceType)||"collection",name:(Y=T)===null||Y===void 0||(Z=Y.$file)===null||Z===void 0?void 0:Z.sourceName,platform:"mihomo",produceType:"internal",produceOpts:{"delete-underscore-fields":!0}});case 9:return nt.t2=nt.sent,nt.t3={proxies:nt.t2},nt.t4=D,nt.t5=(0,nt.t1)(nt.t3,nt.t4),T.$content=nt.t0.safeDump.call(nt.t0,nt.t5),nt.abrupt("return",T);case 17:nt.prev=17,nt.t6=nt.catch(2);case 19:return nt.next=21,_asyncToGenerator(_regeneratorRuntime().mark(function ct(){var at;return _regeneratorRuntime().wrap(function(et){for(;;)switch(et.prev=et.next){case 0:at=createDynamicFunction("operator",t,n,o),T=at(y,e,_objectSpread({source:r},_env.default));case 2:case"end":return et.stop()}},ct)}))();case 21:return nt.abrupt("return",T);case 22:case"end":return nt.stop()}},h,null,[[2,17]])})),function(h){return d.apply(this,arguments)}),nodeFunc:(f=_asyncToGenerator(_regeneratorRuntime().mark(function h(y){var F;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return F=y,S.next=3,_asyncToGenerator(_regeneratorRuntime().mark(function T(){var U;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:U=createDynamicFunction("operator",`async function operator(input = []) {
                        if (input && (input.$files || input.$content)) {
                            let { $content, $files, $options, $file } = input
                            if($file.type === 'mihomoProfile') {
                                `.concat(t,`
                                if(typeof main === 'function') {
                                    const config = {
                                        proxies: await produceArtifact({
                                            type: $file.sourceType || 'collection',
                                            name: $file.sourceName,
                                            platform: 'mihomo',
                                            produceType: 'internal',
                                            produceOpts: {
                                                'delete-underscore-fields': true
                                            }
                                        }),
                                    }
                                    $content = ProxyUtils.yaml.safeDump(await main(config))
                                }
                            } else {
                                `).concat(t,`
                            }
                            return { $content, $files, $options, $file }
                        } else {
                            let proxies = input
                            let list = []
                            for await (let $server of proxies) {
                                `).concat(t,`
                                list.push($server)
                            }
                            return list
                        }
                      }`),n,o),F=U(y,e,_objectSpread({source:r},_env.default));case 2:case"end":return M.stop()}},T)}))();case 3:return S.abrupt("return",F);case 4:case"end":return S.stop()}},h)})),function(h){return f.apply(this,arguments)})};var f,d}function parseIP4P(t){var e,n;try{var r=t.split(":");n=parseInt(r[2],16);var o=parseInt(r[3],16),f=parseInt(r[4],16),d=255&o,h=f>>8,y=255&f;if(e="".concat(o>>8,".").concat(d,".").concat(h,".").concat(y),n<=0||n>65535)throw new Error("Invalid port number: ".concat(n));if(!(0,_$utils_141.isIPv4)(e))throw new Error("Invalid IP address: ".concat(e))}catch(F){_app.default.error("IP4P \u89E3\u6790\u5931\u8D25: ".concat(F))}return{server:e,port:n}}var DOMAIN_RESOLVERS={Custom:(_Custom=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n,r,o,f,d){var h,y,F,S,T,U;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(h=(0,_$md5_150.hex_md5)("CUSTOM:".concat(d,":").concat(e,":").concat(n)),y=_resourceCache.default.get(h),r||!y){M.next=4;break}return M.abrupt("return",y);case 4:return F=n==="IPv6"?"AAAA":"A",M.next=7,(0,_$dns_134.doh)({url:d,domain:e,type:F,timeout:o,edns:f});case 7:if(S=M.sent,T=S.answers,Array.isArray(T)&&T.length!==0){M.next=11;break}throw new Error("No answers");case 11:if((U=T.filter(function(Y){return Y?.type===F}).map(function(Y){return Y?.data}).filter(function(Y){return Y})).length!==0){M.next=14;break}throw new Error("No answers");case 14:return _resourceCache.default.set(h,U),M.abrupt("return",U);case 16:case"end":return M.stop()}},t)})),function(t,e,n,r,o,f){return _Custom.apply(this,arguments)}),Google:(_Google=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n,r,o,f){var d,h,y,F,S,T;return _regeneratorRuntime().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(d=(0,_$md5_150.hex_md5)("GOOGLE:".concat(e,":").concat(n)),h=_resourceCache.default.get(d),r||!h){U.next=4;break}return U.abrupt("return",h);case 4:return y=n==="IPv6"?"AAAA":"A",U.next=7,(0,_$dns_134.doh)({url:"https://8.8.4.4/dns-query",domain:e,type:y,timeout:o,edns:f});case 7:if(F=U.sent,S=F.answers,Array.isArray(S)&&S.length!==0){U.next=11;break}throw new Error("No answers");case 11:if((T=S.filter(function(M){return M?.type===y}).map(function(M){return M?.data}).filter(function(M){return M})).length!==0){U.next=14;break}throw new Error("No answers");case 14:return _resourceCache.default.set(d,T),U.abrupt("return",T);case 16:case"end":return U.stop()}},t)})),function(t,e,n,r,o){return _Google.apply(this,arguments)}),"IP-API":(_IPAPI=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n,r,o){var f,d,h,y,F;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!["IPv6"].includes(n)){S.next=2;break}throw new Error("\u57DF\u540D\u89E3\u6790\u670D\u52A1\u63D0\u4F9B\u65B9 IP-API \u4E0D\u652F\u6301 ".concat(n));case 2:if(f=(0,_$md5_150.hex_md5)("IP-API:".concat(e)),d=_resourceCache.default.get(f),r||!d){S.next=6;break}return S.abrupt("return",d);case 6:return S.next=8,_app.default.http.get({url:"http://ip-api.com/json/".concat(encodeURIComponent(e),"?lang=zh-CN"),timeout:o});case 8:if(h=S.sent,(y=JSON.parse(h.body)).status==="success"){S.next=12;break}throw new Error("Status is ".concat(y.status));case 12:if(y.query&&y.query!==0){S.next=14;break}throw new Error("No answers");case 14:if((F=[y.query]).length!==0){S.next=17;break}throw new Error("No answers");case 17:return _resourceCache.default.set(f,F),S.abrupt("return",F);case 19:case"end":return S.stop()}},t)})),function(t,e,n,r){return _IPAPI.apply(this,arguments)}),Cloudflare:(_Cloudflare=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n,r,o,f){var d,h,y,F,S,T;return _regeneratorRuntime().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(d=(0,_$md5_150.hex_md5)("CLOUDFLARE:".concat(e,":").concat(n)),h=_resourceCache.default.get(d),r||!h){U.next=4;break}return U.abrupt("return",h);case 4:return y=n==="IPv6"?"AAAA":"A",U.next=7,(0,_$dns_134.doh)({url:"https://1.0.0.1/dns-query",domain:e,type:y,timeout:o,edns:f});case 7:if(F=U.sent,S=F.answers,Array.isArray(S)&&S.length!==0){U.next=11;break}throw new Error("No answers");case 11:if((T=S.filter(function(M){return M?.type===y}).map(function(M){return M?.data}).filter(function(M){return M})).length!==0){U.next=14;break}throw new Error("No answers");case 14:return _resourceCache.default.set(d,T),U.abrupt("return",T);case 16:case"end":return U.stop()}},t)})),function(t,e,n,r,o){return _Cloudflare.apply(this,arguments)}),Ali:(_Ali=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n,r,o,f){var d,h,y,F,S;return _regeneratorRuntime().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(d=(0,_$md5_150.hex_md5)("ALI:".concat(e,":").concat(n)),h=_resourceCache.default.get(d),r||!h){T.next=4;break}return T.abrupt("return",h);case 4:return T.next=6,_app.default.http.get({url:"http://223.6.6.6/resolve?edns_client_subnet=".concat(f,"/24&name=").concat(encodeURIComponent(e),"&type=").concat(n==="IPv6"?"AAAA":"A","&short=1"),headers:{accept:"application/dns-json"},timeout:o});case 6:if(y=T.sent,F=JSON.parse(y.body),Array.isArray(F)&&F.length!==0){T.next=10;break}throw new Error("No answers");case 10:if((S=F).length!==0){T.next=13;break}throw new Error("No answers");case 13:return _resourceCache.default.set(d,S),T.abrupt("return",S);case 15:case"end":return T.stop()}},t)})),function(t,e,n,r,o){return _Ali.apply(this,arguments)}),Tencent:(_Tencent=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n,r,o,f){var d,h,y,F,S;return _regeneratorRuntime().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(d=(0,_$md5_150.hex_md5)("TENCENT:".concat(e,":").concat(n)),h=_resourceCache.default.get(d),r||!h){T.next=4;break}return T.abrupt("return",h);case 4:return T.next=6,_app.default.http.get({url:"http://119.28.28.28/d?ip=".concat(f,"&type=").concat(n==="IPv6"?"AAAA":"A","&dn=").concat(encodeURIComponent(e)),headers:{accept:"application/dns-json"},timeout:o});case 6:if(y=T.sent,(F=y.body.split(";").map(function(U){return U.split(",")[0]})).length!==0&&String(F)!=="0"){T.next=10;break}throw new Error("No answers");case 10:if((S=F).length!==0){T.next=13;break}throw new Error("No answers");case 13:return _resourceCache.default.set(d,S),T.abrupt("return",S);case 15:case"end":return T.stop()}},t)})),function(t,e,n,r,o){return _Tencent.apply(this,arguments)})},_Tencent,_Ali,_Cloudflare,_IPAPI,_Google,_Custom;function ResolveDomainOperator(t){var e=t.provider,n=t.type,r=t.filter,o=t.cache,f=t.url,d=t.timeout,h=t.edns;if(["IPv6","IP4P"].includes(n)&&["IP-API"].includes(e))throw new Error("\u57DF\u540D\u89E3\u6790\u670D\u52A1\u63D0\u4F9B\u65B9 ".concat(e," \u4E0D\u652F\u6301 ").concat(n));var y=_app.default.read(_$constants_86.SETTINGS_KEY).defaultTimeout,F=d||y||8e3,S=["IPv6","IP4P"].includes(n)?"IPv6":"IPv4",T=DOMAIN_RESOLVERS[e];if(!T)throw new Error("\u627E\u4E0D\u5230\u57DF\u540D\u89E3\u6790\u670D\u52A1\u63D0\u4F9B\u65B9: ".concat(e));var U,M=h||"223.6.6.6";if(!isIP(M))throw new Error("\u57DF\u540D\u89E3\u6790 EDNS \u5E94\u4E3A IP");return _app.default.info("Domain Resolver: [".concat(n,"] ").concat(e," ").concat(M||""," ").concat(f||"")),{name:"Resolve Domain Operator",func:(U=_asyncToGenerator(_regeneratorRuntime().mark(function Y(Z){var D,nt,ct,at,et,mt,At,dt,ht;return _regeneratorRuntime().wrap(function(xt){for(;;)switch(xt.prev=xt.next){case 0:Z.forEach(function(l,s){!l["_no-resolve"]&&l["no-resolve"]&&(Z[s]["_no-resolve"]=l["no-resolve"])}),D={},nt=15,ct=_toConsumableArray(new Set(Z.filter(function(l){return!isIP(l.server)&&!l["_no-resolve"]}).map(function(l){return l.server}))),at=Math.ceil(ct.length/nt),et=0;case 6:if(!(et<at)){xt.next=15;break}mt=[],At=_createForOfIteratorHelper(ct.splice(0,nt));try{for(ht=function(){var l=dt.value;mt.push(T(l,S,o==="disabled",F,M,f).then(function(s){D[l]=s,_app.default.info("Successfully resolved domain: ".concat(l," \u279F ").concat(s))}).catch(function(s){_app.default.error("Failed to resolve domain: ".concat(l," with resolver [").concat(e,"]: ").concat(s))}))},At.s();!(dt=At.n()).done;)ht()}catch(l){At.e(l)}finally{At.f()}return xt.next=12,Promise.all(mt);case 12:et++,xt.next=6;break;case 15:return Z.forEach(function(l){if(!l["_no-resolve"])if(D[l.server]){l._resolved_ips=D[l.server];var s=Array.isArray(D[l.server])?D[l.server][Math.floor(Math.random()*D[l.server].length)]:D[l.server];if(S==="IPv6"&&(0,_$utils_141.isIPv6)(s)){try{s=new _$utils_141.ipAddress.Address6(s).correctForm()}catch(rt){_app.default.error("Failed to parse IPv6 address: ".concat(s,": ").concat(rt))}if(/^2001::[^:]+:[^:]+:[^:]+$/.test(s)){l._IP4P=s;var v=parseIP4P(s),$=v.server,E=v.port;$&&E?(l._domain=l.server,l.server=$,l.port=E,l.resolved=!0,l._IPv4=l.server,isIP(l._IP)||(l._IP=l.server)):l.resolved||(l.resolved=!1)}else l._domain=l.server,l.server=s,l.resolved=!0,l["_".concat(S)]=l.server,isIP(l._IP)||(l._IP=l.server)}else l._domain=l.server,l.server=s,l.resolved=!0,l["_".concat(S)]=l.server,isIP(l._IP)||(l._IP=l.server)}else l.resolved||(l.resolved=!1)}),xt.abrupt("return",Z.filter(function(l){return r==="removeFailed"?isIP(l.server)||l["_no-resolve"]||l.resolved:r==="IPOnly"?isIP(l.server):r==="IPv4Only"?(0,_$utils_141.isIPv4)(l.server):r!=="IPv6Only"||(0,_$utils_141.isIPv6)(l.server)}));case 17:case"end":return xt.stop()}},Y)})),function(Y){return U.apply(this,arguments)})}}function isIP(t){return(0,_$utils_141.isIPv4)(t)||(0,_$utils_141.isIPv6)(t)}function isAscii(t){return/^[\x00-\x7F]+$/.test(t)}function UselessFilter(){return{name:"Useless Filter",func:function(t){return t.map(function(e){if(e.cipher&&!isAscii(e.cipher)||e.password&&!isAscii(e.password))return!1;if(e.network){var n,r,o,f,d=((n=e["".concat(e.network,"-opts")])===null||n===void 0||(r=n.headers)===null||r===void 0?void 0:r.Host)||((o=e["".concat(e.network,"-opts")])===null||o===void 0||(f=o.headers)===null||f===void 0?void 0:f.host);if((d=Array.isArray(d)?d:[d]).some(function(h){return h&&!isAscii(h)}))return!1}return!/\u7f51\u5740|\u6d41\u91cf|\u65f6\u95f4|\u5e94\u6025|\u8fc7\u671f|Bandwidth|expire/.test(e.name)})}}}function RegionFilter(t){var e={HK:"\u{1F1ED}\u{1F1F0}",TW:"\u{1F1F9}\u{1F1FC}",US:"\u{1F1FA}\u{1F1F8}",SG:"\u{1F1F8}\u{1F1EC}",JP:"\u{1F1EF}\u{1F1F5}",UK:"\u{1F1EC}\u{1F1E7}",DE:"\u{1F1E9}\u{1F1EA}",KR:"\u{1F1F0}\u{1F1F7}"};return{name:"Region Filter",func:function(n){return n.map(function(r){var o=(0,_$geo_138.getFlag)(r.name);return t.some(function(f){return e[f]===o})})}}}function RegexFilter(t){var e=t.regex,n=e===void 0?[]:e,r=t.keep,o=r===void 0||r;return{name:"Regex Filter",func:function(f){return f.map(function(d){var h=n.some(function(y){return buildRegex(y).test(d.name)});return o?h:!h})}}}function buildRegex(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return n=n.join(""),t.startsWith("(?i)")?(t=t.substring(4),new RegExp(t,"i"+n)):new RegExp(t,n)}function TypeFilter(t){return{name:"Type Filter",func:function(e){return e.map(function(n){return t.some(function(r){return n.type===r})})}}}function ScriptFilter(t,e,n,r,o){return{name:"Script Filter",func:(d=_asyncToGenerator(_regeneratorRuntime().mark(function h(y){var F;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return F=(0,_$logical_142.FULL)(y.length,!0),S.next=3,_asyncToGenerator(_regeneratorRuntime().mark(function T(){var U;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:U=createDynamicFunction("filter",t,n,o),F=U(y,e,_objectSpread({source:r},_env.default));case 2:case"end":return M.stop()}},T)}))();case 3:return S.abrupt("return",F);case 4:case"end":return S.stop()}},h)})),function(h){return d.apply(this,arguments)}),nodeFunc:(f=_asyncToGenerator(_regeneratorRuntime().mark(function h(y){var F;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return F=(0,_$logical_142.FULL)(y.length,!0),S.next=3,_asyncToGenerator(_regeneratorRuntime().mark(function T(){var U;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:U=createDynamicFunction("filter",`async function filter(input = []) {
                        let proxies = input
                        let list = []
                        const fn = async ($server) => {
                            `.concat(t,`
                        }
                        for await (let $server of proxies) {
                            list.push(await fn($server))
                        }
                        return list
                      }`),n,o),F=U(y,e,_objectSpread({source:r},_env.default));case 2:case"end":return M.stop()}},T)}))();case 3:return S.abrupt("return",F);case 4:case"end":return S.stop()}},h)})),function(h){return f.apply(this,arguments)})};var f,d}ResolveDomainOperator.resolver=DOMAIN_RESOLVERS;var _default={"Useless Filter":UselessFilter,"Region Filter":RegionFilter,"Regex Filter":RegexFilter,"Type Filter":TypeFilter,"Script Filter":ScriptFilter,"Conditional Filter":ConditionalFilter,"Quick Setting Operator":QuickSettingOperator,"Flag Operator":FlagOperator,"Sort Operator":SortOperator,"Regex Sort Operator":RegexSortOperator,"Regex Rename Operator":RegexRenameOperator,"Regex Delete Operator":RegexDeleteOperator,"Script Operator":ScriptOperator,"Handle Duplicate Operator":HandleDuplicateOperator,"Resolve Domain Operator":ResolveDomainOperator};function ApplyFilter(t,e){return _ApplyFilter.apply(this,arguments)}function _ApplyFilter(){return(_ApplyFilter=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n){var r,o,f,d,h,y,F;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return r=(0,_$logical_142.FULL)(n.length,!0),S.prev=1,S.next=4,e.func(n);case 4:r=S.sent,S.next=25;break;case 7:return S.prev=7,S.t0=S.catch(1),f="",(d="".concat((o=S.t0.message)!==null&&o!==void 0?o:S.t0)).includes("$server is not defined")?f="":(_app.default.error("Cannot apply filter ".concat(e.name,"(function filter)! Reason: ").concat(S.t0)),f="\u6267\u884C function filter \u5931\u8D25 ".concat(d,"; ")),S.prev=12,S.next=15,e.nodeFunc(n);case 15:r=S.sent,S.next=25;break;case 18:throw S.prev=18,S.t1=S.catch(12),_app.default.error("Cannot apply filter ".concat(e.name,"(shortcut script)! Reason: ").concat(S.t1)),y="",F="".concat((h=S.t1.message)!==null&&h!==void 0?h:S.t1),f&&F===d?(y="",f="\u6267\u884C\u5931\u8D25 ".concat(d)):y="\u6267\u884C\u5FEB\u6377\u8FC7\u6EE4\u811A\u672C \u5931\u8D25 ".concat(F),new Error("\u811A\u672C\u8FC7\u6EE4 ".concat(f).concat(y));case 25:return S.abrupt("return",n.filter(function(T,U){return r[U]}));case 26:case"end":return S.stop()}},t,null,[[1,7],[12,18]])}))).apply(this,arguments)}function ApplyOperator(t,e){return _ApplyOperator.apply(this,arguments)}function _ApplyOperator(){return(_ApplyOperator=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n){var r,o,f,d,h,y,F,S,T,U,M;return _regeneratorRuntime().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return r=clone(n),Y.prev=1,Y.next=4,e.func(r);case 4:(o=Y.sent)&&(r=o),Y.next=27;break;case 8:return Y.prev=8,Y.t0=Y.catch(1),y="",(F="".concat((f=Y.t0.message)!==null&&f!==void 0?f:Y.t0)).includes("$server is not defined")||F.includes("$content is not defined")||F.includes("$files is not defined")||(d=r)!==null&&d!==void 0&&d.$files||(h=r)!==null&&h!==void 0&&h.$content?y="":(_app.default.error("Cannot apply operator ".concat(e.name,"(function operator)! Reason: ").concat(Y.t0)),y="\u6267\u884C function operator \u5931\u8D25 ".concat(F,"; ")),Y.prev=13,Y.next=16,e.nodeFunc(r);case 16:(S=Y.sent)&&(r=S),Y.next=27;break;case 20:throw Y.prev=20,Y.t1=Y.catch(13),_app.default.error("Cannot apply operator ".concat(e.name,"(shortcut script)! Reason: ").concat(Y.t1)),U="",M="".concat((T=Y.t1.message)!==null&&T!==void 0?T:Y.t1),y&&M===F?(U="",y="\u6267\u884C\u5931\u8D25 ".concat(F)):U="\u6267\u884C\u5FEB\u6377\u811A\u672C \u5931\u8D25 ".concat(M),new Error("\u811A\u672C\u64CD\u4F5C ".concat(y).concat(U));case 27:return Y.abrupt("return",r);case 28:case"end":return Y.stop()}},t,null,[[1,8],[13,20]])}))).apply(this,arguments)}function ApplyProcessor(t,e){return _ApplyProcessor.apply(this,arguments)}function _ApplyProcessor(){return(_ApplyProcessor=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e.name.indexOf("Filter")===-1){r.next=4;break}return r.abrupt("return",ApplyFilter(e,n));case 4:if(e.name.indexOf("Operator")===-1){r.next=6;break}return r.abrupt("return",ApplyOperator(e,n));case 6:case"end":return r.stop()}},t)}))).apply(this,arguments)}function shuffle(t){for(var e,n,r=t.length;r!==0;)n=Math.floor(Math.random()*r),e=t[r-=1],t[r]=t[n],t[n]=e;return t}function clone(t){return JSON.parse(JSON.stringify(t))}function createDynamicFunction(name,script,$arguments,$options){var flowUtils={getFlowField:_$flow_137.getFlowField,getFlowHeaders:_$flow_137.getFlowHeaders,parseFlowHeaders:_$flow_137.parseFlowHeaders,flowTransfer:_$flow_137.flowTransfer,validCheck:_$flow_137.validCheck,getRmainingDays:_$flow_137.getRmainingDays};return _app.default.env.isLoon?new Function("$arguments","$options","$substore","lodash","$persistentStore","$httpClient","$notification","ProxyUtils","scriptResourceCache","flowUtils","produceArtifact","require","".concat(script,`
 return `).concat(name))($arguments,$options,_app.default,_lodash.default,$persistentStore,$httpClient,$notification,_2.ProxyUtils,_scriptResourceCache.default,flowUtils,_sync.produceArtifact,eval('typeof require !== "undefined"')?require:void 0):new Function("$arguments","$options","$substore","lodash","ProxyUtils","scriptResourceCache","flowUtils","produceArtifact","require","".concat(script,`
 return `).concat(name))($arguments,$options,_app.default,_lodash.default,_2.ProxyUtils,_scriptResourceCache.default,flowUtils,_sync.produceArtifact,eval('typeof require !== "undefined"')?require:void 0)}exports.default=_default}),_$buffer_3=createModuleFactory(function(t,e){(function(n){(function(){"use strict";e.Buffer=o,e.SlowBuffer=function(A){return+A!=A&&(A=0),o.alloc(+A)},e.INSPECT_MAX_BYTES=50;function r(A){if(A>2147483647)throw new RangeError('The value "'+A+'" is invalid for option "size"');var C=new Uint8Array(A);return C.__proto__=o.prototype,C}function o(A,C,j){if(typeof A=="number"){if(typeof C=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h(A)}return f(A,C,j)}function f(A,C,j){if(typeof A=="string")return function(yt,Dt){if(typeof Dt=="string"&&Dt!==""||(Dt="utf8"),!o.isEncoding(Dt))throw new TypeError("Unknown encoding: "+Dt);var Xt=0|S(yt,Dt),_e=r(Xt),me=_e.write(yt,Dt);return me!==Xt&&(_e=_e.slice(0,me)),_e}(A,C);if(ArrayBuffer.isView(A))return y(A);if(A==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof A);if(N(A,ArrayBuffer)||A&&N(A.buffer,ArrayBuffer))return function(yt,Dt,Xt){if(Dt<0||yt.byteLength<Dt)throw new RangeError('"offset" is outside of buffer bounds');if(yt.byteLength<Dt+(Xt||0))throw new RangeError('"length" is outside of buffer bounds');var _e;return(_e=Dt===void 0&&Xt===void 0?new Uint8Array(yt):Xt===void 0?new Uint8Array(yt,Dt):new Uint8Array(yt,Dt,Xt)).__proto__=o.prototype,_e}(A,C,j);if(typeof A=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var K=A.valueOf&&A.valueOf();if(K!=null&&K!==A)return o.from(K,C,j);var J=function(yt){if(o.isBuffer(yt)){var Dt=0|F(yt.length),Xt=r(Dt);return Xt.length===0||yt.copy(Xt,0,0,Dt),Xt}return yt.length!==void 0?typeof yt.length!="number"||G(yt.length)?r(0):y(yt):yt.type==="Buffer"&&Array.isArray(yt.data)?y(yt.data):void 0}(A);if(J)return J;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof A[Symbol.toPrimitive]=="function")return o.from(A[Symbol.toPrimitive]("string"),C,j);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof A)}function d(A){if(typeof A!="number")throw new TypeError('"size" argument must be of type number');if(A<0)throw new RangeError('The value "'+A+'" is invalid for option "size"')}function h(A){return d(A),r(A<0?0:0|F(A))}function y(A){for(var C=A.length<0?0:0|F(A.length),j=r(C),K=0;K<C;K+=1)j[K]=255&A[K];return j}function F(A){if(A>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|A}function S(A,C){if(o.isBuffer(A))return A.length;if(ArrayBuffer.isView(A)||N(A,ArrayBuffer))return A.byteLength;if(typeof A!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof A);var j=A.length,K=arguments.length>2&&arguments[2]===!0;if(!K&&j===0)return 0;for(var J=!1;;)switch(C){case"ascii":case"latin1":case"binary":return j;case"utf8":case"utf-8":return Et(A).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*j;case"hex":return j>>>1;case"base64":return Ct(A).length;default:if(J)return K?-1:Et(A).length;C=(""+C).toLowerCase(),J=!0}}function T(A,C,j){var K=A[C];A[C]=A[j],A[j]=K}function U(A,C,j,K,J){if(A.length===0)return-1;if(typeof j=="string"?(K=j,j=0):j>2147483647?j=2147483647:j<-2147483648&&(j=-2147483648),G(j=+j)&&(j=J?0:A.length-1),j<0&&(j=A.length+j),j>=A.length){if(J)return-1;j=A.length-1}else if(j<0){if(!J)return-1;j=0}if(typeof C=="string"&&(C=o.from(C,K)),o.isBuffer(C))return C.length===0?-1:M(A,C,j,K,J);if(typeof C=="number")return C&=255,typeof Uint8Array.prototype.indexOf=="function"?J?Uint8Array.prototype.indexOf.call(A,C,j):Uint8Array.prototype.lastIndexOf.call(A,C,j):M(A,[C],j,K,J);throw new TypeError("val must be string, number or Buffer")}function M(A,C,j,K,J){var yt,Dt=1,Xt=A.length,_e=C.length;if(K!==void 0&&((K=String(K).toLowerCase())==="ucs2"||K==="ucs-2"||K==="utf16le"||K==="utf-16le")){if(A.length<2||C.length<2)return-1;Dt=2,Xt/=2,_e/=2,j/=2}function me(pe,ge){return Dt===1?pe[ge]:pe.readUInt16BE(ge*Dt)}if(J){var de=-1;for(yt=j;yt<Xt;yt++)if(me(A,yt)===me(C,de===-1?0:yt-de)){if(de===-1&&(de=yt),yt-de+1===_e)return de*Dt}else de!==-1&&(yt-=yt-de),de=-1}else for(j+_e>Xt&&(j=Xt-_e),yt=j;yt>=0;yt--){for(var Zt=!0,Vt=0;Vt<_e;Vt++)if(me(A,yt+Vt)!==me(C,Vt)){Zt=!1;break}if(Zt)return yt}return-1}function Y(A,C,j,K){j=Number(j)||0;var J=A.length-j;K?(K=Number(K))>J&&(K=J):K=J;var yt=C.length;K>yt/2&&(K=yt/2);for(var Dt=0;Dt<K;++Dt){var Xt=parseInt(C.substr(2*Dt,2),16);if(G(Xt))return Dt;A[j+Dt]=Xt}return Dt}function Z(A,C,j,K){return x(Et(C,A.length-j),A,j,K)}function D(A,C,j,K){return x(function(J){for(var yt=[],Dt=0;Dt<J.length;++Dt)yt.push(255&J.charCodeAt(Dt));return yt}(C),A,j,K)}function nt(A,C,j,K){return D(A,C,j,K)}function ct(A,C,j,K){return x(Ct(C),A,j,K)}function at(A,C,j,K){return x(function(J,yt){for(var Dt,Xt,_e,me=[],de=0;de<J.length&&!((yt-=2)<0);++de)Xt=(Dt=J.charCodeAt(de))>>8,_e=Dt%256,me.push(_e),me.push(Xt);return me}(C,A.length-j),A,j,K)}function et(A,C,j){return C===0&&j===A.length?_$base64Js_2.fromByteArray(A):_$base64Js_2.fromByteArray(A.slice(C,j))}function mt(A,C,j){j=Math.min(A.length,j);for(var K=[],J=C;J<j;){var yt,Dt,Xt,_e,me=A[J],de=null,Zt=me>239?4:me>223?3:me>191?2:1;if(J+Zt<=j)switch(Zt){case 1:me<128&&(de=me);break;case 2:(192&(yt=A[J+1]))==128&&(_e=(31&me)<<6|63&yt)>127&&(de=_e);break;case 3:yt=A[J+1],Dt=A[J+2],(192&yt)==128&&(192&Dt)==128&&(_e=(15&me)<<12|(63&yt)<<6|63&Dt)>2047&&(_e<55296||_e>57343)&&(de=_e);break;case 4:yt=A[J+1],Dt=A[J+2],Xt=A[J+3],(192&yt)==128&&(192&Dt)==128&&(192&Xt)==128&&(_e=(15&me)<<18|(63&yt)<<12|(63&Dt)<<6|63&Xt)>65535&&_e<1114112&&(de=_e)}de===null?(de=65533,Zt=1):de>65535&&(de-=65536,K.push(de>>>10&1023|55296),de=56320|1023&de),K.push(de),J+=Zt}return function(Vt){var pe=Vt.length;if(pe<=At)return String.fromCharCode.apply(String,Vt);for(var ge="",jt=0;jt<pe;)ge+=String.fromCharCode.apply(String,Vt.slice(jt,jt+=At));return ge}(K)}e.kMaxLength=2147483647,o.TYPED_ARRAY_SUPPORT=function(){try{var A=new Uint8Array(1);return A.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},A.foo()===42}catch{return!1}}(),o.TYPED_ARRAY_SUPPORT||typeof console>"u",Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),o.poolSize=8192,o.from=function(A,C,j){return f(A,C,j)},o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,o.alloc=function(A,C,j){return function(K,J,yt){return d(K),K<=0?r(K):J!==void 0?typeof yt=="string"?r(K).fill(J,yt):r(K).fill(J):r(K)}(A,C,j)},o.allocUnsafe=function(A){return h(A)},o.allocUnsafeSlow=function(A){return h(A)},o.isBuffer=function(A){return A!=null&&A._isBuffer===!0&&A!==o.prototype},o.compare=function(A,C){if(N(A,Uint8Array)&&(A=o.from(A,A.offset,A.byteLength)),N(C,Uint8Array)&&(C=o.from(C,C.offset,C.byteLength)),!o.isBuffer(A)||!o.isBuffer(C))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(A===C)return 0;for(var j=A.length,K=C.length,J=0,yt=Math.min(j,K);J<yt;++J)if(A[J]!==C[J]){j=A[J],K=C[J];break}return j<K?-1:K<j?1:0},o.isEncoding=function(A){switch(String(A).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(A,C){if(!Array.isArray(A))throw new TypeError('"list" argument must be an Array of Buffers');if(A.length===0)return o.alloc(0);var j;if(C===void 0)for(C=0,j=0;j<A.length;++j)C+=A[j].length;var K=o.allocUnsafe(C),J=0;for(j=0;j<A.length;++j){var yt=A[j];if(N(yt,Uint8Array)&&(yt=o.from(yt)),!o.isBuffer(yt))throw new TypeError('"list" argument must be an Array of Buffers');yt.copy(K,J),J+=yt.length}return K},o.byteLength=S,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var A=this.length;if(A%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var C=0;C<A;C+=2)T(this,C,C+1);return this},o.prototype.swap32=function(){var A=this.length;if(A%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var C=0;C<A;C+=4)T(this,C,C+3),T(this,C+1,C+2);return this},o.prototype.swap64=function(){var A=this.length;if(A%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var C=0;C<A;C+=8)T(this,C,C+7),T(this,C+1,C+6),T(this,C+2,C+5),T(this,C+3,C+4);return this},o.prototype.toString=function(){var A=this.length;return A===0?"":arguments.length===0?mt(this,0,A):function(C,j,K){var J=!1;if((j===void 0||j<0)&&(j=0),j>this.length||((K===void 0||K>this.length)&&(K=this.length),K<=0)||(K>>>=0)<=(j>>>=0))return"";for(C||(C="utf8");;)switch(C){case"hex":return xt(this,j,K);case"utf8":case"utf-8":return mt(this,j,K);case"ascii":return dt(this,j,K);case"latin1":case"binary":return ht(this,j,K);case"base64":return et(this,j,K);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return l(this,j,K);default:if(J)throw new TypeError("Unknown encoding: "+C);C=(C+"").toLowerCase(),J=!0}}.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(A){if(!o.isBuffer(A))throw new TypeError("Argument must be a Buffer");return this===A||o.compare(this,A)===0},o.prototype.inspect=function(){var A="",C=e.INSPECT_MAX_BYTES;return A=this.toString("hex",0,C).replace(/(.{2})/g,"$1 ").trim(),this.length>C&&(A+=" ... "),"<Buffer "+A+">"},o.prototype.compare=function(A,C,j,K,J){if(N(A,Uint8Array)&&(A=o.from(A,A.offset,A.byteLength)),!o.isBuffer(A))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof A);if(C===void 0&&(C=0),j===void 0&&(j=A?A.length:0),K===void 0&&(K=0),J===void 0&&(J=this.length),C<0||j>A.length||K<0||J>this.length)throw new RangeError("out of range index");if(K>=J&&C>=j)return 0;if(K>=J)return-1;if(C>=j)return 1;if(this===A)return 0;for(var yt=(J>>>=0)-(K>>>=0),Dt=(j>>>=0)-(C>>>=0),Xt=Math.min(yt,Dt),_e=this.slice(K,J),me=A.slice(C,j),de=0;de<Xt;++de)if(_e[de]!==me[de]){yt=_e[de],Dt=me[de];break}return yt<Dt?-1:Dt<yt?1:0},o.prototype.includes=function(A,C,j){return this.indexOf(A,C,j)!==-1},o.prototype.indexOf=function(A,C,j){return U(this,A,C,j,!0)},o.prototype.lastIndexOf=function(A,C,j){return U(this,A,C,j,!1)},o.prototype.write=function(A,C,j,K){if(C===void 0)K="utf8",j=this.length,C=0;else if(j===void 0&&typeof C=="string")K=C,j=this.length,C=0;else{if(!isFinite(C))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");C>>>=0,isFinite(j)?(j>>>=0,K===void 0&&(K="utf8")):(K=j,j=void 0)}var J=this.length-C;if((j===void 0||j>J)&&(j=J),A.length>0&&(j<0||C<0)||C>this.length)throw new RangeError("Attempt to write outside buffer bounds");K||(K="utf8");for(var yt=!1;;)switch(K){case"hex":return Y(this,A,C,j);case"utf8":case"utf-8":return Z(this,A,C,j);case"ascii":return D(this,A,C,j);case"latin1":case"binary":return nt(this,A,C,j);case"base64":return ct(this,A,C,j);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return at(this,A,C,j);default:if(yt)throw new TypeError("Unknown encoding: "+K);K=(""+K).toLowerCase(),yt=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var At=4096;function dt(A,C,j){var K="";j=Math.min(A.length,j);for(var J=C;J<j;++J)K+=String.fromCharCode(127&A[J]);return K}function ht(A,C,j){var K="";j=Math.min(A.length,j);for(var J=C;J<j;++J)K+=String.fromCharCode(A[J]);return K}function xt(A,C,j){var K,J=A.length;(!C||C<0)&&(C=0),(!j||j<0||j>J)&&(j=J);for(var yt="",Dt=C;Dt<j;++Dt)yt+=(K=A[Dt])<16?"0"+K.toString(16):K.toString(16);return yt}function l(A,C,j){for(var K=A.slice(C,j),J="",yt=0;yt<K.length;yt+=2)J+=String.fromCharCode(K[yt]+256*K[yt+1]);return J}function s(A,C,j){if(A%1!=0||A<0)throw new RangeError("offset is not uint");if(A+C>j)throw new RangeError("Trying to access beyond buffer length")}function v(A,C,j,K,J,yt){if(!o.isBuffer(A))throw new TypeError('"buffer" argument must be a Buffer instance');if(C>J||C<yt)throw new RangeError('"value" argument is out of bounds');if(j+K>A.length)throw new RangeError("Index out of range")}function $(A,C,j,K,J,yt){if(j+K>A.length)throw new RangeError("Index out of range");if(j<0)throw new RangeError("Index out of range")}function E(A,C,j,K,J){return C=+C,j>>>=0,J||$(A,0,j,4),_$ieee754_10.write(A,C,j,K,23,4),j+4}function rt(A,C,j,K,J){return C=+C,j>>>=0,J||$(A,0,j,8),_$ieee754_10.write(A,C,j,K,52,8),j+8}o.prototype.slice=function(A,C){var j=this.length;(A=~~A)<0?(A+=j)<0&&(A=0):A>j&&(A=j),(C=C===void 0?j:~~C)<0?(C+=j)<0&&(C=0):C>j&&(C=j),C<A&&(C=A);var K=this.subarray(A,C);return K.__proto__=o.prototype,K},o.prototype.readUIntLE=function(A,C,j){A>>>=0,C>>>=0,j||s(A,C,this.length);for(var K=this[A],J=1,yt=0;++yt<C&&(J*=256);)K+=this[A+yt]*J;return K},o.prototype.readUIntBE=function(A,C,j){A>>>=0,C>>>=0,j||s(A,C,this.length);for(var K=this[A+--C],J=1;C>0&&(J*=256);)K+=this[A+--C]*J;return K},o.prototype.readUInt8=function(A,C){return A>>>=0,C||s(A,1,this.length),this[A]},o.prototype.readUInt16LE=function(A,C){return A>>>=0,C||s(A,2,this.length),this[A]|this[A+1]<<8},o.prototype.readUInt16BE=function(A,C){return A>>>=0,C||s(A,2,this.length),this[A]<<8|this[A+1]},o.prototype.readUInt32LE=function(A,C){return A>>>=0,C||s(A,4,this.length),(this[A]|this[A+1]<<8|this[A+2]<<16)+16777216*this[A+3]},o.prototype.readUInt32BE=function(A,C){return A>>>=0,C||s(A,4,this.length),16777216*this[A]+(this[A+1]<<16|this[A+2]<<8|this[A+3])},o.prototype.readIntLE=function(A,C,j){A>>>=0,C>>>=0,j||s(A,C,this.length);for(var K=this[A],J=1,yt=0;++yt<C&&(J*=256);)K+=this[A+yt]*J;return K>=(J*=128)&&(K-=Math.pow(2,8*C)),K},o.prototype.readIntBE=function(A,C,j){A>>>=0,C>>>=0,j||s(A,C,this.length);for(var K=C,J=1,yt=this[A+--K];K>0&&(J*=256);)yt+=this[A+--K]*J;return yt>=(J*=128)&&(yt-=Math.pow(2,8*C)),yt},o.prototype.readInt8=function(A,C){return A>>>=0,C||s(A,1,this.length),128&this[A]?-1*(255-this[A]+1):this[A]},o.prototype.readInt16LE=function(A,C){A>>>=0,C||s(A,2,this.length);var j=this[A]|this[A+1]<<8;return 32768&j?4294901760|j:j},o.prototype.readInt16BE=function(A,C){A>>>=0,C||s(A,2,this.length);var j=this[A+1]|this[A]<<8;return 32768&j?4294901760|j:j},o.prototype.readInt32LE=function(A,C){return A>>>=0,C||s(A,4,this.length),this[A]|this[A+1]<<8|this[A+2]<<16|this[A+3]<<24},o.prototype.readInt32BE=function(A,C){return A>>>=0,C||s(A,4,this.length),this[A]<<24|this[A+1]<<16|this[A+2]<<8|this[A+3]},o.prototype.readFloatLE=function(A,C){return A>>>=0,C||s(A,4,this.length),_$ieee754_10.read(this,A,!0,23,4)},o.prototype.readFloatBE=function(A,C){return A>>>=0,C||s(A,4,this.length),_$ieee754_10.read(this,A,!1,23,4)},o.prototype.readDoubleLE=function(A,C){return A>>>=0,C||s(A,8,this.length),_$ieee754_10.read(this,A,!0,52,8)},o.prototype.readDoubleBE=function(A,C){return A>>>=0,C||s(A,8,this.length),_$ieee754_10.read(this,A,!1,52,8)},o.prototype.writeUIntLE=function(A,C,j,K){A=+A,C>>>=0,j>>>=0,K||v(this,A,C,j,Math.pow(2,8*j)-1,0);var J=1,yt=0;for(this[C]=255&A;++yt<j&&(J*=256);)this[C+yt]=A/J&255;return C+j},o.prototype.writeUIntBE=function(A,C,j,K){A=+A,C>>>=0,j>>>=0,K||v(this,A,C,j,Math.pow(2,8*j)-1,0);var J=j-1,yt=1;for(this[C+J]=255&A;--J>=0&&(yt*=256);)this[C+J]=A/yt&255;return C+j},o.prototype.writeUInt8=function(A,C,j){return A=+A,C>>>=0,j||v(this,A,C,1,255,0),this[C]=255&A,C+1},o.prototype.writeUInt16LE=function(A,C,j){return A=+A,C>>>=0,j||v(this,A,C,2,65535,0),this[C]=255&A,this[C+1]=A>>>8,C+2},o.prototype.writeUInt16BE=function(A,C,j){return A=+A,C>>>=0,j||v(this,A,C,2,65535,0),this[C]=A>>>8,this[C+1]=255&A,C+2},o.prototype.writeUInt32LE=function(A,C,j){return A=+A,C>>>=0,j||v(this,A,C,4,4294967295,0),this[C+3]=A>>>24,this[C+2]=A>>>16,this[C+1]=A>>>8,this[C]=255&A,C+4},o.prototype.writeUInt32BE=function(A,C,j){return A=+A,C>>>=0,j||v(this,A,C,4,4294967295,0),this[C]=A>>>24,this[C+1]=A>>>16,this[C+2]=A>>>8,this[C+3]=255&A,C+4},o.prototype.writeIntLE=function(A,C,j,K){if(A=+A,C>>>=0,!K){var J=Math.pow(2,8*j-1);v(this,A,C,j,J-1,-J)}var yt=0,Dt=1,Xt=0;for(this[C]=255&A;++yt<j&&(Dt*=256);)A<0&&Xt===0&&this[C+yt-1]!==0&&(Xt=1),this[C+yt]=(A/Dt>>0)-Xt&255;return C+j},o.prototype.writeIntBE=function(A,C,j,K){if(A=+A,C>>>=0,!K){var J=Math.pow(2,8*j-1);v(this,A,C,j,J-1,-J)}var yt=j-1,Dt=1,Xt=0;for(this[C+yt]=255&A;--yt>=0&&(Dt*=256);)A<0&&Xt===0&&this[C+yt+1]!==0&&(Xt=1),this[C+yt]=(A/Dt>>0)-Xt&255;return C+j},o.prototype.writeInt8=function(A,C,j){return A=+A,C>>>=0,j||v(this,A,C,1,127,-128),A<0&&(A=255+A+1),this[C]=255&A,C+1},o.prototype.writeInt16LE=function(A,C,j){return A=+A,C>>>=0,j||v(this,A,C,2,32767,-32768),this[C]=255&A,this[C+1]=A>>>8,C+2},o.prototype.writeInt16BE=function(A,C,j){return A=+A,C>>>=0,j||v(this,A,C,2,32767,-32768),this[C]=A>>>8,this[C+1]=255&A,C+2},o.prototype.writeInt32LE=function(A,C,j){return A=+A,C>>>=0,j||v(this,A,C,4,2147483647,-2147483648),this[C]=255&A,this[C+1]=A>>>8,this[C+2]=A>>>16,this[C+3]=A>>>24,C+4},o.prototype.writeInt32BE=function(A,C,j){return A=+A,C>>>=0,j||v(this,A,C,4,2147483647,-2147483648),A<0&&(A=4294967295+A+1),this[C]=A>>>24,this[C+1]=A>>>16,this[C+2]=A>>>8,this[C+3]=255&A,C+4},o.prototype.writeFloatLE=function(A,C,j){return E(this,A,C,!0,j)},o.prototype.writeFloatBE=function(A,C,j){return E(this,A,C,!1,j)},o.prototype.writeDoubleLE=function(A,C,j){return rt(this,A,C,!0,j)},o.prototype.writeDoubleBE=function(A,C,j){return rt(this,A,C,!1,j)},o.prototype.copy=function(A,C,j,K){if(!o.isBuffer(A))throw new TypeError("argument should be a Buffer");if(j||(j=0),K||K===0||(K=this.length),C>=A.length&&(C=A.length),C||(C=0),K>0&&K<j&&(K=j),K===j||A.length===0||this.length===0)return 0;if(C<0)throw new RangeError("targetStart out of bounds");if(j<0||j>=this.length)throw new RangeError("Index out of range");if(K<0)throw new RangeError("sourceEnd out of bounds");K>this.length&&(K=this.length),A.length-C<K-j&&(K=A.length-C+j);var J=K-j;if(this===A&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(C,j,K);else if(this===A&&j<C&&C<K)for(var yt=J-1;yt>=0;--yt)A[yt+C]=this[yt+j];else Uint8Array.prototype.set.call(A,this.subarray(j,K),C);return J},o.prototype.fill=function(A,C,j,K){if(typeof A=="string"){if(typeof C=="string"?(K=C,C=0,j=this.length):typeof j=="string"&&(K=j,j=this.length),K!==void 0&&typeof K!="string")throw new TypeError("encoding must be a string");if(typeof K=="string"&&!o.isEncoding(K))throw new TypeError("Unknown encoding: "+K);if(A.length===1){var J=A.charCodeAt(0);(K==="utf8"&&J<128||K==="latin1")&&(A=J)}}else typeof A=="number"&&(A&=255);if(C<0||this.length<C||this.length<j)throw new RangeError("Out of range index");if(j<=C)return this;var yt;if(C>>>=0,j=j===void 0?this.length:j>>>0,A||(A=0),typeof A=="number")for(yt=C;yt<j;++yt)this[yt]=A;else{var Dt=o.isBuffer(A)?A:o.from(A,K),Xt=Dt.length;if(Xt===0)throw new TypeError('The value "'+A+'" is invalid for argument "value"');for(yt=0;yt<j-C;++yt)this[yt+C]=Dt[yt%Xt]}return this};var gt=/[^+/0-9A-Za-z-_]/g;function Et(A,C){var j;C=C||1/0;for(var K=A.length,J=null,yt=[],Dt=0;Dt<K;++Dt){if((j=A.charCodeAt(Dt))>55295&&j<57344){if(!J){if(j>56319){(C-=3)>-1&&yt.push(239,191,189);continue}if(Dt+1===K){(C-=3)>-1&&yt.push(239,191,189);continue}J=j;continue}if(j<56320){(C-=3)>-1&&yt.push(239,191,189),J=j;continue}j=65536+(J-55296<<10|j-56320)}else J&&(C-=3)>-1&&yt.push(239,191,189);if(J=null,j<128){if((C-=1)<0)break;yt.push(j)}else if(j<2048){if((C-=2)<0)break;yt.push(j>>6|192,63&j|128)}else if(j<65536){if((C-=3)<0)break;yt.push(j>>12|224,j>>6&63|128,63&j|128)}else{if(!(j<1114112))throw new Error("Invalid code point");if((C-=4)<0)break;yt.push(j>>18|240,j>>12&63|128,j>>6&63|128,63&j|128)}}return yt}function Ct(A){return _$base64Js_2.toByteArray(function(C){if((C=(C=C.split("=")[0]).trim().replace(gt,"")).length<2)return"";for(;C.length%4!=0;)C+="=";return C}(A))}function x(A,C,j,K){for(var J=0;J<K&&!(J+j>=C.length||J>=A.length);++J)C[J+j]=A[J];return J}function N(A,C){return A instanceof C||A!=null&&A.constructor!=null&&A.constructor.name!=null&&A.constructor.name===C.name}function G(A){return A!=A}}).call(this)}).call(this,_$buffer_3({}).Buffer)}),_$package_85={name:"sub-store",version:"2.16.10",description:"Advanced Subscription Manager for QX, Loon, Surge, Stash and ShadowRocket.",main:"src/main.js",scripts:{preinstall:"npx only-allow pnpm",test:"gulp peggy && npx cross-env BABEL_ENV=test mocha src/test/**/*.spec.js --require @babel/register --recursive",serve:"node sub-store.min.js",start:"nodemon -w src -w package.json --exec babel-node src/main.js","dev:esbuild":"nodemon -w src -w package.json dev-esbuild.js","dev:run":"nodemon -w sub-store.min.js sub-store.min.js",build:"gulp",bundle:"node bundle.js",changelog:"conventional-changelog -p cli -i CHANGELOG.md -s"},author:"Peng-YM",license:"GPL-3.0",dependencies:{"@maxmind/geoip2-node":"^5.0.0",automerge:"1.0.1-preview.7","body-parser":"^1.19.0",buffer:"^6.0.3","connect-history-api-fallback":"^2.0.0",cron:"^3.1.6","dns-packet":"^5.6.1",express:"^4.17.1","http-proxy-middleware":"^2.0.6","ip-address":"^9.0.5","js-base64":"^3.7.2",jsrsasign:"^11.1.0",lodash:"^4.17.21",ms:"^2.1.3",nanoid:"^3.3.3",request:"^2.88.2","static-js-yaml":"^1.0.0"},devDependencies:{"@babel/core":"^7.18.0","@babel/node":"^7.17.10","@babel/preset-env":"^7.18.0","@babel/register":"^7.17.7","@types/gulp":"^4.0.9",axios:"^0.21.2","babel-plugin-relative-path-import":"^2.0.1",babelify:"^10.0.0","browser-pack-flat":"^3.4.2",browserify:"^17.0.0",chai:"^4.3.6",esbuild:"^0.19.8",eslint:"^8.16.0",gulp:"^4.0.2","gulp-babel":"^8.0.0","gulp-eslint-new":"^1.4.4","gulp-file":"^0.4.0","gulp-header":"^2.0.9","gulp-prettier":"^4.0.0","gulp-tap":"^2.0.0",mocha:"^10.0.0",nodemon:"^2.0.16",peggy:"^2.0.1",prettier:"2.6.2","prettier-plugin-sort-imports":"^1.6.1",tinyify:"^3.0.0"}},_$constants_86={};Object.defineProperty(_$constants_86,"__esModule",{value:!0}),_$constants_86.TOKENS_KEY=_$constants_86.SUBS_KEY=_$constants_86.SETTINGS_KEY=_$constants_86.SCRIPT_RESOURCE_CACHE_KEY=_$constants_86.SCHEMA_VERSION_KEY=_$constants_86.RULES_KEY=_$constants_86.RESOURCE_CACHE_KEY=_$constants_86.MODULES_KEY=_$constants_86.HEADERS_RESOURCE_CACHE_KEY=_$constants_86.GIST_BACKUP_KEY=_$constants_86.GIST_BACKUP_FILE_NAME=_$constants_86.FILES_KEY=_$constants_86.CSR_EXPIRATION_TIME_KEY=_$constants_86.COLLECTIONS_KEY=_$constants_86.CHR_EXPIRATION_TIME_KEY=_$constants_86.CACHE_EXPIRATION_TIME_MS=_$constants_86.ARTIFACT_REPOSITORY_KEY=_$constants_86.ARTIFACTS_KEY=void 0,_$constants_86.SCHEMA_VERSION_KEY="schemaVersion",_$constants_86.SETTINGS_KEY="settings",_$constants_86.SUBS_KEY="subs",_$constants_86.COLLECTIONS_KEY="collections",_$constants_86.FILES_KEY="files",_$constants_86.MODULES_KEY="modules",_$constants_86.ARTIFACTS_KEY="artifacts",_$constants_86.RULES_KEY="rules",_$constants_86.TOKENS_KEY="tokens",_$constants_86.GIST_BACKUP_KEY="Auto Generated Sub-Store Backup",_$constants_86.GIST_BACKUP_FILE_NAME="Sub-Store",_$constants_86.ARTIFACT_REPOSITORY_KEY="Sub-Store Artifacts Repository",_$constants_86.RESOURCE_CACHE_KEY="#sub-store-cached-resource",_$constants_86.HEADERS_RESOURCE_CACHE_KEY="#sub-store-cached-headers-resource",_$constants_86.CHR_EXPIRATION_TIME_KEY="#sub-store-chr-expiration-time",_$constants_86.CACHE_EXPIRATION_TIME_MS=36e5,_$constants_86.SCRIPT_RESOURCE_CACHE_KEY="#sub-store-cached-script-resource",_$constants_86.CSR_EXPIRATION_TIME_KEY="#sub-store-csr-expiration-time";var _$openApi_151={};function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(r){_defineProperty(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=typeof Symbol=="function"?Symbol:{},o=r.iterator||"@@iterator",f=r.asyncIterator||"@@asyncIterator",d=r.toStringTag||"@@toStringTag";function h(l,s,v){return Object.defineProperty(l,s,{value:v,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,v,$){return s[v]=$}}function y(l,s,v,$){var E=s&&s.prototype instanceof T?s:T,rt=Object.create(E.prototype),gt=new dt($||[]);return rt._invoke=function(Et,Ct,x){var N="suspendedStart";return function(G,A){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(G==="throw")throw A;return{value:void 0,done:!0}}for(x.method=G,x.arg=A;;){var C=x.delegate;if(C){var j=et(C,x);if(j){if(j===S)continue;return j}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var K=F(Et,Ct,x);if(K.type==="normal"){if(N=x.done?"completed":"suspendedYield",K.arg===S)continue;return{value:K.arg,done:x.done}}K.type==="throw"&&(N="completed",x.method="throw",x.arg=K.arg)}}}(l,v,gt),rt}function F(l,s,v){try{return{type:"normal",arg:l.call(s,v)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var S={};function T(){}function U(){}function M(){}var Y={};h(Y,o,function(){return this});var Z=Object.getPrototypeOf,D=Z&&Z(Z(ht([])));D&&D!==e&&n.call(D,o)&&(Y=D);var nt=M.prototype=T.prototype=Object.create(Y);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(v){return this._invoke(s,v)})})}function at(l,s){var v;this._invoke=function($,E){function rt(){return new s(function(gt,Et){(function Ct(x,N,G,A){var C=F(l[x],l,N);if(C.type!=="throw"){var j=C.arg,K=j.value;return K&&_typeof(K)=="object"&&n.call(K,"__await")?s.resolve(K.__await).then(function(J){Ct("next",J,G,A)},function(J){Ct("throw",J,G,A)}):s.resolve(K).then(function(J){j.value=J,G(j)},function(J){return Ct("throw",J,G,A)})}A(C.arg)})($,E,gt,Et)})}return v=v?v.then(rt,rt):rt()}}function et(l,s){var v=l.iterator[s.method];if(v===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,et(l,s),s.method==="throw"))return S;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var $=F(v,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,S;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,S):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,S)}function mt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function At(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function dt(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(mt,this),this.reset(!0)}function ht(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var v=-1,$=function E(){for(;++v<l.length;)if(n.call(l,v))return E.value=l[v],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:xt}}function xt(){return{value:void 0,done:!0}}return U.prototype=M,h(nt,"constructor",M),h(M,"constructor",U),U.displayName=h(M,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===U||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,M):(l.__proto__=M,h(l,d,"GeneratorFunction")),l.prototype=Object.create(nt),l},t.awrap=function(l){return{__await:l}},ct(at.prototype),h(at.prototype,f,function(){return this}),t.AsyncIterator=at,t.async=function(l,s,v,$,E){E===void 0&&(E=Promise);var rt=new at(y(l,s,v,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(gt){return gt.done?gt.value:rt.next()})},ct(nt),h(nt,d,"Generator"),h(nt,o,function(){return this}),h(nt,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var v in l)s.push(v);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=ht,dt.prototype={constructor:dt,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(At),!l)for(var s in this)s.charAt(0)==="t"&&n.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function v(Ct,x){return rt.type="throw",rt.arg=l,s.next=Ct,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return v("end");if(E.tryLoc<=this.prev){var gt=n.call(E,"catchLoc"),Et=n.call(E,"finallyLoc");if(gt&&Et){if(this.prev<E.catchLoc)return v(E.catchLoc,!0);if(this.prev<E.finallyLoc)return v(E.finallyLoc)}else if(gt){if(this.prev<E.catchLoc)return v(E.catchLoc,!0)}else{if(!Et)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return v(E.finallyLoc)}}}},abrupt:function(l,s){for(var v=this.tryEntries.length-1;v>=0;--v){var $=this.tryEntries[v];if($.tryLoc<=this.prev&&n.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,S):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),S},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.finallyLoc===l)return this.complete(v.completion,v.afterLoc),At(v),S}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.tryLoc===l){var $=v.completion;if($.type==="throw"){var E=$.arg;At(v)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,v){return this.delegate={iterator:ht(l),resultName:s,nextLoc:v},this.method==="next"&&(this.arg=void 0),S}},t}function asyncGeneratorStep(t,e,n,r,o,f,d){try{var h=t[f](d),y=h.value}catch(F){return void n(F)}h.done?e(y):Promise.resolve(y).then(r,o)}function _asyncToGenerator(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var f=t.apply(e,n);function d(y){asyncGeneratorStep(f,r,o,d,h,"next",y)}function h(y){asyncGeneratorStep(f,r,o,d,h,"throw",y)}d(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _typeof(t){return(_typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$openApi_151,"__esModule",{value:!0}),_$openApi_151.ENV=ENV,_$openApi_151.HTTP=HTTP,_$openApi_151.OpenAPI=void 0;var isQX=typeof $task<"u",isLoon=typeof $loon<"u",isSurge=typeof $httpClient<"u"&&!isLoon,isNode=eval('typeof process !== "undefined"'),isStash=typeof $environment<"u"&&$environment["stash-version"],isShadowRocket=typeof $rocket<"u",isEgern=(typeof egern>"u"?"undefined":_typeof(egern))=="object",isLanceX=typeof $native<"u",isGUIforCores=typeof $Plugins<"u",OpenAPI=function(){function OpenAPI(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"untitled",e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];_classCallCheck(this,OpenAPI),this.name=t,this.debug=e,this.http=HTTP(),this.env=ENV(),this.node=function(){if(isNode){var o=require("fs");return{fs:o}}return null}(),this.initCache();var n=function(o,f){return new Promise(function(d){setTimeout(d.bind(null,f),o)})},r;Promise.prototype.delay=(r=_asyncToGenerator(_regeneratorRuntime().mark(function o(f){var d;return _regeneratorRuntime().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this;case 2:return d=h.sent,h.next=5,n(f,d);case 5:return h.abrupt("return",h.sent);case 6:case"end":return h.stop()}},o,this)})),function(o){return r.apply(this,arguments)})}return _createClass(OpenAPI,[{key:"initCache",value:function initCache(){if(isQX&&(this.cache=JSON.parse($prefs.valueForKey(this.name)||"{}")),(isLoon||isSurge)&&(this.cache=JSON.parse($persistentStore.read(this.name)||"{}")),isGUIforCores&&(this.cache=JSON.parse($Plugins.SubStoreCache.get(this.name)||"{}")),isNode){var basePath=eval("process.env.SUB_STORE_DATA_BASE_PATH")||".",rootPath="".concat(basePath,"/root.json");this.log("Root path: ".concat(rootPath)),this.node.fs.existsSync(rootPath)?this.root=JSON.parse(this.node.fs.readFileSync("".concat(rootPath))):(this.node.fs.writeFileSync(rootPath,JSON.stringify({}),{flag:"wx"}),this.root={});var fpath="".concat(basePath,"/").concat(this.name,".json");this.log("Data path: ".concat(fpath)),this.node.fs.existsSync(fpath)?this.cache=JSON.parse(this.node.fs.readFileSync("".concat(fpath))):(this.node.fs.writeFileSync(fpath,JSON.stringify({}),{flag:"wx"}),this.cache={})}}},{key:"persistCache",value:function persistCache(){var data=JSON.stringify(this.cache,null,2);if(isQX&&$prefs.setValueForKey(data,this.name),(isLoon||isSurge)&&$persistentStore.write(data,this.name),isGUIforCores&&$Plugins.SubStoreCache.set(this.name,data),isNode){var basePath=eval("process.env.SUB_STORE_DATA_BASE_PATH")||".";this.node.fs.writeFileSync("".concat(basePath,"/").concat(this.name,".json"),data,{flag:"w"},function(t){}),this.node.fs.writeFileSync("".concat(basePath,"/root.json"),JSON.stringify(this.root,null,2),{flag:"w"},function(t){})}}},{key:"write",value:function(t,e){if(this.log("SET ".concat(e)),e.indexOf("#")!==-1){if(e=e.substr(1),isSurge||isLoon)return $persistentStore.write(t,e);if(isQX)return $prefs.setValueForKey(t,e);if(isNode&&(this.root[e]=t),isGUIforCores)return $Plugins.SubStoreCache.set(e,t)}else this.cache[e]=t;this.persistCache()}},{key:"read",value:function(t){return this.log("READ ".concat(t)),t.indexOf("#")===-1?this.cache[t]:(t=t.substr(1),isSurge||isLoon?$persistentStore.read(t):isQX?$prefs.valueForKey(t):isNode?this.root[t]:isGUIforCores?$Plugins.SubStoreCache.get(t):void 0)}},{key:"delete",value:function(t){if(this.log("DELETE ".concat(t)),t.indexOf("#")!==-1){if(t=t.substr(1),isSurge||isLoon)return $persistentStore.write(null,t);if(isQX)return $prefs.removeValueForKey(t);if(isNode&&delete this.root[t],isGUIforCores)return $Plugins.SubStoreCache.remove(t)}else delete this.cache[t];this.persistCache()}},{key:"notify",value:function notify(title){var subtitle=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",content=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",options=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},openURL=options["open-url"],mediaURL=options["media-url"];if(isQX&&$notify(title,subtitle,content,options),isSurge&&$notification.post(title,subtitle,content+"".concat(mediaURL?`
\u591A\u5A92\u4F53:`+mediaURL:""),{url:openURL}),isLoon){var opts={};openURL&&(opts.openUrl=openURL),mediaURL&&(opts.mediaUrl=mediaURL),JSON.stringify(opts)==="{}"?$notification.post(title,subtitle,content):$notification.post(title,subtitle,content,opts)}if(isNode){var content_=content+(openURL?`
\u70B9\u51FB\u8DF3\u8F6C: `.concat(openURL):"")+(mediaURL?`
\u591A\u5A92\u4F53: `.concat(mediaURL):""),push=eval("process.env.SUB_STORE_PUSH_SERVICE");if(push){var url=push.replace("[\u63A8\u9001\u6807\u9898]",encodeURIComponent(title||"Sub-Store")).replace("[\u63A8\u9001\u5185\u5BB9]",encodeURIComponent([subtitle,content_].map(function(t){return t}).join(`
`))),$http=HTTP();$http.get({url}).then(function(t){}).catch(function(t){})}}isGUIforCores&&$Plugins.Notify(title,subtitle+`
`+content)}},{key:"log",value:function(t){this.debug}},{key:"info",value:function(t){}},{key:"error",value:function(t){}},{key:"wait",value:function(t){return new Promise(function(e){return setTimeout(e,t)})}},{key:"done",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};isQX||isLoon||isSurge||isGUIforCores?$done(t):isNode&&typeof $context<"u"&&($context.headers=t.headers,$context.statusCode=t.statusCode,$context.body=t.body)}}]),OpenAPI}();function ENV(){return{isQX,isLoon,isSurge,isNode,isStash,isShadowRocket,isEgern,isLanceX,isGUIforCores}}function HTTP(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{baseURL:""},e=ENV(),n=e.isQX,r=e.isLoon,o=e.isSurge,f=e.isNode,d=e.isGUIforCores,h=["GET","POST","PUT","DELETE","HEAD","OPTIONS","PATCH"],y=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/;function F(T,U){U=typeof U=="string"?{url:U}:U;var M=t.baseURL;M&&!y.test(U.url||"")&&(U.url=M?M+U.url:U.url),U=_objectSpread(_objectSpread({},t),U);var Y=U.timeout,Z=_objectSpread(_objectSpread({},{onRequest:function(){},onResponse:function(mt){return mt},onTimeout:function(){}}),U.events),D,nt,ct;if(Z.onRequest(T,U),U.node&&o){var at=$environment["surge-build"];at&&parseInt(at)>=2407&&(U["policy-descriptor"]=U.node,delete U.node)}n?D=$task.fetch({method:T,url:U.url,headers:U.headers,body:U.body,opts:U.opts}):r||o||f?D=new Promise(function(mt,At){var dt=f?require("request"):$httpClient,ht=U.body,xt=JSON.parse(JSON.stringify(U));if(xt.body=ht,!f&&xt.timeout){xt.timeout++;var l="ms";(o||isStash||isShadowRocket)&&(xt.timeout=Math.ceil(xt.timeout/1e3),l="s")}dt[T.toLowerCase()](xt,function(s,v,$){s?At(s):mt({statusCode:v.status||v.statusCode,headers:v.headers,body:$})})}):d&&(D=new Promise((ct=_asyncToGenerator(_regeneratorRuntime().mark(function mt(At,dt){var ht;return _regeneratorRuntime().wrap(function(xt){for(;;)switch(xt.prev=xt.next){case 0:return xt.prev=0,xt.next=3,$Plugins.Requests({method:T,url:U.url,headers:U.headers,body:U.body,options:{Proxy:U.proxy,Timeout:U.timeout?U.timeout/1e3:15}});case 3:ht=xt.sent,At({statusCode:ht.status,headers:ht.headers,body:ht.body}),xt.next=10;break;case 7:xt.prev=7,xt.t0=xt.catch(0),dt(xt.t0);case 10:case"end":return xt.stop()}},mt,null,[[0,7]])})),function(mt,At){return ct.apply(this,arguments)})));var et=Y?new Promise(function(mt,At){nt=setTimeout(function(){return Z.onTimeout(),At("".concat(T," URL: ").concat(U.url," exceeds the timeout ").concat(Y," ms"))},Y)}):null;return(et?Promise.race([et,D]).then(function(mt){return typeof clearTimeout<"u"&&clearTimeout(nt),mt}):D).then(function(mt){return Z.onResponse(mt)})}var S={};return h.forEach(function(T){return S[T.toLowerCase()]=function(U){return F(T,U)}}),S}_$openApi_151.OpenAPI=OpenAPI;var _$app_87={};Object.defineProperty(_$app_87,"__esModule",{value:!0}),_$app_87.default=void 0;var _default=new _$openApi_151.OpenAPI("sub-store");_$app_87.default=_default;var _$migration_143={};Object.defineProperty(_$migration_143,"__esModule",{value:!0}),_$migration_143.default=function(){var t;(t=_app.default.read(_$constants_86.SCHEMA_VERSION_KEY))||function(){_app.default.info("Start migrating...");var e=_app.default.read(_$constants_86.SUBS_KEY)||{},n=Object.values(e).map(function(T){return T.source=T.source||"remote",F(T),S(T),T});_app.default.write(n,_$constants_86.SUBS_KEY);var r=_app.default.read(_$constants_86.COLLECTIONS_KEY)||{},o=Object.values(r).map(function(T){return delete T.ua,F(T),S(T),T});_app.default.write(o,_$constants_86.COLLECTIONS_KEY);var f=_app.default.read(_$constants_86.ARTIFACTS_KEY)||{},d=Object.values(f);_app.default.write(d,_$constants_86.ARTIFACTS_KEY);var h=_app.default.read(_$constants_86.RULES_KEY)||{},y=Object.values(h);function F(T){var U=T["display-name"];U&&(T.displayName=U,delete T["display-name"])}function S(T){var U=T.process;if(U&&U.length!==0){var M,Y=[],Z={type:"Quick Setting Operator",args:{udp:"DEFAULT",tfo:"DEFAULT",scert:"DEFAULT","vmess aead":"DEFAULT",useless:"DEFAULT"}},D=function(At,dt){var ht=typeof Symbol<"u"&&At[Symbol.iterator]||At["@@iterator"];if(!ht){if(Array.isArray(At)||(ht=function(E,rt){if(E){if(typeof E=="string")return _arrayLikeToArray(E,void 0);var gt=Object.prototype.toString.call(E).slice(8,-1);return gt==="Object"&&E.constructor&&(gt=E.constructor.name),gt==="Map"||gt==="Set"?Array.from(E):gt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(gt)?_arrayLikeToArray(E,void 0):void 0}}(At))){ht&&(At=ht);var xt=0,l=function(){};return{s:l,n:function(){return xt>=At.length?{done:!0}:{done:!1,value:At[xt++]}},e:function(E){throw E},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,v=!0,$=!1;return{s:function(){ht=ht.call(At)},n:function(){var E=ht.next();return v=E.done,E},e:function(E){$=!0,s=E},f:function(){try{v||ht.return==null||ht.return()}finally{if($)throw s}}}}(U);try{for(D.s();!(M=D.n()).done;){var nt=M.value;if(nt.type){if(nt.type==="Useless Filter")Z.args.useless="ENABLED";else if(nt.type==="Set Property Operator"){var ct=nt.args,at=ct.key,et=ct.value;switch(at){case"udp":Z.args.udp=et?"ENABLED":"DISABLED";break;case"tfo":Z.args.tfo=et?"ENABLED":"DISABLED";break;case"skip-cert-verify":Z.args.scert=et?"ENABLED":"DISABLED";break;case"aead":Z.args["vmess aead"]=et?"ENABLED":"DISABLED"}}else if(nt.type.indexOf("Keyword")===-1)if(nt.type==="Flag Operator"){var mt=nt.args===void 0||nt.args;nt.args={mode:mt?"add":"remove"},Y.push(nt)}else Y.push(nt)}}}catch(At){D.e(At)}finally{D.f()}Y.unshift(Z),T.process=Y}}_app.default.write(y,_$constants_86.RULES_KEY),delete _app.default.cache.builtin,_app.default.info("Migration complete!")}(),t!=="2.0"&&_app.default.write("2.0",_$constants_86.SCHEMA_VERSION_KEY)};var obj,_app=(obj=_$app_87)&&obj.__esModule?obj:{default:obj};function _arrayLikeToArray(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var _$express_149={};function ___classCallCheck_149(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ___defineProperties_149(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ___createClass_149(t,e,n){return e&&___defineProperties_149(t.prototype,e),n&&___defineProperties_149(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function express(t){var e=t.substore,n=t.port,r=t.host,o=(0,_$openApi_151.ENV)(),f=o.isNode,d={"Content-Type":"text/plain;charset=UTF-8","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST,GET,OPTIONS,PATCH,PUT,DELETE","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept","X-Powered-By":"Sub-Store"};if(f){var h=require("express"),y=require("body-parser"),F=h();return F.use(y.json({verify:Y,limit:"1mb"})),F.use(y.urlencoded({verify:Y,extended:!0})),F.use(y.raw({verify:Y,type:"*/*"})),F.use(function(D,nt,ct){nt.set(d),ct()}),F.start=function(){var D=F.listen(n,r,function(){var nt=D.address(),ct=nt.address,at=nt.port;e.info("[BACKEND] ".concat(ct,":").concat(at))})},F}var S=[],T=["GET","POST","PUT","DELETE","PATCH","OPTIONS","HEAD'","ALL"],U=function D(nt){var ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,at=nt.method,et=nt.url,mt=nt.headers,At=nt.body;mt=formatHeaders(mt),/json/i.test(mt["content-type"])&&(At=JSON.parse(At)),at=at.toUpperCase();var dt,ht=extractURL(et),xt=ht.path,l=ht.query,s=null,v=0;for(dt=ct;dt<S.length;dt++)if(S[dt].method==="ALL"||at===S[dt].method){var $=S[dt].pattern;patternMatched($,xt)&&$.split("/").length>v&&(s=S[dt],v=$.split("/").length)}if(s){var E=function(){D(at,et,dt)},rt={method:at,url:et,path:xt,query:l,params:extractPathParams(s.pattern,xt),headers:mt,body:At},gt=Z(),Et=s.callback,Ct=function(x){gt.status(500).json({status:"failed",message:"Internal Server Error: ".concat(x)})};if(Et.constructor.name==="AsyncFunction")Et(rt,gt,E).catch(Ct);else try{Et(rt,gt,E)}catch(x){Ct(x)}}else Z().status(404).json({status:"failed",message:"ERROR: 404 not found"})},M={};return T.forEach(function(D){M[D.toLowerCase()]=function(nt,ct){S.push({method:D,pattern:nt,callback:ct})}}),M.route=function(D){var nt={};return T.forEach(function(ct){nt[ct.toLowerCase()]=function(at){return S.push({method:ct,pattern:D,callback:at}),nt}}),nt},M.start=function(){U($request)},M;function Y(D,nt,ct,at){ct&&ct.length&&(D.rawBody=ct.toString(at||"utf8"))}function Z(){var D=200,nt=(0,_$openApi_151.ENV)(),ct=nt.isQX,at=nt.isLoon,et=nt.isSurge,mt=nt.isGUIforCores,At=d,dt={200:"HTTP/1.1 200 OK",201:"HTTP/1.1 201 Created",302:"HTTP/1.1 302 Found",307:"HTTP/1.1 307 Temporary Redirect",308:"HTTP/1.1 308 Permanent Redirect",404:"HTTP/1.1 404 Not Found",500:"HTTP/1.1 500 Internal Server Error"};return new(function(){function ht(){___classCallCheck_149(this,ht)}return ___createClass_149(ht,[{key:"status",value:function(xt){return D=xt,this}},{key:"send",value:function(){var xt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",l={status:ct?dt[D]:D,body:xt,headers:At};ct||mt?$done(l):(at||et)&&$done({response:l})}},{key:"end",value:function(){this.send()}},{key:"html",value:function(xt){this.set("Content-Type","text/html;charset=UTF-8"),this.send(xt)}},{key:"json",value:function(xt){this.set("Content-Type","application/json;charset=UTF-8"),this.send(JSON.stringify(xt))}},{key:"set",value:function(xt,l){return At[xt]=l,this}}]),ht}())}}function formatHeaders(t){for(var e={},n=0,r=Object.keys(t);n<r.length;n++){var o=r[n];e[o.toLowerCase()]=t[o]}return e}function patternMatched(t,e){if(t instanceof RegExp&&t.test(e)||t==="/")return!0;if(t.indexOf(":")===-1){for(var n=e.split("/"),r=t.split("/"),o=0;o<r.length;o++)if(n[o]!==r[o])return!1;return!0}return!!extractPathParams(t,e)}function extractURL(t){var e=(t.match(/https?:\/\/[^/]+(\/[^?]*)/)||[])[1]||"/",n={};if(t.indexOf("?")!==-1)for(var r=t.slice(t.indexOf("?")+1).split("&"),o=0;o<r.length;o++){var f=r[o].split("=");n[f[0]]=f[1]}return{path:e,query:n}}function extractPathParams(t,e){if(t.indexOf(":")===-1)return null;for(var n={},r=0,o=0;r<t.length;r++,o++)if(t[r]===":"){for(var f=[],d=[];t[++r]!=="/"&&r<t.length;)f.push(t[r]);for(;e[o]!=="/"&&o<e.length;)d.push(e[o++]);n[f.join("")]=d.join("")}else if(t[r]!==e[o])return null;return n}Object.defineProperty(_$express_149,"__esModule",{value:!0}),_$express_149.default=express;var _$md5_150={};Object.defineProperty(_$md5_150,"__esModule",{value:!0}),_$md5_150.any_hmac_md5=function(t,e,n){return rstr2any(rstr_hmac_md5(str2rstr_utf8(t),str2rstr_utf8(e)),n)},_$md5_150.any_md5=function(t,e){return rstr2any(rstr_md5(str2rstr_utf8(t)),e)},_$md5_150.b64_hmac_md5=function(t,e){return rstr2b64(rstr_hmac_md5(str2rstr_utf8(t),str2rstr_utf8(e)))},_$md5_150.b64_md5=function(t){return rstr2b64(rstr_md5(str2rstr_utf8(t)))},_$md5_150.hex_hmac_md5=function(t,e){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(t),str2rstr_utf8(e)))},_$md5_150.hex_md5=hex_md5;var hexcase=0,b64pad="";function hex_md5(t){return rstr2hex(rstr_md5(str2rstr_utf8(t)))}function rstr_md5(t){return binl2rstr(binl_md5(rstr2binl(t),8*t.length))}function rstr_hmac_md5(t,e){var n=rstr2binl(t);n.length>16&&(n=binl_md5(n,8*t.length));for(var r=Array(16),o=Array(16),f=0;f<16;f++)r[f]=909522486^n[f],o[f]=1549556828^n[f];var d=binl_md5(r.concat(rstr2binl(e)),512+8*e.length);return binl2rstr(binl_md5(o.concat(d),640))}function rstr2hex(t){for(var e,n=hexcase?"0123456789ABCDEF":"0123456789abcdef",r="",o=0;o<t.length;o++)e=t.charCodeAt(o),r+=n.charAt(e>>>4&15)+n.charAt(15&e);return r}function rstr2b64(t){for(var e="",n=t.length,r=0;r<n;r+=3)for(var o=t.charCodeAt(r)<<16|(r+1<n?t.charCodeAt(r+1)<<8:0)|(r+2<n?t.charCodeAt(r+2):0),f=0;f<4;f++)8*r+6*f>8*t.length?e+=b64pad:e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(o>>>6*(3-f)&63);return e}function rstr2any(t,e){var n,r,o,f,d,h=e.length,y=Array(Math.ceil(t.length/2));for(n=0;n<y.length;n++)y[n]=t.charCodeAt(2*n)<<8|t.charCodeAt(2*n+1);var F=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),S=Array(F);for(r=0;r<F;r++){for(d=Array(),f=0,n=0;n<y.length;n++)f=(f<<16)+y[n],f-=(o=Math.floor(f/h))*h,(d.length>0||o>0)&&(d[d.length]=o);S[r]=f,y=d}var T="";for(n=S.length-1;n>=0;n--)T+=e.charAt(S[n]);return T}function str2rstr_utf8(t){for(var e,n,r="",o=-1;++o<t.length;)e=t.charCodeAt(o),n=o+1<t.length?t.charCodeAt(o+1):0,55296<=e&&e<=56319&&56320<=n&&n<=57343&&(e=65536+((1023&e)<<10)+(1023&n),o++),e<=127?r+=String.fromCharCode(e):e<=2047?r+=String.fromCharCode(192|e>>>6&31,128|63&e):e<=65535?r+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):e<=2097151&&(r+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return r}function rstr2binl(t){for(var e=Array(t.length>>2),n=0;n<e.length;n++)e[n]=0;for(n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return e}function binl2rstr(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e}function binl_md5(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var n=1732584193,r=-271733879,o=-1732584194,f=271733878,d=0;d<t.length;d+=16){var h=n,y=r,F=o,S=f;n=md5_ff(n,r,o,f,t[d+0],7,-680876936),f=md5_ff(f,n,r,o,t[d+1],12,-389564586),o=md5_ff(o,f,n,r,t[d+2],17,606105819),r=md5_ff(r,o,f,n,t[d+3],22,-1044525330),n=md5_ff(n,r,o,f,t[d+4],7,-176418897),f=md5_ff(f,n,r,o,t[d+5],12,1200080426),o=md5_ff(o,f,n,r,t[d+6],17,-1473231341),r=md5_ff(r,o,f,n,t[d+7],22,-45705983),n=md5_ff(n,r,o,f,t[d+8],7,1770035416),f=md5_ff(f,n,r,o,t[d+9],12,-1958414417),o=md5_ff(o,f,n,r,t[d+10],17,-42063),r=md5_ff(r,o,f,n,t[d+11],22,-1990404162),n=md5_ff(n,r,o,f,t[d+12],7,1804603682),f=md5_ff(f,n,r,o,t[d+13],12,-40341101),o=md5_ff(o,f,n,r,t[d+14],17,-1502002290),n=md5_gg(n,r=md5_ff(r,o,f,n,t[d+15],22,1236535329),o,f,t[d+1],5,-165796510),f=md5_gg(f,n,r,o,t[d+6],9,-1069501632),o=md5_gg(o,f,n,r,t[d+11],14,643717713),r=md5_gg(r,o,f,n,t[d+0],20,-373897302),n=md5_gg(n,r,o,f,t[d+5],5,-701558691),f=md5_gg(f,n,r,o,t[d+10],9,38016083),o=md5_gg(o,f,n,r,t[d+15],14,-660478335),r=md5_gg(r,o,f,n,t[d+4],20,-405537848),n=md5_gg(n,r,o,f,t[d+9],5,568446438),f=md5_gg(f,n,r,o,t[d+14],9,-1019803690),o=md5_gg(o,f,n,r,t[d+3],14,-187363961),r=md5_gg(r,o,f,n,t[d+8],20,1163531501),n=md5_gg(n,r,o,f,t[d+13],5,-1444681467),f=md5_gg(f,n,r,o,t[d+2],9,-51403784),o=md5_gg(o,f,n,r,t[d+7],14,1735328473),n=md5_hh(n,r=md5_gg(r,o,f,n,t[d+12],20,-1926607734),o,f,t[d+5],4,-378558),f=md5_hh(f,n,r,o,t[d+8],11,-2022574463),o=md5_hh(o,f,n,r,t[d+11],16,1839030562),r=md5_hh(r,o,f,n,t[d+14],23,-35309556),n=md5_hh(n,r,o,f,t[d+1],4,-1530992060),f=md5_hh(f,n,r,o,t[d+4],11,1272893353),o=md5_hh(o,f,n,r,t[d+7],16,-155497632),r=md5_hh(r,o,f,n,t[d+10],23,-1094730640),n=md5_hh(n,r,o,f,t[d+13],4,681279174),f=md5_hh(f,n,r,o,t[d+0],11,-358537222),o=md5_hh(o,f,n,r,t[d+3],16,-722521979),r=md5_hh(r,o,f,n,t[d+6],23,76029189),n=md5_hh(n,r,o,f,t[d+9],4,-640364487),f=md5_hh(f,n,r,o,t[d+12],11,-421815835),o=md5_hh(o,f,n,r,t[d+15],16,530742520),n=md5_ii(n,r=md5_hh(r,o,f,n,t[d+2],23,-995338651),o,f,t[d+0],6,-198630844),f=md5_ii(f,n,r,o,t[d+7],10,1126891415),o=md5_ii(o,f,n,r,t[d+14],15,-1416354905),r=md5_ii(r,o,f,n,t[d+5],21,-57434055),n=md5_ii(n,r,o,f,t[d+12],6,1700485571),f=md5_ii(f,n,r,o,t[d+3],10,-1894986606),o=md5_ii(o,f,n,r,t[d+10],15,-1051523),r=md5_ii(r,o,f,n,t[d+1],21,-2054922799),n=md5_ii(n,r,o,f,t[d+8],6,1873313359),f=md5_ii(f,n,r,o,t[d+15],10,-30611744),o=md5_ii(o,f,n,r,t[d+6],15,-1560198380),r=md5_ii(r,o,f,n,t[d+13],21,1309151649),n=md5_ii(n,r,o,f,t[d+4],6,-145523070),f=md5_ii(f,n,r,o,t[d+11],10,-1120210379),o=md5_ii(o,f,n,r,t[d+2],15,718787259),r=md5_ii(r,o,f,n,t[d+9],21,-343485551),n=safe_add(n,h),r=safe_add(r,y),o=safe_add(o,F),f=safe_add(f,S)}return Array(n,r,o,f)}function md5_cmn(t,e,n,r,o,f){return safe_add((d=safe_add(safe_add(e,t),safe_add(r,f)))<<(h=o)|d>>>32-h,n);var d,h}function md5_ff(t,e,n,r,o,f,d){return md5_cmn(e&n|~e&r,t,e,o,f,d)}function md5_gg(t,e,n,r,o,f,d){return md5_cmn(e&r|n&~r,t,e,o,f,d)}function md5_hh(t,e,n,r,o,f,d){return md5_cmn(e^n^r,t,e,o,f,d)}function md5_ii(t,e,n,r,o,f,d){return md5_cmn(n^(e|~r),t,e,o,f,d)}function safe_add(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}var _$common_12={};Object.defineProperty(_$common_12,"__esModule",{value:!0}),_$common_12.isCorrect=_$common_12.isInSubnet=void 0,_$common_12.isInSubnet=function(t){return!(this.subnetMask<t.subnetMask)&&this.mask(t.subnetMask)===t.mask()},_$common_12.isCorrect=function(t){return function(){return this.addressMinusSuffix===this.correctForm()&&(this.subnetMask===t&&!this.parsedSubnet||this.parsedSubnet===String(this.subnetMask))}};var _$constants_16={};Object.defineProperty(_$constants_16,"__esModule",{value:!0}),_$constants_16.RE_SUBNET_STRING=_$constants_16.RE_ADDRESS=_$constants_16.GROUPS=_$constants_16.BITS=void 0,_$constants_16.BITS=32,_$constants_16.GROUPS=4,_$constants_16.RE_ADDRESS=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g,_$constants_16.RE_SUBNET_STRING=/\/\d{1,2}$/;var _$addressError_11={};Object.defineProperty(_$addressError_11,"__esModule",{value:!0}),_$addressError_11.AddressError=void 0,_$addressError_11.AddressError=class extends Error{constructor(t,e){super(t),this.name="AddressError",e!==null&&(this.parseMessage=e)}};var _$jsbn_51={};(function(){var t;function e(x,N,G){x!=null&&(typeof x=="number"?this.fromNumber(x,N,G):N==null&&typeof x!="string"?this.fromString(x,256):this.fromString(x,N))}function n(){return new e(null)}var r=typeof navigator<"u";r&&navigator.appName=="Microsoft Internet Explorer"?(e.prototype.am=function(x,N,G,A,C,j){for(var K=32767&N,J=N>>15;--j>=0;){var yt=32767&this[x],Dt=this[x++]>>15,Xt=J*yt+Dt*K;C=((yt=K*yt+((32767&Xt)<<15)+G[A]+(1073741823&C))>>>30)+(Xt>>>15)+J*Dt+(C>>>30),G[A++]=1073741823&yt}return C},t=30):r&&navigator.appName!="Netscape"?(e.prototype.am=function(x,N,G,A,C,j){for(;--j>=0;){var K=N*this[x++]+G[A]+C;C=Math.floor(K/67108864),G[A++]=67108863&K}return C},t=26):(e.prototype.am=function(x,N,G,A,C,j){for(var K=16383&N,J=N>>14;--j>=0;){var yt=16383&this[x],Dt=this[x++]>>14,Xt=J*yt+Dt*K;C=((yt=K*yt+((16383&Xt)<<14)+G[A]+C)>>28)+(Xt>>14)+J*Dt,G[A++]=268435455&yt}return C},t=28),e.prototype.DB=t,e.prototype.DM=(1<<t)-1,e.prototype.DV=1<<t,e.prototype.FV=Math.pow(2,52),e.prototype.F1=52-t,e.prototype.F2=2*t-52;var o,f,d=new Array;for(o=48,f=0;f<=9;++f)d[o++]=f;for(o=97,f=10;f<36;++f)d[o++]=f;for(o=65,f=10;f<36;++f)d[o++]=f;function h(x){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(x)}function y(x,N){var G=d[x.charCodeAt(N)];return G??-1}function F(x){var N=n();return N.fromInt(x),N}function S(x){var N,G=1;return(N=x>>>16)!=0&&(x=N,G+=16),(N=x>>8)!=0&&(x=N,G+=8),(N=x>>4)!=0&&(x=N,G+=4),(N=x>>2)!=0&&(x=N,G+=2),(N=x>>1)!=0&&(x=N,G+=1),G}function T(x){this.m=x}function U(x){this.m=x,this.mp=x.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<x.DB-15)-1,this.mt2=2*x.t}function M(x,N){return x&N}function Y(x,N){return x|N}function Z(x,N){return x^N}function D(x,N){return x&~N}function nt(x){if(x==0)return-1;var N=0;return!(65535&x)&&(x>>=16,N+=16),!(255&x)&&(x>>=8,N+=8),!(15&x)&&(x>>=4,N+=4),!(3&x)&&(x>>=2,N+=2),!(1&x)&&++N,N}function ct(x){for(var N=0;x!=0;)x&=x-1,++N;return N}function at(){}function et(x){return x}function mt(x){this.r2=n(),this.q3=n(),e.ONE.dlShiftTo(2*x.t,this.r2),this.mu=this.r2.divide(x),this.m=x}T.prototype.convert=function(x){return x.s<0||x.compareTo(this.m)>=0?x.mod(this.m):x},T.prototype.revert=function(x){return x},T.prototype.reduce=function(x){x.divRemTo(this.m,null,x)},T.prototype.mulTo=function(x,N,G){x.multiplyTo(N,G),this.reduce(G)},T.prototype.sqrTo=function(x,N){x.squareTo(N),this.reduce(N)},U.prototype.convert=function(x){var N=n();return x.abs().dlShiftTo(this.m.t,N),N.divRemTo(this.m,null,N),x.s<0&&N.compareTo(e.ZERO)>0&&this.m.subTo(N,N),N},U.prototype.revert=function(x){var N=n();return x.copyTo(N),this.reduce(N),N},U.prototype.reduce=function(x){for(;x.t<=this.mt2;)x[x.t++]=0;for(var N=0;N<this.m.t;++N){var G=32767&x[N],A=G*this.mpl+((G*this.mph+(x[N]>>15)*this.mpl&this.um)<<15)&x.DM;for(x[G=N+this.m.t]+=this.m.am(0,A,x,N,0,this.m.t);x[G]>=x.DV;)x[G]-=x.DV,x[++G]++}x.clamp(),x.drShiftTo(this.m.t,x),x.compareTo(this.m)>=0&&x.subTo(this.m,x)},U.prototype.mulTo=function(x,N,G){x.multiplyTo(N,G),this.reduce(G)},U.prototype.sqrTo=function(x,N){x.squareTo(N),this.reduce(N)},e.prototype.copyTo=function(x){for(var N=this.t-1;N>=0;--N)x[N]=this[N];x.t=this.t,x.s=this.s},e.prototype.fromInt=function(x){this.t=1,this.s=x<0?-1:0,x>0?this[0]=x:x<-1?this[0]=x+this.DV:this.t=0},e.prototype.fromString=function(x,N){var G;if(N==16)G=4;else if(N==8)G=3;else if(N==256)G=8;else if(N==2)G=1;else if(N==32)G=5;else{if(N!=4)return void this.fromRadix(x,N);G=2}this.t=0,this.s=0;for(var A=x.length,C=!1,j=0;--A>=0;){var K=G==8?255&x[A]:y(x,A);K<0?x.charAt(A)=="-"&&(C=!0):(C=!1,j==0?this[this.t++]=K:j+G>this.DB?(this[this.t-1]|=(K&(1<<this.DB-j)-1)<<j,this[this.t++]=K>>this.DB-j):this[this.t-1]|=K<<j,(j+=G)>=this.DB&&(j-=this.DB))}G==8&&128&x[0]&&(this.s=-1,j>0&&(this[this.t-1]|=(1<<this.DB-j)-1<<j)),this.clamp(),C&&e.ZERO.subTo(this,this)},e.prototype.clamp=function(){for(var x=this.s&this.DM;this.t>0&&this[this.t-1]==x;)--this.t},e.prototype.dlShiftTo=function(x,N){var G;for(G=this.t-1;G>=0;--G)N[G+x]=this[G];for(G=x-1;G>=0;--G)N[G]=0;N.t=this.t+x,N.s=this.s},e.prototype.drShiftTo=function(x,N){for(var G=x;G<this.t;++G)N[G-x]=this[G];N.t=Math.max(this.t-x,0),N.s=this.s},e.prototype.lShiftTo=function(x,N){var G,A=x%this.DB,C=this.DB-A,j=(1<<C)-1,K=Math.floor(x/this.DB),J=this.s<<A&this.DM;for(G=this.t-1;G>=0;--G)N[G+K+1]=this[G]>>C|J,J=(this[G]&j)<<A;for(G=K-1;G>=0;--G)N[G]=0;N[K]=J,N.t=this.t+K+1,N.s=this.s,N.clamp()},e.prototype.rShiftTo=function(x,N){N.s=this.s;var G=Math.floor(x/this.DB);if(G>=this.t)N.t=0;else{var A=x%this.DB,C=this.DB-A,j=(1<<A)-1;N[0]=this[G]>>A;for(var K=G+1;K<this.t;++K)N[K-G-1]|=(this[K]&j)<<C,N[K-G]=this[K]>>A;A>0&&(N[this.t-G-1]|=(this.s&j)<<C),N.t=this.t-G,N.clamp()}},e.prototype.subTo=function(x,N){for(var G=0,A=0,C=Math.min(x.t,this.t);G<C;)A+=this[G]-x[G],N[G++]=A&this.DM,A>>=this.DB;if(x.t<this.t){for(A-=x.s;G<this.t;)A+=this[G],N[G++]=A&this.DM,A>>=this.DB;A+=this.s}else{for(A+=this.s;G<x.t;)A-=x[G],N[G++]=A&this.DM,A>>=this.DB;A-=x.s}N.s=A<0?-1:0,A<-1?N[G++]=this.DV+A:A>0&&(N[G++]=A),N.t=G,N.clamp()},e.prototype.multiplyTo=function(x,N){var G=this.abs(),A=x.abs(),C=G.t;for(N.t=C+A.t;--C>=0;)N[C]=0;for(C=0;C<A.t;++C)N[C+G.t]=G.am(0,A[C],N,C,0,G.t);N.s=0,N.clamp(),this.s!=x.s&&e.ZERO.subTo(N,N)},e.prototype.squareTo=function(x){for(var N=this.abs(),G=x.t=2*N.t;--G>=0;)x[G]=0;for(G=0;G<N.t-1;++G){var A=N.am(G,N[G],x,2*G,0,1);(x[G+N.t]+=N.am(G+1,2*N[G],x,2*G+1,A,N.t-G-1))>=N.DV&&(x[G+N.t]-=N.DV,x[G+N.t+1]=1)}x.t>0&&(x[x.t-1]+=N.am(G,N[G],x,2*G,0,1)),x.s=0,x.clamp()},e.prototype.divRemTo=function(x,N,G){var A=x.abs();if(!(A.t<=0)){var C=this.abs();if(C.t<A.t)return N?.fromInt(0),void(G!=null&&this.copyTo(G));G==null&&(G=n());var j=n(),K=this.s,J=x.s,yt=this.DB-S(A[A.t-1]);yt>0?(A.lShiftTo(yt,j),C.lShiftTo(yt,G)):(A.copyTo(j),C.copyTo(G));var Dt=j.t,Xt=j[Dt-1];if(Xt!=0){var _e=Xt*(1<<this.F1)+(Dt>1?j[Dt-2]>>this.F2:0),me=this.FV/_e,de=(1<<this.F1)/_e,Zt=1<<this.F2,Vt=G.t,pe=Vt-Dt,ge=N??n();for(j.dlShiftTo(pe,ge),G.compareTo(ge)>=0&&(G[G.t++]=1,G.subTo(ge,G)),e.ONE.dlShiftTo(Dt,ge),ge.subTo(j,j);j.t<Dt;)j[j.t++]=0;for(;--pe>=0;){var jt=G[--Vt]==Xt?this.DM:Math.floor(G[Vt]*me+(G[Vt-1]+Zt)*de);if((G[Vt]+=j.am(0,jt,G,pe,0,Dt))<jt)for(j.dlShiftTo(pe,ge),G.subTo(ge,G);G[Vt]<--jt;)G.subTo(ge,G)}N!=null&&(G.drShiftTo(Dt,N),K!=J&&e.ZERO.subTo(N,N)),G.t=Dt,G.clamp(),yt>0&&G.rShiftTo(yt,G),K<0&&e.ZERO.subTo(G,G)}}},e.prototype.invDigit=function(){if(this.t<1)return 0;var x=this[0];if(!(1&x))return 0;var N=3&x;return(N=(N=(N=(N=N*(2-(15&x)*N)&15)*(2-(255&x)*N)&255)*(2-((65535&x)*N&65535))&65535)*(2-x*N%this.DV)%this.DV)>0?this.DV-N:-N},e.prototype.isEven=function(){return(this.t>0?1&this[0]:this.s)==0},e.prototype.exp=function(x,N){if(x>4294967295||x<1)return e.ONE;var G=n(),A=n(),C=N.convert(this),j=S(x)-1;for(C.copyTo(G);--j>=0;)if(N.sqrTo(G,A),(x&1<<j)>0)N.mulTo(A,C,G);else{var K=G;G=A,A=K}return N.revert(G)},e.prototype.toString=function(x){if(this.s<0)return"-"+this.negate().toString(x);var N;if(x==16)N=4;else if(x==8)N=3;else if(x==2)N=1;else if(x==32)N=5;else{if(x!=4)return this.toRadix(x);N=2}var G,A=(1<<N)-1,C=!1,j="",K=this.t,J=this.DB-K*this.DB%N;if(K-- >0)for(J<this.DB&&(G=this[K]>>J)>0&&(C=!0,j=h(G));K>=0;)J<N?(G=(this[K]&(1<<J)-1)<<N-J,G|=this[--K]>>(J+=this.DB-N)):(G=this[K]>>(J-=N)&A,J<=0&&(J+=this.DB,--K)),G>0&&(C=!0),C&&(j+=h(G));return C?j:"0"},e.prototype.negate=function(){var x=n();return e.ZERO.subTo(this,x),x},e.prototype.abs=function(){return this.s<0?this.negate():this},e.prototype.compareTo=function(x){var N=this.s-x.s;if(N!=0)return N;var G=this.t;if((N=G-x.t)!=0)return this.s<0?-N:N;for(;--G>=0;)if((N=this[G]-x[G])!=0)return N;return 0},e.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+S(this[this.t-1]^this.s&this.DM)},e.prototype.mod=function(x){var N=n();return this.abs().divRemTo(x,null,N),this.s<0&&N.compareTo(e.ZERO)>0&&x.subTo(N,N),N},e.prototype.modPowInt=function(x,N){var G;return G=x<256||N.isEven()?new T(N):new U(N),this.exp(x,G)},e.ZERO=F(0),e.ONE=F(1),at.prototype.convert=et,at.prototype.revert=et,at.prototype.mulTo=function(x,N,G){x.multiplyTo(N,G)},at.prototype.sqrTo=function(x,N){x.squareTo(N)},mt.prototype.convert=function(x){if(x.s<0||x.t>2*this.m.t)return x.mod(this.m);if(x.compareTo(this.m)<0)return x;var N=n();return x.copyTo(N),this.reduce(N),N},mt.prototype.revert=function(x){return x},mt.prototype.reduce=function(x){for(x.drShiftTo(this.m.t-1,this.r2),x.t>this.m.t+1&&(x.t=this.m.t+1,x.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);x.compareTo(this.r2)<0;)x.dAddOffset(1,this.m.t+1);for(x.subTo(this.r2,x);x.compareTo(this.m)>=0;)x.subTo(this.m,x)},mt.prototype.mulTo=function(x,N,G){x.multiplyTo(N,G),this.reduce(G)},mt.prototype.sqrTo=function(x,N){x.squareTo(N),this.reduce(N)};var At,dt,ht,xt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],l=(1<<26)/xt[xt.length-1];function s(){var x;x=new Date().getTime(),dt[ht++]^=255&x,dt[ht++]^=x>>8&255,dt[ht++]^=x>>16&255,dt[ht++]^=x>>24&255,ht>=Ct&&(ht-=Ct)}if(e.prototype.chunkSize=function(x){return Math.floor(Math.LN2*this.DB/Math.log(x))},e.prototype.toRadix=function(x){if(x==null&&(x=10),this.signum()==0||x<2||x>36)return"0";var N=this.chunkSize(x),G=Math.pow(x,N),A=F(G),C=n(),j=n(),K="";for(this.divRemTo(A,C,j);C.signum()>0;)K=(G+j.intValue()).toString(x).substr(1)+K,C.divRemTo(A,C,j);return j.intValue().toString(x)+K},e.prototype.fromRadix=function(x,N){this.fromInt(0),N==null&&(N=10);for(var G=this.chunkSize(N),A=Math.pow(N,G),C=!1,j=0,K=0,J=0;J<x.length;++J){var yt=y(x,J);yt<0?x.charAt(J)=="-"&&this.signum()==0&&(C=!0):(K=N*K+yt,++j>=G&&(this.dMultiply(A),this.dAddOffset(K,0),j=0,K=0))}j>0&&(this.dMultiply(Math.pow(N,j)),this.dAddOffset(K,0)),C&&e.ZERO.subTo(this,this)},e.prototype.fromNumber=function(x,N,G){if(typeof N=="number")if(x<2)this.fromInt(1);else for(this.fromNumber(x,G),this.testBit(x-1)||this.bitwiseTo(e.ONE.shiftLeft(x-1),Y,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(N);)this.dAddOffset(2,0),this.bitLength()>x&&this.subTo(e.ONE.shiftLeft(x-1),this);else{var A=new Array,C=7&x;A.length=1+(x>>3),N.nextBytes(A),C>0?A[0]&=(1<<C)-1:A[0]=0,this.fromString(A,256)}},e.prototype.bitwiseTo=function(x,N,G){var A,C,j=Math.min(x.t,this.t);for(A=0;A<j;++A)G[A]=N(this[A],x[A]);if(x.t<this.t){for(C=x.s&this.DM,A=j;A<this.t;++A)G[A]=N(this[A],C);G.t=this.t}else{for(C=this.s&this.DM,A=j;A<x.t;++A)G[A]=N(C,x[A]);G.t=x.t}G.s=N(this.s,x.s),G.clamp()},e.prototype.changeBit=function(x,N){var G=e.ONE.shiftLeft(x);return this.bitwiseTo(G,N,G),G},e.prototype.addTo=function(x,N){for(var G=0,A=0,C=Math.min(x.t,this.t);G<C;)A+=this[G]+x[G],N[G++]=A&this.DM,A>>=this.DB;if(x.t<this.t){for(A+=x.s;G<this.t;)A+=this[G],N[G++]=A&this.DM,A>>=this.DB;A+=this.s}else{for(A+=this.s;G<x.t;)A+=x[G],N[G++]=A&this.DM,A>>=this.DB;A+=x.s}N.s=A<0?-1:0,A>0?N[G++]=A:A<-1&&(N[G++]=this.DV+A),N.t=G,N.clamp()},e.prototype.dMultiply=function(x){this[this.t]=this.am(0,x-1,this,0,0,this.t),++this.t,this.clamp()},e.prototype.dAddOffset=function(x,N){if(x!=0){for(;this.t<=N;)this[this.t++]=0;for(this[N]+=x;this[N]>=this.DV;)this[N]-=this.DV,++N>=this.t&&(this[this.t++]=0),++this[N]}},e.prototype.multiplyLowerTo=function(x,N,G){var A,C=Math.min(this.t+x.t,N);for(G.s=0,G.t=C;C>0;)G[--C]=0;for(A=G.t-this.t;C<A;++C)G[C+this.t]=this.am(0,x[C],G,C,0,this.t);for(A=Math.min(x.t,N);C<A;++C)this.am(0,x[C],G,C,0,N-C);G.clamp()},e.prototype.multiplyUpperTo=function(x,N,G){--N;var A=G.t=this.t+x.t-N;for(G.s=0;--A>=0;)G[A]=0;for(A=Math.max(N-this.t,0);A<x.t;++A)G[this.t+A-N]=this.am(N-A,x[A],G,0,0,this.t+A-N);G.clamp(),G.drShiftTo(1,G)},e.prototype.modInt=function(x){if(x<=0)return 0;var N=this.DV%x,G=this.s<0?x-1:0;if(this.t>0)if(N==0)G=this[0]%x;else for(var A=this.t-1;A>=0;--A)G=(N*G+this[A])%x;return G},e.prototype.millerRabin=function(x){var N=this.subtract(e.ONE),G=N.getLowestSetBit();if(G<=0)return!1;var A=N.shiftRight(G);(x=x+1>>1)>xt.length&&(x=xt.length);for(var C=n(),j=0;j<x;++j){C.fromInt(xt[Math.floor(Math.random()*xt.length)]);var K=C.modPow(A,this);if(K.compareTo(e.ONE)!=0&&K.compareTo(N)!=0){for(var J=1;J++<G&&K.compareTo(N)!=0;)if((K=K.modPowInt(2,this)).compareTo(e.ONE)==0)return!1;if(K.compareTo(N)!=0)return!1}}return!0},e.prototype.clone=function(){var x=n();return this.copyTo(x),x},e.prototype.intValue=function(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},e.prototype.byteValue=function(){return this.t==0?this.s:this[0]<<24>>24},e.prototype.shortValue=function(){return this.t==0?this.s:this[0]<<16>>16},e.prototype.signum=function(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1},e.prototype.toByteArray=function(){var x=this.t,N=new Array;N[0]=this.s;var G,A=this.DB-x*this.DB%8,C=0;if(x-- >0)for(A<this.DB&&(G=this[x]>>A)!=(this.s&this.DM)>>A&&(N[C++]=G|this.s<<this.DB-A);x>=0;)A<8?(G=(this[x]&(1<<A)-1)<<8-A,G|=this[--x]>>(A+=this.DB-8)):(G=this[x]>>(A-=8)&255,A<=0&&(A+=this.DB,--x)),128&G&&(G|=-256),C==0&&(128&this.s)!=(128&G)&&++C,(C>0||G!=this.s)&&(N[C++]=G);return N},e.prototype.equals=function(x){return this.compareTo(x)==0},e.prototype.min=function(x){return this.compareTo(x)<0?this:x},e.prototype.max=function(x){return this.compareTo(x)>0?this:x},e.prototype.and=function(x){var N=n();return this.bitwiseTo(x,M,N),N},e.prototype.or=function(x){var N=n();return this.bitwiseTo(x,Y,N),N},e.prototype.xor=function(x){var N=n();return this.bitwiseTo(x,Z,N),N},e.prototype.andNot=function(x){var N=n();return this.bitwiseTo(x,D,N),N},e.prototype.not=function(){for(var x=n(),N=0;N<this.t;++N)x[N]=this.DM&~this[N];return x.t=this.t,x.s=~this.s,x},e.prototype.shiftLeft=function(x){var N=n();return x<0?this.rShiftTo(-x,N):this.lShiftTo(x,N),N},e.prototype.shiftRight=function(x){var N=n();return x<0?this.lShiftTo(-x,N):this.rShiftTo(x,N),N},e.prototype.getLowestSetBit=function(){for(var x=0;x<this.t;++x)if(this[x]!=0)return x*this.DB+nt(this[x]);return this.s<0?this.t*this.DB:-1},e.prototype.bitCount=function(){for(var x=0,N=this.s&this.DM,G=0;G<this.t;++G)x+=ct(this[G]^N);return x},e.prototype.testBit=function(x){var N=Math.floor(x/this.DB);return N>=this.t?this.s!=0:(this[N]&1<<x%this.DB)!=0},e.prototype.setBit=function(x){return this.changeBit(x,Y)},e.prototype.clearBit=function(x){return this.changeBit(x,D)},e.prototype.flipBit=function(x){return this.changeBit(x,Z)},e.prototype.add=function(x){var N=n();return this.addTo(x,N),N},e.prototype.subtract=function(x){var N=n();return this.subTo(x,N),N},e.prototype.multiply=function(x){var N=n();return this.multiplyTo(x,N),N},e.prototype.divide=function(x){var N=n();return this.divRemTo(x,N,null),N},e.prototype.remainder=function(x){var N=n();return this.divRemTo(x,null,N),N},e.prototype.divideAndRemainder=function(x){var N=n(),G=n();return this.divRemTo(x,N,G),new Array(N,G)},e.prototype.modPow=function(x,N){var G,A,C=x.bitLength(),j=F(1);if(C<=0)return j;G=C<18?1:C<48?3:C<144?4:C<768?5:6,A=C<8?new T(N):N.isEven()?new mt(N):new U(N);var K=new Array,J=3,yt=G-1,Dt=(1<<G)-1;if(K[1]=A.convert(this),G>1){var Xt=n();for(A.sqrTo(K[1],Xt);J<=Dt;)K[J]=n(),A.mulTo(Xt,K[J-2],K[J]),J+=2}var _e,me,de=x.t-1,Zt=!0,Vt=n();for(C=S(x[de])-1;de>=0;){for(C>=yt?_e=x[de]>>C-yt&Dt:(_e=(x[de]&(1<<C+1)-1)<<yt-C,de>0&&(_e|=x[de-1]>>this.DB+C-yt)),J=G;!(1&_e);)_e>>=1,--J;if((C-=J)<0&&(C+=this.DB,--de),Zt)K[_e].copyTo(j),Zt=!1;else{for(;J>1;)A.sqrTo(j,Vt),A.sqrTo(Vt,j),J-=2;J>0?A.sqrTo(j,Vt):(me=j,j=Vt,Vt=me),A.mulTo(Vt,K[_e],j)}for(;de>=0&&!(x[de]&1<<C);)A.sqrTo(j,Vt),me=j,j=Vt,Vt=me,--C<0&&(C=this.DB-1,--de)}return A.revert(j)},e.prototype.modInverse=function(x){var N=x.isEven();if(this.isEven()&&N||x.signum()==0)return e.ZERO;for(var G=x.clone(),A=this.clone(),C=F(1),j=F(0),K=F(0),J=F(1);G.signum()!=0;){for(;G.isEven();)G.rShiftTo(1,G),N?(C.isEven()&&j.isEven()||(C.addTo(this,C),j.subTo(x,j)),C.rShiftTo(1,C)):j.isEven()||j.subTo(x,j),j.rShiftTo(1,j);for(;A.isEven();)A.rShiftTo(1,A),N?(K.isEven()&&J.isEven()||(K.addTo(this,K),J.subTo(x,J)),K.rShiftTo(1,K)):J.isEven()||J.subTo(x,J),J.rShiftTo(1,J);G.compareTo(A)>=0?(G.subTo(A,G),N&&C.subTo(K,C),j.subTo(J,j)):(A.subTo(G,A),N&&K.subTo(C,K),J.subTo(j,J))}return A.compareTo(e.ONE)!=0?e.ZERO:J.compareTo(x)>=0?J.subtract(x):J.signum()<0?(J.addTo(x,J),J.signum()<0?J.add(x):J):J},e.prototype.pow=function(x){return this.exp(x,new at)},e.prototype.gcd=function(x){var N=this.s<0?this.negate():this.clone(),G=x.s<0?x.negate():x.clone();if(N.compareTo(G)<0){var A=N;N=G,G=A}var C=N.getLowestSetBit(),j=G.getLowestSetBit();if(j<0)return N;for(C<j&&(j=C),j>0&&(N.rShiftTo(j,N),G.rShiftTo(j,G));N.signum()>0;)(C=N.getLowestSetBit())>0&&N.rShiftTo(C,N),(C=G.getLowestSetBit())>0&&G.rShiftTo(C,G),N.compareTo(G)>=0?(N.subTo(G,N),N.rShiftTo(1,N)):(G.subTo(N,G),G.rShiftTo(1,G));return j>0&&G.lShiftTo(j,G),G},e.prototype.isProbablePrime=function(x){var N,G=this.abs();if(G.t==1&&G[0]<=xt[xt.length-1]){for(N=0;N<xt.length;++N)if(G[0]==xt[N])return!0;return!1}if(G.isEven())return!1;for(N=1;N<xt.length;){for(var A=xt[N],C=N+1;C<xt.length&&A<l;)A*=xt[C++];for(A=G.modInt(A);N<C;)if(A%xt[N++]==0)return!1}return G.millerRabin(x)},e.prototype.square=function(){var x=n();return this.squareTo(x),x},e.prototype.Barrett=mt,dt==null){var v;if(dt=new Array,ht=0,typeof window<"u"&&window.crypto){if(window.crypto.getRandomValues){var $=new Uint8Array(32);for(window.crypto.getRandomValues($),v=0;v<32;++v)dt[ht++]=$[v]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var E=window.crypto.random(32);for(v=0;v<E.length;++v)dt[ht++]=255&E.charCodeAt(v)}}for(;ht<Ct;)v=Math.floor(65536*Math.random()),dt[ht++]=v>>>8,dt[ht++]=255&v;ht=0,s()}function rt(){if(At==null){for(s(),(At=new Et).init(dt),ht=0;ht<dt.length;++ht)dt[ht]=0;ht=0}return At.next()}function gt(){}function Et(){this.i=0,this.j=0,this.S=new Array}gt.prototype.nextBytes=function(x){var N;for(N=0;N<x.length;++N)x[N]=rt()},Et.prototype.init=function(x){var N,G,A;for(N=0;N<256;++N)this.S[N]=N;for(G=0,N=0;N<256;++N)G=G+this.S[N]+x[N%x.length]&255,A=this.S[N],this.S[N]=this.S[G],this.S[G]=A;this.i=0,this.j=0},Et.prototype.next=function(){var x;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,x=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=x,this.S[x+this.S[this.i]&255]};var Ct=256;_$jsbn_51!==void 0?_$jsbn_51=_$jsbn_51={default:e,BigInteger:e,SecureRandom:gt}:this.jsbn={BigInteger:e,SecureRandom:gt}}).call(this);var _$sprintf_83={};(function(){"use strict";var t={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function e(o){return function(f,d){var h,y,F,S,T,U,M,Y,Z,D=1,nt=f.length,ct="";for(y=0;y<nt;y++)if(typeof f[y]=="string")ct+=f[y];else if(typeof f[y]=="object"){if((S=f[y]).keys)for(h=d[D],F=0;F<S.keys.length;F++){if(h==null)throw new Error(e('[sprintf] Cannot access property "%s" of undefined value "%s"',S.keys[F],S.keys[F-1]));h=h[S.keys[F]]}else h=S.param_no?d[S.param_no]:d[D++];if(t.not_type.test(S.type)&&t.not_primitive.test(S.type)&&h instanceof Function&&(h=h()),t.numeric_arg.test(S.type)&&typeof h!="number"&&isNaN(h))throw new TypeError(e("[sprintf] expecting number but found %T",h));switch(t.number.test(S.type)&&(Y=h>=0),S.type){case"b":h=parseInt(h,10).toString(2);break;case"c":h=String.fromCharCode(parseInt(h,10));break;case"d":case"i":h=parseInt(h,10);break;case"j":h=JSON.stringify(h,null,S.width?parseInt(S.width):0);break;case"e":h=S.precision?parseFloat(h).toExponential(S.precision):parseFloat(h).toExponential();break;case"f":h=S.precision?parseFloat(h).toFixed(S.precision):parseFloat(h);break;case"g":h=S.precision?String(Number(h.toPrecision(S.precision))):parseFloat(h);break;case"o":h=(parseInt(h,10)>>>0).toString(8);break;case"s":h=String(h),h=S.precision?h.substring(0,S.precision):h;break;case"t":h=String(!!h),h=S.precision?h.substring(0,S.precision):h;break;case"T":h=Object.prototype.toString.call(h).slice(8,-1).toLowerCase(),h=S.precision?h.substring(0,S.precision):h;break;case"u":h=parseInt(h,10)>>>0;break;case"v":h=h.valueOf(),h=S.precision?h.substring(0,S.precision):h;break;case"x":h=(parseInt(h,10)>>>0).toString(16);break;case"X":h=(parseInt(h,10)>>>0).toString(16).toUpperCase()}t.json.test(S.type)?ct+=h:(!t.number.test(S.type)||Y&&!S.sign?Z="":(Z=Y?"+":"-",h=h.toString().replace(t.sign,"")),U=S.pad_char?S.pad_char==="0"?"0":S.pad_char.charAt(1):" ",M=S.width-(Z+h).length,T=S.width&&M>0?U.repeat(M):"",ct+=S.align?Z+h+T:U==="0"?Z+T+h:T+Z+h)}return ct}(function(f){if(r[f])return r[f];for(var d,h=f,y=[],F=0;h;){if((d=t.text.exec(h))!==null)y.push(d[0]);else if((d=t.modulo.exec(h))!==null)y.push("%");else{if((d=t.placeholder.exec(h))===null)throw new SyntaxError("[sprintf] unexpected placeholder");if(d[2]){F|=1;var S=[],T=d[2],U=[];if((U=t.key.exec(T))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");for(S.push(U[1]);(T=T.substring(U[0].length))!=="";)if((U=t.key_access.exec(T))!==null)S.push(U[1]);else{if((U=t.index_access.exec(T))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");S.push(U[1])}d[2]=S}else F|=2;if(F===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");y.push({placeholder:d[0],param_no:d[1],keys:d[2],sign:d[3],pad_char:d[4],align:d[5],width:d[6],precision:d[7],type:d[8]})}h=h.substring(d[0].length)}return r[f]=y}(o),arguments)}function n(o,f){return e.apply(null,[o].concat(f||[]))}var r=Object.create(null);_$sprintf_83!==void 0&&(_$sprintf_83.sprintf=e,_$sprintf_83.vsprintf=n),typeof window<"u"&&(window.sprintf=e,window.vsprintf=n,typeof define=="function"&&define.amd&&define(function(){return{sprintf:e,vsprintf:n}}))})();var _$ipv4_14={},__createBinding=this&&this.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&("get"in o?e.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),__importStar=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&__createBinding(e,t,n);return __setModuleDefault(e,t),e};Object.defineProperty(_$ipv4_14,"__esModule",{value:!0}),_$ipv4_14.Address4=void 0;const common=__importStar(_$common_12),constants=__importStar(_$constants_16);class Address4{constructor(e){this.groups=constants.GROUPS,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=common.isCorrect(constants.BITS),this.isInSubnet=common.isInSubnet,this.address=e;const n=constants.RE_SUBNET_STRING.exec(e);if(n){if(this.parsedSubnet=n[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,this.subnetMask<0||this.subnetMask>constants.BITS)throw new _$addressError_11.AddressError("Invalid subnet mask.");e=e.replace(constants.RE_SUBNET_STRING,"")}this.addressMinusSuffix=e,this.parsedAddress=this.parse(e)}static isValid(e){try{return new Address4(e),!0}catch{return!1}}parse(e){const n=e.split(".");if(!e.match(constants.RE_ADDRESS))throw new _$addressError_11.AddressError("Invalid IPv4 address.");return n}correctForm(){return this.parsedAddress.map(e=>parseInt(e,10)).join(".")}static fromHex(e){const n=e.replace(/:/g,"").padStart(8,"0"),r=[];let o;for(o=0;o<8;o+=2){const f=n.slice(o,o+2);r.push(parseInt(f,16))}return new Address4(r.join("."))}static fromInteger(e){return Address4.fromHex(e.toString(16))}static fromArpa(e){const n=e.replace(/(\.in-addr\.arpa)?\.$/,"").split(".").reverse().join(".");return new Address4(n)}toHex(){return this.parsedAddress.map(e=>(0,_$sprintf_83.sprintf)("%02x",parseInt(e,10))).join(":")}toArray(){return this.parsedAddress.map(e=>parseInt(e,10))}toGroup6(){const e=[];let n;for(n=0;n<constants.GROUPS;n+=2){const r=(0,_$sprintf_83.sprintf)("%02x%02x",parseInt(this.parsedAddress[n],10),parseInt(this.parsedAddress[n+1],10));e.push((0,_$sprintf_83.sprintf)("%x",parseInt(r,16)))}return e.join(":")}bigInteger(){return new _$jsbn_51.BigInteger(this.parsedAddress.map(e=>(0,_$sprintf_83.sprintf)("%02x",parseInt(e,10))).join(""),16)}_startAddress(){return new _$jsbn_51.BigInteger(this.mask()+"0".repeat(constants.BITS-this.subnetMask),2)}startAddress(){return Address4.fromBigInteger(this._startAddress())}startAddressExclusive(){const e=new _$jsbn_51.BigInteger("1");return Address4.fromBigInteger(this._startAddress().add(e))}_endAddress(){return new _$jsbn_51.BigInteger(this.mask()+"1".repeat(constants.BITS-this.subnetMask),2)}endAddress(){return Address4.fromBigInteger(this._endAddress())}endAddressExclusive(){const e=new _$jsbn_51.BigInteger("1");return Address4.fromBigInteger(this._endAddress().subtract(e))}static fromBigInteger(e){return Address4.fromInteger(parseInt(e.toString(),10))}mask(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)}getBitsBase2(e,n){return this.binaryZeroPad().slice(e,n)}reverseForm(e){e||(e={});const n=this.correctForm().split(".").reverse().join(".");return e.omitSuffix?n:(0,_$sprintf_83.sprintf)("%s.in-addr.arpa.",n)}isMulticast(){return this.isInSubnet(new Address4("224.0.0.0/4"))}binaryZeroPad(){return this.bigInteger().toString(2).padStart(constants.BITS,"0")}groupForV6(){const e=this.parsedAddress;return this.address.replace(constants.RE_ADDRESS,(0,_$sprintf_83.sprintf)('<span class="hover-group group-v4 group-6">%s</span>.<span class="hover-group group-v4 group-7">%s</span>',e.slice(0,2).join("."),e.slice(2,4).join(".")))}}_$ipv4_14.Address4=Address4;var _$constants_17={};Object.defineProperty(_$constants_17,"__esModule",{value:!0}),_$constants_17.RE_URL_WITH_PORT=_$constants_17.RE_URL=_$constants_17.RE_ZONE_STRING=_$constants_17.RE_SUBNET_STRING=_$constants_17.RE_BAD_ADDRESS=_$constants_17.RE_BAD_CHARACTERS=_$constants_17.TYPES=_$constants_17.SCOPES=_$constants_17.GROUPS=_$constants_17.BITS=void 0,_$constants_17.BITS=128,_$constants_17.GROUPS=8,_$constants_17.SCOPES={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"},_$constants_17.TYPES={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"},_$constants_17.RE_BAD_CHARACTERS=/([^0-9a-f:/%])/gi,_$constants_17.RE_BAD_ADDRESS=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi,_$constants_17.RE_SUBNET_STRING=/\/\d{1,3}(?=%|$)/,_$constants_17.RE_ZONE_STRING=/%.*$/,_$constants_17.RE_URL=new RegExp(/^\[{0,1}([0-9a-f:]+)\]{0,1}/),_$constants_17.RE_URL_WITH_PORT=new RegExp(/\[([0-9a-f:]+)\]:([0-9]{1,5})/);var _$helpers_18={};function spanAllZeroes(t){return t.replace(/(0+)/g,'<span class="zero">$1</span>')}function spanLeadingZeroesSimple(t){return t.replace(/^(0+)/,'<span class="zero">$1</span>')}Object.defineProperty(_$helpers_18,"__esModule",{value:!0}),_$helpers_18.simpleGroup=_$helpers_18.spanLeadingZeroes=_$helpers_18.spanAll=_$helpers_18.spanAllZeroes=void 0,_$helpers_18.spanAllZeroes=spanAllZeroes,_$helpers_18.spanAll=function(t,e=0){return t.split("").map((n,r)=>(0,_$sprintf_83.sprintf)('<span class="digit value-%s position-%d">%s</span>',n,r+e,spanAllZeroes(n))).join("")},_$helpers_18.spanLeadingZeroes=function(t){return t.split(":").map(e=>spanLeadingZeroesSimple(e)).join(":")},_$helpers_18.simpleGroup=function(t,e=0){return t.split(":").map((n,r)=>/group-v4/.test(n)?n:(0,_$sprintf_83.sprintf)('<span class="hover-group group-%d">%s</span>',r+e,spanLeadingZeroesSimple(n)))};var _$regularExpressions_19={},____createBinding_19=this&&this.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&("get"in o?e.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),____setModuleDefault_19=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),____importStar_19=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&____createBinding_19(e,t,n);return ____setModuleDefault_19(e,t),e};Object.defineProperty(_$regularExpressions_19,"__esModule",{value:!0}),_$regularExpressions_19.possibleElisions=_$regularExpressions_19.simpleRegularExpression=_$regularExpressions_19.ADDRESS_BOUNDARY=_$regularExpressions_19.padGroup=_$regularExpressions_19.groupPossibilities=void 0;const v6=____importStar_19(_$constants_17);function groupPossibilities(t){return(0,_$sprintf_83.sprintf)("(%s)",t.join("|"))}function padGroup(t){return t.length<4?(0,_$sprintf_83.sprintf)("0{0,%d}%s",4-t.length,t):t}_$regularExpressions_19.groupPossibilities=groupPossibilities,_$regularExpressions_19.padGroup=padGroup,_$regularExpressions_19.ADDRESS_BOUNDARY="[^A-Fa-f0-9:]",_$regularExpressions_19.simpleRegularExpression=function(t){const e=[];t.forEach((r,o)=>{parseInt(r,16)===0&&e.push(o)});const n=e.map(r=>t.map((o,f)=>{if(f===r){const d=f===0||f===v6.GROUPS-1?":":"";return groupPossibilities([padGroup(o),d])}return padGroup(o)}).join(":"));return n.push(t.map(padGroup).join(":")),groupPossibilities(n)},_$regularExpressions_19.possibleElisions=function(t,e,n){const r=e?"":":",o=n?"":":",f=[];e||n||f.push("::"),e&&n&&f.push(""),(n&&!e||!n&&e)&&f.push(":"),f.push((0,_$sprintf_83.sprintf)("%s(:0{1,4}){1,%d}",r,t-1)),f.push((0,_$sprintf_83.sprintf)("(0{1,4}:){1,%d}%s",t-1,o)),f.push((0,_$sprintf_83.sprintf)("(0{1,4}:){%d}0{1,4}",t-1));for(let d=1;d<t-1;d++)for(let h=1;h<t-d;h++)f.push((0,_$sprintf_83.sprintf)("(0{1,4}:){%d}:(0{1,4}:){%d}0{1,4}",h,t-h-d-1));return groupPossibilities(f)};var _$ipv6_15={},____createBinding_15=this&&this.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&("get"in o?e.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),____setModuleDefault_15=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),____importStar_15=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&____createBinding_15(e,t,n);return ____setModuleDefault_15(e,t),e};Object.defineProperty(_$ipv6_15,"__esModule",{value:!0}),_$ipv6_15.Address6=void 0;const __common_15=____importStar_15(_$common_12),constants4=____importStar_15(_$constants_16),constants6=____importStar_15(_$constants_17),helpers=____importStar_15(_$helpers_18);function spanLeadingZeroes4(t){return(t=t.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2')).replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2')}function paddedHex(t){return(0,_$sprintf_83.sprintf)("%04x",parseInt(t,16))}function unsignByte(t){return 255&t}class Address6{constructor(e,n){this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=__common_15.isInSubnet,this.isCorrect=__common_15.isCorrect(constants6.BITS),this.groups=n===void 0?constants6.GROUPS:n,this.address=e;const r=constants6.RE_SUBNET_STRING.exec(e);if(r){if(this.parsedSubnet=r[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>constants6.BITS)throw new _$addressError_11.AddressError("Invalid subnet mask.");e=e.replace(constants6.RE_SUBNET_STRING,"")}else if(/\//.test(e))throw new _$addressError_11.AddressError("Invalid subnet mask.");const o=constants6.RE_ZONE_STRING.exec(e);o&&(this.zone=o[0],e=e.replace(constants6.RE_ZONE_STRING,"")),this.addressMinusSuffix=e,this.parsedAddress=this.parse(this.addressMinusSuffix)}static isValid(e){try{return new Address6(e),!0}catch{return!1}}static fromBigInteger(e){const n=e.toString(16).padStart(32,"0"),r=[];let o;for(o=0;o<constants6.GROUPS;o++)r.push(n.slice(4*o,4*(o+1)));return new Address6(r.join(":"))}static fromURL(e){let n,r,o=null;if(e.indexOf("[")!==-1&&e.indexOf("]:")!==-1){if((r=constants6.RE_URL_WITH_PORT.exec(e))===null)return{error:"failed to parse address with port",address:null,port:null};n=r[1],o=r[2]}else if(e.indexOf("/")!==-1){if(e=e.replace(/^[a-z0-9]+:\/\//,""),(r=constants6.RE_URL.exec(e))===null)return{error:"failed to parse address from URL",address:null,port:null};n=r[1]}else n=e;return o?((o=parseInt(o,10))<0||o>65536)&&(o=null):o=null,{address:new Address6(n),port:o}}static fromAddress4(e){const n=new _$ipv4_14.Address4(e),r=constants6.BITS-(constants4.BITS-n.subnetMask);return new Address6(`::ffff:${n.correctForm()}/${r}`)}static fromArpa(e){let n=e.replace(/(\.ip6\.arpa)?\.$/,"");if(n.length!==63)throw new _$addressError_11.AddressError("Invalid 'ip6.arpa' form.");const r=n.split(".").reverse();for(let o=7;o>0;o--){const f=4*o;r.splice(f,0,":")}return n=r.join(""),new Address6(n)}microsoftTranscription(){return(0,_$sprintf_83.sprintf)("%s.ipv6-literal.net",this.correctForm().replace(/:/g,"-"))}mask(e=this.subnetMask){return this.getBitsBase2(0,e)}possibleSubnets(e=128){const n=constants6.BITS-this.subnetMask-Math.abs(e-constants6.BITS);return n<0?"0":function(r){const o=/(\d+)(\d{3})/;for(;o.test(r);)r=r.replace(o,"$1,$2");return r}(new _$jsbn_51.BigInteger("2",10).pow(n).toString(10))}_startAddress(){return new _$jsbn_51.BigInteger(this.mask()+"0".repeat(constants6.BITS-this.subnetMask),2)}startAddress(){return Address6.fromBigInteger(this._startAddress())}startAddressExclusive(){const e=new _$jsbn_51.BigInteger("1");return Address6.fromBigInteger(this._startAddress().add(e))}_endAddress(){return new _$jsbn_51.BigInteger(this.mask()+"1".repeat(constants6.BITS-this.subnetMask),2)}endAddress(){return Address6.fromBigInteger(this._endAddress())}endAddressExclusive(){const e=new _$jsbn_51.BigInteger("1");return Address6.fromBigInteger(this._endAddress().subtract(e))}getScope(){let e=constants6.SCOPES[this.getBits(12,16).intValue()];return this.getType()==="Global unicast"&&e!=="Link local"&&(e="Global"),e||"Unknown"}getType(){for(const e of Object.keys(constants6.TYPES))if(this.isInSubnet(new Address6(e)))return constants6.TYPES[e];return"Global unicast"}getBits(e,n){return new _$jsbn_51.BigInteger(this.getBitsBase2(e,n),2)}getBitsBase2(e,n){return this.binaryZeroPad().slice(e,n)}getBitsBase16(e,n){const r=n-e;if(r%4!=0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(e,n).toString(16).padStart(r/4,"0")}getBitsPastSubnet(){return this.getBitsBase2(this.subnetMask,constants6.BITS)}reverseForm(e){e||(e={});const n=Math.floor(this.subnetMask/4),r=this.canonicalForm().replace(/:/g,"").split("").slice(0,n).reverse().join(".");return n>0?e.omitSuffix?r:(0,_$sprintf_83.sprintf)("%s.ip6.arpa.",r):e.omitSuffix?"":"ip6.arpa."}correctForm(){let e,n=[],r=0;const o=[];for(e=0;e<this.parsedAddress.length;e++){const h=parseInt(this.parsedAddress[e],16);h===0&&r++,h!==0&&r>0&&(r>1&&o.push([e-r,e-1]),r=0)}r>1&&o.push([this.parsedAddress.length-r,this.parsedAddress.length-1]);const f=o.map(h=>h[1]-h[0]+1);if(o.length>0){const h=f.indexOf(Math.max(...f));n=function(y,F){const S=[],T=[];let U;for(U=0;U<y.length;U++)U<F[0]?S.push(y[U]):U>F[1]&&T.push(y[U]);return S.concat(["compact"]).concat(T)}(this.parsedAddress,o[h])}else n=this.parsedAddress;for(e=0;e<n.length;e++)n[e]!=="compact"&&(n[e]=parseInt(n[e],16).toString(16));let d=n.join(":");return(d=(d=d.replace(/^compact$/,"::")).replace(/^compact|compact$/,":")).replace(/compact/,"")}binaryZeroPad(){return this.bigInteger().toString(2).padStart(constants6.BITS,"0")}parse4in6(e){const n=e.split(":"),r=n.slice(-1)[0].match(constants4.RE_ADDRESS);if(r){this.parsedAddress4=r[0],this.address4=new _$ipv4_14.Address4(this.parsedAddress4);for(let o=0;o<this.address4.groups;o++)if(/^0[0-9]+/.test(this.address4.parsedAddress[o]))throw new _$addressError_11.AddressError("IPv4 addresses can't have leading zeroes.",e.replace(constants4.RE_ADDRESS,this.address4.parsedAddress.map(spanLeadingZeroes4).join(".")));this.v4=!0,n[n.length-1]=this.address4.toGroup6(),e=n.join(":")}return e}parse(e){const n=(e=this.parse4in6(e)).match(constants6.RE_BAD_CHARACTERS);if(n)throw new _$addressError_11.AddressError((0,_$sprintf_83.sprintf)("Bad character%s detected in address: %s",n.length>1?"s":"",n.join("")),e.replace(constants6.RE_BAD_CHARACTERS,'<span class="parse-error">$1</span>'));const r=e.match(constants6.RE_BAD_ADDRESS);if(r)throw new _$addressError_11.AddressError((0,_$sprintf_83.sprintf)("Address failed regex: %s",r.join("")),e.replace(constants6.RE_BAD_ADDRESS,'<span class="parse-error">$1</span>'));let o=[];const f=e.split("::");if(f.length===2){let d=f[0].split(":"),h=f[1].split(":");d.length===1&&d[0]===""&&(d=[]),h.length===1&&h[0]===""&&(h=[]);const y=this.groups-(d.length+h.length);if(!y)throw new _$addressError_11.AddressError("Error parsing groups");this.elidedGroups=y,this.elisionBegin=d.length,this.elisionEnd=d.length+this.elidedGroups,o=o.concat(d);for(let F=0;F<y;F++)o.push("0");o=o.concat(h)}else{if(f.length!==1)throw new _$addressError_11.AddressError("Too many :: groups found");o=e.split(":"),this.elidedGroups=0}if((o=o.map(d=>(0,_$sprintf_83.sprintf)("%x",parseInt(d,16)))).length!==this.groups)throw new _$addressError_11.AddressError("Incorrect number of groups found");return o}canonicalForm(){return this.parsedAddress.map(paddedHex).join(":")}decimal(){return this.parsedAddress.map(e=>(0,_$sprintf_83.sprintf)("%05d",parseInt(e,16))).join(":")}bigInteger(){return new _$jsbn_51.BigInteger(this.parsedAddress.map(paddedHex).join(""),16)}to4(){const e=this.binaryZeroPad().split("");return _$ipv4_14.Address4.fromHex(new _$jsbn_51.BigInteger(e.slice(96,128).join(""),2).toString(16))}to4in6(){const e=this.to4(),n=new Address6(this.parsedAddress.slice(0,6).join(":"),6).correctForm();let r="";return/:$/.test(n)||(r=":"),n+r+e.address}inspectTeredo(){const e=this.getBitsBase16(0,32),n=this.getBits(80,96).xor(new _$jsbn_51.BigInteger("ffff",16)).toString(),r=_$ipv4_14.Address4.fromHex(this.getBitsBase16(32,64)),o=_$ipv4_14.Address4.fromHex(this.getBits(96,128).xor(new _$jsbn_51.BigInteger("ffffffff",16)).toString(16)),f=this.getBits(64,80),d=this.getBitsBase2(64,80),h=f.testBit(15),y=f.testBit(14),F=f.testBit(8),S=f.testBit(9),T=new _$jsbn_51.BigInteger(d.slice(2,6)+d.slice(8,16),2).toString(10);return{prefix:(0,_$sprintf_83.sprintf)("%s:%s",e.slice(0,4),e.slice(4,8)),server4:r.address,client4:o.address,flags:d,coneNat:h,microsoft:{reserved:y,universalLocal:S,groupIndividual:F,nonce:T},udpPort:n}}inspect6to4(){const e=this.getBitsBase16(0,16),n=_$ipv4_14.Address4.fromHex(this.getBitsBase16(16,48));return{prefix:(0,_$sprintf_83.sprintf)("%s",e.slice(0,4)),gateway:n.address}}to6to4(){if(!this.is4())return null;const e=["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":");return new Address6(e)}toByteArray(){const e=this.bigInteger().toByteArray();return e.length===17&&e[0]===0?e.slice(1):e}toUnsignedByteArray(){return this.toByteArray().map(unsignByte)}static fromByteArray(e){return this.fromUnsignedByteArray(e.map(unsignByte))}static fromUnsignedByteArray(e){const n=new _$jsbn_51.BigInteger("256",10);let r=new _$jsbn_51.BigInteger("0",10),o=new _$jsbn_51.BigInteger("1",10);for(let f=e.length-1;f>=0;f--)r=r.add(o.multiply(new _$jsbn_51.BigInteger(e[f].toString(10),10))),o=o.multiply(n);return Address6.fromBigInteger(r)}isCanonical(){return this.addressMinusSuffix===this.canonicalForm()}isLinkLocal(){return this.getBitsBase2(0,64)==="1111111010000000000000000000000000000000000000000000000000000000"}isMulticast(){return this.getType()==="Multicast"}is4(){return this.v4}isTeredo(){return this.isInSubnet(new Address6("2001::/32"))}is6to4(){return this.isInSubnet(new Address6("2002::/16"))}isLoopback(){return this.getType()==="Loopback"}href(e){return e=e===void 0?"":(0,_$sprintf_83.sprintf)(":%s",e),(0,_$sprintf_83.sprintf)("http://[%s]%s/",this.correctForm(),e)}link(e){e||(e={}),e.className===void 0&&(e.className=""),e.prefix===void 0&&(e.prefix="/#address="),e.v4===void 0&&(e.v4=!1);let n=this.correctForm;return e.v4&&(n=this.to4in6),e.className?(0,_$sprintf_83.sprintf)('<a href="%1$s%2$s" class="%3$s">%2$s</a>',e.prefix,n.call(this),e.className):(0,_$sprintf_83.sprintf)('<a href="%1$s%2$s">%2$s</a>',e.prefix,n.call(this))}group(){if(this.elidedGroups===0)return helpers.simpleGroup(this.address).join(":");const e=[],[n,r]=this.address.split("::");n.length?e.push(...helpers.simpleGroup(n)):e.push("");const o=["hover-group"];for(let f=this.elisionBegin;f<this.elisionBegin+this.elidedGroups;f++)o.push((0,_$sprintf_83.sprintf)("group-%d",f));return e.push((0,_$sprintf_83.sprintf)('<span class="%s"></span>',o.join(" "))),r.length?e.push(...helpers.simpleGroup(r,this.elisionEnd)):e.push(""),this.is4()&&(e.pop(),e.push(this.address4.groupForV6())),e.join(":")}regularExpressionString(e=!1){let n=[];const r=new Address6(this.correctForm());if(r.elidedGroups===0)n.push((0,_$regularExpressions_19.simpleRegularExpression)(r.parsedAddress));else if(r.elidedGroups===constants6.GROUPS)n.push((0,_$regularExpressions_19.possibleElisions)(constants6.GROUPS));else{const o=r.address.split("::");o[0].length&&n.push((0,_$regularExpressions_19.simpleRegularExpression)(o[0].split(":"))),n.push((0,_$regularExpressions_19.possibleElisions)(r.elidedGroups,o[0].length!==0,o[1].length!==0)),o[1].length&&n.push((0,_$regularExpressions_19.simpleRegularExpression)(o[1].split(":"))),n=[n.join(":")]}return e||(n=["(?=^|",_$regularExpressions_19.ADDRESS_BOUNDARY,"|[^\\w\\:])(",...n,")(?=[^\\w\\:]|",_$regularExpressions_19.ADDRESS_BOUNDARY,"|$)"]),n.join("")}regularExpression(e=!1){return new RegExp(this.regularExpressionString(e),"i")}}_$ipv6_15.Address6=Address6;var _$ipAddress_13={},____createBinding_13=this&&this.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&("get"in o?e.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),____setModuleDefault_13=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),____importStar_13=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&____createBinding_13(e,t,n);return ____setModuleDefault_13(e,t),e};Object.defineProperty(_$ipAddress_13,"__esModule",{value:!0}),_$ipAddress_13.v6=_$ipAddress_13.AddressError=_$ipAddress_13.Address6=_$ipAddress_13.Address4=void 0,Object.defineProperty(_$ipAddress_13,"Address4",{enumerable:!0,get:function(){return _$ipv4_14.Address4}}),Object.defineProperty(_$ipAddress_13,"Address6",{enumerable:!0,get:function(){return _$ipv6_15.Address6}}),Object.defineProperty(_$ipAddress_13,"AddressError",{enumerable:!0,get:function(){return _$addressError_11.AddressError}});const __helpers_13=____importStar_13(_$helpers_18);_$ipAddress_13.v6={helpers:__helpers_13};var _$utils_141={};function ___typeof_141(t){return(___typeof_141=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$utils_141,"__esModule",{value:!0}),_$utils_141.getIfNotBlank=function(t,e){return isNotBlank(t)?t:e},_$utils_141.getIfPresent=function(t,e){return isPresent(t)?t:e},_$utils_141.getPolicyDescriptor=function(t){return t?/^.+?\s*?=\s*?.+?\s*?,.+?/.test(t)?{"policy-descriptor":t}:{policy:t}:{}},_$utils_141.getRandomPort=function(t){var e,n=t.split(/,|\//),r=n[Math.floor(Math.random()*n.length)];if(r.includes("-")){var o=function(f){if(Array.isArray(f))return f}(e=r.split("-").map(Number))||function(f,d){var h=f==null?null:typeof Symbol<"u"&&f[Symbol.iterator]||f["@@iterator"];if(h!=null){var y,F,S=[],T=!0,U=!1;try{for(h=h.call(f);!(T=(y=h.next()).done)&&(S.push(y.value),S.length!==2);T=!0);}catch(M){U=!0,F=M}finally{try{T||h.return==null||h.return()}finally{if(U)throw F}}return S}}(e)||function(f,d){if(f){if(typeof f=="string")return ___arrayLikeToArray_141(f,2);var h=Object.prototype.toString.call(f).slice(8,-1);return h==="Object"&&f.constructor&&(h=f.constructor.name),h==="Map"||h==="Set"?Array.from(f):h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h)?___arrayLikeToArray_141(f,2):void 0}}(e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}();return function(f,d){return f=Math.ceil(f),d=Math.floor(d),Math.floor(Math.random()*(d-f+1))+f}(o[0],o[1])}return Number(r)},_$utils_141.ipAddress=void 0,_$utils_141.isIPv4=function(t){return IPV4_REGEX.test(t)},_$utils_141.isIPv6=function(t){return IPV6_REGEX.test(t)},_$utils_141.isNotBlank=isNotBlank,_$utils_141.isPresent=isPresent,_$utils_141.isValidPortNumber=function(t){return/^((6553[0-5])|(655[0-2][0-9])|(65[0-4][0-9]{2})|(6[0-4][0-9]{3})|([1-5][0-9]{4})|([0-5]{0,5})|([0-9]{1,4}))$/.test(t)},_$utils_141.numberToString=function(t){return Number.isSafeInteger(t)?String(t):BigInt(t).toString()};var ipAddress=function(t,e){if(t&&t.__esModule)return t;if(t===null||___typeof_141(t)!=="object"&&typeof t!="function")return{default:t};var n=_getRequireWildcardCache(void 0);if(n&&n.has(t))return n.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var d=o?Object.getOwnPropertyDescriptor(t,f):null;d&&(d.get||d.set)?Object.defineProperty(r,f,d):r[f]=t[f]}return r.default=t,n&&n.set(t,r),r}(_$ipAddress_13);function _getRequireWildcardCache(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(r){return r?n:e})(t)}function ___arrayLikeToArray_141(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}_$utils_141.ipAddress=ipAddress;var IPV4_REGEX=/^((25[0-5]|(2[0-4]|1\d|[1-9]|)\d)(\.(?!$)|$)){4}$/,IPV6_REGEX=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/;function isNotBlank(t){return typeof t=="string"&&t.trim().length>0}function isPresent(t){return t!=null}var _$resourceCache_144={};Object.defineProperty(_$resourceCache_144,"__esModule",{value:!0}),_$resourceCache_144.default=void 0;var __obj_144,___app_144=(__obj_144=_$app_87)&&__obj_144.__esModule?__obj_144:{default:__obj_144};function _slicedToArray(t,e){return function(n){if(Array.isArray(n))return n}(t)||function(n,r){var o=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(o!=null){var f,d,h=[],y=!0,F=!1;try{for(o=o.call(n);!(y=(f=o.next()).done)&&(h.push(f.value),!r||h.length!==r);y=!0);}catch(S){F=!0,d=S}finally{try{y||o.return==null||o.return()}finally{if(F)throw d}}return h}}(t,e)||function(n,r){if(n){if(typeof n=="string")return ___arrayLikeToArray_144(n,r);var o=Object.prototype.toString.call(n).slice(8,-1);return o==="Object"&&n.constructor&&(o=n.constructor.name),o==="Map"||o==="Set"?Array.from(n):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?___arrayLikeToArray_144(n,r):void 0}}(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ___arrayLikeToArray_144(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ___defineProperties_144(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ___default_144=new(function(){function t(r){(function(f,d){if(!(f instanceof d))throw new TypeError("Cannot call a class as a function")})(this,t),this.expires=r,___app_144.default.read(_$constants_86.RESOURCE_CACHE_KEY)||___app_144.default.write("{}",_$constants_86.RESOURCE_CACHE_KEY);try{this.resourceCache=JSON.parse(___app_144.default.read(_$constants_86.RESOURCE_CACHE_KEY))}catch(f){var o;___app_144.default.error("\u89E3\u6790\u6301\u4E45\u5316\u7F13\u5B58\u4E2D\u7684 ".concat(_$constants_86.RESOURCE_CACHE_KEY," \u5931\u8D25, \u91CD\u7F6E\u4E3A {}, \u9519\u8BEF: ").concat((o=f?.message)!==null&&o!==void 0?o:f)),this.resourceCache={},___app_144.default.write("{}",_$constants_86.RESOURCE_CACHE_KEY)}this._cleanup()}var e,n;return e=t,(n=[{key:"_cleanup",value:function(){var r=this,o=!1;Object.entries(this.resourceCache).forEach(function(f){var d=_slicedToArray(f,2),h=d[0],y=d[1];y.time||(delete r.resourceCache[h],___app_144.default.delete("#".concat(h)),o=!0),new Date().getTime()-y.time>r.expires&&(delete r.resourceCache[h],o=!0)}),o&&this._persist()}},{key:"revokeAll",value:function(){this.resourceCache={},this._persist()}},{key:"_persist",value:function(){___app_144.default.write(JSON.stringify(this.resourceCache),_$constants_86.RESOURCE_CACHE_KEY)}},{key:"get",value:function(r){var o=this.resourceCache[r]&&this.resourceCache[r].time;return o&&new Date().getTime()-o<=this.expires?this.resourceCache[r].data:null}},{key:"set",value:function(r,o){this.resourceCache[r]={time:new Date().getTime(),data:o},this._persist()}}])&&___defineProperties_144(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}())(_$constants_86.CACHE_EXPIRATION_TIME_MS);_$resourceCache_144.default=___default_144;var _$headersResourceCache_140={};Object.defineProperty(_$headersResourceCache_140,"__esModule",{value:!0}),_$headersResourceCache_140.default=void 0;var __obj_140,___app_140=(__obj_140=_$app_87)&&__obj_140.__esModule?__obj_140:{default:__obj_140};function ___slicedToArray_140(t,e){return function(n){if(Array.isArray(n))return n}(t)||function(n,r){var o=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(o!=null){var f,d,h=[],y=!0,F=!1;try{for(o=o.call(n);!(y=(f=o.next()).done)&&(h.push(f.value),!r||h.length!==r);y=!0);}catch(S){F=!0,d=S}finally{try{y||o.return==null||o.return()}finally{if(F)throw d}}return h}}(t,e)||function(n,r){if(n){if(typeof n=="string")return ___arrayLikeToArray_140(n,r);var o=Object.prototype.toString.call(n).slice(8,-1);return o==="Object"&&n.constructor&&(o=n.constructor.name),o==="Map"||o==="Set"?Array.from(n):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?___arrayLikeToArray_140(n,r):void 0}}(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ___arrayLikeToArray_140(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ___defineProperties_140(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ___default_140=new(function(){function t(){(function(o,f){if(!(o instanceof f))throw new TypeError("Cannot call a class as a function")})(this,t),this.expires=function(){___app_140.default.read(_$constants_86.CHR_EXPIRATION_TIME_KEY)||___app_140.default.write("6e4",_$constants_86.CHR_EXPIRATION_TIME_KEY);var o=6e4;if(___app_140.default.env.isLoon){var f={"1\u5206\u949F":6e4,"5\u5206\u949F":3e5,"10\u5206\u949F":6e5,"30\u5206\u949F":18e5,"1\u5C0F\u65F6":36e5,"2\u5C0F\u65F6":72e5,"3\u5C0F\u65F6":108e5,"6\u5C0F\u65F6":216e5,"12\u5C0F\u65F6":432e5,"24\u5C0F\u65F6":864e5,"48\u5C0F\u65F6":1728e5,"72\u5C0F\u65F6":2592e5,\u53C2\u6570\u4F20\u5165:"readcachets"},d=___app_140.default.read("#\u54CD\u5E94\u5934\u7F13\u5B58\u6709\u6548\u671F");return d in f&&(o=f[d])==="readcachets"&&(o=d),o}return ___app_140.default.read(_$constants_86.CHR_EXPIRATION_TIME_KEY)}(),___app_140.default.read(_$constants_86.HEADERS_RESOURCE_CACHE_KEY)||___app_140.default.write("{}",_$constants_86.HEADERS_RESOURCE_CACHE_KEY);try{this.resourceCache=JSON.parse(___app_140.default.read(_$constants_86.HEADERS_RESOURCE_CACHE_KEY))}catch(o){var r;___app_140.default.error("\u89E3\u6790\u6301\u4E45\u5316\u7F13\u5B58\u4E2D\u7684 ".concat(_$constants_86.HEADERS_RESOURCE_CACHE_KEY," \u5931\u8D25, \u91CD\u7F6E\u4E3A {}, \u9519\u8BEF: ").concat((r=o?.message)!==null&&r!==void 0?r:o)),this.resourceCache={},___app_140.default.write("{}",_$constants_86.HEADERS_RESOURCE_CACHE_KEY)}this._cleanup()}var e,n;return e=t,(n=[{key:"_cleanup",value:function(){var r=this,o=!1;Object.entries(this.resourceCache).forEach(function(f){var d=___slicedToArray_140(f,2),h=d[0],y=d[1];y.time||(delete r.resourceCache[h],___app_140.default.delete("#".concat(h)),o=!0),new Date().getTime()-y.time>r.expires&&(delete r.resourceCache[h],o=!0)}),o&&this._persist()}},{key:"revokeAll",value:function(){this.resourceCache={},this._persist()}},{key:"_persist",value:function(){___app_140.default.write(JSON.stringify(this.resourceCache),_$constants_86.HEADERS_RESOURCE_CACHE_KEY)}},{key:"get",value:function(r){var o=this.resourceCache[r]&&this.resourceCache[r].time;return o&&new Date().getTime()-o<=this.expires?this.resourceCache[r].data:null}},{key:"gettime",value:function(r){var o=this.resourceCache[r]&&this.resourceCache[r].time;return o&&new Date().getTime()-o<=this.expires?this.resourceCache[r].time:null}},{key:"set",value:function(r,o){this.resourceCache[r]={time:new Date().getTime(),data:o},this._persist()}}])&&___defineProperties_140(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());_$headersResourceCache_140.default=___default_140;var _$flow_137={};Object.defineProperty(_$flow_137,"__esModule",{value:!0}),_$flow_137.flowTransfer=flowTransfer,_$flow_137.getFlowField=getFlowField,_$flow_137.getFlowHeaders=getFlowHeaders,_$flow_137.getRmainingDays=getRmainingDays,_$flow_137.parseFlowHeaders=parseFlowHeaders,_$flow_137.validCheck=validCheck;var ___app_137=_interopRequireDefault(_$app_87),_headersResourceCache=_interopRequireDefault(_$headersResourceCache_140);function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function ___regeneratorRuntime_137(){___regeneratorRuntime_137=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=typeof Symbol=="function"?Symbol:{},o=r.iterator||"@@iterator",f=r.asyncIterator||"@@asyncIterator",d=r.toStringTag||"@@toStringTag";function h(l,s,v){return Object.defineProperty(l,s,{value:v,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,v,$){return s[v]=$}}function y(l,s,v,$){var E=s&&s.prototype instanceof T?s:T,rt=Object.create(E.prototype),gt=new dt($||[]);return rt._invoke=function(Et,Ct,x){var N="suspendedStart";return function(G,A){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(G==="throw")throw A;return{value:void 0,done:!0}}for(x.method=G,x.arg=A;;){var C=x.delegate;if(C){var j=et(C,x);if(j){if(j===S)continue;return j}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var K=F(Et,Ct,x);if(K.type==="normal"){if(N=x.done?"completed":"suspendedYield",K.arg===S)continue;return{value:K.arg,done:x.done}}K.type==="throw"&&(N="completed",x.method="throw",x.arg=K.arg)}}}(l,v,gt),rt}function F(l,s,v){try{return{type:"normal",arg:l.call(s,v)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var S={};function T(){}function U(){}function M(){}var Y={};h(Y,o,function(){return this});var Z=Object.getPrototypeOf,D=Z&&Z(Z(ht([])));D&&D!==e&&n.call(D,o)&&(Y=D);var nt=M.prototype=T.prototype=Object.create(Y);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(v){return this._invoke(s,v)})})}function at(l,s){var v;this._invoke=function($,E){function rt(){return new s(function(gt,Et){(function Ct(x,N,G,A){var C=F(l[x],l,N);if(C.type!=="throw"){var j=C.arg,K=j.value;return K&&___typeof_137(K)=="object"&&n.call(K,"__await")?s.resolve(K.__await).then(function(J){Ct("next",J,G,A)},function(J){Ct("throw",J,G,A)}):s.resolve(K).then(function(J){j.value=J,G(j)},function(J){return Ct("throw",J,G,A)})}A(C.arg)})($,E,gt,Et)})}return v=v?v.then(rt,rt):rt()}}function et(l,s){var v=l.iterator[s.method];if(v===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,et(l,s),s.method==="throw"))return S;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var $=F(v,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,S;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,S):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,S)}function mt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function At(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function dt(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(mt,this),this.reset(!0)}function ht(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var v=-1,$=function E(){for(;++v<l.length;)if(n.call(l,v))return E.value=l[v],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:xt}}function xt(){return{value:void 0,done:!0}}return U.prototype=M,h(nt,"constructor",M),h(M,"constructor",U),U.displayName=h(M,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===U||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,M):(l.__proto__=M,h(l,d,"GeneratorFunction")),l.prototype=Object.create(nt),l},t.awrap=function(l){return{__await:l}},ct(at.prototype),h(at.prototype,f,function(){return this}),t.AsyncIterator=at,t.async=function(l,s,v,$,E){E===void 0&&(E=Promise);var rt=new at(y(l,s,v,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(gt){return gt.done?gt.value:rt.next()})},ct(nt),h(nt,d,"Generator"),h(nt,o,function(){return this}),h(nt,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var v in l)s.push(v);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=ht,dt.prototype={constructor:dt,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(At),!l)for(var s in this)s.charAt(0)==="t"&&n.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function v(Ct,x){return rt.type="throw",rt.arg=l,s.next=Ct,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return v("end");if(E.tryLoc<=this.prev){var gt=n.call(E,"catchLoc"),Et=n.call(E,"finallyLoc");if(gt&&Et){if(this.prev<E.catchLoc)return v(E.catchLoc,!0);if(this.prev<E.finallyLoc)return v(E.finallyLoc)}else if(gt){if(this.prev<E.catchLoc)return v(E.catchLoc,!0)}else{if(!Et)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return v(E.finallyLoc)}}}},abrupt:function(l,s){for(var v=this.tryEntries.length-1;v>=0;--v){var $=this.tryEntries[v];if($.tryLoc<=this.prev&&n.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,S):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),S},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.finallyLoc===l)return this.complete(v.completion,v.afterLoc),At(v),S}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.tryLoc===l){var $=v.completion;if($.type==="throw"){var E=$.arg;At(v)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,v){return this.delegate={iterator:ht(l),resultName:s,nextLoc:v},this.method==="next"&&(this.arg=void 0),S}},t}function __ownKeys_137(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function ___objectSpread_137(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_137(Object(n),!0).forEach(function(r){___defineProperty_137(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):__ownKeys_137(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ___defineProperty_137(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _createForOfIteratorHelper(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=_unsupportedIterableToArray(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){n=n.call(t)},n:function(){var y=n.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||n.return==null||n.return()}finally{if(h)throw f}}}}function _unsupportedIterableToArray(t,e){if(t){if(typeof t=="string")return ___arrayLikeToArray_137(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?___arrayLikeToArray_137(t,e):void 0}}function ___arrayLikeToArray_137(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ___typeof_137(t){return(___typeof_137=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function __asyncGeneratorStep_137(t,e,n,r,o,f,d){try{var h=t[f](d),y=h.value}catch(F){return void n(F)}h.done?e(y):Promise.resolve(y).then(r,o)}function ___asyncToGenerator_137(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var f=t.apply(e,n);function d(y){__asyncGeneratorStep_137(f,r,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_137(f,r,o,d,h,"throw",y)}d(void 0)})}}function getFlowField(t){for(var e="",n="",r=0,o=Object.keys(t);r<o.length;r++){var f=o[r],d=f.toLowerCase();d==="subscription-userinfo"?e=t[f]:d==="profile-web-page-url"&&(n=t[f])}return"".concat(e||"").concat(n?"; app_url=".concat(encodeURIComponent(n)):"")}function getFlowHeaders(t,e,n,r,o){return _getFlowHeaders.apply(this,arguments)}function _getFlowHeaders(){return _getFlowHeaders=___asyncToGenerator_137(___regeneratorRuntime_137().mark(function _callee(rawUrl,ua,timeout,customProxy,flowUrl){var _$arguments,_$arguments2,_$arguments3,url,$arguments,rawArgs,_iterator,_step,pair,key,value,_ENV,isStash,isLoon,isShadowRocket,isQX,insecure,_$$read,defaultProxy,defaultFlowUserAgent,defaultTimeout,proxy,userAgent,requestTimeout,id,cached,flowInfo,http,_yield$http$get,body,_yield$http$head,headers,_e$message2,_yield$http$get2,_headers;return ___regeneratorRuntime_137().wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(url=flowUrl||rawUrl||"",$arguments={},rawArgs=url.split("#"),url=url.split("#")[0],rawArgs.length>1)try{$arguments=JSON.parse(decodeURIComponent(rawArgs[1]))}catch{_iterator=_createForOfIteratorHelper(rawArgs[1].split("&"));try{for(_iterator.s();!(_step=_iterator.n()).done;)pair=_step.value,key=pair.split("=")[0],value=pair.split("=")[1],$arguments[key]=value==null||value===""||decodeURIComponent(value)}catch(e){_iterator.e(e)}finally{_iterator.f()}}if((_$arguments=$arguments)===null||_$arguments===void 0||!_$arguments.noFlow){_context.next=7;break}return _context.abrupt("return");case 7:if(_ENV=(0,_$openApi_151.ENV)(),isStash=_ENV.isStash,isLoon=_ENV.isLoon,isShadowRocket=_ENV.isShadowRocket,isQX=_ENV.isQX,insecure=(_$arguments2=$arguments)!==null&&_$arguments2!==void 0&&_$arguments2.insecure?___app_137.default.env.isNode?{strictSSL:!1}:{insecure:!0}:void 0,_$$read=___app_137.default.read(_$constants_86.SETTINGS_KEY),defaultProxy=_$$read.defaultProxy,defaultFlowUserAgent=_$$read.defaultFlowUserAgent,defaultTimeout=_$$read.defaultTimeout,proxy=customProxy||defaultProxy,___app_137.default.env.isNode&&(proxy=proxy||eval("process.env.SUB_STORE_BACKEND_DEFAULT_PROXY")),userAgent=ua||defaultFlowUserAgent||"clash",requestTimeout=timeout||defaultTimeout||8e3,id=(0,_$md5_150.hex_md5)(userAgent+url),cached=_headersResourceCache.default.get(id),(_$arguments3=$arguments)!==null&&_$arguments3!==void 0&&_$arguments3.noCache||!cached){_context.next=21;break}___app_137.default.info("\u4F7F\u7528\u7F13\u5B58\u7684\u6D41\u91CF\u4FE1\u606F: ".concat(url,", ").concat(userAgent)),flowInfo=cached,_context.next=52;break;case 21:if(http=(0,_$openApi_151.HTTP)(),!flowUrl){_context.next=31;break}return ___app_137.default.info("\u4F7F\u7528 GET \u65B9\u6CD5\u4ECE\u54CD\u5E94\u4F53\u83B7\u53D6\u6D41\u91CF\u4FE1\u606F: ".concat(flowUrl,", User-Agent: ").concat(userAgent||"",", Insecure: ").concat(!!insecure,", Proxy: ").concat(proxy)),_context.next=26,http.get(___objectSpread_137(___objectSpread_137(___objectSpread_137(___objectSpread_137(___objectSpread_137({url:flowUrl,headers:{"User-Agent":userAgent},timeout:requestTimeout},proxy?{proxy}:{}),isLoon&&proxy?{node:proxy}:{}),isQX&&proxy?{opts:{policy:proxy}}:{}),proxy?(0,_$utils_141.getPolicyDescriptor)(proxy):{}),insecure||{}));case 26:_yield$http$get=_context.sent,body=_yield$http$get.body,flowInfo=body,_context.next=50;break;case 31:return _context.prev=31,___app_137.default.info("\u4F7F\u7528 HEAD \u65B9\u6CD5\u4ECE\u54CD\u5E94\u5934\u83B7\u53D6\u6D41\u91CF\u4FE1\u606F: ".concat(url,", User-Agent: ").concat(userAgent||"",", Insecure: ").concat(!!insecure,", Proxy: ").concat(proxy)),_context.next=35,http.head(___objectSpread_137(___objectSpread_137(___objectSpread_137(___objectSpread_137(___objectSpread_137({url:url.split(/[\r\n]+/).map(function(t){return t.trim()}).filter(function(t){return t.length})[0],headers:___objectSpread_137(___objectSpread_137({"User-Agent":userAgent},isStash&&proxy?{"X-Stash-Selected-Proxy":encodeURIComponent(proxy)}:{}),isShadowRocket&&proxy?{"X-Surge-Policy":proxy}:{}),timeout:requestTimeout},proxy?{proxy}:{}),isLoon&&proxy?{node:proxy}:{}),isQX&&proxy?{opts:{policy:proxy}}:{}),proxy?(0,_$utils_141.getPolicyDescriptor)(proxy):{}),insecure||{}));case 35:_yield$http$head=_context.sent,headers=_yield$http$head.headers,flowInfo=getFlowField(headers),_context.next=43;break;case 40:_context.prev=40,_context.t0=_context.catch(31),___app_137.default.error("\u4F7F\u7528 HEAD \u65B9\u6CD5\u4ECE\u54CD\u5E94\u5934\u83B7\u53D6\u6D41\u91CF\u4FE1\u606F\u5931\u8D25: ".concat(url,", User-Agent: ").concat(userAgent||"",", Insecure: ").concat(!!insecure,", Proxy: ").concat(proxy,": ").concat((_e$message2=_context.t0.message)!==null&&_e$message2!==void 0?_e$message2:_context.t0));case 43:if(flowInfo){_context.next=50;break}return ___app_137.default.info("\u4F7F\u7528 GET \u65B9\u6CD5\u83B7\u53D6\u6D41\u91CF\u4FE1\u606F: ".concat(url,", User-Agent: ").concat(userAgent||"",", Insecure: ").concat(!!insecure,", Proxy: ").concat(proxy)),_context.next=47,http.get(___objectSpread_137(___objectSpread_137(___objectSpread_137(___objectSpread_137(___objectSpread_137({url:url.split(/[\r\n]+/).map(function(t){return t.trim()}).filter(function(t){return t.length})[0],headers:___objectSpread_137(___objectSpread_137({"User-Agent":userAgent},isStash&&proxy?{"X-Stash-Selected-Proxy":encodeURIComponent(proxy)}:{}),isShadowRocket&&proxy?{"X-Surge-Policy":proxy}:{}),timeout:requestTimeout},proxy?{proxy}:{}),isLoon&&proxy?{node:proxy}:{}),isQX&&proxy?{opts:{policy:proxy}}:{}),proxy?(0,_$utils_141.getPolicyDescriptor)(proxy):{}),insecure||{}));case 47:_yield$http$get2=_context.sent,_headers=_yield$http$get2.headers,flowInfo=getFlowField(_headers);case 50:flowInfo&&(flowInfo=flowInfo.trim()),flowInfo&&_headersResourceCache.default.set(id,flowInfo);case 52:return _context.abrupt("return",flowInfo);case 53:case"end":return _context.stop()}},_callee,null,[[31,40]])})),_getFlowHeaders.apply(this,arguments)}function parseFlowHeaders(t){if(t){var e=t.match(/upload=([-+]?)([0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)/),n=Number(e[1]+e[2]),r=t.match(/download=([-+]?)([0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)/),o=Number(r[1]+r[2]),f=t.match(/total=([-+]?)([0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)/),d=Number(f[1]+f[2]),h=t.match(/expire=([-+]?)([0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)/),y=h?Number(h[1]+h[2]):void 0,F=t.match(/reset_day=([0-9]+)/),S=F?Number(F[1]):void 0,T=t.match(/app_url=(.*?)\s*?(;|$)/),U=T?decodeURIComponent(T[1]):void 0,M=t.match(/plan_name=(.*?)\s*?(;|$)/);return{expires:y,total:d,usage:{upload:n,download:o},remainingDays:S,appUrl:U,planName:M?decodeURIComponent(M[1]):void 0}}}function flowTransfer(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"B",n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],r=n.indexOf(e);return t<1024||r===n.length-1?{value:t.toFixed(1),unit:e}:flowTransfer(t/1024,n[++r])}function validCheck(t){if(!t)throw new Error("\u6CA1\u6709\u6D41\u91CF\u4FE1\u606F");if(t!=null&&t.expires&&1e3*t.expires<Date.now()){var e=new Date(1e3*t.expires).toLocaleDateString();throw new Error("\u8BA2\u9605\u5DF2\u8FC7\u671F: ".concat(e))}if(t!=null&&t.total){var n,r,o=((n=t.usage)===null||n===void 0?void 0:n.upload)||0,f=((r=t.usage)===null||r===void 0?void 0:r.download)||0;if(t.total-o-f<0){var d=o+f,h=flowTransfer(Math.abs(d));h.value=d<0?"-"+h.value:h.value;var y=flowTransfer(t.total);throw new Error("\u6D41\u91CF\u5DF2\u7528\u5B8C: ".concat(h.value," ").concat(h.unit," / ").concat(y.value," ").concat(y.unit))}}}function getRmainingDays(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};try{var e=t.resetDay,n=t.startDate,r=t.cycleDays;if(["string","number"].includes(___typeof_137(t))&&(e=t),n&&r){if(r=parseInt(r),isNaN(r)||r<=0)throw new Error("\u91CD\u7F6E\u5468\u671F\u5E94\u4E3A\u6B63\u6574\u6570");if(!n||!Date.parse(n))throw new Error("\u5F00\u59CB\u65E5\u671F\u4E0D\u5408\u6CD5");var o=new Date(n),f=new Date;if(o.setHours(0,0,0,0),f.setHours(0,0,0,0),o.getTime()>f.getTime())throw new Error("\u5F00\u59CB\u65E5\u671F\u5E94\u65E9\u4E8E\u73B0\u5728");var d=new Date(n);for(d.setDate(d.getDate()+r);d<f;)d.setDate(d.getDate()+r);d.setHours(0,0,0,0);var h=d.getTime()-f.getTime();return Math.ceil(h/864e5)}if(!e)return;if(e=parseInt(e),isNaN(e)||e<=0||e>31)throw new Error("\u6708\u91CD\u7F6E\u65E5\u5E94\u4E3A 1-31 \u4E4B\u95F4\u7684\u6574\u6570");var y=new Date,F=y.getDate(),S=y.getMonth(),T=y.getFullYear();return(e>F?0:new Date(T,S+1,0).getDate())-F+e}catch(M){var U;___app_137.default.error("getRmainingDays failed: ".concat((U=M.message)!==null&&U!==void 0?U:M))}}var _$common_23={};function isNothing(t){return t==null}_$common_23.isNothing=isNothing,_$common_23.isObject=function(t){return typeof t=="object"&&t!==null},_$common_23.toArray=function(t){return Array.isArray(t)?t:isNothing(t)?[]:[t]},_$common_23.repeat=function(t,e){var n,r="";for(n=0;n<e;n+=1)r+=t;return r},_$common_23.isNegativeZero=function(t){return t===0&&Number.NEGATIVE_INFINITY===1/t},_$common_23.extend=function(t,e){var n,r,o,f;if(e)for(n=0,r=(f=Object.keys(e)).length;n<r;n+=1)t[o=f[n]]=e[o];return t};var _$exception_25={};function YAMLException(t,e){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=e,this.message=(this.reason||"(unknown reason)")+(this.mark?" "+this.mark.toString():""),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}YAMLException.prototype=Object.create(Error.prototype),YAMLException.prototype.constructor=YAMLException,YAMLException.prototype.toString=function(t){var e=this.name+": ";return e+=this.reason||"(unknown reason)",!t&&this.mark&&(e+=" "+this.mark.toString()),e},_$exception_25=YAMLException;var _$mark_27={};function Mark(t,e,n,r,o){this.name=t,this.buffer=e,this.position=n,this.line=r,this.column=o}Mark.prototype.getSnippet=function(t,e){var n,r,o,f,d;if(!this.buffer)return null;for(t=t||4,e=e||75,n="",r=this.position;r>0&&`\0\r
\x85\u2028\u2029`.indexOf(this.buffer.charAt(r-1))===-1;)if(r-=1,this.position-r>e/2-1){n=" ... ",r+=5;break}for(o="",f=this.position;f<this.buffer.length&&`\0\r
\x85\u2028\u2029`.indexOf(this.buffer.charAt(f))===-1;)if((f+=1)-this.position>e/2-1){o=" ... ",f-=5;break}return d=this.buffer.slice(r,f),_$common_23.repeat(" ",t)+n+d+o+`
`+_$common_23.repeat(" ",t+this.position-r+n.length)+"^"},Mark.prototype.toString=function(t){var e,n="";return this.name&&(n+='in "'+this.name+'" '),n+="at line "+(this.line+1)+", column "+(this.column+1),t||(e=this.getSnippet())&&(n+=`:
`+e),n},_$mark_27=Mark;var TYPE_CONSTRUCTOR_OPTIONS=["kind","resolve","construct","instanceOf","predicate","represent","defaultStyle","styleAliases"],YAML_NODE_KINDS=["scalar","sequence","mapping"],_$type_34=function(t,e){var n,r;if(e=e||{},Object.keys(e).forEach(function(o){if(TYPE_CONSTRUCTOR_OPTIONS.indexOf(o)===-1)throw new _$exception_25('Unknown option "'+o+'" is met in definition of "'+t+'" YAML type.')}),this.tag=t,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(o){return o},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.defaultStyle=e.defaultStyle||null,this.styleAliases=(n=e.styleAliases||null,r={},n!==null&&Object.keys(n).forEach(function(o){n[o].forEach(function(f){r[String(f)]=o})}),r),YAML_NODE_KINDS.indexOf(this.kind)===-1)throw new _$exception_25('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')},_$schema_28={};function compileList(t,e,n){var r=[];return t.include.forEach(function(o){n=compileList(o,e,n)}),t[e].forEach(function(o){n.forEach(function(f,d){f.tag===o.tag&&f.kind===o.kind&&r.push(d)}),n.push(o)}),n.filter(function(o,f){return r.indexOf(f)===-1})}function Schema(t){this.include=t.include||[],this.implicit=t.implicit||[],this.explicit=t.explicit||[],this.implicit.forEach(function(e){if(e.loadKind&&e.loadKind!=="scalar")throw new _$exception_25("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.")}),this.compiledImplicit=compileList(this,"implicit",[]),this.compiledExplicit=compileList(this,"explicit",[]),this.compiledTypeMap=function(){var e,n,r={scalar:{},sequence:{},mapping:{},fallback:{}};function o(f){r[f.kind][f.tag]=r.fallback[f.tag]=f}for(e=0,n=arguments.length;e<n;e+=1)arguments[e].forEach(o);return r}(this.compiledImplicit,this.compiledExplicit)}Schema.DEFAULT=null,Schema.create=function(){var t,e;switch(arguments.length){case 1:t=Schema.DEFAULT,e=arguments[0];break;case 2:t=arguments[0],e=arguments[1];break;default:throw new _$exception_25("Wrong number of arguments for Schema.create function")}if(t=_$common_23.toArray(t),e=_$common_23.toArray(e),!t.every(function(n){return n instanceof Schema}))throw new _$exception_25("Specified list of super schemas (or a single Schema object) contains a non-Schema object.");if(!e.every(function(n){return n instanceof _$type_34}))throw new _$exception_25("Specified list of YAML types (or a single Type object) contains a non-Type object.");return new Schema({include:t,explicit:e})},_$schema_28=Schema;var _$str_49=new _$type_34("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return t!==null?t:""}}),_$seq_47=new _$type_34("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return t!==null?t:[]}}),_$map_42=new _$type_34("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return t!==null?t:{}}}),_$failsafe_32=new _$schema_28({explicit:[_$str_49,_$seq_47,_$map_42]}),_$null_44=new _$type_34("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(t){if(t===null)return!0;var e=t.length;return e===1&&t==="~"||e===4&&(t==="null"||t==="Null"||t==="NULL")},construct:function(){return null},predicate:function(t){return t===null},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"}},defaultStyle:"lowercase"}),_$bool_36=new _$type_34("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(t){if(t===null)return!1;var e=t.length;return e===4&&(t==="true"||t==="True"||t==="TRUE")||e===5&&(t==="false"||t==="False"||t==="FALSE")},construct:function(t){return t==="true"||t==="True"||t==="TRUE"},predicate:function(t){return Object.prototype.toString.call(t)==="[object Boolean]"},represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function isOctCode(t){return 48<=t&&t<=55}function isDecCode(t){return 48<=t&&t<=57}var _$int_38=new _$type_34("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(t){if(t===null)return!1;var e,n,r=t.length,o=0,f=!1;if(!r)return!1;if((e=t[o])!=="-"&&e!=="+"||(e=t[++o]),e==="0"){if(o+1===r)return!0;if((e=t[++o])==="b"){for(o++;o<r;o++)if((e=t[o])!=="_"){if(e!=="0"&&e!=="1")return!1;f=!0}return f&&e!=="_"}if(e==="x"){for(o++;o<r;o++)if((e=t[o])!=="_"){if(!(48<=(n=t.charCodeAt(o))&&n<=57||65<=n&&n<=70||97<=n&&n<=102))return!1;f=!0}return f&&e!=="_"}for(;o<r;o++)if((e=t[o])!=="_"){if(!isOctCode(t.charCodeAt(o)))return!1;f=!0}return f&&e!=="_"}if(e==="_")return!1;for(;o<r;o++)if((e=t[o])!=="_"){if(e===":")break;if(!isDecCode(t.charCodeAt(o)))return!1;f=!0}return!(!f||e==="_")&&(e!==":"||/^(:[0-5]?[0-9])+$/.test(t.slice(o)))},construct:function(t){var e,n,r=t,o=1,f=[];return r.indexOf("_")!==-1&&(r=r.replace(/_/g,"")),(e=r[0])!=="-"&&e!=="+"||(e==="-"&&(o=-1),e=(r=r.slice(1))[0]),r==="0"?0:e==="0"?r[1]==="b"?o*parseInt(r.slice(2),2):r[1]==="x"?o*parseInt(r,16):o*parseInt(r,8):r.indexOf(":")!==-1?(r.split(":").forEach(function(d){f.unshift(parseInt(d,10))}),r=0,n=1,f.forEach(function(d){r+=d*n,n*=60}),o*r):o*parseInt(r,10)},predicate:function(t){return Object.prototype.toString.call(t)==="[object Number]"&&t%1==0&&!_$common_23.isNegativeZero(t)},represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0"+t.toString(8):"-0"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),YAML_FLOAT_PATTERN=new RegExp("^(?:[-+]?(?:0|[1-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\.[0-9_]*|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),SCIENTIFIC_WITHOUT_DOT=/^[-+]?[0-9]+e/,_$float_37=new _$type_34("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(t){return t!==null&&!(!YAML_FLOAT_PATTERN.test(t)||t[t.length-1]==="_")},construct:function(t){var e,n,r,o;return n=(e=t.replace(/_/g,"").toLowerCase())[0]==="-"?-1:1,o=[],"+-".indexOf(e[0])>=0&&(e=e.slice(1)),e===".inf"?n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:e===".nan"?NaN:e.indexOf(":")>=0?(e.split(":").forEach(function(f){o.unshift(parseFloat(f,10))}),e=0,r=1,o.forEach(function(f){e+=f*r,r*=60}),n*e):n*parseFloat(e,10)},predicate:function(t){return Object.prototype.toString.call(t)==="[object Number]"&&(t%1!=0||_$common_23.isNegativeZero(t))},represent:function(t,e){var n;if(isNaN(t))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(_$common_23.isNegativeZero(t))return"-0.0";return n=t.toString(10),SCIENTIFIC_WITHOUT_DOT.test(n)?n.replace("e",".e"):n},defaultStyle:"lowercase"}),_$json_33=new _$schema_28({include:[_$failsafe_32],implicit:[_$null_44,_$bool_36,_$int_38,_$float_37]}),_$core_29=new _$schema_28({include:[_$json_33]}),YAML_DATE_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),YAML_TIMESTAMP_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),_$timestamp_50=new _$type_34("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(t){return t!==null&&(YAML_DATE_REGEXP.exec(t)!==null||YAML_TIMESTAMP_REGEXP.exec(t)!==null)},construct:function(t){var e,n,r,o,f,d,h,y,F=0,S=null;if((e=YAML_DATE_REGEXP.exec(t))===null&&(e=YAML_TIMESTAMP_REGEXP.exec(t)),e===null)throw new Error("Date resolve error");if(n=+e[1],r=+e[2]-1,o=+e[3],!e[4])return new Date(Date.UTC(n,r,o));if(f=+e[4],d=+e[5],h=+e[6],e[7]){for(F=e[7].slice(0,3);F.length<3;)F+="0";F=+F}return e[9]&&(S=6e4*(60*+e[10]+ +(e[11]||0)),e[9]==="-"&&(S=-S)),y=new Date(Date.UTC(n,r,o,f,d,h,F)),S&&y.setTime(y.getTime()-S),y},instanceOf:Date,represent:function(t){return t.toISOString()}}),_$merge_43=new _$type_34("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(t){return t==="<<"||t===null}}),NodeBuffer;try{var _require=require;NodeBuffer=_require("buffer").Buffer}catch(t){}var BASE64_MAP=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`,_$binary_35=new _$type_34("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(t){if(t===null)return!1;var e,n,r=0,o=t.length,f=BASE64_MAP;for(n=0;n<o;n++)if(!((e=f.indexOf(t.charAt(n)))>64)){if(e<0)return!1;r+=6}return r%8==0},construct:function(t){var e,n,r=t.replace(/[\r\n=]/g,""),o=r.length,f=BASE64_MAP,d=0,h=[];for(e=0;e<o;e++)e%4==0&&e&&(h.push(d>>16&255),h.push(d>>8&255),h.push(255&d)),d=d<<6|f.indexOf(r.charAt(e));return(n=o%4*6)==0?(h.push(d>>16&255),h.push(d>>8&255),h.push(255&d)):n===18?(h.push(d>>10&255),h.push(d>>2&255)):n===12&&h.push(d>>4&255),NodeBuffer?NodeBuffer.from?NodeBuffer.from(h):new NodeBuffer(h):h},predicate:function(t){return NodeBuffer&&NodeBuffer.isBuffer(t)},represent:function(t){var e,n,r="",o=0,f=t.length,d=BASE64_MAP;for(e=0;e<f;e++)e%3==0&&e&&(r+=d[o>>18&63],r+=d[o>>12&63],r+=d[o>>6&63],r+=d[63&o]),o=(o<<8)+t[e];return(n=f%3)==0?(r+=d[o>>18&63],r+=d[o>>12&63],r+=d[o>>6&63],r+=d[63&o]):n===2?(r+=d[o>>10&63],r+=d[o>>4&63],r+=d[o<<2&63],r+=d[64]):n===1&&(r+=d[o>>2&63],r+=d[o<<4&63],r+=d[64],r+=d[64]),r}}),_hasOwnProperty=Object.prototype.hasOwnProperty,_toString=Object.prototype.toString,_$omap_45=new _$type_34("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(t){if(t===null)return!0;var e,n,r,o,f,d=[],h=t;for(e=0,n=h.length;e<n;e+=1){if(r=h[e],f=!1,_toString.call(r)!=="[object Object]")return!1;for(o in r)if(_hasOwnProperty.call(r,o)){if(f)return!1;f=!0}if(!f||d.indexOf(o)!==-1)return!1;d.push(o)}return!0},construct:function(t){return t!==null?t:[]}}),___toString_46=Object.prototype.toString,_$pairs_46=new _$type_34("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(t){if(t===null)return!0;var e,n,r,o,f,d=t;for(f=new Array(d.length),e=0,n=d.length;e<n;e+=1){if(r=d[e],___toString_46.call(r)!=="[object Object]"||(o=Object.keys(r)).length!==1)return!1;f[e]=[o[0],r[o[0]]]}return!0},construct:function(t){if(t===null)return[];var e,n,r,o,f,d=t;for(f=new Array(d.length),e=0,n=d.length;e<n;e+=1)r=d[e],o=Object.keys(r),f[e]=[o[0],r[o[0]]];return f}}),___hasOwnProperty_48=Object.prototype.hasOwnProperty,_$set_48=new _$type_34("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(t){if(t===null)return!0;var e,n=t;for(e in n)if(___hasOwnProperty_48.call(n,e)&&n[e]!==null)return!1;return!0},construct:function(t){return t!==null?t:{}}}),_$default_safe_31=new _$schema_28({include:[_$core_29],implicit:[_$timestamp_50,_$merge_43],explicit:[_$binary_35,_$omap_45,_$pairs_46,_$set_48]}),_$undefined_41=new _$type_34("tag:yaml.org,2002:js/undefined",{kind:"scalar",resolve:function(){return!0},construct:function(){},predicate:function(t){return t===void 0},represent:function(){return""}}),_$regexp_40=new _$type_34("tag:yaml.org,2002:js/regexp",{kind:"scalar",resolve:function(t){if(t===null||t.length===0)return!1;var e=t,n=/\/([gim]*)$/.exec(t),r="";return!(e[0]==="/"&&(n&&(r=n[1]),r.length>3||e[e.length-r.length-1]!=="/"))},construct:function(t){var e=t,n=/\/([gim]*)$/.exec(t),r="";return e[0]==="/"&&(n&&(r=n[1]),e=e.slice(1,e.length-r.length-1)),new RegExp(e,r)},predicate:function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},represent:function(t){var e="/"+t.source+"/";return t.global&&(e+="g"),t.multiline&&(e+="m"),t.ignoreCase&&(e+="i"),e}}),esprima;try{var ___require_39=require;esprima=___require_39("esprima")}catch(t){typeof window<"u"&&(esprima=window.esprima)}var _$function_39=new _$type_34("tag:yaml.org,2002:js/function",{kind:"scalar",resolve:function(t){if(t===null)return!1;try{var e="("+t+")",n=esprima.parse(e,{range:!0});return n.type==="Program"&&n.body.length===1&&n.body[0].type==="ExpressionStatement"&&(n.body[0].expression.type==="ArrowFunctionExpression"||n.body[0].expression.type==="FunctionExpression")}catch{return!1}},construct:function(t){var e,n="("+t+")",r=esprima.parse(n,{range:!0}),o=[];if(r.type!=="Program"||r.body.length!==1||r.body[0].type!=="ExpressionStatement"||r.body[0].expression.type!=="ArrowFunctionExpression"&&r.body[0].expression.type!=="FunctionExpression")throw new Error("Failed to resolve function");return r.body[0].expression.params.forEach(function(f){o.push(f.name)}),e=r.body[0].expression.body.range,r.body[0].expression.body.type==="BlockStatement"?new Function(o,n.slice(e[0]+1,e[1]-1)):new Function(o,"return "+n.slice(e[0],e[1]))},predicate:function(t){return Object.prototype.toString.call(t)==="[object Function]"},represent:function(t){return t.toString()}}),_$default_full_30=_$schema_28.DEFAULT=new _$schema_28({include:[_$default_safe_31],explicit:[_$undefined_41,_$regexp_40,_$function_39]}),_$loader_26={},___hasOwnProperty_26=Object.prototype.hasOwnProperty,CONTEXT_FLOW_IN=1,CONTEXT_FLOW_OUT=2,CONTEXT_BLOCK_IN=3,CONTEXT_BLOCK_OUT=4,CHOMPING_CLIP=1,CHOMPING_STRIP=2,CHOMPING_KEEP=3,PATTERN_NON_PRINTABLE=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,PATTERN_NON_ASCII_LINE_BREAKS=/[\x85\u2028\u2029]/,PATTERN_FLOW_INDICATORS=/[,\[\]\{\}]/,PATTERN_TAG_HANDLE=/^(?:!|!!|![a-z\-]+!)$/i,PATTERN_TAG_URI=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function _class(t){return Object.prototype.toString.call(t)}function is_EOL(t){return t===10||t===13}function is_WHITE_SPACE(t){return t===9||t===32}function is_WS_OR_EOL(t){return t===9||t===32||t===10||t===13}function is_FLOW_INDICATOR(t){return t===44||t===91||t===93||t===123||t===125}function fromHexCode(t){var e;return 48<=t&&t<=57?t-48:97<=(e=32|t)&&e<=102?e-97+10:-1}function simpleEscapeSequence(t){return t===48?"\0":t===97?"\x07":t===98?"\b":t===116||t===9?"	":t===110?`
`:t===118?"\v":t===102?"\f":t===114?"\r":t===101?"\x1B":t===32?" ":t===34?'"':t===47?"/":t===92?"\\":t===78?"\x85":t===95?"\xA0":t===76?"\u2028":t===80?"\u2029":""}function charFromCodepoint(t){return t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}for(var simpleEscapeCheck=new Array(256),simpleEscapeMap=new Array(256),i=0;i<256;i++)simpleEscapeCheck[i]=simpleEscapeSequence(i)?1:0,simpleEscapeMap[i]=simpleEscapeSequence(i);function State(t,e){this.input=t,this.filename=e.filename||null,this.schema=e.schema||_$default_full_30,this.onWarning=e.onWarning||null,this.legacy=e.legacy||!1,this.json=e.json||!1,this.listener=e.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.documents=[]}function generateError(t,e){return new _$exception_25(e,new _$mark_27(t.filename,t.input,t.position,t.line,t.position-t.lineStart))}function throwError(t,e){throw generateError(t,e)}function throwWarning(t,e){t.onWarning&&t.onWarning.call(null,generateError(t,e))}var directiveHandlers={YAML:function(t,e,n){var r,o,f;t.version!==null&&throwError(t,"duplication of %YAML directive"),n.length!==1&&throwError(t,"YAML directive accepts exactly one argument"),(r=/^([0-9]+)\.([0-9]+)$/.exec(n[0]))===null&&throwError(t,"ill-formed argument of the YAML directive"),o=parseInt(r[1],10),f=parseInt(r[2],10),o!==1&&throwError(t,"unacceptable YAML version of the document"),t.version=n[0],t.checkLineBreaks=f<2,f!==1&&f!==2&&throwWarning(t,"unsupported YAML version of the document")},TAG:function(t,e,n){var r,o;n.length!==2&&throwError(t,"TAG directive accepts exactly two arguments"),r=n[0],o=n[1],PATTERN_TAG_HANDLE.test(r)||throwError(t,"ill-formed tag handle (first argument) of the TAG directive"),___hasOwnProperty_26.call(t.tagMap,r)&&throwError(t,'there is a previously declared suffix for "'+r+'" tag handle'),PATTERN_TAG_URI.test(o)||throwError(t,"ill-formed tag prefix (second argument) of the TAG directive"),t.tagMap[r]=o}};function captureSegment(t,e,n,r){var o,f,d,h;if(e<n){if(h=t.input.slice(e,n),r)for(o=0,f=h.length;o<f;o+=1)(d=h.charCodeAt(o))===9||32<=d&&d<=1114111||throwError(t,"expected valid JSON character");else PATTERN_NON_PRINTABLE.test(h)&&throwError(t,"the stream contains non-printable characters");t.result+=h}}function mergeMappings(t,e,n,r){var o,f,d,h;for(_$common_23.isObject(n)||throwError(t,"cannot merge mappings; the provided source object is unacceptable"),d=0,h=(o=Object.keys(n)).length;d<h;d+=1)f=o[d],___hasOwnProperty_26.call(e,f)||(e[f]=n[f],r[f]=!0)}function storeMappingPair(t,e,n,r,o,f,d,h){var y,F;if(Array.isArray(o))for(y=0,F=(o=Array.prototype.slice.call(o)).length;y<F;y+=1)Array.isArray(o[y])&&throwError(t,"nested arrays are not supported inside keys"),typeof o=="object"&&_class(o[y])==="[object Object]"&&(o[y]="[object Object]");if(typeof o=="object"&&_class(o)==="[object Object]"&&(o="[object Object]"),o=String(o),e===null&&(e={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(f))for(y=0,F=f.length;y<F;y+=1)mergeMappings(t,e,f[y],n);else mergeMappings(t,e,f,n);else t.json||___hasOwnProperty_26.call(n,o)||!___hasOwnProperty_26.call(e,o)||(t.line=d||t.line,t.position=h||t.position,throwError(t,"duplicated mapping key")),e[o]=f,delete n[o];return e}function readLineBreak(t){var e;(e=t.input.charCodeAt(t.position))===10?t.position++:e===13?(t.position++,t.input.charCodeAt(t.position)===10&&t.position++):throwError(t,"a line break is expected"),t.line+=1,t.lineStart=t.position}function skipSeparationSpace(t,e,n){for(var r=0,o=t.input.charCodeAt(t.position);o!==0;){for(;is_WHITE_SPACE(o);)o=t.input.charCodeAt(++t.position);if(e&&o===35)do o=t.input.charCodeAt(++t.position);while(o!==10&&o!==13&&o!==0);if(!is_EOL(o))break;for(readLineBreak(t),o=t.input.charCodeAt(t.position),r++,t.lineIndent=0;o===32;)t.lineIndent++,o=t.input.charCodeAt(++t.position)}return n!==-1&&r!==0&&t.lineIndent<n&&throwWarning(t,"deficient indentation"),r}function testDocumentSeparator(t){var e,n=t.position;return!((e=t.input.charCodeAt(n))!==45&&e!==46||e!==t.input.charCodeAt(n+1)||e!==t.input.charCodeAt(n+2)||(n+=3,(e=t.input.charCodeAt(n))!==0&&!is_WS_OR_EOL(e)))}function writeFoldedLines(t,e){e===1?t.result+=" ":e>1&&(t.result+=_$common_23.repeat(`
`,e-1))}function readBlockSequence(t,e){var n,r,o=t.tag,f=t.anchor,d=[],h=!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=d),r=t.input.charCodeAt(t.position);r!==0&&r===45&&is_WS_OR_EOL(t.input.charCodeAt(t.position+1));)if(h=!0,t.position++,skipSeparationSpace(t,!0,-1)&&t.lineIndent<=e)d.push(null),r=t.input.charCodeAt(t.position);else if(n=t.line,composeNode(t,e,CONTEXT_BLOCK_IN,!1,!0),d.push(t.result),skipSeparationSpace(t,!0,-1),r=t.input.charCodeAt(t.position),(t.line===n||t.lineIndent>e)&&r!==0)throwError(t,"bad indentation of a sequence entry");else if(t.lineIndent<e)break;return!!h&&(t.tag=o,t.anchor=f,t.kind="sequence",t.result=d,!0)}function readTagProperty(t){var e,n,r,o,f=!1,d=!1;if((o=t.input.charCodeAt(t.position))!==33)return!1;if(t.tag!==null&&throwError(t,"duplication of a tag property"),(o=t.input.charCodeAt(++t.position))===60?(f=!0,o=t.input.charCodeAt(++t.position)):o===33?(d=!0,n="!!",o=t.input.charCodeAt(++t.position)):n="!",e=t.position,f){do o=t.input.charCodeAt(++t.position);while(o!==0&&o!==62);t.position<t.length?(r=t.input.slice(e,t.position),o=t.input.charCodeAt(++t.position)):throwError(t,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!is_WS_OR_EOL(o);)o===33&&(d?throwError(t,"tag suffix cannot contain exclamation marks"):(n=t.input.slice(e-1,t.position+1),PATTERN_TAG_HANDLE.test(n)||throwError(t,"named tag handle cannot contain such characters"),d=!0,e=t.position+1)),o=t.input.charCodeAt(++t.position);r=t.input.slice(e,t.position),PATTERN_FLOW_INDICATORS.test(r)&&throwError(t,"tag suffix cannot contain flow indicator characters")}return r&&!PATTERN_TAG_URI.test(r)&&throwError(t,"tag name cannot contain such characters: "+r),f?t.tag=r:___hasOwnProperty_26.call(t.tagMap,n)?t.tag=t.tagMap[n]+r:n==="!"?t.tag="!"+r:n==="!!"?t.tag="tag:yaml.org,2002:"+r:throwError(t,'undeclared tag handle "'+n+'"'),!0}function readAnchorProperty(t){var e,n;if((n=t.input.charCodeAt(t.position))!==38)return!1;for(t.anchor!==null&&throwError(t,"duplication of an anchor property"),n=t.input.charCodeAt(++t.position),e=t.position;n!==0&&!is_WS_OR_EOL(n)&&!is_FLOW_INDICATOR(n);)n=t.input.charCodeAt(++t.position);return t.position===e&&throwError(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(e,t.position),!0}function composeNode(t,e,n,r,o){var f,d,h,y,F,S,T,U,M=1,Y=!1,Z=!1;if(t.listener!==null&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,f=d=h=CONTEXT_BLOCK_OUT===n||CONTEXT_BLOCK_IN===n,r&&skipSeparationSpace(t,!0,-1)&&(Y=!0,t.lineIndent>e?M=1:t.lineIndent===e?M=0:t.lineIndent<e&&(M=-1)),M===1)for(;readTagProperty(t)||readAnchorProperty(t);)skipSeparationSpace(t,!0,-1)?(Y=!0,h=f,t.lineIndent>e?M=1:t.lineIndent===e?M=0:t.lineIndent<e&&(M=-1)):h=!1;if(h&&(h=Y||o),M!==1&&CONTEXT_BLOCK_OUT!==n||(T=CONTEXT_FLOW_IN===n||CONTEXT_FLOW_OUT===n?e:e+1,U=t.position-t.lineStart,M===1?h&&(readBlockSequence(t,U)||function(D,nt,ct){var at,et,mt,At,dt,ht=D.tag,xt=D.anchor,l={},s={},v=null,$=null,E=null,rt=!1,gt=!1;for(D.anchor!==null&&(D.anchorMap[D.anchor]=l),dt=D.input.charCodeAt(D.position);dt!==0;){if(at=D.input.charCodeAt(D.position+1),mt=D.line,At=D.position,dt!==63&&dt!==58||!is_WS_OR_EOL(at)){if(!composeNode(D,ct,CONTEXT_FLOW_OUT,!1,!0))break;if(D.line===mt){for(dt=D.input.charCodeAt(D.position);is_WHITE_SPACE(dt);)dt=D.input.charCodeAt(++D.position);if(dt===58)is_WS_OR_EOL(dt=D.input.charCodeAt(++D.position))||throwError(D,"a whitespace character is expected after the key-value separator within a block mapping"),rt&&(storeMappingPair(D,l,s,v,$,null),v=$=E=null),gt=!0,rt=!1,et=!1,v=D.tag,$=D.result;else{if(!gt)return D.tag=ht,D.anchor=xt,!0;throwError(D,"can not read an implicit mapping pair; a colon is missed")}}else{if(!gt)return D.tag=ht,D.anchor=xt,!0;throwError(D,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else dt===63?(rt&&(storeMappingPair(D,l,s,v,$,null),v=$=E=null),gt=!0,rt=!0,et=!0):rt?(rt=!1,et=!0):throwError(D,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),D.position+=1,dt=at;if((D.line===mt||D.lineIndent>nt)&&(composeNode(D,nt,CONTEXT_BLOCK_OUT,!0,et)&&(rt?$=D.result:E=D.result),rt||(storeMappingPair(D,l,s,v,$,E,mt,At),v=$=E=null),skipSeparationSpace(D,!0,-1),dt=D.input.charCodeAt(D.position)),D.lineIndent>nt&&dt!==0)throwError(D,"bad indentation of a mapping entry");else if(D.lineIndent<nt)break}return rt&&storeMappingPair(D,l,s,v,$,null),gt&&(D.tag=ht,D.anchor=xt,D.kind="mapping",D.result=l),gt}(t,U,T))||function(D,nt){var ct,at,et,mt,At,dt,ht,xt,l,s,v=!0,$=D.tag,E=D.anchor,rt={};if((s=D.input.charCodeAt(D.position))===91)et=93,dt=!1,at=[];else{if(s!==123)return!1;et=125,dt=!0,at={}}for(D.anchor!==null&&(D.anchorMap[D.anchor]=at),s=D.input.charCodeAt(++D.position);s!==0;){if(skipSeparationSpace(D,!0,nt),(s=D.input.charCodeAt(D.position))===et)return D.position++,D.tag=$,D.anchor=E,D.kind=dt?"mapping":"sequence",D.result=at,!0;v||throwError(D,"missed comma between flow collection entries"),l=null,mt=At=!1,s===63&&is_WS_OR_EOL(D.input.charCodeAt(D.position+1))&&(mt=At=!0,D.position++,skipSeparationSpace(D,!0,nt)),ct=D.line,composeNode(D,nt,CONTEXT_FLOW_IN,!1,!0),xt=D.tag,ht=D.result,skipSeparationSpace(D,!0,nt),s=D.input.charCodeAt(D.position),!At&&D.line!==ct||s!==58||(mt=!0,s=D.input.charCodeAt(++D.position),skipSeparationSpace(D,!0,nt),composeNode(D,nt,CONTEXT_FLOW_IN,!1,!0),l=D.result),dt?storeMappingPair(D,at,rt,xt,ht,l):mt?at.push(storeMappingPair(D,null,rt,xt,ht,l)):at.push(ht),skipSeparationSpace(D,!0,nt),(s=D.input.charCodeAt(D.position))===44?(v=!0,s=D.input.charCodeAt(++D.position)):v=!1}throwError(D,"unexpected end of the stream within a flow collection")}(t,T)?Z=!0:(d&&function(D,nt){var ct,at,et,mt,At,dt=CHOMPING_CLIP,ht=!1,xt=!1,l=nt,s=0,v=!1;if((mt=D.input.charCodeAt(D.position))===124)at=!1;else{if(mt!==62)return!1;at=!0}for(D.kind="scalar",D.result="";mt!==0;)if((mt=D.input.charCodeAt(++D.position))===43||mt===45)CHOMPING_CLIP===dt?dt=mt===43?CHOMPING_KEEP:CHOMPING_STRIP:throwError(D,"repeat of a chomping mode identifier");else{if(!((et=48<=(At=mt)&&At<=57?At-48:-1)>=0))break;et===0?throwError(D,"bad explicit indentation width of a block scalar; it cannot be less than one"):xt?throwError(D,"repeat of an indentation width identifier"):(l=nt+et-1,xt=!0)}if(is_WHITE_SPACE(mt)){do mt=D.input.charCodeAt(++D.position);while(is_WHITE_SPACE(mt));if(mt===35)do mt=D.input.charCodeAt(++D.position);while(!is_EOL(mt)&&mt!==0)}for(;mt!==0;){for(readLineBreak(D),D.lineIndent=0,mt=D.input.charCodeAt(D.position);(!xt||D.lineIndent<l)&&mt===32;)D.lineIndent++,mt=D.input.charCodeAt(++D.position);if(!xt&&D.lineIndent>l&&(l=D.lineIndent),is_EOL(mt))s++;else{if(D.lineIndent<l){dt===CHOMPING_KEEP?D.result+=_$common_23.repeat(`
`,ht?1+s:s):dt===CHOMPING_CLIP&&ht&&(D.result+=`
`);break}for(at?is_WHITE_SPACE(mt)?(v=!0,D.result+=_$common_23.repeat(`
`,ht?1+s:s)):v?(v=!1,D.result+=_$common_23.repeat(`
`,s+1)):s===0?ht&&(D.result+=" "):D.result+=_$common_23.repeat(`
`,s):D.result+=_$common_23.repeat(`
`,ht?1+s:s),ht=!0,xt=!0,s=0,ct=D.position;!is_EOL(mt)&&mt!==0;)mt=D.input.charCodeAt(++D.position);captureSegment(D,ct,D.position,!1)}}return!0}(t,T)||function(D,nt){var ct,at,et;if((ct=D.input.charCodeAt(D.position))!==39)return!1;for(D.kind="scalar",D.result="",D.position++,at=et=D.position;(ct=D.input.charCodeAt(D.position))!==0;)if(ct===39){if(captureSegment(D,at,D.position,!0),(ct=D.input.charCodeAt(++D.position))!==39)return!0;at=D.position,D.position++,et=D.position}else is_EOL(ct)?(captureSegment(D,at,et,!0),writeFoldedLines(D,skipSeparationSpace(D,!1,nt)),at=et=D.position):D.position===D.lineStart&&testDocumentSeparator(D)?throwError(D,"unexpected end of the document within a single quoted scalar"):(D.position++,et=D.position);throwError(D,"unexpected end of the stream within a single quoted scalar")}(t,T)||function(D,nt){var ct,at,et,mt,At,dt,ht;if((dt=D.input.charCodeAt(D.position))!==34)return!1;for(D.kind="scalar",D.result="",D.position++,ct=at=D.position;(dt=D.input.charCodeAt(D.position))!==0;){if(dt===34)return captureSegment(D,ct,D.position,!0),D.position++,!0;if(dt===92){if(captureSegment(D,ct,D.position,!0),is_EOL(dt=D.input.charCodeAt(++D.position)))skipSeparationSpace(D,!1,nt);else if(dt<256&&simpleEscapeCheck[dt])D.result+=simpleEscapeMap[dt],D.position++;else if((At=(ht=dt)===120?2:ht===117?4:ht===85?8:0)>0){for(et=At,mt=0;et>0;et--)(At=fromHexCode(dt=D.input.charCodeAt(++D.position)))>=0?mt=(mt<<4)+At:throwError(D,"expected hexadecimal character");D.result+=charFromCodepoint(mt),D.position++}else throwError(D,"unknown escape sequence");ct=at=D.position}else is_EOL(dt)?(captureSegment(D,ct,at,!0),writeFoldedLines(D,skipSeparationSpace(D,!1,nt)),ct=at=D.position):D.position===D.lineStart&&testDocumentSeparator(D)?throwError(D,"unexpected end of the document within a double quoted scalar"):(D.position++,at=D.position)}throwError(D,"unexpected end of the stream within a double quoted scalar")}(t,T)?Z=!0:function(D){var nt,ct,at;if((at=D.input.charCodeAt(D.position))!==42)return!1;for(at=D.input.charCodeAt(++D.position),nt=D.position;at!==0&&!is_WS_OR_EOL(at)&&!is_FLOW_INDICATOR(at);)at=D.input.charCodeAt(++D.position);return D.position===nt&&throwError(D,"name of an alias node must contain at least one character"),ct=D.input.slice(nt,D.position),___hasOwnProperty_26.call(D.anchorMap,ct)||throwError(D,'unidentified alias "'+ct+'"'),D.result=D.anchorMap[ct],skipSeparationSpace(D,!0,-1),!0}(t)?(Z=!0,t.tag===null&&t.anchor===null||throwError(t,"alias node should not have any properties")):function(D,nt,ct){var at,et,mt,At,dt,ht,xt,l,s=D.kind,v=D.result;if(is_WS_OR_EOL(l=D.input.charCodeAt(D.position))||is_FLOW_INDICATOR(l)||l===35||l===38||l===42||l===33||l===124||l===62||l===39||l===34||l===37||l===64||l===96||(l===63||l===45)&&(is_WS_OR_EOL(at=D.input.charCodeAt(D.position+1))||ct&&is_FLOW_INDICATOR(at)))return!1;for(D.kind="scalar",D.result="",et=mt=D.position,At=!1;l!==0;){if(l===58){if(is_WS_OR_EOL(at=D.input.charCodeAt(D.position+1))||ct&&is_FLOW_INDICATOR(at))break}else if(l===35){if(is_WS_OR_EOL(D.input.charCodeAt(D.position-1)))break}else{if(D.position===D.lineStart&&testDocumentSeparator(D)||ct&&is_FLOW_INDICATOR(l))break;if(is_EOL(l)){if(dt=D.line,ht=D.lineStart,xt=D.lineIndent,skipSeparationSpace(D,!1,-1),D.lineIndent>=nt){At=!0,l=D.input.charCodeAt(D.position);continue}D.position=mt,D.line=dt,D.lineStart=ht,D.lineIndent=xt;break}}At&&(captureSegment(D,et,mt,!1),writeFoldedLines(D,D.line-dt),et=mt=D.position,At=!1),is_WHITE_SPACE(l)||(mt=D.position+1),l=D.input.charCodeAt(++D.position)}return captureSegment(D,et,mt,!1),!!D.result||(D.kind=s,D.result=v,!1)}(t,T,CONTEXT_FLOW_IN===n)&&(Z=!0,t.tag===null&&(t.tag="?")),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):M===0&&(Z=h&&readBlockSequence(t,U))),t.tag!==null&&t.tag!=="!")if(t.tag==="?"){for(t.result!==null&&t.kind!=="scalar"&&throwError(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),y=0,F=t.implicitTypes.length;y<F;y+=1)if((S=t.implicitTypes[y]).resolve(t.result)){t.result=S.construct(t.result),t.tag=S.tag,t.anchor!==null&&(t.anchorMap[t.anchor]=t.result);break}}else ___hasOwnProperty_26.call(t.typeMap[t.kind||"fallback"],t.tag)?(S=t.typeMap[t.kind||"fallback"][t.tag],t.result!==null&&S.kind!==t.kind&&throwError(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+S.kind+'", not "'+t.kind+'"'),S.resolve(t.result)?(t.result=S.construct(t.result),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):throwError(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")):throwError(t,"unknown tag !<"+t.tag+">");return t.listener!==null&&t.listener("close",t),t.tag!==null||t.anchor!==null||Z}function readDocument(t){var e,n,r,o,f=t.position,d=!1;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap={},t.anchorMap={};(o=t.input.charCodeAt(t.position))!==0&&(skipSeparationSpace(t,!0,-1),o=t.input.charCodeAt(t.position),!(t.lineIndent>0||o!==37));){for(d=!0,o=t.input.charCodeAt(++t.position),e=t.position;o!==0&&!is_WS_OR_EOL(o);)o=t.input.charCodeAt(++t.position);for(r=[],(n=t.input.slice(e,t.position)).length<1&&throwError(t,"directive name must not be less than one character in length");o!==0;){for(;is_WHITE_SPACE(o);)o=t.input.charCodeAt(++t.position);if(o===35){do o=t.input.charCodeAt(++t.position);while(o!==0&&!is_EOL(o));break}if(is_EOL(o))break;for(e=t.position;o!==0&&!is_WS_OR_EOL(o);)o=t.input.charCodeAt(++t.position);r.push(t.input.slice(e,t.position))}o!==0&&readLineBreak(t),___hasOwnProperty_26.call(directiveHandlers,n)?directiveHandlers[n](t,n,r):throwWarning(t,'unknown document directive "'+n+'"')}skipSeparationSpace(t,!0,-1),t.lineIndent===0&&t.input.charCodeAt(t.position)===45&&t.input.charCodeAt(t.position+1)===45&&t.input.charCodeAt(t.position+2)===45?(t.position+=3,skipSeparationSpace(t,!0,-1)):d&&throwError(t,"directives end mark is expected"),composeNode(t,t.lineIndent-1,CONTEXT_BLOCK_OUT,!1,!0),skipSeparationSpace(t,!0,-1),t.checkLineBreaks&&PATTERN_NON_ASCII_LINE_BREAKS.test(t.input.slice(f,t.position))&&throwWarning(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&testDocumentSeparator(t)?t.input.charCodeAt(t.position)===46&&(t.position+=3,skipSeparationSpace(t,!0,-1)):t.position<t.length-1&&throwError(t,"end of the stream or a document separator is expected")}function loadDocuments(t,e){e=e||{},(t=String(t)).length!==0&&(t.charCodeAt(t.length-1)!==10&&t.charCodeAt(t.length-1)!==13&&(t+=`
`),t.charCodeAt(0)===65279&&(t=t.slice(1)));var n=new State(t,e),r=t.indexOf("\0");for(r!==-1&&(n.position=r,throwError(n,"null byte is not allowed in input")),n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)readDocument(n);return n.documents}function loadAll(t,e,n){e!==null&&typeof e=="object"&&n===void 0&&(n=e,e=null);var r=loadDocuments(t,n);if(typeof e!="function")return r;for(var o=0,f=r.length;o<f;o+=1)e(r[o])}function load(t,e){var n=loadDocuments(t,e);if(n.length!==0){if(n.length===1)return n[0];throw new _$exception_25("expected a single document in the stream, but found more")}}_$loader_26.loadAll=loadAll,_$loader_26.load=load,_$loader_26.safeLoadAll=function(t,e,n){return typeof e=="object"&&e!==null&&n===void 0&&(n=e,e=null),loadAll(t,e,_$common_23.extend({schema:_$default_safe_31},n))},_$loader_26.safeLoad=function(t,e){return load(t,_$common_23.extend({schema:_$default_safe_31},e))};var _$dumper_24={},___toString_24=Object.prototype.toString,___hasOwnProperty_24=Object.prototype.hasOwnProperty,CHAR_TAB=9,CHAR_LINE_FEED=10,CHAR_CARRIAGE_RETURN=13,CHAR_SPACE=32,CHAR_EXCLAMATION=33,CHAR_DOUBLE_QUOTE=34,CHAR_SHARP=35,CHAR_PERCENT=37,CHAR_AMPERSAND=38,CHAR_SINGLE_QUOTE=39,CHAR_ASTERISK=42,CHAR_COMMA=44,CHAR_MINUS=45,CHAR_COLON=58,CHAR_EQUALS=61,CHAR_GREATER_THAN=62,CHAR_QUESTION=63,CHAR_COMMERCIAL_AT=64,CHAR_LEFT_SQUARE_BRACKET=91,CHAR_RIGHT_SQUARE_BRACKET=93,CHAR_GRAVE_ACCENT=96,CHAR_LEFT_CURLY_BRACKET=123,CHAR_VERTICAL_LINE=124,CHAR_RIGHT_CURLY_BRACKET=125,ESCAPE_SEQUENCES={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},DEPRECATED_BOOLEANS_SYNTAX=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"];function encodeHex(t){var e,n,r;if(e=t.toString(16).toUpperCase(),t<=255)n="x",r=2;else if(t<=65535)n="u",r=4;else{if(!(t<=4294967295))throw new _$exception_25("code point within a string may not be greater than 0xFFFFFFFF");n="U",r=8}return"\\"+n+_$common_23.repeat("0",r-e.length)+e}function __State_24(t){this.schema=t.schema||_$default_full_30,this.indent=Math.max(1,t.indent||2),this.noArrayIndent=t.noArrayIndent||!1,this.skipInvalid=t.skipInvalid||!1,this.flowLevel=_$common_23.isNothing(t.flowLevel)?-1:t.flowLevel,this.styleMap=function(e,n){var r,o,f,d,h,y,F;if(n===null)return{};for(r={},f=0,d=(o=Object.keys(n)).length;f<d;f+=1)h=o[f],y=String(n[h]),h.slice(0,2)==="!!"&&(h="tag:yaml.org,2002:"+h.slice(2)),(F=e.compiledTypeMap.fallback[h])&&___hasOwnProperty_24.call(F.styleAliases,y)&&(y=F.styleAliases[y]),r[h]=y;return r}(this.schema,t.styles||null),this.sortKeys=t.sortKeys||!1,this.lineWidth=t.lineWidth||80,this.noRefs=t.noRefs||!1,this.noCompatMode=t.noCompatMode||!1,this.condenseFlow=t.condenseFlow||!1,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function indentString(t,e){for(var n,r=_$common_23.repeat(" ",e),o=0,f=-1,d="",h=t.length;o<h;)(f=t.indexOf(`
`,o))===-1?(n=t.slice(o),o=h):(n=t.slice(o,f+1),o=f+1),n.length&&n!==`
`&&(d+=r),d+=n;return d}function generateNextLine(t,e){return`
`+_$common_23.repeat(" ",t.indent*e)}function isWhitespace(t){return t===CHAR_SPACE||t===CHAR_TAB}function isPrintable(t){return 32<=t&&t<=126||161<=t&&t<=55295&&t!==8232&&t!==8233||57344<=t&&t<=65533&&t!==65279||65536<=t&&t<=1114111}function isPlainSafe(t,e){return isPrintable(t)&&t!==65279&&t!==CHAR_COMMA&&t!==CHAR_LEFT_SQUARE_BRACKET&&t!==CHAR_RIGHT_SQUARE_BRACKET&&t!==CHAR_LEFT_CURLY_BRACKET&&t!==CHAR_RIGHT_CURLY_BRACKET&&t!==CHAR_COLON&&(t!==CHAR_SHARP||e&&function(n){return isPrintable(n)&&!isWhitespace(n)&&n!==65279&&n!==CHAR_CARRIAGE_RETURN&&n!==CHAR_LINE_FEED}(e))}function needIndentIndicator(t){return/^\n* /.test(t)}var STYLE_PLAIN=1,STYLE_SINGLE=2,STYLE_LITERAL=3,STYLE_FOLDED=4,STYLE_DOUBLE=5;function chooseScalarStyle(t,e,n,r,o){var f,d,h,y,F=!1,S=!1,T=r!==-1,U=-1,M=isPrintable(y=t.charCodeAt(0))&&y!==65279&&!isWhitespace(y)&&y!==CHAR_MINUS&&y!==CHAR_QUESTION&&y!==CHAR_COLON&&y!==CHAR_COMMA&&y!==CHAR_LEFT_SQUARE_BRACKET&&y!==CHAR_RIGHT_SQUARE_BRACKET&&y!==CHAR_LEFT_CURLY_BRACKET&&y!==CHAR_RIGHT_CURLY_BRACKET&&y!==CHAR_SHARP&&y!==CHAR_AMPERSAND&&y!==CHAR_ASTERISK&&y!==CHAR_EXCLAMATION&&y!==CHAR_VERTICAL_LINE&&y!==CHAR_EQUALS&&y!==CHAR_GREATER_THAN&&y!==CHAR_SINGLE_QUOTE&&y!==CHAR_DOUBLE_QUOTE&&y!==CHAR_PERCENT&&y!==CHAR_COMMERCIAL_AT&&y!==CHAR_GRAVE_ACCENT&&!isWhitespace(t.charCodeAt(t.length-1));if(e)for(f=0;f<t.length;f++){if(!isPrintable(d=t.charCodeAt(f)))return STYLE_DOUBLE;h=f>0?t.charCodeAt(f-1):null,M=M&&isPlainSafe(d,h)}else{for(f=0;f<t.length;f++){if((d=t.charCodeAt(f))===CHAR_LINE_FEED)F=!0,T&&(S=S||f-U-1>r&&t[U+1]!==" ",U=f);else if(!isPrintable(d))return STYLE_DOUBLE;h=f>0?t.charCodeAt(f-1):null,M=M&&isPlainSafe(d,h)}S=S||T&&f-U-1>r&&t[U+1]!==" "}return F||S?n>9&&needIndentIndicator(t)?STYLE_DOUBLE:S?STYLE_FOLDED:STYLE_LITERAL:M&&!o(t)?STYLE_PLAIN:STYLE_SINGLE}function writeScalar(t,e,n,r){t.dump=function(){if(e.length===0)return"''";if(!t.noCompatMode&&DEPRECATED_BOOLEANS_SYNTAX.indexOf(e)!==-1)return"'"+e+"'";var o=t.indent*Math.max(1,n),f=t.lineWidth===-1?-1:Math.max(Math.min(t.lineWidth,40),t.lineWidth-o),d=r||t.flowLevel>-1&&n>=t.flowLevel;switch(chooseScalarStyle(e,d,t.indent,f,function(h){return function(y,F){var S,T;for(S=0,T=y.implicitTypes.length;S<T;S+=1)if(y.implicitTypes[S].resolve(F))return!0;return!1}(t,h)})){case STYLE_PLAIN:return e;case STYLE_SINGLE:return"'"+e.replace(/'/g,"''")+"'";case STYLE_LITERAL:return"|"+blockHeader(e,t.indent)+dropEndingNewline(indentString(e,o));case STYLE_FOLDED:return">"+blockHeader(e,t.indent)+dropEndingNewline(indentString(function(h,y){for(var F,S,T,U=/(\n+)([^\n]*)/g,M=(T=(T=h.indexOf(`
`))!==-1?T:h.length,U.lastIndex=T,foldLine(h.slice(0,T),y)),Y=h[0]===`
`||h[0]===" ";S=U.exec(h);){var Z=S[1],D=S[2];F=D[0]===" ",M+=Z+(Y||F||D===""?"":`
`)+foldLine(D,y),Y=F}return M}(e,f),o));case STYLE_DOUBLE:return'"'+function(h){for(var y,F,S,T="",U=0;U<h.length;U++)(y=h.charCodeAt(U))>=55296&&y<=56319&&(F=h.charCodeAt(U+1))>=56320&&F<=57343?(T+=encodeHex(1024*(y-55296)+F-56320+65536),U++):T+=!(S=ESCAPE_SEQUENCES[y])&&isPrintable(y)?h[U]:S||encodeHex(y);return T}(e)+'"';default:throw new _$exception_25("impossible error: invalid scalar style")}}()}function blockHeader(t,e){var n=needIndentIndicator(t)?String(e):"",r=t[t.length-1]===`
`;return n+(!r||t[t.length-2]!==`
`&&t!==`
`?r?"":"-":"+")+`
`}function dropEndingNewline(t){return t[t.length-1]===`
`?t.slice(0,-1):t}function foldLine(t,e){if(t===""||t[0]===" ")return t;for(var n,r,o=/ [^ ]/g,f=0,d=0,h=0,y="";n=o.exec(t);)(h=n.index)-f>e&&(r=d>f?d:h,y+=`
`+t.slice(f,r),f=r+1),d=h;return y+=`
`,t.length-f>e&&d>f?y+=t.slice(f,d)+`
`+t.slice(d+1):y+=t.slice(f),y.slice(1)}function detectType(t,e,n){var r,o,f,d,h,y;for(f=0,d=(o=n?t.explicitTypes:t.implicitTypes).length;f<d;f+=1)if(((h=o[f]).instanceOf||h.predicate)&&(!h.instanceOf||typeof e=="object"&&e instanceof h.instanceOf)&&(!h.predicate||h.predicate(e))){if(t.tag=n?h.tag:"?",h.represent){if(y=t.styleMap[h.tag]||h.defaultStyle,___toString_24.call(h.represent)==="[object Function]")r=h.represent(e,y);else{if(!___hasOwnProperty_24.call(h.represent,y))throw new _$exception_25("!<"+h.tag+'> tag resolver accepts not "'+y+'" style');r=h.represent[y](e,y)}t.dump=r}return!0}return!1}function writeNode(t,e,n,r,o,f){t.tag=null,t.dump=n,detectType(t,n,!1)||detectType(t,n,!0);var d=___toString_24.call(t.dump);r&&(r=t.flowLevel<0||t.flowLevel>e);var h,y,F=d==="[object Object]"||d==="[object Array]";if(F&&(y=(h=t.duplicates.indexOf(n))!==-1),(t.tag!==null&&t.tag!=="?"||y||t.indent!==2&&e>0)&&(o=!1),y&&t.usedDuplicates[h])t.dump="*ref_"+h;else{if(F&&y&&!t.usedDuplicates[h]&&(t.usedDuplicates[h]=!0),d==="[object Object]")r&&Object.keys(t.dump).length!==0?(function(T,U,M,Y){var Z,D,nt,ct,at,et,mt="",At=T.tag,dt=Object.keys(M);if(T.sortKeys===!0)dt.sort();else if(typeof T.sortKeys=="function")dt.sort(T.sortKeys);else if(T.sortKeys)throw new _$exception_25("sortKeys must be a boolean or a function");for(Z=0,D=dt.length;Z<D;Z+=1)et="",Y&&Z===0||(et+=generateNextLine(T,U)),ct=M[nt=dt[Z]],writeNode(T,U+1,nt,!0,!0,!0)&&((at=T.tag!==null&&T.tag!=="?"||T.dump&&T.dump.length>1024)&&(T.dump&&CHAR_LINE_FEED===T.dump.charCodeAt(0)?et+="?":et+="? "),et+=T.dump,at&&(et+=generateNextLine(T,U)),writeNode(T,U+1,ct,!0,at)&&(T.dump&&CHAR_LINE_FEED===T.dump.charCodeAt(0)?et+=":":et+=": ",mt+=et+=T.dump));T.tag=At,T.dump=mt||"{}"}(t,e,t.dump,o),y&&(t.dump="&ref_"+h+t.dump)):(function(T,U,M){var Y,Z,D,nt,ct,at="",et=T.tag,mt=Object.keys(M);for(Y=0,Z=mt.length;Y<Z;Y+=1)ct="",Y!==0&&(ct+=", "),T.condenseFlow&&(ct+='"'),nt=M[D=mt[Y]],writeNode(T,U,D,!1,!1)&&(T.dump.length>1024&&(ct+="? "),ct+=T.dump+(T.condenseFlow?'"':"")+":"+(T.condenseFlow?"":" "),writeNode(T,U,nt,!1,!1)&&(at+=ct+=T.dump));T.tag=et,T.dump="{"+at+"}"}(t,e,t.dump),y&&(t.dump="&ref_"+h+" "+t.dump));else if(d==="[object Array]"){var S=t.noArrayIndent&&e>0?e-1:e;r&&t.dump.length!==0?(function(T,U,M,Y){var Z,D,nt="",ct=T.tag;for(Z=0,D=M.length;Z<D;Z+=1)writeNode(T,U+1,M[Z],!0,!0)&&(Y&&Z===0||(nt+=generateNextLine(T,U)),T.dump&&CHAR_LINE_FEED===T.dump.charCodeAt(0)?nt+="-":nt+="- ",nt+=T.dump);T.tag=ct,T.dump=nt||"[]"}(t,S,t.dump,o),y&&(t.dump="&ref_"+h+t.dump)):(function(T,U,M){var Y,Z,D="",nt=T.tag;for(Y=0,Z=M.length;Y<Z;Y+=1)writeNode(T,U,M[Y],!1,!1)&&(Y!==0&&(D+=","+(T.condenseFlow?"":" ")),D+=T.dump);T.tag=nt,T.dump="["+D+"]"}(t,S,t.dump),y&&(t.dump="&ref_"+h+" "+t.dump))}else{if(d!=="[object String]"){if(t.skipInvalid)return!1;throw new _$exception_25("unacceptable kind of an object to dump "+d)}t.tag!=="?"&&writeScalar(t,t.dump,e,f)}t.tag!==null&&t.tag!=="?"&&(t.dump="!<"+t.tag+"> "+t.dump)}return!0}function getDuplicateReferences(t,e){var n,r,o=[],f=[];for(function d(h,y,F){var S,T,U;if(h!==null&&typeof h=="object")if((T=y.indexOf(h))!==-1)F.indexOf(T)===-1&&F.push(T);else if(y.push(h),Array.isArray(h))for(T=0,U=h.length;T<U;T+=1)d(h[T],y,F);else for(T=0,U=(S=Object.keys(h)).length;T<U;T+=1)d(h[S[T]],y,F)}(t,o,f),n=0,r=f.length;n<r;n+=1)e.duplicates.push(o[f[n]]);e.usedDuplicates=new Array(r)}function dump(t,e){var n=new __State_24(e=e||{});return n.noRefs||getDuplicateReferences(t,n),writeNode(n,0,t,!0,!0)?n.dump+`
`:""}_$dumper_24.dump=dump,_$dumper_24.safeDump=function(t,e){return dump(t,_$common_23.extend({schema:_$default_safe_31},e))};var _$jsYaml_22={};function deprecated(t){return function(){throw new Error("Function "+t+" is deprecated and cannot be used.")}}_$jsYaml_22.Type=_$type_34,_$jsYaml_22.Schema=_$schema_28,_$jsYaml_22.FAILSAFE_SCHEMA=_$failsafe_32,_$jsYaml_22.JSON_SCHEMA=_$json_33,_$jsYaml_22.CORE_SCHEMA=_$core_29,_$jsYaml_22.DEFAULT_SAFE_SCHEMA=_$default_safe_31,_$jsYaml_22.DEFAULT_FULL_SCHEMA=_$default_full_30,_$jsYaml_22.load=_$loader_26.load,_$jsYaml_22.loadAll=_$loader_26.loadAll,_$jsYaml_22.safeLoad=_$loader_26.safeLoad,_$jsYaml_22.safeLoadAll=_$loader_26.safeLoadAll,_$jsYaml_22.dump=_$dumper_24.dump,_$jsYaml_22.safeDump=_$dumper_24.safeDump,_$jsYaml_22.YAMLException=_$exception_25,_$jsYaml_22.MINIMAL_SCHEMA=_$failsafe_32,_$jsYaml_22.SAFE_SCHEMA=_$default_safe_31,_$jsYaml_22.DEFAULT_SCHEMA=_$default_full_30,_$jsYaml_22.scan=deprecated("scan"),_$jsYaml_22.parse=deprecated("parse"),_$jsYaml_22.compose=deprecated("compose"),_$jsYaml_22.addConstructor=deprecated("addConstructor");var _$yaml_21=_$jsYaml_22,_$staticJsYaml_84={safeLoad:_$yaml_21.safeLoad,load:_$yaml_21.load,safeDump:_$yaml_21.safeDump,dump:_$yaml_21.dump},_$yaml_148={};Object.defineProperty(_$yaml_148,"__esModule",{value:!0}),_$yaml_148.default=void 0,_$yaml_148.dump=__dump_148,_$yaml_148.load=__load_148,_$yaml_148.safeDump=safeDump,_$yaml_148.safeLoad=safeLoad;var __obj_148,_staticJsYaml=(__obj_148=_$staticJsYaml_84)&&__obj_148.__esModule?__obj_148:{default:__obj_148};function retry(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];try{return t.apply(void 0,[e].concat(r))}catch{return t.apply(void 0,[__dump_148(t.apply(void 0,[e.replace(/!<str>\s*/g,"__SubStoreJSYAMLString__")].concat(r))).replace(/__SubStoreJSYAMLString__/g,"")].concat(r))}}function safeLoad(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return retry.apply(void 0,[_staticJsYaml.default.safeLoad,JSON.parse(JSON.stringify(t))].concat(n))}function __load_148(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return retry.apply(void 0,[_staticJsYaml.default.load,JSON.parse(JSON.stringify(t))].concat(n))}function safeDump(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return _staticJsYaml.default.safeDump.apply(_staticJsYaml.default,[JSON.parse(JSON.stringify(t))].concat(n))}function __dump_148(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return _staticJsYaml.default.dump.apply(_staticJsYaml.default,[JSON.parse(JSON.stringify(t))].concat(n))}var ___default_148={safeLoad,load:__load_148,safeDump,dump:__dump_148};_$yaml_148.default=___default_148;for(var _$base64Js_2={byteLength:function(t){var e=getLens(t),n=e[0],r=e[1];return 3*(n+r)/4-r},toByteArray:function(t){var e,n,r=getLens(t),o=r[0],f=r[1],d=new Arr(function(F,S,T){return 3*(S+T)/4-T}(0,o,f)),h=0,y=f>0?o-4:o;for(n=0;n<y;n+=4)e=revLookup[t.charCodeAt(n)]<<18|revLookup[t.charCodeAt(n+1)]<<12|revLookup[t.charCodeAt(n+2)]<<6|revLookup[t.charCodeAt(n+3)],d[h++]=e>>16&255,d[h++]=e>>8&255,d[h++]=255&e;return f===2&&(e=revLookup[t.charCodeAt(n)]<<2|revLookup[t.charCodeAt(n+1)]>>4,d[h++]=255&e),f===1&&(e=revLookup[t.charCodeAt(n)]<<10|revLookup[t.charCodeAt(n+1)]<<4|revLookup[t.charCodeAt(n+2)]>>2,d[h++]=e>>8&255,d[h++]=255&e),d},fromByteArray:function(t){for(var e,n=t.length,r=n%3,o=[],f=0,d=n-r;f<d;f+=16383)o.push(encodeChunk(t,f,f+16383>d?d:f+16383));return r===1?(e=t[n-1],o.push(lookup[e>>2]+lookup[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],o.push(lookup[e>>10]+lookup[e>>4&63]+lookup[e<<2&63]+"=")),o.join("")}},lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",__i_2=0,len=code.length;__i_2<len;++__i_2)lookup[__i_2]=code[__i_2],revLookup[code.charCodeAt(__i_2)]=__i_2;function getLens(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return n===-1&&(n=e),[n,n===e?0:4-n%4]}function encodeChunk(t,e,n){for(var r,o,f=[],d=e;d<n;d+=3)r=(t[d]<<16&16711680)+(t[d+1]<<8&65280)+(255&t[d+2]),f.push(lookup[(o=r)>>18&63]+lookup[o>>12&63]+lookup[o>>6&63]+lookup[63&o]);return f.join("")}revLookup[45]=62,revLookup[95]=63;var _$ieee754_10={read:function(t,e,n,r,o){var f,d,h=8*o-r-1,y=(1<<h)-1,F=y>>1,S=-7,T=n?o-1:0,U=n?-1:1,M=t[e+T];for(T+=U,f=M&(1<<-S)-1,M>>=-S,S+=h;S>0;f=256*f+t[e+T],T+=U,S-=8);for(d=f&(1<<-S)-1,f>>=-S,S+=r;S>0;d=256*d+t[e+T],T+=U,S-=8);if(f===0)f=1-F;else{if(f===y)return d?NaN:1/0*(M?-1:1);d+=Math.pow(2,r),f-=F}return(M?-1:1)*d*Math.pow(2,f-r)},write:function(t,e,n,r,o,f){var d,h,y,F=8*f-o-1,S=(1<<F)-1,T=S>>1,U=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,M=r?0:f-1,Y=r?1:-1,Z=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(h=isNaN(e)?1:0,d=S):(d=Math.floor(Math.log(e)/Math.LN2),e*(y=Math.pow(2,-d))<1&&(d--,y*=2),(e+=d+T>=1?U/y:U*Math.pow(2,1-T))*y>=2&&(d++,y/=2),d+T>=S?(h=0,d=S):d+T>=1?(h=(e*y-1)*Math.pow(2,o),d+=T):(h=e*Math.pow(2,T-1)*Math.pow(2,o),d=0));o>=8;t[n+M]=255&h,M+=Y,h/=256,o-=8);for(d=d<<o|h,F+=o;F>0;t[n+M]=255&d,M+=Y,d/=256,F-=8);t[n+M-Y]|=128*Z}},_$base64_20={exports:{}};(function(t,e){(function(){(function(n,r){var o,f;typeof _$base64_20.exports=="object"?_$base64_20.exports=r():typeof define=="function"&&define.amd?define(r):(o=n.Base64,(f=r()).noConflict=function(){return n.Base64=o,f},n.Meteor&&(Base64=f),n.Base64=f)})(typeof self<"u"?self:typeof window<"u"?window:t!==void 0?t:this,function(){"use strict";var n,r=typeof atob=="function",o=typeof btoa=="function",f=typeof e=="function",d=typeof TextDecoder=="function"?new TextDecoder:void 0,h=typeof TextEncoder=="function"?new TextEncoder:void 0,y=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),F=(n={},y.forEach(function(C,j){return n[C]=j}),n),S=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,T=String.fromCharCode.bind(String),U=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):function(C,j){return j===void 0&&(j=function(K){return K}),new Uint8Array(Array.prototype.slice.call(C,0).map(j))},M=function(C){return C.replace(/=/g,"").replace(/[+\/]/g,function(j){return j=="+"?"-":"_"})},Y=function(C){return C.replace(/[^A-Za-z0-9\+\/]/g,"")},Z=function(C){for(var j,K,J,yt,Dt="",Xt=C.length%3,_e=0;_e<C.length;){if((K=C.charCodeAt(_e++))>255||(J=C.charCodeAt(_e++))>255||(yt=C.charCodeAt(_e++))>255)throw new TypeError("invalid character found");Dt+=y[(j=K<<16|J<<8|yt)>>18&63]+y[j>>12&63]+y[j>>6&63]+y[63&j]}return Xt?Dt.slice(0,Xt-3)+"===".substring(Xt):Dt},D=o?function(C){return btoa(C)}:f?function(C){return e.from(C,"binary").toString("base64")}:Z,nt=f?function(C){return e.from(C).toString("base64")}:function(C){for(var j=[],K=0,J=C.length;K<J;K+=4096)j.push(T.apply(null,C.subarray(K,K+4096)));return D(j.join(""))},ct=function(C,j){return j===void 0&&(j=!1),j?M(nt(C)):nt(C)},at=function(C){if(C.length<2)return(j=C.charCodeAt(0))<128?C:j<2048?T(192|j>>>6)+T(128|63&j):T(224|j>>>12&15)+T(128|j>>>6&63)+T(128|63&j);var j=65536+1024*(C.charCodeAt(0)-55296)+(C.charCodeAt(1)-56320);return T(240|j>>>18&7)+T(128|j>>>12&63)+T(128|j>>>6&63)+T(128|63&j)},et=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,mt=function(C){return C.replace(et,at)},At=f?function(C){return e.from(C,"utf8").toString("base64")}:h?function(C){return nt(h.encode(C))}:function(C){return D(mt(C))},dt=function(C,j){return j===void 0&&(j=!1),j?M(At(C)):At(C)},ht=function(C){return dt(C,!0)},xt=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,l=function(C){switch(C.length){case 4:var j=((7&C.charCodeAt(0))<<18|(63&C.charCodeAt(1))<<12|(63&C.charCodeAt(2))<<6|63&C.charCodeAt(3))-65536;return T(55296+(j>>>10))+T(56320+(1023&j));case 3:return T((15&C.charCodeAt(0))<<12|(63&C.charCodeAt(1))<<6|63&C.charCodeAt(2));default:return T((31&C.charCodeAt(0))<<6|63&C.charCodeAt(1))}},s=function(C){return C.replace(xt,l)},v=function(C){if(C=C.replace(/\s+/g,""),!S.test(C))throw new TypeError("malformed base64.");C+="==".slice(2-(3&C.length));for(var j,K,J,yt="",Dt=0;Dt<C.length;)j=F[C.charAt(Dt++)]<<18|F[C.charAt(Dt++)]<<12|(K=F[C.charAt(Dt++)])<<6|(J=F[C.charAt(Dt++)]),yt+=K===64?T(j>>16&255):J===64?T(j>>16&255,j>>8&255):T(j>>16&255,j>>8&255,255&j);return yt},$=r?function(C){return atob(Y(C))}:f?function(C){return e.from(C,"base64").toString("binary")}:v,E=f?function(C){return U(e.from(C,"base64"))}:function(C){return U($(C),function(j){return j.charCodeAt(0)})},rt=function(C){return E(Et(C))},gt=f?function(C){return e.from(C,"base64").toString("utf8")}:d?function(C){return d.decode(E(C))}:function(C){return s($(C))},Et=function(C){return Y(C.replace(/[-_]/g,function(j){return j=="-"?"+":"/"}))},Ct=function(C){return gt(Et(C))},x=function(C){return{value:C,enumerable:!1,writable:!0,configurable:!0}},N=function(){var C=function(j,K){return Object.defineProperty(String.prototype,j,x(K))};C("fromBase64",function(){return Ct(this)}),C("toBase64",function(j){return dt(this,j)}),C("toBase64URI",function(){return dt(this,!0)}),C("toBase64URL",function(){return dt(this,!0)}),C("toUint8Array",function(){return rt(this)})},G=function(){var C=function(j,K){return Object.defineProperty(Uint8Array.prototype,j,x(K))};C("toBase64",function(j){return ct(this,j)}),C("toBase64URI",function(){return ct(this,!0)}),C("toBase64URL",function(){return ct(this,!0)})},A={version:"3.7.2",VERSION:"3.7.2",atob:$,atobPolyfill:v,btoa:D,btoaPolyfill:Z,fromBase64:Ct,toBase64:dt,encode:dt,encodeURI:ht,encodeURL:ht,utob:mt,btou:s,decode:Ct,isValid:function(C){if(typeof C!="string")return!1;var j=C.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(j)||!/[^\s0-9a-zA-Z\-_]/.test(j)},fromUint8Array:ct,toUint8Array:rt,extendString:N,extendUint8Array:G,extendBuiltins:function(){N(),G()},Base64:{}};return Object.keys(A).forEach(function(C){return A.Base64[C]=A[C]}),A})}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},_$buffer_3({}).Buffer),_$base64_20=_$base64_20.exports;var _$preprocessors_94={};Object.defineProperty(_$preprocessors_94,"__esModule",{value:!0}),_$preprocessors_94.default=void 0;var __obj_94,___app_94=(__obj_94=_$app_87)&&__obj_94.__esModule?__obj_94:{default:__obj_94},keys,___default_94=[{name:"HTML",test:function(t){return/^<!DOCTYPE html>/.test(t)},parse:function(){return""}},{name:"Clash Pre-processor",test:function(t){if(!/proxies/.test(t))return!1;var e=(0,_$yaml_148.safeLoad)(t);return e.proxies&&Array.isArray(e.proxies)},parse:function(t,e){var n=t.replace(/short-id:([ ]*[^,\n}]*)/g,function(d,h){var y=h.trim();return y&&y!==""?/^(['"]).*\1$/.test(y)?"short-id: ".concat(y):'short-id: "'.concat(y,'"'):'short-id: ""'}),r=(0,_$yaml_148.safeLoad)(n),o=r.proxies,f=r["global-client-fingerprint"];return(e?`proxies:
`:"")+o.map(function(d){return f&&!d["client-fingerprint"]&&(d["client-fingerprint"]=f),"".concat(e?"  - ":"").concat(JSON.stringify(d),`
`)}).join("")}},(keys=["dm1lc3M","c3NyOi8v","dHJvamFu","c3M6Ly","c3NkOi8v","c2hhZG93","aHR0c","dmxlc3M=","aHlzdGVyaWEy","aHkyOi8v","d2lyZWd1YXJkOi8v","d2c6Ly8=","dHVpYzovLw=="],{name:"Base64 Pre-processor",test:function(t){return!/^\w+:\/\/\w+/im.test(t)&&keys.some(function(e){return t.indexOf(e)!==-1})},parse:function(t){var e=_$base64_20.Base64.decode(t);return/^\w+:\/\/\w+/m.test(e)?e:(___app_94.default.error("Base64 Pre-processor error: decoded line does not start with protocol"),t)}}),{name:"SSD Pre-processor",test:function(t){return t.indexOf("ssd://")===0},parse:function(t){for(var e=[],n=JSON.parse(_$base64_20.Base64.decode(t.split("ssd://")[1])),r=n.port,o=n.encryption,f=n.password,d=n.servers,h=0;h<d.length;h++){var y=d[h];o=y.encryption?y.encryption:o,f=y.password?y.password:f;var F=_$base64_20.Base64.encode(o+":"+f),S=y.server;r=y.port?y.port:r;var T=y.remarks?y.remarks:h,U=y.plugin_options?"/?plugin="+encodeURIComponent(y.plugin+";"+y.plugin_options):"";e[h]="ss://"+F+"@"+S+":"+r+U+"#"+T}return e.join(`
`)}},{name:"Full Config Preprocessor",test:function(t){return/^(\[server_local\]|\[Proxy\])/gm.test(t)},parse:function(t){var e;return((e=t.match(/^\[server_local|Proxy\]([\s\S]+?)^\[.+?\](\r?\n|$)/im))===null||e===void 0?void 0:e[1])||t}}];_$preprocessors_94.default=___default_94;var _$download_135={};function ___typeof_135(t){return(___typeof_135=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$download_135,"__esModule",{value:!0}),_$download_135.default=download;var _resourceCache=___interopRequireDefault_135(_$resourceCache_144),___headersResourceCache_135=___interopRequireDefault_135(_$headersResourceCache_140),___app_135=___interopRequireDefault_135(_$app_87),_preprocessors=___interopRequireDefault_135(_$preprocessors_94);function ___interopRequireDefault_135(t){return t&&t.__esModule?t:{default:t}}function ___regeneratorRuntime_135(){___regeneratorRuntime_135=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=typeof Symbol=="function"?Symbol:{},o=r.iterator||"@@iterator",f=r.asyncIterator||"@@asyncIterator",d=r.toStringTag||"@@toStringTag";function h(l,s,v){return Object.defineProperty(l,s,{value:v,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,v,$){return s[v]=$}}function y(l,s,v,$){var E=s&&s.prototype instanceof T?s:T,rt=Object.create(E.prototype),gt=new dt($||[]);return rt._invoke=function(Et,Ct,x){var N="suspendedStart";return function(G,A){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(G==="throw")throw A;return{value:void 0,done:!0}}for(x.method=G,x.arg=A;;){var C=x.delegate;if(C){var j=et(C,x);if(j){if(j===S)continue;return j}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var K=F(Et,Ct,x);if(K.type==="normal"){if(N=x.done?"completed":"suspendedYield",K.arg===S)continue;return{value:K.arg,done:x.done}}K.type==="throw"&&(N="completed",x.method="throw",x.arg=K.arg)}}}(l,v,gt),rt}function F(l,s,v){try{return{type:"normal",arg:l.call(s,v)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var S={};function T(){}function U(){}function M(){}var Y={};h(Y,o,function(){return this});var Z=Object.getPrototypeOf,D=Z&&Z(Z(ht([])));D&&D!==e&&n.call(D,o)&&(Y=D);var nt=M.prototype=T.prototype=Object.create(Y);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(v){return this._invoke(s,v)})})}function at(l,s){var v;this._invoke=function($,E){function rt(){return new s(function(gt,Et){(function Ct(x,N,G,A){var C=F(l[x],l,N);if(C.type!=="throw"){var j=C.arg,K=j.value;return K&&___typeof_135(K)=="object"&&n.call(K,"__await")?s.resolve(K.__await).then(function(J){Ct("next",J,G,A)},function(J){Ct("throw",J,G,A)}):s.resolve(K).then(function(J){j.value=J,G(j)},function(J){return Ct("throw",J,G,A)})}A(C.arg)})($,E,gt,Et)})}return v=v?v.then(rt,rt):rt()}}function et(l,s){var v=l.iterator[s.method];if(v===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,et(l,s),s.method==="throw"))return S;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var $=F(v,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,S;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,S):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,S)}function mt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function At(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function dt(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(mt,this),this.reset(!0)}function ht(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var v=-1,$=function E(){for(;++v<l.length;)if(n.call(l,v))return E.value=l[v],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:xt}}function xt(){return{value:void 0,done:!0}}return U.prototype=M,h(nt,"constructor",M),h(M,"constructor",U),U.displayName=h(M,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===U||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,M):(l.__proto__=M,h(l,d,"GeneratorFunction")),l.prototype=Object.create(nt),l},t.awrap=function(l){return{__await:l}},ct(at.prototype),h(at.prototype,f,function(){return this}),t.AsyncIterator=at,t.async=function(l,s,v,$,E){E===void 0&&(E=Promise);var rt=new at(y(l,s,v,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(gt){return gt.done?gt.value:rt.next()})},ct(nt),h(nt,d,"Generator"),h(nt,o,function(){return this}),h(nt,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var v in l)s.push(v);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=ht,dt.prototype={constructor:dt,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(At),!l)for(var s in this)s.charAt(0)==="t"&&n.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function v(Ct,x){return rt.type="throw",rt.arg=l,s.next=Ct,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return v("end");if(E.tryLoc<=this.prev){var gt=n.call(E,"catchLoc"),Et=n.call(E,"finallyLoc");if(gt&&Et){if(this.prev<E.catchLoc)return v(E.catchLoc,!0);if(this.prev<E.finallyLoc)return v(E.finallyLoc)}else if(gt){if(this.prev<E.catchLoc)return v(E.catchLoc,!0)}else{if(!Et)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return v(E.finallyLoc)}}}},abrupt:function(l,s){for(var v=this.tryEntries.length-1;v>=0;--v){var $=this.tryEntries[v];if($.tryLoc<=this.prev&&n.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,S):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),S},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.finallyLoc===l)return this.complete(v.completion,v.afterLoc),At(v),S}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.tryLoc===l){var $=v.completion;if($.type==="throw"){var E=$.arg;At(v)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,v){return this.delegate={iterator:ht(l),resultName:s,nextLoc:v},this.method==="next"&&(this.arg=void 0),S}},t}function __ownKeys_135(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function ___objectSpread_135(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_135(Object(n),!0).forEach(function(r){___defineProperty_135(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):__ownKeys_135(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ___defineProperty_135(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ___createForOfIteratorHelper_135(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=___unsupportedIterableToArray_135(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){n=n.call(t)},n:function(){var y=n.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||n.return==null||n.return()}finally{if(h)throw f}}}}function ___unsupportedIterableToArray_135(t,e){if(t){if(typeof t=="string")return ___arrayLikeToArray_135(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?___arrayLikeToArray_135(t,e):void 0}}function ___arrayLikeToArray_135(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function __asyncGeneratorStep_135(t,e,n,r,o,f,d){try{var h=t[f](d),y=h.value}catch(F){return void n(F)}h.done?e(y):Promise.resolve(y).then(r,o)}function ___asyncToGenerator_135(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var f=t.apply(e,n);function d(y){__asyncGeneratorStep_135(f,r,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_135(f,r,o,d,h,"throw",y)}d(void 0)})}}var clashPreprocessor=_preprocessors.default.find(function(t){return t.name==="Clash Pre-processor"}),tasks=new Map;function download(){return _download.apply(this,arguments)}function _download(){return _download=___asyncToGenerator_135(___regeneratorRuntime_135().mark(function _callee(){var _$arguments,_$arguments2,_$arguments3,_$arguments6,_$arguments11,rawUrl,ua,timeout,customProxy,skipCustomCache,awaitCustomCache,noCache,preprocess,$arguments,url,rawArgs,_iterator,_step,pair,key,value,_ENV,isNode,isStash,isLoon,isShadowRocket,isQX,_$$read,defaultProxy,defaultUserAgent,defaultTimeout,defaultCacheThreshold,cacheThreshold,proxy,userAgent,requestTimeout,id,customCacheKey,_$arguments4,customCached,_cached,_e$message,_$arguments5,http,result,cached,_$arguments7,_$arguments8,insecure,_yield$http$get,body,headers,statusCode,flowInfo,shouldCache,size,_$arguments9,_e$message4,_cached2,_e$message3,_$arguments10,_args=arguments;return ___regeneratorRuntime_135().wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(rawUrl=_args.length>0&&_args[0]!==void 0?_args[0]:"",ua=_args.length>1?_args[1]:void 0,timeout=_args.length>2?_args[2]:void 0,customProxy=_args.length>3?_args[3]:void 0,skipCustomCache=_args.length>4?_args[4]:void 0,awaitCustomCache=_args.length>5?_args[5]:void 0,noCache=_args.length>6?_args[6]:void 0,preprocess=_args.length>7?_args[7]:void 0,$arguments={},url=rawUrl.replace(/#noFlow$/,""),rawArgs=url.split("#"),url=url.split("#")[0],rawArgs.length>1)try{$arguments=JSON.parse(decodeURIComponent(rawArgs[1]))}catch{_iterator=___createForOfIteratorHelper_135(rawArgs[1].split("&"));try{for(_iterator.s();!(_step=_iterator.n()).done;)pair=_step.value,key=pair.split("=")[0],value=pair.split("=")[1],$arguments[key]=value==null||value===""||decodeURIComponent(value)}catch(e){_iterator.e(e)}finally{_iterator.f()}}if(_ENV=(0,_$openApi_151.ENV)(),isNode=_ENV.isNode,isStash=_ENV.isStash,isLoon=_ENV.isLoon,isShadowRocket=_ENV.isShadowRocket,isQX=_ENV.isQX,_$$read=___app_135.default.read(_$constants_86.SETTINGS_KEY),defaultProxy=_$$read.defaultProxy,defaultUserAgent=_$$read.defaultUserAgent,defaultTimeout=_$$read.defaultTimeout,defaultCacheThreshold=_$$read.cacheThreshold,cacheThreshold=defaultCacheThreshold||1024,proxy=customProxy||defaultProxy,___app_135.default.env.isNode&&(proxy=proxy||eval("process.env.SUB_STORE_BACKEND_DEFAULT_PROXY")),userAgent=ua||defaultUserAgent||"clash.meta",requestTimeout=timeout||defaultTimeout||8e3,id=(0,_$md5_150.hex_md5)(userAgent+url),((_$arguments=$arguments)===null||_$arguments===void 0?void 0:_$arguments.cacheKey)===!0&&(___app_135.default.error("\u4F7F\u7528\u81EA\u5B9A\u4E49\u7F13\u5B58\u65F6 cacheKey \u7684\u503C\u4E0D\u80FD\u4E3A\u7A7A"),$arguments.cacheKey=void 0),customCacheKey=(_$arguments2=$arguments)!==null&&_$arguments2!==void 0&&_$arguments2.cacheKey?"#sub-store-cached-custom-".concat((_$arguments3=$arguments)===null||_$arguments3===void 0?void 0:_$arguments3.cacheKey):void 0,!customCacheKey||skipCustomCache){_context.next=47;break}if(customCached=___app_135.default.read(customCacheKey),_cached=_resourceCache.default.get(id),noCache||(_$arguments4=$arguments)!==null&&_$arguments4!==void 0&&_$arguments4.noCache||!_cached){_context.next=29;break}return ___app_135.default.info("\u4E50\u89C2\u7F13\u5B58: URL ".concat(url,`
\u5B58\u5728\u6709\u6548\u7684\u5E38\u89C4\u7F13\u5B58
\u4F7F\u7528\u5E38\u89C4\u7F13\u5B58\u4EE5\u907F\u514D\u91CD\u590D\u8BF7\u6C42`)),_context.abrupt("return",_cached);case 29:if(!customCached){_context.next=47;break}if(!awaitCustomCache){_context.next=44;break}return ___app_135.default.info("\u4E50\u89C2\u7F13\u5B58: URL ".concat(url,`
\u672C\u6B21\u8FDB\u884C\u8BF7\u6C42 \u5C1D\u8BD5\u66F4\u65B0\u7F13\u5B58`)),_context.prev=32,_context.next=35,download(rawUrl.replace(/(\?|&)cacheKey=.*?(&|$)/,""),ua,timeout,proxy,!0,void 0,void 0,preprocess);case 35:_context.next=42;break;case 37:_context.prev=37,_context.t0=_context.catch(32),___app_135.default.error("\u4E50\u89C2\u7F13\u5B58: URL ".concat(url," \u66F4\u65B0\u7F13\u5B58\u53D1\u751F\u9519\u8BEF ").concat((_e$message=_context.t0.message)!==null&&_e$message!==void 0?_e$message:_context.t0)),___app_135.default.info("\u4F7F\u7528\u4E50\u89C2\u7F13\u5B58\u7684\u6570\u636E\u5237\u65B0\u7F13\u5B58, \u9632\u6B62\u540E\u7EED\u8BF7\u6C42"),_resourceCache.default.set(id,customCached);case 42:_context.next=46;break;case 44:___app_135.default.info("\u4E50\u89C2\u7F13\u5B58: URL ".concat(url,`
\u672C\u6B21\u8FD4\u56DE\u81EA\u5B9A\u4E49\u7F13\u5B58 `).concat((_$arguments5=$arguments)===null||_$arguments5===void 0?void 0:_$arguments5.cacheKey,`
\u5E76\u8FDB\u884C\u8BF7\u6C42 \u5C1D\u8BD5\u5F02\u6B65\u66F4\u65B0\u7F13\u5B58`)),download(rawUrl.replace(/(\?|&)cacheKey=.*?(&|$)/,""),ua,timeout,proxy,!0,void 0,void 0,preprocess).catch(function(t){var e;___app_135.default.error("\u4E50\u89C2\u7F13\u5B58: URL ".concat(url," \u5F02\u6B65\u66F4\u65B0\u7F13\u5B58\u53D1\u751F\u9519\u8BEF ").concat((e=t.message)!==null&&e!==void 0?e:t))});case 46:return _context.abrupt("return",customCached);case 47:if(isNode||!tasks.has(id)){_context.next=49;break}return _context.abrupt("return",tasks.get(id));case 49:if(http=(0,_$openApi_151.HTTP)({headers:___objectSpread_135(___objectSpread_135({"User-Agent":userAgent},isStash&&proxy?{"X-Stash-Selected-Proxy":encodeURIComponent(proxy)}:{}),isShadowRocket&&proxy?{"X-Surge-Policy":proxy}:{}),timeout:requestTimeout}),cached=_resourceCache.default.get(id),noCache||(_$arguments6=$arguments)!==null&&_$arguments6!==void 0&&_$arguments6.noCache||!cached){_context.next=57;break}___app_135.default.info("\u4F7F\u7528\u7F13\u5B58: ".concat(url,", ").concat(userAgent)),result=cached,customCacheKey&&(___app_135.default.info("URL ".concat(url,`
\u5199\u5165\u81EA\u5B9A\u4E49\u7F13\u5B58 `).concat((_$arguments7=$arguments)===null||_$arguments7===void 0?void 0:_$arguments7.cacheKey)),___app_135.default.write(cached,customCacheKey)),_context.next=87;break;case 57:return insecure=(_$arguments8=$arguments)!==null&&_$arguments8!==void 0&&_$arguments8.insecure?isNode?{strictSSL:!1}:{insecure:!0}:void 0,___app_135.default.info(`Downloading...
User-Agent: `.concat(userAgent,`
Timeout: `).concat(requestTimeout,`
Proxy: `).concat(proxy,`
Insecure: `).concat(!!insecure,`
Preprocess: `).concat(preprocess,`
URL: `).concat(url)),_context.prev=59,_context.next=62,http.get(___objectSpread_135(___objectSpread_135(___objectSpread_135(___objectSpread_135(___objectSpread_135({url},proxy?{proxy}:{}),isLoon&&proxy?{node:proxy}:{}),isQX&&proxy?{opts:{policy:proxy}}:{}),proxy?(0,_$utils_141.getPolicyDescriptor)(proxy):{}),insecure||{}));case 62:if(_yield$http$get=_context.sent,body=_yield$http$get.body,headers=_yield$http$get.headers,statusCode=_yield$http$get.statusCode,___app_135.default.info("statusCode: ".concat(statusCode)),!(statusCode<200||statusCode>=400)){_context.next=69;break}throw new Error("statusCode: ".concat(statusCode));case 69:if(headers&&(flowInfo=(0,_$flow_137.getFlowField)(headers),flowInfo&&___headersResourceCache_135.default.set(id,flowInfo)),body.replace(/\s/g,"").length!==0){_context.next=72;break}throw new Error(new Error("\u8FDC\u7A0B\u8D44\u6E90\u5185\u5BB9\u4E3A\u7A7A"));case 72:if(preprocess)try{clashPreprocessor.test(body)&&(body=clashPreprocessor.parse(body,!0))}catch(t){___app_135.default.error("Clash Pre-processor error: ".concat(t))}shouldCache=!0,cacheThreshold&&(size=body.length/1024,size>cacheThreshold&&(___app_135.default.info("\u8D44\u6E90\u5927\u5C0F ".concat(size.toFixed(2)," KB \u8D85\u8FC7\u4E86 ").concat(cacheThreshold," KB, \u4E0D\u7F13\u5B58")),shouldCache=!1)),shouldCache&&(_resourceCache.default.set(id,body),customCacheKey&&(___app_135.default.info("URL ".concat(url,`
\u5199\u5165\u81EA\u5B9A\u4E49\u7F13\u5B58 `).concat((_$arguments9=$arguments)===null||_$arguments9===void 0?void 0:_$arguments9.cacheKey)),___app_135.default.write(body,customCacheKey))),result=body,_context.next=87;break;case 79:if(_context.prev=79,_context.t1=_context.catch(59),!customCacheKey){_context.next=86;break}if(_cached2=___app_135.default.read(customCacheKey),!_cached2){_context.next=86;break}return ___app_135.default.info("\u65E0\u6CD5\u4E0B\u8F7D URL ".concat(url,": ").concat((_e$message3=_context.t1.message)!==null&&_e$message3!==void 0?_e$message3:_context.t1,`
\u4F7F\u7528\u81EA\u5B9A\u4E49\u7F13\u5B58 `).concat((_$arguments10=$arguments)===null||_$arguments10===void 0?void 0:_$arguments10.cacheKey)),_context.abrupt("return",_cached2);case 86:throw new Error("\u65E0\u6CD5\u4E0B\u8F7D URL ".concat(url,": ").concat((_e$message4=_context.t1.message)!==null&&_e$message4!==void 0?_e$message4:_context.t1));case 87:if((_$arguments11=$arguments)===null||_$arguments11===void 0||!_$arguments11.validCheck){_context.next=96;break}return _context.t2=_$flow_137.validCheck,_context.t3=_$flow_137.parseFlowHeaders,_context.next=92,(0,_$flow_137.getFlowHeaders)(url,$arguments.flowUserAgent,void 0,proxy,$arguments.flowUrl);case 92:return _context.t4=_context.sent,_context.t5=(0,_context.t3)(_context.t4),_context.next=96,(0,_context.t2)(_context.t5);case 96:return isNode||tasks.set(id,result),_context.abrupt("return",result);case 98:case"end":return _context.stop()}},_callee,null,[[32,37],[59,79]])})),_download.apply(this,arguments)}var _$response_127={};Object.defineProperty(_$response_127,"__esModule",{value:!0}),_$response_127.failed=function(t,e,n){t.status(n||500).json({status:"failed",error:{code:e.code,type:e.type,message:e.message,details:e.details}})},_$response_127.success=function(t,e,n){t.status(n||200).json({status:"success",data:e})};var _$errors_119={};function ___typeof_119(t){return(___typeof_119=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function _inherits(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(t,e)}function _createSuper(t){var e=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var n,r=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(f,d){if(d&&(___typeof_119(d)==="object"||typeof d=="function"))return d;if(d!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(h){if(h===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h}(f)}(this,n)}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(t)}function ___defineProperties_119(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ___createClass_119(t,e,n){return e&&___defineProperties_119(t.prototype,e),n&&___defineProperties_119(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ___classCallCheck_119(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(_$errors_119,"__esModule",{value:!0}),_$errors_119.ResourceNotFoundError=_$errors_119.RequestInvalidError=_$errors_119.NetworkError=_$errors_119.InternalServerError=void 0;var BaseError=___createClass_119(function t(e,n,r){___classCallCheck_119(this,t),this.code=e,this.message=n,this.details=r}),InternalServerError=function(t){_inherits(n,BaseError);var e=_createSuper(n);function n(r,o,f){var d;return ___classCallCheck_119(this,n),(d=e.call(this,r,o,f)).type="InternalServerError",d}return ___createClass_119(n)}();_$errors_119.InternalServerError=InternalServerError;var RequestInvalidError=function(t){_inherits(n,BaseError);var e=_createSuper(n);function n(r,o,f){var d;return ___classCallCheck_119(this,n),(d=e.call(this,r,o,f)).type="RequestInvalidError",d}return ___createClass_119(n)}();_$errors_119.RequestInvalidError=RequestInvalidError;var ResourceNotFoundError=function(t){_inherits(n,BaseError);var e=_createSuper(n);function n(r,o,f){var d;return ___classCallCheck_119(this,n),(d=e.call(this,r,o,f)).type="ResourceNotFoundError",d}return ___createClass_119(n)}();_$errors_119.ResourceNotFoundError=ResourceNotFoundError;var NetworkError=function(t){_inherits(n,BaseError);var e=_createSuper(n);function n(r,o,f){var d;return ___classCallCheck_119(this,n),(d=e.call(this,r,o,f)).type="NetworkError",d}return ___createClass_119(n)}();_$errors_119.NetworkError=NetworkError;var _$database_133={};function findIndexByName(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"name";return t.findIndex(function(r){return r[n]===e})}Object.defineProperty(_$database_133,"__esModule",{value:!0}),_$database_133.deleteByName=function(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"name",r=findIndexByName(t,e,n);t.splice(r,1)},_$database_133.findByName=function(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"name";return t.find(function(r){return r[n]===e})},_$database_133.findIndexByName=findIndexByName,_$database_133.updateByName=function(t,e,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"name",o=findIndexByName(t,e,r);t[o]=n};var _$jsrsasign_52={};(function(t){(function(){var e,n,r,o,f,d,h,y,F,S,T,U={userAgent:!1},M={},Y=Y||(e=Math,r=(n={}).lib={},o=r.Base=function(){function a(){}return{extend:function(u){a.prototype=this;var p=new a;return u&&p.mixIn(u),p.hasOwnProperty("init")||(p.init=function(){p.$super.init.apply(this,arguments)}),p.init.prototype=p,p.$super=this,p},create:function(){var u=this.extend();return u.init.apply(u,arguments),u},init:function(){},mixIn:function(u){for(var p in u)u.hasOwnProperty(p)&&(this[p]=u[p]);u.hasOwnProperty("toString")&&(this.toString=u.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=r.WordArray=o.extend({init:function(a,u){a=this.words=a||[],this.sigBytes=u??4*a.length},toString:function(a){return(a||h).stringify(this)},concat:function(a){var u=this.words,p=a.words,g=this.sigBytes,m=a.sigBytes;if(this.clamp(),g%4)for(var w=0;w<m;w++){var O=p[w>>>2]>>>24-w%4*8&255;u[g+w>>>2]|=O<<24-(g+w)%4*8}else for(w=0;w<m;w+=4)u[g+w>>>2]=p[w>>>2];return this.sigBytes+=m,this},clamp:function(){var a=this.words,u=this.sigBytes;a[u>>>2]&=4294967295<<32-u%4*8,a.length=e.ceil(u/4)},clone:function(){var a=o.clone.call(this);return a.words=this.words.slice(0),a},random:function(a){for(var u=[],p=0;p<a;p+=4)u.push(4294967296*e.random()|0);return new f.init(u,a)}}),d=n.enc={},h=d.Hex={stringify:function(a){for(var u=a.words,p=a.sigBytes,g=[],m=0;m<p;m++){var w=u[m>>>2]>>>24-m%4*8&255;g.push((w>>>4).toString(16)),g.push((15&w).toString(16))}return g.join("")},parse:function(a){for(var u=a.length,p=[],g=0;g<u;g+=2)p[g>>>3]|=parseInt(a.substr(g,2),16)<<24-g%8*4;return new f.init(p,u/2)}},y=d.Latin1={stringify:function(a){for(var u=a.words,p=a.sigBytes,g=[],m=0;m<p;m++){var w=u[m>>>2]>>>24-m%4*8&255;g.push(String.fromCharCode(w))}return g.join("")},parse:function(a){for(var u=a.length,p=[],g=0;g<u;g++)p[g>>>2]|=(255&a.charCodeAt(g))<<24-g%4*8;return new f.init(p,u)}},F=d.Utf8={stringify:function(a){try{return decodeURIComponent(escape(y.stringify(a)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(a){return y.parse(unescape(encodeURIComponent(a)))}},S=r.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(a){typeof a=="string"&&(a=F.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(a){var u=this._data,p=u.words,g=u.sigBytes,m=this.blockSize,w=g/(4*m),O=(w=a?e.ceil(w):e.max((0|w)-this._minBufferSize,0))*m,R=e.min(4*O,g);if(O){for(var P=0;P<O;P+=m)this._doProcessBlock(p,P);var B=p.splice(0,O);u.sigBytes-=R}return new f.init(B,R)},clone:function(){var a=o.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0}),r.Hasher=S.extend({cfg:o.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){S.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(u,p){return new a.init(p).finalize(u)}},_createHmacHelper:function(a){return function(u,p){return new T.HMAC.init(a,p).finalize(u)}}}),T=n.algo={},n);(function(a){var u,p=(u=Y).lib,g=p.Base,m=p.WordArray;(u=u.x64={}).Word=g.extend({init:function(w,O){this.high=w,this.low=O}}),u.WordArray=g.extend({init:function(w,O){w=this.words=w||[],this.sigBytes=O??8*w.length},toX32:function(){for(var w=this.words,O=w.length,R=[],P=0;P<O;P++){var B=w[P];R.push(B.high),R.push(B.low)}return m.create(R,this.sigBytes)},clone:function(){for(var w=g.clone.call(this),O=w.words=this.words.slice(0),R=O.length,P=0;P<R;P++)O[P]=O[P].clone();return w}})})(),Y.lib.Cipher||function(a){var u=(H=Y).lib,p=u.Base,g=u.WordArray,m=u.BufferedBlockAlgorithm,w=H.enc.Base64,O=H.algo.EvpKDF,R=u.Cipher=m.extend({cfg:p.extend(),createEncryptor:function(z,st){return this.create(this._ENC_XFORM_MODE,z,st)},createDecryptor:function(z,st){return this.create(this._DEC_XFORM_MODE,z,st)},init:function(z,st,bt){this.cfg=this.cfg.extend(bt),this._xformMode=z,this._key=st,this.reset()},reset:function(){m.reset.call(this),this._doReset()},process:function(z){return this._append(z),this._process()},finalize:function(z){return z&&this._append(z),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(z){return{encrypt:function(st,bt,It){return(typeof bt=="string"?W:k).encrypt(z,st,bt,It)},decrypt:function(st,bt,It){return(typeof bt=="string"?W:k).decrypt(z,st,bt,It)}}}});u.StreamCipher=R.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var P=H.mode={},B=function(z,st,bt){var It=this._iv;It?this._iv=void 0:It=this._prevBlock;for(var Mt=0;Mt<bt;Mt++)z[st+Mt]^=It[Mt]},q=(u.BlockCipherMode=p.extend({createEncryptor:function(z,st){return this.Encryptor.create(z,st)},createDecryptor:function(z,st){return this.Decryptor.create(z,st)},init:function(z,st){this._cipher=z,this._iv=st}})).extend();q.Encryptor=q.extend({processBlock:function(z,st){var bt=this._cipher,It=bt.blockSize;B.call(this,z,st,It),bt.encryptBlock(z,st),this._prevBlock=z.slice(st,st+It)}}),q.Decryptor=q.extend({processBlock:function(z,st){var bt=this._cipher,It=bt.blockSize,Mt=z.slice(st,st+It);bt.decryptBlock(z,st),B.call(this,z,st,It),this._prevBlock=Mt}}),P=P.CBC=q,q=(H.pad={}).Pkcs7={pad:function(z,st){for(var bt,It=(bt=(bt=4*st)-z.sigBytes%bt)<<24|bt<<16|bt<<8|bt,Mt=[],Lt=0;Lt<bt;Lt+=4)Mt.push(It);bt=g.create(Mt,bt),z.concat(bt)},unpad:function(z){z.sigBytes-=255&z.words[z.sigBytes-1>>>2]}},u.BlockCipher=R.extend({cfg:R.cfg.extend({mode:P,padding:q}),reset:function(){R.reset.call(this);var z=(st=this.cfg).iv,st=st.mode;if(this._xformMode==this._ENC_XFORM_MODE)var bt=st.createEncryptor;else bt=st.createDecryptor,this._minBufferSize=1;this._mode=bt.call(st,this,z&&z.words)},_doProcessBlock:function(z,st){this._mode.processBlock(z,st)},_doFinalize:function(){var z=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){z.pad(this._data,this.blockSize);var st=this._process(!0)}else st=this._process(!0),z.unpad(st);return st},blockSize:4});var L=u.CipherParams=p.extend({init:function(z){this.mixIn(z)},toString:function(z){return(z||this.formatter).stringify(this)}}),k=(P=(H.format={}).OpenSSL={stringify:function(z){var st=z.ciphertext;return((z=z.salt)?g.create([1398893684,1701076831]).concat(z).concat(st):st).toString(w)},parse:function(z){var st=(z=w.parse(z)).words;if(st[0]==1398893684&&st[1]==1701076831){var bt=g.create(st.slice(2,4));st.splice(0,4),z.sigBytes-=16}return L.create({ciphertext:z,salt:bt})}},u.SerializableCipher=p.extend({cfg:p.extend({format:P}),encrypt:function(z,st,bt,It){It=this.cfg.extend(It);var Mt=z.createEncryptor(bt,It);return st=Mt.finalize(st),Mt=Mt.cfg,L.create({ciphertext:st,key:bt,iv:Mt.iv,algorithm:z,mode:Mt.mode,padding:Mt.padding,blockSize:z.blockSize,formatter:It.format})},decrypt:function(z,st,bt,It){return It=this.cfg.extend(It),st=this._parse(st,It.format),z.createDecryptor(bt,It).finalize(st.ciphertext)},_parse:function(z,st){return typeof z=="string"?st.parse(z,this):z}})),H=(H.kdf={}).OpenSSL={execute:function(z,st,bt,It){return It||(It=g.random(8)),z=O.create({keySize:st+bt}).compute(z,It),bt=g.create(z.words.slice(st),4*bt),z.sigBytes=4*st,L.create({key:z,iv:bt,salt:It})}},W=u.PasswordBasedCipher=k.extend({cfg:k.cfg.extend({kdf:H}),encrypt:function(z,st,bt,It){return bt=(It=this.cfg.extend(It)).kdf.execute(bt,z.keySize,z.ivSize),It.iv=bt.iv,(z=k.encrypt.call(this,z,st,bt.key,It)).mixIn(bt),z},decrypt:function(z,st,bt,It){return It=this.cfg.extend(It),st=this._parse(st,It.format),bt=It.kdf.execute(bt,z.keySize,z.ivSize,st.salt),It.iv=bt.iv,k.decrypt.call(this,z,st,bt.key,It)}})}(),function(){for(var a=Y,u=a.lib.BlockCipher,p=a.algo,g=[],m=[],w=[],O=[],R=[],P=[],B=[],q=[],L=[],k=[],H=[],W=0;256>W;W++)H[W]=128>W?W<<1:W<<1^283;var z=0,st=0;for(W=0;256>W;W++){var bt=(bt=st^st<<1^st<<2^st<<3^st<<4)>>>8^255&bt^99;g[z]=bt,m[bt]=z;var It=H[z],Mt=H[It],Lt=H[Mt],tt=257*H[bt]^16843008*bt;w[z]=tt<<24|tt>>>8,O[z]=tt<<16|tt>>>16,R[z]=tt<<8|tt>>>24,P[z]=tt,tt=16843009*Lt^65537*Mt^257*It^16843008*z,B[bt]=tt<<24|tt>>>8,q[bt]=tt<<16|tt>>>16,L[bt]=tt<<8|tt>>>24,k[bt]=tt,z?(z=It^H[H[H[Lt^It]]],st^=H[H[st]]):z=st=1}var ut=[0,1,2,4,8,16,32,64,128,27,54];p=p.AES=u.extend({_doReset:function(){for(var pt=(wt=this._key).words,it=wt.sigBytes/4,wt=4*((this._nRounds=it+6)+1),$t=this._keySchedule=[],Wt=0;Wt<wt;Wt++)if(Wt<it)$t[Wt]=pt[Wt];else{var Ht=$t[Wt-1];Wt%it?6<it&&Wt%it==4&&(Ht=g[Ht>>>24]<<24|g[Ht>>>16&255]<<16|g[Ht>>>8&255]<<8|g[255&Ht]):(Ht=g[(Ht=Ht<<8|Ht>>>24)>>>24]<<24|g[Ht>>>16&255]<<16|g[Ht>>>8&255]<<8|g[255&Ht],Ht^=ut[Wt/it|0]<<24),$t[Wt]=$t[Wt-it]^Ht}for(pt=this._invKeySchedule=[],it=0;it<wt;it++)Wt=wt-it,Ht=it%4?$t[Wt]:$t[Wt-4],pt[it]=4>it||4>=Wt?Ht:B[g[Ht>>>24]]^q[g[Ht>>>16&255]]^L[g[Ht>>>8&255]]^k[g[255&Ht]]},encryptBlock:function(pt,it){this._doCryptBlock(pt,it,this._keySchedule,w,O,R,P,g)},decryptBlock:function(pt,it){var wt=pt[it+1];pt[it+1]=pt[it+3],pt[it+3]=wt,this._doCryptBlock(pt,it,this._invKeySchedule,B,q,L,k,m),wt=pt[it+1],pt[it+1]=pt[it+3],pt[it+3]=wt},_doCryptBlock:function(pt,it,wt,$t,Wt,Ht,Se,zt){for(var Q=this._nRounds,ft=pt[it]^wt[0],vt=pt[it+1]^wt[1],Rt=pt[it+2]^wt[2],Ft=pt[it+3]^wt[3],Nt=4,re=1;re<Q;re++){var te=$t[ft>>>24]^Wt[vt>>>16&255]^Ht[Rt>>>8&255]^Se[255&Ft]^wt[Nt++],St=$t[vt>>>24]^Wt[Rt>>>16&255]^Ht[Ft>>>8&255]^Se[255&ft]^wt[Nt++],kt=$t[Rt>>>24]^Wt[Ft>>>16&255]^Ht[ft>>>8&255]^Se[255&vt]^wt[Nt++];Ft=$t[Ft>>>24]^Wt[ft>>>16&255]^Ht[vt>>>8&255]^Se[255&Rt]^wt[Nt++],ft=te,vt=St,Rt=kt}te=(zt[ft>>>24]<<24|zt[vt>>>16&255]<<16|zt[Rt>>>8&255]<<8|zt[255&Ft])^wt[Nt++],St=(zt[vt>>>24]<<24|zt[Rt>>>16&255]<<16|zt[Ft>>>8&255]<<8|zt[255&ft])^wt[Nt++],kt=(zt[Rt>>>24]<<24|zt[Ft>>>16&255]<<16|zt[ft>>>8&255]<<8|zt[255&vt])^wt[Nt++],Ft=(zt[Ft>>>24]<<24|zt[ft>>>16&255]<<16|zt[vt>>>8&255]<<8|zt[255&Rt])^wt[Nt++],pt[it]=te,pt[it+1]=St,pt[it+2]=kt,pt[it+3]=Ft},keySize:8}),a.AES=u._createHelper(p)}(),function(){function a(k,H){var W=(this._lBlock>>>k^this._rBlock)&H;this._rBlock^=W,this._lBlock^=W<<k}function u(k,H){var W=(this._rBlock>>>k^this._lBlock)&H;this._lBlock^=W,this._rBlock^=W<<k}var p=Y,g=(m=p.lib).WordArray,m=m.BlockCipher,w=p.algo,O=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],R=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],P=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],B=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],q=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],L=w.DES=m.extend({_doReset:function(){for(var k=this._key.words,H=[],W=0;56>W;W++){var z=O[W]-1;H[W]=k[z>>>5]>>>31-z%32&1}for(k=this._subKeys=[],z=0;16>z;z++){var st=k[z]=[],bt=P[z];for(W=0;24>W;W++)st[W/6|0]|=H[(R[W]-1+bt)%28]<<31-W%6,st[4+(W/6|0)]|=H[28+(R[W+24]-1+bt)%28]<<31-W%6;for(st[0]=st[0]<<1|st[0]>>>31,W=1;7>W;W++)st[W]>>>=4*(W-1)+3;st[7]=st[7]<<5|st[7]>>>27}for(H=this._invSubKeys=[],W=0;16>W;W++)H[W]=k[15-W]},encryptBlock:function(k,H){this._doCryptBlock(k,H,this._subKeys)},decryptBlock:function(k,H){this._doCryptBlock(k,H,this._invSubKeys)},_doCryptBlock:function(k,H,W){this._lBlock=k[H],this._rBlock=k[H+1],a.call(this,4,252645135),a.call(this,16,65535),u.call(this,2,858993459),u.call(this,8,16711935),a.call(this,1,1431655765);for(var z=0;16>z;z++){for(var st=W[z],bt=this._lBlock,It=this._rBlock,Mt=0,Lt=0;8>Lt;Lt++)Mt|=B[Lt][((It^st[Lt])&q[Lt])>>>0];this._lBlock=It,this._rBlock=bt^Mt}W=this._lBlock,this._lBlock=this._rBlock,this._rBlock=W,a.call(this,1,1431655765),u.call(this,8,16711935),u.call(this,2,858993459),a.call(this,16,65535),a.call(this,4,252645135),k[H]=this._lBlock,k[H+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});p.DES=m._createHelper(L),w=w.TripleDES=m.extend({_doReset:function(){var k=this._key.words;this._des1=L.createEncryptor(g.create(k.slice(0,2))),this._des2=L.createEncryptor(g.create(k.slice(2,4))),this._des3=L.createEncryptor(g.create(k.slice(4,6)))},encryptBlock:function(k,H){this._des1.encryptBlock(k,H),this._des2.decryptBlock(k,H),this._des3.encryptBlock(k,H)},decryptBlock:function(k,H){this._des3.decryptBlock(k,H),this._des2.encryptBlock(k,H),this._des1.decryptBlock(k,H)},keySize:6,ivSize:2,blockSize:2}),p.TripleDES=m._createHelper(w)}(),function(){var a=Y,u=a.lib.WordArray;a.enc.Base64={stringify:function(p){var g=p.words,m=p.sigBytes,w=this._map;p.clamp(),p=[];for(var O=0;O<m;O+=3)for(var R=(g[O>>>2]>>>24-O%4*8&255)<<16|(g[O+1>>>2]>>>24-(O+1)%4*8&255)<<8|g[O+2>>>2]>>>24-(O+2)%4*8&255,P=0;4>P&&O+.75*P<m;P++)p.push(w.charAt(R>>>6*(3-P)&63));if(g=w.charAt(64))for(;p.length%4;)p.push(g);return p.join("")},parse:function(p){var g=p.length,m=this._map;(w=m.charAt(64))&&(w=p.indexOf(w))!=-1&&(g=w);for(var w=[],O=0,R=0;R<g;R++)if(R%4){var P=m.indexOf(p.charAt(R-1))<<R%4*2,B=m.indexOf(p.charAt(R))>>>6-R%4*2;w[O>>>2]|=(P|B)<<24-O%4*8,O++}return u.create(w,O)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(a){function u(L,k,H,W,z,st,bt){return((L=L+(k&H|~k&W)+z+bt)<<st|L>>>32-st)+k}function p(L,k,H,W,z,st,bt){return((L=L+(k&W|H&~W)+z+bt)<<st|L>>>32-st)+k}function g(L,k,H,W,z,st,bt){return((L=L+(k^H^W)+z+bt)<<st|L>>>32-st)+k}function m(L,k,H,W,z,st,bt){return((L=L+(H^(k|~W))+z+bt)<<st|L>>>32-st)+k}for(var w=Y,O=(P=w.lib).WordArray,R=P.Hasher,P=w.algo,B=[],q=0;64>q;q++)B[q]=4294967296*a.abs(a.sin(q+1))|0;P=P.MD5=R.extend({_doReset:function(){this._hash=new O.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(L,k){for(var H=0;16>H;H++){var W=L[z=k+H];L[z]=16711935&(W<<8|W>>>24)|4278255360&(W<<24|W>>>8)}H=this._hash.words;var z=L[k+0],st=(W=L[k+1],L[k+2]),bt=L[k+3],It=L[k+4],Mt=L[k+5],Lt=L[k+6],tt=L[k+7],ut=L[k+8],pt=L[k+9],it=L[k+10],wt=L[k+11],$t=L[k+12],Wt=L[k+13],Ht=L[k+14],Se=L[k+15],zt=u(zt=H[0],vt=H[1],ft=H[2],Q=H[3],z,7,B[0]),Q=u(Q,zt,vt,ft,W,12,B[1]),ft=u(ft,Q,zt,vt,st,17,B[2]),vt=u(vt,ft,Q,zt,bt,22,B[3]);zt=u(zt,vt,ft,Q,It,7,B[4]),Q=u(Q,zt,vt,ft,Mt,12,B[5]),ft=u(ft,Q,zt,vt,Lt,17,B[6]),vt=u(vt,ft,Q,zt,tt,22,B[7]),zt=u(zt,vt,ft,Q,ut,7,B[8]),Q=u(Q,zt,vt,ft,pt,12,B[9]),ft=u(ft,Q,zt,vt,it,17,B[10]),vt=u(vt,ft,Q,zt,wt,22,B[11]),zt=u(zt,vt,ft,Q,$t,7,B[12]),Q=u(Q,zt,vt,ft,Wt,12,B[13]),ft=u(ft,Q,zt,vt,Ht,17,B[14]),zt=p(zt,vt=u(vt,ft,Q,zt,Se,22,B[15]),ft,Q,W,5,B[16]),Q=p(Q,zt,vt,ft,Lt,9,B[17]),ft=p(ft,Q,zt,vt,wt,14,B[18]),vt=p(vt,ft,Q,zt,z,20,B[19]),zt=p(zt,vt,ft,Q,Mt,5,B[20]),Q=p(Q,zt,vt,ft,it,9,B[21]),ft=p(ft,Q,zt,vt,Se,14,B[22]),vt=p(vt,ft,Q,zt,It,20,B[23]),zt=p(zt,vt,ft,Q,pt,5,B[24]),Q=p(Q,zt,vt,ft,Ht,9,B[25]),ft=p(ft,Q,zt,vt,bt,14,B[26]),vt=p(vt,ft,Q,zt,ut,20,B[27]),zt=p(zt,vt,ft,Q,Wt,5,B[28]),Q=p(Q,zt,vt,ft,st,9,B[29]),ft=p(ft,Q,zt,vt,tt,14,B[30]),zt=g(zt,vt=p(vt,ft,Q,zt,$t,20,B[31]),ft,Q,Mt,4,B[32]),Q=g(Q,zt,vt,ft,ut,11,B[33]),ft=g(ft,Q,zt,vt,wt,16,B[34]),vt=g(vt,ft,Q,zt,Ht,23,B[35]),zt=g(zt,vt,ft,Q,W,4,B[36]),Q=g(Q,zt,vt,ft,It,11,B[37]),ft=g(ft,Q,zt,vt,tt,16,B[38]),vt=g(vt,ft,Q,zt,it,23,B[39]),zt=g(zt,vt,ft,Q,Wt,4,B[40]),Q=g(Q,zt,vt,ft,z,11,B[41]),ft=g(ft,Q,zt,vt,bt,16,B[42]),vt=g(vt,ft,Q,zt,Lt,23,B[43]),zt=g(zt,vt,ft,Q,pt,4,B[44]),Q=g(Q,zt,vt,ft,$t,11,B[45]),ft=g(ft,Q,zt,vt,Se,16,B[46]),zt=m(zt,vt=g(vt,ft,Q,zt,st,23,B[47]),ft,Q,z,6,B[48]),Q=m(Q,zt,vt,ft,tt,10,B[49]),ft=m(ft,Q,zt,vt,Ht,15,B[50]),vt=m(vt,ft,Q,zt,Mt,21,B[51]),zt=m(zt,vt,ft,Q,$t,6,B[52]),Q=m(Q,zt,vt,ft,bt,10,B[53]),ft=m(ft,Q,zt,vt,it,15,B[54]),vt=m(vt,ft,Q,zt,W,21,B[55]),zt=m(zt,vt,ft,Q,ut,6,B[56]),Q=m(Q,zt,vt,ft,Se,10,B[57]),ft=m(ft,Q,zt,vt,Lt,15,B[58]),vt=m(vt,ft,Q,zt,Wt,21,B[59]),zt=m(zt,vt,ft,Q,It,6,B[60]),Q=m(Q,zt,vt,ft,wt,10,B[61]),ft=m(ft,Q,zt,vt,st,15,B[62]),vt=m(vt,ft,Q,zt,pt,21,B[63]),H[0]=H[0]+zt|0,H[1]=H[1]+vt|0,H[2]=H[2]+ft|0,H[3]=H[3]+Q|0},_doFinalize:function(){var L=this._data,k=L.words,H=8*this._nDataBytes,W=8*L.sigBytes;k[W>>>5]|=128<<24-W%32;var z=a.floor(H/4294967296);for(k[15+(W+64>>>9<<4)]=16711935&(z<<8|z>>>24)|4278255360&(z<<24|z>>>8),k[14+(W+64>>>9<<4)]=16711935&(H<<8|H>>>24)|4278255360&(H<<24|H>>>8),L.sigBytes=4*(k.length+1),this._process(),k=(L=this._hash).words,H=0;4>H;H++)W=k[H],k[H]=16711935&(W<<8|W>>>24)|4278255360&(W<<24|W>>>8);return L},clone:function(){var L=R.clone.call(this);return L._hash=this._hash.clone(),L}}),w.MD5=R._createHelper(P),w.HmacMD5=R._createHmacHelper(P)}(Math),function(){var a=Y,u=(m=a.lib).WordArray,p=m.Hasher,g=[],m=a.algo.SHA1=p.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(w,O){for(var R=this._hash.words,P=R[0],B=R[1],q=R[2],L=R[3],k=R[4],H=0;80>H;H++){if(16>H)g[H]=0|w[O+H];else{var W=g[H-3]^g[H-8]^g[H-14]^g[H-16];g[H]=W<<1|W>>>31}W=(P<<5|P>>>27)+k+g[H],W=20>H?W+(1518500249+(B&q|~B&L)):40>H?W+(1859775393+(B^q^L)):60>H?W+((B&q|B&L|q&L)-1894007588):W+((B^q^L)-899497514),k=L,L=q,q=B<<30|B>>>2,B=P,P=W}R[0]=R[0]+P|0,R[1]=R[1]+B|0,R[2]=R[2]+q|0,R[3]=R[3]+L|0,R[4]=R[4]+k|0},_doFinalize:function(){var w=this._data,O=w.words,R=8*this._nDataBytes,P=8*w.sigBytes;return O[P>>>5]|=128<<24-P%32,O[14+(P+64>>>9<<4)]=Math.floor(R/4294967296),O[15+(P+64>>>9<<4)]=R,w.sigBytes=4*O.length,this._process(),this._hash},clone:function(){var w=p.clone.call(this);return w._hash=this._hash.clone(),w}});a.SHA1=p._createHelper(m),a.HmacSHA1=p._createHmacHelper(m)}(),function(a){for(var u=Y,p=(m=u.lib).WordArray,g=m.Hasher,m=u.algo,w=[],O=[],R=function(W){return 4294967296*(W-(0|W))|0},P=2,B=0;64>B;){var q;t:{q=P;for(var L=a.sqrt(q),k=2;k<=L;k++)if(!(q%k)){q=!1;break t}q=!0}q&&(8>B&&(w[B]=R(a.pow(P,.5))),O[B]=R(a.pow(P,1/3)),B++),P++}var H=[];m=m.SHA256=g.extend({_doReset:function(){this._hash=new p.init(w.slice(0))},_doProcessBlock:function(W,z){for(var st=this._hash.words,bt=st[0],It=st[1],Mt=st[2],Lt=st[3],tt=st[4],ut=st[5],pt=st[6],it=st[7],wt=0;64>wt;wt++){if(16>wt)H[wt]=0|W[z+wt];else{var $t=H[wt-15],Wt=H[wt-2];H[wt]=(($t<<25|$t>>>7)^($t<<14|$t>>>18)^$t>>>3)+H[wt-7]+((Wt<<15|Wt>>>17)^(Wt<<13|Wt>>>19)^Wt>>>10)+H[wt-16]}$t=it+((tt<<26|tt>>>6)^(tt<<21|tt>>>11)^(tt<<7|tt>>>25))+(tt&ut^~tt&pt)+O[wt]+H[wt],Wt=((bt<<30|bt>>>2)^(bt<<19|bt>>>13)^(bt<<10|bt>>>22))+(bt&It^bt&Mt^It&Mt),it=pt,pt=ut,ut=tt,tt=Lt+$t|0,Lt=Mt,Mt=It,It=bt,bt=$t+Wt|0}st[0]=st[0]+bt|0,st[1]=st[1]+It|0,st[2]=st[2]+Mt|0,st[3]=st[3]+Lt|0,st[4]=st[4]+tt|0,st[5]=st[5]+ut|0,st[6]=st[6]+pt|0,st[7]=st[7]+it|0},_doFinalize:function(){var W=this._data,z=W.words,st=8*this._nDataBytes,bt=8*W.sigBytes;return z[bt>>>5]|=128<<24-bt%32,z[14+(bt+64>>>9<<4)]=a.floor(st/4294967296),z[15+(bt+64>>>9<<4)]=st,W.sigBytes=4*z.length,this._process(),this._hash},clone:function(){var W=g.clone.call(this);return W._hash=this._hash.clone(),W}}),u.SHA256=g._createHelper(m),u.HmacSHA256=g._createHmacHelper(m)}(Math),function(){var a=Y,u=a.lib.WordArray,p=(g=a.algo).SHA256,g=g.SHA224=p.extend({_doReset:function(){this._hash=new u.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var m=p._doFinalize.call(this);return m.sigBytes-=4,m}});a.SHA224=p._createHelper(g),a.HmacSHA224=p._createHmacHelper(g)}(),function(){function a(){return g.create.apply(g,arguments)}for(var u=Y,p=u.lib.Hasher,g=(w=u.x64).Word,m=w.WordArray,w=u.algo,O=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],R=[],P=0;80>P;P++)R[P]=a();w=w.SHA512=p.extend({_doReset:function(){this._hash=new m.init([new g.init(1779033703,4089235720),new g.init(3144134277,2227873595),new g.init(1013904242,4271175723),new g.init(2773480762,1595750129),new g.init(1359893119,2917565137),new g.init(2600822924,725511199),new g.init(528734635,4215389547),new g.init(1541459225,327033209)])},_doProcessBlock:function(B,q){for(var L=(It=this._hash.words)[0],k=It[1],H=It[2],W=It[3],z=It[4],st=It[5],bt=It[6],It=It[7],Mt=L.high,Lt=L.low,tt=k.high,ut=k.low,pt=H.high,it=H.low,wt=W.high,$t=W.low,Wt=z.high,Ht=z.low,Se=st.high,zt=st.low,Q=bt.high,ft=bt.low,vt=It.high,Rt=It.low,Ft=Mt,Nt=Lt,re=tt,te=ut,St=pt,kt=it,Tt=wt,Qt=$t,le=Wt,$e=Ht,pr=Se,Pr=zt,er=Q,gn=ft,ro=vt,wr=Rt,Fr=0;80>Fr;Fr++){var yn=R[Fr];if(16>Fr)var Or=yn.high=0|B[q+2*Fr],ir=yn.low=0|B[q+2*Fr+1];else{Or=((ir=(Or=R[Fr-15]).high)>>>1|(Br=Or.low)<<31)^(ir>>>8|Br<<24)^ir>>>7;var Br=(Br>>>1|ir<<31)^(Br>>>8|ir<<24)^(Br>>>7|ir<<25),Ge=((ir=(Ge=R[Fr-2]).high)>>>19|(Er=Ge.low)<<13)^(ir<<3|Er>>>29)^ir>>>6,Er=(Er>>>19|ir<<13)^(Er<<3|ir>>>29)^(Er>>>6|ir<<26),Yn=(ir=R[Fr-7]).high,Qr=(mn=R[Fr-16]).high,mn=mn.low;Or=(Or=(Or=Or+Yn+((ir=Br+ir.low)>>>0<Br>>>0?1:0))+Ge+((ir+=Er)>>>0<Er>>>0?1:0))+Qr+((ir+=mn)>>>0<mn>>>0?1:0),yn.high=Or,yn.low=ir}Yn=le&pr^~le&er,mn=$e&Pr^~$e&gn,yn=Ft&re^Ft&St^re&St;var ta=Nt&te^Nt&kt^te&kt,ea=(Br=(Ft>>>28|Nt<<4)^(Ft<<30|Nt>>>2)^(Ft<<25|Nt>>>7),Ge=(Nt>>>28|Ft<<4)^(Nt<<30|Ft>>>2)^(Nt<<25|Ft>>>7),(Er=O[Fr]).high),Nn=Er.low;Qr=ro+((le>>>14|$e<<18)^(le>>>18|$e<<14)^(le<<23|$e>>>9))+((Er=wr+(($e>>>14|le<<18)^($e>>>18|le<<14)^($e<<23|le>>>9)))>>>0<wr>>>0?1:0),ro=er,wr=gn,er=pr,gn=Pr,pr=le,Pr=$e,le=Tt+(Qr=(Qr=(Qr=Qr+Yn+((Er+=mn)>>>0<mn>>>0?1:0))+ea+((Er+=Nn)>>>0<Nn>>>0?1:0))+Or+((Er+=ir)>>>0<ir>>>0?1:0))+(($e=Qt+Er|0)>>>0<Qt>>>0?1:0)|0,Tt=St,Qt=kt,St=re,kt=te,re=Ft,te=Nt,Ft=Qr+(yn=Br+yn+((ir=Ge+ta)>>>0<Ge>>>0?1:0))+((Nt=Er+ir|0)>>>0<Er>>>0?1:0)|0}Lt=L.low=Lt+Nt,L.high=Mt+Ft+(Lt>>>0<Nt>>>0?1:0),ut=k.low=ut+te,k.high=tt+re+(ut>>>0<te>>>0?1:0),it=H.low=it+kt,H.high=pt+St+(it>>>0<kt>>>0?1:0),$t=W.low=$t+Qt,W.high=wt+Tt+($t>>>0<Qt>>>0?1:0),Ht=z.low=Ht+$e,z.high=Wt+le+(Ht>>>0<$e>>>0?1:0),zt=st.low=zt+Pr,st.high=Se+pr+(zt>>>0<Pr>>>0?1:0),ft=bt.low=ft+gn,bt.high=Q+er+(ft>>>0<gn>>>0?1:0),Rt=It.low=Rt+wr,It.high=vt+ro+(Rt>>>0<wr>>>0?1:0)},_doFinalize:function(){var B=this._data,q=B.words,L=8*this._nDataBytes,k=8*B.sigBytes;return q[k>>>5]|=128<<24-k%32,q[30+(k+128>>>10<<5)]=Math.floor(L/4294967296),q[31+(k+128>>>10<<5)]=L,B.sigBytes=4*q.length,this._process(),this._hash.toX32()},clone:function(){var B=p.clone.call(this);return B._hash=this._hash.clone(),B},blockSize:32}),u.SHA512=p._createHelper(w),u.HmacSHA512=p._createHmacHelper(w)}(),function(){var a=Y,u=(m=a.x64).Word,p=m.WordArray,g=(m=a.algo).SHA512,m=m.SHA384=g.extend({_doReset:function(){this._hash=new p.init([new u.init(3418070365,3238371032),new u.init(1654270250,914150663),new u.init(2438529370,812702999),new u.init(355462360,4144912697),new u.init(1731405415,4290775857),new u.init(2394180231,1750603025),new u.init(3675008525,1694076839),new u.init(1203062813,3204075428)])},_doFinalize:function(){var w=g._doFinalize.call(this);return w.sigBytes-=16,w}});a.SHA384=g._createHelper(m),a.HmacSHA384=g._createHmacHelper(m)}(),function(){var a=Y,u=(g=a.lib).WordArray,p=g.Hasher,g=a.algo,m=u.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),w=u.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),O=u.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),R=u.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),P=u.create([0,1518500249,1859775393,2400959708,2840853838]),B=u.create([1352829926,1548603684,1836072691,2053994217,0]);g=g.RIPEMD160=p.extend({_doReset:function(){this._hash=u.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(q,L){for(var k=0;16>k;k++){var H=q[wt=L+k];q[wt]=16711935&(H<<8|H>>>24)|4278255360&(H<<24|H>>>8)}var W,z,st,bt,It,Mt,Lt,tt,ut,pt,it,wt=this._hash.words,$t=(H=P.words,B.words),Wt=m.words,Ht=w.words,Se=O.words,zt=R.words;for(Mt=W=wt[0],Lt=z=wt[1],tt=st=wt[2],ut=bt=wt[3],pt=It=wt[4],k=0;80>k;k+=1)it=W+q[L+Wt[k]]|0,it=16>k?it+((z^st^bt)+H[0]):32>k?it+((z&st|~z&bt)+H[1]):48>k?it+(((z|~st)^bt)+H[2]):64>k?it+((z&bt|st&~bt)+H[3]):it+((z^(st|~bt))+H[4]),it=(it=(it|=0)<<Se[k]|it>>>32-Se[k])+It|0,W=It,It=bt,bt=st<<10|st>>>22,st=z,z=it,it=Mt+q[L+Ht[k]]|0,it=16>k?it+((Lt^(tt|~ut))+$t[0]):32>k?it+((Lt&ut|tt&~ut)+$t[1]):48>k?it+(((Lt|~tt)^ut)+$t[2]):64>k?it+((Lt&tt|~Lt&ut)+$t[3]):it+((Lt^tt^ut)+$t[4]),it=(it=(it|=0)<<zt[k]|it>>>32-zt[k])+pt|0,Mt=pt,pt=ut,ut=tt<<10|tt>>>22,tt=Lt,Lt=it;it=wt[1]+st+ut|0,wt[1]=wt[2]+bt+pt|0,wt[2]=wt[3]+It+Mt|0,wt[3]=wt[4]+W+Lt|0,wt[4]=wt[0]+z+tt|0,wt[0]=it},_doFinalize:function(){var q=this._data,L=q.words,k=8*this._nDataBytes,H=8*q.sigBytes;for(L[H>>>5]|=128<<24-H%32,L[14+(H+64>>>9<<4)]=16711935&(k<<8|k>>>24)|4278255360&(k<<24|k>>>8),q.sigBytes=4*(L.length+1),this._process(),L=(q=this._hash).words,k=0;5>k;k++)H=L[k],L[k]=16711935&(H<<8|H>>>24)|4278255360&(H<<24|H>>>8);return q},clone:function(){var q=p.clone.call(this);return q._hash=this._hash.clone(),q}}),a.RIPEMD160=p._createHelper(g),a.HmacRIPEMD160=p._createHmacHelper(g)}(Math),function(){var a=Y,u=a.enc.Utf8;a.algo.HMAC=a.lib.Base.extend({init:function(p,g){p=this._hasher=new p.init,typeof g=="string"&&(g=u.parse(g));var m=p.blockSize,w=4*m;g.sigBytes>w&&(g=p.finalize(g)),g.clamp();for(var O=this._oKey=g.clone(),R=this._iKey=g.clone(),P=O.words,B=R.words,q=0;q<m;q++)P[q]^=1549556828,B[q]^=909522486;O.sigBytes=R.sigBytes=w,this.reset()},reset:function(){var p=this._hasher;p.reset(),p.update(this._iKey)},update:function(p){return this._hasher.update(p),this},finalize:function(p){var g=this._hasher;return p=g.finalize(p),g.reset(),g.finalize(this._oKey.clone().concat(p))}})}(),function(){var a,u=Y,p=(a=u.lib).Base,g=a.WordArray,m=(a=u.algo).HMAC,w=a.PBKDF2=p.extend({cfg:p.extend({keySize:4,hasher:a.SHA1,iterations:1}),init:function(O){this.cfg=this.cfg.extend(O)},compute:function(O,R){var P=this.cfg,B=m.create(P.hasher,O),q=g.create(),L=g.create([1]),k=q.words,H=L.words,W=P.keySize;for(P=P.iterations;k.length<W;){var z=B.update(R).finalize(L);B.reset();for(var st=z.words,bt=st.length,It=z,Mt=1;Mt<P;Mt++){It=B.finalize(It),B.reset();for(var Lt=It.words,tt=0;tt<bt;tt++)st[tt]^=Lt[tt]}q.concat(z),H[0]++}return q.sigBytes=4*W,q}});u.PBKDF2=function(O,R,P){return w.create(P).compute(O,R)}}();var Z,D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function nt(a){var u,p,g="";for(u=0;u+3<=a.length;u+=3)p=parseInt(a.substring(u,u+3),16),g+=D.charAt(p>>6)+D.charAt(63&p);for(u+1==a.length?(p=parseInt(a.substring(u,u+1),16),g+=D.charAt(p<<2)):u+2==a.length&&(p=parseInt(a.substring(u,u+2),16),g+=D.charAt(p>>2)+D.charAt((3&p)<<4)),"=";(3&g.length)>0;)g+="=";return g}function ct(a){var u,p,g,m="",w=0;for(u=0;u<a.length&&a.charAt(u)!="=";++u)(g=D.indexOf(a.charAt(u)))<0||(w==0?(m+=xt(g>>2),p=3&g,w=1):w==1?(m+=xt(p<<2|g>>4),p=15&g,w=2):w==2?(m+=xt(p),m+=xt(g>>2),p=3&g,w=3):(m+=xt(p<<2|g>>4),m+=xt(15&g),w=0));return w==1&&(m+=xt(p<<2)),m}function at(a){var u,p=ct(a),g=new Array;for(u=0;2*u<p.length;++u)g[u]=parseInt(p.substring(2*u,2*u+2),16);return g}function et(a,u,p){a!=null&&(typeof a=="number"?this.fromNumber(a,u,p):u==null&&typeof a!="string"?this.fromString(a,256):this.fromString(a,u))}function mt(){return new et(null)}U.appName=="Microsoft Internet Explorer"?(et.prototype.am=function(a,u,p,g,m,w){for(var O=32767&u,R=u>>15;--w>=0;){var P=32767&this[a],B=this[a++]>>15,q=R*P+B*O;m=((P=O*P+((32767&q)<<15)+p[g]+(1073741823&m))>>>30)+(q>>>15)+R*B+(m>>>30),p[g++]=1073741823&P}return m},Z=30):U.appName!="Netscape"?(et.prototype.am=function(a,u,p,g,m,w){for(;--w>=0;){var O=u*this[a++]+p[g]+m;m=Math.floor(O/67108864),p[g++]=67108863&O}return m},Z=26):(et.prototype.am=function(a,u,p,g,m,w){for(var O=16383&u,R=u>>14;--w>=0;){var P=16383&this[a],B=this[a++]>>14,q=R*P+B*O;m=((P=O*P+((16383&q)<<14)+p[g]+m)>>28)+(q>>14)+R*B,p[g++]=268435455&P}return m},Z=28),et.prototype.DB=Z,et.prototype.DM=(1<<Z)-1,et.prototype.DV=1<<Z,et.prototype.FV=Math.pow(2,52),et.prototype.F1=52-Z,et.prototype.F2=2*Z-52;var At,dt,ht=new Array;for(At=48,dt=0;dt<=9;++dt)ht[At++]=dt;for(At=97,dt=10;dt<36;++dt)ht[At++]=dt;for(At=65,dt=10;dt<36;++dt)ht[At++]=dt;function xt(a){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(a)}function l(a,u){var p=ht[a.charCodeAt(u)];return p??-1}function s(a){var u=mt();return u.fromInt(a),u}function v(a){var u,p=1;return(u=a>>>16)!=0&&(a=u,p+=16),(u=a>>8)!=0&&(a=u,p+=8),(u=a>>4)!=0&&(a=u,p+=4),(u=a>>2)!=0&&(a=u,p+=2),(u=a>>1)!=0&&(a=u,p+=1),p}function $(a){this.m=a}function E(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function rt(a,u){return a&u}function gt(a,u){return a|u}function Et(a,u){return a^u}function Ct(a,u){return a&~u}function x(a){if(a==0)return-1;var u=0;return!(65535&a)&&(a>>=16,u+=16),!(255&a)&&(a>>=8,u+=8),!(15&a)&&(a>>=4,u+=4),!(3&a)&&(a>>=2,u+=2),!(1&a)&&++u,u}function N(a){for(var u=0;a!=0;)a&=a-1,++u;return u}function G(){}function A(a){return a}function C(a){this.r2=mt(),this.q3=mt(),et.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a),this.m=a}$.prototype.convert=function(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a},$.prototype.revert=function(a){return a},$.prototype.reduce=function(a){a.divRemTo(this.m,null,a)},$.prototype.mulTo=function(a,u,p){a.multiplyTo(u,p),this.reduce(p)},$.prototype.sqrTo=function(a,u){a.squareTo(u),this.reduce(u)},E.prototype.convert=function(a){var u=mt();return a.abs().dlShiftTo(this.m.t,u),u.divRemTo(this.m,null,u),a.s<0&&u.compareTo(et.ZERO)>0&&this.m.subTo(u,u),u},E.prototype.revert=function(a){var u=mt();return a.copyTo(u),this.reduce(u),u},E.prototype.reduce=function(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var u=0;u<this.m.t;++u){var p=32767&a[u],g=p*this.mpl+((p*this.mph+(a[u]>>15)*this.mpl&this.um)<<15)&a.DM;for(a[p=u+this.m.t]+=this.m.am(0,g,a,u,0,this.m.t);a[p]>=a.DV;)a[p]-=a.DV,a[++p]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)},E.prototype.mulTo=function(a,u,p){a.multiplyTo(u,p),this.reduce(p)},E.prototype.sqrTo=function(a,u){a.squareTo(u),this.reduce(u)},et.prototype.copyTo=function(a){for(var u=this.t-1;u>=0;--u)a[u]=this[u];a.t=this.t,a.s=this.s},et.prototype.fromInt=function(a){this.t=1,this.s=a<0?-1:0,a>0?this[0]=a:a<-1?this[0]=a+this.DV:this.t=0},et.prototype.fromString=function(a,u){var p;if(u==16)p=4;else if(u==8)p=3;else if(u==256)p=8;else if(u==2)p=1;else if(u==32)p=5;else{if(u!=4)return void this.fromRadix(a,u);p=2}this.t=0,this.s=0;for(var g=a.length,m=!1,w=0;--g>=0;){var O=p==8?255&a[g]:l(a,g);O<0?a.charAt(g)=="-"&&(m=!0):(m=!1,w==0?this[this.t++]=O:w+p>this.DB?(this[this.t-1]|=(O&(1<<this.DB-w)-1)<<w,this[this.t++]=O>>this.DB-w):this[this.t-1]|=O<<w,(w+=p)>=this.DB&&(w-=this.DB))}p==8&&128&a[0]&&(this.s=-1,w>0&&(this[this.t-1]|=(1<<this.DB-w)-1<<w)),this.clamp(),m&&et.ZERO.subTo(this,this)},et.prototype.clamp=function(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t},et.prototype.dlShiftTo=function(a,u){var p;for(p=this.t-1;p>=0;--p)u[p+a]=this[p];for(p=a-1;p>=0;--p)u[p]=0;u.t=this.t+a,u.s=this.s},et.prototype.drShiftTo=function(a,u){for(var p=a;p<this.t;++p)u[p-a]=this[p];u.t=Math.max(this.t-a,0),u.s=this.s},et.prototype.lShiftTo=function(a,u){var p,g=a%this.DB,m=this.DB-g,w=(1<<m)-1,O=Math.floor(a/this.DB),R=this.s<<g&this.DM;for(p=this.t-1;p>=0;--p)u[p+O+1]=this[p]>>m|R,R=(this[p]&w)<<g;for(p=O-1;p>=0;--p)u[p]=0;u[O]=R,u.t=this.t+O+1,u.s=this.s,u.clamp()},et.prototype.rShiftTo=function(a,u){u.s=this.s;var p=Math.floor(a/this.DB);if(p>=this.t)u.t=0;else{var g=a%this.DB,m=this.DB-g,w=(1<<g)-1;u[0]=this[p]>>g;for(var O=p+1;O<this.t;++O)u[O-p-1]|=(this[O]&w)<<m,u[O-p]=this[O]>>g;g>0&&(u[this.t-p-1]|=(this.s&w)<<m),u.t=this.t-p,u.clamp()}},et.prototype.subTo=function(a,u){for(var p=0,g=0,m=Math.min(a.t,this.t);p<m;)g+=this[p]-a[p],u[p++]=g&this.DM,g>>=this.DB;if(a.t<this.t){for(g-=a.s;p<this.t;)g+=this[p],u[p++]=g&this.DM,g>>=this.DB;g+=this.s}else{for(g+=this.s;p<a.t;)g-=a[p],u[p++]=g&this.DM,g>>=this.DB;g-=a.s}u.s=g<0?-1:0,g<-1?u[p++]=this.DV+g:g>0&&(u[p++]=g),u.t=p,u.clamp()},et.prototype.multiplyTo=function(a,u){var p=this.abs(),g=a.abs(),m=p.t;for(u.t=m+g.t;--m>=0;)u[m]=0;for(m=0;m<g.t;++m)u[m+p.t]=p.am(0,g[m],u,m,0,p.t);u.s=0,u.clamp(),this.s!=a.s&&et.ZERO.subTo(u,u)},et.prototype.squareTo=function(a){for(var u=this.abs(),p=a.t=2*u.t;--p>=0;)a[p]=0;for(p=0;p<u.t-1;++p){var g=u.am(p,u[p],a,2*p,0,1);(a[p+u.t]+=u.am(p+1,2*u[p],a,2*p+1,g,u.t-p-1))>=u.DV&&(a[p+u.t]-=u.DV,a[p+u.t+1]=1)}a.t>0&&(a[a.t-1]+=u.am(p,u[p],a,2*p,0,1)),a.s=0,a.clamp()},et.prototype.divRemTo=function(a,u,p){var g=a.abs();if(!(g.t<=0)){var m=this.abs();if(m.t<g.t)return u?.fromInt(0),void(p!=null&&this.copyTo(p));p==null&&(p=mt());var w=mt(),O=this.s,R=a.s,P=this.DB-v(g[g.t-1]);P>0?(g.lShiftTo(P,w),m.lShiftTo(P,p)):(g.copyTo(w),m.copyTo(p));var B=w.t,q=w[B-1];if(q!=0){var L=q*(1<<this.F1)+(B>1?w[B-2]>>this.F2:0),k=this.FV/L,H=(1<<this.F1)/L,W=1<<this.F2,z=p.t,st=z-B,bt=u??mt();for(w.dlShiftTo(st,bt),p.compareTo(bt)>=0&&(p[p.t++]=1,p.subTo(bt,p)),et.ONE.dlShiftTo(B,bt),bt.subTo(w,w);w.t<B;)w[w.t++]=0;for(;--st>=0;){var It=p[--z]==q?this.DM:Math.floor(p[z]*k+(p[z-1]+W)*H);if((p[z]+=w.am(0,It,p,st,0,B))<It)for(w.dlShiftTo(st,bt),p.subTo(bt,p);p[z]<--It;)p.subTo(bt,p)}u!=null&&(p.drShiftTo(B,u),O!=R&&et.ZERO.subTo(u,u)),p.t=B,p.clamp(),P>0&&p.rShiftTo(P,p),O<0&&et.ZERO.subTo(p,p)}}},et.prototype.invDigit=function(){if(this.t<1)return 0;var a=this[0];if(!(1&a))return 0;var u=3&a;return(u=(u=(u=(u=u*(2-(15&a)*u)&15)*(2-(255&a)*u)&255)*(2-((65535&a)*u&65535))&65535)*(2-a*u%this.DV)%this.DV)>0?this.DV-u:-u},et.prototype.isEven=function(){return(this.t>0?1&this[0]:this.s)==0},et.prototype.exp=function(a,u){if(a>4294967295||a<1)return et.ONE;var p=mt(),g=mt(),m=u.convert(this),w=v(a)-1;for(m.copyTo(p);--w>=0;)if(u.sqrTo(p,g),(a&1<<w)>0)u.mulTo(g,m,p);else{var O=p;p=g,g=O}return u.revert(p)},et.prototype.toString=function(a){if(this.s<0)return"-"+this.negate().toString(a);var u;if(a==16)u=4;else if(a==8)u=3;else if(a==2)u=1;else if(a==32)u=5;else{if(a!=4)return this.toRadix(a);u=2}var p,g=(1<<u)-1,m=!1,w="",O=this.t,R=this.DB-O*this.DB%u;if(O-- >0)for(R<this.DB&&(p=this[O]>>R)>0&&(m=!0,w=xt(p));O>=0;)R<u?(p=(this[O]&(1<<R)-1)<<u-R,p|=this[--O]>>(R+=this.DB-u)):(p=this[O]>>(R-=u)&g,R<=0&&(R+=this.DB,--O)),p>0&&(m=!0),m&&(w+=xt(p));return m?w:"0"},et.prototype.negate=function(){var a=mt();return et.ZERO.subTo(this,a),a},et.prototype.abs=function(){return this.s<0?this.negate():this},et.prototype.compareTo=function(a){var u=this.s-a.s;if(u!=0)return u;var p=this.t;if((u=p-a.t)!=0)return this.s<0?-u:u;for(;--p>=0;)if((u=this[p]-a[p])!=0)return u;return 0},et.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+v(this[this.t-1]^this.s&this.DM)},et.prototype.mod=function(a){var u=mt();return this.abs().divRemTo(a,null,u),this.s<0&&u.compareTo(et.ZERO)>0&&a.subTo(u,u),u},et.prototype.modPowInt=function(a,u){var p;return p=a<256||u.isEven()?new $(u):new E(u),this.exp(a,p)},et.ZERO=s(0),et.ONE=s(1),G.prototype.convert=A,G.prototype.revert=A,G.prototype.mulTo=function(a,u,p){a.multiplyTo(u,p)},G.prototype.sqrTo=function(a,u){a.squareTo(u)},C.prototype.convert=function(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var u=mt();return a.copyTo(u),this.reduce(u),u},C.prototype.revert=function(a){return a},C.prototype.reduce=function(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)},C.prototype.mulTo=function(a,u,p){a.multiplyTo(u,p),this.reduce(p)},C.prototype.sqrTo=function(a,u){a.squareTo(u),this.reduce(u)};var j=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],K=(1<<26)/j[j.length-1];function J(){this.i=0,this.j=0,this.S=new Array}et.prototype.chunkSize=function(a){return Math.floor(Math.LN2*this.DB/Math.log(a))},et.prototype.toRadix=function(a){if(a==null&&(a=10),this.signum()==0||a<2||a>36)return"0";var u=this.chunkSize(a),p=Math.pow(a,u),g=s(p),m=mt(),w=mt(),O="";for(this.divRemTo(g,m,w);m.signum()>0;)O=(p+w.intValue()).toString(a).substr(1)+O,m.divRemTo(g,m,w);return w.intValue().toString(a)+O},et.prototype.fromRadix=function(a,u){this.fromInt(0),u==null&&(u=10);for(var p=this.chunkSize(u),g=Math.pow(u,p),m=!1,w=0,O=0,R=0;R<a.length;++R){var P=l(a,R);P<0?a.charAt(R)=="-"&&this.signum()==0&&(m=!0):(O=u*O+P,++w>=p&&(this.dMultiply(g),this.dAddOffset(O,0),w=0,O=0))}w>0&&(this.dMultiply(Math.pow(u,w)),this.dAddOffset(O,0)),m&&et.ZERO.subTo(this,this)},et.prototype.fromNumber=function(a,u,p){if(typeof u=="number")if(a<2)this.fromInt(1);else for(this.fromNumber(a,p),this.testBit(a-1)||this.bitwiseTo(et.ONE.shiftLeft(a-1),gt,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(u);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(et.ONE.shiftLeft(a-1),this);else{var g=new Array,m=7&a;g.length=1+(a>>3),u.nextBytes(g),m>0?g[0]&=(1<<m)-1:g[0]=0,this.fromString(g,256)}},et.prototype.bitwiseTo=function(a,u,p){var g,m,w=Math.min(a.t,this.t);for(g=0;g<w;++g)p[g]=u(this[g],a[g]);if(a.t<this.t){for(m=a.s&this.DM,g=w;g<this.t;++g)p[g]=u(this[g],m);p.t=this.t}else{for(m=this.s&this.DM,g=w;g<a.t;++g)p[g]=u(m,a[g]);p.t=a.t}p.s=u(this.s,a.s),p.clamp()},et.prototype.changeBit=function(a,u){var p=et.ONE.shiftLeft(a);return this.bitwiseTo(p,u,p),p},et.prototype.addTo=function(a,u){for(var p=0,g=0,m=Math.min(a.t,this.t);p<m;)g+=this[p]+a[p],u[p++]=g&this.DM,g>>=this.DB;if(a.t<this.t){for(g+=a.s;p<this.t;)g+=this[p],u[p++]=g&this.DM,g>>=this.DB;g+=this.s}else{for(g+=this.s;p<a.t;)g+=a[p],u[p++]=g&this.DM,g>>=this.DB;g+=a.s}u.s=g<0?-1:0,g>0?u[p++]=g:g<-1&&(u[p++]=this.DV+g),u.t=p,u.clamp()},et.prototype.dMultiply=function(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()},et.prototype.dAddOffset=function(a,u){if(a!=0){for(;this.t<=u;)this[this.t++]=0;for(this[u]+=a;this[u]>=this.DV;)this[u]-=this.DV,++u>=this.t&&(this[this.t++]=0),++this[u]}},et.prototype.multiplyLowerTo=function(a,u,p){var g,m=Math.min(this.t+a.t,u);for(p.s=0,p.t=m;m>0;)p[--m]=0;for(g=p.t-this.t;m<g;++m)p[m+this.t]=this.am(0,a[m],p,m,0,this.t);for(g=Math.min(a.t,u);m<g;++m)this.am(0,a[m],p,m,0,u-m);p.clamp()},et.prototype.multiplyUpperTo=function(a,u,p){--u;var g=p.t=this.t+a.t-u;for(p.s=0;--g>=0;)p[g]=0;for(g=Math.max(u-this.t,0);g<a.t;++g)p[this.t+g-u]=this.am(u-g,a[g],p,0,0,this.t+g-u);p.clamp(),p.drShiftTo(1,p)},et.prototype.modInt=function(a){if(a<=0)return 0;var u=this.DV%a,p=this.s<0?a-1:0;if(this.t>0)if(u==0)p=this[0]%a;else for(var g=this.t-1;g>=0;--g)p=(u*p+this[g])%a;return p},et.prototype.millerRabin=function(a){var u=this.subtract(et.ONE),p=u.getLowestSetBit();if(p<=0)return!1;var g=u.shiftRight(p);(a=a+1>>1)>j.length&&(a=j.length);for(var m=mt(),w=0;w<a;++w){m.fromInt(j[Math.floor(Math.random()*j.length)]);var O=m.modPow(g,this);if(O.compareTo(et.ONE)!=0&&O.compareTo(u)!=0){for(var R=1;R++<p&&O.compareTo(u)!=0;)if((O=O.modPowInt(2,this)).compareTo(et.ONE)==0)return!1;if(O.compareTo(u)!=0)return!1}}return!0},et.prototype.clone=function(){var a=mt();return this.copyTo(a),a},et.prototype.intValue=function(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},et.prototype.byteValue=function(){return this.t==0?this.s:this[0]<<24>>24},et.prototype.shortValue=function(){return this.t==0?this.s:this[0]<<16>>16},et.prototype.signum=function(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1},et.prototype.toByteArray=function(){var a=this.t,u=new Array;u[0]=this.s;var p,g=this.DB-a*this.DB%8,m=0;if(a-- >0)for(g<this.DB&&(p=this[a]>>g)!=(this.s&this.DM)>>g&&(u[m++]=p|this.s<<this.DB-g);a>=0;)g<8?(p=(this[a]&(1<<g)-1)<<8-g,p|=this[--a]>>(g+=this.DB-8)):(p=this[a]>>(g-=8)&255,g<=0&&(g+=this.DB,--a)),128&p&&(p|=-256),m==0&&(128&this.s)!=(128&p)&&++m,(m>0||p!=this.s)&&(u[m++]=p);return u},et.prototype.equals=function(a){return this.compareTo(a)==0},et.prototype.min=function(a){return this.compareTo(a)<0?this:a},et.prototype.max=function(a){return this.compareTo(a)>0?this:a},et.prototype.and=function(a){var u=mt();return this.bitwiseTo(a,rt,u),u},et.prototype.or=function(a){var u=mt();return this.bitwiseTo(a,gt,u),u},et.prototype.xor=function(a){var u=mt();return this.bitwiseTo(a,Et,u),u},et.prototype.andNot=function(a){var u=mt();return this.bitwiseTo(a,Ct,u),u},et.prototype.not=function(){for(var a=mt(),u=0;u<this.t;++u)a[u]=this.DM&~this[u];return a.t=this.t,a.s=~this.s,a},et.prototype.shiftLeft=function(a){var u=mt();return a<0?this.rShiftTo(-a,u):this.lShiftTo(a,u),u},et.prototype.shiftRight=function(a){var u=mt();return a<0?this.lShiftTo(-a,u):this.rShiftTo(a,u),u},et.prototype.getLowestSetBit=function(){for(var a=0;a<this.t;++a)if(this[a]!=0)return a*this.DB+x(this[a]);return this.s<0?this.t*this.DB:-1},et.prototype.bitCount=function(){for(var a=0,u=this.s&this.DM,p=0;p<this.t;++p)a+=N(this[p]^u);return a},et.prototype.testBit=function(a){var u=Math.floor(a/this.DB);return u>=this.t?this.s!=0:(this[u]&1<<a%this.DB)!=0},et.prototype.setBit=function(a){return this.changeBit(a,gt)},et.prototype.clearBit=function(a){return this.changeBit(a,Ct)},et.prototype.flipBit=function(a){return this.changeBit(a,Et)},et.prototype.add=function(a){var u=mt();return this.addTo(a,u),u},et.prototype.subtract=function(a){var u=mt();return this.subTo(a,u),u},et.prototype.multiply=function(a){var u=mt();return this.multiplyTo(a,u),u},et.prototype.divide=function(a){var u=mt();return this.divRemTo(a,u,null),u},et.prototype.remainder=function(a){var u=mt();return this.divRemTo(a,null,u),u},et.prototype.divideAndRemainder=function(a){var u=mt(),p=mt();return this.divRemTo(a,u,p),new Array(u,p)},et.prototype.modPow=function(a,u){var p,g,m=a.bitLength(),w=s(1);if(m<=0)return w;p=m<18?1:m<48?3:m<144?4:m<768?5:6,g=m<8?new $(u):u.isEven()?new C(u):new E(u);var O=new Array,R=3,P=p-1,B=(1<<p)-1;if(O[1]=g.convert(this),p>1){var q=mt();for(g.sqrTo(O[1],q);R<=B;)O[R]=mt(),g.mulTo(q,O[R-2],O[R]),R+=2}var L,k,H=a.t-1,W=!0,z=mt();for(m=v(a[H])-1;H>=0;){for(m>=P?L=a[H]>>m-P&B:(L=(a[H]&(1<<m+1)-1)<<P-m,H>0&&(L|=a[H-1]>>this.DB+m-P)),R=p;!(1&L);)L>>=1,--R;if((m-=R)<0&&(m+=this.DB,--H),W)O[L].copyTo(w),W=!1;else{for(;R>1;)g.sqrTo(w,z),g.sqrTo(z,w),R-=2;R>0?g.sqrTo(w,z):(k=w,w=z,z=k),g.mulTo(z,O[L],w)}for(;H>=0&&!(a[H]&1<<m);)g.sqrTo(w,z),k=w,w=z,z=k,--m<0&&(m=this.DB-1,--H)}return g.revert(w)},et.prototype.modInverse=function(a){var u=a.isEven();if(this.isEven()&&u||a.signum()==0)return et.ZERO;for(var p=a.clone(),g=this.clone(),m=s(1),w=s(0),O=s(0),R=s(1);p.signum()!=0;){for(;p.isEven();)p.rShiftTo(1,p),u?(m.isEven()&&w.isEven()||(m.addTo(this,m),w.subTo(a,w)),m.rShiftTo(1,m)):w.isEven()||w.subTo(a,w),w.rShiftTo(1,w);for(;g.isEven();)g.rShiftTo(1,g),u?(O.isEven()&&R.isEven()||(O.addTo(this,O),R.subTo(a,R)),O.rShiftTo(1,O)):R.isEven()||R.subTo(a,R),R.rShiftTo(1,R);p.compareTo(g)>=0?(p.subTo(g,p),u&&m.subTo(O,m),w.subTo(R,w)):(g.subTo(p,g),u&&O.subTo(m,O),R.subTo(w,R))}return g.compareTo(et.ONE)!=0?et.ZERO:R.compareTo(a)>=0?R.subtract(a):R.signum()<0?(R.addTo(a,R),R.signum()<0?R.add(a):R):R},et.prototype.pow=function(a){return this.exp(a,new G)},et.prototype.gcd=function(a){var u=this.s<0?this.negate():this.clone(),p=a.s<0?a.negate():a.clone();if(u.compareTo(p)<0){var g=u;u=p,p=g}var m=u.getLowestSetBit(),w=p.getLowestSetBit();if(w<0)return u;for(m<w&&(w=m),w>0&&(u.rShiftTo(w,u),p.rShiftTo(w,p));u.signum()>0;)(m=u.getLowestSetBit())>0&&u.rShiftTo(m,u),(m=p.getLowestSetBit())>0&&p.rShiftTo(m,p),u.compareTo(p)>=0?(u.subTo(p,u),u.rShiftTo(1,u)):(p.subTo(u,p),p.rShiftTo(1,p));return w>0&&p.lShiftTo(w,p),p},et.prototype.isProbablePrime=function(a){var u,p=this.abs();if(p.t==1&&p[0]<=j[j.length-1]){for(u=0;u<j.length;++u)if(p[0]==j[u])return!0;return!1}if(p.isEven())return!1;for(u=1;u<j.length;){for(var g=j[u],m=u+1;m<j.length&&g<K;)g*=j[m++];for(g=p.modInt(g);u<m;)if(g%j[u++]==0)return!1}return p.millerRabin(a)},et.prototype.square=function(){var a=mt();return this.squareTo(a),a},J.prototype.init=function(a){var u,p,g;for(u=0;u<256;++u)this.S[u]=u;for(p=0,u=0;u<256;++u)p=p+this.S[u]+a[u%a.length]&255,g=this.S[u],this.S[u]=this.S[p],this.S[p]=g;this.i=0,this.j=0},J.prototype.next=function(){var a;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,a=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=a,this.S[a+this.S[this.i]&255]};var yt,Dt,Xt;function _e(){var a;a=new Date().getTime(),Dt[Xt++]^=255&a,Dt[Xt++]^=a>>8&255,Dt[Xt++]^=a>>16&255,Dt[Xt++]^=a>>24&255,Xt>=256&&(Xt-=256)}if(Dt==null){var me;if(Dt=new Array,Xt=0,M!==void 0&&(M.crypto!==void 0||M.msCrypto!==void 0)){var de=M.crypto||M.msCrypto;if(de.getRandomValues){var Zt=new Uint8Array(32);for(de.getRandomValues(Zt),me=0;me<32;++me)Dt[Xt++]=Zt[me]}else if(U.appName=="Netscape"&&U.appVersion<"5"){var Vt=M.crypto.random(32);for(me=0;me<Vt.length;++me)Dt[Xt++]=255&Vt.charCodeAt(me)}}for(;Xt<256;)me=Math.floor(65536*Math.random()),Dt[Xt++]=me>>>8,Dt[Xt++]=255&me;Xt=0,_e()}function pe(){if(yt==null){for(_e(),(yt=new J).init(Dt),Xt=0;Xt<Dt.length;++Xt)Dt[Xt]=0;Xt=0}return yt.next()}function ge(){}function jt(a,u){return new et(a,u)}function Bt(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function ie(a,u){this.x=u,this.q=a}function ee(a,u,p,g){this.curve=a,this.x=u,this.y=p,this.z=g??et.ONE,this.zinv=null}function Kt(a,u,p){this.q=a,this.a=this.fromBigInteger(u),this.b=this.fromBigInteger(p),this.infinity=new ee(this,null,null)}ge.prototype.nextBytes=function(a){var u;for(u=0;u<a.length;++u)a[u]=pe()},Bt.prototype.doPublic=function(a){return a.modPowInt(this.e,this.n)},Bt.prototype.setPublic=function(a,u){if(this.isPublic=!0,this.isPrivate=!1,typeof a!="string")this.n=a,this.e=u;else{if(!(a!=null&&u!=null&&a.length>0&&u.length>0))throw"Invalid RSA public key";this.n=jt(a,16),this.e=parseInt(u,16)}},Bt.prototype.type="RSA",Bt.prototype.doPrivate=function(a){if(this.p==null||this.q==null)return a.modPow(this.d,this.n);for(var u=a.mod(this.p).modPow(this.dmp1,this.p),p=a.mod(this.q).modPow(this.dmq1,this.q);u.compareTo(p)<0;)u=u.add(this.p);return u.subtract(p).multiply(this.coeff).mod(this.p).multiply(this.q).add(p)},Bt.prototype.setPrivate=function(a,u,p){if(this.isPrivate=!0,typeof a!="string")this.n=a,this.e=u,this.d=p;else{if(!(a!=null&&u!=null&&a.length>0&&u.length>0))throw"Invalid RSA private key";this.n=jt(a,16),this.e=parseInt(u,16),this.d=jt(p,16)}},Bt.prototype.setPrivateEx=function(a,u,p,g,m,w,O,R){if(this.isPrivate=!0,this.isPublic=!1,a==null)throw"RSASetPrivateEx N == null";if(u==null)throw"RSASetPrivateEx E == null";if(a.length==0)throw"RSASetPrivateEx N.length == 0";if(u.length==0)throw"RSASetPrivateEx E.length == 0";if(!(a!=null&&u!=null&&a.length>0&&u.length>0))throw"Invalid RSA private key in RSASetPrivateEx";this.n=jt(a,16),this.e=parseInt(u,16),this.d=jt(p,16),this.p=jt(g,16),this.q=jt(m,16),this.dmp1=jt(w,16),this.dmq1=jt(O,16),this.coeff=jt(R,16)},Bt.prototype.generate=function(a,u){var p=new ge,g=a>>1;this.e=parseInt(u,16);for(var m=new et(u,16),w=a/2-100,O=et.ONE.shiftLeft(w);;){for(;this.p=new et(a-g,1,p),this.p.subtract(et.ONE).gcd(m).compareTo(et.ONE)!=0||!this.p.isProbablePrime(10););for(;this.q=new et(g,1,p),this.q.subtract(et.ONE).gcd(m).compareTo(et.ONE)!=0||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var R=this.p;this.p=this.q,this.q=R}var P=this.q.subtract(this.p).abs();if(!(P.bitLength()<w||P.compareTo(O)<=0)){var B=this.p.subtract(et.ONE),q=this.q.subtract(et.ONE),L=B.multiply(q);if(L.gcd(m).compareTo(et.ONE)==0&&(this.n=this.p.multiply(this.q),this.n.bitLength()==a)){this.d=m.modInverse(L),this.dmp1=this.d.mod(B),this.dmq1=this.d.mod(q),this.coeff=this.q.modInverse(this.p);break}}}this.isPrivate=!0},ie.prototype.equals=function(a){return a==this||this.q.equals(a.q)&&this.x.equals(a.x)},ie.prototype.toBigInteger=function(){return this.x},ie.prototype.negate=function(){return new ie(this.q,this.x.negate().mod(this.q))},ie.prototype.add=function(a){return new ie(this.q,this.x.add(a.toBigInteger()).mod(this.q))},ie.prototype.subtract=function(a){return new ie(this.q,this.x.subtract(a.toBigInteger()).mod(this.q))},ie.prototype.multiply=function(a){return new ie(this.q,this.x.multiply(a.toBigInteger()).mod(this.q))},ie.prototype.square=function(){return new ie(this.q,this.x.square().mod(this.q))},ie.prototype.divide=function(a){return new ie(this.q,this.x.multiply(a.toBigInteger().modInverse(this.q)).mod(this.q))},ie.prototype.sqrt=function(){return new ie(this.q,this.x.sqrt().mod(this.q))},ee.prototype.getX=function(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},ee.prototype.getY=function(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},ee.prototype.equals=function(a){return a==this||(this.isInfinity()?a.isInfinity():a.isInfinity()?this.isInfinity():!!a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q).equals(et.ZERO)&&a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q).equals(et.ZERO))},ee.prototype.isInfinity=function(){return this.x==null&&this.y==null||this.z.equals(et.ZERO)&&!this.y.toBigInteger().equals(et.ZERO)},ee.prototype.negate=function(){return new ee(this.curve,this.x,this.y.negate(),this.z)},ee.prototype.add=function(a){if(this.isInfinity())return a;if(a.isInfinity())return this;var u=a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q),p=a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q);if(et.ZERO.equals(p))return et.ZERO.equals(u)?this.twice():this.curve.getInfinity();var g=new et("3"),m=this.x.toBigInteger(),w=this.y.toBigInteger(),O=(a.x.toBigInteger(),a.y.toBigInteger(),p.square()),R=O.multiply(p),P=m.multiply(O),B=u.square().multiply(this.z),q=B.subtract(P.shiftLeft(1)).multiply(a.z).subtract(R).multiply(p).mod(this.curve.q),L=P.multiply(g).multiply(u).subtract(w.multiply(R)).subtract(B.multiply(u)).multiply(a.z).add(u.multiply(R)).mod(this.curve.q),k=R.multiply(this.z).multiply(a.z).mod(this.curve.q);return new ee(this.curve,this.curve.fromBigInteger(q),this.curve.fromBigInteger(L),k)},ee.prototype.twice=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var a=new et("3"),u=this.x.toBigInteger(),p=this.y.toBigInteger(),g=p.multiply(this.z),m=g.multiply(p).mod(this.curve.q),w=this.curve.a.toBigInteger(),O=u.square().multiply(a);et.ZERO.equals(w)||(O=O.add(this.z.square().multiply(w)));var R=(O=O.mod(this.curve.q)).square().subtract(u.shiftLeft(3).multiply(m)).shiftLeft(1).multiply(g).mod(this.curve.q),P=O.multiply(a).multiply(u).subtract(m.shiftLeft(1)).shiftLeft(2).multiply(m).subtract(O.square().multiply(O)).mod(this.curve.q),B=g.square().multiply(g).shiftLeft(3).mod(this.curve.q);return new ee(this.curve,this.curve.fromBigInteger(R),this.curve.fromBigInteger(P),B)},ee.prototype.multiply=function(a){if(this.isInfinity())return this;if(a.signum()==0)return this.curve.getInfinity();var u,p=a,g=p.multiply(new et("3")),m=this.negate(),w=this,O=this.curve.q.subtract(a),R=O.multiply(new et("3")),P=new ee(this.curve,this.x,this.y),B=P.negate();for(u=g.bitLength()-2;u>0;--u){w=w.twice();var q=g.testBit(u);q!=p.testBit(u)&&(w=w.add(q?this:m))}for(u=R.bitLength()-2;u>0;--u){P=P.twice();var L=R.testBit(u);L!=O.testBit(u)&&(P=P.add(L?P:B))}return w},ee.prototype.multiplyTwo=function(a,u,p){var g;g=a.bitLength()>p.bitLength()?a.bitLength()-1:p.bitLength()-1;for(var m=this.curve.getInfinity(),w=this.add(u);g>=0;)m=m.twice(),a.testBit(g)?m=p.testBit(g)?m.add(w):m.add(this):p.testBit(g)&&(m=m.add(u)),--g;return m},Kt.prototype.getQ=function(){return this.q},Kt.prototype.getA=function(){return this.a},Kt.prototype.getB=function(){return this.b},Kt.prototype.equals=function(a){return a==this||this.q.equals(a.q)&&this.a.equals(a.a)&&this.b.equals(a.b)},Kt.prototype.getInfinity=function(){return this.infinity},Kt.prototype.fromBigInteger=function(a){return new ie(this.q,a)},Kt.prototype.decodePointHex=function(a){switch(parseInt(a.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var u=a.substr(0,2),p=(a.substr(2),this.fromBigInteger(new et(R,16))),g=this.getA(),m=this.getB(),w=p.square().add(g).multiply(p).add(m).sqrt();return u=="03"&&(w=w.negate()),new ee(this,p,w);case 4:case 6:case 7:var O=(a.length-2)/2,R=a.substr(2,O),P=a.substr(O+2,O);return new ee(this,this.fromBigInteger(new et(R,16)),this.fromBigInteger(new et(P,16)));default:return null}},ie.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},ee.prototype.getEncoded=function(a){var u=function(w,O){var R=w.toByteArrayUnsigned();if(O<R.length)R=R.slice(R.length-O);else for(;O>R.length;)R.unshift(0);return R},p=this.getX().toBigInteger(),g=this.getY().toBigInteger(),m=u(p,32);return a?g.isEven()?m.unshift(2):m.unshift(3):(m.unshift(4),m=m.concat(u(g,32))),m},ee.decodeFrom=function(a,u){u[0];var p=u.length-1,g=u.slice(1,1+p/2),m=u.slice(1+p/2,1+p);g.unshift(0),m.unshift(0);var w=new et(g),O=new et(m);return new ee(a,a.fromBigInteger(w),a.fromBigInteger(O))},ee.decodeFromHex=function(a,u){u.substr(0,2);var p=u.length-2,g=u.substr(2,p/2),m=u.substr(2+p/2,p/2),w=new et(g,16),O=new et(m,16);return new ee(a,a.fromBigInteger(w),a.fromBigInteger(O))},ee.prototype.add2D=function(a){if(this.isInfinity())return a;if(a.isInfinity())return this;if(this.x.equals(a.x))return this.y.equals(a.y)?this.twice():this.curve.getInfinity();var u=a.x.subtract(this.x),p=a.y.subtract(this.y).divide(u),g=p.square().subtract(this.x).subtract(a.x),m=p.multiply(this.x.subtract(g)).subtract(this.y);return new ee(this.curve,g,m)},ee.prototype.twice2D=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var a=this.curve.fromBigInteger(et.valueOf(2)),u=this.curve.fromBigInteger(et.valueOf(3)),p=this.x.square().multiply(u).add(this.curve.a).divide(this.y.multiply(a)),g=p.square().subtract(this.x.multiply(a)),m=p.multiply(this.x.subtract(g)).subtract(this.y);return new ee(this.curve,g,m)},ee.prototype.multiply2D=function(a){if(this.isInfinity())return this;if(a.signum()==0)return this.curve.getInfinity();var u,p=a,g=p.multiply(new et("3")),m=this.negate(),w=this;for(u=g.bitLength()-2;u>0;--u){w=w.twice();var O=g.testBit(u);O!=p.testBit(u)&&(w=w.add2D(O?this:m))}return w},ee.prototype.isOnCurve=function(){var a=this.getX().toBigInteger(),u=this.getY().toBigInteger(),p=this.curve.getA().toBigInteger(),g=this.curve.getB().toBigInteger(),m=this.curve.getQ(),w=u.multiply(u).mod(m),O=a.multiply(a).multiply(a).add(p.multiply(a)).add(g).mod(m);return w.equals(O)},ee.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},ee.prototype.validate=function(){var a=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var u=this.getX().toBigInteger(),p=this.getY().toBigInteger();if(u.compareTo(et.ONE)<0||u.compareTo(a.subtract(et.ONE))>0)throw new Error("x coordinate out of bounds");if(p.compareTo(et.ONE)<0||p.compareTo(a.subtract(et.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(a).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var be=function(){var a=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),u=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),p={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function g(O,R,P){return R?p[R]:String.fromCharCode(parseInt(P,16))}var m=new String(""),w=Object.hasOwnProperty;return function(O,R){var P,B,q=O.match(a),L=q[0],k=!1;L==="{"?P={}:L==="["?P=[]:(P=[],k=!0);for(var H=[P],W=1-k,z=q.length;W<z;++W){var st;switch((L=q[W]).charCodeAt(0)){default:(st=H[0])[B||st.length]=+L,B=void 0;break;case 34:if((L=L.substring(1,L.length-1)).indexOf("\\")!==-1&&(L=L.replace(u,g)),st=H[0],!B){if(!(st instanceof Array)){B=L||m;break}B=st.length}st[B]=L,B=void 0;break;case 91:st=H[0],H.unshift(st[B||st.length]=[]),B=void 0;break;case 93:H.shift();break;case 102:(st=H[0])[B||st.length]=!1,B=void 0;break;case 110:(st=H[0])[B||st.length]=null,B=void 0;break;case 116:(st=H[0])[B||st.length]=!0,B=void 0;break;case 123:st=H[0],H.unshift(st[B||st.length]={}),B=void 0;break;case 125:H.shift()}}if(k){if(H.length!==1)throw new Error;P=P[0]}else if(H.length)throw new Error;if(R){var bt=function(It,Mt){var Lt=It[Mt];if(Lt&&typeof Lt=="object"){var tt=null;for(var ut in Lt)if(w.call(Lt,ut)&&Lt!==It){var pt=bt(Lt,ut);pt!==void 0?Lt[ut]=pt:(tt||(tt=[]),tt.push(ut))}if(tt)for(var it=tt.length;--it>=0;)delete Lt[tt[it]]}return R.call(It,Mt,Lt)};P=bt({"":P},"")}return P}}();b!==void 0&&b||(b={}),b.asn1!==void 0&&b.asn1||(b.asn1={}),b.asn1.ASN1Util=new function(){this.integerToByteHex=function(a){var u=a.toString(16);return u.length%2==1&&(u="0"+u),u},this.bigIntToMinTwosComplementsHex=function(a){return Ve(a)},this.getPEMStringFromHex=function(a,u){return Je(a,u)},this.newObject=function(a){var u=b.asn1,p=u.ASN1Object,g=u.DERBoolean,m=u.DERInteger,w=u.DERBitString,O=u.DEROctetString,R=u.DERNull,P=u.DERObjectIdentifier,B=u.DEREnumerated,q=u.DERUTF8String,L=u.DERNumericString,k=u.DERPrintableString,H=u.DERTeletexString,W=u.DERIA5String,z=u.DERUTCTime,st=u.DERGeneralizedTime,bt=u.DERVisibleString,It=u.DERBMPString,Mt=u.DERSequence,Lt=u.DERSet,tt=u.DERTaggedObject,ut=u.ASN1Util.newObject;if(a instanceof u.ASN1Object)return a;var pt=Object.keys(a);if(pt.length!=1)throw new Error("key of param shall be only one.");var it=pt[0];if(":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+it+":")==-1)throw new Error("undefined key: "+it);if(it=="bool")return new g(a[it]);if(it=="int")return new m(a[it]);if(it=="bitstr")return new w(a[it]);if(it=="octstr")return new O(a[it]);if(it=="null")return new R(a[it]);if(it=="oid")return new P(a[it]);if(it=="enum")return new B(a[it]);if(it=="utf8str")return new q(a[it]);if(it=="numstr")return new L(a[it]);if(it=="prnstr")return new k(a[it]);if(it=="telstr")return new H(a[it]);if(it=="ia5str")return new W(a[it]);if(it=="utctime")return new z(a[it]);if(it=="gentime")return new st(a[it]);if(it=="visstr")return new bt(a[it]);if(it=="bmpstr")return new It(a[it]);if(it=="asn1")return new p(a[it]);if(it=="seq"){for(var wt=a[it],$t=[],Wt=0;Wt<wt.length;Wt++){var Ht=ut(wt[Wt]);$t.push(Ht)}return new Mt({array:$t})}if(it=="set"){for(wt=a[it],$t=[],Wt=0;Wt<wt.length;Wt++)Ht=ut(wt[Wt]),$t.push(Ht);return new Lt({array:$t})}if(it=="tag"){var Se=a[it];if(Object.prototype.toString.call(Se)==="[object Array]"&&Se.length==3){var zt=ut(Se[2]);return new tt({tag:Se[0],explicit:Se[1],obj:zt})}return new tt(Se)}},this.jsonToASN1HEX=function(a){return this.newObject(a).tohex()}},b.asn1.ASN1Util.oidHexToInt=function(a){for(var u="",p=parseInt(a.substr(0,2),16),g=(u=Math.floor(p/40)+"."+p%40,""),m=2;m<a.length;m+=2){var w=("00000000"+parseInt(a.substr(m,2),16).toString(2)).slice(-8);g+=w.substr(1,7),w.substr(0,1)=="0"&&(u=u+"."+new et(g,2).toString(10),g="")}return u},b.asn1.ASN1Util.oidIntToHex=function(a){var u=function(R){var P=R.toString(16);return P.length==1&&(P="0"+P),P},p=function(R){var P="",B=new et(R,10).toString(2),q=7-B.length%7;q==7&&(q=0);for(var L="",k=0;k<q;k++)L+="0";for(B=L+B,k=0;k<B.length-1;k+=7){var H=B.substr(k,7);k!=B.length-7&&(H="1"+H),P+=u(parseInt(H,2))}return P};if(!a.match(/^[0-9.]+$/))throw"malformed oid string: "+a;var g="",m=a.split("."),w=40*parseInt(m[0])+parseInt(m[1]);g+=u(w),m.splice(0,2);for(var O=0;O<m.length;O++)g+=p(m[O]);return g},b.asn1.ASN1Object=function(a){this.params=null,this.getLengthHexFromValue=function(){if(this.hV===void 0||this.hV==null)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n=0,v="+this.hV);var u=this.hV.length/2,p=u.toString(16);if(p.length%2==1&&(p="0"+p),u<128)return p;var g=p.length/2;if(g>15)throw new Error("ASN.1 length too long to represent by 8x: n = "+u.toString(16));return(128+g).toString(16)+p},this.tohex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.getValueHex=function(){return this.tohex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(u){this.params=u},a!=null&&a.tlv!=null&&(this.hTLV=a.tlv,this.isModified=!1)},b.asn1.DERAbstractString=function(a){b.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(u){this.hTLV=null,this.isModified=!0,this.s=u,this.hV=Ir(this.s).toLowerCase()},this.setStringHex=function(u){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=u},this.getFreshValueHex=function(){return this.hV},a!==void 0&&(typeof a=="string"?this.setString(a):a.str!==void 0?this.setString(a.str):a.hex!==void 0&&this.setStringHex(a.hex))},Yt(b.asn1.DERAbstractString,b.asn1.ASN1Object),b.asn1.DERAbstractTime=function(a){b.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(u){var p=u.getTime()+6e4*u.getTimezoneOffset();return new Date(p)},this.formatDate=function(u,p,g){var m=this.zeroPadding,w=this.localDateToUTC(u),O=String(w.getFullYear());p=="utc"&&(O=O.substr(2,2));var R=O+m(String(w.getMonth()+1),2)+m(String(w.getDate()),2)+m(String(w.getHours()),2)+m(String(w.getMinutes()),2)+m(String(w.getSeconds()),2);if(g===!0){var P=w.getMilliseconds();if(P!=0){var B=m(String(P),3);R=R+"."+(B=B.replace(/[0]+$/,""))}}return R+"Z"},this.zeroPadding=function(u,p){return u.length>=p?u:new Array(p-u.length+1).join("0")+u},this.setByParam=function(u){this.hV=null,this.hTLV=null,this.params=u},this.getString=function(){},this.setString=function(u){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.str=u},this.setByDate=function(u){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.date=u},this.setByDateValue=function(u,p,g,m,w,O){var R=new Date(Date.UTC(u,p-1,g,m,w,O,0));this.setByDate(R)},this.getFreshValueHex=function(){return this.hV}},Yt(b.asn1.DERAbstractTime,b.asn1.ASN1Object),b.asn1.DERAbstractStructured=function(a){b.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(u){this.hTLV=null,this.isModified=!0,this.asn1Array=u},this.appendASN1Object=function(u){this.hTLV=null,this.isModified=!0,this.asn1Array.push(u)},this.asn1Array=new Array,a!==void 0&&a.array!==void 0&&(this.asn1Array=a.array)},Yt(b.asn1.DERAbstractStructured,b.asn1.ASN1Object),b.asn1.DERBoolean=function(a){b.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV=a==0?"010100":"0101ff"},Yt(b.asn1.DERBoolean,b.asn1.ASN1Object),b.asn1.DERInteger=function(a){b.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.params=null;var u=Ve;this.setByBigInteger=function(p){this.isModified=!0,this.params={bigint:p}},this.setByInteger=function(p){this.isModified=!0,this.params=p},this.setValueHex=function(p){this.isModified=!0,this.params={hex:p}},this.getFreshValueHex=function(){var p=this.params,g=null;if(p==null)throw new Error("value not set");if(typeof p=="object"&&p.hex!=null)return this.hV=p.hex,this.hV;if(typeof p=="number")g=new et(String(p),10);else if(p.int!=null)g=new et(String(p.int),10);else{if(p.bigint==null)throw new Error("wrong parameter");g=p.bigint}return this.hV=u(g),this.hV},a!=null&&(this.params=a)},Yt(b.asn1.DERInteger,b.asn1.ASN1Object),b.asn1.DERBitString=function(a){if(a!==void 0&&a.obj!==void 0){var u=b.asn1.ASN1Util.newObject(a.obj);a.hex="00"+u.tohex()}b.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(p){this.hTLV=null,this.isModified=!0,this.hV=p},this.setUnusedBitsAndHexValue=function(p,g){if(p<0||7<p)throw"unused bits shall be from 0 to 7: u = "+p;var m="0"+p;this.hTLV=null,this.isModified=!0,this.hV=m+g},this.setByBinaryString=function(p){var g=8-(p=p.replace(/0+$/,"")).length%8;g==8&&(g=0),p+="0000000".substr(0,g);for(var m="",w=0;w<p.length-1;w+=8){var O=p.substr(w,8),R=parseInt(O,2).toString(16);R.length==1&&(R="0"+R),m+=R}this.hTLV=null,this.isModified=!0,this.hV="0"+g+m},this.setByBooleanArray=function(p){for(var g="",m=0;m<p.length;m++)p[m]==1?g+="1":g+="0";this.setByBinaryString(g)},this.newFalseArray=function(p){for(var g=new Array(p),m=0;m<p;m++)g[m]=!1;return g},this.getFreshValueHex=function(){return this.hV},a!==void 0&&(typeof a=="string"&&a.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(a):a.hex!==void 0?this.setHexValueIncludingUnusedBits(a.hex):a.bin!==void 0?this.setByBinaryString(a.bin):a.array!==void 0&&this.setByBooleanArray(a.array))},Yt(b.asn1.DERBitString,b.asn1.ASN1Object),b.asn1.DEROctetString=function(a){if(a!==void 0&&a.obj!==void 0){var u=b.asn1.ASN1Util.newObject(a.obj);a.hex=u.tohex()}b.asn1.DEROctetString.superclass.constructor.call(this,a),this.hT="04"},Yt(b.asn1.DEROctetString,b.asn1.DERAbstractString),b.asn1.DERNull=function(){b.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},Yt(b.asn1.DERNull,b.asn1.ASN1Object),b.asn1.DERObjectIdentifier=function(a){b.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(u){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=u},this.setValueOidString=function(u){var p=xe(u);if(p==null)throw new Error("malformed oid string: "+u);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=p},this.setValueName=function(u){var p=b.asn1.x509.OID.name2oid(u);if(p==="")throw new Error("DERObjectIdentifier oidName undefined: "+u);this.setValueOidString(p)},this.setValueNameOrOid=function(u){u.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(u):this.setValueName(u)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(u){typeof u=="string"?this.setValueNameOrOid(u):u.oid!==void 0?this.setValueNameOrOid(u.oid):u.name!==void 0?this.setValueNameOrOid(u.name):u.hex!==void 0&&this.setValueHex(u.hex)},a!==void 0&&this.setByParam(a)},Yt(b.asn1.DERObjectIdentifier,b.asn1.ASN1Object),b.asn1.DEREnumerated=function(a){b.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(u){this.hTLV=null,this.isModified=!0,this.hV=Ve(u)},this.setByInteger=function(u){var p=new et(String(u),10);this.setByBigInteger(p)},this.setValueHex=function(u){this.hV=u},this.getFreshValueHex=function(){return this.hV},a!==void 0&&(a.int!==void 0?this.setByInteger(a.int):typeof a=="number"?this.setByInteger(a):a.hex!==void 0&&this.setValueHex(a.hex))},Yt(b.asn1.DEREnumerated,b.asn1.ASN1Object),b.asn1.DERUTF8String=function(a){b.asn1.DERUTF8String.superclass.constructor.call(this,a),this.hT="0c"},Yt(b.asn1.DERUTF8String,b.asn1.DERAbstractString),b.asn1.DERNumericString=function(a){b.asn1.DERNumericString.superclass.constructor.call(this,a),this.hT="12"},Yt(b.asn1.DERNumericString,b.asn1.DERAbstractString),b.asn1.DERPrintableString=function(a){b.asn1.DERPrintableString.superclass.constructor.call(this,a),this.hT="13"},Yt(b.asn1.DERPrintableString,b.asn1.DERAbstractString),b.asn1.DERTeletexString=function(a){b.asn1.DERTeletexString.superclass.constructor.call(this,a),this.hT="14"},Yt(b.asn1.DERTeletexString,b.asn1.DERAbstractString),b.asn1.DERIA5String=function(a){b.asn1.DERIA5String.superclass.constructor.call(this,a),this.hT="16"},Yt(b.asn1.DERIA5String,b.asn1.DERAbstractString),b.asn1.DERVisibleString=function(a){b.asn1.DERIA5String.superclass.constructor.call(this,a),this.hT="1a"},Yt(b.asn1.DERVisibleString,b.asn1.DERAbstractString),b.asn1.DERBMPString=function(a){b.asn1.DERBMPString.superclass.constructor.call(this,a),this.hT="1e"},Yt(b.asn1.DERBMPString,b.asn1.DERAbstractString),b.asn1.DERUTCTime=function(a){b.asn1.DERUTCTime.superclass.constructor.call(this,a),this.hT="17",this.params=void 0,this.getFreshValueHex=function(){var u=this.params;if(this.params==null&&(u={date:new Date}),typeof u=="string"){if(!u.match(/^[0-9]{12}Z$/)&&!u.match(/^[0-9]{12}\.[0-9]+Z$/))throw new Error("malformed string for UTCTime: "+u);this.hV=nr(u)}else if(u.str!=null)this.hV=nr(u.str);else if(u.date==null&&u.millis==1){var p=new Date;this.hV=nr(this.formatDate(p,"utc",!0))}else if(u.date!=null&&u.date instanceof Date){var g=u.millis===!0;this.hV=nr(this.formatDate(u.date,"utc",g))}else u instanceof Date&&(this.hV=nr(this.formatDate(u,"utc")));if(this.hV==null)throw new Error("parameter not specified properly for UTCTime");return this.hV},a!=null&&this.setByParam(a)},Yt(b.asn1.DERUTCTime,b.asn1.DERAbstractTime),b.asn1.DERGeneralizedTime=function(a){b.asn1.DERGeneralizedTime.superclass.constructor.call(this,a),this.hT="18",this.params=a,this.getFreshValueHex=function(){var u=this.params;if(this.params==null&&(u={date:new Date}),typeof u=="string"){if(!u.match(/^[0-9]{14}Z$/)&&!u.match(/^[0-9]{14}\.[0-9]+Z$/))throw new Error("malformed string for GeneralizedTime: "+u);this.hV=nr(u)}else if(u.str!=null)this.hV=nr(u.str);else if(u.date==null&&u.millis==1){var p=new Date;this.hV=nr(this.formatDate(p,"gen",!0))}else if(u.date!=null&&u.date instanceof Date){var g=u.millis===!0;this.hV=nr(this.formatDate(u.date,"gen",g))}else u instanceof Date&&(this.hV=nr(this.formatDate(u,"gen")));if(this.hV==null)throw new Error("parameter not specified properly for GeneralizedTime");return this.hV},a!=null&&this.setByParam(a)},Yt(b.asn1.DERGeneralizedTime,b.asn1.DERAbstractTime),b.asn1.DERSequence=function(a){b.asn1.DERSequence.superclass.constructor.call(this,a),this.hT="30",this.getFreshValueHex=function(){for(var u="",p=0;p<this.asn1Array.length;p++)u+=this.asn1Array[p].tohex();return this.hV=u,this.hV}},Yt(b.asn1.DERSequence,b.asn1.DERAbstractStructured),b.asn1.DERSet=function(a){b.asn1.DERSet.superclass.constructor.call(this,a),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var u=new Array,p=0;p<this.asn1Array.length;p++){var g=this.asn1Array[p];u.push(g.tohex())}return this.sortFlag==1&&u.sort(),this.hV=u.join(""),this.hV},a!==void 0&&a.sortflag!==void 0&&a.sortflag==0&&(this.sortFlag=!1)},Yt(b.asn1.DERSet,b.asn1.DERAbstractStructured),b.asn1.DERTaggedObject=function(a){b.asn1.DERTaggedObject.superclass.constructor.call(this);var u=b.asn1,p=Gt,g=p.getV,m=(p.isASN1HEX,u.ASN1Util.newObject);this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.params={tag:"a0",explicit:!0},this.setASN1Object=function(w,O,R){this.params={tag:O,explicit:w,obj:R}},this.getFreshValueHex=function(){var w=this.params;if(w.explicit==null&&(w.explicit=!0),w.tage!=null&&(w.tag=w.tage,w.explicit=!0),w.tagi!=null&&(w.tag=w.tagi,w.explicit=!1),w.str!=null)this.hV=Ir(w.str);else if(w.hex!=null)this.hV=w.hex;else{if(w.obj==null)throw new Error("str, hex nor obj not specified");var O;w.obj instanceof u.ASN1Object?O=w.obj.tohex():typeof w.obj=="object"&&(O=m(w.obj).tohex()),w.explicit?this.hV=O:this.hV=g(O,0)}return w.tag==null&&(w.tag="a0"),this.hT=w.tag,this.hTLV=null,this.isModified=!0,this.hV},this.setByParam=function(w){this.params=w},a!==void 0&&this.setByParam(a)},Yt(b.asn1.DERTaggedObject,b.asn1.ASN1Object);var b,Be,ce,Gt=new function(){};function ze(a){for(var u=new Array,p=0;p<a.length;p++)u[p]=a.charCodeAt(p);return u}function We(a){for(var u="",p=0;p<a.length;p++)u+=String.fromCharCode(a[p]);return u}function Xe(a){for(var u="",p=0;p<a.length;p++){var g=a[p].toString(16);g.length==1&&(g="0"+g),u+=g}return u}function nr(a){return Xe(ze(a))}function lr(a){return(a=(a=a.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function ur(a){return a.length%4==2?a+="==":a.length%4==3&&(a+="="),(a=a.replace(/-/g,"+")).replace(/_/g,"/")}function Me(a){return a.length%2==1&&(a="0"+a),lr(nt(a))}function Ke(a){return ct(ur(a))}function Ir(a){return Yr(Ar(a)).toLowerCase()}function Le(a){try{return decodeURIComponent(Jr(a))}catch{return null}}function qr(a){return Le(function(u){for(var p=u.match(/.{1,2}/g),g=[],m=0;m<p.length;m++){var w=parseInt(p[m],16);161<=w&&w<=191?(g.push("c2"),g.push(p[m])):192<=w&&w<=255?(g.push("c3"),g.push((w-64).toString(16))):g.push(p[m])}return g.join("")}(a))}function hr(a){for(var u="",p=0;p<a.length-1;p+=2)u+=String.fromCharCode(parseInt(a.substr(p,2),16));return u}function Sr(a){for(var u="",p=0;p<a.length;p++)u+=("0"+a.charCodeAt(p).toString(16)).slice(-2);return u}function Xr(a){return nt(a)}function Kr(a,u){return(a=a.replace(new RegExp("(.{"+u+"})","g"),`$1\r
`)).replace(/\s+$/,"")}function Qe(a){return ct(a.replace(/[^0-9A-Za-z\/+=]*/g,""))}function Je(a,u){return"-----BEGIN "+u+`-----\r
`+Kr(Xr(a),64)+`\r
-----END `+u+`-----\r
`}function tr(a,u){if(a.indexOf("-----BEGIN ")==-1)throw new Error("can't find PEM header");return Qe(a=u!==void 0?(a=a.replace(new RegExp("^[^]*-----BEGIN "+u+"-----"),"")).replace(new RegExp("-----END "+u+"-----[^]*$"),""):(a=a.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,""))}function an(a){var u,p,g,m,w,O,R,P,B,q;if(q=(a=Gr(a)).match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return u=parseInt(q[1]),p=parseInt(q[2])-1,g=parseInt(q[3]),m=parseInt(q[4]),w=parseInt(q[5]),O=parseInt(q[6]),R=0,(P=q[7])!==""&&(B=(P.substr(1)+"00").substr(0,3),R=parseInt(B)),Date.UTC(u,p,g,m,w,O,R);throw new Error("unsupported zulu format: "+a)}function Vr(a){return Math.round(an(a)/1e3)}function Gr(a){return a.match(/^[0-9]{12}Z$/)||a.match(/^[0-9]{12}[.][0-9]*Z$/)?a.match(/^[0-4]/)?"20"+a:"19"+a:a}function Yr(a){return a.replace(/%/g,"")}function Jr(a){return a.replace(/(..)/g,"%$1")}function sn(a){var u="malformed IPv6 address";if(!a.match(/^[0-9A-Fa-f:]+$/))throw u;var p=(a=a.toLowerCase()).split(":").length-1;if(p<2)throw u;var g=":".repeat(7-p+2),m=(a=a.replace("::",g)).split(":");if(m.length!=8)throw u;for(var w=0;w<8;w++)m[w]=("0000"+m[w]).slice(-4);return m.join("")}function se(a){if(!a.match(/^[0-9A-Fa-f]{32}$/))throw new Error("malformed IPv6 address: "+a);var u=(a=a.toLowerCase()).match(/.{1,4}/g),p=(a=":"+(u=(u=u.map(function(m){return m.replace(/^0+/,"")})).map(function(m){return m==""?"0":m})).join(":")+":").match(/:(0:){2,}/g);if(p==null)return a.slice(1,-1);var g=p.sort().slice(-1)[0];return(a=a.replace(g.substr(0,g.length-1),":")).substr(0,2)!="::"&&(a=a.substr(1)),a.substr(-2,2)!="::"&&(a=a.substr(0,a.length-1)),a}function ye(a){var u=new Error("malformed hex value");if(!a.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw u;if(a.length==8)try{return parseInt(a.substr(0,2),16)+"."+parseInt(a.substr(2,2),16)+"."+parseInt(a.substr(4,2),16)+"."+parseInt(a.substr(6,2),16)}catch{throw u}else{if(a.length!=16){if(a.length==32)return se(a);if(a.length==64){try{return se(a.substr(0,32))+"/"+Re(a.substr(32))}catch{throw u}return}return a}try{return ye(a.substr(0,8))+"/"+Re(a.substr(8))}catch{throw u}}}function Re(a){var u,p=new Error("malformed mask");try{u=new et(a,16).toString(2)}catch{throw p}if(!u.match(/^1*0*$/))throw p;return u.replace(/0+$/,"").length}function ar(a){var u=new Error("malformed IP address");if(!(a=a.toLowerCase(a)).match(/^[0-9a-f.:/]+$/))throw u;if(!a.match(/^[0-9.]+$/)){var p;if(a.match(/^[0-9.]+\/[0-9]+$/))return ar((p=a.split("/"))[0])+he(parseInt(p[1]),32);if(a.match(/^[0-9a-f:]+$/)&&a.indexOf(":")!==-1)return sn(a);if(a.match(/^[0-9a-f:]+\/[0-9]+$/)&&a.indexOf(":")!==-1)return sn((p=a.split("/"))[0])+he(parseInt(p[1]),128);throw u}var g=a.split(".");if(g.length!==4)throw u;var m="";try{for(var w=0;w<4;w++)m+=("0"+parseInt(g[w]).toString(16)).slice(-2);return m}catch{throw u}}function he(a,u){return u==32&&a==0?"00000000":u==128&&a==0?"00000000000000000000000000000000":new et(Array(a+1).join("1")+Array(u-a+1).join("0"),2).toString(16)}function Zr(a){return a.match(/.{4}/g).map(function(u){var p=parseInt(u.substr(0,2),16),g=parseInt(u.substr(2),16);if(p==0&g<128)return String.fromCharCode(g);if(p<8){var m=128|63&g;return Le((192|(7&p)<<3|(192&g)>>6).toString(16)+m.toString(16))}m=128|(15&p)<<2|(192&g)>>6;var w=128|63&g;return Le((224|(240&p)>>4).toString(16)+m.toString(16)+w.toString(16))}).join("")}function Ar(a){for(var u=encodeURIComponent(a),p="",g=0;g<u.length;g++)u[g]=="%"?(p+=u.substr(g,3),g+=2):p=p+"%"+nr(u[g]);return p}function un(a){return!(a.length%2!=0||!a.match(/^[0-9a-f]+$/)&&!a.match(/^[0-9A-F]+$/))}function or(a){return!!a.match(/^[0-9A-Za-z-_.]+$/)}function X(a){return a.length%2==1?"0"+a:a.substr(0,1)>"7"?"00"+a:a}function xe(a){var u=function(R){var P=R.toString(16);return P.length==1&&(P="0"+P),P},p=function(R){var P="",B=parseInt(R,10).toString(2),q=7-B.length%7;q==7&&(q=0);for(var L="",k=0;k<q;k++)L+="0";for(B=L+B,k=0;k<B.length-1;k+=7){var H=B.substr(k,7);k!=B.length-7&&(H="1"+H),P+=u(parseInt(H,2))}return P};try{if(!a.match(/^[0-9.]+$/))return null;var g="",m=a.split("."),w=40*parseInt(m[0],10)+parseInt(m[1],10);g+=u(w),m.splice(0,2);for(var O=0;O<m.length;O++)g+=p(m[O]);return g}catch{return null}}function Tr(a){if(!un(a))return null;try{var u=[],p=a.substr(0,2),g=parseInt(p,16);u[0]=new String(Math.floor(g/40)),u[1]=new String(g%40);for(var m=a.substr(2),w=[],O=0;O<m.length/2;O++)w.push(parseInt(m.substr(2*O,2),16));var R=[],P="";for(O=0;O<w.length;O++)128&w[O]?P+=Ut((127&w[O]).toString(2),7):(P+=Ut((127&w[O]).toString(2),7),R.push(new String(parseInt(P,2))),P="");var B=u.join(".");return R.length>0&&(B=B+"."+R.join(".")),B}catch{return null}}function gr(a){return Ve(new et(String(a),10))}function Ve(a){var u=a.toString(16);if(u.substr(0,1)!="-")return u.length%2==1?u="0"+u:u.match(/^[0-7]/)||(u="00"+u),u;var p=u.substr(1).length;p%2==1?p+=1:u.match(/^[0-7]/)||(p+=2);for(var g="",m=0;m<p;m++)g+="f";return new et(g,16).xor(a).add(et.ONE).toString(16).replace(/^-/,"")}Gt.getLblen=function(a,u){if(a.substr(u+2,1)!="8")return 1;var p=parseInt(a.substr(u+3,1));return p==0?-1:0<p&&p<10?p+1:-2},Gt.getL=function(a,u){var p=Gt.getLblen(a,u);return p<1?"":a.substr(u+2,2*p)},Gt.getVblen=function(a,u){var p;return(p=Gt.getL(a,u))==""?-1:(p.substr(0,1)==="8"?new et(p.substr(2),16):new et(p,16)).intValue()},Gt.getVidx=function(a,u){var p=Gt.getLblen(a,u);return p<0?p:u+2*(p+1)},Gt.getV=function(a,u){var p=Gt.getVidx(a,u),g=Gt.getVblen(a,u);return a.substr(p,2*g)},Gt.getTLV=function(a,u){return a.substr(u,2)+Gt.getL(a,u)+Gt.getV(a,u)},Gt.getTLVblen=function(a,u){return 2+2*Gt.getLblen(a,u)+2*Gt.getVblen(a,u)},Gt.getNextSiblingIdx=function(a,u){return Gt.getVidx(a,u)+2*Gt.getVblen(a,u)},Gt.getChildIdx=function(a,u){var p,g,m,w=Gt,O=[];p=w.getVidx(a,u),g=2*w.getVblen(a,u),a.substr(u,2)=="03"&&(p+=2,g-=2),m=0;for(var R=p;m<=g;){var P=w.getTLVblen(a,R);if((m+=P)<=g&&O.push(R),R+=P,m>=g)break}return O},Gt.getNthChildIdx=function(a,u,p){return Gt.getChildIdx(a,u)[p]},Gt.getIdxbyList=function(a,u,p,g){var m,w,O=Gt;return p.length==0?g!==void 0&&a.substr(u,2)!==g?-1:u:(m=p.shift())>=(w=O.getChildIdx(a,u)).length?-1:O.getIdxbyList(a,w[m],p,g)},Gt.getIdxbyListEx=function(a,u,p,g){var m,w,O=Gt;if(p.length==0)return g!==void 0&&a.substr(u,2)!==g?-1:u;m=p.shift(),w=O.getChildIdx(a,u);for(var R=0,P=0;P<w.length;P++){var B=a.substr(w[P],2);if(typeof m=="number"&&!O.isContextTag(B)&&R==m||typeof m=="string"&&O.isContextTag(B,m))return O.getIdxbyListEx(a,w[P],p,g);O.isContextTag(B)||R++}return-1},Gt.getTLVbyList=function(a,u,p,g){var m=Gt,w=m.getIdxbyList(a,u,p,g);return w==-1||w>=a.length?null:m.getTLV(a,w)},Gt.getTLVbyListEx=function(a,u,p,g){var m=Gt,w=m.getIdxbyListEx(a,u,p,g);return w==-1?null:m.getTLV(a,w)},Gt.getVbyList=function(a,u,p,g,m){var w,O,R=Gt;return(w=R.getIdxbyList(a,u,p,g))==-1||w>=a.length?null:(O=R.getV(a,w),m===!0&&(O=O.substr(2)),O)},Gt.getVbyListEx=function(a,u,p,g,m){var w,O,R=Gt;return(w=R.getIdxbyListEx(a,u,p,g))==-1?null:(O=R.getV(a,w),a.substr(w,2)=="03"&&m!==!1&&(O=O.substr(2)),O)},Gt.getInt=function(a,u,p){p==null&&(p=-1);try{var g=a.substr(u,2);if(g!="02"&&g!="03")return p;var m=Gt.getV(a,u);return g=="02"?parseInt(m,16):sr(m)}catch{return p}},Gt.getOID=function(a,u,p){p==null&&(p=null);try{return a.substr(u,2)!="06"?p:Tr(Gt.getV(a,u))}catch{return p}},Gt.getOIDName=function(a,u,p){p==null&&(p=null);try{var g=Gt.getOID(a,u,p);if(g==p)return p;var m=b.asn1.x509.OID.oid2name(g);return m==""?g:m}catch{return p}},Gt.getString=function(a,u,p){p==null&&(p=null);try{return hr(Gt.getV(a,u))}catch{return p}},Gt.hextooidstr=function(a){var u=function(L,k){return L.length>=k?L:new Array(k-L.length+1).join("0")+L},p=[],g=a.substr(0,2),m=parseInt(g,16);p[0]=new String(Math.floor(m/40)),p[1]=new String(m%40);for(var w=a.substr(2),O=[],R=0;R<w.length/2;R++)O.push(parseInt(w.substr(2*R,2),16));var P=[],B="";for(R=0;R<O.length;R++)128&O[R]?B+=u((127&O[R]).toString(2),7):(B+=u((127&O[R]).toString(2),7),P.push(new String(parseInt(B,2))),B="");var q=p.join(".");return P.length>0&&(q=q+"."+P.join(".")),q},Gt.dump=function(a,u,p,g){var m=Gt,w=m.getV,O=m.dump,R=m.getChildIdx,P=a;a instanceof b.asn1.ASN1Object&&(P=a.tohex());var B=function(pt,it){return pt.length<=2*it?pt:pt.substr(0,it)+"..(total "+pt.length/2+"bytes).."+pt.substr(pt.length-it,it)};u===void 0&&(u={ommit_long_octet:32}),p===void 0&&(p=0),g===void 0&&(g="");var q,L=u.ommit_long_octet;if((q=P.substr(p,2))=="01")return(k=w(P,p))=="00"?g+`BOOLEAN FALSE
`:g+`BOOLEAN TRUE
`;if(q=="02")return g+"INTEGER "+B(k=w(P,p),L)+`
`;if(q=="03"){var k=w(P,p);return m.isASN1HEX(k.substr(2))?(tt=g+`BITSTRING, encapsulates
`)+O(k.substr(2),u,0,g+"  "):g+"BITSTRING "+B(k,L)+`
`}if(q=="04")return k=w(P,p),m.isASN1HEX(k)?(tt=g+`OCTETSTRING, encapsulates
`)+O(k,u,0,g+"  "):g+"OCTETSTRING "+B(k,L)+`
`;if(q=="05")return g+`NULL
`;if(q=="06"){var H=w(P,p),W=b.asn1.ASN1Util.oidHexToInt(H),z=b.asn1.x509.OID.oid2name(W),st=W.replace(/\./g," ");return z!=""?g+"ObjectIdentifier "+z+" ("+st+`)
`:g+"ObjectIdentifier ("+st+`)
`}if(q=="0a")return g+"ENUMERATED "+parseInt(w(P,p))+`
`;if(q=="0c")return g+"UTF8String '"+Le(w(P,p))+`'
`;if(q=="13")return g+"PrintableString '"+Le(w(P,p))+`'
`;if(q=="14")return g+"TeletexString '"+Le(w(P,p))+`'
`;if(q=="16")return g+"IA5String '"+Le(w(P,p))+`'
`;if(q=="17")return g+"UTCTime "+Le(w(P,p))+`
`;if(q=="18")return g+"GeneralizedTime "+Le(w(P,p))+`
`;if(q=="1a")return g+"VisualString '"+Le(w(P,p))+`'
`;if(q=="1e")return g+"BMPString '"+Zr(w(P,p))+`'
`;if(q=="30"){if(P.substr(p,4)=="3000")return g+`SEQUENCE {}
`;tt=g+`SEQUENCE
`;var bt=u;if(((Lt=R(P,p)).length==2||Lt.length==3)&&P.substr(Lt[0],2)=="06"&&P.substr(Lt[Lt.length-1],2)=="04"){z=m.oidname(w(P,Lt[0]));var It=JSON.parse(JSON.stringify(u));It.x509ExtName=z,bt=It}for(var Mt=0;Mt<Lt.length;Mt++)tt+=O(P,bt,Lt[Mt],g+"  ");return tt}if(q=="31"){tt=g+`SET
`;var Lt=R(P,p);for(Mt=0;Mt<Lt.length;Mt++)tt+=O(P,u,Lt[Mt],g+"  ");return tt}if(128&(q=parseInt(q,16))){var tt,ut=31&q;if(32&q){for(tt=g+"["+ut+`]
`,Lt=R(P,p),Mt=0;Mt<Lt.length;Mt++)tt+=O(P,u,Lt[Mt],g+"  ");return tt}return k=w(P,p),Gt.isASN1HEX(k)?(tt=g+"["+ut+`]
`)+O(k,u,0,g+"  "):((k.substr(0,8)=="68747470"||u.x509ExtName==="subjectAltName"&&ut==2)&&(k=Le(k)),g+"["+ut+"] "+k+`
`)}return g+"UNKNOWN("+q+") "+w(P,p)+`
`},Gt.parse=function(a){var u=Gt,p=u.parse,g=u.isASN1HEX,m=u.getV,w=u.getTLV,O=u.getChildIdx,R=b.asn1,P=R.ASN1Util.oidHexToInt,B=R.x509.OID.oid2name,q=Le,L=Zr,k=qr,H={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"},W=a.substr(0,2),z={},st=m(a,0);if(W=="01")return a=="0101ff"?{bool:!0}:{bool:!1};if(W=="02")return{int:{hex:st}};if(W=="03")try{if(st.substr(0,2)!="00")throw"not encap";var bt=st.substr(2);if(!g(bt))throw"not encap";return{bitstr:{obj:p(bt)}}}catch{var It=null;return st.length<=10&&(It=Ie(st)),It==null?{bitstr:{hex:st}}:{bitstr:{bin:It}}}else if(W=="04")try{if(!g(st))throw"not encap";return{octstr:{obj:p(st)}}}catch{return{octstr:{hex:st}}}else{if(W=="05")return{null:""};if(W=="06"){var Mt=P(st),Lt=B(Mt);return Lt==""?{oid:Mt}:{oid:Lt}}if(W=="0a")return st.length>4?{enum:{hex:st}}:{enum:parseInt(st,16)};if(W=="30"||W=="31")return z[H[W]]=function(pt){for(var it=[],wt=O(pt,0),$t=0;$t<wt.length;$t++){var Wt=wt[$t],Ht=w(pt,Wt),Se=p(Ht);it.push(Se)}return it}(a),z;if(W=="14"){var tt=k(st);return z[H[W]]={str:tt},z}if(W=="1e")return tt=L(st),z[H[W]]={str:tt},z;if(":0c:12:13:16:17:18:1a:".indexOf(W)!=-1)return tt=q(st),z[H[W]]={str:tt},z;if(W.match(/^8[0-9]$/))return(tt=q(st))==null|tt==""||tt.match(/[\x00-\x1F\x7F-\x9F]/)!=null||tt.match(/[\u0000-\u001F\u0080\u2013\u009F]/)!=null?{tag:{tag:W,explicit:!1,hex:st}}:{tag:{tag:W,explicit:!1,str:tt}};if(!W.match(/^a[0-9]$/)){var ut=new b.asn1.ASN1Object;return ut.hV=st,{asn1:{tlv:W+ut.getLengthHexFromValue()+st}}}try{if(!g(st))throw new Error("not encap");return{tag:{tag:W,explicit:!0,obj:p(st)}}}catch{return{tag:{tag:W,explicit:!0,hex:st}}}}},Gt.isContextTag=function(a,u){var p,g;a=a.toLowerCase();try{p=parseInt(a,16)}catch{return-1}if(u===void 0)return(192&p)==128;try{return u.match(/^\[[0-9]+\]$/)!=null&&!((g=parseInt(u.substr(1,u.length-1),10))>31)&&(192&p)==128&&(31&p)==g}catch{return!1}},Gt.isASN1HEX=function(a){var u=Gt;if(a.length%2==1)return!1;var p=u.getVblen(a,0),g=a.substr(0,2),m=u.getL(a,0);return a.length-g.length-m.length==2*p},Gt.checkStrictDER=function(a,u,p,g,m){var w=Gt;if(p===void 0){if(typeof a!="string")throw new Error("not hex string");if(a=a.toLowerCase(),!b.lang.String.isHex(a))throw new Error("not hex string");p=a.length,m=(g=a.length/2)<128?1:Math.ceil(g.toString(16))+1}if(w.getL(a,u).length>2*m)throw new Error("L of TLV too long: idx="+u);var O=w.getVblen(a,u);if(O>g)throw new Error("value of L too long than hex: idx="+u);var R=w.getTLV(a,u),P=R.length-2-w.getL(a,u).length;if(P!==2*O)throw new Error("V string length and L's value not the same:"+P+"/"+2*O);if(u===0&&a.length!=R.length)throw new Error("total length and TLV length unmatch:"+a.length+"!="+R.length);var B=a.substr(u,2);if(B==="02"){var q=w.getVidx(a,u);if(a.substr(q,2)=="00"&&a.charCodeAt(q+2)<56)throw new Error("not least zeros for DER INTEGER")}if(32&parseInt(B,16)){for(var L=w.getVblen(a,u),k=0,H=w.getChildIdx(a,u),W=0;W<H.length;W++)k+=w.getTLV(a,H[W]).length,w.checkStrictDER(a,H[W],p,g,m);if(2*L!=k)throw new Error("sum of children's TLV length and L unmatch: "+2*L+"!="+k)}},Gt.oidname=function(a){var u=b.asn1;b.lang.String.isHex(a)&&(a=u.ASN1Util.oidHexToInt(a));var p=u.x509.OID.oid2name(a);return p===""&&(p=a),p},b!==void 0&&b||(b={}),b.asn1!==void 0&&b.asn1||(b.asn1={}),b.asn1.x509!==void 0&&b.asn1.x509||(b.asn1.x509={}),b.asn1.x509.Certificate=function(a){b.asn1.x509.Certificate.superclass.constructor.call(this);var u=b.asn1,p=u.DERBitString,g=u.DERSequence,m=u.x509,w=m.TBSCertificate,O=m.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(R){this.params=R},this.sign=function(){var R=this.params,P=R.sigalg;R.sigalg.name!=null&&(P=R.sigalg.name);var B=R.tbsobj.tohex(),q=new b.crypto.Signature({alg:P});q.init(R.cakey),q.updateHex(B),R.sighex=q.sign()},this.getPEM=function(){return Je(this.tohex(),"CERTIFICATE")},this.tohex=function(){var R=this.params;if(R.tbsobj!=null&&R.tbsobj!=null||(R.tbsobj=new w(R)),R.sighex==null&&R.cakey!=null&&this.sign(),R.sighex==null)throw new Error("sighex or cakey parameter not defined");var P=[];return P.push(R.tbsobj),P.push(new O({name:R.sigalg})),P.push(new p({hex:"00"+R.sighex})),new g({array:P}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&(this.params=a)},Yt(b.asn1.x509.Certificate,b.asn1.ASN1Object),b.asn1.x509.TBSCertificate=function(a){b.asn1.x509.TBSCertificate.superclass.constructor.call(this);var u=b.asn1,p=u.x509,g=u.DERTaggedObject,m=u.DERInteger,w=u.DERSequence,O=p.AlgorithmIdentifier,R=p.Time,P=p.X500Name,B=p.Extensions,q=p.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(L){this.params=L},this.tohex=function(){var L=[],k=this.params;if(k.version!=null||k.version!=1){var H=2;k.version!=null&&(H=k.version-1);var W=new g({obj:new m({int:H})});L.push(W)}return L.push(new m(k.serial)),L.push(new O({name:k.sigalg})),L.push(new P(k.issuer)),L.push(new w({array:[new R(k.notbefore),new R(k.notafter)]})),L.push(new P(k.subject)),L.push(new q(Te.getKey(k.sbjpubkey))),k.ext!==void 0&&k.ext.length>0&&L.push(new g({tag:"a3",obj:new B(k.ext)})),new b.asn1.DERSequence({array:L}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(b.asn1.x509.TBSCertificate,b.asn1.ASN1Object),b.asn1.x509.Extensions=function(a){b.asn1.x509.Extensions.superclass.constructor.call(this);var u=b.asn1,p=u.DERSequence,g=u.x509;this.aParam=[],this.setByParam=function(m){this.aParam=m},this.tohex=function(){for(var m=[],w=0;w<this.aParam.length;w++){var O=this.aParam[w],R=O.extname,P=null;if(O.extn!=null)P=new g.PrivateExtension(O);else if(R=="subjectKeyIdentifier")P=new g.SubjectKeyIdentifier(O);else if(R=="keyUsage")P=new g.KeyUsage(O);else if(R=="subjectAltName")P=new g.SubjectAltName(O);else if(R=="issuerAltName")P=new g.IssuerAltName(O);else if(R=="basicConstraints")P=new g.BasicConstraints(O);else if(R=="nameConstraints")P=new g.NameConstraints(O);else if(R=="cRLDistributionPoints")P=new g.CRLDistributionPoints(O);else if(R=="certificatePolicies")P=new g.CertificatePolicies(O);else if(R=="policyMappings")P=new g.PolicyMappings(O);else if(R=="policyConstraints")P=new g.PolicyConstraints(O);else if(R=="inhibitAnyPolicy")P=new g.InhibitAnyPolicy(O);else if(R=="authorityKeyIdentifier")P=new g.AuthorityKeyIdentifier(O);else if(R=="extKeyUsage")P=new g.ExtKeyUsage(O);else if(R=="authorityInfoAccess")P=new g.AuthorityInfoAccess(O);else if(R=="cRLNumber")P=new g.CRLNumber(O);else if(R=="cRLReason")P=new g.CRLReason(O);else if(R=="ocspNonce")P=new g.OCSPNonce(O);else if(R=="ocspNoCheck")P=new g.OCSPNoCheck(O);else if(R=="adobeTimeStamp")P=new g.AdobeTimeStamp(O);else{if(R!="subjectDirectoryAttributes")throw new Error("extension not supported:"+JSON.stringify(O));P=new g.SubjectDirectoryAttributes(O)}P!=null&&m.push(P)}return new p({array:m}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.x509.Extensions,b.asn1.ASN1Object),b.asn1.x509.Extension=function(a){b.asn1.x509.Extension.superclass.constructor.call(this);var u=b.asn1,p=u.DERObjectIdentifier,g=u.DEROctetString,m=(u.DERBitString,u.DERBoolean),w=u.DERSequence;this.tohex=function(){var O=new p({oid:this.oid}),R=new g({hex:this.getExtnValueHex()}),P=new Array;return P.push(O),this.critical&&P.push(new m),P.push(R),new w({array:P}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.critical=!1,a!==void 0&&a.critical!==void 0&&(this.critical=a.critical)},Yt(b.asn1.x509.Extension,b.asn1.ASN1Object),b.asn1.x509.KeyUsage=function(a){b.asn1.x509.KeyUsage.superclass.constructor.call(this,a);var u=Error,p={digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8};this.getExtnValueHex=function(){var g=this.getBinValue();return this.asn1ExtnValue=new b.asn1.DERBitString({bin:g}),this.asn1ExtnValue.tohex()},this.getBinValue=function(){var g=this.params;if(typeof g!="object"||typeof g.names!="object"&&typeof g.bin!="string")throw new u("parameter not yet set");if(g.names!=null)return fr(g.names,p);if(g.bin!=null)return g.bin;throw new u("parameter not set properly")},this.oid="2.5.29.15",a!==void 0&&(this.params=a)},Yt(b.asn1.x509.KeyUsage,b.asn1.x509.Extension),b.asn1.x509.BasicConstraints=function(a){b.asn1.x509.BasicConstraints.superclass.constructor.call(this,a);var u=b.asn1,p=u.DERBoolean,g=u.DERInteger,m=u.DERSequence;this.getExtnValueHex=function(){var w=new Array;this.cA&&w.push(new p),this.pathLen>-1&&w.push(new g({int:this.pathLen}));var O=new m({array:w});return this.asn1ExtnValue=O,this.asn1ExtnValue.tohex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,a!==void 0&&(a.cA!==void 0&&(this.cA=a.cA),a.pathLen!==void 0&&(this.pathLen=a.pathLen))},Yt(b.asn1.x509.BasicConstraints,b.asn1.x509.Extension),b.asn1.x509.CRLDistributionPoints=function(a){b.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,a);var u=b.asn1,p=u.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.setByDPArray=function(g){for(var m=[],w=0;w<g.length;w++)if(g[w]instanceof b.asn1.ASN1Object)m.push(g[w]);else{var O=new p.DistributionPoint(g[w]);m.push(O)}this.asn1ExtnValue=new u.DERSequence({array:m})},this.setByOneURI=function(g){var m=new p.DistributionPoint({fulluri:g});this.setByDPArray([m])},this.oid="2.5.29.31",a!==void 0&&(a.array!==void 0?this.setByDPArray(a.array):a.uri!==void 0&&this.setByOneURI(a.uri))},Yt(b.asn1.x509.CRLDistributionPoints,b.asn1.x509.Extension),b.asn1.x509.DistributionPoint=function(a){b.asn1.x509.DistributionPoint.superclass.constructor.call(this);var u=b.asn1,p=u.x509.DistributionPointName;this.tohex=function(){var g=new u.DERSequence;if(this.asn1DP!=null){var m=new u.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});g.appendASN1Object(m)}return this.hTLV=g.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&(a.dpobj!==void 0?this.asn1DP=a.dpobj:a.dpname!==void 0?this.asn1DP=new p(a.dpname):a.fulluri!==void 0&&(this.asn1DP=new p({full:[{uri:a.fulluri}]})))},Yt(b.asn1.x509.DistributionPoint,b.asn1.ASN1Object),b.asn1.x509.DistributionPointName=function(a){b.asn1.x509.DistributionPointName.superclass.constructor.call(this);var u=b.asn1,p=u.DERTaggedObject;if(this.tohex=function(){if(this.type!="full")throw new Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new p({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0)if(u.x509.GeneralNames.prototype.isPrototypeOf(a))this.type="full",this.tag="a0",this.asn1V=a;else{if(a.full===void 0)throw new Error("This class supports GeneralNames only as argument");this.type="full",this.tag="a0",this.asn1V=new u.x509.GeneralNames(a.full)}},Yt(b.asn1.x509.DistributionPointName,b.asn1.ASN1Object),b.asn1.x509.CertificatePolicies=function(a){b.asn1.x509.CertificatePolicies.superclass.constructor.call(this,a);var u=b.asn1,p=u.x509,g=u.DERSequence,m=p.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var w=[],O=0;O<this.params.array.length;O++)w.push(new m(this.params.array[O]));var R=new g({array:w});return this.asn1ExtnValue=R,this.asn1ExtnValue.tohex()},this.oid="2.5.29.32",a!==void 0&&(this.params=a)},Yt(b.asn1.x509.CertificatePolicies,b.asn1.x509.Extension),b.asn1.x509.PolicyInformation=function(a){b.asn1.x509.PolicyInformation.superclass.constructor.call(this,a);var u=b.asn1,p=u.DERSequence,g=u.DERObjectIdentifier,m=u.x509.PolicyQualifierInfo;this.params=null,this.tohex=function(){if(this.params.policyoid===void 0&&this.params.array===void 0)throw new Error("parameter oid and array missing");var w=[new g(this.params.policyoid)];if(this.params.array!==void 0){for(var O=[],R=0;R<this.params.array.length;R++)O.push(new m(this.params.array[R]));O.length>0&&w.push(new p({array:O}))}return new p({array:w}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&(this.params=a)},Yt(b.asn1.x509.PolicyInformation,b.asn1.ASN1Object),b.asn1.x509.PolicyQualifierInfo=function(a){b.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,a);var u=b.asn1,p=u.DERSequence,g=u.DERIA5String,m=u.DERObjectIdentifier,w=u.x509.UserNotice;this.params=null,this.tohex=function(){return this.params.cps!==void 0?new p({array:[new m({oid:"1.3.6.1.5.5.7.2.1"}),new g({str:this.params.cps})]}).tohex():this.params.unotice!=null?new p({array:[new m({oid:"1.3.6.1.5.5.7.2.2"}),new w(this.params.unotice)]}).tohex():void 0},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&(this.params=a)},Yt(b.asn1.x509.PolicyQualifierInfo,b.asn1.ASN1Object),b.asn1.x509.UserNotice=function(a){b.asn1.x509.UserNotice.superclass.constructor.call(this,a);var u=b.asn1.DERSequence,p=(b.asn1.DERInteger,b.asn1.x509.DisplayText),g=b.asn1.x509.NoticeReference;this.params=null,this.tohex=function(){var m=[];return this.params.noticeref!==void 0&&m.push(new g(this.params.noticeref)),this.params.exptext!==void 0&&m.push(new p(this.params.exptext)),new u({array:m}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&(this.params=a)},Yt(b.asn1.x509.UserNotice,b.asn1.ASN1Object),b.asn1.x509.NoticeReference=function(a){b.asn1.x509.NoticeReference.superclass.constructor.call(this,a);var u=b.asn1.DERSequence,p=b.asn1.DERInteger,g=b.asn1.x509.DisplayText;this.params=null,this.tohex=function(){var m=[];if(this.params.org!==void 0&&m.push(new g(this.params.org)),this.params.noticenum!==void 0){for(var w=[],O=this.params.noticenum,R=0;R<O.length;R++)w.push(new p(O[R]));m.push(new u({array:w}))}if(m.length==0)throw new Error("parameter is empty");return new u({array:m}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&(this.params=a)},Yt(b.asn1.x509.NoticeReference,b.asn1.ASN1Object),b.asn1.x509.DisplayText=function(a){b.asn1.x509.DisplayText.superclass.constructor.call(this,a),this.hT="0c",a!==void 0&&(a.type==="ia5"?this.hT="16":a.type==="vis"?this.hT="1a":a.type==="bmp"&&(this.hT="1e"))},Yt(b.asn1.x509.DisplayText,b.asn1.DERAbstractString),b.asn1.x509.PolicyMappings=function(a){b.asn1.x509.PolicyMappings.superclass.constructor.call(this,a);var u=b.asn1,p=(u.x509,u.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){for(var g=this.params,m=[],w=0;w<g.array.length;w++){var O=g.array[w];m.push({seq:[{oid:O[0]},{oid:O[1]}]})}return this.asn1ExtnValue=p({seq:m}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.33",a!==void 0&&(this.params=a)},Yt(b.asn1.x509.PolicyMappings,b.asn1.x509.Extension),b.asn1.x509.PolicyConstraints=function(a){b.asn1.x509.PolicyConstraints.superclass.constructor.call(this,a);var u=b.asn1,p=(u.x509,u.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){var g=this.params,m=[];return g.reqexp!=null&&m.push({tag:{tagi:"80",obj:{int:g.reqexp}}}),g.inhibit!=null&&m.push({tag:{tagi:"81",obj:{int:g.inhibit}}}),this.asn1ExtnValue=p({seq:m}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.36",a!==void 0&&(this.params=a)},Yt(b.asn1.x509.PolicyConstraints,b.asn1.x509.Extension),b.asn1.x509.InhibitAnyPolicy=function(a){b.asn1.x509.InhibitAnyPolicy.superclass.constructor.call(this,a);var u=b.asn1,p=(u.x509,u.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=p({int:this.params.skip}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.54",a!==void 0&&(this.params=a)},Yt(b.asn1.x509.InhibitAnyPolicy,b.asn1.x509.Extension),b.asn1.x509.NameConstraints=function(a){b.asn1.x509.NameConstraints.superclass.constructor.call(this,a);var u=b.asn1,p=u.x509,g=u.ASN1Util.newObject,m=p.GeneralSubtree;this.params=null,this.getExtnValueHex=function(){var w=this.params,O=[];if(w.permit!=null&&w.permit.length!=null){for(var R=[],P=0;P<w.permit.length;P++)R.push(new m(w.permit[P]));O.push({tag:{tagi:"a0",obj:{seq:R}}})}if(w.exclude!=null&&w.exclude.length!=null){var B=[];for(P=0;P<w.exclude.length;P++)B.push(new m(w.exclude[P]));O.push({tag:{tagi:"a1",obj:{seq:B}}})}return this.asn1ExtnValue=g({seq:O}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.30",a!==void 0&&(this.params=a)},Yt(b.asn1.x509.NameConstraints,b.asn1.x509.Extension),b.asn1.x509.GeneralSubtree=function(a){b.asn1.x509.GeneralSubtree.superclass.constructor.call(this);var u=b.asn1,p=u.x509.GeneralName,g=u.ASN1Util.newObject;this.params=null,this.setByParam=function(m){this.params=m},this.tohex=function(){var m=this.params,w=[new p(m)];return m.min!=null&&w.push({tag:{tagi:"80",obj:{int:m.min}}}),m.max!=null&&w.push({tag:{tagi:"81",obj:{int:m.max}}}),g({seq:w}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(b.asn1.x509.GeneralSubtree,b.asn1.ASN1Object),b.asn1.x509.ExtKeyUsage=function(a){b.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,a);var u=b.asn1;this.setPurposeArray=function(p){this.asn1ExtnValue=new u.DERSequence;for(var g=0;g<p.length;g++){var m=new u.DERObjectIdentifier(p[g]);this.asn1ExtnValue.appendASN1Object(m)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.37",a!==void 0&&a.array!==void 0&&this.setPurposeArray(a.array)},Yt(b.asn1.x509.ExtKeyUsage,b.asn1.x509.Extension),b.asn1.x509.AuthorityKeyIdentifier=function(a){b.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,a);var u=b,p=u.asn1,g=p.DERTaggedObject,m=p.x509.GeneralNames;u.crypto.Util.isKey,this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var w=new Array;this.asn1KID&&w.push(new g({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&w.push(new g({explicit:!1,tag:"a1",obj:new m([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&w.push(new g({explicit:!1,tag:"82",obj:this.asn1CertSN}));var O=new p.DERSequence({array:w});return this.asn1ExtnValue=O,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(w){if(w.str!==void 0||w.hex!==void 0)this.asn1KID=new b.asn1.DEROctetString(w);else if(typeof w=="object"&&b.crypto.Util.isKey(w)||typeof w=="string"&&w.indexOf("BEGIN ")!=-1){var O=w;typeof w=="string"&&(O=Te.getKey(w));var R=Te.getKeyID(O);this.asn1KID=new b.asn1.DEROctetString({hex:R})}},this.setCertIssuerByParam=function(w){w.str!==void 0||w.ldapstr!==void 0||w.hex!==void 0||w.certsubject!==void 0||w.certissuer!==void 0?this.asn1CertIssuer=new b.asn1.x509.X500Name(w):typeof w=="string"&&w.indexOf("BEGIN ")!=-1&&w.indexOf("CERTIFICATE")!=-1&&(this.asn1CertIssuer=new b.asn1.x509.X500Name({certissuer:w}))},this.setCertSNByParam=function(w){if(w.str!==void 0||w.bigint!==void 0||w.hex!==void 0)this.asn1CertSN=new b.asn1.DERInteger(w);else if(typeof w=="string"&&w.indexOf("BEGIN ")!=-1&&w.indexOf("CERTIFICATE")){var O=new Ee;O.readCertPEM(w);var R=O.getSerialNumberHex();this.asn1CertSN=new b.asn1.DERInteger({hex:R})}},this.oid="2.5.29.35",a!==void 0&&(a.kid!==void 0&&this.setKIDByParam(a.kid),a.issuer!==void 0&&this.setCertIssuerByParam(a.issuer),a.sn!==void 0&&this.setCertSNByParam(a.sn),a.issuersn!==void 0&&typeof a.issuersn=="string"&&a.issuersn.indexOf("BEGIN ")!=-1&&a.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(a.issuersn),this.setCertIssuerByParam(a.issuersn)))},Yt(b.asn1.x509.AuthorityKeyIdentifier,b.asn1.x509.Extension),b.asn1.x509.SubjectKeyIdentifier=function(a){b.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,a);var u=b.asn1.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(p){if(p.str!==void 0||p.hex!==void 0)this.asn1KID=new u(p);else if(typeof p=="object"&&b.crypto.Util.isKey(p)||typeof p=="string"&&p.indexOf("BEGIN")!=-1){var g=p;typeof p=="string"&&(g=Te.getKey(p));var m=Te.getKeyID(g);this.asn1KID=new b.asn1.DEROctetString({hex:m})}},this.oid="2.5.29.14",a!==void 0&&a.kid!==void 0&&this.setKIDByParam(a.kid)},Yt(b.asn1.x509.SubjectKeyIdentifier,b.asn1.x509.Extension),b.asn1.x509.AuthorityInfoAccess=function(a){b.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,a),this.setAccessDescriptionArray=function(u){for(var p=new Array,g=b.asn1,m=g.DERSequence,w=g.DERObjectIdentifier,O=g.x509.GeneralName,R=0;R<u.length;R++){var P,B=u[R];if(B.ocsp!==void 0)P=new m({array:[new w({oid:"1.3.6.1.5.5.7.48.1"}),new O({uri:B.ocsp})]});else{if(B.caissuer===void 0)throw new Error("unknown AccessMethod parameter: "+JSON.stringify(B));P=new m({array:[new w({oid:"1.3.6.1.5.5.7.48.2"}),new O({uri:B.caissuer})]})}p.push(P)}this.asn1ExtnValue=new m({array:p})},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.1.1",a!==void 0&&a.array!==void 0&&this.setAccessDescriptionArray(a.array)},Yt(b.asn1.x509.AuthorityInfoAccess,b.asn1.x509.Extension),b.asn1.x509.SubjectAltName=function(a){b.asn1.x509.SubjectAltName.superclass.constructor.call(this,a),this.setNameArray=function(u){this.asn1ExtnValue=new b.asn1.x509.GeneralNames(u)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.17",a!==void 0&&a.array!==void 0&&this.setNameArray(a.array)},Yt(b.asn1.x509.SubjectAltName,b.asn1.x509.Extension),b.asn1.x509.IssuerAltName=function(a){b.asn1.x509.IssuerAltName.superclass.constructor.call(this,a),this.setNameArray=function(u){this.asn1ExtnValue=new b.asn1.x509.GeneralNames(u)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.18",a!==void 0&&a.array!==void 0&&this.setNameArray(a.array)},Yt(b.asn1.x509.IssuerAltName,b.asn1.x509.Extension),b.asn1.x509.SubjectDirectoryAttributes=function(a){b.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,a);var u=b.asn1,p=u.DERSequence,g=u.ASN1Util.newObject,m=u.x509.OID.name2oid;this.params=null,this.getExtnValueHex=function(){for(var w=[],O=0;O<this.params.array.length;O++){var R=this.params.array[O];if(R.attr==null||R.array==null){var P={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if(R.attr=="dateOfBirth")P.seq[0].oid=m(R.attr),P.seq[1].set[0]={gentime:R.str};else if(R.attr=="placeOfBirth")P.seq[0].oid=m(R.attr),P.seq[1].set[0]={utf8str:R.str};else if(R.attr=="gender")P.seq[0].oid=m(R.attr),P.seq[1].set[0]={prnstr:R.str};else if(R.attr=="countryOfCitizenship")P.seq[0].oid=m(R.attr),P.seq[1].set[0]={prnstr:R.str};else{if(R.attr!="countryOfResidence")throw new Error("unsupported attribute: "+R.attr);P.seq[0].oid=m(R.attr),P.seq[1].set[0]={prnstr:R.str}}w.push(new g(P))}else{var B={seq:[{oid:R.attr},{set:R.array}]};w.push(g(B))}}var q=new p({array:w});return this.asn1ExtnValue=q,this.asn1ExtnValue.tohex()},this.oid="2.5.29.9",a!==void 0&&(this.params=a)},Yt(b.asn1.x509.SubjectDirectoryAttributes,b.asn1.x509.Extension),b.asn1.x509.PrivateExtension=function(a){b.asn1.x509.PrivateExtension.superclass.constructor.call(this,a);var u=b,p=u.lang.String.isHex,g=u.asn1,m=g.x509.OID.name2oid,w=g.ASN1Util.newObject;this.params=null,this.setByParam=function(O){this.oid=m(O.extname),this.params=O},this.getExtnValueHex=function(){if(this.params.extname==null||this.params.extn==null)throw new Error("extname or extnhex not specified");var O=this.params.extn;if(typeof O=="string"&&p(O))return O;if(typeof O=="object")try{return w(O).tohex()}catch{}throw new Error("unsupported extn value")},a!=null&&this.setByParam(a)},Yt(b.asn1.x509.PrivateExtension,b.asn1.x509.Extension),b.asn1.x509.CRL=function(a){b.asn1.x509.CRL.superclass.constructor.call(this);var u=b.asn1,p=u.DERSequence,g=u.DERBitString,m=u.x509,w=m.AlgorithmIdentifier,O=m.TBSCertList;this.params=void 0,this.setByParam=function(R){this.params=R},this.sign=function(){var R=new O(this.params).tohex(),P=new b.crypto.Signature({alg:this.params.sigalg});P.init(this.params.cakey),P.updateHex(R);var B=P.sign();this.params.sighex=B},this.getPEM=function(){return Je(this.tohex(),"X509 CRL")},this.tohex=function(){var R=this.params;if(R.tbsobj==null&&(R.tbsobj=new O(R)),R.sighex==null&&R.cakey!=null&&this.sign(),R.sighex==null)throw new Error("sighex or cakey parameter not defined");var P=[];return P.push(R.tbsobj),P.push(new w({name:R.sigalg})),P.push(new g({hex:"00"+R.sighex})),new p({array:P}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&(this.params=a)},Yt(b.asn1.x509.CRL,b.asn1.ASN1Object),b.asn1.x509.TBSCertList=function(a){b.asn1.x509.TBSCertList.superclass.constructor.call(this);var u=b.asn1,p=u.DERInteger,g=u.DERSequence,m=u.DERTaggedObject,w=(u.DERObjectIdentifier,u.x509),O=w.AlgorithmIdentifier,R=w.Time,P=w.Extensions,B=w.X500Name;this.params=null,this.setByParam=function(q){this.params=q},this.getRevCertSequence=function(){for(var q=[],L=this.params.revcert,k=0;k<L.length;k++){var H=[new p(L[k].sn),new R(L[k].date)];L[k].ext!=null&&H.push(new P(L[k].ext)),q.push(new g({array:H}))}return new g({array:q})},this.tohex=function(){var q=[],L=this.params;if(L.version!=null){var k=L.version-1,H=new p({int:k});q.push(H)}if(q.push(new O({name:L.sigalg})),q.push(new B(L.issuer)),q.push(new R(L.thisupdate)),L.nextupdate!=null&&q.push(new R(L.nextupdate)),L.revcert!=null&&q.push(this.getRevCertSequence()),L.ext!=null){var W=new P(L.ext);q.push(new m({tag:"a0",explicit:!0,obj:W}))}return new g({array:q}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(b.asn1.x509.TBSCertList,b.asn1.ASN1Object),b.asn1.x509.CRLEntry=function(a){b.asn1.x509.CRLEntry.superclass.constructor.call(this);var u=b.asn1;this.setCertSerial=function(p){this.sn=new u.DERInteger(p)},this.setRevocationDate=function(p){this.time=new u.x509.Time(p)},this.tohex=function(){var p=new u.DERSequence({array:[this.sn,this.time]});return this.TLV=p.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&(a.time!==void 0&&this.setRevocationDate(a.time),a.sn!==void 0&&this.setCertSerial(a.sn))},Yt(b.asn1.x509.CRLEntry,b.asn1.ASN1Object),b.asn1.x509.CRLNumber=function(a){b.asn1.x509.CRLNumber.superclass.constructor.call(this,a),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new b.asn1.DERInteger(this.params.num),this.asn1ExtnValue.tohex()},this.oid="2.5.29.20",a!=null&&(this.params=a)},Yt(b.asn1.x509.CRLNumber,b.asn1.x509.Extension),b.asn1.x509.CRLReason=function(a){b.asn1.x509.CRLReason.superclass.constructor.call(this,a),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new b.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.tohex()},this.oid="2.5.29.21",a!=null&&(this.params=a)},Yt(b.asn1.x509.CRLReason,b.asn1.x509.Extension),b.asn1.x509.OCSPNonce=function(a){b.asn1.x509.OCSPNonce.superclass.constructor.call(this,a),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new b.asn1.DEROctetString(this.params),this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.2",a!=null&&(this.params=a)},Yt(b.asn1.x509.OCSPNonce,b.asn1.x509.Extension),b.asn1.x509.OCSPNoCheck=function(a){b.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,a),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new b.asn1.DERNull,this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.5",a!=null&&(this.params=a)},Yt(b.asn1.x509.OCSPNoCheck,b.asn1.x509.Extension),b.asn1.x509.AdobeTimeStamp=function(a){b.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,a);var u=b.asn1,p=u.DERInteger,g=u.DERBoolean,m=u.DERSequence,w=u.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var O=this.params,R=[new p(1)];return R.push(new w({uri:O.uri})),O.reqauth!=null&&R.push(new g(O.reqauth)),this.asn1ExtnValue=new m({array:R}),this.asn1ExtnValue.tohex()},this.oid="1.2.840.113583.1.1.9.1",a!==void 0&&this.setByParam(a)},Yt(b.asn1.x509.AdobeTimeStamp,b.asn1.x509.Extension),b.asn1.x509.X500Name=function(a){b.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var u=b.asn1,p=u.x509,g=p.RDN;this.setByString=function(m,w){w!==void 0&&(this.sRule=w);var O=m.split("/");O.shift();for(var R=[],P=0;P<O.length;P++)if(O[P].match(/^[^=]+=.+$/))R.push(O[P]);else{var B=R.length-1;R[B]=R[B]+"/"+O[P]}for(P=0;P<R.length;P++)this.asn1Array.push(new g({str:R[P],rule:this.sRule}))},this.setByLdapString=function(m,w){w!==void 0&&(this.sRule=w);var O=p.X500Name.ldapToCompat(m);this.setByString(O,w)},this.setByObject=function(m,w){for(var O in w!==void 0&&(this.sRule=w),m)if(m.hasOwnProperty(O)){var R=new g({str:O+"="+m[O],rule:this.sRule});this.asn1Array?this.asn1Array.push(R):this.asn1Array=[R]}},this.setByParam=function(m){var w;m.rule!==void 0&&(this.sRule=m.rule),m.array!==void 0?this.paramArray=m.array:m.str!==void 0?this.setByString(m.str):m.ldapstr!==void 0?this.setByLdapString(m.ldapstr):m.hex!==void 0?this.hTLV=m.hex:m.certissuer!==void 0?((w=new Ee).readCertPEM(m.certissuer),this.hTLV=w.getIssuerHex()):m.certsubject!==void 0?((w=new Ee).readCertPEM(m.certsubject),this.hTLV=w.getSubjectHex()):typeof m=="object"&&m.certsubject===void 0&&m.certissuer===void 0&&this.setByObject(m)},this.tohex=function(){if(typeof this.hTLV=="string")return this.hTLV;if(this.asn1Array.length==0&&this.paramArray.length>0)for(var m=0;m<this.paramArray.length;m++){var w={array:this.paramArray[m]};this.sRule!="utf8"&&(w.rule=this.sRule);var O=new g(w);this.asn1Array.push(O)}var R=new u.DERSequence({array:this.asn1Array});return this.hTLV=R.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(b.asn1.x509.X500Name,b.asn1.ASN1Object),b.asn1.x509.X500Name.compatToLDAP=function(a){if(a.substr(0,1)!=="/")throw"malformed input";var u=(a=a.substr(1)).split("/");return u.reverse(),(u=u.map(function(p){return p.replace(/,/,"\\,")})).join(",")},b.asn1.x509.X500Name.onelineToLDAP=function(a){return b.asn1.x509.X500Name.compatToLDAP(a)},b.asn1.x509.X500Name.ldapToCompat=function(a){for(var u=a.split(","),p=!1,g=[],m=0;u.length>0;m++){var w=u.shift();if(p===!0){var O=(g.pop()+","+w).replace(/\\,/g,",");g.push(O),p=!1}else g.push(w);w.substr(-1,1)==="\\"&&(p=!0)}return(g=g.map(function(R){return R.replace("/","\\/")})).reverse(),"/"+g.join("/")},b.asn1.x509.X500Name.ldapToOneline=function(a){return b.asn1.x509.X500Name.ldapToCompat(a)},b.asn1.x509.RDN=function(a){b.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var u=b.asn1.x509.AttributeTypeAndValue;this.setByParam=function(p){p.rule!==void 0&&(this.sRule=p.rule),p.str!==void 0&&this.addByMultiValuedString(p.str),p.array!==void 0&&(this.paramArray=p.array)},this.addByString=function(p){this.asn1Array.push(new b.asn1.x509.AttributeTypeAndValue({str:p,rule:this.sRule}))},this.addByMultiValuedString=function(p){for(var g=b.asn1.x509.RDN.parseString(p),m=0;m<g.length;m++)this.addByString(g[m])},this.tohex=function(){if(this.asn1Array.length==0&&this.paramArray.length>0)for(var p=0;p<this.paramArray.length;p++){var g=this.paramArray[p];g.rule!==void 0&&this.sRule!="utf8"&&(g.rule=this.sRule);var m=new u(g);this.asn1Array.push(m)}var w=new b.asn1.DERSet({array:this.asn1Array});return this.TLV=w.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(b.asn1.x509.RDN,b.asn1.ASN1Object),b.asn1.x509.RDN.parseString=function(a){for(var u=a.split(/\+/),p=!1,g=[],m=0;u.length>0;m++){var w=u.shift();if(p===!0){var O=(g.pop()+"+"+w).replace(/\\\+/g,"+");g.push(O),p=!1}else g.push(w);w.substr(-1,1)==="\\"&&(p=!0)}var R=!1,P=[];for(m=0;g.length>0;m++){if(w=g.shift(),R===!0){var B=P.pop();w.match(/"$/)?(O=(B+"+"+w).replace(/^([^=]+)="(.*)"$/,"$1=$2"),P.push(O),R=!1):P.push(B+"+"+w)}else P.push(w);w.match(/^[^=]+="/)&&(R=!0)}return P},b.asn1.x509.AttributeTypeAndValue=function(a){b.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var u=b,p=u.asn1,g=p.DERSequence,m=p.DERUTF8String,w=p.DERPrintableString,O=p.DERTeletexString,R=p.DERIA5String,P=p.DERVisibleString,B=p.DERBMPString,q=u.lang.String.isMail,L=u.lang.String.isPrintable;this.setByParam=function(k){if(k.rule!==void 0&&(this.sRule=k.rule),k.ds!==void 0&&(this.dsType=k.ds),k.value===void 0&&k.str!==void 0){var H=k.str.match(/^([^=]+)=(.+)$/);if(!H)throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr);this.sType=H[1],this.sValue=H[2]}else this.sType=k.type,this.sValue=k.value},this.setByString=function(k,H){H!==void 0&&(this.sRule=H);var W=k.match(/^([^=]+)=(.+)$/);if(!W)throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr);this.setByAttrTypeAndValueStr(W[1],W[2])},this._getDsType=function(){var k=this.sType,H=this.sValue,W=this.sRule;return W==="prn"?k=="CN"&&q(H)?"ia5":L(H)?"prn":"utf8":W==="utf8"?k=="CN"&&q(H)?"ia5":k=="C"?"prn":"utf8":"utf8"},this.setByAttrTypeAndValueStr=function(k,H,W){W!==void 0&&(this.sRule=W),this.sType=k,this.sValue=H},this.getValueObj=function(k,H){if(k=="utf8")return new m({str:H});if(k=="prn")return new w({str:H});if(k=="tel")return new O({str:H});if(k=="ia5")return new R({str:H});if(k=="vis")return new P({str:H});if(k=="bmp")return new B({str:H});throw new Error("unsupported directory string type: type="+k+" value="+H)},this.tohex=function(){this.dsType==null&&(this.dsType=this._getDsType());var k=b.asn1.x509.OID.atype2obj(this.sType),H=this.getValueObj(this.dsType,this.sValue),W=new g({array:[k,H]});return this.TLV=W.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(b.asn1.x509.AttributeTypeAndValue,b.asn1.ASN1Object),b.asn1.x509.SubjectPublicKeyInfo=function(a){b.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var u=b,p=u.asn1,g=p.DERInteger,m=p.DERBitString,w=p.DERObjectIdentifier,O=p.DERSequence,R=p.ASN1Util.newObject,P=p.x509.AlgorithmIdentifier,B=u.crypto;B.ECDSA,B.DSA,this.getASN1Object=function(){if(this.asn1AlgId==null||this.asn1SubjPKey==null)throw"algId and/or subjPubKey not set";return new O({array:[this.asn1AlgId,this.asn1SubjPKey]})},this.tohex=function(){var q=this.getASN1Object();return this.hTLV=q.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.setPubKey=function(q){try{if(q instanceof Bt){var L=R({seq:[{int:{bigint:q.n}},{int:{int:q.e}}]}).tohex();this.asn1AlgId=new P({name:"rsaEncryption"}),this.asn1SubjPKey=new m({hex:"00"+L})}}catch{}try{if(q instanceof b.crypto.ECDSA){var k=new w({name:q.curveName});this.asn1AlgId=new P({name:"ecPublicKey",asn1params:k}),this.asn1SubjPKey=new m({hex:"00"+q.pubKeyHex})}}catch{}try{if(q instanceof b.crypto.DSA){k=new R({seq:[{int:{bigint:q.p}},{int:{bigint:q.q}},{int:{bigint:q.g}}]}),this.asn1AlgId=new P({name:"dsa",asn1params:k});var H=new g({bigint:q.y});this.asn1SubjPKey=new m({hex:"00"+H.tohex()})}}catch{}},a!==void 0&&this.setPubKey(a)},Yt(b.asn1.x509.SubjectPublicKeyInfo,b.asn1.ASN1Object),b.asn1.x509.Time=function(a){b.asn1.x509.Time.superclass.constructor.call(this);var u=b.asn1,p=u.DERUTCTime,g=u.DERGeneralizedTime;this.params=null,this.type=null,this.setTimeParams=function(m){this.timeParams=m},this.setByParam=function(m){this.params=m},this.getType=function(m){return m.match(/^[0-9]{12}Z$/)?"utc":m.match(/^[0-9]{14}Z$/)?"gen":m.match(/^[0-9]{12}\.[0-9]+Z$/)?"utc":m.match(/^[0-9]{14}\.[0-9]+Z$/)?"gen":null},this.tohex=function(){var m=this.params,w=null;if(typeof m=="string"&&(m={str:m}),m==null||!m.str||m.type!=null&&m.type!=null||(m.type=this.getType(m.str)),m!=null&&m.str?(m.type=="utc"&&(w=new p(m.str)),m.type=="gen"&&(w=new g(m.str))):w=this.type=="gen"?new g:new p,w==null)throw new Error("wrong setting for Time");return this.TLV=w.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},b.asn1.x509.Time_bak=function(a){b.asn1.x509.Time_bak.superclass.constructor.call(this);var u=b.asn1,p=u.DERUTCTime,g=u.DERGeneralizedTime;this.setTimeParams=function(m){this.timeParams=m},this.tohex=function(){var m=null;return m=this.timeParams!=null?this.type=="utc"?new p(this.timeParams):new g(this.timeParams):this.type=="utc"?new p:new g,this.TLV=m.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},this.type="utc",a!==void 0&&(a.type!==void 0?this.type=a.type:a.str!==void 0&&(a.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),a.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=a)},Yt(b.asn1.x509.Time,b.asn1.ASN1Object),b.asn1.x509.AlgorithmIdentifier=function(a){b.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var u=b.asn1,p=u.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.tohex=function(){if(this.nameAlg===null&&this.asn1Alg===null)throw new Error("algorithm not specified");if(this.nameAlg!==null){var m=null;for(var w in p)w===this.nameAlg&&(m=p[w]);if(m!==null)return this.hTLV=m,this.hTLV}this.nameAlg!==null&&this.asn1Alg===null&&(this.asn1Alg=u.x509.OID.name2obj(this.nameAlg));var O=[this.asn1Alg];this.asn1Params!==null&&O.push(this.asn1Params);var R=new u.DERSequence({array:O});return this.hTLV=R.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&(a.name!==void 0&&(this.nameAlg=a.name),a.asn1params!==void 0&&(this.asn1Params=a.asn1params),a.paramempty!==void 0&&(this.paramEmpty=a.paramempty)),this.asn1Params===null&&this.paramEmpty===!1&&this.nameAlg!==null){this.nameAlg.name!==void 0&&(this.nameAlg=this.nameAlg.name);var g=this.nameAlg.toLowerCase();g.substr(-7,7)!=="withdsa"&&g.substr(-9,9)!=="withecdsa"&&(this.asn1Params=new u.DERNull)}},Yt(b.asn1.x509.AlgorithmIdentifier,b.asn1.ASN1Object),b.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"},b.asn1.x509.GeneralName=function(a){b.asn1.x509.GeneralName.superclass.constructor.call(this);var u=b.asn1,p=u.x509,g=p.X500Name,m=p.OtherName,w=u.DERIA5String,O=(u.DERPrintableString,u.DEROctetString),R=u.DERTaggedObject,P=u.ASN1Object,B=Error;this.params=null,this.setByParam=function(q){this.params=q},this.tohex=function(){var q,L,k=this.params,H=!1;if(k.other!==void 0)q="a0",L=new m(k.other);else if(k.rfc822!==void 0)q="81",L=new w({str:k.rfc822});else if(k.dns!==void 0)q="82",L=new w({str:k.dns});else if(k.dn!==void 0)q="a4",H=!0,L=typeof k.dn=="string"?new g({str:k.dn}):k.dn instanceof b.asn1.x509.X500Name?k.dn:new g(k.dn);else if(k.ldapdn!==void 0)q="a4",H=!0,L=new g({ldapstr:k.ldapdn});else if(k.certissuer!==void 0||k.certsubj!==void 0){var W,z;q="a4",H=!0;var st=null;if(k.certsubj!==void 0?(W=!1,z=k.certsubj):(W=!0,z=k.certissuer),z.match(/^[0-9A-Fa-f]+$/),z.indexOf("-----BEGIN ")!=-1&&(st=tr(z)),st==null)throw new Error("certsubj/certissuer not cert");var bt,It=new Ee;It.hex=st,bt=W?It.getIssuerHex():It.getSubjectHex(),(L=new P).hTLV=bt}else if(k.uri!==void 0)q="86",L=new w({str:k.uri});else{if(k.ip===void 0)throw new B("improper params");var Mt;q="87";var Lt=k.ip;try{if(Lt.match(/^[0-9a-f]+$/)){var tt=Lt.length;if(tt!=8&&tt!=16&&tt!=32&&tt!=64)throw"err";Mt=Lt}else Mt=ar(Lt)}catch(ut){throw new B("malformed IP address: "+k.ip+":"+ut.message)}L=new O({hex:Mt})}return new R({tag:q,explicit:H,obj:L}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(b.asn1.x509.GeneralName,b.asn1.ASN1Object),b.asn1.x509.GeneralNames=function(a){b.asn1.x509.GeneralNames.superclass.constructor.call(this);var u=b.asn1;this.setByParamArray=function(p){for(var g=0;g<p.length;g++){var m=new u.x509.GeneralName(p[g]);this.asn1Array.push(m)}},this.tohex=function(){return new u.DERSequence({array:this.asn1Array}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.asn1Array=new Array,a!==void 0&&this.setByParamArray(a)},Yt(b.asn1.x509.GeneralNames,b.asn1.ASN1Object),b.asn1.x509.OtherName=function(a){b.asn1.x509.OtherName.superclass.constructor.call(this);var u=b.asn1,p=u.DERObjectIdentifier,g=u.DERSequence,m=u.ASN1Util.newObject;this.params=null,this.setByParam=function(w){this.params=w},this.tohex=function(){var w=this.params;if(w.oid==null||w.value==null)throw new Error("oid or value not specified");var O=new p({oid:w.oid}),R=m({tag:{tag:"a0",explicit:!0,obj:w.value}});return new g({array:[O,R]}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(b.asn1.x509.OtherName,b.asn1.ASN1Object),b.asn1.x509.OID=new function(){var a=b.asn1.DERObjectIdentifier;this.name2oidList={"aes128-CBC":"2.16.840.1.101.3.4.1.2","aes256-CBC":"2.16.840.1.101.3.4.1.42",sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",hmacWithSHA1:"1.2.840.113549.2.7",hmacWithSHA224:"1.2.840.113549.2.8",hmacWithSHA256:"1.2.840.113549.2.9",hmacWithSHA384:"1.2.840.113549.2.10",hmacWithSHA512:"1.2.840.113549.2.11",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",policyMappings:"2.5.29.33",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",inhibitAnyPolicy:"2.5.29.54",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",smtpUTF8Mailbox:"1.3.6.1.5.5.7.8.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",secp521r1:"1.3.132.0.35",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1",smimeMailboxLegacy:"2.23.140.1.5.1.1",smimeMailboxMulti:"2.23.140.1.5.1.2",smimeMailboxStrict:"2.23.140.1.5.1.3",smimeOrganizationLegacy:"2.23.140.1.5.2.1",smimeOrganizationMulti:"2.23.140.1.5.2.2",smimeOrganizationStrict:"2.23.140.1.5.2.3",smimeSponsorLegacy:"2.23.140.1.5.3.1",smimeSponsorMulti:"2.23.140.1.5.3.2",smimeSponsorStrict:"2.23.140.1.5.3.3",smimeIndividualLegacy:"2.23.140.1.5.4.1",smimeIndividualMulti:"2.23.140.1.5.4.2",smimeIndividualStrict:"2.23.140.1.5.4.3"},this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",GN:"2.5.4.42",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.objCache={},this.name2obj=function(u){if(this.objCache[u]!==void 0)return this.objCache[u];if(this.name2oidList[u]===void 0)throw"Name of ObjectIdentifier not defined: "+u;var p=this.name2oidList[u],g=new a({oid:p});return this.objCache[u]=g,g},this.atype2obj=function(u){if(this.objCache[u]!==void 0)return this.objCache[u];var p;if(u.match(/^\d+\.\d+\.[0-9.]+$/))p=u;else if(this.atype2oidList[u]!==void 0)p=this.atype2oidList[u];else{if(this.name2oidList[u]===void 0)throw new Error("AttributeType name undefined: "+u);p=this.name2oidList[u]}var g=new a({oid:p});return this.objCache[u]=g,g},this.registerOIDs=function(u){if(this.checkOIDs(u))for(var p in u)this.name2oidList[p]=u[p]},this.checkOIDs=function(u){try{var p=Object.keys(u);return p.length!=0&&(p.map(function(g,m,w){if(!this[g].match(/^[0-2]\.[0-9.]+$/))throw new Error("value is not OID")},u),!0)}catch{return!1}}},b.asn1.x509.OID.oid2name=function(a){var u=b.asn1.x509.OID.name2oidList;for(var p in u)if(u[p]==a)return p;return""},b.asn1.x509.OID.oid2atype=function(a){var u=b.asn1.x509.OID.atype2oidList;for(var p in u)if(u[p]==a)return p;return a},b.asn1.x509.OID.name2oid=function(a){if(a.match(/^[0-9.]+$/))return a;var u=b.asn1.x509.OID.name2oidList;return u[a]===void 0?"":u[a]},b.asn1.x509.X509Util={},b.asn1.x509.X509Util.newCertPEM=function(a){var u=b.asn1.x509;return u.TBSCertificate,new u.Certificate(a).getPEM()},b!==void 0&&b||(b={}),b.asn1!==void 0&&b.asn1||(b.asn1={}),b.asn1.cms!==void 0&&b.asn1.cms||(b.asn1.cms={}),b.asn1.cms.Attribute=function(a){var u=Error,p=b.asn1,g=p.DERSequence,m=p.DERSet,w=p.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(O){this.params=O},this.getValueArray=function(){throw new u("not yet implemented abstract")},this.tohex=function(){var O=new w({oid:this.typeOid}),R=new m({array:this.getValueArray()});return new g({array:[O,R]}).tohex()},this.getEncodedHex=function(){return this.tohex()}},Yt(b.asn1.cms.Attribute,b.asn1.ASN1Object),b.asn1.cms.ContentType=function(a){var u=b.asn1;u.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){return[new u.DERObjectIdentifier(this.params.type)]},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.ContentType,b.asn1.cms.Attribute),b.asn1.cms.MessageDigest=function(a){var u=b.asn1,p=u.DEROctetString;u.cms.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){return[new p(this.params)]},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.MessageDigest,b.asn1.cms.Attribute),b.asn1.cms.SigningTime=function(a){var u=b.asn1;u.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){return[new u.x509.Time(this.params)]},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.SigningTime,b.asn1.cms.Attribute),b.asn1.cms.SigningCertificate=function(a){var u=Error,p=b,g=p.asn1,m=g.DERSequence,w=g.cms,O=w.ESSCertID;p.crypto,w.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new u("parameter 'array' not specified");for(var R=this.params.array,P=[],B=0;B<R.length;B++){var q=R[B];a.hasis!=0||typeof q!="string"||q.indexOf("-----BEGIN")==-1&&!Gt.isASN1HEX(q)||(q={cert:q}),q.hasis!=0&&a.hasis==0&&(q.hasis=!1),P.push(new O(q))}var L=new m({array:P});return[new m({array:[L]})]},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.SigningCertificate,b.asn1.cms.Attribute),b.asn1.cms.ESSCertID=function(a){b.asn1.cms.ESSCertID.superclass.constructor.call(this);var u=Error,p=b,g=p.asn1,m=g.DEROctetString,w=g.DERSequence,O=g.cms.IssuerSerial;this.params=null,this.getCertHash=function(R,P){if(R.hash!=null)return R.hash;if(typeof R=="string"&&R.indexOf("-----BEGIN")==-1&&!Gt.isASN1HEX(R))return R;var B,q,L;if(typeof R=="string")B=R;else{if(R.cert==null)throw new u("hash nor cert unspecified");B=R.cert}if(q=B.indexOf("-----BEGIN")!=-1?tr(B):B,typeof R=="string"&&(R.indexOf("-----BEGIN")!=-1?q=tr(R):Gt.isASN1HEX(R)&&(q=R)),R.alg!=null)L=R.alg;else{if(P==null)throw new u("hash alg unspecified");L=P}return p.crypto.Util.hashHex(q,L)},this.tohex=function(){var R=this.params,P=this.getCertHash(R,"sha1"),B=[];return B.push(new m({hex:P})),(typeof R=="string"&&R.indexOf("-----BEGIN")!=-1||R.cert!=null&&R.hasis!=0||R.issuer!=null&&R.serial!=null)&&B.push(new O(R)),new w({array:B}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.ESSCertID,b.asn1.ASN1Object),b.asn1.cms.SigningCertificateV2=function(a){var u=Error,p=b,g=p.asn1,m=g.DERSequence,w=(g.x509,g.cms),O=w.ESSCertIDv2;p.crypto,w.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new u("parameter 'array' not specified");for(var R=this.params.array,P=[],B=0;B<R.length;B++){var q=R[B];a.alg==null&&a.hasis!=0||typeof q!="string"||q.indexOf("-----BEGIN")==-1&&!Gt.isASN1HEX(q)||(q={cert:q}),q.alg==null&&a.alg!=null&&(q.alg=a.alg),q.hasis!=0&&a.hasis==0&&(q.hasis=!1),P.push(new O(q))}var L=new m({array:P});return[new m({array:[L]})]},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.SigningCertificateV2,b.asn1.cms.Attribute),b.asn1.cms.ESSCertIDv2=function(a){b.asn1.cms.ESSCertIDv2.superclass.constructor.call(this);var u=b.asn1,p=u.DEROctetString,g=u.DERSequence,m=u.cms.IssuerSerial,w=u.x509.AlgorithmIdentifier;this.params=null,this.tohex=function(){var O=this.params,R=this.getCertHash(O,"sha256"),P=[];return O.alg!=null&&O.alg!="sha256"&&P.push(new w({name:O.alg})),P.push(new p({hex:R})),(typeof O=="string"&&O.indexOf("-----BEGIN")!=-1||O.cert!=null&&O.hasis!=0||O.issuer!=null&&O.serial!=null)&&P.push(new m(O)),new g({array:P}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.ESSCertIDv2,b.asn1.cms.ESSCertID),b.asn1.cms.IssuerSerial=function(a){var u=Error,p=b.asn1,g=p.DERInteger,m=p.DERSequence,w=p.cms,O=p.x509.GeneralNames,R=Ee;w.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(P){this.params=P},this.tohex=function(){var P,B,q=this.params;if(typeof q=="string"&&q.indexOf("-----BEGIN")!=-1||q.cert!=null){var L;L=q.cert!=null?q.cert:q;var k=new R;k.readCertPEM(L),P=k.getIssuer(),B={hex:k.getSerialNumberHex()}}else{if(q.issuer==null||!q.serial)throw new u("cert or issuer and serial parameter not specified");P=q.issuer,B=q.serial}var H=new O([{dn:P}]),W=new g(B);return new m({array:[H,W]}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.IssuerSerial,b.asn1.ASN1Object),b.asn1.cms.SignerIdentifier=function(a){var u=b.asn1,p=(u.DERInteger,u.DERSequence,u.cms),g=p.IssuerAndSerialNumber,m=p.SubjectKeyIdentifier;u.x509.X500Name,p.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.tohex=function(){var w=this.params;if(w.type=="isssn")return new g(w).tohex();if(w.type=="skid")return new m(w).tohex();throw new Error("wrong property for isssn or skid")},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.SignerIdentifier,b.asn1.ASN1Object),b.asn1.cms.IssuerAndSerialNumber=function(a){var u=b.asn1,p=u.DERInteger,g=u.DERSequence,m=u.cms,w=u.x509.X500Name,O=Ee,R=Error;m.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.tohex=function(){var P,B,q=this.params;if(typeof q=="string"&&q.indexOf("-----BEGIN")!=-1||q.cert!=null){var L;L=q.cert!=null?q.cert:q;var k=new O;k.readCertPEM(L),P=k.getIssuer(),B={hex:k.getSerialNumberHex()}}else{if(q.issuer==null||!q.serial)throw new R("cert or issuer and serial parameter not specified");P=q.issuer,B=q.serial}var H=new w(P),W=new p(B);return new g({array:[H,W]}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(P){this.params=P},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.IssuerAndSerialNumber,b.asn1.ASN1Object),b.asn1.cms.SubjectKeyIdentifier=function(a){var u=b.asn1,p=(u.DERInteger,u.DERSequence,u.ASN1Util.newObject),g=u.cms,m=(g.IssuerAndSerialName,g.SubjectKeyIdentifier,u.x509.X500Name,Ee),w=Error;g.SubjectKeyIdentifier.superclass.constructor.call(this),this.tohex=function(){var O,R=this.params;if(R.cert==null&&R.skid==null)throw new w("property cert nor skid undefined");return R.cert!=null?O=new m(R.cert).getExtSubjectKeyIdentifier().kid.hex:R.skid!=null&&(O=R.skid),p({tag:{tage:"a0",obj:{octstr:{hex:O}}}}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.SubjectKeyIdentifier,b.asn1.ASN1Object),b.asn1.cms.AttributeList=function(a){var u=Error,p=b.asn1,g=p.DERSet,m=p.cms;m.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(w){this.params=w},this.tohex=function(){var w=this.params;if(this.hTLV!=null)return this.hTLV;var O=!0;w.sortflag!=null&&(O=w.sortflag);for(var R=w.array,P=[],B=0;B<R.length;B++){var q=R[B],L=q.attr;if(L=="contentType")P.push(new m.ContentType(q));else if(L=="messageDigest")P.push(new m.MessageDigest(q));else if(L=="signingTime")P.push(new m.SigningTime(q));else if(L=="signingCertificate")P.push(new m.SigningCertificate(q));else if(L=="signingCertificateV2")P.push(new m.SigningCertificateV2(q));else if(L=="signaturePolicyIdentifier")P.push(new b.asn1.cades.SignaturePolicyIdentifier(q));else{if(L!="signatureTimeStamp"&&L!="timeStampToken")throw new u("unknown attr: "+L);P.push(new b.asn1.cades.SignatureTimeStamp(q))}}var k=new g({array:P,sortflag:O});return this.hTLV=k.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.AttributeList,b.asn1.ASN1Object),b.asn1.cms.SignerInfo=function(a){var u=Error,p=b,g=p.asn1,m=g.DERInteger,w=g.DEROctetString,O=g.DERSequence,R=g.DERTaggedObject,P=g.cms,B=P.SignerIdentifier,q=P.AttributeList,L=(P.ContentType,P.EncapsulatedContentInfo,P.MessageDigest,P.SignedData,g.x509.AlgorithmIdentifier),k=p.crypto,H=Te;P.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var W=this.params,z=W.sigalg,st=new q(W.sattrs).tohex(),bt=H.getKey(W.signkey),It=new k.Signature({alg:z});It.init(bt),It.updateHex(st);var Mt=It.sign();W.sighex=Mt},this.tohex=function(){var W=this.params,z=[];if(z.push(new m({int:W.version})),z.push(new B(W.id)),z.push(new L({name:W.hashalg})),W.sattrs!=null){var st=new q(W.sattrs);try{z.push(new R({tag:"a0",explicit:!1,obj:st}))}catch(bt){throw new u("si sattr error: "+bt)}}if(W.sigalgfield!=null?z.push(new L({name:W.sigalgfield})):z.push(new L({name:W.sigalg})),W.sighex==null&&W.signkey!=null&&this.sign(),z.push(new w({hex:W.sighex})),W.uattrs!=null){st=new q(W.uattrs);try{z.push(new R({tag:"a1",explicit:!1,obj:st}))}catch(bt){throw new u("si uattr error: "+bt)}}return new O({array:z}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.SignerInfo,b.asn1.ASN1Object),b.asn1.cms.EncapsulatedContentInfo=function(a){var u=b.asn1,p=u.DERTaggedObject,g=u.DERSequence,m=u.DERObjectIdentifier,w=u.DEROctetString;u.cms.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var O=this.params,R=[];if(R.push(new m(O.type)),O.content!=null&&(O.content.hex!=null||O.content.str!=null)&&O.isDetached!=1){var P=new w(O.content),B=new p({tag:"a0",explicit:!0,obj:P});R.push(B)}return new g({array:R}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(O){this.params=O},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.EncapsulatedContentInfo,b.asn1.ASN1Object),b.asn1.cms.ContentInfo=function(a){var u=b.asn1,p=u.DERTaggedObject,g=u.DERSequence,m=u.DERObjectIdentifier;u.x509.OID.name2obj,b.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var w=this.params,O=[];O.push(new m(w.type));var R=new p({tag:"a0",explicit:!0,obj:w.obj});return O.push(R),new g({array:O}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(w){this.params=w},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.ContentInfo,b.asn1.ASN1Object),b.asn1.cms.SignedData=function(a){var u=b.asn1,p=(u.ASN1Object,u.DERInteger),g=u.DERSet,m=u.DERSequence,w=(u.DERTaggedObject,u.cms),O=w.EncapsulatedContentInfo,R=w.SignerInfo,P=w.ContentInfo,B=w.CertificateSet,q=w.RevocationInfoChoices,L=u.x509.AlgorithmIdentifier;b.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var k=this.params;this._setDigestAlgs(k),this._setContentTypeByEContent(k),this._setMessageDigestByEContent(k),this._setSignerInfoVersion(k),this._setSignedDataVersion(k)},this._setDigestAlgs=function(k){for(var H={},W=k.sinfos,z=0;z<W.length;z++)H[W[z].hashalg]=1;k.hashalgs=Object.keys(H).sort()},this._setContentTypeByEContent=function(k){for(var H=k.econtent.type,W=k.sinfos,z=0;z<W.length;z++){var st=W[z];this._getAttrParamByName(st,"contentType").type=H}},this._setMessageDigestByEContent=function(k){var H=k.econtent,W=(k.econtent.type,H.content.hex);W==null&&H.type=="data"&&H.content.str!=null&&(W=Sr(H.content.str));for(var z=k.sinfos,st=0;st<z.length;st++){var bt=z[st],It=bt.hashalg,Mt=this._getAttrParamByName(bt,"messageDigest"),Lt=b.crypto.Util.hashHex(W,It);Mt.hex=Lt}},this._getAttrParamByName=function(k,H){for(var W=k.sattrs.array,z=0;z<W.length;z++)if(W[z].attr==H)return W[z]},this._setSignerInfoVersion=function(k){for(var H=k.sinfos,W=0;W<H.length;W++){var z=H[W],st=1;z.id.type=="skid"&&(st=3),z.version=st}},this._setSignedDataVersion=function(k){var H=this._getSignedDataVersion(k);k.version=H},this._getSignedDataVersion=function(k){if(k.revinfos!=null){for(var H=k.revinfos,W=0;W<H.length;W++)if(H[W].ocsp!=null)return 5}var z=k.sinfos;for(W=0;W<z.length;W++)if(k.sinfos[W].version==3)return 3;return k.econtent.type!="data"?3:1},this.tohex=function(){var k=this.params;this.getEncodedHexPrepare!=null&&this.getEncodedHexPrepare(),k.fixed!=1&&this.checkAndFixParam();var H=[];H.push(new p({int:k.version}));for(var W=[],z=0;z<k.hashalgs.length;z++){var st=k.hashalgs[z];W.push(new L({name:st}))}H.push(new g({array:W})),H.push(new O(k.econtent)),k.certs!=null&&H.push(new B(k.certs)),k.revinfos!=null&&H.push(new q(k.revinfos));var bt=[];for(z=0;z<k.sinfos.length;z++){var It=k.sinfos[z];bt.push(new R(It))}return H.push(new g({array:bt})),new m({array:H}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.getContentInfo=function(){return new P({type:"signed-data",obj:this})},this.getContentInfoEncodedHex=function(){return this.getContentInfo().tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.SignedData,b.asn1.ASN1Object),b.asn1.cms.CertificateSet=function(a){b.asn1.cms.CertificateSet.superclass.constructor.call(this);var u=Error,p=b.asn1,g=p.DERTaggedObject,m=p.DERSet,w=p.ASN1Object;this.params=null,this.tohex=function(){var O,R=this.params,P=[];if(R instanceof Array)O=R;else{if(R.array==null)throw new u("cert array not specified");O=R.array}for(var B=0;B<O.length;B++){var q=tr(O[B]),L=new w;L.hTLV=q,P.push(L)}var k={array:P};R.sortflag==0&&(k.sortflag=!1);var H=new m(k);return new g({tag:"a0",explicit:!1,obj:H}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.CertificateSet,b.asn1.ASN1Object),b.asn1.cms.RevocationInfoChoices=function(a){b.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.tohex=function(){var u=this.params;if(!u instanceof Array)throw new Error("params is not array");for(var p=[],g=0;g<u.length;g++)p.push(new b.asn1.cms.RevocationInfoChoice(u[g]));return b.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:p}}}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.RevocationInfoChoices,b.asn1.ASN1Object),b.asn1.cms.RevocationInfoChoice=function(a){b.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.tohex=function(){var u=this.params;if(u.crl!=null&&typeof u.crl=="string"){var p=u.crl;return u.crl.indexOf("-----BEGIN")!=-1&&(p=tr(u.crl)),p}if(u.ocsp!=null)return b.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new b.asn1.cms.OtherRevocationFormat(u)}}).tohex();throw new Error("property crl or ocsp undefined")},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.RevocationInfoChoice,b.asn1.ASN1Object),b.asn1.cms.OtherRevocationFormat=function(a){b.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var u=Error,p=b,g=p.asn1.ASN1Util.newObject,m=p.lang.String.isHex;this.params=null,this.tohex=function(){var w=this.params;if(w.ocsp==null)throw new u("property ocsp not specified");if(!m(w.ocsp)||!Gt.isASN1HEX(w.ocsp))throw new u("ocsp value not ASN.1 hex string");return g({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:w.ocsp}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.cms.OtherRevocationFormat,b.asn1.ASN1Object),b.asn1.cms.CMSUtil=new function(){},b.asn1.cms.CMSUtil.newSignedData=function(a){return new b.asn1.cms.SignedData(a)},b.asn1.cms.CMSUtil.verifySignedData=function(a){var u=b,p=u.asn1,g=p.cms,m=(g.SignerInfo,g.SignedData,g.SigningTime,g.SigningCertificate,g.SigningCertificateV2,p.cades.SignaturePolicyIdentifier,u.lang.String.isHex),w=Gt,O=w.getVbyList,R=w.getTLVbyList,P=w.getIdxbyList,B=w.getChildIdx,q=w.getTLV,L=w.oidname,k=u.crypto.Util.hashHex;a.cms===void 0&&m(a.cms);var H=a.cms,W=function(It,Mt){var Lt=Mt.idx;Mt.signerid_issuer1=R(It,Lt,[1,0],"30"),Mt.signerid_serial1=O(It,Lt,[1,1],"02"),Mt.hashalg=L(O(It,Lt,[2,0],"06"));var tt=P(It,Lt,[3],"a0");Mt.idxSignedAttrs=tt,z(It,Mt,tt);var ut=B(It,Lt).length;if(ut<6)throw"malformed SignerInfo";Mt.sigalg=L(O(It,Lt,[ut-2,0],"06")),Mt.sigval=O(It,Lt,[ut-1],"04")},z=function(It,Mt,Lt){var tt=B(It,Lt);Mt.signedAttrIdxList=tt;for(var ut=0;ut<tt.length;ut++){var pt,it=tt[ut],wt=O(It,it,[0],"06");wt==="2a864886f70d010905"?(pt=Le(O(It,it,[1,0])),Mt.saSigningTime=pt):wt==="2a864886f70d010904"&&(pt=O(It,it,[1,0],"04"),Mt.saMessageDigest=pt)}},st=function(It,Mt,Lt,tt){Lt.verifyDetail={};var ut=Lt.verifyDetail,pt=Mt.parse.econtent,it=Lt.hashalg,wt=Lt.saMessageDigest;ut.validMessageDigest=!1,k(pt,it)===wt&&(ut.validMessageDigest=!0),function(Q,ft,vt,Rt){var Ft,Nt=ft.parse.certsIdx;if(ft.certs===void 0){Ft=[],ft.certkeys=[];for(var re=B(Q,Nt),te=0;te<re.length;te++){var St=q(Q,re[te]),kt=new Ee;kt.readCertHex(St),Ft[te]=kt,ft.certkeys[te]=kt.getPublicKey()}ft.certs=Ft}else Ft=ft.certs;for(ft.cccc=Ft.length,ft.cccci=re.length,te=0;te<Ft.length;te++){var Tt=kt.getIssuerHex(),Qt=kt.getSerialNumberHex();vt.signerid_issuer1===Tt&&vt.signerid_serial1===Qt&&(vt.certkey_idx=te)}}(It,Mt,Lt),ut.validSignatureValue=!1;var $t=Lt.sigalg,Wt="31"+q(It,Lt.idxSignedAttrs).substr(2);Lt.signedattrshex=Wt;var Ht=Mt.certs[Lt.certkey_idx].getPublicKey(),Se=new b.crypto.Signature({alg:$t});Se.init(Ht),Se.updateHex(Wt);var zt=Se.verify(Lt.sigval);ut.validSignatureValue_isValid=zt,zt===!0&&(ut.validSignatureValue=!0),Lt.isValid=!1,ut.validMessageDigest&&ut.validSignatureValue&&(Lt.isValid=!0)},bt={isValid:!1,parse:{}};return function(It,Mt){if(O(It,0,[0],"06")!=="2a864886f70d010702")return Mt;Mt.cmsType="signedData",Mt.econtent=O(It,0,[1,0,2,1,0]),function(Lt,tt){for(var ut,pt=3;pt<6;pt++)if((ut=P(Lt,0,[1,0,pt]))!==void 0){var it=Lt.substr(ut,2);it==="a0"&&(tt.certsIdx=ut),it==="a1"&&(tt.revinfosIdx=ut),it==="31"&&(tt.signerinfosIdx=ut)}}(It,Mt),Mt.signerInfos=[],function(Lt,tt){var ut=tt.signerinfosIdx;if(ut!==void 0){var pt=B(Lt,ut);tt.signerInfoIdxList=pt;for(var it=0;it<pt.length;it++){var wt={idx:pt[it]};W(Lt,wt),tt.signerInfos.push(wt)}}}(It,Mt)}(H,bt.parse),function(It,Mt){for(var Lt=Mt.parse.signerInfos,tt=Lt.length,ut=!0,pt=0;pt<tt;pt++){var it=Lt[pt];st(It,Mt,it),it.isValid||(ut=!1)}Mt.isValid=ut}(H,bt),bt},b.asn1.cms.CMSParser=function(){var a=Error,u=Ee,p=new u,g=Gt,m=g.getV,w=g.getTLV,O=(g.getIdxbyList,g.getTLVbyList),R=g.getTLVbyListEx,P=g.getVbyList,B=g.getVbyListEx,q=g.getChildIdx;this.getCMSSignedData=function(L){var k=O(L,0,[1,0]);return this.getSignedData(k)},this.getSignedData=function(L){var k=q(L,0),H={},W=m(L,k[0]),z=parseInt(W,16);H.version=z;var st=w(L,k[1]);H.hashalgs=this.getHashAlgArray(st);var bt=w(L,k[2]);H.econtent=this.getEContent(bt);var It=R(L,0,["[0]"]);It!=null&&(H.certs=this.getCertificateSet(It)),R(L,0,["[1]"]);var Mt=R(L,0,[3]);return H.sinfos=this.getSignerInfos(Mt),H},this.getHashAlgArray=function(L){for(var k=q(L,0),H=new u,W=[],z=0;z<k.length;z++){var st=w(L,k[z]),bt=H.getAlgorithmIdentifierName(st);W.push(bt)}return W},this.getEContent=function(L){var k={},H=P(L,0,[0]),W=P(L,0,[1,0]);return k.type=b.asn1.x509.OID.oid2name(Gt.hextooidstr(H)),k.content={hex:W},k},this.getSignerInfos=function(L){for(var k=[],H=q(L,0),W=0;W<H.length;W++){var z=w(L,H[W]),st=this.getSignerInfo(z);k.push(st)}return k},this.getSignerInfo=function(L){var k={},H=q(L,0),W=g.getInt(L,H[0],-1);W!=-1&&(k.version=W);var z=w(L,H[1]),st=this.getIssuerAndSerialNumber(z);k.id=st;var bt=w(L,H[2]),It=p.getAlgorithmIdentifierName(bt);k.hashalg=It;var Mt=R(L,0,["[0]"]);if(Mt!=null){var Lt=this.getAttributeList(Mt);k.sattrs=Lt}var tt=R(L,0,[3]),ut=p.getAlgorithmIdentifierName(tt);k.sigalg=ut;var pt=B(L,0,[4]);k.sighex=pt;var it=R(L,0,["[1]"]);if(it!=null){var wt=this.getAttributeList(it);k.uattrs=wt}return k},this.getSignerIdentifier=function(L){if(L.substr(0,2)=="30")return this.getIssuerAndSerialNumber(L);throw new Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(L){var k={type:"isssn"},H=q(L,0),W=w(L,H[0]);k.issuer=p.getX500Name(W);var z=m(L,H[1]);return k.serial={hex:z},k},this.getAttributeList=function(L){for(var k=[],H=q(L,0),W=0;W<H.length;W++){var z=w(L,H[W]),st=this.getAttribute(z);k.push(st)}return{array:k}},this.getAttribute=function(L){var k={},H=q(L,0),W=g.getOID(L,H[0]),z=b.asn1.x509.OID.oid2name(W);k.attr=z;var st=w(L,H[1]),bt=q(st,0);if(bt.length==1)k.valhex=w(st,bt[0]);else{for(var It=[],Mt=0;Mt<bt.length;Mt++)It.push(w(st,bt[Mt]));k.valhex=It}return z=="contentType"?this.setContentType(k):z=="messageDigest"?this.setMessageDigest(k):z=="signingTime"?this.setSigningTime(k):z=="signingCertificate"?this.setSigningCertificate(k):z=="signingCertificateV2"?this.setSigningCertificateV2(k):z=="signaturePolicyIdentifier"&&this.setSignaturePolicyIdentifier(k),k},this.setContentType=function(L){var k=g.getOIDName(L.valhex,0,null);k!=null&&(L.type=k,delete L.valhex)},this.setSigningTime=function(L){var k=Le(m(L.valhex,0));L.str=k,delete L.valhex},this.setMessageDigest=function(L){var k=m(L.valhex,0);L.hex=k,delete L.valhex},this.setSigningCertificate=function(L){var k=q(L.valhex,0);if(k.length>0){for(var H=w(L.valhex,k[0]),W=q(H,0),z=[],st=0;st<W.length;st++){var bt=w(H,W[st]),It=this.getESSCertID(bt);z.push(It)}L.array=z}if(k.length>1){var Mt=w(L.valhex,k[1]);L.polhex=Mt}delete L.valhex},this.setSignaturePolicyIdentifier=function(L){var k=q(L.valhex,0);if(k.length>0){var H=g.getOID(L.valhex,k[0]);L.oid=H}if(k.length>1){var W=new u,z=q(L.valhex,k[1]),st=w(L.valhex,z[0]),bt=W.getAlgorithmIdentifierName(st);L.alg=bt;var It=m(L.valhex,z[1]);L.hash=It}delete L.valhex},this.setSigningCertificateV2=function(L){var k=q(L.valhex,0);if(k.length>0){for(var H=w(L.valhex,k[0]),W=q(H,0),z=[],st=0;st<W.length;st++){var bt=w(H,W[st]),It=this.getESSCertIDv2(bt);z.push(It)}L.array=z}if(k.length>1){var Mt=w(L.valhex,k[1]);L.polhex=Mt}delete L.valhex},this.getESSCertID=function(L){var k={},H=q(L,0);if(H.length>0){var W=m(L,H[0]);k.hash=W}if(H.length>1){var z=w(L,H[1]),st=this.getIssuerSerial(z);st.serial!=null&&(k.serial=st.serial),st.issuer!=null&&(k.issuer=st.issuer)}return k},this.getESSCertIDv2=function(L){var k={},H=q(L,0);if(H.length<1||3<H.length)throw new a("wrong number of elements");var W=0;if(L.substr(H[0],2)=="30"){var z=w(L,H[0]);k.alg=p.getAlgorithmIdentifierName(z),W++}else k.alg="sha256";var st=m(L,H[W]);if(k.hash=st,H.length>W+1){var bt=w(L,H[W+1]),It=this.getIssuerSerial(bt);k.issuer=It.issuer,k.serial=It.serial}return k},this.getIssuerSerial=function(L){var k={},H=q(L,0),W=w(L,H[0]),z=p.getGeneralNames(W)[0].dn;k.issuer=z;var st=m(L,H[1]);return k.serial={hex:st},k},this.getCertificateSet=function(L){for(var k=q(L,0),H=[],W=0;W<k.length;W++){var z=w(L,k[W]);if(z.substr(0,2)=="30"){var st=Je(z,"CERTIFICATE");H.push(st)}}return{array:H,sortflag:!1}}},b!==void 0&&b||(b={}),b.asn1!==void 0&&b.asn1||(b.asn1={}),b.asn1.tsp!==void 0&&b.asn1.tsp||(b.asn1.tsp={}),b.asn1.tsp.TimeStampToken=function(a){var u=b.asn1.tsp;u.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var p=new u.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=p.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.tsp.TimeStampToken,b.asn1.cms.SignedData),b.asn1.tsp.TSTInfo=function(a){var u=b.asn1,p=u.DERSequence,g=u.DERInteger,m=u.DERBoolean,w=u.DERGeneralizedTime,O=u.DERObjectIdentifier,R=u.DERTaggedObject,P=u.tsp,B=P.MessageImprint,q=P.Accuracy,L=(u.x509.X500Name,u.x509.GeneralName);if(P.TSTInfo.superclass.constructor.call(this),this.dVersion=new g({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.tohex=function(){var k=[this.dVersion];if(this.dPolicy==null)throw new Error("policy shall be specified.");if(k.push(this.dPolicy),this.dMessageImprint==null)throw new Error("messageImprint shall be specified.");if(k.push(this.dMessageImprint),this.dSerial==null)throw new Error("serialNumber shall be specified.");if(k.push(this.dSerial),this.dGenTime==null)throw new Error("genTime shall be specified.");k.push(this.dGenTime),this.dAccuracy!=null&&k.push(this.dAccuracy),this.dOrdering!=null&&k.push(this.dOrdering),this.dNonce!=null&&k.push(this.dNonce),this.dTsa!=null&&k.push(this.dTsa);var H=new p({array:k});return this.hTLV=H.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0){if(typeof a.policy=="string"){if(!a.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new O({oid:a.policy})}a.messageImprint!==void 0&&(this.dMessageImprint=new B(a.messageImprint)),a.serial!==void 0&&(this.dSerial=new g(a.serial)),a.genTime!==void 0&&(this.dGenTime=new w(a.genTime)),a.accuracy!==void 0&&(this.dAccuracy=new q(a.accuracy)),a.ordering!==void 0&&a.ordering==1&&(this.dOrdering=new m),a.nonce!==void 0&&(this.dNonce=new g(a.nonce)),a.tsa!==void 0&&(this.dTsa=new R({tag:"a0",explicit:!0,obj:new L({dn:a.tsa})}))}},Yt(b.asn1.tsp.TSTInfo,b.asn1.ASN1Object),b.asn1.tsp.Accuracy=function(a){var u=b.asn1,p=u.ASN1Util.newObject;u.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.tohex=function(){var g=this.params,m=[];return g.seconds!=null&&typeof g.seconds=="number"&&m.push({int:g.seconds}),g.millis!=null&&typeof g.millis=="number"&&m.push({tag:{tagi:"80",obj:{int:g.millis}}}),g.micros!=null&&typeof g.micros=="number"&&m.push({tag:{tagi:"81",obj:{int:g.micros}}}),p({seq:m}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.tsp.Accuracy,b.asn1.ASN1Object),b.asn1.tsp.MessageImprint=function(a){var u=b.asn1,p=u.DERSequence,g=u.DEROctetString,m=u.x509.AlgorithmIdentifier;u.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.tohex=function(){var w=this.params,O=new m({name:w.alg}),R=new g({hex:w.hash});return new p({array:[O,R]}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(b.asn1.tsp.MessageImprint,b.asn1.ASN1Object),b.asn1.tsp.TimeStampReq=function(a){var u=b.asn1,p=u.DERSequence,g=u.DERInteger,m=u.DERBoolean,w=(u.ASN1Object,u.DERObjectIdentifier),O=u.tsp,R=O.MessageImprint;O.TimeStampReq.superclass.constructor.call(this),this.params=null,this.tohex=function(){var P=this.params,B=[];return B.push(new g({int:1})),P.messageImprint instanceof b.asn1.ASN1Object?B.push(P.messageImprint):B.push(new R(P.messageImprint)),P.policy!=null&&B.push(new w(P.policy)),P.nonce!=null&&B.push(new g(P.nonce)),P.certreq==1&&B.push(new m),new p({array:B}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.tsp.TimeStampReq,b.asn1.ASN1Object),b.asn1.tsp.TimeStampResp=function(a){var u=b.asn1,p=u.DERSequence,g=(u.ASN1Object,u.tsp),m=g.PKIStatusInfo;g.TimeStampResp.superclass.constructor.call(this),this.params=null,this.tohex=function(){var w=this.params,O=[];if(w.econtent!=null||w.tst!=null)if(w.statusinfo!=null?O.push(new m(w.statusinfo)):O.push(new m("granted")),w.econtent!=null)O.push(new g.TimeStampToken(w).getContentInfo());else{if(!(w.tst instanceof u.ASN1Object))throw new Error("improper member tst value");O.push(w.tst)}else{if(w.statusinfo==null)throw new Error("parameter for token nor statusinfo not specified");O.push(new m(w.statusinfo))}return new p({array:O}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.tsp.TimeStampResp,b.asn1.ASN1Object),b.asn1.tsp.PKIStatusInfo=function(a){var u=Error,p=b.asn1,g=p.DERSequence,m=p.tsp,w=m.PKIStatus,O=m.PKIFreeText,R=m.PKIFailureInfo;m.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var P=this.params,B=[];if(typeof P=="string")B.push(new w(P));else{if(P.status==null)throw new u("property 'status' unspecified");B.push(new w(P.status)),P.statusstr!=null&&B.push(new O(P.statusstr)),P.failinfo!=null&&B.push(new R(P.failinfo))}return new g({array:B}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.tsp.PKIStatusInfo,b.asn1.ASN1Object),b.asn1.tsp.PKIStatus=function(a){var u=Error,p=b.asn1,g=p.DERInteger;p.tsp.PKIStatus.superclass.constructor.call(this);var m={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.tohex=function(){var w,O=this.params;if(typeof O=="string")try{w=m[O]}catch{throw new u("undefined name: "+O)}else{if(typeof O!="number")throw new u("unsupported params");w=O}return new g({int:w}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.tsp.PKIStatus,b.asn1.ASN1Object),b.asn1.tsp.PKIFreeText=function(a){var u=Error,p=b.asn1,g=p.DERSequence,m=p.DERUTF8String;p.tsp.PKIFreeText.superclass.constructor.call(this),this.params=null,this.tohex=function(){var w=this.params;if(!w instanceof Array)throw new u("wrong params: not array");for(var O=[],R=0;R<w.length;R++)O.push(new m({str:w[R]}));return new g({array:O}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.tsp.PKIFreeText,b.asn1.ASN1Object),b.asn1.tsp.PKIFailureInfo=function(a){var u=Error,p=b.asn1,g=p.DERBitString,m=p.tsp.PKIFailureInfo,w={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};m.superclass.constructor.call(this),this.params=null,this.getBinValue=function(){var O=this.params,R=0;if(typeof O=="number"&&0<=O&&O<=25){for(var P=(R|=1<<O).toString(2),B="",q=P.length-1;q>=0;q--)B+=P[q];return B}if(typeof O=="string"&&w[O]!=null)return fr([O],w);if(typeof O=="object"&&O.length!=null)return fr(O,w);throw new u("wrong params")},this.tohex=function(){this.params;var O=this.getBinValue();return new g({bin:O}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.tsp.PKIFailureInfo,b.asn1.ASN1Object),b.asn1.tsp.AbstractTSAAdapter=function(a){this.getTSTHex=function(u,p){throw"not implemented yet"}},b.asn1.tsp.SimpleTSAAdapter=function(a){var u=b,p=u.asn1.tsp,g=u.crypto.Util.hashHex;p.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(m,w){var O=g(m,w);this.params.econtent.content.messageImprint={alg:w,hash:O},this.params.econtent.content.serial={int:this.serial++};var R=Math.floor(1e9*Math.random());return this.params.econtent.content.nonce={int:R},new p.TimeStampToken(this.params).getContentInfoEncodedHex()},a!==void 0&&(this.params=a)},Yt(b.asn1.tsp.SimpleTSAAdapter,b.asn1.tsp.AbstractTSAAdapter),b.asn1.tsp.FixedTSAAdapter=function(a){var u=b,p=u.asn1.tsp,g=u.crypto.Util.hashHex;p.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(m,w){var O=g(m,w);return this.params.econtent.content.messageImprint={alg:w,hash:O},new p.TimeStampToken(this.params).getContentInfoEncodedHex()},a!==void 0&&(this.params=a)},Yt(b.asn1.tsp.FixedTSAAdapter,b.asn1.tsp.AbstractTSAAdapter),b.asn1.tsp.TSPUtil=new function(){},b.asn1.tsp.TSPUtil.newTimeStampToken=function(a){return new b.asn1.tsp.TimeStampToken(a)},b.asn1.tsp.TSPUtil.parseTimeStampReq=function(a){return new b.asn1.tsp.TSPParser().getTimeStampReq(a)},b.asn1.tsp.TSPUtil.parseMessageImprint=function(a){return new b.asn1.tsp.TSPParser().getMessageImprint(a)},b.asn1.tsp.TSPParser=function(){var a=new Ee,u=Gt,p=u.getV,g=u.getTLV,m=u.getIdxbyList,w=(u.getTLVbyListEx,u.getChildIdx),O=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],R={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(P){var B=w(P,0);if(B.length==1)return this.getPKIStatusInfo(g(P,B[0]));if(B.length>1){var q=this.getPKIStatusInfo(g(P,B[0])),L=g(P,B[1]),k=this.getToken(L);return k.statusinfo=q,k}},this.getToken=function(P){var B=new b.asn1.cms.CMSParser().getCMSSignedData(P);return this.setTSTInfo(B),B},this.setTSTInfo=function(P){var B=P.econtent;if(B.type=="tstinfo"){var q=B.content.hex,L=this.getTSTInfo(q);B.content=L}},this.getTSTInfo=function(P){var B={},q=w(P,0),L=p(P,q[1]);B.policy=Tr(L);var k=g(P,q[2]);B.messageImprint=this.getMessageImprint(k);var H=p(P,q[3]);B.serial={hex:H};var W=p(P,q[4]);B.genTime={str:Le(W)};var z=0;if(q.length>5&&P.substr(q[5],2)=="30"){var st=g(P,q[5]);B.accuracy=this.getAccuracy(st),z++}if(q.length>5+z&&P.substr(q[5+z],2)=="01"&&(p(P,q[5+z])=="ff"&&(B.ordering=!0),z++),q.length>5+z&&P.substr(q[5+z],2)=="02"){var bt=p(P,q[5+z]);B.nonce={hex:bt},z++}if(q.length>5+z&&P.substr(q[5+z],2)=="a0"){var It=g(P,q[5+z]);It="30"+It.substr(2),pGeneralNames=a.getGeneralNames(It);var Mt=pGeneralNames[0].dn;B.tsa=Mt,z++}if(q.length>5+z&&P.substr(q[5+z],2)=="a1"){var Lt=g(P,q[5+z]);Lt="30"+Lt.substr(2);var tt=a.getExtParamArray(Lt);B.ext=tt,z++}return B},this.getAccuracy=function(P){for(var B={},q=w(P,0),L=0;L<q.length;L++){var k=P.substr(q[L],2),H=p(P,q[L]),W=parseInt(H,16);k=="02"?B.seconds=W:k=="80"?B.millis=W:k=="81"&&(B.micros=W)}return B},this.getMessageImprint=function(P){if(P.substr(0,2)!="30")throw new Error("head of messageImprint hex shall be x30");var B={},q=(w(P,0),m(P,0,[0,0])),L=p(P,q),k=u.hextooidstr(L),H=b.asn1.x509.OID.oid2name(k);if(H=="")throw new Error("hashAlg name undefined: "+k);var W=H,z=m(P,0,[1]);return B.alg=W,B.hash=p(P,z),B},this.getPKIStatusInfo=function(P){var B={},q=w(P,0),L=0;try{var k=p(P,q[0]),H=parseInt(k,16);B.status=O[H]}catch{}if(q.length>1&&P.substr(q[1],2)=="30"){var W=g(P,q[1]);B.statusstr=this.getPKIFreeText(W),L++}if(q.length>L&&P.substr(q[1+L],2)=="03"){var z=g(P,q[1+L]);B.failinfo=this.getPKIFailureInfo(z)}return B},this.getPKIFreeText=function(P){for(var B=[],q=w(P,0),L=0;L<q.length;L++)B.push(u.getString(P,q[L]));return B},this.getPKIFailureInfo=function(P){var B=u.getInt(P,0);return R[B]!=null?R[B]:B},this.getTimeStampReq=function(P){var B={certreq:!1},q=w(P,0);if(q.length<2)throw new Error("TimeStampReq must have at least 2 items");var L=g(P,q[1]);B.messageImprint=b.asn1.tsp.TSPUtil.parseMessageImprint(L);for(var k=2;k<q.length;k++){var H=q[k],W=P.substr(H,2);if(W=="06"){var z=p(P,H);B.policy=u.hextooidstr(z)}W=="02"&&(B.nonce=p(P,H)),W=="01"&&(B.certreq=!0)}return B}},b!==void 0&&b||(b={}),b.asn1!==void 0&&b.asn1||(b.asn1={}),b.asn1.cades!==void 0&&b.asn1.cades||(b.asn1.cades={}),b.asn1.cades.SignaturePolicyIdentifier=function(a){var u=b.asn1.cades,p=u.SignaturePolicyId;u.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new p(this.params)]},this.setByParam=function(g){this.params=g},a!=null&&this.setByParam(a)},Yt(b.asn1.cades.SignaturePolicyIdentifier,b.asn1.cms.Attribute),b.asn1.cades.SignaturePolicyId=function(a){var u=b.asn1,p=u.DERSequence,g=u.DERObjectIdentifier,m=(u.x509.AlgorithmIdentifier,u.cades),w=m.SignaturePolicyId,O=m.OtherHashAlgAndValue;w.superclass.constructor.call(this),this.params=null,this.tohex=function(){var R=this.params,P=[];return P.push(new g(R.oid)),P.push(new O(R)),new p({array:P}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(R){this.params=R},a!=null&&this.setByParam(a)},Yt(b.asn1.cades.SignaturePolicyId,b.asn1.ASN1Object),b.asn1.cades.OtherHashAlgAndValue=function(a){var u=Error,p=b.asn1,g=p.DERSequence,m=p.DEROctetString,w=p.x509.AlgorithmIdentifier;p.cades.OtherHashAlgAndValue.superclass.constructor.call(this),this.params=null,this.tohex=function(){var O=this.params;if(O.alg==null)throw new u("property 'alg' not specified");if(O.hash==null&&O.cert==null)throw new u("property 'hash' nor 'cert' not specified");var R=null;if(O.hash!=null)R=O.hash;else if(O.cert!=null){if(typeof O.cert!="string")throw new u("cert not string");var P=O.cert;O.cert.indexOf("-----BEGIN")!=-1&&(P=tr(O.cert)),R=b.crypto.Util.hashHex(P,O.alg)}var B=[];return B.push(new w({name:O.alg})),B.push(new m({hex:R})),new g({array:B}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.cades.OtherHashAlgAndValue,b.asn1.ASN1Object),b.asn1.cades.OtherHashValue=function(a){b.asn1.cades.OtherHashValue.superclass.constructor.call(this);var u=Error,p=b,g=(p.lang.String.isHex,p.asn1.DEROctetString);p.crypto.Util.hashHex,this.params=null,this.tohex=function(){var m=this.params;if(m.hash==null&&m.cert==null)throw new u("hash or cert not specified");var w=null;if(m.hash!=null)w=m.hash;else if(m.cert!=null){if(typeof m.cert!="string")throw new u("cert not string");var O=m.cert;m.cert.indexOf("-----BEGIN")!=-1&&(O=tr(m.cert)),w=b.crypto.Util.hashHex(O,"sha1")}return new g({hex:w}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.cades.OtherHashValue,b.asn1.ASN1Object),b.asn1.cades.SignatureTimeStamp=function(a){var u=Error,p=b,g=p.lang.String.isHex,m=p.asn1,w=m.ASN1Object;m.x509,m.cades.SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var O=this.params;if(O.tst!=null){if(g(O.tst))return(R=new w).hTLV=O.tst,[R];if(O.tst instanceof w)return[O.tst];throw new u("params.tst has wrong value")}if(O.res!=null){var R,P=O.res;if(P instanceof w&&(P=P.tohex()),typeof P!="string"||!g(P))throw new u("params.res has wrong value");return Gt.getTLVbyList(P,0,[1]),(R=new w).hTLV=O.tst,[R]}},a!=null&&this.setByParam(a)},Yt(b.asn1.cades.SignatureTimeStamp,b.asn1.cms.Attribute),b.asn1.cades.CompleteCertificateRefs=function(a){var u=Error,p=b,g=p.asn1,m=g.DERSequence,w=g.cades,O=w.OtherCertID,R=p.lang.String.isHex;w.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var P=this.params,B=[],q=0;q<P.array.length;q++){var L=P.array[q];if(typeof L=="string")if(L.indexOf("-----BEGIN")!=-1)L={cert:L};else{if(!R(L))throw new u("unsupported value: "+L);L={hash:L}}P.alg!=null&&L.alg==null&&(L.alg=P.alg),P.hasis!=null&&L.hasis==null&&(L.hasis=P.hasis);var k=new O(L);B.push(k)}return[new m({array:B})]},a!=null&&this.setByParam(a)},Yt(b.asn1.cades.CompleteCertificateRefs,b.asn1.cms.Attribute),b.asn1.cades.OtherCertID=function(a){var u=b.asn1,p=u.DERSequence,g=u.cms.IssuerSerial,m=u.cades,w=m.OtherHashValue,O=m.OtherHashAlgAndValue;m.OtherCertID.superclass.constructor.call(this),this.params=a,this.tohex=function(){var R=this.params;typeof R=="string"&&(R.indexOf("-----BEGIN")!=-1?R={cert:R}:_isHex(R)&&(R={hash:R}));var P,B=[];if(P=R.alg!=null?new O(R):new w(R),B.push(P),R.cert!=null&&R.hasis==1||R.issuer!=null&&R.serial!=null){var q=new g(R);B.push(q)}return new p({array:B}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.cades.OtherCertID,b.asn1.ASN1Object),b.asn1.cades.OtherHash=function(a){var u=b,p=u.asn1,g=(p.cms,p.cades),m=g.OtherHashAlgAndValue,w=g.OtherHashValue,O=(u.crypto.Util.hashHex,u.lang.String.isHex);g.OtherHash.superclass.constructor.call(this),this.params=null,this.tohex=function(){var R=this.params;return typeof R=="string"&&(R.indexOf("-----BEGIN")!=-1?R={cert:R}:O(R)&&(R={hash:R})),(R.alg!=null?new m(R):new w(R)).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.cades.OtherHash,b.asn1.ASN1Object),b.asn1.cades.CAdESUtil=new function(){},b.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(a){return new b.asn1.cms.CMSParser().getCMSSignedData(a)},b.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(a,u,p){var g=Gt,m=g.getChildIdx,w=g.getTLV,O=g.getV,R=b.asn1,P=R.ASN1Object,B=R.cms,q=B.AttributeList,L=B.SignerInfo,k={},H=m(a,u);if(H.length!=6)throw"not supported items for SignerInfo (!=6)";var W=H.shift();k.version=w(a,W);var z=H.shift();k.si=w(a,z);var st=H.shift();k.digalg=w(a,st);var bt=H.shift();k.sattrs=w(a,bt);var It=H.shift();k.sigalg=w(a,It);var Mt=H.shift();k.sig=w(a,Mt),k.sigval=O(a,Mt);var Lt=null;return k.obj=new L,(Lt=new P).hTLV=k.version,k.obj.dCMSVersion=Lt,(Lt=new P).hTLV=k.si,k.obj.dSignerIdentifier=Lt,(Lt=new P).hTLV=k.digalg,k.obj.dDigestAlgorithm=Lt,(Lt=new P).hTLV=k.sattrs,k.obj.dSignedAttrs=Lt,(Lt=new P).hTLV=k.sigalg,k.obj.dSigAlg=Lt,(Lt=new P).hTLV=k.sig,k.obj.dSig=Lt,k.obj.dUnsignedAttrs=new q,k},b.asn1.csr!==void 0&&b.asn1.csr||(b.asn1.csr={}),b.asn1.csr.CertificationRequest=function(a){var u=b.asn1,p=u.DERBitString,g=u.DERSequence,m=u.csr,w=(u.x509,m.CertificationRequestInfo);m.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(O){this.params=O},this.sign=function(){var O=new w(this.params).tohex(),R=new b.crypto.Signature({alg:this.params.sigalg});R.init(this.params.sbjprvkey),R.updateHex(O);var P=R.sign();this.params.sighex=P},this.getPEM=function(){return Je(this.tohex(),"CERTIFICATE REQUEST")},this.tohex=function(){var O=this.params,R=new b.asn1.csr.CertificationRequestInfo(this.params),P=new b.asn1.x509.AlgorithmIdentifier({name:O.sigalg});if(O.sighex==null&&O.sbjprvkey!=null&&this.sign(),O.sighex==null)throw new Error("sighex or sbjprvkey parameter not defined");var B=new p({hex:"00"+O.sighex});return new g({array:[R,P,B]}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(b.asn1.csr.CertificationRequest,b.asn1.ASN1Object),b.asn1.csr.CertificationRequestInfo=function(a){var u=b.asn1,p=(u.DERBitString,u.DERSequence),g=u.DERInteger,m=u.DERUTF8String,w=u.DERTaggedObject,O=u.ASN1Util.newObject,R=u.csr,P=u.x509,B=P.X500Name,q=P.Extensions,L=P.SubjectPublicKeyInfo;R.AttributeList,R.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(k){k!=null&&(this.params=k)},this.tohex=function(){var k=this.params,H=[];if(H.push(new g({int:0})),H.push(new B(k.subject)),H.push(new L(Te.getKey(k.sbjpubkey))),k.attrs!=null){var W=function(bt){for(var It=Error,Mt=b.asn1.x509.Extensions,Lt=[],tt=0;tt<bt.length;tt++){var ut=bt[tt],pt=ut.attr;if(pt=="extensionRequest"){var it={seq:[{oid:"1.2.840.113549.1.9.14"},{set:[new Mt(ut.ext)]}]};Lt.push(it)}else if(pt=="unstructuredName")it={seq:[{oid:"1.2.840.113549.1.9.2"},{set:ut.names}]},Lt.push(it);else{if(pt!="challengePassword")throw new It("unknown CSR attribute");it={seq:[{oid:"1.2.840.113549.1.9.7"},{set:[{utf8str:ut.password}]}]},Lt.push(it)}}return{set:Lt}}(k.attrs),z=O({tag:{tage:"a0",obj:W}});H.push(z)}else if(k.extreq!=null){var st=new q(k.extreq);z=O({tag:{tage:"a0",obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[st]}]}}}),H.push(z)}else H.push(new w({tag:"a0",explicit:!1,obj:new m({str:""})}));return new p({array:H}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(b.asn1.csr.CertificationRequestInfo,b.asn1.ASN1Object),b.asn1.csr.AttributeList=function(a){},Yt(b.asn1.csr.AttributeList,b.asn1.ASN1Object),b.asn1.csr.CSRUtil=new function(){},b.asn1.csr.CSRUtil.newCSRPEM=function(a){return new b.asn1.csr.CertificationRequest(a).getPEM()},b.asn1.csr.CSRUtil.getParam=function(a,u){var p=Gt,g=p.getV,m=p.getIdxbyList,w=p.getTLVbyList,O=p.getTLVbyListEx,R=p.getVbyListEx,P={};if(a.indexOf("-----BEGIN CERTIFICATE REQUEST")==-1)throw new Error("argument is not PEM file");var B=tr(a,"CERTIFICATE REQUEST");u&&(P.tbs=w(B,0,[0]));try{var q=O(B,0,[0,1]);if(q=="3000")P.subject={};else{var L=new Ee;P.subject=L.getX500Name(q)}}catch{}var k=O(B,0,[0,2]),H=Te.getKey(k,null,"pkcs8pub");P.sbjpubkey=Te.getPEM(H,"PKCS8PUB");var W,z,st=(z=m(W=B,0,[0,3,0,0],"06"),g(W,z)!="2a864886f70d01090e"?null:w(W,0,[0,3,0,1,0],"30"));L=new Ee,st!=null&&(P.extreq=L.getExtParamArray(st));try{var bt=O(B,0,[1],"30");L=new Ee,P.sigalg=L.getAlgorithmIdentifierName(bt)}catch{}try{var It=R(B,0,[2]);P.sighex=It}catch{}return P},b.asn1.csr.CSRUtil.verifySignature=function(a){try{var u=null;if(typeof a=="string"&&a.indexOf("-----BEGIN CERTIFICATE REQUEST")!=-1?u=b.asn1.csr.CSRUtil.getParam(a,!0):typeof a=="object"&&a.sbjpubkey!=null&&a.sigalg!=null&&a.sighex!=null&&a.tbs!=null&&(u=a),u==null)return!1;var p=new b.crypto.Signature({alg:u.sigalg});return p.init(u.sbjpubkey),p.updateHex(u.tbs),p.verify(u.sighex)}catch(g){return alert(g),!1}},b!==void 0&&b||(b={}),b.asn1!==void 0&&b.asn1||(b.asn1={}),b.asn1.ocsp!==void 0&&b.asn1.ocsp||(b.asn1.ocsp={}),b.asn1.ocsp.DEFAULT_HASH="sha1",b.asn1.ocsp.OCSPResponse=function(a){b.asn1.ocsp.OCSPResponse.superclass.constructor.call(this),b.asn1.DEREnumerated;var u=b.asn1.ASN1Util.newObject,p=b.asn1.ocsp.ResponseBytes,g=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var m=this.params.resstatus;return typeof m=="number"?m:typeof m!="string"?-1:g.indexOf(m)},this.setByParam=function(m){this.params=m},this.tohex=function(){var m=this.params,w=this._getStatusCode();if(w==-1)throw new Error("responseStatus not supported: "+m.resstatus);if(w!=0)return u({seq:[{enum:{int:w}}]}).tohex();var O=new p(m);return u({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:O}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(b.asn1.ocsp.OCSPResponse,b.asn1.ASN1Object),b.asn1.ocsp.ResponseBytes=function(a){b.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var u=b.asn1,p=u.DERSequence,g=u.DERObjectIdentifier,m=u.DEROctetString,w=u.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(O){this.params=O},this.tohex=function(){var O=this.params;if(O.restype!="ocspBasic")throw new Error("not supported responseType: "+O.restype);var R=new w(O),P=[];return P.push(new g({name:"ocspBasic"})),P.push(new m({hex:R.tohex()})),new p({array:P}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(b.asn1.ocsp.ResponseBytes,b.asn1.ASN1Object),b.asn1.ocsp.BasicOCSPResponse=function(a){b.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var u=Error,p=b.asn1,g=p.ASN1Object,m=p.DERSequence,w=(p.DERGeneralizedTime,p.DERTaggedObject),O=p.DERBitString,R=(p.x509.Extensions,p.x509.AlgorithmIdentifier),P=p.ocsp;P.ResponderID,_SingleResponseList=P.SingleResponseList,_ResponseData=P.ResponseData,this.params=null,this.setByParam=function(B){this.params=B},this.sign=function(){var B=this.params,q=B.tbsresp.tohex(),L=new b.crypto.Signature({alg:B.sigalg});L.init(B.reskey),L.updateHex(q),B.sighex=L.sign()},this.tohex=function(){var B=this.params;B.tbsresp==null&&(B.tbsresp=new _ResponseData(B)),B.sighex==null&&B.reskey!=null&&this.sign();var q=[];if(q.push(B.tbsresp),q.push(new R({name:B.sigalg})),q.push(new O({hex:"00"+B.sighex})),B.certs!=null&&B.certs.length!=null){for(var L=[],k=0;k<B.certs.length;k++){var H=B.certs[k],W=null;if(Gt.isASN1HEX(H))W=H;else{if(!H.match(/-----BEGIN/))throw new u("certs["+k+"] not hex or PEM");W=tr(H)}L.push(new g({tlv:W}))}var z=new m({array:L});q.push(new w({tag:"a0",explicit:!0,obj:z}))}return new m({array:q}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(b.asn1.ocsp.BasicOCSPResponse,b.asn1.ASN1Object),b.asn1.ocsp.ResponseData=function(a){b.asn1.ocsp.ResponseData.superclass.constructor.call(this);var u=Error,p=b.asn1,g=p.DERSequence,m=p.DERGeneralizedTime,w=p.DERTaggedObject,O=p.x509.Extensions,R=p.ocsp,P=R.ResponderID;_SingleResponseList=R.SingleResponseList,this.params=null,this.tohex=function(){var B=this.params;B.respid!=null&&new u("respid not specified"),B.prodat!=null&&new u("prodat not specified"),B.array!=null&&new u("array not specified");var q=[];if(q.push(new P(B.respid)),q.push(new m(B.prodat)),q.push(new _SingleResponseList(B.array)),B.ext!=null){var L=new O(B.ext);q.push(new w({tag:"a1",explicit:!0,obj:L}))}return new g({array:q}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(B){this.params=B},a!==void 0&&this.setByParam(a)},Yt(b.asn1.ocsp.ResponseData,b.asn1.ASN1Object),b.asn1.ocsp.ResponderID=function(a){b.asn1.ocsp.ResponderID.superclass.constructor.call(this);var u=b,p=u.asn1,g=p.ASN1Util.newObject,m=p.x509.X500Name,w=u.lang.String.isHex,O=Error;this.params=null,this.tohex=function(){var R=this.params;if(R.key!=null){var P,B=null;if(typeof R.key=="string"?(w(R.key)&&(B=R.key),R.key.match(/-----BEGIN CERTIFICATE/)&&(P=new Ee(R.key).getExtSubjectKeyIdentifier())!=null&&(B=P.kid.hex)):R.key instanceof Ee&&(P=R.key.getExtSubjectKeyIdentifier())!=null&&(B=P.kid.hex),B==null)throw new O("wrong key member value");return g({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:B}}}}).tohex()}if(R.name!=null){var q=null;if(typeof R.name=="string"&&R.name.match(/-----BEGIN CERTIFICATE/)?q=new Ee(R.name).getSubject():R.name instanceof Ee?q=R.name.getSubject():typeof R.name!="object"||R.name.array==null&&R.name.str==null||(q=R.name),q==null)throw new O("wrong name member value");return g({tag:{tag:"a1",explicit:!0,obj:new m(q)}}).tohex()}throw new O("key or name not specified")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(R){this.params=R},a!==void 0&&this.setByParam(a)},Yt(b.asn1.ocsp.ResponderID,b.asn1.ASN1Object),b.asn1.ocsp.SingleResponseList=function(a){b.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var u=b.asn1,p=u.DERSequence,g=u.ocsp.SingleResponse;this.params=null,this.tohex=function(){var m=this.params;if(typeof m!="object"||m.length==null)throw new Error("params not specified properly");for(var w=[],O=0;O<m.length;O++)w.push(new g(m[O]));return new p({array:w}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(m){this.params=m},a!==void 0&&this.setByParam(a)},Yt(b.asn1.ocsp.SingleResponseList,b.asn1.ASN1Object),b.asn1.ocsp.SingleResponse=function(a){var u=Error,p=b.asn1,g=p.DERSequence,m=p.DERGeneralizedTime,w=p.DERTaggedObject,O=p.ocsp,R=O.CertID,P=O.CertStatus,B=p.x509.Extensions;O.SingleResponse.superclass.constructor.call(this),this.params=null,this.tohex=function(){var q=this.params,L=[];if(q.certid==null)throw new u("certid unspecified");if(q.status==null)throw new u("status unspecified");if(q.thisupdate==null)throw new u("thisupdate unspecified");if(L.push(new R(q.certid)),L.push(new P(q.status)),L.push(new m(q.thisupdate)),q.nextupdate!=null){var k=new m(q.nextupdate);L.push(new w({tag:"a0",explicit:!0,obj:k}))}if(q.ext!=null){var H=new B(q.ext);L.push(new w({tag:"a1",explicit:!0,obj:H}))}return new g({array:L}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(q){this.params=q},a!==void 0&&this.setByParam(a)},Yt(b.asn1.ocsp.SingleResponse,b.asn1.ASN1Object),b.asn1.ocsp.CertID=function(a){var u=b,p=u.asn1,g=p.DEROctetString,m=p.DERInteger,w=p.DERSequence,O=p.x509.AlgorithmIdentifier,R=p.ocsp,P=(R.DEFAULT_HASH,u.crypto.Util.hashHex),B=Ee,q=Gt.getVbyList;R.CertID.superclass.constructor.call(this),this.DEFAULT_HASH="sha1",this.params=null,this.setByValue=function(L,k,H,W){W==null&&(W=this.DEFAULT_HASH),this.params={alg:W,issname:L,isskey:k,sbjsn:H}},this.setByCert=function(L,k,H){H==null&&(H=this.DEFAULT_HASH),this.params={alg:H,issuerCert:L,subjectCert:k}},this.getParamByCerts=function(L,k,H){H==null&&(H=this.DEFAULT_HASH);var W=new B(L),z=new B(k),st=P(W.getSubjectHex(),H),bt=W.getPublicKeyHex();return{alg:H,issname:st,isskey:P(q(bt,0,[1],"03",!0),H),sbjsn:z.getSerialNumberHex()}},this.tohex=function(){if(typeof this.params!="object")throw new Error("params not set");var L,k,H,W,z=this.params;if(W=z.alg==null?this.DEFAULT_HASH:z.alg,z.issuerCert!=null&&z.subjectCert!=null){var st=this.getParamByCerts(z.issuerCert,z.subjectCert,W);L=st.issname,k=st.isskey,H=st.sbjsn}else{if(z.issname==null||z.isskey==null||z.sbjsn==null)throw new Error("required param members not defined");L=z.issname,k=z.isskey,H=z.sbjsn}var bt=new O({name:W}),It=new g({hex:L}),Mt=new g({hex:k}),Lt=new m({hex:H}),tt=new w({array:[bt,It,Mt,Lt]});return this.hTLV=tt.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(b.asn1.ocsp.CertID,b.asn1.ASN1Object),b.asn1.ocsp.CertStatus=function(a){b.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.tohex=function(){var u=this.params;if(u.status=="good")return"8000";if(u.status=="unknown")return"8200";if(u.status=="revoked"){var p=[{gentime:{str:u.time}}];u.reason!=null&&p.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:u.reason}}}});var g={tag:"a1",explicit:!1,obj:{seq:p}};return b.asn1.ASN1Util.newObject({tag:g}).tohex()}throw new Error("bad status")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(u){this.params=u},a!==void 0&&this.setByParam(a)},Yt(b.asn1.ocsp.CertStatus,b.asn1.ASN1Object),b.asn1.ocsp.Request=function(a){var u=b.asn1,p=u.DERSequence,g=u.ocsp;if(g.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.tohex=function(){var w=[];if(this.dReqCert===null)throw"reqCert not set";w.push(this.dReqCert);var O=new p({array:w});return this.hTLV=O.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0){var m=new g.CertID(a);this.dReqCert=m}},Yt(b.asn1.ocsp.Request,b.asn1.ASN1Object),b.asn1.ocsp.TBSRequest=function(a){var u=b.asn1,p=u.DERSequence,g=u.ocsp;g.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(m){for(var w=[],O=0;O<m.length;O++){var R=new g.Request(m[0]);w.push(R)}this.dRequestList=w},this.tohex=function(){var m=[];if(this.version!==0)throw"not supported version: "+this.version;if(this.dRequestorName!==null)throw"requestorName not supported";var w=new p({array:this.dRequestList});if(m.push(w),this.dRequestExt!==null)throw"requestExtensions not supported";var O=new p({array:m});return this.hTLV=O.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&a.reqList!==void 0&&this.setRequestListByParam(a.reqList)},Yt(b.asn1.ocsp.TBSRequest,b.asn1.ASN1Object),b.asn1.ocsp.OCSPRequest=function(a){var u=b.asn1,p=u.DERSequence,g=u.ocsp;if(g.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.tohex=function(){var w=[];if(this.dTbsRequest===null)throw"tbsRequest not set";if(w.push(this.dTbsRequest),this.dOptionalSignature!==null)throw"optionalSignature not supported";var O=new p({array:w});return this.hTLV=O.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&a.reqList!==void 0){var m=new g.TBSRequest(a);this.dTbsRequest=m}},Yt(b.asn1.ocsp.OCSPRequest,b.asn1.ASN1Object),b.asn1.ocsp.OCSPUtil={},b.asn1.ocsp.OCSPUtil.getRequestHex=function(a,u,p){var g=b.asn1.ocsp;p===void 0&&(p=g.DEFAULT_HASH);var m={alg:p,issuerCert:a,subjectCert:u};return new g.OCSPRequest({reqList:[m]}).tohex()},b.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(a){var u=Gt,p=u.getVbyList,g=u.getVbyListEx,m=u.getIdxbyList,w=(u.getIdxbyListEx,u.getV),O={};try{var R=g(a,0,[0],"0a");O.responseStatus=parseInt(R,16)}catch{}if(O.responseStatus!==0)return O;try{var P=m(a,0,[1,0,1,0,0,2,0,1]);a.substr(P,2)==="80"?O.certStatus="good":a.substr(P,2)==="a1"?(O.certStatus="revoked",O.revocationTime=Le(p(a,P,[0]))):a.substr(P,2)==="82"&&(O.certStatus="unknown")}catch{}try{var B=m(a,0,[1,0,1,0,0,2,0,2]);O.thisUpdate=Le(w(a,B))}catch{}try{var q=m(a,0,[1,0,1,0,0,2,0,3]);a.substr(q,2)==="a0"&&(O.nextUpdate=Le(p(a,q,[0])))}catch{}return O},b.asn1.ocsp.OCSPParser=function(){var a=Error,u=Ee,p=new u,g=Gt,m=g.getV,w=g.getTLV,O=g.getIdxbyList,R=g.getVbyList,P=g.getTLVbyList,B=g.getVbyListEx,q=g.getTLVbyListEx,L=g.getChildIdx;this.getOCSPRequest=function(k){var H=L(k,0);if(H.length!=1&&H.length!=2)throw new a("wrong number elements: "+H.length);return this.getTBSRequest(w(k,H[0]))},this.getTBSRequest=function(k){var H={},W=q(k,0,[0],"30");H.array=this.getRequestList(W);var z=q(k,0,["[2]",0],"30");return z!=null&&(H.ext=p.getExtParamArray(z)),H},this.getRequestList=function(k){for(var H=[],W=L(k,0),z=0;z<W.length;z++)k=w(k,W[z]),H.push(this.getRequest(k));return H},this.getRequest=function(k){var H=L(k,0);if(H.length!=1&&H.length!=2)throw new a("wrong number elements: "+H.length);var W=this.getCertID(w(k,H[0]));if(H.length==2){var z=O(k,0,[1,0]);W.ext=p.getExtParamArray(w(k,z))}return W},this.getCertID=function(k){var H=L(k,0);if(H.length!=4)throw new a("wrong number elements: "+H.length);var W=new u,z={};return z.alg=W.getAlgorithmIdentifierName(w(k,H[0])),z.issname=m(k,H[1]),z.isskey=m(k,H[2]),z.sbjsn=m(k,H[3]),z},this.getOCSPResponse=function(k){var H,W=L(k,0),z=m(k,W[0]),st=parseInt(z);if(W.length==1)return{resstatus:st};var bt=P(k,0,[1,0]);return(H=this.getResponseBytes(bt)).resstatus=st,H},this.getResponseBytes=function(k){var H,W=L(k,0),z=P(k,0,[1,0]);H=this.getBasicOCSPResponse(z);var st=m(k,W[0]);return H.restype=b.asn1.x509.OID.oid2name(Tr(st)),H},this.getBasicOCSPResponse=function(k){var H,W=L(k,0);H=this.getResponseData(w(k,W[0]));var z=new Ee;H.alg=z.getAlgorithmIdentifierName(w(k,W[1]));var st=m(k,W[2]);H.sighex=st.substr(2);var bt=B(k,0,["[0]"]);if(bt!=null){for(var It=L(bt,0),Mt=[],Lt=0;Lt<It.length;Lt++){var tt=w(bt,It[Lt]);Mt.push(tt)}H.certs=Mt}return H},this.getResponseData=function(k){var H=L(k,0),W=H.length,z={},st=0;k.substr(H[0],2)=="a0"&&st++,z.respid=this.getResponderID(w(k,H[st++]));var bt=m(k,H[st++]);if(z.prodat=Le(bt),z.array=this.getSingleResponseList(w(k,H[st++])),k.substr(H[W-1],2)=="a1"){var It=P(k,H[W-1],[0]),Mt=new Ee;z.ext=Mt.getExtParamArray(It)}return z},this.getResponderID=function(k){var H={};if(k.substr(0,2)=="a2"){var W=R(k,0,[0]);H.key=W}if(k.substr(0,2)=="a1"){var z=P(k,0,[0]),st=new Ee;H.name=st.getX500Name(z)}return H},this.getSingleResponseList=function(k){for(var H=L(k,0),W=[],z=0;z<H.length;z++){var st=this.getSingleResponse(w(k,H[z]));W.push(st)}return W},this.getSingleResponse=function(k){var H=L(k,0),W={},z=this.getCertID(w(k,H[0]));W.certid=z;var st=this.getCertStatus(w(k,H[1]));if(W.status=st,k.substr(H[2],2)=="18"){var bt=m(k,H[2]);W.thisupdate=Le(bt)}for(var It=3;It<H.length;It++){if(k.substr(H[It],2)=="a0"){var Mt=R(k,H[It],[0],"18");W.nextupdate=Le(Mt)}if(k.substr(H[It],2)=="a1"){var Lt=new Ee,tt=P(k,0,[It,0]);W.ext=Lt.getExtParamArray(tt)}}return W},this.getCertStatus=function(k){var H={};if(k=="8000")return{status:"good"};if(k=="8200")return{status:"unknown"};if(k.substr(0,2)=="a1"){H.status="revoked";var W=Le(R(k,0,[0]));H.time=W}return H}},b!==void 0&&b||(b={}),b.lang!==void 0&&b.lang||(b.lang={}),b.lang.String=function(){},typeof t=="function"?(Be=function(a){return lr(t.from(a,"utf8").toString("base64"))},ce=function(a){return t.from(ur(a),"base64").toString("utf8")}):(Be=function(a){return Me(Yr(Ar(a)))},ce=function(a){return decodeURIComponent(Jr(Ke(a)))}),b.lang.String.isInteger=function(a){return!!a.match(/^[0-9]+$/)||!!a.match(/^-[0-9]+$/)},b.lang.String.isHex=function(a){return un(a)},b.lang.String.isBase64=function(a){return!(!(a=a.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||a.length%4!=0)},b.lang.String.isBase64URL=function(a){return!a.match(/[+/=]/)&&(a=ur(a),b.lang.String.isBase64(a))},b.lang.String.isIntegerArray=function(a){return!!(a=a.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},b.lang.String.isPrintable=function(a){return a.match(/^[0-9A-Za-z '()+,-./:=?]*$/)!==null},b.lang.String.isIA5=function(a){return a.match(/^[\x20-\x21\x23-\x7f]*$/)!==null},b.lang.String.isMail=function(a){return a.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)!==null};var Ut=function(a,u,p){return p==null&&(p="0"),a.length>=u?a:new Array(u-a.length+1).join(p)+a};function sr(a){if(a.length%2!=0||(a=a.toLowerCase()).match(/^[0-9a-f]+$/)==null)return-1;try{var u=a.substr(0,2);if(u=="00")return parseInt(a.substr(2),16);var p=parseInt(u,16);if(p>7)return-1;var g=a.substr(2),m=parseInt(g,16).toString(2);m=="0"&&(m="00000000"),m=m.slice(0,0-p);var w=parseInt(m,2);return w==NaN?-1:w}catch{return-1}}function _n(a){if(typeof a!="number"||a<0)return null;var u=Number(a).toString(2),p=8-u.length%8;p==8&&(p=0),u+=Ut("",p,"0");var g=parseInt(u,2).toString(16);return g.length%2==1&&(g="0"+g),"0"+p+g}function Ie(a){if(typeof a!="string"||a.length%2!=0||!a.match(/^[0-9a-f]+$/))return null;try{var u=parseInt(a.substr(0,2),16);if(u<0||7<u)return null;for(var p=a.substr(2),g="",m=0;m<p.length;m+=2){var w=p.substr(m,2),O=parseInt(w,16).toString(2);g+=O=("0000000"+O).slice(-8)}return g.substr(0,g.length-u)}catch{return null}}function fr(a,u){for(var p=0,g=0;g<a.length;g++)p|=1<<u[a[g]];var m=p.toString(2),w="";for(g=m.length-1;g>=0;g--)w+=m[g];return w}function Ue(a,u,p){if(typeof a=="object"){u=String(u).split(".");for(var g=0;g<u.length&&a;g++){var m=u[g];m.match(/^[0-9]+$/)&&(m=parseInt(m)),a=a[m]}return a||a===!1?a:p}}function Yt(a,u){var p=function(){};p.prototype=u.prototype,a.prototype=new p,a.prototype.constructor=a,a.superclass=u.prototype,u.prototype.constructor==Object.prototype.constructor&&(u.prototype.constructor=u)}b!==void 0&&b||(b={}),b.crypto!==void 0&&b.crypto||(b.crypto={}),b.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:Y.algo.MD5,sha1:Y.algo.SHA1,sha224:Y.algo.SHA224,sha256:Y.algo.SHA256,sha384:Y.algo.SHA384,sha512:Y.algo.SHA512,ripemd160:Y.algo.RIPEMD160},this.getDigestInfoHex=function(a,u){if(this.DIGESTINFOHEAD[u]===void 0)throw"alg not supported in Util.DIGESTINFOHEAD: "+u;return this.DIGESTINFOHEAD[u]+a},this.getPaddedDigestInfoHex=function(a,u,p){var g=this.getDigestInfoHex(a,u),m=p/4;if(g.length+22>m)throw"key is too short for SigAlg: keylen="+p+","+u;for(var w="0001",O="00"+g,R="",P=m-w.length-O.length,B=0;B<P;B+=2)R+="ff";return w+R+O},this.hashString=function(a,u){return new b.crypto.MessageDigest({alg:u}).digestString(a)},this.hashHex=function(a,u){return new b.crypto.MessageDigest({alg:u}).digestHex(a)},this.sha1=function(a){return this.hashString(a,"sha1")},this.sha256=function(a){return this.hashString(a,"sha256")},this.sha256Hex=function(a){return this.hashHex(a,"sha256")},this.sha512=function(a){return this.hashString(a,"sha512")},this.sha512Hex=function(a){return this.hashHex(a,"sha512")},this.isKey=function(a){return a instanceof Bt||a instanceof b.crypto.DSA||a instanceof b.crypto.ECDSA}},b.crypto.Util.md5=function(a){return new b.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(a)},b.crypto.Util.ripemd160=function(a){return new b.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(a)},b.crypto.Util.SECURERANDOMGEN=new ge,b.crypto.Util.getRandomHexOfNbytes=function(a){var u=new Array(a);return b.crypto.Util.SECURERANDOMGEN.nextBytes(u),Xe(u)},b.crypto.Util.getRandomBigIntegerOfNbytes=function(a){return new et(b.crypto.Util.getRandomHexOfNbytes(a),16)},b.crypto.Util.getRandomHexOfNbits=function(a){var u=a%8,p=new Array((a-u)/8+1);return b.crypto.Util.SECURERANDOMGEN.nextBytes(p),p[0]=(255<<u&255^255)&p[0],Xe(p)},b.crypto.Util.getRandomBigIntegerOfNbits=function(a){return new et(b.crypto.Util.getRandomHexOfNbits(a),16)},b.crypto.Util.getRandomBigIntegerZeroToMax=function(a){for(var u=a.bitLength();;){var p=b.crypto.Util.getRandomBigIntegerOfNbits(u);if(a.compareTo(p)!=-1)return p}},b.crypto.Util.getRandomBigIntegerMinToMax=function(a,u){var p=a.compareTo(u);if(p==1)throw"biMin is greater than biMax";if(p==0)return a;var g=u.subtract(a);return b.crypto.Util.getRandomBigIntegerZeroToMax(g).add(a)},b.crypto.MessageDigest=function(a){this.setAlgAndProvider=function(u,p){if((u=b.crypto.MessageDigest.getCanonicalAlgName(u))!==null&&p===void 0&&(p=b.crypto.Util.DEFAULTPROVIDER[u]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(u)!=-1&&p=="cryptojs"){try{this.md=b.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[u].create()}catch(g){throw"setAlgAndProvider hash alg set fail alg="+u+"/"+g}this.updateString=function(g){this.md.update(g)},this.updateHex=function(g){var m=Y.enc.Hex.parse(g);this.md.update(m)},this.digest=function(){return this.md.finalize().toString(Y.enc.Hex)},this.digestString=function(g){return this.updateString(g),this.digest()},this.digestHex=function(g){return this.updateHex(g),this.digest()}}if(":sha256:".indexOf(u)!=-1&&p=="sjcl"){try{this.md=new sjcl.hash.sha256}catch(g){throw"setAlgAndProvider hash alg set fail alg="+u+"/"+g}this.updateString=function(g){this.md.update(g)},this.updateHex=function(g){var m=sjcl.codec.hex.toBits(g);this.md.update(m)},this.digest=function(){var g=this.md.finalize();return sjcl.codec.hex.fromBits(g)},this.digestString=function(g){return this.updateString(g),this.digest()},this.digestHex=function(g){return this.updateHex(g),this.digest()}}},this.updateString=function(u){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(u){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(u){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(u){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},a!==void 0&&a.alg!==void 0&&(this.algName=a.alg,a.prov===void 0&&(this.provName=b.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},b.crypto.MessageDigest.getCanonicalAlgName=function(a){return typeof a=="string"&&(a=(a=a.toLowerCase()).replace(/-/,"")),a},b.crypto.MessageDigest.getHashLength=function(a){var u=b.crypto.MessageDigest,p=u.getCanonicalAlgName(a);if(u.HASHLENGTH[p]===void 0)throw"not supported algorithm: "+a;return u.HASHLENGTH[p]},b.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},b.crypto.Mac=function(a){this.setAlgAndProvider=function(u,p){if((u=u.toLowerCase())==null&&(u="hmacsha1"),(u=u.toLowerCase()).substr(0,4)!="hmac")throw"setAlgAndProvider unsupported HMAC alg: "+u;p===void 0&&(p=b.crypto.Util.DEFAULTPROVIDER[u]),this.algProv=u+"/"+p;var g=u.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(g)!=-1&&p=="cryptojs"){try{var m=b.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[g];this.mac=Y.algo.HMAC.create(m,this.pass)}catch(w){throw"setAlgAndProvider hash alg set fail hashAlg="+g+"/"+w}this.updateString=function(w){this.mac.update(w)},this.updateHex=function(w){var O=Y.enc.Hex.parse(w);this.mac.update(O)},this.doFinal=function(){return this.mac.finalize().toString(Y.enc.Hex)},this.doFinalString=function(w){return this.updateString(w),this.doFinal()},this.doFinalHex=function(w){return this.updateHex(w),this.doFinal()}}},this.updateString=function(u){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(u){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(u){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(u){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(u){if(typeof u=="string"){var p=u;return u.length%2!=1&&u.match(/^[0-9A-Fa-f]+$/)||(p=Sr(u)),void(this.pass=Y.enc.Hex.parse(p))}if(typeof u!="object")throw"KJUR.crypto.Mac unsupported password type: "+u;if(p=null,u.hex!==void 0){if(u.hex.length%2!=0||!u.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+u.hex;p=u.hex}if(u.utf8!==void 0&&(p=Ir(u.utf8)),u.rstr!==void 0&&(p=Sr(u.rstr)),u.b64!==void 0&&(p=ct(u.b64)),u.b64u!==void 0&&(p=Ke(u.b64u)),p==null)throw"KJUR.crypto.Mac unsupported password type: "+u;this.pass=Y.enc.Hex.parse(p)},a!==void 0&&(a.pass!==void 0&&this.setPassword(a.pass),a.alg!==void 0&&(this.algName=a.alg,a.prov===void 0&&(this.provName=b.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},b.crypto.Signature=function(a){var u=null;if(this._setAlgNames=function(){var p=this.algName.match(/^(.+)with(.+)$/);p&&(this.mdAlgName=p[1].toLowerCase(),this.pubkeyAlgName=p[2].toLowerCase(),this.pubkeyAlgName=="rsaandmgf1"&&this.mdAlgName=="sha"&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(p,g){for(var m="",w=g/4-p.length,O=0;O<w;O++)m+="0";return m+p},this.setAlgAndProvider=function(p,g){if(this._setAlgNames(),g!="cryptojs/jsrsa")throw new Error("provider not supported: "+g);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new b.crypto.MessageDigest({alg:this.mdAlgName})}catch(m){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+m)}this.init=function(m,w){var O=null;try{O=w===void 0?Te.getKey(m):Te.getKey(m,w)}catch(R){throw"init failed:"+R}if(O.isPrivate===!0)this.prvKey=O,this.state="SIGN";else{if(O.isPublic!==!0)throw"init failed.:"+O;this.pubKey=O,this.state="VERIFY"}},this.updateString=function(m){this.md.updateString(m)},this.updateHex=function(m){this.md.updateHex(m)},this.sign=function(){if(this.sHashHex=this.md.digest(),this.prvKey===void 0&&this.ecprvhex!==void 0&&this.eccurvename!==void 0&&b.crypto.ECDSA!==void 0&&(this.prvKey=new b.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof Bt&&this.pubkeyAlgName==="rsaandmgf1")this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof Bt&&this.pubkeyAlgName==="rsa")this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof b.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof b.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(m){return this.updateString(m),this.sign()},this.signHex=function(m){return this.updateHex(m),this.sign()},this.verify=function(m){if(this.sHashHex=this.md.digest(),this.pubKey===void 0&&this.ecpubhex!==void 0&&this.eccurvename!==void 0&&b.crypto.ECDSA!==void 0&&(this.pubKey=new b.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof Bt&&this.pubkeyAlgName==="rsaandmgf1")return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,m,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof Bt&&this.pubkeyAlgName==="rsa")return this.pubKey.verifyWithMessageHash(this.sHashHex,m);if(b.crypto.ECDSA!==void 0&&this.pubKey instanceof b.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,m);if(b.crypto.DSA!==void 0&&this.pubKey instanceof b.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,m);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(p,g){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(p){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(p){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(p){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(p){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(p){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=a,a!==void 0&&(a.alg!==void 0&&(this.algName=a.alg,a.prov===void 0?this.provName=b.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=a.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),a.psssaltlen!==void 0&&(this.pssSaltLen=a.psssaltlen),a.prvkeypem!==void 0)){if(a.prvkeypas!==void 0)throw"both prvkeypem and prvkeypas parameters not supported";try{u=Te.getKey(a.prvkeypem),this.init(u)}catch(p){throw"fatal error to load pem private key: "+p}}},b.crypto.Cipher=function(a){},b.crypto.Cipher.encrypt=function(a,u,p,g){if(Ue(g,"enclag")!=null&&(p=g.encalg),typeof p=="string"&&p.substr(-4)=="-CBC"){var m=u,w=a;Ue(g,"key")!=null&&(m=g.key),Ue(g,"enc")!=null&&(hEnc=g.enc);var O,R=Y.enc.Hex.parse(m),P=Y.enc.Hex.parse(w),B=Y.enc.Hex.parse(g.iv);if(p=="des-EDE3-CBC")O=Y.TripleDES.encrypt(P,R,{iv:B});else{if(p!="aes128-CBC"&&p!="aes256-CBC")throw new Error("unsupported algorithm: "+p);O=Y.AES.encrypt(P,R,{iv:B})}return O+""}throw new Error("Cipher.encrypt: unsupported key or algorithm")},b.crypto.Cipher.decrypt=function(a,u,p,g){if(Ue(g,"enclag")!=null&&(p=g.encalg),typeof p=="string"&&p.substr(-4)=="-CBC"){var m=u,w=a;Ue(g,"key")!=null&&(m=g.key),Ue(g,"enc")!=null&&(w=g.enc);var O,R=Y.enc.Hex.parse(m),P=Y.enc.Hex.parse(w),B=Y.enc.Hex.parse(g.iv);if(p=="des-EDE3-CBC")O=Y.TripleDES.decrypt({ciphertext:P},R,{iv:B});else{if(p!="aes128-CBC"&&p!="aes256-CBC")throw new Error("unsupported algorithm: "+p);O=Y.AES.decrypt({ciphertext:P},R,{iv:B})}return Y.enc.Hex.stringify(O)}throw new Error("Cipher.decrypt: unsupported key or algorithm")},b.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040022":"secp384r1","2b81040023":"secp521r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},b!==void 0&&b||(b={}),b.crypto!==void 0&&b.crypto||(b.crypto={}),b.crypto.ECDSA=function(a){var u=Error,p=et,g=ee,m=b.crypto.ECDSA,w=b.crypto.ECParameterDB,O=m.getName,R=Gt,P=R.getVbyListEx,B=R.isASN1HEX,q=new ge;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(L){return new p(L.bitLength(),q).mod(L.subtract(p.ONE)).add(p.ONE)},this.setNamedCurve=function(L){this.ecparams=w.getByName(L),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=L},this.setPrivateKeyHex=function(L){this.isPrivate=!0,this.prvKeyHex=L},this.setPublicKeyHex=function(L){this.isPublic=!0,this.pubKeyHex=L},this.getPublicKeyXYHex=function(){var L=this.pubKeyHex;if(L.substr(0,2)!=="04")throw"this method supports uncompressed format(04) only";var k=this.ecparams.keycharlen;if(L.length!==2+2*k)throw"malformed public key hex length";var H={};return H.x=L.substr(2,k),H.y=L.substr(2+k),H},this.getShortNISTPCurveName=function(){var L=this.curveName;return L==="secp256r1"||L==="NIST P-256"||L==="P-256"||L==="prime256v1"?"P-256":L==="secp384r1"||L==="NIST P-384"||L==="P-384"?"P-384":L==="secp521r1"||L==="NIST P-521"||L==="P-521"?"P-521":null},this.generateKeyPairHex=function(){var L=this.ecparams.n,k=this.getBigRandom(L),H=this.ecparams.keycharlen,W=("0000000000"+k.toString(16)).slice(-H);return this.setPrivateKeyHex(W),{ecprvhex:W,ecpubhex:this.generatePublicKeyHex()}},this.generatePublicKeyHex=function(){var L=new p(this.prvKeyHex,16),k=this.ecparams.G.multiply(L),H=k.getX().toBigInteger(),W=k.getY().toBigInteger(),z=this.ecparams.keycharlen,st="04"+("0000000000"+H.toString(16)).slice(-z)+("0000000000"+W.toString(16)).slice(-z);return this.setPublicKeyHex(st),st},this.signWithMessageHash=function(L){return this.signHex(L,this.prvKeyHex)},this.signHex=function(L,k){var H=new p(k,16),W=this.ecparams.n,z=new p(L.substring(0,this.ecparams.keycharlen),16);do var st=this.getBigRandom(W),bt=this.ecparams.G.multiply(st).getX().toBigInteger().mod(W);while(bt.compareTo(p.ZERO)<=0);var It=st.modInverse(W).multiply(z.add(H.multiply(bt))).mod(W);return m.biRSSigToASN1Sig(bt,It)},this.sign=function(L,k){var H=k,W=this.ecparams.n,z=p.fromByteArrayUnsigned(L);do var st=this.getBigRandom(W),bt=this.ecparams.G.multiply(st).getX().toBigInteger().mod(W);while(bt.compareTo(et.ZERO)<=0);var It=st.modInverse(W).multiply(z.add(H.multiply(bt))).mod(W);return this.serializeSig(bt,It)},this.verifyWithMessageHash=function(L,k){return this.verifyHex(L,k,this.pubKeyHex)},this.verifyHex=function(L,k,H){try{var W,z,st=m.parseSigHex(k);W=st.r,z=st.s;var bt=g.decodeFromHex(this.ecparams.curve,H),It=new p(L.substring(0,this.ecparams.keycharlen),16);return this.verifyRaw(It,W,z,bt)}catch{return!1}},this.verify=function(L,k,H){var W,z,st;if(Bitcoin.Util.isArray(k)){var bt=this.parseSig(k);W=bt.r,z=bt.s}else{if(typeof k!="object"||!k.r||!k.s)throw"Invalid value for signature";W=k.r,z=k.s}if(H instanceof ee)st=H;else{if(!Bitcoin.Util.isArray(H))throw"Invalid format for pubkey value, must be byte array or ECPointFp";st=g.decodeFrom(this.ecparams.curve,H)}var It=p.fromByteArrayUnsigned(L);return this.verifyRaw(It,W,z,st)},this.verifyRaw=function(L,k,H,W){var z=this.ecparams.n,st=this.ecparams.G;if(k.compareTo(p.ONE)<0||k.compareTo(z)>=0||H.compareTo(p.ONE)<0||H.compareTo(z)>=0)return!1;var bt=H.modInverse(z),It=L.multiply(bt).mod(z),Mt=k.multiply(bt).mod(z);return st.multiply(It).add(W.multiply(Mt)).getX().toBigInteger().mod(z).equals(k)},this.serializeSig=function(L,k){var H=L.toByteArraySigned(),W=k.toByteArraySigned(),z=[];return z.push(2),z.push(H.length),(z=z.concat(H)).push(2),z.push(W.length),(z=z.concat(W)).unshift(z.length),z.unshift(48),z},this.parseSig=function(L){var k;if(L[0]!=48)throw new Error("Signature not a valid DERSequence");if(L[k=2]!=2)throw new Error("First element in signature must be a DERInteger");var H=L.slice(k+2,k+2+L[k+1]);if(L[k+=2+L[k+1]]!=2)throw new Error("Second element in signature must be a DERInteger");var W=L.slice(k+2,k+2+L[k+1]);return k+=2+L[k+1],{r:p.fromByteArrayUnsigned(H),s:p.fromByteArrayUnsigned(W)}},this.parseSigCompact=function(L){if(L.length!==65)throw"Signature has the wrong length";var k=L[0]-27;if(k<0||k>7)throw"Invalid signature type";var H=this.ecparams.n;return{r:p.fromByteArrayUnsigned(L.slice(1,33)).mod(H),s:p.fromByteArrayUnsigned(L.slice(33,65)).mod(H),i:k}},this.readPKCS5PrvKeyHex=function(L){if(B(L)===!1)throw new Error("not ASN.1 hex string");var k,H,W;try{k=P(L,0,["[0]",0],"06"),H=P(L,0,[1],"04");try{W=P(L,0,["[1]",0],"03")}catch{}}catch{throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=O(k),this.curveName===void 0)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(W),this.setPrivateKeyHex(H),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(L){if(B(L)===!1)throw new u("not ASN.1 hex string");var k,H,W;try{P(L,0,[1,0],"06"),k=P(L,0,[1,1],"06"),H=P(L,0,[2,0,1],"04");try{W=P(L,0,[2,0,"[1]",0],"03")}catch{}}catch{throw new u("malformed PKCS#8 plain ECC private key")}if(this.curveName=O(k),this.curveName===void 0)throw new u("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(W),this.setPrivateKeyHex(H),this.isPublic=!1},this.readPKCS8PubKeyHex=function(L){if(B(L)===!1)throw new u("not ASN.1 hex string");var k,H;try{P(L,0,[0,0],"06"),k=P(L,0,[0,1],"06"),H=P(L,0,[1],"03")}catch{throw new u("malformed PKCS#8 ECC public key")}if(this.curveName=O(k),this.curveName===null)throw new u("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(H)},this.readCertPubKeyHex=function(L,k){if(B(L)===!1)throw new u("not ASN.1 hex string");var H,W;try{H=P(L,0,[0,5,0,1],"06"),W=P(L,0,[0,5,1],"03")}catch{throw new u("malformed X.509 certificate ECC public key")}if(this.curveName=O(H),this.curveName===null)throw new u("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(W)},a!==void 0&&a.curve!==void 0&&(this.curveName=a.curve),this.curveName===void 0&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),a!==void 0&&(a.prv!==void 0&&this.setPrivateKeyHex(a.prv),a.pub!==void 0&&this.setPublicKeyHex(a.pub))},b.crypto.ECDSA.parseSigHex=function(a){var u=b.crypto.ECDSA.parseSigHexInHexRS(a);return{r:new et(u.r,16),s:new et(u.s,16)}},b.crypto.ECDSA.parseSigHexInHexRS=function(a){var u=Gt,p=u.getChildIdx,g=u.getV;if(u.checkStrictDER(a,0),a.substr(0,2)!="30")throw new Error("signature is not a ASN.1 sequence");var m=p(a,0);if(m.length!=2)throw new Error("signature shall have two elements");var w=m[0],O=m[1];if(a.substr(w,2)!="02")throw new Error("1st item not ASN.1 integer");if(a.substr(O,2)!="02")throw new Error("2nd item not ASN.1 integer");return{r:g(a,w),s:g(a,O)}},b.crypto.ECDSA.asn1SigToConcatSig=function(a){var u=b.crypto.ECDSA.parseSigHexInHexRS(a),p=u.r,g=u.s;if(p.length>=130&&p.length<=134){if(p.length%2!=0)throw Error("unknown ECDSA sig r length error");if(g.length%2!=0)throw Error("unknown ECDSA sig s length error");p.substr(0,2)=="00"&&(p=p.substr(2)),g.substr(0,2)=="00"&&(g=g.substr(2));var m=Math.max(p.length,g.length);return(p=("000000"+p).slice(-m))+("000000"+g).slice(-m)}if(p.substr(0,2)=="00"&&p.length%32==2&&(p=p.substr(2)),g.substr(0,2)=="00"&&g.length%32==2&&(g=g.substr(2)),p.length%32==30&&(p="00"+p),g.length%32==30&&(g="00"+g),p.length%32!=0)throw Error("unknown ECDSA sig r length error");if(g.length%32!=0)throw Error("unknown ECDSA sig s length error");return p+g},b.crypto.ECDSA.concatSigToASN1Sig=function(a){if(a.length%4!=0)throw Error("unknown ECDSA concatinated r-s sig length error");var u=a.substr(0,a.length/2),p=a.substr(a.length/2);return b.crypto.ECDSA.hexRSSigToASN1Sig(u,p)},b.crypto.ECDSA.hexRSSigToASN1Sig=function(a,u){var p=new et(a,16),g=new et(u,16);return b.crypto.ECDSA.biRSSigToASN1Sig(p,g)},b.crypto.ECDSA.biRSSigToASN1Sig=function(a,u){var p=b.asn1,g=new p.DERInteger({bigint:a}),m=new p.DERInteger({bigint:u});return new p.DERSequence({array:[g,m]}).tohex()},b.crypto.ECDSA.getName=function(a){return a==="2b8104001f"?"secp192k1":a==="2a8648ce3d030107"?"secp256r1":a==="2b8104000a"?"secp256k1":a==="2b81040021"?"secp224r1":a==="2b81040022"?"secp384r1":a==="2b81040023"?"secp521r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(a)!==-1?"secp256r1":"|secp256k1|".indexOf(a)!==-1?"secp256k1":"|secp224r1|NIST P-224|P-224|".indexOf(a)!==-1?"secp224r1":"|secp384r1|NIST P-384|P-384|".indexOf(a)!==-1?"secp384r1":"|secp521r1|NIST P-521|P-521|".indexOf(a)!==-1?"secp521r1":null},b!==void 0&&b||(b={}),b.crypto!==void 0&&b.crypto||(b.crypto={}),b.crypto.ECParameterDB=new function(){var a={},u={};function p(g){return new et(g,16)}this.getByName=function(g){var m=g;if(u[m]!==void 0&&(m=u[g]),a[m]!==void 0)return a[m];throw"unregistered EC curve name: "+m},this.regist=function(g,m,w,O,R,P,B,q,L,k,H,W){a[g]={};var z=p(w),st=p(O),bt=p(R),It=p(P),Mt=p(B),Lt=new Kt(z,st,bt),tt=Lt.decodePointHex("04"+q+L);a[g].name=g,a[g].keylen=m,a[g].keycharlen=2*Math.ceil(m/8),a[g].curve=Lt,a[g].G=tt,a[g].n=It,a[g].h=Mt,a[g].oid=H,a[g].info=W;for(var ut=0;ut<k.length;ut++)u[k[ut]]=g}},b.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),b.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),b.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),b.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),b.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),b.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),b.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),b.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),b.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),b.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),b!==void 0&&b||(b={}),b.crypto!==void 0&&b.crypto||(b.crypto={}),b.crypto.DSA=function(){var a=Gt,u=(a.getVbyList,a.getVbyListEx),p=a.isASN1HEX,g=et;this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(m,w,O,R,P){this.isPrivate=!0,this.p=m,this.q=w,this.g=O,this.y=R,this.x=P},this.setPrivateHex=function(m,w,O,R,P){var B,q,L,k,H;B=new et(m,16),q=new et(w,16),L=new et(O,16),k=typeof R=="string"&&R.length>1?new et(R,16):null,H=new et(P,16),this.setPrivate(B,q,L,k,H)},this.setPublic=function(m,w,O,R){this.isPublic=!0,this.p=m,this.q=w,this.g=O,this.y=R,this.x=null},this.setPublicHex=function(m,w,O,R){var P,B,q,L;P=new et(m,16),B=new et(w,16),q=new et(O,16),L=new et(R,16),this.setPublic(P,B,q,L)},this.signWithMessageHash=function(m){var w=this.p,O=this.q,R=this.g,P=(this.y,this.x),B=b.crypto.Util.getRandomBigIntegerMinToMax(et.ONE.add(et.ONE),O.subtract(et.ONE)),q=new et(m.substr(0,O.bitLength()/4),16),L=R.modPow(B,w).mod(O),k=B.modInverse(O).multiply(q.add(P.multiply(L))).mod(O);return b.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:L}},{int:{bigint:k}}]})},this.verifyWithMessageHash=function(m,w){var O=this.p,R=this.q,P=this.g,B=this.y,q=this.parseASN1Signature(w),L=q[0],k=q[1],H=new et(m.substr(0,R.bitLength()/4),16);if(et.ZERO.compareTo(L)>0||L.compareTo(R)>0||et.ZERO.compareTo(k)>=0||k.compareTo(R)>0)throw"invalid DSA signature";var W=k.modInverse(R),z=H.multiply(W).mod(R),st=L.multiply(W).mod(R);return P.modPow(z,O).multiply(B.modPow(st,O)).mod(O).mod(R).compareTo(L)==0},this.parseASN1Signature=function(m){try{return[new g(u(m,0,[0],"02"),16),new g(u(m,0,[1],"02"),16)]}catch{throw new Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(m){var w,O,R,P,B;if(p(m)===!1)throw new Error("not ASN.1 hex string");try{w=u(m,0,[1],"02"),O=u(m,0,[2],"02"),R=u(m,0,[3],"02"),P=u(m,0,[4],"02"),B=u(m,0,[5],"02")}catch{throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(w,O,R,P,B)},this.readPKCS8PrvKeyHex=function(m){var w,O,R,P;if(p(m)===!1)throw new Error("not ASN.1 hex string");try{w=u(m,0,[1,1,0],"02"),O=u(m,0,[1,1,1],"02"),R=u(m,0,[1,1,2],"02"),P=u(m,0,[2,0],"02")}catch{throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(w,O,R,null,P)},this.readPKCS8PubKeyHex=function(m){var w,O,R,P;if(p(m)===!1)throw new Error("not ASN.1 hex string");try{w=u(m,0,[0,1,0],"02"),O=u(m,0,[0,1,1],"02"),R=u(m,0,[0,1,2],"02"),P=u(m,0,[1,0],"02")}catch{throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(w,O,R,P)},this.readCertPubKeyHex=function(m,w){var O,R,P,B;if(p(m)===!1)throw new Error("not ASN.1 hex string");try{O=u(m,0,[0,5,0,1,0],"02"),R=u(m,0,[0,5,0,1,1],"02"),P=u(m,0,[0,5,0,1,2],"02"),B=u(m,0,[0,5,1,0],"02")}catch{throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(O,R,P,B)}};var Te=function(){var a=function(P,B,q){return u(Y.AES,P,B,q)},u=function(P,B,q,L){var k=Y.enc.Hex.parse(B),H=Y.enc.Hex.parse(q),W=Y.enc.Hex.parse(L),z={};z.key=H,z.iv=W,z.ciphertext=k;var st=P.decrypt(z,H,{iv:W});return Y.enc.Hex.stringify(st)},p=function(P,B,q){return g(Y.AES,P,B,q)},g=function(P,B,q,L){var k=Y.enc.Hex.parse(B),H=Y.enc.Hex.parse(q),W=Y.enc.Hex.parse(L),z=P.encrypt(k,H,{iv:W}),st=Y.enc.Hex.parse(z.toString());return Y.enc.Base64.stringify(st)},m={"AES-256-CBC":{proc:a,eproc:p,keylen:32,ivlen:16},"AES-192-CBC":{proc:a,eproc:p,keylen:24,ivlen:16},"AES-128-CBC":{proc:a,eproc:p,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(P,B,q){return u(Y.TripleDES,P,B,q)},eproc:function(P,B,q){return g(Y.TripleDES,P,B,q)},keylen:24,ivlen:8},"DES-CBC":{proc:function(P,B,q){return u(Y.DES,P,B,q)},eproc:function(P,B,q){return g(Y.DES,P,B,q)},keylen:8,ivlen:8}},w=function(P){var B={},q=P.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));q&&(B.cipher=q[1],B.ivsalt=q[2]);var L=P.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));L&&(B.type=L[1]);var k=-1,H=0;P.indexOf(`\r
\r
`)!=-1&&(k=P.indexOf(`\r
\r
`),H=2),P.indexOf(`

`)!=-1&&(k=P.indexOf(`

`),H=1);var W=P.indexOf("-----END");if(k!=-1&&W!=-1){var z=P.substring(k+2*H,W-H);z=z.replace(/\s+/g,""),B.data=z}return B},O=function(P,B,q){for(var L=q.substring(0,16),k=Y.enc.Hex.parse(L),H=Y.enc.Utf8.parse(B),W=m[P].keylen+m[P].ivlen,z="",st=null;;){var bt=Y.algo.MD5.create();if(st!=null&&bt.update(st),bt.update(H),bt.update(k),st=bt.finalize(),(z+=Y.enc.Hex.stringify(st)).length>=2*W)break}var It={};return It.keyhex=z.substr(0,2*m[P].keylen),It.ivhex=z.substr(2*m[P].keylen,2*m[P].ivlen),It},R=function(P,B,q,L){var k=Y.enc.Base64.parse(P),H=Y.enc.Hex.stringify(k);return(0,m[B].proc)(H,q,L)};return{version:"1.0.0",parsePKCS5PEM:function(P){return w(P)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(P,B,q){return O(P,B,q)},decryptKeyB64:function(P,B,q,L){return R(P,B,q,L)},getDecryptedKeyHex:function(P,B){var q=w(P),L=(q.type,q.cipher),k=q.ivsalt,H=q.data,W=O(L,B,k).keyhex;return R(H,L,W,k)},getEncryptedPKCS5PEMFromPrvKeyHex:function(P,B,q,L,k){var H="";if(L!==void 0&&L!=null||(L="AES-256-CBC"),m[L]===void 0)throw new Error("KEYUTIL unsupported algorithm: "+L);k!==void 0&&k!=null||(k=function(z){var st=Y.lib.WordArray.random(z);return Y.enc.Hex.stringify(st)}(m[L].ivlen).toUpperCase());var W=function(z,st,bt,It){return(0,m[st].eproc)(z,bt,It)}(B,L,O(L,q,k).keyhex,k);return H="-----BEGIN "+P+` PRIVATE KEY-----\r
`,H+=`Proc-Type: 4,ENCRYPTED\r
`,H+="DEK-Info: "+L+","+k+`\r
`,H+=`\r
`,(H+=W.replace(/(.{64})/g,`$1\r
`))+`\r
-----END `+P+` PRIVATE KEY-----\r
`},getEncryptedPKCS8PEM:function(P,B,q){return Je(this.getEncryptedPKCS8Hex(P,B,q),"ENCRYPTED PRIVATE KEY")},getEncryptedPKCS8Hex:function(P,B,q){var L;(L=q==null||q==null?{}:JSON.parse(JSON.stringify(q))).plain=P,this.initPBES2Param(L),this.encryptPBES2Param(L,B);var k=this.generatePBES2ASN1Param(L);return b.asn1.ASN1Util.newObject(k).tohex()},initPBES2Param:function(P){var B;Ue(P,"encalg")==null&&(P.encalg="aes256-CBC"),Ue(P,"iter")==null&&(P.iter=2048),Ue(P,"prf")==null&&(P.prf="hmacWithSHA256"),Ue(P,"salt")==null&&(P.salt=Y.enc.Hex.stringify(Y.lib.WordArray.random(8))),Ue(P,"enciv")==null&&(P.encalg=="des-EDE3-CBC"&&(B=8),P.encalg=="aes128-CBC"&&(B=16),P.encalg=="aes256-CBC"&&(B=16),P.enciv=Y.enc.Hex.stringify(Y.lib.WordArray.random(B)))},encryptPBES2Param:function(P,B){var q=Te.getDKFromPBES2Param(P,B);try{var L=b.crypto.Cipher.encrypt(P.plain,q,P.encalg,{iv:P.enciv})}catch{throw new Error("encrypt error: "+P.plain+" "+q+" "+P.encalg+" "+P.enciv)}P.enc=L},generatePBES2ASN1Param:function(P){var B={seq:[{seq:[{oid:"pkcs5PBES2"},{seq:[{seq:[{oid:"pkcs5PBKDF2"},{seq:[{octstr:{hex:P.salt}},{int:{hex:gr(P.iter)}}]}]},{seq:[{oid:P.encalg},{octstr:{hex:P.enciv}}]}]}]},{octstr:{hex:P.enc}}]};return P.prf!="hmacWithSHA1"&&B.seq[0].seq[1].seq[0].seq[1].seq.push({seq:[{oid:P.prf},{null:""}]}),B},parseHexOfEncryptedPKCS8:function(P){var B=Gt,q=B.getChildIdx,L=B.getV,k={},H=q(P,0);if(H.length!=2)throw new Error("malformed format: SEQUENCE(0).items != 2: "+H.length);k.ciphertext=L(P,H[1]);var W=q(P,H[0]);if(W.length!=2)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+W.length);if(L(P,W[0])!="2a864886f70d01050d")throw new Error("this only supports pkcs5PBES2");var z=q(P,W[1]);if(W.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+z.length);var st=q(P,z[1]);if(st.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+st.length);if(L(P,st[0])!="2a864886f70d0307")throw"this only supports TripleDES";k.encryptionSchemeAlg="TripleDES",k.encryptionSchemeIV=L(P,st[1]);var bt=q(P,z[0]);if(bt.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+bt.length);if(L(P,bt[0])!="2a864886f70d01050c")throw new Error("this only supports pkcs5PBKDF2");var It=q(P,bt[1]);if(It.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+It.length);k.pbkdf2Salt=L(P,It[0]);var Mt=L(P,It[1]);try{k.pbkdf2Iter=parseInt(Mt,16)}catch{throw new Error("malformed format pbkdf2Iter: "+Mt)}return k},getPBKDF2KeyHexFromParam:function(P,B){var q=Y.enc.Hex.parse(P.pbkdf2Salt),L=P.pbkdf2Iter,k=Y.PBKDF2(B,q,{keySize:6,iterations:L});return Y.enc.Hex.stringify(k)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(P,B){var q=tr(P,"ENCRYPTED PRIVATE KEY"),L=this.parseHexOfEncryptedPKCS8(q),k=Te.getPBKDF2KeyHexFromParam(L,B),H={};H.ciphertext=Y.enc.Hex.parse(L.ciphertext);var W=Y.enc.Hex.parse(k),z=Y.enc.Hex.parse(L.encryptionSchemeIV),st=Y.TripleDES.decrypt(H,W,{iv:z});return Y.enc.Hex.stringify(st)},parsePBES2:function(P){var B=Gt.parse(P);if(Ue(B,"seq.0.seq.0.oid")!="pkcs5PBES2"||Ue(B,"seq.0.seq.1.seq.0.seq.0.oid")!="pkcs5PBKDF2")throw new Error("not pkcs5PBES2 and pkcs5PBKDF2 used");var q=Ue(B,"seq.0.seq.1.seq.0.seq.1.seq");if(q==null)throw new Error("PBKDF2 parameter not found");var L=Ue(q,"0.octstr.hex"),k=Ue(q,"1.int.hex"),H=Ue(q,"2.seq.0.oid","hmacWithSHA1"),W=-1;try{W=parseInt(k,16)}catch{throw new Error("iter not proper value")}var z=Ue(B,"seq.0.seq.1.seq.1.seq.0.oid"),st=Ue(B,"seq.0.seq.1.seq.1.seq.1.octstr.hex"),bt=Ue(B,"seq.1.octstr.hex");if(z==null||st==null||bt==null)throw new Error("encalg, enciv or enc is undefined");return{salt:L,iter:W,prf:H,encalg:z,enciv:st,enc:bt}},getDKFromPBES2Param:function(P,B){var q={hmacWithSHA1:Y.algo.SHA1,hmacWithSHA224:Y.algo.SHA224,hmacWithSHA256:Y.algo.SHA256,hmacWithSHA384:Y.algo.SHA384,hmacWithSHA512:Y.algo.SHA512}[P.prf];if(q==null)throw new Error("unsupported prf");var L={"des-EDE3-CBC":6,"aes128-CBC":4,"aes256-CBC":8}[P.encalg];if(L==null)throw new Error("unsupported encalg");var k=Y.enc.Hex.parse(P.salt),H=P.iter;try{var W=Y.PBKDF2(B,k,{keySize:L,iterations:H,hasher:q});return Y.enc.Hex.stringify(W)}catch(z){throw new Error("PBKDF2 error: "+z+" "+JSON.stringify(P)+" "+B)}},getPlainHexFromEncryptedPKCS8PEM:function(P,B){if(P.indexOf("BEGIN ENCRYPTED PRIVATE KEY")==-1)throw new Error("not Encrypted PKCS#8 PEM string");var q,L=tr(P);try{q=Te.parsePBES2(L)}catch(H){throw new Error("malformed PBES2 format: "+H.message)}var k=Te.getDKFromPBES2Param(q,B);return b.crypto.Cipher.decrypt(q.enc,k,q.encalg,{iv:q.enciv})},getKeyFromEncryptedPKCS8PEM:function(P,B){var q=this.getPlainHexFromEncryptedPKCS8PEM(P,B);return this.getKeyFromPlainPrivatePKCS8Hex(q)},parsePlainPrivatePKCS8Hex:function(P){var B=Gt,q=B.getChildIdx,L=B.getV,k={algparam:null};if(P.substr(0,2)!="30")throw new Error("malformed plain PKCS8 private key(code:001)");var H=q(P,0);if(H.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if(P.substr(H[1],2)!="30")throw new Error("malformed PKCS8 private key(code:003)");var W=q(P,H[1]);if(W.length!=2)throw new Error("malformed PKCS8 private key(code:004)");if(P.substr(W[0],2)!="06")throw new Error("malformed PKCS8 private key(code:005)");if(k.algoid=L(P,W[0]),P.substr(W[1],2)=="06"&&(k.algparam=L(P,W[1])),P.substr(H[2],2)!="04")throw new Error("malformed PKCS8 private key(code:006)");return k.keyidx=B.getVidx(P,H[2]),k},getKeyFromPlainPrivatePKCS8PEM:function(P){var B=tr(P,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(B)},getKeyFromPlainPrivatePKCS8Hex:function(P){var B,q=this.parsePlainPrivatePKCS8Hex(P);if(q.algoid=="2a864886f70d010101")B=new Bt;else if(q.algoid=="2a8648ce380401")B=new b.crypto.DSA;else{if(q.algoid!="2a8648ce3d0201")throw new Error("unsupported private key algorithm");B=new b.crypto.ECDSA}return B.readPKCS8PrvKeyHex(P),B},_getKeyFromPublicPKCS8Hex:function(P){var B,q=Gt.getVbyList(P,0,[0,0],"06");if(q==="2a864886f70d010101")B=new Bt;else if(q==="2a8648ce380401")B=new b.crypto.DSA;else{if(q!=="2a8648ce3d0201")throw new Error("unsupported PKCS#8 public key hex");B=new b.crypto.ECDSA}return B.readPKCS8PubKeyHex(P),B},parsePublicRawRSAKeyHex:function(P){var B=Gt,q=B.getChildIdx,L=B.getV,k={};if(P.substr(0,2)!="30")throw new Error("malformed RSA key(code:001)");var H=q(P,0);if(H.length!=2)throw new Error("malformed RSA key(code:002)");if(P.substr(H[0],2)!="02")throw new Error("malformed RSA key(code:003)");if(k.n=L(P,H[0]),P.substr(H[1],2)!="02")throw new Error("malformed RSA key(code:004)");return k.e=L(P,H[1]),k},parsePublicPKCS8Hex:function(P){var B=Gt,q=B.getChildIdx,L=B.getV,k={algparam:null},H=q(P,0);if(H.length!=2)throw new Error("outer DERSequence shall have 2 elements: "+H.length);var W=H[0];if(P.substr(W,2)!="30")throw new Error("malformed PKCS8 public key(code:001)");var z=q(P,W);if(z.length!=2)throw new Error("malformed PKCS8 public key(code:002)");if(P.substr(z[0],2)!="06")throw new Error("malformed PKCS8 public key(code:003)");if(k.algoid=L(P,z[0]),P.substr(z[1],2)=="06"?k.algparam=L(P,z[1]):P.substr(z[1],2)=="30"&&(k.algparam={},k.algparam.p=B.getVbyList(P,z[1],[0],"02"),k.algparam.q=B.getVbyList(P,z[1],[1],"02"),k.algparam.g=B.getVbyList(P,z[1],[2],"02")),P.substr(H[1],2)!="03")throw new Error("malformed PKCS8 public key(code:004)");return k.key=L(P,H[1]).substr(2),k}}}();function Jt(a,u){for(var p="",g=u/4-a.length,m=0;m<g;m++)p+="0";return p+a}function jn(a,u,p){for(var g="",m=0;g.length<u;)g+=hr(p(Sr(a+String.fromCharCode.apply(String,[(4278190080&m)>>24,(16711680&m)>>16,(65280&m)>>8,255&m])))),m+=1;return g}function Pn(a){for(var u in b.crypto.Util.DIGESTINFOHEAD){var p=b.crypto.Util.DIGESTINFOHEAD[u],g=p.length;if(a.substring(0,g)==p)return[u,a.substring(g)]}return[]}function Ee(a){var u,p=Gt,g=p.getChildIdx,m=p.getV,w=(p.dump,p.parse),O=p.getTLV,R=p.getVbyList,P=p.getVbyListEx,B=p.getTLVbyList,q=p.getTLVbyListEx,L=p.getIdxbyList,k=p.getIdxbyListEx,H=p.getVidx,W=p.getInt,z=p.oidname,st=p.hextooidstr,bt=tr,It=Error;try{u=b.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch{}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(this.hex===null||this.version!==0)return this.version;var tt=B(this.hex,0,[0,0]);if(tt.substr(0,2)=="a0"){var ut=B(tt,0,[0]),pt=W(ut,0);if(pt<0||2<pt)throw new Error("malformed version field");return this.version=pt+1,this.version}return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return P(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var tt=q(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(tt)},this.getAlgorithmIdentifierName=function(tt){for(var ut in u)if(tt===u[ut])return ut;return z(P(tt,0,[0],"06"))},this.getIssuer=function(tt,ut){return this.getX500Name(this.getIssuerHex(),tt,ut)},this.getIssuerHex=function(){return B(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return this.getIssuer().str},this.getSubject=function(tt,ut){return this.getX500Name(this.getSubjectHex(),tt,ut)},this.getSubjectHex=function(){return B(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return this.getSubject().str},this.getNotBefore=function(){var tt=R(this.hex,0,[0,4+this.foffset,0]);return tt=tt.replace(/(..)/g,"%$1"),decodeURIComponent(tt)},this.getNotAfter=function(){var tt=R(this.hex,0,[0,4+this.foffset,1]);return tt=tt.replace(/(..)/g,"%$1"),decodeURIComponent(tt)},this.getPublicKeyHex=function(){return this.getSPKI()},this.getSPKI=function(){return B(this.hex,0,[0,6+this.foffset],"30")},this.getSPKIValue=function(){var tt=this.getSPKI();return tt==null?null:R(tt,0,[1],"03",!0)},this.getPublicKeyIdx=function(){return L(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var tt=this.getPublicKeyIdx();return L(this.hex,tt,[1,0],"30")},this.getPublicKey=function(){return Te.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var tt=B(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(tt)},this.getSignatureValueHex=function(){return R(this.hex,0,[2],"03",!0)},this.verifySignature=function(tt){var ut=this.getSignatureAlgorithmField(),pt=this.getSignatureValueHex(),it=B(this.hex,0,[0],"30"),wt=new b.crypto.Signature({alg:ut});return wt.init(tt),wt.updateHex(it),wt.verify(pt)},this.parseExt=function(tt){var ut,pt,it;if(tt===void 0){if(it=this.hex,this.version!==3)return-1;ut=L(it,0,[0,7,0],"30"),pt=g(it,ut)}else{it=tr(tt);var wt=L(it,0,[0,3,0,0],"06");if(m(it,wt)!="2a864886f70d01090e")return void(this.aExtInfo=new Array);ut=L(it,0,[0,3,0,1,0],"30"),pt=g(it,ut),this.hex=it}this.aExtInfo=new Array;for(var $t=0;$t<pt.length;$t++){var Wt={critical:!1},Ht=0;g(it,pt[$t]).length===3&&(Wt.critical=!0,Ht=1),Wt.oid=p.hextooidstr(R(it,pt[$t],[0],"06"));var Se=L(it,pt[$t],[1+Ht]);Wt.vidx=H(it,Se),this.aExtInfo.push(Wt)}},this.getExtInfo=function(tt){var ut=this.aExtInfo,pt=tt;if(tt.match(/^[0-9.]+$/)||(pt=b.asn1.x509.OID.name2oid(tt)),pt!==""){for(var it=0;it<ut.length;it++)if(ut[it].oid===pt)return ut[it]}},this.getCriticalExtV=function(tt,ut,pt){if(ut!=null)return[ut,pt];var it=this.getExtInfo(tt);return it==null?[null,null]:[O(this.hex,it.vidx),it.critical]},this.getExtBasicConstraints=function(tt,ut){if(tt===void 0&&ut===void 0){var pt=this.getExtInfo("basicConstraints");if(pt===void 0)return;tt=O(this.hex,pt.vidx),ut=pt.critical}var it={extname:"basicConstraints"};if(ut&&(it.critical=!0),tt==="3000")return it;if(tt==="30030101ff")return it.cA=!0,it;if(tt.substr(0,12)==="30060101ff02"){var wt=m(tt,10),$t=parseInt(wt,16);return it.cA=!0,it.pathLen=$t,it}throw new Error("hExtV parse error: "+tt)},this.getExtNameConstraints=function(tt,ut){var pt=this.getCriticalExtV("nameConstraints",tt,ut);if(tt=pt[0],ut=pt[1],tt!=null){var it={extname:"nameConstraints"};ut&&(it.critical=!0);for(var wt=g(tt,0),$t=0;$t<wt.length;$t++){for(var Wt=[],Ht=g(tt,wt[$t]),Se=0;Se<Ht.length;Se++){var zt=O(tt,Ht[Se]),Q=this.getGeneralSubtree(zt);Wt.push(Q)}var ft=tt.substr(wt[$t],2);ft=="a0"?it.permit=Wt:ft=="a1"&&(it.exclude=Wt)}return it}},this.getGeneralSubtree=function(tt){var ut=g(tt,0),pt=ut.length;if(pt<1||2<pt)throw new Error("wrong num elements");for(var it=this.getGeneralName(O(tt,ut[0])),wt=1;wt<pt;wt++){var $t=tt.substr(ut[wt],2),Wt=m(tt,ut[wt]),Ht=parseInt(Wt,16);$t=="80"&&(it.min=Ht),$t=="81"&&(it.max=Ht)}return it},this.getExtKeyUsage=function(tt,ut){var pt=this.getCriticalExtV("keyUsage",tt,ut);if(tt=pt[0],ut=pt[1],tt!=null){var it={extname:"keyUsage"};return ut&&(it.critical=!0),it.names=this.getExtKeyUsageString(tt).split(","),it}},this.getExtKeyUsageBin=function(tt){if(tt===void 0){var ut=this.getExtInfo("keyUsage");if(ut===void 0)return"";tt=O(this.hex,ut.vidx)}if(tt.length!=8&&tt.length!=10)throw new Error("malformed key usage value: "+tt);var pt="000000000000000"+parseInt(tt.substr(6),16).toString(2);return tt.length==8&&(pt=pt.slice(-8)),tt.length==10&&(pt=pt.slice(-16)),(pt=pt.replace(/0+$/,""))==""&&(pt="0"),pt},this.getExtKeyUsageString=function(tt){for(var ut=this.getExtKeyUsageBin(tt),pt=new Array,it=0;it<ut.length;it++)ut.substr(it,1)=="1"&&pt.push(Ee.KEYUSAGE_NAME[it]);return pt.join(",")},this.getExtSubjectKeyIdentifier=function(tt,ut){if(tt===void 0&&ut===void 0){var pt=this.getExtInfo("subjectKeyIdentifier");if(pt===void 0)return;tt=O(this.hex,pt.vidx),ut=pt.critical}var it={extname:"subjectKeyIdentifier"};ut&&(it.critical=!0);var wt=m(tt,0);return it.kid={hex:wt},it},this.getExtAuthorityKeyIdentifier=function(tt,ut){if(tt===void 0&&ut===void 0){var pt=this.getExtInfo("authorityKeyIdentifier");if(pt===void 0)return;tt=O(this.hex,pt.vidx),ut=pt.critical}var it={extname:"authorityKeyIdentifier"};ut&&(it.critical=!0);for(var wt=g(tt,0),$t=0;$t<wt.length;$t++){var Wt=tt.substr(wt[$t],2);if(Wt==="80"&&(it.kid={hex:m(tt,wt[$t])}),Wt==="a1"){var Ht=O(tt,wt[$t]),Se=this.getGeneralNames(Ht);it.issuer=Se[0].dn}Wt==="82"&&(it.sn={hex:m(tt,wt[$t])})}return it},this.getExtExtKeyUsage=function(tt,ut){if(tt===void 0&&ut===void 0){var pt=this.getExtInfo("extKeyUsage");if(pt===void 0)return;tt=O(this.hex,pt.vidx),ut=pt.critical}var it={extname:"extKeyUsage",array:[]};ut&&(it.critical=!0);for(var wt=g(tt,0),$t=0;$t<wt.length;$t++)it.array.push(z(m(tt,wt[$t])));return it},this.getExtExtKeyUsageName=function(){var tt=this.getExtInfo("extKeyUsage");if(tt===void 0)return tt;var ut=new Array,pt=O(this.hex,tt.vidx);if(pt==="")return ut;for(var it=g(pt,0),wt=0;wt<it.length;wt++)ut.push(z(m(pt,it[wt])));return ut},this.getExtSubjectAltName=function(tt,ut){if(tt===void 0&&ut===void 0){var pt=this.getExtInfo("subjectAltName");if(pt===void 0)return;tt=O(this.hex,pt.vidx),ut=pt.critical}var it={extname:"subjectAltName",array:[]};return ut&&(it.critical=!0),it.array=this.getGeneralNames(tt),it},this.getExtIssuerAltName=function(tt,ut){if(tt===void 0&&ut===void 0){var pt=this.getExtInfo("issuerAltName");if(pt===void 0)return;tt=O(this.hex,pt.vidx),ut=pt.critical}var it={extname:"issuerAltName",array:[]};return ut&&(it.critical=!0),it.array=this.getGeneralNames(tt),it},this.getGeneralNames=function(tt){for(var ut=g(tt,0),pt=[],it=0;it<ut.length;it++){var wt=this.getGeneralName(O(tt,ut[it]));wt!==void 0&&pt.push(wt)}return pt},this.getGeneralName=function(tt){var ut=tt.substr(0,2),pt=m(tt,0),it=hr(pt);return ut=="81"?{rfc822:it}:ut=="82"?{dns:it}:ut=="86"?{uri:it}:ut=="87"?{ip:ye(pt)}:ut=="a4"?{dn:this.getX500Name(pt)}:ut=="a0"?{other:this.getOtherName(tt)}:void 0},this.getExtSubjectAltName2=function(){var tt,ut,pt,it=this.getExtInfo("subjectAltName");if(it===void 0)return it;for(var wt=new Array,$t=O(this.hex,it.vidx),Wt=g($t,0),Ht=0;Ht<Wt.length;Ht++)pt=$t.substr(Wt[Ht],2),tt=m($t,Wt[Ht]),pt==="81"&&(ut=Le(tt),wt.push(["MAIL",ut])),pt==="82"&&(ut=Le(tt),wt.push(["DNS",ut])),pt==="84"&&(ut=Ee.hex2dn(tt,0),wt.push(["DN",ut])),pt==="86"&&(ut=Le(tt),wt.push(["URI",ut])),pt==="87"&&(ut=ye(tt),wt.push(["IP",ut]));return wt},this.getExtCRLDistributionPoints=function(tt,ut){if(tt===void 0&&ut===void 0){var pt=this.getExtInfo("cRLDistributionPoints");if(pt===void 0)return;tt=O(this.hex,pt.vidx),ut=pt.critical}var it={extname:"cRLDistributionPoints",array:[]};ut&&(it.critical=!0);for(var wt=g(tt,0),$t=0;$t<wt.length;$t++){var Wt=O(tt,wt[$t]);it.array.push(this.getDistributionPoint(Wt))}return it},this.getDistributionPoint=function(tt){for(var ut={},pt=g(tt,0),it=0;it<pt.length;it++){var wt=tt.substr(pt[it],2),$t=O(tt,pt[it]);wt=="a0"&&(ut.dpname=this.getDistributionPointName($t))}return ut},this.getDistributionPointName=function(tt){for(var ut={},pt=g(tt,0),it=0;it<pt.length;it++){var wt=tt.substr(pt[it],2),$t=O(tt,pt[it]);wt=="a0"&&(ut.full=this.getGeneralNames($t))}return ut},this.getExtCRLDistributionPointsURI=function(){var tt=this.getExtCRLDistributionPoints();if(tt==null)return tt;for(var ut=tt.array,pt=[],it=0;it<ut.length;it++)try{ut[it].dpname.full[0].uri!=null&&pt.push(ut[it].dpname.full[0].uri)}catch{}return pt},this.getExtAIAInfo=function(){var tt=this.getExtInfo("authorityInfoAccess");if(tt===void 0)return tt;for(var ut={ocsp:[],caissuer:[]},pt=g(this.hex,tt.vidx),it=0;it<pt.length;it++){var wt=R(this.hex,pt[it],[0],"06"),$t=R(this.hex,pt[it],[1],"86");wt==="2b06010505073001"&&ut.ocsp.push(Le($t)),wt==="2b06010505073002"&&ut.caissuer.push(Le($t))}return ut},this.getExtAuthorityInfoAccess=function(tt,ut){if(tt===void 0&&ut===void 0){var pt=this.getExtInfo("authorityInfoAccess");if(pt===void 0)return;tt=O(this.hex,pt.vidx),ut=pt.critical}var it={extname:"authorityInfoAccess",array:[]};ut&&(it.critical=!0);for(var wt=g(tt,0),$t=0;$t<wt.length;$t++){var Wt=P(tt,wt[$t],[0],"06"),Ht=Le(R(tt,wt[$t],[1],"86"));if(Wt=="2b06010505073001")it.array.push({ocsp:Ht});else{if(Wt!="2b06010505073002")throw new Error("unknown method: "+Wt);it.array.push({caissuer:Ht})}}return it},this.getExtCertificatePolicies=function(tt,ut){if(tt===void 0&&ut===void 0){var pt=this.getExtInfo("certificatePolicies");if(pt===void 0)return;tt=O(this.hex,pt.vidx),ut=pt.critical}var it={extname:"certificatePolicies",array:[]};ut&&(it.critical=!0);for(var wt=g(tt,0),$t=0;$t<wt.length;$t++){var Wt=O(tt,wt[$t]),Ht=this.getPolicyInformation(Wt);it.array.push(Ht)}return it},this.getPolicyInformation=function(tt){var ut={},pt=R(tt,0,[0],"06");ut.policyoid=z(pt);var it=k(tt,0,[1],"30");if(it!=-1){ut.array=[];for(var wt=g(tt,it),$t=0;$t<wt.length;$t++){var Wt=O(tt,wt[$t]),Ht=this.getPolicyQualifierInfo(Wt);ut.array.push(Ht)}}return ut},this.getOtherName=function(tt){var ut={},pt=g(tt,0),it=R(tt,pt[0],[],"06"),wt=R(tt,pt[1],[]);return ut.oid=z(it),ut.value=w(wt),ut},this.getPolicyQualifierInfo=function(tt){var ut={},pt=R(tt,0,[0],"06");if(pt==="2b06010505070201"){var it=P(tt,0,[1],"16");ut.cps=hr(it)}else if(pt==="2b06010505070202"){var wt=B(tt,0,[1],"30");ut.unotice=this.getUserNotice(wt)}return ut},this.getUserNotice=function(tt){var ut=null;try{return ut=p.parse(tt),this._asn1ToUnotice(ut)}catch{return}},this._asn1ToUnotice=function(tt){try{for(var ut={},pt=Ue(tt,"seq"),it=0;it<pt.length;it++){var wt=this._asn1ToNoticeRef(pt[it]);wt!=null&&(ut.noticeref=wt);var $t=this.asn1ToDisplayText(pt[it]);$t!=null&&(ut.exptext=$t)}return Object.keys(ut).length>0?ut:void 0}catch{return}},this._asn1ToNoticeRef=function(tt){try{for(var ut={},pt=Ue(tt,"seq"),it=0;it<pt.length;it++){var wt=this._asn1ToNoticeNum(pt[it]);wt!=null&&(ut.noticenum=wt);var $t=this.asn1ToDisplayText(pt[it]);$t!=null&&(ut.org=$t)}return Object.keys(ut).length>0?ut:void 0}catch{return}},this._asn1ToNoticeNum=function(tt){try{for(var ut=Ue(tt,"seq"),pt=[],it=0;it<ut.length;it++){var wt=ut[it];pt.push(parseInt(Ue(wt,"int.hex"),16))}return pt}catch{return}},this.getDisplayText=function(tt){var ut={};return ut.type={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"}[tt.substr(0,2)],ut.str=hr(m(tt,0)),ut},this.asn1ToDisplayText=function(tt){return tt.utf8str!=null?{type:"utf8",str:tt.utf8str.str}:tt.ia5str!=null?{type:"ia5",str:tt.ia5str.str}:tt.visstr!=null?{type:"vis",str:tt.visstr.str}:tt.bmpstr!=null?{type:"bmp",str:tt.bmpstr.str}:tt.prnstr!=null?{type:"prn",str:tt.prnstr.str}:void 0},this.getExtPolicyMappings=function(tt,ut){var pt=this.getCriticalExtV("policyMappings",tt,ut);if(tt=pt[0],ut=pt[1],tt!=null){var it={extname:"policyMappings"};ut&&(it.critical=!0);try{for(var wt=w(tt).seq,$t=[],Wt=0;Wt<wt.length;Wt++){var Ht=wt[Wt].seq;$t.push([Ht[0].oid,Ht[1].oid])}it.array=$t}catch{throw new It("malformed policyMappings")}return it}},this.getExtPolicyConstraints=function(tt,ut){var pt=this.getCriticalExtV("policyConstraints",tt,ut);if(tt=pt[0],ut=pt[1],tt!=null){var it={extname:"policyConstraints"};ut&&(it.critical=!0);var wt=w(tt);try{for(var $t=wt.seq,Wt=0;Wt<$t.length;Wt++){var Ht=$t[Wt].tag;Ht.explicit==0&&(Ht.tag=="80"&&(it.reqexp=parseInt(Ht.hex,16)),Ht.tag=="81"&&(it.inhibit=parseInt(Ht.hex,16)))}}catch{return new It("malformed policyConstraints value")}return it}},this.getExtInhibitAnyPolicy=function(tt,ut){var pt=this.getCriticalExtV("inhibitAnyPolicy",tt,ut);if(tt=pt[0],ut=pt[1],tt!=null){var it={extname:"inhibitAnyPolicy"};ut&&(it.critical=!0);var wt=W(tt,0);return wt==-1?new It("wrong value"):(it.skip=wt,it)}},this.getExtCRLNumber=function(tt,ut){var pt={extname:"cRLNumber"};if(ut&&(pt.critical=!0),tt.substr(0,2)=="02")return pt.num={hex:m(tt,0)},pt;throw new It("hExtV parse error: "+tt)},this.getExtCRLReason=function(tt,ut){var pt={extname:"cRLReason"};if(ut&&(pt.critical=!0),tt.substr(0,2)=="0a")return pt.code=parseInt(m(tt,0),16),pt;throw new Error("hExtV parse error: "+tt)},this.getExtOcspNonce=function(tt,ut){var pt={extname:"ocspNonce"};ut&&(pt.critical=!0);var it=m(tt,0);return pt.hex=it,pt},this.getExtOcspNoCheck=function(tt,ut){var pt={extname:"ocspNoCheck"};return ut&&(pt.critical=!0),pt},this.getExtAdobeTimeStamp=function(tt,ut){if(tt===void 0&&ut===void 0){var pt=this.getExtInfo("adobeTimeStamp");if(pt===void 0)return;tt=O(this.hex,pt.vidx),ut=pt.critical}var it={extname:"adobeTimeStamp"};ut&&(it.critical=!0);var wt=g(tt,0);if(wt.length>1){var $t=O(tt,wt[1]),Wt=this.getGeneralName($t);Wt.uri!=null&&(it.uri=Wt.uri)}if(wt.length>2){var Ht=O(tt,wt[2]);Ht=="0101ff"&&(it.reqauth=!0),Ht=="010100"&&(it.reqauth=!1)}return it},this.getExtSubjectDirectoryAttributes=function(tt,ut){if(tt===void 0&&ut===void 0){var pt=this.getExtInfo("subjectDirectoryAttributes");if(pt===void 0)return;tt=O(this.hex,pt.vidx),ut=pt.critical}var it={extname:"subjectDirectoryAttributes"};ut&&(it.critical=!0);try{for(var wt=w(tt),$t=[],Wt=0;Wt<wt.seq.length;Wt++){var Ht=wt.seq[Wt],Se=Ue(Ht,"seq.0.oid"),zt=Ue(Ht,"seq.1.set");if(Se==null||zt==null)throw"error";$t.push({attr:Se,array:zt})}return it.array=$t,it}catch{throw new Error("malformed subjectDirectoryAttributes extension value")}};var Mt=function(tt){var ut={};try{var pt=tt.seq[0].oid,it=b.asn1.x509.OID.name2oid(pt);ut.type=b.asn1.x509.OID.oid2atype(it);var wt=tt.seq[1];if(wt.utf8str!=null)ut.ds="utf8",ut.value=wt.utf8str.str;else if(wt.numstr!=null)ut.ds="num",ut.value=wt.numstr.str;else if(wt.telstr!=null)ut.ds="tel",ut.value=wt.telstr.str;else if(wt.prnstr!=null)ut.ds="prn",ut.value=wt.prnstr.str;else if(wt.ia5str!=null)ut.ds="ia5",ut.value=wt.ia5str.str;else if(wt.visstr!=null)ut.ds="vis",ut.value=wt.visstr.str;else{if(wt.bmpstr==null)throw"error";ut.ds="bmp",ut.value=wt.bmpstr.str}return ut}catch{throw new Erorr("improper ASN.1 parsed AttrTypeAndValue")}},Lt=function(tt){try{return tt.set.map(function(ut){return Mt(ut)})}catch(ut){throw new Error("improper ASN.1 parsed RDN: "+ut)}};this.getX500NameRule=function(tt){for(var ut=null,pt=[],it=0;it<tt.length;it++)for(var wt=tt[it],$t=0;$t<wt.length;$t++)pt.push(wt[$t]);for(it=0;it<pt.length;it++){var Wt=pt[it],Ht=Wt.ds,Se=Wt.value,zt=Wt.type;if(Ht!="prn"&&Ht!="utf8"&&Ht!="ia5")return"mixed";if(Ht=="ia5"){if(zt!="CN")return"mixed";if(b.lang.String.isMail(Se))continue;return"mixed"}if(zt=="C"){if(Ht=="prn")continue;return"mixed"}if(ut==null)ut=Ht;else if(ut!==Ht)return"mixed"}return ut??"prn"},this.getAttrTypeAndValue=function(tt){var ut=w(tt);return Mt(ut)},this.getRDN=function(tt){var ut=w(tt);return Lt(ut)},this.getX500NameArray=function(tt){return function(ut){try{return ut.seq.map(function(pt){return Lt(pt)})}catch(pt){throw new Error("improper ASN.1 parsed X500Name: "+pt)}}(w(tt))},this.getX500Name=function(tt,ut,pt){var it=this.getX500NameArray(tt),wt={str:this.dnarraytostr(it)};return wt.array=it,pt==1&&(wt.hex=tt),ut==1&&(wt.canon=this.c14nRDNArray(it)),wt},this.readCertPEM=function(tt){this.readCertHex(bt(tt))},this.readCertHex=function(tt){this.hex=tt,this.getVersion();try{L(this.hex,0,[0,7],"a3"),this.parseExt()}catch{}},this.getParam=function(tt){var ut={};return tt==null&&(tt={}),ut.version=this.getVersion(),ut.serial={hex:this.getSerialNumberHex()},ut.sigalg=this.getSignatureAlgorithmField(),ut.issuer=this.getIssuer(tt.dncanon,tt.dnhex),ut.notbefore=this.getNotBefore(),ut.notafter=this.getNotAfter(),ut.subject=this.getSubject(tt.dncanon,tt.dnhex),ut.sbjpubkey=Je(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo!=null&&this.aExtInfo.length>0&&(ut.ext=this.getExtParamArray()),ut.sighex=this.getSignatureValueHex(),tt.tbshex==1&&(ut.tbshex=B(this.hex,0,[0])),tt.nodnarray==1&&(delete ut.issuer.array,delete ut.subject.array),ut},this.getExtParamArray=function(tt){tt==null&&k(this.hex,0,[0,"[3]"])!=-1&&(tt=q(this.hex,0,[0,"[3]",0],"30"));for(var ut=[],pt=g(tt,0),it=0;it<pt.length;it++){var wt=O(tt,pt[it]),$t=this.getExtParam(wt);$t!=null&&ut.push($t)}return ut},this.getExtParam=function(tt){var ut=g(tt,0).length;if(ut!=2&&ut!=3)throw new Error("wrong number elements in Extension: "+ut+" "+tt);var pt=st(R(tt,0,[0],"06")),it=!1;ut==3&&B(tt,0,[1])=="0101ff"&&(it=!0);var wt=B(tt,0,[ut-1,0]),$t=void 0;if(pt=="2.5.29.14"?$t=this.getExtSubjectKeyIdentifier(wt,it):pt=="2.5.29.15"?$t=this.getExtKeyUsage(wt,it):pt=="2.5.29.17"?$t=this.getExtSubjectAltName(wt,it):pt=="2.5.29.18"?$t=this.getExtIssuerAltName(wt,it):pt=="2.5.29.19"?$t=this.getExtBasicConstraints(wt,it):pt=="2.5.29.30"?$t=this.getExtNameConstraints(wt,it):pt=="2.5.29.31"?$t=this.getExtCRLDistributionPoints(wt,it):pt=="2.5.29.32"?$t=this.getExtCertificatePolicies(wt,it):pt=="2.5.29.33"?$t=this.getExtPolicyMappings(wt,it):pt=="2.5.29.35"?$t=this.getExtAuthorityKeyIdentifier(wt,it):pt=="2.5.29.36"?$t=this.getExtPolicyConstraints(wt,it):pt=="2.5.29.37"?$t=this.getExtExtKeyUsage(wt,it):pt=="2.5.29.54"?$t=this.getExtInhibitAnyPolicy(wt,it):pt=="1.3.6.1.5.5.7.1.1"?$t=this.getExtAuthorityInfoAccess(wt,it):pt=="2.5.29.20"?$t=this.getExtCRLNumber(wt,it):pt=="2.5.29.21"?$t=this.getExtCRLReason(wt,it):pt=="2.5.29.9"?$t=this.getExtSubjectDirectoryAttributes(wt,it):pt=="1.3.6.1.5.5.7.48.1.2"?$t=this.getExtOcspNonce(wt,it):pt=="1.3.6.1.5.5.7.48.1.5"?$t=this.getExtOcspNoCheck(wt,it):pt=="1.2.840.113583.1.1.9.1"?$t=this.getExtAdobeTimeStamp(wt,it):Ee.EXT_PARSER[pt]!=null&&($t=Ee.EXT_PARSER[pt](pt,it,wt)),$t!=null)return $t;var Wt={extname:pt,extn:wt};try{Wt.extn=w(wt)}catch{}return it&&(Wt.critical=!0),Wt},this.findExt=function(tt,ut){for(var pt=0;pt<tt.length;pt++)if(tt[pt].extname==ut)return tt[pt];return null},this.updateExtCDPFullURI=function(tt,ut){var pt=this.findExt(tt,"cRLDistributionPoints");if(pt!=null&&pt.array!=null){for(var it=pt.array,wt=0;wt<it.length;wt++)if(it[wt].dpname!=null&&it[wt].dpname.full!=null)for(var $t=it[wt].dpname.full,Wt=0;Wt<$t.length;Wt++){var Ht=$t[wt];Ht.uri!=null&&(Ht.uri=ut)}}},this.updateExtAIAOCSP=function(tt,ut){var pt=this.findExt(tt,"authorityInfoAccess");if(pt!=null&&pt.array!=null)for(var it=pt.array,wt=0;wt<it.length;wt++)it[wt].ocsp!=null&&(it[wt].ocsp=ut)},this.updateExtAIACAIssuer=function(tt,ut){var pt=this.findExt(tt,"authorityInfoAccess");if(pt!=null&&pt.array!=null)for(var it=pt.array,wt=0;wt<it.length;wt++)it[wt].caissuer!=null&&(it[wt].caissuer=ut)},this.dnarraytostr=function(tt){return"/"+tt.map(function(ut){return function(pt){return pt.map(function(it){return(wt=it,wt.type+"="+wt.value).replace(/\+/,"\\+");var wt}).join("+")}(ut).replace(/\//,"\\/")}).join("/")},this.setCanonicalizedDN=function(tt){var ut;if(tt.str!=null&&tt.array==null){var pt=new b.asn1.x509.X500Name({str:tt.str}).tohex();ut=this.getX500NameArray(pt)}else ut=tt.array;tt.canon==null&&(tt.canon=this.c14nRDNArray(ut))},this.c14nRDNArray=function(tt){for(var ut=[],pt=0;pt<tt.length;pt++){for(var it=tt[pt],wt=[],$t=0;$t<it.length;$t++){var Wt=it[$t],Ht=Wt.value;Ht=(Ht=(Ht=(Ht=Ht.replace(/^\s*/,"")).replace(/\s*$/,"")).replace(/\s+/g," ")).toLowerCase(),wt.push(Wt.type.toLowerCase()+"="+Ht)}ut.push(wt.join("+"))}return"/"+ut.join("/")},this.getInfo=function(){var tt,ut,pt,it=function(Ft){for(var Nt="",re="    ",te=`
`,St=Ft.array,kt=0;kt<St.length;kt++){var Tt=St[kt];Tt.dn!=null&&(Nt+=re+"dn: "+Tt.dn.str+te),Tt.ip!=null&&(Nt+=re+"ip: "+Tt.ip+te),Tt.rfc822!=null&&(Nt+=re+"rfc822: "+Tt.rfc822+te),Tt.dns!=null&&(Nt+=re+"dns: "+Tt.dns+te),Tt.uri!=null&&(Nt+=re+"uri: "+Tt.uri+te),Tt.other!=null&&(Nt+=re+"other: "+Tt.other.oid+"="+JSON.stringify(Tt.other.value).replace(/\"/g,"")+te)}return Nt.replace(/\n$/,"")},wt=function(Ft){for(var Nt="",re=Ft.array,te=0;te<re.length;te++){var St=re[te];if(Nt+="    policy oid: "+St.policyoid+`
`,St.array!==void 0)for(var kt=0;kt<St.array.length;kt++){var Tt=St.array[kt];Tt.cps!==void 0&&(Nt+="    cps: "+Tt.cps+`
`)}}return Nt},$t=function(Ft){for(var Nt="",re=Ft.array,te=0;te<re.length;te++){var St=re[te];try{St.dpname.full[0].uri!==void 0&&(Nt+="    "+St.dpname.full[0].uri+`
`)}catch{}try{St.dname.full[0].dn.hex!==void 0&&(Nt+="    "+Ee.hex2dn(St.dpname.full[0].dn.hex)+`
`)}catch{}}return Nt},Wt=function(Ft){for(var Nt="",re=Ft.array,te=0;te<re.length;te++){var St=re[te];St.caissuer!==void 0&&(Nt+="    caissuer: "+St.caissuer+`
`),St.ocsp!==void 0&&(Nt+="    ocsp: "+St.ocsp+`
`)}return Nt};if(tt=`Basic Fields
`,tt+="  serial number: "+this.getSerialNumberHex()+`
`,tt+="  signature algorithm: "+this.getSignatureAlgorithmField()+`
`,tt+="  issuer: "+this.getIssuerString()+`
`,tt+="  notBefore: "+this.getNotBefore()+`
`,tt+="  notAfter: "+this.getNotAfter()+`
`,tt+="  subject: "+this.getSubjectString()+`
`,tt+=`  subject public key info: 
`,tt+="    key algorithm: "+(ut=this.getPublicKey()).type+`
`,ut.type==="RSA"&&(tt+="    n="+X(ut.n.toString(16)).substr(0,16)+`...
`,tt+="    e="+X(ut.e.toString(16))+`
`),(pt=this.aExtInfo)!=null){tt+=`X509v3 Extensions:
`;for(var Ht=0;Ht<pt.length;Ht++){var Se=pt[Ht],zt=b.asn1.x509.OID.oid2name(Se.oid);zt===""&&(zt=Se.oid);var Q="";if(Se.critical===!0&&(Q="CRITICAL"),tt+="  "+zt+" "+Q+`:
`,zt==="basicConstraints"){var ft=this.getExtBasicConstraints();ft.cA===void 0?tt+=`    {}
`:(tt+="    cA=true",ft.pathLen!==void 0&&(tt+=", pathLen="+ft.pathLen),tt+=`
`)}else{var vt;if(zt=="policyMappings")tt+="    "+this.getExtPolicyMappings().array.map(function(Ft){var Nt=Ft;return Nt[0]+":"+Nt[1]}).join(", ")+`
`;else if(zt=="policyConstraints")tt+="    ",(vt=this.getExtPolicyConstraints()).reqexp!=null&&(tt+=" reqexp="+vt.reqexp),vt.inhibit!=null&&(tt+=" inhibit="+vt.inhibit),tt+=`
`;else if(zt=="inhibitAnyPolicy")tt+="    skip="+(vt=this.getExtInhibitAnyPolicy()).skip+`
`;else if(zt=="keyUsage")tt+="    "+this.getExtKeyUsageString()+`
`;else if(zt=="subjectKeyIdentifier")tt+="    "+this.getExtSubjectKeyIdentifier().kid.hex+`
`;else if(zt=="authorityKeyIdentifier"){var Rt=this.getExtAuthorityKeyIdentifier();Rt.kid!==void 0&&(tt+="    kid="+Rt.kid.hex+`
`)}else zt=="extKeyUsage"?tt+="    "+this.getExtExtKeyUsage().array.join(", ")+`
`:zt=="subjectAltName"?tt+=it(this.getExtSubjectAltName())+`
`:zt=="cRLDistributionPoints"?tt+=$t(this.getExtCRLDistributionPoints()):zt=="authorityInfoAccess"?tt+=Wt(this.getExtAuthorityInfoAccess()):zt=="certificatePolicies"&&(tt+=wt(this.getExtCertificatePolicies()))}}}return(tt+="signature algorithm: "+this.getSignatureAlgorithmName()+`
`)+"signature: "+this.getSignatureValueHex().substr(0,16)+`...
`},typeof a=="string"&&(a.indexOf("-----BEGIN")!=-1?this.readCertPEM(a):b.lang.String.isHex(a)&&this.readCertHex(a))}Te.getKey=function(a,u,p){var g,m=(bt=Gt).getChildIdx,w=(bt.getV,bt.getVbyList),O=b.crypto,R=O.ECDSA,P=O.DSA,B=Bt,q=tr,L=Te;if(B!==void 0&&a instanceof B||R!==void 0&&a instanceof R||P!==void 0&&a instanceof P)return a;if(a.curve!==void 0&&a.xy!==void 0&&a.d===void 0)return new R({pub:a.xy,curve:a.curve});if(a.curve!==void 0&&a.d!==void 0)return new R({prv:a.d,curve:a.curve});if(a.kty===void 0&&a.n!==void 0&&a.e!==void 0&&a.d===void 0)return(Ht=new B).setPublic(a.n,a.e),Ht;if(a.kty===void 0&&a.n!==void 0&&a.e!==void 0&&a.d!==void 0&&a.p!==void 0&&a.q!==void 0&&a.dp!==void 0&&a.dq!==void 0&&a.co!==void 0&&a.qi===void 0)return(Ht=new B).setPrivateEx(a.n,a.e,a.d,a.p,a.q,a.dp,a.dq,a.co),Ht;if(a.kty===void 0&&a.n!==void 0&&a.e!==void 0&&a.d!==void 0&&a.p===void 0)return(Ht=new B).setPrivate(a.n,a.e,a.d),Ht;if(a.p!==void 0&&a.q!==void 0&&a.g!==void 0&&a.y!==void 0&&a.x===void 0)return(Ht=new P).setPublic(a.p,a.q,a.g,a.y),Ht;if(a.p!==void 0&&a.q!==void 0&&a.g!==void 0&&a.y!==void 0&&a.x!==void 0)return(Ht=new P).setPrivate(a.p,a.q,a.g,a.y,a.x),Ht;if(a.kty==="RSA"&&a.n!==void 0&&a.e!==void 0&&a.d===void 0)return(Ht=new B).setPublic(Ke(a.n),Ke(a.e)),Ht;if(a.kty==="RSA"&&a.n!==void 0&&a.e!==void 0&&a.d!==void 0&&a.p!==void 0&&a.q!==void 0&&a.dp!==void 0&&a.dq!==void 0&&a.qi!==void 0)return(Ht=new B).setPrivateEx(Ke(a.n),Ke(a.e),Ke(a.d),Ke(a.p),Ke(a.q),Ke(a.dp),Ke(a.dq),Ke(a.qi)),Ht;if(a.kty==="RSA"&&a.n!==void 0&&a.e!==void 0&&a.d!==void 0)return(Ht=new B).setPrivate(Ke(a.n),Ke(a.e),Ke(a.d)),Ht;if(a.kty==="EC"&&a.crv!==void 0&&a.x!==void 0&&a.y!==void 0&&a.d===void 0){var k=(Wt=new R({curve:a.crv})).ecparams.keycharlen,H="04"+("0000000000"+Ke(a.x)).slice(-k)+("0000000000"+Ke(a.y)).slice(-k);return Wt.setPublicKeyHex(H),Wt}if(a.kty==="EC"&&a.crv!==void 0&&a.x!==void 0&&a.y!==void 0&&a.d!==void 0){k=(Wt=new R({curve:a.crv})).ecparams.keycharlen,H="04"+("0000000000"+Ke(a.x)).slice(-k)+("0000000000"+Ke(a.y)).slice(-k);var W=("0000000000"+Ke(a.d)).slice(-k);return Wt.setPublicKeyHex(H),Wt.setPrivateKeyHex(W),Wt}if(p==="pkcs5prv"){var z,st=a,bt=Gt;if((z=m(st,0)).length===9)(Ht=new B).readPKCS5PrvKeyHex(st);else if(z.length===6)(Ht=new P).readPKCS5PrvKeyHex(st);else{if(!(z.length>2&&st.substr(z[1],2)==="04"))throw new Error("unsupported PKCS#1/5 hexadecimal key");(Ht=new R).readPKCS5PrvKeyHex(st)}return Ht}if(p==="pkcs8prv")return L.getKeyFromPlainPrivatePKCS8Hex(a);if(p==="pkcs8pub")return L._getKeyFromPublicPKCS8Hex(a);if(p==="x509pub")return Ee.getPublicKeyFromCertHex(a);if(a.indexOf("-END CERTIFICATE-",0)!=-1||a.indexOf("-END X509 CERTIFICATE-",0)!=-1||a.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return Ee.getPublicKeyFromCertPEM(a);if(a.indexOf("-END PUBLIC KEY-")!=-1){var It=tr(a,"PUBLIC KEY");return L._getKeyFromPublicPKCS8Hex(It)}if(a.indexOf("-END RSA PRIVATE KEY-")!=-1&&a.indexOf("4,ENCRYPTED")==-1){var Mt=q(a,"RSA PRIVATE KEY");return L.getKey(Mt,null,"pkcs5prv")}if(a.indexOf("-END DSA PRIVATE KEY-")!=-1&&a.indexOf("4,ENCRYPTED")==-1){var Lt=w(g=q(a,"DSA PRIVATE KEY"),0,[1],"02"),tt=w(g,0,[2],"02"),ut=w(g,0,[3],"02"),pt=w(g,0,[4],"02"),it=w(g,0,[5],"02");return(Ht=new P).setPrivate(new et(Lt,16),new et(tt,16),new et(ut,16),new et(pt,16),new et(it,16)),Ht}if(a.indexOf("-END EC PRIVATE KEY-")!=-1&&a.indexOf("4,ENCRYPTED")==-1)return Mt=q(a,"EC PRIVATE KEY"),L.getKey(Mt,null,"pkcs5prv");if(a.indexOf("-END PRIVATE KEY-")!=-1)return L.getKeyFromPlainPrivatePKCS8PEM(a);if(a.indexOf("-END RSA PRIVATE KEY-")!=-1&&a.indexOf("4,ENCRYPTED")!=-1){var wt=L.getDecryptedKeyHex(a,u),$t=new Bt;return $t.readPKCS5PrvKeyHex(wt),$t}if(a.indexOf("-END EC PRIVATE KEY-")!=-1&&a.indexOf("4,ENCRYPTED")!=-1){var Wt,Ht=w(g=L.getDecryptedKeyHex(a,u),0,[1],"04"),Se=w(g,0,[2,0],"06"),zt=w(g,0,[3,0],"03").substr(2);if(b.crypto.OID.oidhex2name[Se]===void 0)throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+Se);return(Wt=new R({curve:b.crypto.OID.oidhex2name[Se]})).setPublicKeyHex(zt),Wt.setPrivateKeyHex(Ht),Wt.isPublic=!1,Wt}if(a.indexOf("-END DSA PRIVATE KEY-")!=-1&&a.indexOf("4,ENCRYPTED")!=-1)return Lt=w(g=L.getDecryptedKeyHex(a,u),0,[1],"02"),tt=w(g,0,[2],"02"),ut=w(g,0,[3],"02"),pt=w(g,0,[4],"02"),it=w(g,0,[5],"02"),(Ht=new P).setPrivate(new et(Lt,16),new et(tt,16),new et(ut,16),new et(pt,16),new et(it,16)),Ht;if(a.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return L.getKeyFromEncryptedPKCS8PEM(a,u);throw new Error("not supported argument")},Te.generateKeypair=function(a,u){if(a=="RSA"){var p=u;(O=new Bt).generate(p,"10001"),O.isPrivate=!0,O.isPublic=!0;var g=new Bt,m=O.n.toString(16),w=O.e.toString(16);return g.setPublic(m,w),g.isPrivate=!1,g.isPublic=!0,(R={}).prvKeyObj=O,R.pubKeyObj=g,R}if(a=="EC"){var O,R,P=u,B=new b.crypto.ECDSA({curve:P}).generateKeyPairHex();return(O=new b.crypto.ECDSA({curve:P})).setPublicKeyHex(B.ecpubhex),O.setPrivateKeyHex(B.ecprvhex),O.isPrivate=!0,O.isPublic=!1,(g=new b.crypto.ECDSA({curve:P})).setPublicKeyHex(B.ecpubhex),g.isPrivate=!1,g.isPublic=!0,(R={}).prvKeyObj=O,R.pubKeyObj=g,R}throw new Error("unknown algorithm: "+a)},Te.getPEM=function(a,u,p,g,m,w){var O=b,R=O.asn1,P=R.DERObjectIdentifier,B=R.DERInteger,q=R.ASN1Util.newObject,L=R.x509.SubjectPublicKeyInfo,k=O.crypto,H=k.DSA,W=k.ECDSA,z=Bt;function st($t){return q({seq:[{int:0},{int:{bigint:$t.n}},{int:$t.e},{int:{bigint:$t.d}},{int:{bigint:$t.p}},{int:{bigint:$t.q}},{int:{bigint:$t.dmp1}},{int:{bigint:$t.dmq1}},{int:{bigint:$t.coeff}}]})}function bt($t){return q({seq:[{int:1},{octstr:{hex:$t.prvKeyHex}},{tag:["a0",!0,{oid:{name:$t.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+$t.pubKeyHex}}]}]})}function It($t){return q({seq:[{int:0},{int:{bigint:$t.p}},{int:{bigint:$t.q}},{int:{bigint:$t.g}},{int:{bigint:$t.y}},{int:{bigint:$t.x}}]})}if((z!==void 0&&a instanceof z||H!==void 0&&a instanceof H||W!==void 0&&a instanceof W)&&a.isPublic==1&&(u===void 0||u=="PKCS8PUB"))return Je(ut=new L(a).tohex(),"PUBLIC KEY");if(u=="PKCS1PRV"&&z!==void 0&&a instanceof z&&(p===void 0||p==null)&&a.isPrivate==1)return Je(ut=st(a).tohex(),"RSA PRIVATE KEY");if(u=="PKCS1PRV"&&W!==void 0&&a instanceof W&&(p===void 0||p==null)&&a.isPrivate==1){var Mt=new P({name:a.curveName}).tohex(),Lt=bt(a).tohex(),tt="";return(tt+=Je(Mt,"EC PARAMETERS"))+Je(Lt,"EC PRIVATE KEY")}if(u=="PKCS1PRV"&&H!==void 0&&a instanceof H&&(p===void 0||p==null)&&a.isPrivate==1)return Je(ut=It(a).tohex(),"DSA PRIVATE KEY");if(u=="PKCS5PRV"&&z!==void 0&&a instanceof z&&p!==void 0&&p!=null&&a.isPrivate==1){var ut=st(a).tohex();return g===void 0&&(g="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",ut,p,g,w)}if(u=="PKCS5PRV"&&W!==void 0&&a instanceof W&&p!==void 0&&p!=null&&a.isPrivate==1)return ut=bt(a).tohex(),g===void 0&&(g="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",ut,p,g,w);if(u=="PKCS5PRV"&&H!==void 0&&a instanceof H&&p!==void 0&&p!=null&&a.isPrivate==1)return ut=It(a).tohex(),g===void 0&&(g="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",ut,p,g,w);var pt=function($t,Wt){if(typeof Wt=="string")return Te.getEncryptedPKCS8PEM($t,Wt);if(typeof Wt=="object"&&Ue(Wt,"passcode")!=null){var Ht=JSON.parse(JSON.stringify(Wt)),Se=Ht.passcode;return delete Ht.passcode,Te.getEncryptedPKCS8PEM($t,Se,Ht)}};if(u=="PKCS8PRV"&&z!=null&&a instanceof z&&a.isPrivate==1){var it=st(a).tohex();return ut=q({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:it}}]}).tohex(),p===void 0||p==null?Je(ut,"PRIVATE KEY"):pt(ut,p)}if(u=="PKCS8PRV"&&W!==void 0&&a instanceof W&&a.isPrivate==1){var wt={seq:[{int:1},{octstr:{hex:a.prvKeyHex}}]};return typeof a.pubKeyHex=="string"&&wt.seq.push({tag:["a1",!0,{bitstr:{hex:"00"+a.pubKeyHex}}]}),it=new q(wt).tohex(),ut=q({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:a.curveName}}]},{octstr:{hex:it}}]}).tohex(),p===void 0||p==null?Je(ut,"PRIVATE KEY"):pt(ut,p)}if(u=="PKCS8PRV"&&H!==void 0&&a instanceof H&&a.isPrivate==1)return it=new B({bigint:a.x}).tohex(),ut=q({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:a.p}},{int:{bigint:a.q}},{int:{bigint:a.g}}]}]},{octstr:{hex:it}}]}).tohex(),p===void 0||p==null?Je(ut,"PRIVATE KEY"):pt(ut,p);throw new Error("unsupported object nor format")},Te.getKeyFromCSRPEM=function(a){var u=tr(a,"CERTIFICATE REQUEST");return Te.getKeyFromCSRHex(u)},Te.getKeyFromCSRHex=function(a){var u=Te.parseCSRHex(a);return Te.getKey(u.p8pubkeyhex,null,"pkcs8pub")},Te.parseCSRHex=function(a){var u=Gt,p=u.getChildIdx,g=u.getTLV,m={},w=a;if(w.substr(0,2)!="30")throw new Error("malformed CSR(code:001)");var O=p(w,0);if(O.length<1)throw new Error("malformed CSR(code:002)");if(w.substr(O[0],2)!="30")throw new Error("malformed CSR(code:003)");var R=p(w,O[0]);if(R.length<3)throw new Error("malformed CSR(code:004)");return m.p8pubkeyhex=g(w,R[2]),m},Te.getKeyID=function(a){var u=Te,p=Gt;typeof a=="string"&&a.indexOf("BEGIN ")!=-1&&(a=u.getKey(a));var g=tr(u.getPEM(a)),m=p.getIdxbyList(g,0,[1]),w=p.getV(g,m).substring(2);return b.crypto.Util.hashHex(w,"sha1")},Te.getJWK=function(a,u,p,g,m){var w,O,R={},P=b.crypto.Util.hashHex;if(typeof a=="string")w=Te.getKey(a),a.indexOf("CERTIFICATE")!=-1&&(O=tr(a));else{if(typeof a!="object")throw new Error("unsupported keyinfo type");a instanceof Ee?(w=a.getPublicKey(),O=a.hex):w=a}if(w instanceof Bt&&w.isPrivate)R.kty="RSA",R.n=Me(w.n.toString(16)),R.e=Me(w.e.toString(16)),R.d=Me(w.d.toString(16)),R.p=Me(w.p.toString(16)),R.q=Me(w.q.toString(16)),R.dp=Me(w.dmp1.toString(16)),R.dq=Me(w.dmq1.toString(16)),R.qi=Me(w.coeff.toString(16));else if(w instanceof Bt&&w.isPublic)R.kty="RSA",R.n=Me(w.n.toString(16)),R.e=Me(w.e.toString(16));else if(w instanceof b.crypto.ECDSA&&w.isPrivate){if((q=w.getShortNISTPCurveName())!=="P-256"&&q!=="P-384"&&q!=="P-521")throw new Error("unsupported curve name for JWT: "+q);var B=w.getPublicKeyXYHex();R.kty="EC",R.crv=q,R.x=Me(B.x),R.y=Me(B.y),R.d=Me(w.prvKeyHex)}else if(w instanceof b.crypto.ECDSA&&w.isPublic){var q;if((q=w.getShortNISTPCurveName())!=="P-256"&&q!=="P-384"&&q!=="P-521")throw new Error("unsupported curve name for JWT: "+q);B=w.getPublicKeyXYHex(),R.kty="EC",R.crv=q,R.x=Me(B.x),R.y=Me(B.y)}if(R.kty==null)throw new Error("unsupported keyinfo");return w.isPrivate||u==1||(R.kid=b.jws.JWS.getJWKthumbprint(R)),O!=null&&p!=1&&(R.x5c=[nt(O)]),O!=null&&g!=1&&(R.x5t=lr(nt(P(O,"sha1")))),O!=null&&m!=1&&(R["x5t#S256"]=lr(nt(P(O,"sha256")))),R},Te.getJWKFromKey=function(a){return Te.getJWK(a,!0,!0,!0,!0)},Bt.getPosArrayOfChildrenFromHex=function(a){return Gt.getChildIdx(a,0)},Bt.getHexValueArrayOfChildrenFromHex=function(a){var u,p=Gt.getV,g=p(a,(u=Bt.getPosArrayOfChildrenFromHex(a))[0]),m=p(a,u[1]),w=p(a,u[2]),O=p(a,u[3]),R=p(a,u[4]),P=p(a,u[5]),B=p(a,u[6]),q=p(a,u[7]),L=p(a,u[8]);return(u=new Array).push(g,m,w,O,R,P,B,q,L),u},Bt.prototype.readPrivateKeyFromPEMString=function(a){var u=tr(a),p=Bt.getHexValueArrayOfChildrenFromHex(u);this.setPrivateEx(p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8])},Bt.prototype.readPKCS5PrvKeyHex=function(a){var u=Bt.getHexValueArrayOfChildrenFromHex(a);this.setPrivateEx(u[1],u[2],u[3],u[4],u[5],u[6],u[7],u[8])},Bt.prototype.readPKCS8PrvKeyHex=function(a){var u,p,g,m,w,O,R,P,B=Gt,q=B.getVbyListEx;if(B.isASN1HEX(a)===!1)throw new Error("not ASN.1 hex string");try{u=q(a,0,[2,0,1],"02"),p=q(a,0,[2,0,2],"02"),g=q(a,0,[2,0,3],"02"),m=q(a,0,[2,0,4],"02"),w=q(a,0,[2,0,5],"02"),O=q(a,0,[2,0,6],"02"),R=q(a,0,[2,0,7],"02"),P=q(a,0,[2,0,8],"02")}catch{throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(u,p,g,m,w,O,R,P)},Bt.prototype.readPKCS5PubKeyHex=function(a){var u=Gt,p=u.getV;if(u.isASN1HEX(a)===!1)throw new Error("keyHex is not ASN.1 hex string");var g=u.getChildIdx(a,0);if(g.length!==2||a.substr(g[0],2)!=="02"||a.substr(g[1],2)!=="02")throw new Error("wrong hex for PKCS#5 public key");var m=p(a,g[0]),w=p(a,g[1]);this.setPublic(m,w)},Bt.prototype.readPKCS8PubKeyHex=function(a){var u=Gt;if(u.isASN1HEX(a)===!1)throw new Error("not ASN.1 hex string");if(u.getTLVbyListEx(a,0,[0,0])!=="06092a864886f70d010101")throw new Error("not PKCS8 RSA public key");var p=u.getTLVbyListEx(a,0,[1,0]);this.readPKCS5PubKeyHex(p)},Bt.prototype.readCertPubKeyHex=function(a,u){var p,g;(p=new Ee).readCertHex(a),g=p.getPublicKeyHex(),this.readPKCS8PubKeyHex(g)},new RegExp("[^0-9a-f]","gi"),Bt.prototype.sign=function(a,u){var p,g=(p=a,b.crypto.Util.hashString(p,u));return this.signWithMessageHash(g,u)},Bt.prototype.signWithMessageHash=function(a,u){var p=jt(b.crypto.Util.getPaddedDigestInfoHex(a,u,this.n.bitLength()),16);return Jt(this.doPrivate(p).toString(16),this.n.bitLength())},Bt.prototype.signPSS=function(a,u,p){var g,m=(g=Sr(a),b.crypto.Util.hashHex(g,u));return p===void 0&&(p=-1),this.signWithMessageHashPSS(m,u,p)},Bt.prototype.signWithMessageHashPSS=function(a,u,p){var g,m=hr(a),w=m.length,O=this.n.bitLength()-1,R=Math.ceil(O/8),P=function(st){return b.crypto.Util.hashHex(st,u)};if(p===-1||p===void 0)p=w;else if(p===-2)p=R-w-2;else if(p<-2)throw new Error("invalid salt length");if(R<w+p+2)throw new Error("data too long");var B="";p>0&&(B=new Array(p),new ge().nextBytes(B),B=String.fromCharCode.apply(String,B));var q=hr(P(Sr("\0\0\0\0\0\0\0\0"+m+B))),L=[];for(g=0;g<R-p-w-2;g+=1)L[g]=0;var k=String.fromCharCode.apply(String,L)+""+B,H=jn(q,k.length,P),W=[];for(g=0;g<k.length;g+=1)W[g]=k.charCodeAt(g)^H.charCodeAt(g);var z=65280>>8*R-O&255;for(W[0]&=~z,g=0;g<w;g++)W.push(q.charCodeAt(g));return W.push(188),Jt(this.doPrivate(new et(W)).toString(16),this.n.bitLength())},Bt.prototype.verify=function(a,u){if((u=u.toLowerCase()).match(/^[0-9a-f]+$/)==null)return!1;var p=jt(u,16),g=this.n.bitLength();if(p.bitLength()>g)return!1;var m=this.doPublic(p).toString(16);if(m.length+3!=g/4)return!1;var w=Pn(m.replace(/^1f+00/,""));if(w.length==0)return!1;var O,R=w[0];return w[1]==(O=a,b.crypto.Util.hashString(O,R))},Bt.prototype.verifyWithMessageHash=function(a,u){if(u.length!=Math.ceil(this.n.bitLength()/4))return!1;var p=jt(u,16);if(p.bitLength()>this.n.bitLength())return 0;var g=Pn(this.doPublic(p).toString(16).replace(/^1f+00/,""));return g.length!=0&&(g[0],g[1]==a)},Bt.prototype.verifyPSS=function(a,u,p,g){var m,w=(m=Sr(a),b.crypto.Util.hashHex(m,p));return g===void 0&&(g=-1),this.verifyWithMessageHashPSS(w,u,p,g)},Bt.prototype.verifyWithMessageHashPSS=function(a,u,p,g){if(u.length!=Math.ceil(this.n.bitLength()/4))return!1;var m,w=new et(u,16),O=function(It){return b.crypto.Util.hashHex(It,p)},R=hr(a),P=R.length,B=this.n.bitLength()-1,q=Math.ceil(B/8);if(g===-1||g===void 0)g=P;else if(g===-2)g=q-P-2;else if(g<-2)throw new Error("invalid salt length");if(q<P+g+2)throw new Error("data too long");var L=this.doPublic(w).toByteArray();for(m=0;m<L.length;m+=1)L[m]&=255;for(;L.length<q;)L.unshift(0);if(L[q-1]!==188)throw new Error("encoded message does not end in 0xbc");var k=(L=String.fromCharCode.apply(String,L)).substr(0,q-P-1),H=L.substr(k.length,P),W=65280>>8*q-B&255;if(k.charCodeAt(0)&W)throw new Error("bits beyond keysize not zero");var z=jn(H,k.length,O),st=[];for(m=0;m<k.length;m+=1)st[m]=k.charCodeAt(m)^z.charCodeAt(m);st[0]&=~W;var bt=q-P-g-2;for(m=0;m<bt;m+=1)if(st[m]!==0)throw new Error("leftmost octets not zero");if(st[bt]!==1)throw new Error("0x01 marker not found");return H===hr(O(Sr("\0\0\0\0\0\0\0\0"+R+String.fromCharCode.apply(String,st.slice(-g)))))},Bt.SALT_LEN_HLEN=-1,Bt.SALT_LEN_MAX=-2,Bt.SALT_LEN_RECOVER=-2,Ee.EXT_PARSER={},Ee.registExtParser=function(a,u){Ee.EXT_PARSER[a]=u},Ee.hex2dn=function(a,u){u===void 0&&(u=0);var p=new Ee;return Gt.getTLV(a,u),p.getX500Name(a).str},Ee.hex2rdn=function(a,u){if(u===void 0&&(u=0),a.substr(u,2)!=="31")throw new Error("malformed RDN");for(var p=new Array,g=Gt.getChildIdx(a,u),m=0;m<g.length;m++)p.push(Ee.hex2attrTypeValue(a,g[m]));return(p=p.map(function(w){return w.replace("+","\\+")})).join("+")},Ee.hex2attrTypeValue=function(a,u){var p=Gt,g=p.getV;if(u===void 0&&(u=0),a.substr(u,2)!=="30")throw new Error("malformed attribute type and value");var m=p.getChildIdx(a,u);m.length!==2||a.substr(m[0],2);var w=g(a,m[0]),O=b.asn1.ASN1Util.oidHexToInt(w);return b.asn1.x509.OID.oid2atype(O)+"="+hr(g(a,m[1]))},Ee.getPublicKeyFromCertHex=function(a){var u=new Ee;return u.readCertHex(a),u.getPublicKey()},Ee.getPublicKeyFromCertPEM=function(a){var u=new Ee;return u.readCertPEM(a),u.getPublicKey()},Ee.getPublicKeyInfoPropOfCertPEM=function(a){var u,p,g=Gt.getVbyList,m={algparam:null};return(u=new Ee).readCertPEM(a),p=u.getPublicKeyHex(),m.keyhex=g(p,0,[1],"03").substr(2),m.algoid=g(p,0,[0,0],"06"),m.algoid==="2a8648ce3d0201"&&(m.algparam=g(p,0,[0,1],"06")),m},Ee.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],b!==void 0&&b||(b={}),b.jws!==void 0&&b.jws||(b.jws={}),b.jws.JWS=function(){var a=b.jws.JWS.isSafeJSONString;this.parseJWS=function(u,p){if(this.parsedJWS===void 0||!p&&this.parsedJWS.sigvalH===void 0){var g=u.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(g==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var m=g[1],w=g[2],O=g[3],R=m+"."+w;if(this.parsedJWS={},this.parsedJWS.headB64U=m,this.parsedJWS.payloadB64U=w,this.parsedJWS.sigvalB64U=O,this.parsedJWS.si=R,!p){var P=Ke(O),B=jt(P,16);this.parsedJWS.sigvalH=P,this.parsedJWS.sigvalBI=B}var q=ce(m),L=ce(w);if(this.parsedJWS.headS=q,this.parsedJWS.payloadS=L,!a(q,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+q}}},b.jws.JWS.sign=function(a,u,p,g,m){var w,O,R,P=b,B=P.jws.JWS,q=B.readSafeJSONString,L=B.isSafeJSONString,k=P.crypto,H=(k.ECDSA,k.Mac),W=k.Signature,z=JSON;if(typeof u!="string"&&typeof u!="object")throw"spHeader must be JSON string or object: "+u;if(typeof u=="object"&&(O=u,w=z.stringify(O)),typeof u=="string"){if(!L(w=u))throw"JWS Head is not safe JSON string: "+w;O=q(w)}if(R=p,typeof p=="object"&&(R=z.stringify(p)),a!=""&&a!=null||O.alg===void 0||(a=O.alg),a!=""&&a!=null&&O.alg===void 0&&(O.alg=a,w=z.stringify(O)),a!==O.alg)throw"alg and sHeader.alg doesn't match: "+a+"!="+O.alg;var st=null;if(B.jwsalg2sigalg[a]===void 0)throw"unsupported alg name: "+a;st=B.jwsalg2sigalg[a];var bt=Be(w)+"."+Be(R),It="";if(st.substr(0,4)=="Hmac"){if(g===void 0)throw"mac key shall be specified for HS* alg";var Mt=new H({alg:st,prov:"cryptojs",pass:g});Mt.updateString(bt),It=Mt.doFinal()}else if(st.indexOf("withECDSA")!=-1){(tt=new W({alg:st})).init(g,m),tt.updateString(bt);var Lt=tt.sign();It=b.crypto.ECDSA.asn1SigToConcatSig(Lt)}else{var tt;st!="none"&&((tt=new W({alg:st})).init(g,m),tt.updateString(bt),It=tt.sign())}return bt+"."+Me(It)},b.jws.JWS.verify=function(a,u,p){var g,m=b,w=m.jws.JWS,O=w.readSafeJSONString,R=m.crypto,P=R.ECDSA,B=R.Mac,q=R.Signature;if(g=Bt,!or(a))return!1;var L=a.split(".");if(L.length!==3)return!1;var k,H=L[0]+"."+L[1],W=Ke(L[2]),z=O(ce(L[0])),st=null;if(z.alg===void 0)throw"algorithm not specified in header";if(k=(st=z.alg).substr(0,2),p!=null&&Object.prototype.toString.call(p)==="[object Array]"&&p.length>0&&(":"+p.join(":")+":").indexOf(":"+st+":")==-1)throw"algorithm '"+st+"' not accepted in the list";if(st!="none"&&u===null)throw"key shall be specified to verify.";if(typeof u=="string"&&u.indexOf("-----BEGIN ")!=-1&&(u=Te.getKey(u)),!(k!="RS"&&k!="PS"||u instanceof g))throw"key shall be a RSAKey obj for RS* and PS* algs";if(k=="ES"&&!(u instanceof P))throw"key shall be a ECDSA obj for ES* algs";var bt=null;if(w.jwsalg2sigalg[z.alg]===void 0)throw"unsupported alg name: "+st;if((bt=w.jwsalg2sigalg[st])=="none")throw"not supported";if(bt.substr(0,4)=="Hmac"){if(u===void 0)throw"hexadecimal key shall be specified for HMAC";var It=new B({alg:bt,pass:u});return It.updateString(H),W==It.doFinal()}if(bt.indexOf("withECDSA")!=-1){var Mt,Lt=null;try{Lt=P.concatSigToASN1Sig(W)}catch{return!1}return(Mt=new q({alg:bt})).init(u),Mt.updateString(H),Mt.verify(Lt)}return(Mt=new q({alg:bt})).init(u),Mt.updateString(H),Mt.verify(W)},b.jws.JWS.parse=function(a){var u,p,g,m=a.split("."),w={};if(m.length!=2&&m.length!=3)throw"malformed sJWS: wrong number of '.' splitted elements";return u=m[0],p=m[1],m.length==3&&(g=m[2]),w.headerObj=b.jws.JWS.readSafeJSONString(ce(u)),w.payloadObj=b.jws.JWS.readSafeJSONString(ce(p)),w.headerPP=JSON.stringify(w.headerObj,null,"  "),w.payloadObj==null?w.payloadPP=ce(p):w.payloadPP=JSON.stringify(w.payloadObj,null,"  "),g!==void 0&&(w.sigHex=Ke(g)),w},b.jws.JWS.verifyJWT=function(a,u,p){var g=b.jws,m=g.JWS,w=m.readSafeJSONString,O=m.inArray,R=m.includedArray;if(!or(a))return!1;var P=a.split(".");if(P.length!=3)return!1;var B=P[0],q=P[1],L=(Ke(P[2]),w(ce(B))),k=w(ce(q));if(L.alg===void 0)return!1;if(p.alg===void 0)throw"acceptField.alg shall be specified";if(!O(L.alg,p.alg)||k.iss!==void 0&&typeof p.iss=="object"&&!O(k.iss,p.iss)||k.sub!==void 0&&typeof p.sub=="object"&&!O(k.sub,p.sub))return!1;if(k.aud!==void 0&&typeof p.aud=="object"){if(typeof k.aud=="string"){if(!O(k.aud,p.aud))return!1}else if(typeof k.aud=="object"&&!R(k.aud,p.aud))return!1}var H=g.IntDate.getNow();return p.verifyAt!==void 0&&typeof p.verifyAt=="number"&&(H=p.verifyAt),p.gracePeriod!==void 0&&typeof p.gracePeriod=="number"||(p.gracePeriod=0),!(k.exp!==void 0&&typeof k.exp=="number"&&k.exp+p.gracePeriod<H||k.nbf!==void 0&&typeof k.nbf=="number"&&H<k.nbf-p.gracePeriod||k.iat!==void 0&&typeof k.iat=="number"&&H<k.iat-p.gracePeriod||k.jti!==void 0&&p.jti!==void 0&&k.jti!==p.jti||!m.verify(a,u,p.alg))},b.jws.JWS.includedArray=function(a,u){var p=b.jws.JWS.inArray;if(a===null||typeof a!="object"||typeof a.length!="number")return!1;for(var g=0;g<a.length;g++)if(!p(a[g],u))return!1;return!0},b.jws.JWS.inArray=function(a,u){if(u===null||typeof u!="object"||typeof u.length!="number")return!1;for(var p=0;p<u.length;p++)if(u[p]==a)return!0;return!1},b.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",ES512:"SHA512withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},b.jws.JWS.isSafeJSONString=function(a,u,p){var g=null;try{return typeof(g=be(a))!="object"||g.constructor===Array?0:(u&&(u[p]=g),1)}catch{return 0}},b.jws.JWS.readSafeJSONString=function(a){var u=null;try{return typeof(u=be(a))!="object"||u.constructor===Array?null:u}catch{return null}},b.jws.JWS.getEncodedSignatureValueFromJWS=function(a){var u=a.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(u==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return u[1]},b.jws.JWS.getJWKthumbprint=function(a){if(a.kty!=="RSA"&&a.kty!=="EC"&&a.kty!=="oct")throw"unsupported algorithm for JWK Thumprint";var u="{";if(a.kty==="RSA"){if(typeof a.n!="string"||typeof a.e!="string")throw"wrong n and e value for RSA key";u+='"e":"'+a.e+'",',u+='"kty":"'+a.kty+'",',u+='"n":"'+a.n+'"}'}else if(a.kty==="EC"){if(typeof a.crv!="string"||typeof a.x!="string"||typeof a.y!="string")throw"wrong crv, x and y value for EC key";u+='"crv":"'+a.crv+'",',u+='"kty":"'+a.kty+'",',u+='"x":"'+a.x+'",',u+='"y":"'+a.y+'"}'}else if(a.kty==="oct"){if(typeof a.k!="string")throw"wrong k value for oct(symmetric) key";u+='"kty":"'+a.kty+'",',u+='"k":"'+a.k+'"}'}var p=Sr(u);return Me(b.crypto.Util.hashHex(p,"sha256"))},b.jws.IntDate={},b.jws.IntDate.get=function(a){var u=b.jws.IntDate,p=u.getNow,g=u.getZulu;if(a=="now")return p();if(a=="now + 1hour")return p()+3600;if(a=="now + 1day")return p()+86400;if(a=="now + 1month")return p()+2592e3;if(a=="now + 1year")return p()+31536e3;if(a.match(/Z$/))return g(a);if(a.match(/^[0-9]+$/))return parseInt(a);throw"unsupported format: "+a},b.jws.IntDate.getZulu=function(a){return Vr(a)},b.jws.IntDate.getNow=function(){return~~(new Date/1e3)},b.jws.IntDate.intDate2UTCString=function(a){return new Date(1e3*a).toUTCString()},b.jws.IntDate.intDate2Zulu=function(a){var u=new Date(1e3*a);return("0000"+u.getUTCFullYear()).slice(-4)+("00"+(u.getUTCMonth()+1)).slice(-2)+("00"+u.getUTCDate()).slice(-2)+("00"+u.getUTCHours()).slice(-2)+("00"+u.getUTCMinutes()).slice(-2)+("00"+u.getUTCSeconds()).slice(-2)+"Z"},b!==void 0&&b||(b={}),b.jws!==void 0&&b.jws||(b.jws={}),b.jws.JWSJS=function(){var a=b.jws.JWS,u=a.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(p){this.init();var g=p.split(".");if(g.length!=3)throw"malformed input JWS";this.aHeader.push(g[0]),this.sPayload=g[1],this.aSignature.push(g[2])},this.addSignature=function(p,g,m,w){if(this.sPayload===void 0||this.sPayload===null)throw"there's no JSON-JS signature to add.";var O=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var R=b.jws.JWS.sign(p,g,this.sPayload,m,w).split(".");R[0],R[2],this.aHeader.push(R[0]),this.aSignature.push(R[2])}catch(P){throw this.aHeader.length>O&&this.aHeader.pop(),this.aSignature.length>O&&this.aSignature.pop(),"addSignature failed: "+P}},this.verifyAll=function(p){if(this.aHeader.length!==p.length||this.aSignature.length!==p.length)return!1;for(var g=0;g<p.length;g++){var m=p[g];if(m.length!==2||this.verifyNth(g,m[0],m[1])===!1)return!1}return!0},this.verifyNth=function(p,g,m){if(this.aHeader.length<=p||this.aSignature.length<=p)return!1;var w=this.aHeader[p],O=this.aSignature[p],R=w+"."+this.sPayload+"."+O,P=!1;try{P=a.verify(R,g,m)}catch{return!1}return P},this.readJWSJS=function(p){if(typeof p=="string"){var g=u(p);if(g==null)throw"argument is not safe JSON object string";this.aHeader=g.headers,this.sPayload=g.payload,this.aSignature=g.signatures}else try{if(!(p.headers.length>0))throw"malformed header";if(this.aHeader=p.headers,typeof p.payload!="string"||(this.sPayload=p.payload,!(p.signatures.length>0)))throw"malformed signatures";this.aSignature=p.signatures}catch(m){throw"malformed JWS-JS JSON object: "+m}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return this.aHeader.length==0?1:0}},_$jsrsasign_52.SecureRandom=ge,_$jsrsasign_52.rng_seed_time=_e,_$jsrsasign_52.BigInteger=et,_$jsrsasign_52.RSAKey=Bt,_$jsrsasign_52.ECDSA=b.crypto.ECDSA,_$jsrsasign_52.DSA=b.crypto.DSA,_$jsrsasign_52.Signature=b.crypto.Signature,_$jsrsasign_52.MessageDigest=b.crypto.MessageDigest,_$jsrsasign_52.Mac=b.crypto.Mac,_$jsrsasign_52.KEYUTIL=Te,_$jsrsasign_52.ASN1HEX=Gt,_$jsrsasign_52.X509=Ee,_$jsrsasign_52.X509CRL=function(a){var u=b.lang.String.isHex,p=Gt,g=p.getV,m=p.getTLV,w=p.getVbyList,O=p.getTLVbyList,R=p.getTLVbyListEx,P=p.getIdxbyList,B=p.getIdxbyListEx,q=p.getChildIdx,L=new Ee;this.hex=null,this.posSigAlg=null,this.posRevCert=null,this.parsed=null,this._setPos=function(){var k=P(this.hex,0,[0,0]),H=this.hex.substr(k,2);if(H=="02")this.posSigAlg=1;else{if(H!="30")throw new Error("malformed 1st item of TBSCertList: "+H);this.posSigAlg=0}var W,z=P(this.hex,0,[0,this.posSigAlg+3]),st=this.hex.substr(z,2);if(st=="17"||st=="18")W=P(this.hex,0,[0,this.posSigAlg+4]),this.posRevCert=null,W!=-1&&this.hex.substr(W,2)=="30"&&(this.posRevCert=this.posSigAlg+4);else if(st=="30")this.posRevCert=this.posSigAlg+3;else{if(st!="a0")throw new Error("malformed nextUpdate or revCert tag: "+st);this.posRevCert=null}},this.getVersion=function(){return this.posSigAlg==0?null:parseInt(w(this.hex,0,[0,0],"02"),16)+1},this.getSignatureAlgorithmField=function(){var k=O(this.hex,0,[0,this.posSigAlg],"30");return L.getAlgorithmIdentifierName(k)},this.getIssuer=function(){return L.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return O(this.hex,0,[0,this.posSigAlg+1],"30")},this.getThisUpdate=function(){var k=w(this.hex,0,[0,this.posSigAlg+2]);return result=hr(k)},this.getNextUpdate=function(){var k=P(this.hex,0,[0,this.posSigAlg+3]),H=this.hex.substr(k,2);return H!="17"&&H!="18"?null:hr(g(this.hex,k))},this.getRevCertArray=function(){if(this.posRevCert==null)return null;for(var k=[],H=P(this.hex,0,[0,this.posRevCert]),W=q(this.hex,H),z=0;z<W.length;z++){var st=m(this.hex,W[z]);k.push(this.getRevCert(st))}return k},this.getRevCert=function(k){var H={},W=q(k,0);return H.sn={hex:w(k,0,[0],"02")},H.date=hr(w(k,0,[1])),W.length==3&&(H.ext=L.getExtParamArray(O(k,0,[2]))),H},this.findRevCert=function(k){var H=new Ee(k).getSerialNumberHex();return this.findRevCertBySN(H)},this.findRevCertBySN=function(k){if(this.parsed==null&&this.getParam(),this.parsed.revcert==null)return null;for(var H=this.parsed.revcert,W=0;W<H.length;W++)if(k==H[W].sn.hex)return H[W];return null},this.getSignatureValueHex=function(){return w(this.hex,0,[2],"03",!0)},this.verifySignature=function(k){var H=this.getSignatureAlgorithmField(),W=this.getSignatureValueHex(),z=O(this.hex,0,[0],"30"),st=new b.crypto.Signature({alg:H});return st.init(k),st.updateHex(z),st.verify(W)},this.getParam=function(k){var H={},W=this.getVersion();W!=null&&(H.version=W),H.sigalg=this.getSignatureAlgorithmField(),H.issuer=this.getIssuer(),H.thisupdate=this.getThisUpdate();var z=this.getNextUpdate();z!=null&&(H.nextupdate=z);var st=this.getRevCertArray();if(st!=null&&(H.revcert=st),B(this.hex,0,[0,"[0]"])!=-1){var bt=R(this.hex,0,[0,"[0]",0]);H.ext=L.getExtParamArray(bt)}return H.sighex=this.getSignatureValueHex(),this.parsed=H,typeof k=="object"&&(k.tbshex==1&&(H.tbshex=O(this.hex,0,[0])),k.nodnarray==1&&delete H.issuer.array),H},typeof a=="string"&&(u(a)?this.hex=a:a.match(/-----BEGIN X509 CRL/)&&(this.hex=tr(a)),this._setPos())},_$jsrsasign_52.CryptoJS=Y,_$jsrsasign_52.b64tohex=ct,_$jsrsasign_52.b64toBA=at,_$jsrsasign_52.ECFieldElementFp=ie,_$jsrsasign_52.ECPointFp=ee,_$jsrsasign_52.ECCurveFp=Kt,_$jsrsasign_52.stoBA=ze,_$jsrsasign_52.BAtos=We,_$jsrsasign_52.BAtohex=Xe,_$jsrsasign_52.stohex=nr,_$jsrsasign_52.stob64=function(a){return nt(nr(a))},_$jsrsasign_52.stob64u=function(a){return lr(nt(nr(a)))},_$jsrsasign_52.b64utos=function(a){return We(at(ur(a)))},_$jsrsasign_52.b64tob64u=lr,_$jsrsasign_52.b64utob64=ur,_$jsrsasign_52.hex2b64=nt,_$jsrsasign_52.hextob64u=Me,_$jsrsasign_52.b64utohex=Ke,_$jsrsasign_52.utf8tob64u=Be,_$jsrsasign_52.b64utoutf8=ce,_$jsrsasign_52.utf8tob64=function(a){return nt(Yr(Ar(a)))},_$jsrsasign_52.b64toutf8=function(a){return decodeURIComponent(Jr(ct(a)))},_$jsrsasign_52.utf8tohex=Ir,_$jsrsasign_52.hextoutf8=Le,_$jsrsasign_52.hextorstr=hr,_$jsrsasign_52.rstrtohex=Sr,_$jsrsasign_52.hextob64=Xr,_$jsrsasign_52.hextob64nl=function(a){return Kr(Xr(a),64)},_$jsrsasign_52.b64nltohex=Qe,_$jsrsasign_52.hextopem=Je,_$jsrsasign_52.pemtohex=tr,_$jsrsasign_52.hextoArrayBuffer=function(a){if(a.length%2!=0)throw"input is not even length";if(a.match(/^[0-9A-Fa-f]+$/)==null)throw"input is not hexadecimal";for(var u=new ArrayBuffer(a.length/2),p=new DataView(u),g=0;g<a.length/2;g++)p.setUint8(g,parseInt(a.substr(2*g,2),16));return u},_$jsrsasign_52.ArrayBuffertohex=function(a){for(var u="",p=new DataView(a),g=0;g<a.byteLength;g++)u+=("00"+p.getUint8(g).toString(16)).slice(-2);return u},_$jsrsasign_52.zulutomsec=an,_$jsrsasign_52.msectozulu=function(a){var u=new Date(a),p=("0000"+u.getUTCFullYear()).slice(-4),g=("00"+(u.getUTCMonth()+1)).slice(-2),m=("00"+u.getUTCDate()).slice(-2),w=("00"+u.getUTCHours()).slice(-2),O=("00"+u.getUTCMinutes()).slice(-2),R=("00"+u.getUTCSeconds()).slice(-2),P=("000"+u.getUTCMilliseconds()).slice(-3);return p+g+m+w+O+R+(P=(P=P.replace(/0+$/,""))!=""?"."+P:P)+"Z"},_$jsrsasign_52.zulutosec=Vr,_$jsrsasign_52.zulutodate=function(a){return new Date(an(a))},_$jsrsasign_52.datetozulu=function(a,u,p){var g,m=a.getUTCFullYear();if(u){if(m<1950||2049<m)throw"not proper year for UTCTime: "+m;g=(""+m).slice(-2)}else g=("000"+m).slice(-4);if(g+=("0"+(a.getUTCMonth()+1)).slice(-2),g+=("0"+a.getUTCDate()).slice(-2),g+=("0"+a.getUTCHours()).slice(-2),g+=("0"+a.getUTCMinutes()).slice(-2),g+=("0"+a.getUTCSeconds()).slice(-2),p){var w=a.getUTCMilliseconds();w!==0&&(g+="."+(w=(w=("00"+w).slice(-3)).replace(/0+$/g,"")))}return g+"Z"},_$jsrsasign_52.uricmptohex=Yr,_$jsrsasign_52.hextouricmp=Jr,_$jsrsasign_52.ipv6tohex=sn,_$jsrsasign_52.hextoipv6=se,_$jsrsasign_52.hextoip=ye,_$jsrsasign_52.iptohex=ar,_$jsrsasign_52.ucs2hextoutf8=Zr,_$jsrsasign_52.encodeURIComponentAll=Ar,_$jsrsasign_52.newline_toUnix=function(a){return a.replace(/\r\n/gm,`
`)},_$jsrsasign_52.newline_toDos=function(a){return(a=a.replace(/\r\n/gm,`
`)).replace(/\n/gm,`\r
`)},_$jsrsasign_52.hextoposhex=X,_$jsrsasign_52.intarystrtohex=function(a){a=(a=(a=a.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{return a.split(/,/).map(function(u,p,g){var m=parseInt(u);if(m<0||255<m)throw"integer not in range 0-255";return("00"+m.toString(16)).slice(-2)}).join("")}catch(u){throw"malformed integer array string: "+u}},_$jsrsasign_52.strdiffidx=function(a,u){var p=a.length;a.length>u.length&&(p=u.length);for(var g=0;g<p;g++)if(a.charCodeAt(g)!=u.charCodeAt(g))return g;return a.length!=u.length?p:-1},_$jsrsasign_52.oidtohex=xe,_$jsrsasign_52.hextooid=Tr,_$jsrsasign_52.strpad=Ut,_$jsrsasign_52.bitstrtoint=sr,_$jsrsasign_52.inttobitstr=_n,_$jsrsasign_52.bitstrtobinstr=Ie,_$jsrsasign_52.binstrtobitstr=function(a){if(typeof a!="string"||a.match(/^[01]+$/)==null)return null;try{return _n(parseInt(a,2))}catch{return null}},_$jsrsasign_52.isBase64URLDot=or,_$jsrsasign_52.namearraytobinstr=fr,_$jsrsasign_52.extendClass=Yt,_$jsrsasign_52.foldnl=Kr,_$jsrsasign_52.b64topem=function(a,u){return"-----BEGIN "+u+`-----\r
`+Kr(a,64)+`\r
-----END `+u+`-----\r
`},_$jsrsasign_52.pemtob64=function(a){return a.indexOf("-----BEGIN ")==-1||a.indexOf("-----END ")==-1?null:(a=(a=(a=a.replace(/^[\s\S]*?-----BEGIN [^-]+-----/m,"")).replace(/-----END [\s\S]+$/m,"")).replace(/\s+/g,"")).match(/^[0-9a-zA-Z+/=]+$/)?a:null},_$jsrsasign_52.timeogen=Gr,_$jsrsasign_52.aryval=Ue,_$jsrsasign_52.inttohex=gr,_$jsrsasign_52.twoscompl=Ve,_$jsrsasign_52.KJUR=b,_$jsrsasign_52.crypto=b.crypto,_$jsrsasign_52.asn1=b.asn1,_$jsrsasign_52.jws=b.jws,_$jsrsasign_52.lang=b.lang,_$jsrsasign_52.VERSION="11.1.0",_$jsrsasign_52.VERSION_FULL="jsrsasign(all) 11.1.0 (2024-02-01) (c) 2010-2023 Kenji Urushima | kjur.github.io/jsrsasign/license"}).call(this)}).call(this,_$buffer_3({}).Buffer);var _$rs_145={};Object.defineProperty(_$rs_145,"__esModule",{value:!0}),_$rs_145.default=void 0,_$rs_145.generateFingerprint=generateFingerprint;var __obj_145,_jsrsasign=(__obj_145=_$jsrsasign_52)&&__obj_145.__esModule?__obj_145:{default:__obj_145};function generateFingerprint(t){var e=_jsrsasign.default.pemtohex(t);return _jsrsasign.default.KJUR.crypto.Util.hashHex(e,"sha256").match(/.{2}/g).join(":").toUpperCase()}var ___default_145={generateFingerprint};_$rs_145.default=___default_145;var _$scriptResourceCache_146={};Object.defineProperty(_$scriptResourceCache_146,"__esModule",{value:!0}),_$scriptResourceCache_146.default=void 0;var __obj_146,___app_146=(__obj_146=_$app_87)&&__obj_146.__esModule?__obj_146:{default:__obj_146};function ___slicedToArray_146(t,e){return function(n){if(Array.isArray(n))return n}(t)||function(n,r){var o=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(o!=null){var f,d,h=[],y=!0,F=!1;try{for(o=o.call(n);!(y=(f=o.next()).done)&&(h.push(f.value),!r||h.length!==r);y=!0);}catch(S){F=!0,d=S}finally{try{y||o.return==null||o.return()}finally{if(F)throw d}}return h}}(t,e)||function(n,r){if(n){if(typeof n=="string")return ___arrayLikeToArray_146(n,r);var o=Object.prototype.toString.call(n).slice(8,-1);return o==="Object"&&n.constructor&&(o=n.constructor.name),o==="Map"||o==="Set"?Array.from(n):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?___arrayLikeToArray_146(n,r):void 0}}(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ___arrayLikeToArray_146(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ___defineProperties_146(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ___default_146=new(function(){function t(){(function(o,f){if(!(o instanceof f))throw new TypeError("Cannot call a class as a function")})(this,t),this.expires=function(){___app_146.default.read(_$constants_86.CSR_EXPIRATION_TIME_KEY)||___app_146.default.write("1728e5",_$constants_86.CSR_EXPIRATION_TIME_KEY);var o=1728e5;if(___app_146.default.env.isLoon){var f={"1\u5206\u949F":6e4,"5\u5206\u949F":3e5,"10\u5206\u949F":6e5,"30\u5206\u949F":18e5,"1\u5C0F\u65F6":36e5,"2\u5C0F\u65F6":72e5,"3\u5C0F\u65F6":108e5,"6\u5C0F\u65F6":216e5,"12\u5C0F\u65F6":432e5,"24\u5C0F\u65F6":864e5,"48\u5C0F\u65F6":1728e5,"72\u5C0F\u65F6":2592e5,\u53C2\u6570\u4F20\u5165:"readcachets"},d=___app_146.default.read("#\u8282\u70B9\u7F13\u5B58\u6709\u6548\u671F");return d in f&&(o=f[d])==="readcachets"&&(o=d),o}return ___app_146.default.read(_$constants_86.CSR_EXPIRATION_TIME_KEY)}(),___app_146.default.read(_$constants_86.SCRIPT_RESOURCE_CACHE_KEY)||___app_146.default.write("{}",_$constants_86.SCRIPT_RESOURCE_CACHE_KEY);try{this.resourceCache=JSON.parse(___app_146.default.read(_$constants_86.SCRIPT_RESOURCE_CACHE_KEY))}catch(o){var r;___app_146.default.error("\u89E3\u6790\u6301\u4E45\u5316\u7F13\u5B58\u4E2D\u7684 ".concat(_$constants_86.SCRIPT_RESOURCE_CACHE_KEY," \u5931\u8D25, \u91CD\u7F6E\u4E3A {}, \u9519\u8BEF: ").concat((r=o?.message)!==null&&r!==void 0?r:o)),this.resourceCache={},___app_146.default.write("{}",_$constants_86.SCRIPT_RESOURCE_CACHE_KEY)}this._cleanup()}var e,n;return e=t,(n=[{key:"_cleanup",value:function(){var r=this,o=!1;Object.entries(this.resourceCache).forEach(function(f){var d=___slicedToArray_146(f,2),h=d[0],y=d[1];y.time||(delete r.resourceCache[h],___app_146.default.delete("#".concat(h)),o=!0),new Date().getTime()-y.time>r.expires&&(delete r.resourceCache[h],o=!0)}),o&&this._persist()}},{key:"revokeAll",value:function(){this.resourceCache={},this._persist()}},{key:"_persist",value:function(){___app_146.default.write(JSON.stringify(this.resourceCache),_$constants_86.SCRIPT_RESOURCE_CACHE_KEY)}},{key:"get",value:function(r){var o=this.resourceCache[r]&&this.resourceCache[r].time;return o&&new Date().getTime()-o<=this.expires?this.resourceCache[r].data:null}},{key:"gettime",value:function(r){var o=this.resourceCache[r]&&this.resourceCache[r].time;return o&&new Date().getTime()-o<=this.expires?this.resourceCache[r].time:null}},{key:"set",value:function(r,o){this.resourceCache[r]={time:new Date().getTime(),data:o},this._persist()}}])&&___defineProperties_146(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());_$scriptResourceCache_146.default=___default_146;var _$logical_142={};function ___arrayLikeToArray_142(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}Object.defineProperty(_$logical_142,"__esModule",{value:!0}),_$logical_142.AND=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(function(r,o){return r.map(function(f,d){return o[d]&&f})})},_$logical_142.FULL=function(t,e){return(n=Array(t).keys(),function(r){if(Array.isArray(r))return ___arrayLikeToArray_142(r)}(n)||function(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}(n)||function(r,o){if(r){if(typeof r=="string")return ___arrayLikeToArray_142(r,void 0);var f=Object.prototype.toString.call(r).slice(8,-1);return f==="Object"&&r.constructor&&(f=r.constructor.name),f==="Map"||f==="Set"?Array.from(r):f==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(f)?___arrayLikeToArray_142(r,void 0):void 0}}(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()).map(function(){return e});var n},_$logical_142.NOT=function(t){return t.map(function(e){return!e})},_$logical_142.OR=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(function(r,o){return r.map(function(f,d){return o[d]||f})})};var _$geo_138={};Object.defineProperty(_$geo_138,"__esModule",{value:!0}),_$geo_138.MMDB=void 0,_$geo_138.getFlag=getFlag,_$geo_138.getISO=getISO,_$geo_138.removeFlag=removeFlag;var ___app_138=___interopRequireDefault_138(_$app_87);function ___interopRequireDefault_138(t){return t&&t.__esModule?t:{default:t}}function ___classCallCheck_138(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ___defineProperties_138(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ___createClass_138(t,e,n){return e&&___defineProperties_138(t.prototype,e),n&&___defineProperties_138(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var ISOFlags={"\u{1F3F3}\uFE0F\u200D\u{1F308}":["EXP","BAND"],"\u{1F1F8}\u{1F1F1}":["TEST","SOS"],"\u{1F1E6}\u{1F1E9}":["AD","AND"],"\u{1F1E6}\u{1F1EA}":["AE","ARE"],"\u{1F1E6}\u{1F1EB}":["AF","AFG"],"\u{1F1E6}\u{1F1F1}":["AL","ALB"],"\u{1F1E6}\u{1F1F2}":["AM","ARM"],"\u{1F1E6}\u{1F1F7}":["AR","ARG"],"\u{1F1E6}\u{1F1F9}":["AT","AUT"],"\u{1F1E6}\u{1F1FA}":["AU","AUS"],"\u{1F1E6}\u{1F1FF}":["AZ","AZE"],"\u{1F1E7}\u{1F1E6}":["BA","BIH"],"\u{1F1E7}\u{1F1E9}":["BD","BGD"],"\u{1F1E7}\u{1F1EA}":["BE","BEL"],"\u{1F1E7}\u{1F1EC}":["BG","BGR"],"\u{1F1E7}\u{1F1ED}":["BH","BHR"],"\u{1F1E7}\u{1F1F4}":["BO","BOL"],"\u{1F1E7}\u{1F1F7}":["BR","BRA"],"\u{1F1E7}\u{1F1FE}":["BY","BLR"],"\u{1F1E8}\u{1F1E6}":["CA","CAN"],"\u{1F1E8}\u{1F1ED}":["CH","CHE"],"\u{1F1E8}\u{1F1F1}":["CL","CHL"],"\u{1F1E8}\u{1F1F4}":["CO","COL"],"\u{1F1E8}\u{1F1F7}":["CR","CRI"],"\u{1F1E8}\u{1F1FE}":["CY","CYP"],"\u{1F1E8}\u{1F1FF}":["CZ","CZE"],"\u{1F1E9}\u{1F1EA}":["DE","DEU"],"\u{1F1E9}\u{1F1F0}":["DK","DNK"],"\u{1F1EA}\u{1F1E8}":["EC","ECU"],"\u{1F1EA}\u{1F1EA}":["EE","EST"],"\u{1F1EA}\u{1F1EC}":["EG","EGY"],"\u{1F1EA}\u{1F1F8}":["ES","ESP"],"\u{1F1EA}\u{1F1FA}":["EU"],"\u{1F1EB}\u{1F1EE}":["FI","FIN"],"\u{1F1EB}\u{1F1F7}":["FR","FRA"],"\u{1F1EC}\u{1F1E7}":["GB","GBR","UK"],"\u{1F1EC}\u{1F1EA}":["GE","GEO"],"\u{1F1EC}\u{1F1F7}":["GR","GRC"],"\u{1F1EC}\u{1F1F9}":["GT","GTM"],"\u{1F1ED}\u{1F1F0}":["HK","HKG","HKT","HKBN","HGC","WTT","CMI"],"\u{1F1ED}\u{1F1F7}":["HR","HRV"],"\u{1F1ED}\u{1F1FA}":["HU","HUN"],"\u{1F1EF}\u{1F1F4}":["JO","JOR"],"\u{1F1EF}\u{1F1F5}":["JP","JPN","TYO"],"\u{1F1F0}\u{1F1EA}":["KE","KEN"],"\u{1F1F0}\u{1F1EC}":["KG","KGZ"],"\u{1F1F0}\u{1F1ED}":["KH","KGZ"],"\u{1F1F0}\u{1F1F5}":["KP","PRK"],"\u{1F1F0}\u{1F1F7}":["KR","KOR","SEL"],"\u{1F1F0}\u{1F1FF}":["KZ","KAZ"],"\u{1F1EE}\u{1F1E9}":["ID","IDN"],"\u{1F1EE}\u{1F1EA}":["IE","IRL"],"\u{1F1EE}\u{1F1F1}":["IL","ISR"],"\u{1F1EE}\u{1F1F2}":["IM","IMN"],"\u{1F1EE}\u{1F1F3}":["IN","IND"],"\u{1F1EE}\u{1F1F7}":["IR","IRN"],"\u{1F1EE}\u{1F1F8}":["IS","ISL"],"\u{1F1EE}\u{1F1F9}":["IT","ITA"],"\u{1F1F1}\u{1F1F9}":["LT","LTU"],"\u{1F1F1}\u{1F1FA}":["LU","LUX"],"\u{1F1F1}\u{1F1FB}":["LV","LVA"],"\u{1F1F2}\u{1F1E6}":["MA","MAR"],"\u{1F1F2}\u{1F1E9}":["MD","MDA"],"\u{1F1F3}\u{1F1EC}":["NG","NGA"],"\u{1F1F2}\u{1F1F0}":["MK","MKD"],"\u{1F1F2}\u{1F1F3}":["MN","MNG"],"\u{1F1F2}\u{1F1F4}":["MO","MAC","CTM"],"\u{1F1F2}\u{1F1F9}":["MT","MLT"],"\u{1F1F2}\u{1F1FD}":["MX","MEX"],"\u{1F1F2}\u{1F1FE}":["MY","MYS"],"\u{1F1F3}\u{1F1F1}":["NL","NLD","AMS"],"\u{1F1F3}\u{1F1F4}":["NO","NOR"],"\u{1F1F3}\u{1F1F5}":["NP","NPL"],"\u{1F1F3}\u{1F1FF}":["NZ","NZL"],"\u{1F1F5}\u{1F1E6}":["PA","PAN"],"\u{1F1F5}\u{1F1EA}":["PE","PER"],"\u{1F1F5}\u{1F1ED}":["PH","PHL"],"\u{1F1F5}\u{1F1F0}":["PK","PAK"],"\u{1F1F5}\u{1F1F1}":["PL","POL"],"\u{1F1F5}\u{1F1F7}":["PR","PRI"],"\u{1F1F5}\u{1F1F9}":["PT","PRT"],"\u{1F1F5}\u{1F1FE}":["PY","PRY"],"\u{1F1F7}\u{1F1F4}":["RO","ROU"],"\u{1F1F7}\u{1F1F8}":["RS","SRB"],"\u{1F1F7}\u{1F1EA}":["RE","REU"],"\u{1F1F7}\u{1F1FA}":["RU","RUS"],"\u{1F1F8}\u{1F1E6}":["SA","SAU"],"\u{1F1F8}\u{1F1EA}":["SE","SWE"],"\u{1F1F8}\u{1F1EC}":["SG","SGP"],"\u{1F1F8}\u{1F1EE}":["SI","SVN"],"\u{1F1F8}\u{1F1F0}":["SK","SVK"],"\u{1F1F9}\u{1F1ED}":["TH","THA"],"\u{1F1F9}\u{1F1F3}":["TN","TUN"],"\u{1F1F9}\u{1F1F7}":["TR","TUR"],"\u{1F1F9}\u{1F1FC}":["TW","TWN","CHT","HINET","ROC"],"\u{1F1FA}\u{1F1E6}":["UA","UKR"],"\u{1F1FA}\u{1F1F8}":["US","USA","LAX","SFO","SJC"],"\u{1F1FA}\u{1F1FE}":["UY","URY"],"\u{1F1FB}\u{1F1EA}":["VE","VEN"],"\u{1F1FB}\u{1F1F3}":["VN","VNM"],"\u{1F1FF}\u{1F1E6}":["ZA","ZAF","JNB"],"\u{1F1E8}\u{1F1F3}":["CN","CHN","BACK"]};function getFlag(t){for(var e,n={"\u{1F3F3}\uFE0F\u200D\u{1F308}":["\u6D41\u91CF","\u65F6\u95F4","\u8FC7\u671F","Bandwidth","Expire"],"\u{1F1F8}\u{1F1F1}":["\u5E94\u6025","\u6D4B\u8BD5\u8282\u70B9"],"\u{1F1E6}\u{1F1E9}":["Andorra","\u5B89\u9053\u5C14"],"\u{1F1E6}\u{1F1EA}":["United Arab Emirates","\u963F\u8054\u914B","\u8FEA\u62DC"],"\u{1F1E6}\u{1F1EB}":["Afghanistan","\u963F\u5BCC\u6C57"],"\u{1F1E6}\u{1F1F1}":["Albania","\u963F\u5C14\u5DF4\u5C3C\u4E9A","\u963F\u723E\u5DF4\u5C3C\u4E9E"],"\u{1F1E6}\u{1F1F2}":["Armenia","\u4E9A\u7F8E\u5C3C\u4E9A"],"\u{1F1E6}\u{1F1F7}":["Argentina","\u963F\u6839\u5EF7"],"\u{1F1E6}\u{1F1F9}":["Austria","\u5965\u5730\u5229","\u5967\u5730\u5229","\u7EF4\u4E5F\u7EB3"],"\u{1F1E6}\u{1F1FA}":["Australia","\u6FB3\u5927\u5229\u4E9A","\u6FB3\u6D32","\u58A8\u5C14\u672C","\u6089\u5C3C","\u571F\u6FB3","\u4EAC\u6FB3","\u5EE3\u6FB3","\u6EEC\u6FB3","\u6CAA\u6FB3","\u5E7F\u6FB3","Sydney"],"\u{1F1E6}\u{1F1FF}":["Azerbaijan","\u963F\u585E\u62DC\u7586"],"\u{1F1E7}\u{1F1E6}":["Bosnia and Herzegovina","\u6CE2\u9ED1\u5171\u548C\u56FD","\u6CE2\u9ED1"],"\u{1F1E7}\u{1F1E9}":["Bangladesh","\u5B5F\u52A0\u62C9\u56FD","\u5B5F\u52A0\u62C9"],"\u{1F1E7}\u{1F1EA}":["Belgium","\u6BD4\u5229\u65F6","\u6BD4\u5229\u6642"],"\u{1F1E7}\u{1F1EC}":["Bulgaria","\u4FDD\u52A0\u5229\u4E9A","\u4FDD\u52A0\u5229\u4E9E"],"\u{1F1E7}\u{1F1ED}":["Bahrain","\u5DF4\u6797"],"\u{1F1E7}\u{1F1F7}":["Brazil","\u5DF4\u897F","\u5723\u4FDD\u7F57"],"\u{1F1E7}\u{1F1FE}":["Belarus","\u767D\u4FC4\u7F57\u65AF","\u767D\u4FC4"],"\u{1F1E7}\u{1F1F4}":["Bolivia","\u73BB\u5229\u7EF4\u4E9A"],"\u{1F1E8}\u{1F1E6}":["Canada","\u52A0\u62FF\u5927","\u8499\u7279\u5229\u5C14","\u6E29\u54E5\u534E","\u6953\u8449","\u67AB\u53F6","\u6ED1\u94C1\u5362","\u591A\u4F26\u591A","Waterloo","Toronto"],"\u{1F1E8}\u{1F1ED}":["Switzerland","\u745E\u58EB","\u82CF\u9ECE\u4E16","Zurich"],"\u{1F1E8}\u{1F1F1}":["Chile","\u667A\u5229"],"\u{1F1E8}\u{1F1F4}":["Colombia","\u54E5\u4F26\u6BD4\u4E9A"],"\u{1F1E8}\u{1F1F7}":["Costa Rica","\u54E5\u65AF\u8FBE\u9ECE\u52A0"],"\u{1F1E8}\u{1F1FE}":["Cyprus","\u585E\u6D66\u8DEF\u65AF"],"\u{1F1E8}\u{1F1FF}":["Czechia","\u6377\u514B"],"\u{1F1E9}\u{1F1EA}":["German","\u5FB7\u56FD","\u5FB7\u570B","\u4EAC\u5FB7","\u6EEC\u5FB7","\u5EE3\u5FB7","\u6CAA\u5FB7","\u5E7F\u5FB7","\u6CD5\u5170\u514B\u798F","Frankfurt","\u5FB7\u610F\u5FD7"],"\u{1F1E9}\u{1F1F0}":["Denmark","\u4E39\u9EA6","\u4E39\u9EA5"],"\u{1F1EA}\u{1F1E8}":["Ecuador","\u5384\u74DC\u591A\u5C14"],"\u{1F1EA}\u{1F1EA}":["Estonia","\u7231\u6C99\u5C3C\u4E9A"],"\u{1F1EA}\u{1F1EC}":["Egypt","\u57C3\u53CA"],"\u{1F1EA}\u{1F1F8}":["Spain","\u897F\u73ED\u7259"],"\u{1F1EA}\u{1F1FA}":["European Union","\u6B27\u76DF","\u6B27\u7F57\u5DF4"],"\u{1F1EB}\u{1F1EE}":["Finland","\u82AC\u5170","\u82AC\u862D","\u8D6B\u5C14\u8F9B\u57FA"],"\u{1F1EB}\u{1F1F7}":["France","\u6CD5\u56FD","\u6CD5\u570B","\u5DF4\u9ECE"],"\u{1F1EC}\u{1F1E7}":["Great Britain","\u82F1\u56FD","England","United Kingdom","\u4F26\u6566","\u82F1","London"],"\u{1F1EC}\u{1F1EA}":["Georgia","\u683C\u9C81\u5409\u4E9A","\u683C\u9B6F\u5409\u4E9E"],"\u{1F1EC}\u{1F1F7}":["Greece","\u5E0C\u814A","\u5E0C\u81D8"],"\u{1F1EC}\u{1F1F9}":["Guatemala","\u5371\u5730\u9A6C\u62C9"],"\u{1F1ED}\u{1F1F0}":["Hongkong","\u9999\u6E2F","Hong Kong","HongKong","HONG KONG","\u6DF1\u6E2F","\u6CAA\u6E2F","\u547C\u6E2F","\u7A57\u6E2F","\u4EAC\u6E2F","\u6E2F"],"\u{1F1ED}\u{1F1F7}":["Croatia","\u514B\u7F57\u5730\u4E9A","\u514B\u7F85\u5730\u4E9E"],"\u{1F1ED}\u{1F1FA}":["Hungary","\u5308\u7259\u5229"],"\u{1F1EF}\u{1F1F4}":["Jordan","\u7EA6\u65E6"],"\u{1F1EF}\u{1F1F5}":["Japan","\u65E5\u672C","\u4E1C\u4EAC","\u5927\u962A","\u57FC\u7389","\u6CAA\u65E5","\u7A57\u65E5","\u5DDD\u65E5","\u4E2D\u65E5","\u6CC9\u65E5","\u676D\u65E5","\u6DF1\u65E5","\u8FBD\u65E5","\u5E7F\u65E5","\u5927\u5742","Osaka","Tokyo"],"\u{1F1F0}\u{1F1EA}":["Kenya","\u80AF\u5C3C\u4E9A"],"\u{1F1F0}\u{1F1EC}":["Kyrgyzstan","\u5409\u5C14\u5409\u65AF\u65AF\u5766"],"\u{1F1F0}\u{1F1ED}":["Cambodia","\u67EC\u57D4\u5BE8"],"\u{1F1F0}\u{1F1F5}":["North Korea","\u671D\u9C9C"],"\u{1F1F0}\u{1F1F7}":["Korea","\u97E9\u56FD","\u97D3\u570B","\u97E9","\u97D3","\u9996\u5C14","\u6625\u5DDD","Chuncheon","Seoul"],"\u{1F1F0}\u{1F1FF}":["Kazakhstan","\u54C8\u8428\u514B\u65AF\u5766","\u54C8\u8428\u514B"],"\u{1F1EE}\u{1F1E9}":["Indonesia","\u5370\u5C3C","\u5370\u5EA6\u5C3C\u897F\u4E9A","\u96C5\u52A0\u8FBE"],"\u{1F1EE}\u{1F1EA}":["Ireland","\u7231\u5C14\u5170","\u611B\u723E\u862D","\u90FD\u67CF\u6797"],"\u{1F1EE}\u{1F1F1}":["Israel","\u4EE5\u8272\u5217"],"\u{1F1EE}\u{1F1F2}":["Isle of Man","\u9A6C\u6069\u5C9B","\u99AC\u6069\u5CF6"],"\u{1F1EE}\u{1F1F3}":["India","\u5370\u5EA6","\u5B5F\u4E70","MFumbai","Mumbai"],"\u{1F1EE}\u{1F1F7}":["Iran","\u4F0A\u6717"],"\u{1F1EE}\u{1F1F8}":["Iceland","\u51B0\u5C9B","\u51B0\u5CF6"],"\u{1F1EE}\u{1F1F9}":["Italy","\u610F\u5927\u5229","\u7FA9\u5927\u5229","\u7C73\u5170","Nachash"],"\u{1F1F1}\u{1F1F9}":["Lithuania","\u7ACB\u9676\u5B9B"],"\u{1F1F1}\u{1F1FA}":["Luxembourg","\u5362\u68EE\u5821"],"\u{1F1F1}\u{1F1FB}":["Latvia","\u62C9\u8131\u7EF4\u4E9A","Latvija"],"\u{1F1F2}\u{1F1E6}":["Morocco","\u6469\u6D1B\u54E5"],"\u{1F1F2}\u{1F1E9}":["Moldova","\u6469\u5C14\u591A\u74E6","\u6469\u723E\u591A\u74E6"],"\u{1F1F3}\u{1F1EC}":["Nigeria","\u5C3C\u65E5\u5229\u4E9A","\u5C3C\u65E5\u5229\u4E9E"],"\u{1F1F2}\u{1F1F0}":["Macedonia","\u9A6C\u5176\u987F","\u99AC\u5176\u9813"],"\u{1F1F2}\u{1F1F3}":["Mongolia","\u8499\u53E4"],"\u{1F1F2}\u{1F1F4}":["Macao","\u6FB3\u95E8","\u6FB3\u9580","CTM"],"\u{1F1F2}\u{1F1F9}":["Malta","\u9A6C\u8033\u4ED6"],"\u{1F1F2}\u{1F1FD}":["Mexico","\u58A8\u897F\u54E5"],"\u{1F1F2}\u{1F1FE}":["Malaysia","\u9A6C\u6765","\u99AC\u4F86","\u5409\u9686\u5761","\u5927\u99AC"],"\u{1F1F3}\u{1F1F1}":["Netherlands","\u8377\u5170","\u8377\u862D","\u5C3C\u5FB7\u862D","\u963F\u59C6\u65AF\u7279\u4E39","Amsterdam"],"\u{1F1F3}\u{1F1F4}":["Norway","\u632A\u5A01"],"\u{1F1F3}\u{1F1F5}":["Nepal","\u5C3C\u6CCA\u5C14"],"\u{1F1F3}\u{1F1FF}":["New Zealand","\u65B0\u897F\u5170","\u65B0\u897F\u862D"],"\u{1F1F5}\u{1F1E6}":["Panama","\u5DF4\u62FF\u9A6C"],"\u{1F1F5}\u{1F1EA}":["Peru","\u79D8\u9C81","\u7955\u9B6F"],"\u{1F1F5}\u{1F1ED}":["Philippines","\u83F2\u5F8B\u5BBE","\u83F2\u5F8B\u8CD3"],"\u{1F1F5}\u{1F1F0}":["Pakistan","\u5DF4\u57FA\u65AF\u5766"],"\u{1F1F5}\u{1F1F1}":["Poland","\u6CE2\u5170","\u6CE2\u862D","\u534E\u6C99","Warsaw"],"\u{1F1F5}\u{1F1F7}":["Puerto Rico","\u6CE2\u591A\u9ECE\u5404"],"\u{1F1F5}\u{1F1F9}":["Portugal","\u8461\u8404\u7259"],"\u{1F1F5}\u{1F1FE}":["Paraguay","\u5DF4\u62C9\u572D"],"\u{1F1F7}\u{1F1F4}":["Romania","\u7F57\u9A6C\u5C3C\u4E9A"],"\u{1F1F7}\u{1F1F8}":["Serbia","\u585E\u5C14\u7EF4\u4E9A"],"\u{1F1F7}\u{1F1EA}":["R\xE9union","\u7559\u5C3C\u6C6A","\u6CD5\u5C5E\u7559\u5C3C\u6C6A"],"\u{1F1F7}\u{1F1FA}":["Russia","\u4FC4\u7F57\u65AF","\u4FC4\u56FD","\u4FC4\u7F85\u65AF","\u4F2F\u529B","\u83AB\u65AF\u79D1","\u5723\u5F7C\u5F97\u5821","\u897F\u4F2F\u5229\u4E9A","\u4EAC\u4FC4","\u676D\u4FC4","\u5EE3\u4FC4","\u6EEC\u4FC4","\u5E7F\u4FC4","\u6CAA\u4FC4","Moscow"],"\u{1F1F8}\u{1F1E6}":["Saudi","\u6C99\u7279\u963F\u62C9\u4F2F","\u6C99\u7279","Riyadh","\u5229\u96C5\u5F97"],"\u{1F1F8}\u{1F1EA}":["Sweden","\u745E\u5178","\u65AF\u5FB7\u54E5\u5C14\u6469","Stockholm"],"\u{1F1F8}\u{1F1EC}":["Singapore","\u65B0\u52A0\u5761","\u72EE\u57CE","\u6CAA\u65B0","\u4EAC\u65B0","\u4E2D\u65B0","\u6CC9\u65B0","\u7A57\u65B0","\u6DF1\u65B0","\u676D\u65B0","\u5E7F\u65B0","\u5EE3\u65B0","\u6EEC\u65B0"],"\u{1F1F8}\u{1F1EE}":["Slovenia","\u65AF\u6D1B\u6587\u5C3C\u4E9A"],"\u{1F1F8}\u{1F1F0}":["Slovakia","\u65AF\u6D1B\u4F10\u514B"],"\u{1F1F9}\u{1F1ED}":["Thailand","\u6CF0\u56FD","\u6CF0\u570B","\u66FC\u8C37"],"\u{1F1F9}\u{1F1F3}":["Tunisia","\u7A81\u5C3C\u65AF"],"\u{1F1F9}\u{1F1F7}":["Turkey","\u571F\u8033\u5176","\u4F0A\u65AF\u5766\u5E03\u5C14","Istanbul"],"\u{1F1F9}\u{1F1FC}":["Taiwan","\u53F0\u6E7E","\u81FA\u7063","\u53F0\u7063","\u4E2D\u83EF\u6C11\u570B","\u4E2D\u534E\u6C11\u56FD","\u53F0\u5317","\u53F0\u4E2D","\u65B0\u5317","\u5F70\u5316","\u53F0","\u81FA","Taipei","Tai Wan"],"\u{1F1FA}\u{1F1E6}":["Ukraine","\u4E4C\u514B\u5170","\u70CF\u514B\u862D"],"\u{1F1FA}\u{1F1F8}":["United States","\u7F8E\u56FD","America","\u7F8E","\u4EAC\u7F8E","\u6CE2\u7279\u5170","\u8FBE\u62C9\u65AF","\u4FC4\u52D2\u5188","Oregon","\u51E4\u51F0\u57CE","\u8D39\u5229\u8499","\u7845\u8C37","\u77FD\u8C37","\u62C9\u65AF\u7EF4\u52A0\u65AF","\u6D1B\u6749\u77F6","\u5723\u4F55\u585E","\u5723\u514B\u62C9\u62C9","\u897F\u96C5\u56FE","\u829D\u52A0\u54E5","\u6CAA\u7F8E","\u54E5\u4F26\u5E03","\u7EBD\u7EA6","New York","Los Angeles","San Jose","Sillicon Valley","Michigan","\u4FC4\u4EA5\u4FC4","Ohio","\u9A6C\u7EB3\u8428\u65AF","Manassas","\u5F17\u5409\u5C3C\u4E9A","Virginia"],"\u{1F1FA}\u{1F1FE}":["Uruguay","\u4E4C\u62C9\u572D"],"\u{1F1FB}\u{1F1EA}":["Venezuela","\u59D4\u5185\u745E\u62C9"],"\u{1F1FB}\u{1F1F3}":["Vietnam","\u8D8A\u5357","\u80E1\u5FD7\u660E"],"\u{1F1FF}\u{1F1E6}":["South Africa","\u5357\u975E"],"\u{1F1E8}\u{1F1F3}":["China","\u4E2D\u56FD","\u4E2D\u570B","\u56DE\u56FD","\u56DE\u570B","\u56FD\u5185","\u570B\u5167","\u534E\u4E1C","\u534E\u897F","\u534E\u5357","\u534E\u5317","\u534E\u4E2D","\u6C5F\u82CF","\u5317\u4EAC","\u4E0A\u6D77","\u5E7F\u5DDE","\u6DF1\u5733","\u676D\u5DDE","\u5F90\u5DDE","\u9752\u5C9B","\u5B81\u6CE2","\u9547\u6C5F"]},r=((e=t.match(/[\uD83C][\uDDE6-\uDDFF][\uD83C][\uDDE6-\uDDFF]/))===null||e===void 0?void 0:e[0])||"\u{1F3F4}\u200D\u2620\uFE0F",o=0,f=Object.keys(n);o<f.length;o++){var d=f[o];if(n[d].some(function(S){return RegExp("".concat(S),"i").test(t)}))return/\u5185\u8499\u53e4/.test(t)&&["\u{1F1F2}\u{1F1F3}"].includes(d)?"\u{1F1E8}\u{1F1F3}":d}for(var h=0,y=Object.keys(ISOFlags);h<y.length;h++){var F=y[h];if(ISOFlags[F].some(function(S){return RegExp("(^|[^a-zA-Z])".concat(S,"([^a-zA-Z]|$)")).test(t)})&&(F!="\u{1F1E8}\u{1F1F3}"||!RegExp("(^|[^a-zA-Z])CN2([^a-zA-Z]|$)").test(t)))return F}return r}function getISO(t){var e;return(e=ISOFlags[getFlag(t)])===null||e===void 0?void 0:e[0]}function removeFlag(t){return t.replace(/[\uD83C][\uDDE6-\uDDFF][\uD83C][\uDDE6-\uDDFF]|\ud83c\udff4\u200d\u2620\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08/g,"").trim()}var MMDB=function(){function MMDB(){var _ref=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},country=_ref.country,asn=_ref.asn;if(___classCallCheck_138(this,MMDB),___app_138.default.env.isNode){var Reader=require("@maxmind/geoip2-node").Reader,fs=require("fs"),countryFile=country||eval("process.env.SUB_STORE_MMDB_COUNTRY_PATH"),asnFile=asn||eval("process.env.SUB_STORE_MMDB_ASN_PATH");if(countryFile&&(this.countryReader=Reader.openBuffer(fs.readFileSync(countryFile))),asnFile){if(!fs.existsSync(asnFile))throw new Error("GeoLite2 ASN MMDB does not exist");this.asnReader=Reader.openBuffer(fs.readFileSync(asnFile))}}}return ___createClass_138(MMDB,[{key:"geoip",value:function(t){var e,n,r;return(e=this.countryReader)===null||e===void 0||(n=e.country(t))===null||n===void 0||(r=n.country)===null||r===void 0?void 0:r.isoCode}},{key:"ipaso",value:function(t){var e,n;return(e=this.asnReader)===null||e===void 0||(n=e.asn(t))===null||n===void 0?void 0:n.autonomousSystemOrganization}},{key:"ipasn",value:function(t){var e,n;return(e=this.asnReader)===null||e===void 0||(n=e.asn(t))===null||n===void 0?void 0:n.autonomousSystemNumber}}]),MMDB}();_$geo_138.MMDB=MMDB;var _$types_9={toString:function(t){switch(t){case 1:return"A";case 10:return"NULL";case 28:return"AAAA";case 18:return"AFSDB";case 42:return"APL";case 257:return"CAA";case 60:return"CDNSKEY";case 59:return"CDS";case 37:return"CERT";case 5:return"CNAME";case 49:return"DHCID";case 32769:return"DLV";case 39:return"DNAME";case 48:return"DNSKEY";case 43:return"DS";case 55:return"HIP";case 13:return"HINFO";case 45:return"IPSECKEY";case 25:return"KEY";case 36:return"KX";case 29:return"LOC";case 15:return"MX";case 35:return"NAPTR";case 2:return"NS";case 47:return"NSEC";case 50:return"NSEC3";case 51:return"NSEC3PARAM";case 12:return"PTR";case 46:return"RRSIG";case 17:return"RP";case 24:return"SIG";case 6:return"SOA";case 99:return"SPF";case 33:return"SRV";case 44:return"SSHFP";case 32768:return"TA";case 249:return"TKEY";case 52:return"TLSA";case 250:return"TSIG";case 16:return"TXT";case 252:return"AXFR";case 251:return"IXFR";case 41:return"OPT";case 255:return"ANY"}return"UNKNOWN_"+t},toType:function(t){switch(t.toUpperCase()){case"A":return 1;case"NULL":return 10;case"AAAA":return 28;case"AFSDB":return 18;case"APL":return 42;case"CAA":return 257;case"CDNSKEY":return 60;case"CDS":return 59;case"CERT":return 37;case"CNAME":return 5;case"DHCID":return 49;case"DLV":return 32769;case"DNAME":return 39;case"DNSKEY":return 48;case"DS":return 43;case"HIP":return 55;case"HINFO":return 13;case"IPSECKEY":return 45;case"KEY":return 25;case"KX":return 36;case"LOC":return 29;case"MX":return 15;case"NAPTR":return 35;case"NS":return 2;case"NSEC":return 47;case"NSEC3":return 50;case"NSEC3PARAM":return 51;case"PTR":return 12;case"RRSIG":return 46;case"RP":return 17;case"SIG":return 24;case"SOA":return 6;case"SPF":return 99;case"SRV":return 33;case"SSHFP":return 44;case"TA":return 32768;case"TKEY":return 249;case"TLSA":return 52;case"TSIG":return 250;case"TXT":return 16;case"AXFR":return 252;case"IXFR":return 251;case"OPT":return 41;case"ANY":case"*":return 255}return t.toUpperCase().startsWith("UNKNOWN_")?parseInt(t.slice(8)):0}},_$rcodes_8={toString:function(t){switch(t){case 0:return"NOERROR";case 1:return"FORMERR";case 2:return"SERVFAIL";case 3:return"NXDOMAIN";case 4:return"NOTIMP";case 5:return"REFUSED";case 6:return"YXDOMAIN";case 7:return"YXRRSET";case 8:return"NXRRSET";case 9:return"NOTAUTH";case 10:return"NOTZONE";case 11:return"RCODE_11";case 12:return"RCODE_12";case 13:return"RCODE_13";case 14:return"RCODE_14";case 15:return"RCODE_15"}return"RCODE_"+t},toRcode:function(t){switch(t.toUpperCase()){case"NOERROR":return 0;case"FORMERR":return 1;case"SERVFAIL":return 2;case"NXDOMAIN":return 3;case"NOTIMP":return 4;case"REFUSED":return 5;case"YXDOMAIN":return 6;case"YXRRSET":return 7;case"NXRRSET":return 8;case"NOTAUTH":return 9;case"NOTZONE":return 10;case"RCODE_11":return 11;case"RCODE_12":return 12;case"RCODE_13":return 13;case"RCODE_14":return 14;case"RCODE_15":return 15}return 0}},_$opcodes_6={toString:function(t){switch(t){case 0:return"QUERY";case 1:return"IQUERY";case 2:return"STATUS";case 3:return"OPCODE_3";case 4:return"NOTIFY";case 5:return"UPDATE";case 6:return"OPCODE_6";case 7:return"OPCODE_7";case 8:return"OPCODE_8";case 9:return"OPCODE_9";case 10:return"OPCODE_10";case 11:return"OPCODE_11";case 12:return"OPCODE_12";case 13:return"OPCODE_13";case 14:return"OPCODE_14";case 15:return"OPCODE_15"}return"OPCODE_"+t},toOpcode:function(t){switch(t.toUpperCase()){case"QUERY":return 0;case"IQUERY":return 1;case"STATUS":return 2;case"OPCODE_3":return 3;case"NOTIFY":return 4;case"UPDATE":return 5;case"OPCODE_6":return 6;case"OPCODE_7":return 7;case"OPCODE_8":return 8;case"OPCODE_9":return 9;case"OPCODE_10":return 10;case"OPCODE_11":return 11;case"OPCODE_12":return 12;case"OPCODE_13":return 13;case"OPCODE_14":return 14;case"OPCODE_15":return 15}return 0}},_$classes_4={toString:function(t){switch(t){case 1:return"IN";case 2:return"CS";case 3:return"CH";case 4:return"HS";case 255:return"ANY"}return"UNKNOWN_"+t},toClass:function(t){switch(t.toUpperCase()){case"IN":return 1;case"CS":return 2;case"CH":return 3;case"HS":return 4;case"ANY":return 255}return 0}},_$optioncodes_7={toString:function(t){switch(t){case 1:return"LLQ";case 2:return"UL";case 3:return"NSID";case 5:return"DAU";case 6:return"DHU";case 7:return"N3U";case 8:return"CLIENT_SUBNET";case 9:return"EXPIRE";case 10:return"COOKIE";case 11:return"TCP_KEEPALIVE";case 12:return"PADDING";case 13:return"CHAIN";case 14:return"KEY_TAG";case 26946:return"DEVICEID"}return t<0?null:"OPTION_"+t},toCode:function(t){if(typeof t=="number")return t;if(!t)return-1;switch(t.toUpperCase()){case"OPTION_0":return 0;case"LLQ":return 1;case"UL":return 2;case"NSID":return 3;case"OPTION_4":return 4;case"DAU":return 5;case"DHU":return 6;case"N3U":return 7;case"CLIENT_SUBNET":return 8;case"EXPIRE":return 9;case"COOKIE":return 10;case"TCP_KEEPALIVE":return 11;case"PADDING":return 12;case"CHAIN":return 13;case"KEY_TAG":return 14;case"DEVICEID":return 26946;case"OPTION_65535":return 65535}const e=t.match(/_(\d+)$/);return e?parseInt(e[1],10):-1}},_$index_1={exports:{}},ipCodec=function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decode=function(d,h,y){if(h=~~h,(y=y||d.length-h)===r.size)return r.decode(d,h,y);if(y===o.size)return o.decode(d,h,y);throw Error(`Invalid buffer size needs to be ${r.size} for v4 or ${o.size} for v6.`)},t.encode=function(d,h,y){y=~~y;const F=f(d);return typeof h=="function"&&(h=h(y+F)),F===r.size?r.encode(d,h,y):o.encode(d,h,y)},t.familyOf=function(d){return f(d)===r.size?1:2},t.name=void 0,t.sizeOf=f,t.v6=t.v4=void 0;const e=/^(\d{1,3}\.){3,3}\d{1,3}$/,n=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i,r={name:"v4",size:4,isFormat:d=>e.test(d),encode(d,h,y){y=~~y,h=h||new Uint8Array(y+4);const F=d.length;let S=0;for(let T=0;T<F;){const U=d.charCodeAt(T++);U===46?(h[y++]=S,S=0):S=10*S+(U-48)}return h[y]=S,h},decode:(d,h)=>(h=~~h,`${d[h++]}.${d[h++]}.${d[h++]}.${d[h]}`)};t.v4=r;const o={name:"v6",size:16,isFormat:d=>d.length>0&&n.test(d),encode(d,h,y){let F=16+(y=~~y),S=-1,T=0,U=0,M=!0,Y=!1;h=h||new Uint8Array(y+16);for(let Z=0;Z<d.length;Z++){let D=d.charCodeAt(Z);D===58?(M?S!==-1?(y<F&&(h[y]=0),y<F-1&&(h[y+1]=0),y+=2):y<F&&(S=y):(Y===!0?(y<F&&(h[y]=U),y++):(y<F&&(h[y]=T>>8),y<F-1&&(h[y+1]=255&T),y+=2),T=0,U=0),M=!0,Y=!1):D===46?(y<F&&(h[y]=U),y++,U=0,T=0,M=!1,Y=!0):(M=!1,D>=97?D-=87:D>=65?D-=55:U=10*U+(D-=48),T=(T<<4)+D)}if(M===!1)Y===!0?(y<F&&(h[y]=U),y++):(y<F&&(h[y]=T>>8),y<F-1&&(h[y+1]=255&T),y+=2);else if(S===0)y<F&&(h[y]=0),y<F-1&&(h[y+1]=0),y+=2;else if(S!==-1){y+=2;for(let Z=Math.min(y-1,F-1);Z>=S+2;Z--)h[Z]=h[Z-2];h[S]=0,h[S+1]=0,S=y}if(S!==y&&S!==-1)for(y>F-2&&(y=F-2);F>S;)h[--F]=y<F&&y>S?h[--y]:0;else for(;y<F;)h[y++]=0;return h},decode(d,h){h=~~h;let y="";for(let F=0;F<16;F+=2)F!==0&&(y+=":"),y+=(d[h+F]<<8|d[h+F+1]).toString(16);return y.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}};function f(d){if(r.isFormat(d))return r.size;if(o.isFormat(d))return o.size;throw Error("Invalid ip address: "+d)}return t.v6=o,t.name="ip","default"in t?t.default:t}({});typeof define=="function"&&define.amd?define([],function(){return ipCodec}):typeof _$index_1.exports=="object"&&(_$index_1.exports=ipCodec),_$index_1=_$index_1.exports;var _$dnsPacket_5={};const Buffer=_$buffer_3({}).Buffer,name=_$dnsPacket_5.name={};name.encode=function(t,e,n,{mail:r=!1}={}){e||(e=Buffer.alloc(name.encodingLength(t))),n||(n=0);const o=n,f=t.replace(/^\.|\.$/gm,"");if(f.length){let d=[];if(r){let h="";f.split(".").forEach(y=>{y.endsWith("\\")?h+=(h.length?".":"")+y.slice(0,-1):d.length===0&&h.length?d.push(h+"."+y):d.push(y)})}else d=f.split(".");for(let h=0;h<d.length;h++){const y=e.write(d[h],n+1);e[n]=y,n+=y+1}}return e[n++]=0,name.encode.bytes=n-o,e},name.encode.bytes=0,name.decode=function(t,e,{mail:n=!1}={}){e||(e=0);const r=[];let o=e,f=0,d=0,h=!1;for(;;){if(e>=t.length)throw new Error("Cannot decode name (buffer overflow)");const y=t[e++];if(d+=h?0:1,y===0)break;if(192&y){if((192&y)!=192)throw new Error("Cannot decode name (bad label)");{if(e+1>t.length)throw new Error("Cannot decode name (buffer overflow)");const F=t.readUInt16BE(e-1)-49152;if(F>=o)throw new Error("Cannot decode name (bad pointer)");e=F,o=F,d+=h?0:1,h=!0}}else{if(e+y>t.length)throw new Error("Cannot decode name (buffer overflow)");if((f+=y+1)>254)throw new Error("Cannot decode name (name too long)");let F=t.toString("utf-8",e,e+y);n&&(F=F.replace(/\./g,"\\.")),r.push(F),e+=y,d+=h?0:y}}return name.decode.bytes=d,r.length===0?".":r.join(".")},name.decode.bytes=0,name.encodingLength=function(t){return t==="."||t===".."?1:Buffer.byteLength(t.replace(/^\.|\.$/gm,""))+2};const string={encode:function(t,e,n){e||(e=Buffer.alloc(string.encodingLength(t))),n||(n=0);const r=e.write(t,n+1);return e[n]=r,string.encode.bytes=r+1,e}};string.encode.bytes=0,string.decode=function(t,e){e||(e=0);const n=t[e],r=t.toString("utf-8",e+1,e+1+n);return string.decode.bytes=n+1,r},string.decode.bytes=0,string.encodingLength=function(t){return Buffer.byteLength(t)+1};const header={encode:function(t,e,n){e||(e=header.encodingLength(t)),n||(n=0);const r=32767&(t.flags||0),o=t.type==="response"?32768:0;return e.writeUInt16BE(t.id||0,n),e.writeUInt16BE(r|o,n+2),e.writeUInt16BE(t.questions.length,n+4),e.writeUInt16BE(t.answers.length,n+6),e.writeUInt16BE(t.authorities.length,n+8),e.writeUInt16BE(t.additionals.length,n+10),e}};header.encode.bytes=12,header.decode=function(t,e){if(e||(e=0),t.length<12)throw new Error("Header must be 12 bytes");const n=t.readUInt16BE(e+2);return{id:t.readUInt16BE(e),type:32768&n?"response":"query",flags:32767&n,flag_qr:(n>>15&1)==1,opcode:_$opcodes_6.toString(n>>11&15),flag_aa:(n>>10&1)==1,flag_tc:(n>>9&1)==1,flag_rd:(n>>8&1)==1,flag_ra:(n>>7&1)==1,flag_z:(n>>6&1)==1,flag_ad:(n>>5&1)==1,flag_cd:(n>>4&1)==1,rcode:_$rcodes_8.toString(15&n),questions:new Array(t.readUInt16BE(e+4)),answers:new Array(t.readUInt16BE(e+6)),authorities:new Array(t.readUInt16BE(e+8)),additionals:new Array(t.readUInt16BE(e+10))}},header.decode.bytes=12,header.encodingLength=function(){return 12};const runknown=_$dnsPacket_5.unknown={};runknown.encode=function(t,e,n){return e||(e=Buffer.alloc(runknown.encodingLength(t))),n||(n=0),e.writeUInt16BE(t.length,n),t.copy(e,n+2),runknown.encode.bytes=t.length+2,e},runknown.encode.bytes=0,runknown.decode=function(t,e){e||(e=0);const n=t.readUInt16BE(e),r=t.slice(e+2,e+2+n);return runknown.decode.bytes=n+2,r},runknown.decode.bytes=0,runknown.encodingLength=function(t){return t.length+2};const rns=_$dnsPacket_5.ns={};rns.encode=function(t,e,n){return e||(e=Buffer.alloc(rns.encodingLength(t))),n||(n=0),name.encode(t,e,n+2),e.writeUInt16BE(name.encode.bytes,n),rns.encode.bytes=name.encode.bytes+2,e},rns.encode.bytes=0,rns.decode=function(t,e){e||(e=0);const n=t.readUInt16BE(e),r=name.decode(t,e+2);return rns.decode.bytes=n+2,r},rns.decode.bytes=0,rns.encodingLength=function(t){return name.encodingLength(t)+2};const rsoa=_$dnsPacket_5.soa={};rsoa.encode=function(t,e,n){e||(e=Buffer.alloc(rsoa.encodingLength(t))),n||(n=0);const r=n;return n+=2,name.encode(t.mname,e,n),n+=name.encode.bytes,name.encode(t.rname,e,n,{mail:!0}),n+=name.encode.bytes,e.writeUInt32BE(t.serial||0,n),n+=4,e.writeUInt32BE(t.refresh||0,n),n+=4,e.writeUInt32BE(t.retry||0,n),n+=4,e.writeUInt32BE(t.expire||0,n),n+=4,e.writeUInt32BE(t.minimum||0,n),n+=4,e.writeUInt16BE(n-r-2,r),rsoa.encode.bytes=n-r,e},rsoa.encode.bytes=0,rsoa.decode=function(t,e){e||(e=0);const n=e,r={};return e+=2,r.mname=name.decode(t,e),e+=name.decode.bytes,r.rname=name.decode(t,e,{mail:!0}),e+=name.decode.bytes,r.serial=t.readUInt32BE(e),e+=4,r.refresh=t.readUInt32BE(e),e+=4,r.retry=t.readUInt32BE(e),e+=4,r.expire=t.readUInt32BE(e),e+=4,r.minimum=t.readUInt32BE(e),e+=4,rsoa.decode.bytes=e-n,r},rsoa.decode.bytes=0,rsoa.encodingLength=function(t){return 22+name.encodingLength(t.mname)+name.encodingLength(t.rname)};const rtxt=_$dnsPacket_5.txt={};rtxt.encode=function(t,e,n){Array.isArray(t)||(t=[t]);for(let o=0;o<t.length;o++)if(typeof t[o]=="string"&&(t[o]=Buffer.from(t[o])),!Buffer.isBuffer(t[o]))throw new Error("Must be a Buffer");e||(e=Buffer.alloc(rtxt.encodingLength(t))),n||(n=0);const r=n;return n+=2,t.forEach(function(o){e[n++]=o.length,o.copy(e,n,0,o.length),n+=o.length}),e.writeUInt16BE(n-r-2,r),rtxt.encode.bytes=n-r,e},rtxt.encode.bytes=0,rtxt.decode=function(t,e){e||(e=0);const n=e;let r=t.readUInt16BE(e);e+=2;let o=[];for(;r>0;){const f=t[e++];if(--r<f)throw new Error("Buffer overflow");o.push(t.slice(e,e+f)),e+=f,r-=f}return rtxt.decode.bytes=e-n,o},rtxt.decode.bytes=0,rtxt.encodingLength=function(t){Array.isArray(t)||(t=[t]);let e=2;return t.forEach(function(n){e+=typeof n=="string"?Buffer.byteLength(n)+1:n.length+1}),e};const rnull=_$dnsPacket_5.null={};rnull.encode=function(t,e,n){e||(e=Buffer.alloc(rnull.encodingLength(t))),n||(n=0),typeof t=="string"&&(t=Buffer.from(t)),t||(t=Buffer.alloc(0));const r=n;n+=2;const o=t.length;return t.copy(e,n,0,o),n+=o,e.writeUInt16BE(n-r-2,r),rnull.encode.bytes=n-r,e},rnull.encode.bytes=0,rnull.decode=function(t,e){e||(e=0);const n=e,r=t.readUInt16BE(e);e+=2;const o=t.slice(e,e+r);return e+=r,rnull.decode.bytes=e-n,o},rnull.decode.bytes=0,rnull.encodingLength=function(t){return t?(Buffer.isBuffer(t)?t.length:Buffer.byteLength(t))+2:2};const rhinfo=_$dnsPacket_5.hinfo={};rhinfo.encode=function(t,e,n){e||(e=Buffer.alloc(rhinfo.encodingLength(t))),n||(n=0);const r=n;return n+=2,string.encode(t.cpu,e,n),n+=string.encode.bytes,string.encode(t.os,e,n),n+=string.encode.bytes,e.writeUInt16BE(n-r-2,r),rhinfo.encode.bytes=n-r,e},rhinfo.encode.bytes=0,rhinfo.decode=function(t,e){e||(e=0);const n=e,r={};return e+=2,r.cpu=string.decode(t,e),e+=string.decode.bytes,r.os=string.decode(t,e),e+=string.decode.bytes,rhinfo.decode.bytes=e-n,r},rhinfo.decode.bytes=0,rhinfo.encodingLength=function(t){return string.encodingLength(t.cpu)+string.encodingLength(t.os)+2};const rptr=_$dnsPacket_5.ptr={},rcname=_$dnsPacket_5.cname=rptr,rdname=_$dnsPacket_5.dname=rptr;rptr.encode=function(t,e,n){return e||(e=Buffer.alloc(rptr.encodingLength(t))),n||(n=0),name.encode(t,e,n+2),e.writeUInt16BE(name.encode.bytes,n),rptr.encode.bytes=name.encode.bytes+2,e},rptr.encode.bytes=0,rptr.decode=function(t,e){e||(e=0);const n=name.decode(t,e+2);return rptr.decode.bytes=name.decode.bytes+2,n},rptr.decode.bytes=0,rptr.encodingLength=function(t){return name.encodingLength(t)+2};const rsrv=_$dnsPacket_5.srv={};rsrv.encode=function(t,e,n){e||(e=Buffer.alloc(rsrv.encodingLength(t))),n||(n=0),e.writeUInt16BE(t.priority||0,n+2),e.writeUInt16BE(t.weight||0,n+4),e.writeUInt16BE(t.port||0,n+6),name.encode(t.target,e,n+8);const r=name.encode.bytes+6;return e.writeUInt16BE(r,n),rsrv.encode.bytes=r+2,e},rsrv.encode.bytes=0,rsrv.decode=function(t,e){e||(e=0);const n=t.readUInt16BE(e),r={};return r.priority=t.readUInt16BE(e+2),r.weight=t.readUInt16BE(e+4),r.port=t.readUInt16BE(e+6),r.target=name.decode(t,e+8),rsrv.decode.bytes=n+2,r},rsrv.decode.bytes=0,rsrv.encodingLength=function(t){return 8+name.encodingLength(t.target)};const rcaa=_$dnsPacket_5.caa={};rcaa.ISSUER_CRITICAL=128,rcaa.encode=function(t,e,n){const r=rcaa.encodingLength(t);return e||(e=Buffer.alloc(rcaa.encodingLength(t))),n||(n=0),t.issuerCritical&&(t.flags=rcaa.ISSUER_CRITICAL),e.writeUInt16BE(r-2,n),n+=2,e.writeUInt8(t.flags||0,n),n+=1,string.encode(t.tag,e,n),n+=string.encode.bytes,e.write(t.value,n),n+=Buffer.byteLength(t.value),rcaa.encode.bytes=r,e},rcaa.encode.bytes=0,rcaa.decode=function(t,e){e||(e=0);const n=t.readUInt16BE(e),r=e+=2,o={};return o.flags=t.readUInt8(e),e+=1,o.tag=string.decode(t,e),e+=string.decode.bytes,o.value=t.toString("utf-8",e,r+n),o.issuerCritical=!!(o.flags&rcaa.ISSUER_CRITICAL),rcaa.decode.bytes=n+2,o},rcaa.decode.bytes=0,rcaa.encodingLength=function(t){return string.encodingLength(t.tag)+string.encodingLength(t.value)+2};const rmx=_$dnsPacket_5.mx={};rmx.encode=function(t,e,n){e||(e=Buffer.alloc(rmx.encodingLength(t))),n||(n=0);const r=n;return n+=2,e.writeUInt16BE(t.preference||0,n),n+=2,name.encode(t.exchange,e,n),n+=name.encode.bytes,e.writeUInt16BE(n-r-2,r),rmx.encode.bytes=n-r,e},rmx.encode.bytes=0,rmx.decode=function(t,e){e||(e=0);const n=e,r={};return e+=2,r.preference=t.readUInt16BE(e),e+=2,r.exchange=name.decode(t,e),e+=name.decode.bytes,rmx.decode.bytes=e-n,r},rmx.encodingLength=function(t){return 4+name.encodingLength(t.exchange)};const ra=_$dnsPacket_5.a={};ra.encode=function(t,e,n){return e||(e=Buffer.alloc(ra.encodingLength(t))),n||(n=0),e.writeUInt16BE(4,n),n+=2,_$index_1.v4.encode(t,e,n),ra.encode.bytes=6,e},ra.encode.bytes=0,ra.decode=function(t,e){e||(e=0),e+=2;const n=_$index_1.v4.decode(t,e);return ra.decode.bytes=6,n},ra.decode.bytes=0,ra.encodingLength=function(){return 6};const raaaa=_$dnsPacket_5.aaaa={};raaaa.encode=function(t,e,n){return e||(e=Buffer.alloc(raaaa.encodingLength(t))),n||(n=0),e.writeUInt16BE(16,n),n+=2,_$index_1.v6.encode(t,e,n),raaaa.encode.bytes=18,e},raaaa.encode.bytes=0,raaaa.decode=function(t,e){e||(e=0),e+=2;const n=_$index_1.v6.decode(t,e);return raaaa.decode.bytes=18,n},raaaa.decode.bytes=0,raaaa.encodingLength=function(){return 18};const roption=_$dnsPacket_5.option={};roption.encode=function(t,e,n){e||(e=Buffer.alloc(roption.encodingLength(t))),n||(n=0);const r=n,o=_$optioncodes_7.toCode(t.code);if(e.writeUInt16BE(o,n),n+=2,t.data)e.writeUInt16BE(t.data.length,n),n+=2,t.data.copy(e,n),n+=t.data.length;else switch(o){case 8:const f=t.sourcePrefixLength||0,d=t.family||_$index_1.familyOf(t.ip),h=_$index_1.encode(t.ip,Buffer.alloc),y=Math.ceil(f/8);e.writeUInt16BE(y+4,n),n+=2,e.writeUInt16BE(d,n),n+=2,e.writeUInt8(f,n++),e.writeUInt8(t.scopePrefixLength||0,n++),h.copy(e,n,0,y),n+=y;break;case 11:t.timeout?(e.writeUInt16BE(2,n),n+=2,e.writeUInt16BE(t.timeout,n),n+=2):(e.writeUInt16BE(0,n),n+=2);break;case 12:const F=t.length||0;e.writeUInt16BE(F,n),n+=2,e.fill(0,n,n+F),n+=F;break;case 14:const S=2*t.tags.length;e.writeUInt16BE(S,n),n+=2;for(const T of t.tags)e.writeUInt16BE(T,n),n+=2;break;default:throw new Error("Unknown roption code: "+t.code)}return roption.encode.bytes=n-r,e},roption.encode.bytes=0,roption.decode=function(t,e){e||(e=0);const n={};n.code=t.readUInt16BE(e),n.type=_$optioncodes_7.toString(n.code),e+=2;const r=t.readUInt16BE(e);switch(e+=2,n.data=t.slice(e,e+r),n.code){case 8:n.family=t.readUInt16BE(e),e+=2,n.sourcePrefixLength=t.readUInt8(e++),n.scopePrefixLength=t.readUInt8(e++);const o=Buffer.alloc(n.family===1?4:16);t.copy(o,0,e,e+r-4),n.ip=_$index_1.decode(o);break;case 11:r>0&&(n.timeout=t.readUInt16BE(e),e+=2);break;case 14:n.tags=[];for(let f=0;f<r;f+=2)n.tags.push(t.readUInt16BE(e)),e+=2}return roption.decode.bytes=r+4,n},roption.decode.bytes=0,roption.encodingLength=function(t){if(t.data)return t.data.length+4;switch(_$optioncodes_7.toCode(t.code)){case 8:const e=t.sourcePrefixLength||0;return Math.ceil(e/8)+8;case 11:return typeof t.timeout=="number"?6:4;case 12:return t.length+4;case 14:return 4+2*t.tags.length}throw new Error("Unknown roption code: "+t.code)};const ropt=_$dnsPacket_5.opt={};ropt.encode=function(t,e,n){e||(e=Buffer.alloc(ropt.encodingLength(t))),n||(n=0);const r=n,o=encodingLengthList(t,roption);return e.writeUInt16BE(o,n),n=encodeList(t,roption,e,n+2),ropt.encode.bytes=n-r,e},ropt.encode.bytes=0,ropt.decode=function(t,e){e||(e=0);const n=e,r=[];let o=t.readUInt16BE(e);e+=2;let f=0;for(;o>0;)r[f++]=roption.decode(t,e),e+=roption.decode.bytes,o-=roption.decode.bytes;return ropt.decode.bytes=e-n,r},ropt.decode.bytes=0,ropt.encodingLength=function(t){return 2+encodingLengthList(t||[],roption)};const rdnskey=_$dnsPacket_5.dnskey={};rdnskey.PROTOCOL_DNSSEC=3,rdnskey.ZONE_KEY=128,rdnskey.SECURE_ENTRYPOINT=32768,rdnskey.encode=function(t,e,n){e||(e=Buffer.alloc(rdnskey.encodingLength(t))),n||(n=0);const r=n,o=t.key;if(!Buffer.isBuffer(o))throw new Error("Key must be a Buffer");return n+=2,e.writeUInt16BE(t.flags,n),n+=2,e.writeUInt8(rdnskey.PROTOCOL_DNSSEC,n),n+=1,e.writeUInt8(t.algorithm,n),n+=1,o.copy(e,n,0,o.length),n+=o.length,rdnskey.encode.bytes=n-r,e.writeUInt16BE(rdnskey.encode.bytes-2,r),e},rdnskey.encode.bytes=0,rdnskey.decode=function(t,e){e||(e=0);const n=e;var r={},o=t.readUInt16BE(e);if(e+=2,r.flags=t.readUInt16BE(e),e+=2,t.readUInt8(e)!==rdnskey.PROTOCOL_DNSSEC)throw new Error("Protocol must be 3");return e+=1,r.algorithm=t.readUInt8(e),e+=1,r.key=t.slice(e,n+o+2),e+=r.key.length,rdnskey.decode.bytes=e-n,r},rdnskey.decode.bytes=0,rdnskey.encodingLength=function(t){return 6+Buffer.byteLength(t.key)};const rrrsig=_$dnsPacket_5.rrsig={};rrrsig.encode=function(t,e,n){e||(e=Buffer.alloc(rrrsig.encodingLength(t))),n||(n=0);const r=n,o=t.signature;if(!Buffer.isBuffer(o))throw new Error("Signature must be a Buffer");return n+=2,e.writeUInt16BE(_$types_9.toType(t.typeCovered),n),n+=2,e.writeUInt8(t.algorithm,n),n+=1,e.writeUInt8(t.labels,n),n+=1,e.writeUInt32BE(t.originalTTL,n),n+=4,e.writeUInt32BE(t.expiration,n),n+=4,e.writeUInt32BE(t.inception,n),n+=4,e.writeUInt16BE(t.keyTag,n),n+=2,name.encode(t.signersName,e,n),n+=name.encode.bytes,o.copy(e,n,0,o.length),n+=o.length,rrrsig.encode.bytes=n-r,e.writeUInt16BE(rrrsig.encode.bytes-2,r),e},rrrsig.encode.bytes=0,rrrsig.decode=function(t,e){e||(e=0);const n=e;var r={},o=t.readUInt16BE(e);return e+=2,r.typeCovered=_$types_9.toString(t.readUInt16BE(e)),e+=2,r.algorithm=t.readUInt8(e),e+=1,r.labels=t.readUInt8(e),e+=1,r.originalTTL=t.readUInt32BE(e),e+=4,r.expiration=t.readUInt32BE(e),e+=4,r.inception=t.readUInt32BE(e),e+=4,r.keyTag=t.readUInt16BE(e),e+=2,r.signersName=name.decode(t,e),e+=name.decode.bytes,r.signature=t.slice(e,n+o+2),e+=r.signature.length,rrrsig.decode.bytes=e-n,r},rrrsig.decode.bytes=0,rrrsig.encodingLength=function(t){return 20+name.encodingLength(t.signersName)+Buffer.byteLength(t.signature)};const rrp=_$dnsPacket_5.rp={};rrp.encode=function(t,e,n){e||(e=Buffer.alloc(rrp.encodingLength(t))),n||(n=0);const r=n;return n+=2,name.encode(t.mbox||".",e,n,{mail:!0}),n+=name.encode.bytes,name.encode(t.txt||".",e,n),n+=name.encode.bytes,rrp.encode.bytes=n-r,e.writeUInt16BE(rrp.encode.bytes-2,r),e},rrp.encode.bytes=0,rrp.decode=function(t,e){e||(e=0);const n=e,r={};return e+=2,r.mbox=name.decode(t,e,{mail:!0})||".",e+=name.decode.bytes,r.txt=name.decode(t,e)||".",e+=name.decode.bytes,rrp.decode.bytes=e-n,r},rrp.decode.bytes=0,rrp.encodingLength=function(t){return 2+name.encodingLength(t.mbox||".")+name.encodingLength(t.txt||".")};const typebitmap={encode:function(t,e,n){e||(e=Buffer.alloc(typebitmap.encodingLength(t))),n||(n=0);const r=n;for(var o=[],f=0;f<t.length;f++){var d=_$types_9.toType(t[f]);o[d>>8]===void 0&&(o[d>>8]=[]),o[d>>8][d>>3&31]|=1<<7-(7&d)}for(f=0;f<o.length;f++)if(o[f]!==void 0){var h=Buffer.from(o[f]);e.writeUInt8(f,n),n+=1,e.writeUInt8(h.length,n),n+=1,h.copy(e,n),n+=h.length}return typebitmap.encode.bytes=n-r,e}};typebitmap.encode.bytes=0,typebitmap.decode=function(t,e,n){e||(e=0);const r=e;for(var o=[];e-r<n;){var f=t.readUInt8(e);e+=1;var d=t.readUInt8(e);e+=1;for(var h=0;h<d;h++)for(var y=t.readUInt8(e+h),F=0;F<8;F++)if(y&1<<7-F){var S=_$types_9.toString(f<<8|h<<3|F);o.push(S)}e+=d}return typebitmap.decode.bytes=e-r,o},typebitmap.decode.bytes=0,typebitmap.encodingLength=function(t){for(var e=[],n=0;n<t.length;n++){var r=_$types_9.toType(t[n]);e[r>>8]=Math.max(e[r>>8]||0,255&r)}var o=0;for(n=0;n<e.length;n++)e[n]!==void 0&&(o+=2+Math.ceil((e[n]+1)/8));return o};const rnsec=_$dnsPacket_5.nsec={};rnsec.encode=function(t,e,n){e||(e=Buffer.alloc(rnsec.encodingLength(t))),n||(n=0);const r=n;return n+=2,name.encode(t.nextDomain,e,n),n+=name.encode.bytes,typebitmap.encode(t.rrtypes,e,n),n+=typebitmap.encode.bytes,rnsec.encode.bytes=n-r,e.writeUInt16BE(rnsec.encode.bytes-2,r),e},rnsec.encode.bytes=0,rnsec.decode=function(t,e){e||(e=0);const n=e;var r={},o=t.readUInt16BE(e);return e+=2,r.nextDomain=name.decode(t,e),e+=name.decode.bytes,r.rrtypes=typebitmap.decode(t,e,o-(e-n)),e+=typebitmap.decode.bytes,rnsec.decode.bytes=e-n,r},rnsec.decode.bytes=0,rnsec.encodingLength=function(t){return 2+name.encodingLength(t.nextDomain)+typebitmap.encodingLength(t.rrtypes)};const rnsec3=_$dnsPacket_5.nsec3={};rnsec3.encode=function(t,e,n){e||(e=Buffer.alloc(rnsec3.encodingLength(t))),n||(n=0);const r=n,o=t.salt;if(!Buffer.isBuffer(o))throw new Error("salt must be a Buffer");const f=t.nextDomain;if(!Buffer.isBuffer(f))throw new Error("nextDomain must be a Buffer");return n+=2,e.writeUInt8(t.algorithm,n),n+=1,e.writeUInt8(t.flags,n),n+=1,e.writeUInt16BE(t.iterations,n),n+=2,e.writeUInt8(o.length,n),n+=1,o.copy(e,n,0,o.length),n+=o.length,e.writeUInt8(f.length,n),n+=1,f.copy(e,n,0,f.length),n+=f.length,typebitmap.encode(t.rrtypes,e,n),n+=typebitmap.encode.bytes,rnsec3.encode.bytes=n-r,e.writeUInt16BE(rnsec3.encode.bytes-2,r),e},rnsec3.encode.bytes=0,rnsec3.decode=function(t,e){e||(e=0);const n=e;var r={},o=t.readUInt16BE(e);e+=2,r.algorithm=t.readUInt8(e),e+=1,r.flags=t.readUInt8(e),e+=1,r.iterations=t.readUInt16BE(e),e+=2;const f=t.readUInt8(e);e+=1,r.salt=t.slice(e,e+f),e+=f;const d=t.readUInt8(e);return e+=1,r.nextDomain=t.slice(e,e+d),e+=d,r.rrtypes=typebitmap.decode(t,e,o-(e-n)),e+=typebitmap.decode.bytes,rnsec3.decode.bytes=e-n,r},rnsec3.decode.bytes=0,rnsec3.encodingLength=function(t){return 8+t.salt.length+t.nextDomain.length+typebitmap.encodingLength(t.rrtypes)};const rds=_$dnsPacket_5.ds={};rds.encode=function(t,e,n){e||(e=Buffer.alloc(rds.encodingLength(t))),n||(n=0);const r=n,o=t.digest;if(!Buffer.isBuffer(o))throw new Error("Digest must be a Buffer");return n+=2,e.writeUInt16BE(t.keyTag,n),n+=2,e.writeUInt8(t.algorithm,n),n+=1,e.writeUInt8(t.digestType,n),n+=1,o.copy(e,n,0,o.length),n+=o.length,rds.encode.bytes=n-r,e.writeUInt16BE(rds.encode.bytes-2,r),e},rds.encode.bytes=0,rds.decode=function(t,e){e||(e=0);const n=e;var r={},o=t.readUInt16BE(e);return e+=2,r.keyTag=t.readUInt16BE(e),e+=2,r.algorithm=t.readUInt8(e),e+=1,r.digestType=t.readUInt8(e),e+=1,r.digest=t.slice(e,n+o+2),e+=r.digest.length,rds.decode.bytes=e-n,r},rds.decode.bytes=0,rds.encodingLength=function(t){return 6+Buffer.byteLength(t.digest)};const rsshfp=_$dnsPacket_5.sshfp={};rsshfp.getFingerprintLengthForHashType=function(t){switch(t){case 1:return 20;case 2:return 32}},rsshfp.encode=function(t,e,n){e||(e=Buffer.alloc(rsshfp.encodingLength(t))),n||(n=0);const r=n;e[n+=2]=t.algorithm,e[n+=1]=t.hash,n+=1;const o=Buffer.from(t.fingerprint.toUpperCase(),"hex");if(o.length!==rsshfp.getFingerprintLengthForHashType(t.hash))throw new Error("Invalid fingerprint length");return o.copy(e,n),n+=o.byteLength,rsshfp.encode.bytes=n-r,e.writeUInt16BE(rsshfp.encode.bytes-2,r),e},rsshfp.encode.bytes=0,rsshfp.decode=function(t,e){e||(e=0);const n=e,r={};e+=2,r.algorithm=t[e],e+=1,r.hash=t[e],e+=1;const o=rsshfp.getFingerprintLengthForHashType(r.hash);return r.fingerprint=t.slice(e,e+o).toString("hex").toUpperCase(),e+=o,rsshfp.decode.bytes=e-n,r},rsshfp.decode.bytes=0,rsshfp.encodingLength=function(t){return 4+Buffer.from(t.fingerprint,"hex").byteLength};const rnaptr=_$dnsPacket_5.naptr={};rnaptr.encode=function(t,e,n){e||(e=Buffer.alloc(rnaptr.encodingLength(t))),n||(n=0);const r=n;return n+=2,e.writeUInt16BE(t.order||0,n),n+=2,e.writeUInt16BE(t.preference||0,n),n+=2,string.encode(t.flags,e,n),n+=string.encode.bytes,string.encode(t.services,e,n),n+=string.encode.bytes,string.encode(t.regexp,e,n),n+=string.encode.bytes,name.encode(t.replacement,e,n),n+=name.encode.bytes,rnaptr.encode.bytes=n-r,e.writeUInt16BE(rnaptr.encode.bytes-2,r),e},rnaptr.encode.bytes=0,rnaptr.decode=function(t,e){e||(e=0);const n=e,r={};return e+=2,r.order=t.readUInt16BE(e),e+=2,r.preference=t.readUInt16BE(e),e+=2,r.flags=string.decode(t,e),e+=string.decode.bytes,r.services=string.decode(t,e),e+=string.decode.bytes,r.regexp=string.decode(t,e),e+=string.decode.bytes,r.replacement=name.decode(t,e),e+=name.decode.bytes,rnaptr.decode.bytes=e-n,r},rnaptr.decode.bytes=0,rnaptr.encodingLength=function(t){return string.encodingLength(t.flags)+string.encodingLength(t.services)+string.encodingLength(t.regexp)+name.encodingLength(t.replacement)+6};const rtlsa=_$dnsPacket_5.tlsa={};rtlsa.encode=function(t,e,n){e||(e=Buffer.alloc(rtlsa.encodingLength(t))),n||(n=0);const r=n,o=t.certificate;if(!Buffer.isBuffer(o))throw new Error("Certificate must be a Buffer");return n+=2,e.writeUInt8(t.usage,n),n+=1,e.writeUInt8(t.selector,n),n+=1,e.writeUInt8(t.matchingType,n),n+=1,o.copy(e,n,0,o.length),n+=o.length,rtlsa.encode.bytes=n-r,e.writeUInt16BE(rtlsa.encode.bytes-2,r),e},rtlsa.encode.bytes=0,rtlsa.decode=function(t,e){e||(e=0);const n=e,r={},o=t.readUInt16BE(e);return e+=2,r.usage=t.readUInt8(e),e+=1,r.selector=t.readUInt8(e),e+=1,r.matchingType=t.readUInt8(e),e+=1,r.certificate=t.slice(e,n+o+2),e+=r.certificate.length,rtlsa.decode.bytes=e-n,r},rtlsa.decode.bytes=0,rtlsa.encodingLength=function(t){return 5+Buffer.byteLength(t.certificate)};const renc=_$dnsPacket_5.record=function(t){switch(t.toUpperCase()){case"A":return ra;case"PTR":return rptr;case"CNAME":return rcname;case"DNAME":return rdname;case"TXT":return rtxt;case"NULL":return rnull;case"AAAA":return raaaa;case"SRV":return rsrv;case"HINFO":return rhinfo;case"CAA":return rcaa;case"NS":return rns;case"SOA":return rsoa;case"MX":return rmx;case"OPT":return ropt;case"DNSKEY":return rdnskey;case"RRSIG":return rrrsig;case"RP":return rrp;case"NSEC":return rnsec;case"NSEC3":return rnsec3;case"SSHFP":return rsshfp;case"DS":return rds;case"NAPTR":return rnaptr;case"TLSA":return rtlsa}return runknown},answer=_$dnsPacket_5.answer={};answer.encode=function(t,e,n){e||(e=Buffer.alloc(answer.encodingLength(t))),n||(n=0);const r=n;if(name.encode(t.name,e,n),n+=name.encode.bytes,e.writeUInt16BE(_$types_9.toType(t.type),n),t.type.toUpperCase()==="OPT"){if(t.name!==".")throw new Error("OPT name must be root.");e.writeUInt16BE(t.udpPayloadSize||4096,n+2),e.writeUInt8(t.extendedRcode||0,n+4),e.writeUInt8(t.ednsVersion||0,n+5),e.writeUInt16BE(t.flags||0,n+6),n+=8,ropt.encode(t.options||[],e,n),n+=ropt.encode.bytes}else{let o=_$classes_4.toClass(t.class===void 0?"IN":t.class);t.flush&&(o|=32768),e.writeUInt16BE(o,n+2),e.writeUInt32BE(t.ttl||0,n+4),n+=8;const f=renc(t.type);f.encode(t.data,e,n),n+=f.encode.bytes}return answer.encode.bytes=n-r,e},answer.encode.bytes=0,answer.decode=function(t,e){e||(e=0);const n={},r=e;if(n.name=name.decode(t,e),e+=name.decode.bytes,n.type=_$types_9.toString(t.readUInt16BE(e)),n.type==="OPT")n.udpPayloadSize=t.readUInt16BE(e+2),n.extendedRcode=t.readUInt8(e+4),n.ednsVersion=t.readUInt8(e+5),n.flags=t.readUInt16BE(e+6),n.flag_do=(n.flags>>15&1)==1,n.options=ropt.decode(t,e+8),e+=8+ropt.decode.bytes;else{const o=t.readUInt16BE(e+2);n.ttl=t.readUInt32BE(e+4),n.class=_$classes_4.toString(-32769&o),n.flush=!!(32768&o);const f=renc(n.type);n.data=f.decode(t,e+8),e+=8+f.decode.bytes}return answer.decode.bytes=e-r,n},answer.decode.bytes=0,answer.encodingLength=function(t){const e=t.data!==null&&t.data!==void 0?t.data:t.options;return name.encodingLength(t.name)+8+renc(t.type).encodingLength(e)};const question=_$dnsPacket_5.question={};function encodingLengthList(t,e){let n=0;for(let r=0;r<t.length;r++)n+=e.encodingLength(t[r]);return n}function encodeList(t,e,n,r){for(let o=0;o<t.length;o++)e.encode(t[o],n,r),r+=e.encode.bytes;return r}function decodeList(t,e,n,r){for(let o=0;o<t.length;o++)t[o]=e.decode(n,r),r+=e.decode.bytes;return r}question.encode=function(t,e,n){e||(e=Buffer.alloc(question.encodingLength(t))),n||(n=0);const r=n;return name.encode(t.name,e,n),n+=name.encode.bytes,e.writeUInt16BE(_$types_9.toType(t.type),n),n+=2,e.writeUInt16BE(_$classes_4.toClass(t.class===void 0?"IN":t.class),n),n+=2,question.encode.bytes=n-r,t},question.encode.bytes=0,question.decode=function(t,e){e||(e=0);const n=e,r={};return r.name=name.decode(t,e),e+=name.decode.bytes,r.type=_$types_9.toString(t.readUInt16BE(e)),e+=2,r.class=_$classes_4.toString(t.readUInt16BE(e)),e+=2,32768&r.class&&(r.class&=-32769),question.decode.bytes=e-n,r},question.decode.bytes=0,question.encodingLength=function(t){return name.encodingLength(t.name)+4},_$dnsPacket_5.AUTHORITATIVE_ANSWER=1024,_$dnsPacket_5.TRUNCATED_RESPONSE=512,_$dnsPacket_5.RECURSION_DESIRED=256,_$dnsPacket_5.RECURSION_AVAILABLE=128,_$dnsPacket_5.AUTHENTIC_DATA=32,_$dnsPacket_5.CHECKING_DISABLED=16,_$dnsPacket_5.DNSSEC_OK=32768,_$dnsPacket_5.encode=function(t,e,n){const r=!e;r&&(e=Buffer.alloc(_$dnsPacket_5.encodingLength(t))),n||(n=0);const o=n;return t.questions||(t.questions=[]),t.answers||(t.answers=[]),t.authorities||(t.authorities=[]),t.additionals||(t.additionals=[]),header.encode(t,e,n),n+=header.encode.bytes,n=encodeList(t.questions,question,e,n),n=encodeList(t.answers,answer,e,n),n=encodeList(t.authorities,answer,e,n),n=encodeList(t.additionals,answer,e,n),_$dnsPacket_5.encode.bytes=n-o,r&&_$dnsPacket_5.encode.bytes!==e.length?e.slice(0,_$dnsPacket_5.encode.bytes):e},_$dnsPacket_5.encode.bytes=0,_$dnsPacket_5.decode=function(t,e){e||(e=0);const n=e,r=header.decode(t,e);return e+=header.decode.bytes,e=decodeList(r.questions,question,t,e),e=decodeList(r.answers,answer,t,e),e=decodeList(r.authorities,answer,t,e),e=decodeList(r.additionals,answer,t,e),_$dnsPacket_5.decode.bytes=e-n,r},_$dnsPacket_5.decode.bytes=0,_$dnsPacket_5.encodingLength=function(t){return header.encodingLength(t)+encodingLengthList(t.questions||[],question)+encodingLengthList(t.answers||[],answer)+encodingLengthList(t.authorities||[],answer)+encodingLengthList(t.additionals||[],answer)},_$dnsPacket_5.streamEncode=function(t){const e=_$dnsPacket_5.encode(t),n=Buffer.alloc(2);n.writeUInt16BE(e.byteLength);const r=Buffer.concat([n,e]);return _$dnsPacket_5.streamEncode.bytes=r.byteLength,r},_$dnsPacket_5.streamEncode.bytes=0,_$dnsPacket_5.streamDecode=function(t){const e=t.readUInt16BE(0);if(t.byteLength<e+2)return null;const n=_$dnsPacket_5.decode(t.slice(2));return _$dnsPacket_5.streamDecode.bytes=_$dnsPacket_5.decode.bytes,n},_$dnsPacket_5.streamDecode.bytes=0;var _$dns_134={};Object.defineProperty(_$dns_134,"__esModule",{value:!0}),_$dns_134.doh=function(t){return _doh.apply(this,arguments)};var ___app_134=___interopRequireDefault_134(_$app_87),_dnsPacket=___interopRequireDefault_134(_$dnsPacket_5),_buffer=_$buffer_3({});function ___interopRequireDefault_134(t){return t&&t.__esModule?t:{default:t}}function ___typeof_134(t){return(___typeof_134=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function ___regeneratorRuntime_134(){___regeneratorRuntime_134=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=typeof Symbol=="function"?Symbol:{},o=r.iterator||"@@iterator",f=r.asyncIterator||"@@asyncIterator",d=r.toStringTag||"@@toStringTag";function h(l,s,v){return Object.defineProperty(l,s,{value:v,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,v,$){return s[v]=$}}function y(l,s,v,$){var E=s&&s.prototype instanceof T?s:T,rt=Object.create(E.prototype),gt=new dt($||[]);return rt._invoke=function(Et,Ct,x){var N="suspendedStart";return function(G,A){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(G==="throw")throw A;return{value:void 0,done:!0}}for(x.method=G,x.arg=A;;){var C=x.delegate;if(C){var j=et(C,x);if(j){if(j===S)continue;return j}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var K=F(Et,Ct,x);if(K.type==="normal"){if(N=x.done?"completed":"suspendedYield",K.arg===S)continue;return{value:K.arg,done:x.done}}K.type==="throw"&&(N="completed",x.method="throw",x.arg=K.arg)}}}(l,v,gt),rt}function F(l,s,v){try{return{type:"normal",arg:l.call(s,v)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var S={};function T(){}function U(){}function M(){}var Y={};h(Y,o,function(){return this});var Z=Object.getPrototypeOf,D=Z&&Z(Z(ht([])));D&&D!==e&&n.call(D,o)&&(Y=D);var nt=M.prototype=T.prototype=Object.create(Y);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(v){return this._invoke(s,v)})})}function at(l,s){var v;this._invoke=function($,E){function rt(){return new s(function(gt,Et){(function Ct(x,N,G,A){var C=F(l[x],l,N);if(C.type!=="throw"){var j=C.arg,K=j.value;return K&&___typeof_134(K)=="object"&&n.call(K,"__await")?s.resolve(K.__await).then(function(J){Ct("next",J,G,A)},function(J){Ct("throw",J,G,A)}):s.resolve(K).then(function(J){j.value=J,G(j)},function(J){return Ct("throw",J,G,A)})}A(C.arg)})($,E,gt,Et)})}return v=v?v.then(rt,rt):rt()}}function et(l,s){var v=l.iterator[s.method];if(v===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,et(l,s),s.method==="throw"))return S;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var $=F(v,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,S;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,S):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,S)}function mt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function At(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function dt(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(mt,this),this.reset(!0)}function ht(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var v=-1,$=function E(){for(;++v<l.length;)if(n.call(l,v))return E.value=l[v],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:xt}}function xt(){return{value:void 0,done:!0}}return U.prototype=M,h(nt,"constructor",M),h(M,"constructor",U),U.displayName=h(M,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===U||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,M):(l.__proto__=M,h(l,d,"GeneratorFunction")),l.prototype=Object.create(nt),l},t.awrap=function(l){return{__await:l}},ct(at.prototype),h(at.prototype,f,function(){return this}),t.AsyncIterator=at,t.async=function(l,s,v,$,E){E===void 0&&(E=Promise);var rt=new at(y(l,s,v,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(gt){return gt.done?gt.value:rt.next()})},ct(nt),h(nt,d,"Generator"),h(nt,o,function(){return this}),h(nt,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var v in l)s.push(v);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=ht,dt.prototype={constructor:dt,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(At),!l)for(var s in this)s.charAt(0)==="t"&&n.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function v(Ct,x){return rt.type="throw",rt.arg=l,s.next=Ct,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return v("end");if(E.tryLoc<=this.prev){var gt=n.call(E,"catchLoc"),Et=n.call(E,"finallyLoc");if(gt&&Et){if(this.prev<E.catchLoc)return v(E.catchLoc,!0);if(this.prev<E.finallyLoc)return v(E.finallyLoc)}else if(gt){if(this.prev<E.catchLoc)return v(E.catchLoc,!0)}else{if(!Et)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return v(E.finallyLoc)}}}},abrupt:function(l,s){for(var v=this.tryEntries.length-1;v>=0;--v){var $=this.tryEntries[v];if($.tryLoc<=this.prev&&n.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,S):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),S},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.finallyLoc===l)return this.complete(v.completion,v.afterLoc),At(v),S}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.tryLoc===l){var $=v.completion;if($.type==="throw"){var E=$.arg;At(v)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,v){return this.delegate={iterator:ht(l),resultName:s,nextLoc:v},this.method==="next"&&(this.arg=void 0),S}},t}function __asyncGeneratorStep_134(t,e,n,r,o,f,d){try{var h=t[f](d),y=h.value}catch(F){return void n(F)}h.done?e(y):Promise.resolve(y).then(r,o)}function _doh(){var t;return t=___regeneratorRuntime_134().mark(function e(n){var r,o,f,d,h,y,F,S;return ___regeneratorRuntime_134().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return r=n.url,o=n.domain,f=n.type,d=f===void 0?"A":f,h=n.timeout,y=n.edns,F=_dnsPacket.default.encode({type:"query",id:0,flags:_dnsPacket.default.RECURSION_DESIRED,questions:[{type:d,name:o}],additionals:[{type:"OPT",name:".",udpPayloadSize:4096,flags:0,options:[{code:"CLIENT_SUBNET",ip:y,sourcePrefixLength:(0,_$utils_141.isIPv4)(y)?24:56,scopePrefixLength:0}]}]}),T.next=4,___app_134.default.http.get({url:"".concat(r,"?dns=").concat(F.toString("base64").toString("utf-8").replace(/=/g,"")),headers:{Accept:"application/dns-message"},"binary-mode":!0,encoding:null,timeout:h});case 4:return S=T.sent,T.abrupt("return",_dnsPacket.default.decode(_buffer.Buffer.from(___app_134.default.env.isQX?S.bodyBytes:S.body)));case 6:case"end":return T.stop()}},e)}),(_doh=function(){var e=this,n=arguments;return new Promise(function(r,o){var f=t.apply(e,n);function d(y){__asyncGeneratorStep_134(f,r,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_134(f,r,o,d,h,"throw",y)}d(void 0)})}).apply(this,arguments)}var _$lodash_53={exports:{}};(function(t){(function(){(function(){var e="Expected a function",n="__lodash_placeholder__",r=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],o="[object Arguments]",f="[object Array]",d="[object Boolean]",h="[object Date]",y="[object Error]",F="[object Function]",S="[object GeneratorFunction]",T="[object Map]",U="[object Number]",M="[object Object]",Y="[object RegExp]",Z="[object Set]",D="[object String]",nt="[object Symbol]",ct="[object WeakMap]",at="[object ArrayBuffer]",et="[object DataView]",mt="[object Float32Array]",At="[object Float64Array]",dt="[object Int8Array]",ht="[object Int16Array]",xt="[object Int32Array]",l="[object Uint8Array]",s="[object Uint16Array]",v="[object Uint32Array]",$=/\b__p \+= '';/g,E=/\b(__p \+=) '' \+/g,rt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,gt=/&(?:amp|lt|gt|quot|#39);/g,Et=/[&<>"']/g,Ct=RegExp(gt.source),x=RegExp(Et.source),N=/<%-([\s\S]+?)%>/g,G=/<%([\s\S]+?)%>/g,A=/<%=([\s\S]+?)%>/g,C=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,j=/^\w*$/,K=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,J=/[\\^$.*+?()[\]{}|]/g,yt=RegExp(J.source),Dt=/^\s+/,Xt=/\s/,_e=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,me=/\{\n\/\* \[wrapped with (.+)\] \*/,de=/,? & /,Zt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Vt=/[()=,{}\[\]\/\s]/,pe=/\\(\\)?/g,ge=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,jt=/\w*$/,Bt=/^[-+]0x[0-9a-f]+$/i,ie=/^0b[01]+$/i,ee=/^\[object .+?Constructor\]$/,Kt=/^0o[0-7]+$/i,be=/^(?:0|[1-9]\d*)$/,b=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Be=/($^)/,ce=/['\n\r\u2028\u2029\\]/g,Gt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ze="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",We="["+ze+"]",Xe="["+Gt+"]",nr="\\d+",lr="[a-z\\xdf-\\xf6\\xf8-\\xff]",ur="[^\\ud800-\\udfff"+ze+nr+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",Me="\\ud83c[\\udffb-\\udfff]",Ke="[^\\ud800-\\udfff]",Ir="(?:\\ud83c[\\udde6-\\uddff]){2}",Le="[\\ud800-\\udbff][\\udc00-\\udfff]",qr="[A-Z\\xc0-\\xd6\\xd8-\\xde]",hr="(?:"+lr+"|"+ur+")",Sr="(?:"+qr+"|"+ur+")",Xr="(?:"+Xe+"|"+Me+")?",Kr="[\\ufe0e\\ufe0f]?"+Xr+"(?:\\u200d(?:"+[Ke,Ir,Le].join("|")+")[\\ufe0e\\ufe0f]?"+Xr+")*",Qe="(?:"+["[\\u2700-\\u27bf]",Ir,Le].join("|")+")"+Kr,Je="(?:"+[Ke+Xe+"?",Xe,Ir,Le,"[\\ud800-\\udfff]"].join("|")+")",tr=RegExp("['\u2019]","g"),an=RegExp(Xe,"g"),Vr=RegExp(Me+"(?="+Me+")|"+Je+Kr,"g"),Gr=RegExp([qr+"?"+lr+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?="+[We,qr,"$"].join("|")+")",Sr+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?="+[We,qr+hr,"$"].join("|")+")",qr+"?"+hr+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?",qr+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",nr,Qe].join("|"),"g"),Yr=RegExp("[\\u200d\\ud800-\\udfff"+Gt+"\\ufe0e\\ufe0f]"),Jr=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,sn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],se=-1,ye={};ye[mt]=ye[At]=ye[dt]=ye[ht]=ye[xt]=ye[l]=ye["[object Uint8ClampedArray]"]=ye[s]=ye[v]=!0,ye[o]=ye[f]=ye[at]=ye[d]=ye[et]=ye[h]=ye[y]=ye[F]=ye[T]=ye[U]=ye[M]=ye[Y]=ye[Z]=ye[D]=ye[ct]=!1;var Re={};Re[o]=Re[f]=Re[at]=Re[et]=Re[d]=Re[h]=Re[mt]=Re[At]=Re[dt]=Re[ht]=Re[xt]=Re[T]=Re[U]=Re[M]=Re[Y]=Re[Z]=Re[D]=Re[nt]=Re[l]=Re["[object Uint8ClampedArray]"]=Re[s]=Re[v]=!0,Re[y]=Re[F]=Re[ct]=!1;var ar={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},he=parseFloat,Zr=parseInt,Ar=typeof t=="object"&&t&&t.Object===Object&&t,un=typeof self=="object"&&self&&self.Object===Object&&self,or=Ar||un||Function("return this")(),X=typeof _$lodash_53.exports=="object"&&_$lodash_53.exports&&!_$lodash_53.exports.nodeType&&_$lodash_53.exports,xe=X&&_$lodash_53&&!_$lodash_53.nodeType&&_$lodash_53,Tr=xe&&xe.exports===X,gr=Tr&&Ar.process,Ve=function(){try{return xe&&xe.require&&xe.require("util").types||gr&&gr.binding&&gr.binding("util")}catch{}}(),Ut=Ve&&Ve.isArrayBuffer,sr=Ve&&Ve.isDate,_n=Ve&&Ve.isMap,Ie=Ve&&Ve.isRegExp,fr=Ve&&Ve.isSet,Ue=Ve&&Ve.isTypedArray;function Yt(St,kt,Tt){switch(Tt.length){case 0:return St.call(kt);case 1:return St.call(kt,Tt[0]);case 2:return St.call(kt,Tt[0],Tt[1]);case 3:return St.call(kt,Tt[0],Tt[1],Tt[2])}return St.apply(kt,Tt)}function Te(St,kt,Tt,Qt){for(var le=-1,$e=St==null?0:St.length;++le<$e;){var pr=St[le];kt(Qt,pr,Tt(pr),St)}return Qt}function Jt(St,kt){for(var Tt=-1,Qt=St==null?0:St.length;++Tt<Qt&&kt(St[Tt],Tt,St)!==!1;);return St}function jn(St,kt){for(var Tt=St==null?0:St.length;Tt--&&kt(St[Tt],Tt,St)!==!1;);return St}function Pn(St,kt){for(var Tt=-1,Qt=St==null?0:St.length;++Tt<Qt;)if(!kt(St[Tt],Tt,St))return!1;return!0}function Ee(St,kt){for(var Tt=-1,Qt=St==null?0:St.length,le=0,$e=[];++Tt<Qt;){var pr=St[Tt];kt(pr,Tt,St)&&($e[le++]=pr)}return $e}function a(St,kt){return!(St==null||!St.length)&&q(St,kt,0)>-1}function u(St,kt,Tt){for(var Qt=-1,le=St==null?0:St.length;++Qt<le;)if(Tt(kt,St[Qt]))return!0;return!1}function p(St,kt){for(var Tt=-1,Qt=St==null?0:St.length,le=Array(Qt);++Tt<Qt;)le[Tt]=kt(St[Tt],Tt,St);return le}function g(St,kt){for(var Tt=-1,Qt=kt.length,le=St.length;++Tt<Qt;)St[le+Tt]=kt[Tt];return St}function m(St,kt,Tt,Qt){var le=-1,$e=St==null?0:St.length;for(Qt&&$e&&(Tt=St[++le]);++le<$e;)Tt=kt(Tt,St[le],le,St);return Tt}function w(St,kt,Tt,Qt){var le=St==null?0:St.length;for(Qt&&le&&(Tt=St[--le]);le--;)Tt=kt(Tt,St[le],le,St);return Tt}function O(St,kt){for(var Tt=-1,Qt=St==null?0:St.length;++Tt<Qt;)if(kt(St[Tt],Tt,St))return!0;return!1}var R=W("length");function P(St,kt,Tt){var Qt;return Tt(St,function(le,$e,pr){if(kt(le,$e,pr))return Qt=$e,!1}),Qt}function B(St,kt,Tt,Qt){for(var le=St.length,$e=Tt+(Qt?1:-1);Qt?$e--:++$e<le;)if(kt(St[$e],$e,St))return $e;return-1}function q(St,kt,Tt){return kt==kt?function(Qt,le,$e){for(var pr=$e-1,Pr=Qt.length;++pr<Pr;)if(Qt[pr]===le)return pr;return-1}(St,kt,Tt):B(St,k,Tt)}function L(St,kt,Tt,Qt){for(var le=Tt-1,$e=St.length;++le<$e;)if(Qt(St[le],kt))return le;return-1}function k(St){return St!=St}function H(St,kt){var Tt=St==null?0:St.length;return Tt?bt(St,kt)/Tt:NaN}function W(St){return function(kt){return kt?.[St]}}function z(St){return function(kt){return St?.[kt]}}function st(St,kt,Tt,Qt,le){return le(St,function($e,pr,Pr){Tt=Qt?(Qt=!1,$e):kt(Tt,$e,pr,Pr)}),Tt}function bt(St,kt){for(var Tt,Qt=-1,le=St.length;++Qt<le;){var $e=kt(St[Qt]);$e!==void 0&&(Tt=Tt===void 0?$e:Tt+$e)}return Tt}function It(St,kt){for(var Tt=-1,Qt=Array(St);++Tt<St;)Qt[Tt]=kt(Tt);return Qt}function Mt(St){return St&&St.slice(0,Nt(St)+1).replace(Dt,"")}function Lt(St){return function(kt){return St(kt)}}function tt(St,kt){return p(kt,function(Tt){return St[Tt]})}function ut(St,kt){return St.has(kt)}function pt(St,kt){for(var Tt=-1,Qt=St.length;++Tt<Qt&&q(kt,St[Tt],0)>-1;);return Tt}function it(St,kt){for(var Tt=St.length;Tt--&&q(kt,St[Tt],0)>-1;);return Tt}var wt=z({\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"}),$t=z({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Wt(St){return"\\"+ar[St]}function Ht(St){return Yr.test(St)}function Se(St){var kt=-1,Tt=Array(St.size);return St.forEach(function(Qt,le){Tt[++kt]=[le,Qt]}),Tt}function zt(St,kt){return function(Tt){return St(kt(Tt))}}function Q(St,kt){for(var Tt=-1,Qt=St.length,le=0,$e=[];++Tt<Qt;){var pr=St[Tt];pr!==kt&&pr!==n||(St[Tt]=n,$e[le++]=Tt)}return $e}function ft(St){var kt=-1,Tt=Array(St.size);return St.forEach(function(Qt){Tt[++kt]=Qt}),Tt}function vt(St){var kt=-1,Tt=Array(St.size);return St.forEach(function(Qt){Tt[++kt]=[Qt,Qt]}),Tt}function Rt(St){return Ht(St)?function(kt){for(var Tt=Vr.lastIndex=0;Vr.test(kt);)++Tt;return Tt}(St):R(St)}function Ft(St){return Ht(St)?function(kt){return kt.match(Vr)||[]}(St):function(kt){return kt.split("")}(St)}function Nt(St){for(var kt=St.length;kt--&&Xt.test(St.charAt(kt)););return kt}var re=z({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),te=function St(kt){var Tt,Qt=(kt=kt==null?or:te.defaults(or.Object(),kt,te.pick(or,sn))).Array,le=kt.Date,$e=kt.Error,pr=kt.Function,Pr=kt.Math,er=kt.Object,gn=kt.RegExp,ro=kt.String,wr=kt.TypeError,Fr=Qt.prototype,yn=pr.prototype,Or=er.prototype,ir=kt["__core-js_shared__"],Br=yn.toString,Ge=Or.hasOwnProperty,Er=0,Yn=(Tt=/[^.]+$/.exec(ir&&ir.keys&&ir.keys.IE_PROTO||""))?"Symbol(src)_1."+Tt:"",Qr=Or.toString,mn=Br.call(er),ta=or._,ea=gn("^"+Br.call(Ge).replace(J,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Nn=Tr?kt.Buffer:void 0,Fn=kt.Symbol,mo=kt.Uint8Array,Qa=Nn?Nn.allocUnsafe:void 0,vo=zt(er.getPrototypeOf,er),ts=er.create,es=Or.propertyIsEnumerable,bo=Fr.splice,rs=Fn?Fn.isConcatSpreadable:void 0,no=Fn?Fn.iterator:void 0,Bn=Fn?Fn.toStringTag:void 0,wo=function(){try{var c=qn(er,"defineProperty");return c({},"",{}),c}catch{}}(),Mi=kt.clearTimeout!==or.clearTimeout&&kt.clearTimeout,qi=le&&le.now!==or.Date.now&&le.now,Ki=kt.setTimeout!==or.setTimeout&&kt.setTimeout,Eo=Pr.ceil,xo=Pr.floor,na=er.getOwnPropertySymbols,Vi=Nn?Nn.isBuffer:void 0,ns=kt.isFinite,Gi=Fr.join,Yi=zt(er.keys,er),br=Pr.max,kr=Pr.min,zi=le.now,Wi=kt.parseInt,os=Pr.random,Xi=Fr.reverse,oa=qn(kt,"DataView"),oo=qn(kt,"Map"),aa=qn(kt,"Promise"),zn=qn(kt,"Set"),ao=qn(kt,"WeakMap"),so=qn(er,"create"),So=ao&&new ao,Wn={},Ji=Kn(oa),Zi=Kn(oo),Qi=Kn(aa),tu=Kn(zn),eu=Kn(ao),Ao=Fn?Fn.prototype:void 0,io=Ao?Ao.valueOf:void 0,as=Ao?Ao.toString:void 0;function lt(c){if(_r(c)&&!je(c)&&!(c instanceof Ye)){if(c instanceof tn)return c;if(Ge.call(c,"__wrapped__"))return ii(c)}return new tn(c)}var Xn=function(){function c(){}return function(_){if(!dr(_))return{};if(ts)return ts(_);c.prototype=_;var I=new c;return c.prototype=void 0,I}}();function Co(){}function tn(c,_){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!_,this.__index__=0,this.__values__=void 0}function Ye(c){this.__wrapped__=c,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Ln(c){var _=-1,I=c==null?0:c.length;for(this.clear();++_<I;){var V=c[_];this.set(V[0],V[1])}}function vn(c){var _=-1,I=c==null?0:c.length;for(this.clear();++_<I;){var V=c[_];this.set(V[0],V[1])}}function bn(c){var _=-1,I=c==null?0:c.length;for(this.clear();++_<I;){var V=c[_];this.set(V[0],V[1])}}function Un(c){var _=-1,I=c==null?0:c.length;for(this.__data__=new bn;++_<I;)this.add(c[_])}function cn(c){var _=this.__data__=new vn(c);this.size=_.size}function ss(c,_){var I=je(c),V=!I&&Vn(c),ot=!I&&!V&&Tn(c),_t=!I&&!V&&!ot&&to(c),Pt=I||V||ot||_t,Ot=Pt?It(c.length,ro):[],qt=Ot.length;for(var oe in c)!_&&!Ge.call(c,oe)||Pt&&(oe=="length"||ot&&(oe=="offset"||oe=="parent")||_t&&(oe=="buffer"||oe=="byteLength"||oe=="byteOffset")||Sn(oe,qt))||Ot.push(oe);return Ot}function is(c){var _=c.length;return _?c[ya(0,_-1)]:void 0}function ru(c,_){return Uo(Lr(c),Hn(_,0,c.length))}function nu(c){return Uo(Lr(c))}function sa(c,_,I){(I===void 0||ln(c[_],I))&&(I!==void 0||_ in c)||wn(c,_,I)}function uo(c,_,I){var V=c[_];Ge.call(c,_)&&ln(V,I)&&(I!==void 0||_ in c)||wn(c,_,I)}function Io(c,_){for(var I=c.length;I--;)if(ln(c[I][0],_))return I;return-1}function ou(c,_,I,V){return On(c,function(ot,_t,Pt){_(V,ot,I(ot),Pt)}),V}function us(c,_){return c&&fn(_,xr(_),c)}function wn(c,_,I){_=="__proto__"&&wo?wo(c,_,{configurable:!0,enumerable:!0,value:I,writable:!0}):c[_]=I}function ia(c,_){for(var I=-1,V=_.length,ot=Qt(V),_t=c==null;++I<V;)ot[I]=_t?void 0:Ma(c,_[I]);return ot}function Hn(c,_,I){return c==c&&(I!==void 0&&(c=c<=I?c:I),_!==void 0&&(c=c>=_?c:_)),c}function en(c,_,I,V,ot,_t){var Pt,Ot=1&_,qt=2&_,oe=4&_;if(I&&(Pt=ot?I(c,V,ot,_t):I(c)),Pt!==void 0)return Pt;if(!dr(c))return c;var ne=je(c);if(ne){if(Pt=function(ae){var fe=ae.length,Pe=new ae.constructor(fe);return fe&&typeof ae[0]=="string"&&Ge.call(ae,"index")&&(Pe.index=ae.index,Pe.input=ae.input),Pe}(c),!Ot)return Lr(c,Pt)}else{var ue=$r(c),we=ue==F||ue==S;if(Tn(c))return Rs(c,Ot);if(ue==M||ue==o||we&&!ot){if(Pt=qt||we?{}:Zs(c),!Ot)return qt?function(ae,fe){return fn(ae,Xs(ae),fe)}(c,function(ae,fe){return ae&&fn(fe,Hr(fe),ae)}(Pt,c)):function(ae,fe){return fn(ae,ka(ae),fe)}(c,us(Pt,c))}else{if(!Re[ue])return ot?c:{};Pt=function(ae,fe,Pe){var ve,De,qe,Ze=ae.constructor;switch(fe){case at:return Sa(ae);case d:case h:return new Ze(+ae);case et:return function(Ce,Oe){var mr=Oe?Sa(Ce.buffer):Ce.buffer;return new Ce.constructor(mr,Ce.byteOffset,Ce.byteLength)}(ae,Pe);case mt:case At:case dt:case ht:case xt:case l:case"[object Uint8ClampedArray]":case s:case v:return Ts(ae,Pe);case T:return new Ze;case U:case D:return new Ze(ae);case Y:return(qe=new(De=ae).constructor(De.source,jt.exec(De))).lastIndex=De.lastIndex,qe;case Z:return new Ze;case nt:return ve=ae,io?er(io.call(ve)):{}}}(c,ue,Ot)}}_t||(_t=new cn);var Ae=_t.get(c);if(Ae)return Ae;_t.set(c,Pt),Ai(c)?c.forEach(function(ae){Pt.add(en(ae,_,I,ae,c,_t))}):xi(c)&&c.forEach(function(ae,fe){Pt.set(fe,en(ae,_,I,fe,c,_t))});var Fe=ne?void 0:(oe?qt?Pa:Ia:qt?Hr:xr)(c);return Jt(Fe||c,function(ae,fe){Fe&&(ae=c[fe=ae]),uo(Pt,fe,en(ae,_,I,fe,c,_t))}),Pt}function cs(c,_,I){var V=I.length;if(c==null)return!V;for(c=er(c);V--;){var ot=I[V],_t=_[ot],Pt=c[ot];if(Pt===void 0&&!(ot in c)||!_t(Pt))return!1}return!0}function ls(c,_,I){if(typeof c!="function")throw new wr(e);return go(function(){c.apply(void 0,I)},_)}function co(c,_,I,V){var ot=-1,_t=a,Pt=!0,Ot=c.length,qt=[],oe=_.length;if(!Ot)return qt;I&&(_=p(_,Lt(I))),V?(_t=u,Pt=!1):_.length>=200&&(_t=ut,Pt=!1,_=new Un(_));t:for(;++ot<Ot;){var ne=c[ot],ue=I==null?ne:I(ne);if(ne=V||ne!==0?ne:0,Pt&&ue==ue){for(var we=oe;we--;)if(_[we]===ue)continue t;qt.push(ne)}else _t(_,ue,V)||qt.push(ne)}return qt}lt.templateSettings={escape:N,evaluate:G,interpolate:A,variable:"",imports:{_:lt}},lt.prototype=Co.prototype,lt.prototype.constructor=lt,tn.prototype=Xn(Co.prototype),tn.prototype.constructor=tn,Ye.prototype=Xn(Co.prototype),Ye.prototype.constructor=Ye,Ln.prototype.clear=function(){this.__data__=so?so(null):{},this.size=0},Ln.prototype.delete=function(c){var _=this.has(c)&&delete this.__data__[c];return this.size-=_?1:0,_},Ln.prototype.get=function(c){var _=this.__data__;if(so){var I=_[c];return I==="__lodash_hash_undefined__"?void 0:I}return Ge.call(_,c)?_[c]:void 0},Ln.prototype.has=function(c){var _=this.__data__;return so?_[c]!==void 0:Ge.call(_,c)},Ln.prototype.set=function(c,_){var I=this.__data__;return this.size+=this.has(c)?0:1,I[c]=so&&_===void 0?"__lodash_hash_undefined__":_,this},vn.prototype.clear=function(){this.__data__=[],this.size=0},vn.prototype.delete=function(c){var _=this.__data__,I=Io(_,c);return!(I<0||(I==_.length-1?_.pop():bo.call(_,I,1),--this.size,0))},vn.prototype.get=function(c){var _=this.__data__,I=Io(_,c);return I<0?void 0:_[I][1]},vn.prototype.has=function(c){return Io(this.__data__,c)>-1},vn.prototype.set=function(c,_){var I=this.__data__,V=Io(I,c);return V<0?(++this.size,I.push([c,_])):I[V][1]=_,this},bn.prototype.clear=function(){this.size=0,this.__data__={hash:new Ln,map:new(oo||vn),string:new Ln}},bn.prototype.delete=function(c){var _=Lo(this,c).delete(c);return this.size-=_?1:0,_},bn.prototype.get=function(c){return Lo(this,c).get(c)},bn.prototype.has=function(c){return Lo(this,c).has(c)},bn.prototype.set=function(c,_){var I=Lo(this,c),V=I.size;return I.set(c,_),this.size+=I.size==V?0:1,this},Un.prototype.add=Un.prototype.push=function(c){return this.__data__.set(c,"__lodash_hash_undefined__"),this},Un.prototype.has=function(c){return this.__data__.has(c)},cn.prototype.clear=function(){this.__data__=new vn,this.size=0},cn.prototype.delete=function(c){var _=this.__data__,I=_.delete(c);return this.size=_.size,I},cn.prototype.get=function(c){return this.__data__.get(c)},cn.prototype.has=function(c){return this.__data__.has(c)},cn.prototype.set=function(c,_){var I=this.__data__;if(I instanceof vn){var V=I.__data__;if(!oo||V.length<199)return V.push([c,_]),this.size=++I.size,this;I=this.__data__=new bn(V)}return I.set(c,_),this.size=I.size,this};var On=Bs(pn),ps=Bs(la,!0);function au(c,_){var I=!0;return On(c,function(V,ot,_t){return I=!!_(V,ot,_t)}),I}function Po(c,_,I){for(var V=-1,ot=c.length;++V<ot;){var _t=c[V],Pt=_(_t);if(Pt!=null&&(Ot===void 0?Pt==Pt&&!Wr(Pt):I(Pt,Ot)))var Ot=Pt,qt=_t}return qt}function ds(c,_){var I=[];return On(c,function(V,ot,_t){_(V,ot,_t)&&I.push(V)}),I}function Cr(c,_,I,V,ot){var _t=-1,Pt=c.length;for(I||(I=gu),ot||(ot=[]);++_t<Pt;){var Ot=c[_t];_>0&&I(Ot)?_>1?Cr(Ot,_-1,I,V,ot):g(ot,Ot):V||(ot[ot.length]=Ot)}return ot}var ca=Ls(),hs=Ls(!0);function pn(c,_){return c&&ca(c,_,xr)}function la(c,_){return c&&hs(c,_,xr)}function Fo(c,_){return Ee(_,function(I){return An(c[I])})}function Mn(c,_){for(var I=0,V=(_=$n(_,c)).length;c!=null&&I<V;)c=c[dn(_[I++])];return I&&I==V?c:void 0}function _s(c,_,I){var V=_(c);return je(c)?V:g(V,I(c))}function Dr(c){return c==null?c===void 0?"[object Undefined]":"[object Null]":Bn&&Bn in er(c)?function(_){var I=Ge.call(_,Bn),V=_[Bn];try{_[Bn]=void 0;var ot=!0}catch{}var _t=Qr.call(_);return ot&&(I?_[Bn]=V:delete _[Bn]),_t}(c):function(_){return Qr.call(_)}(c)}function pa(c,_){return c>_}function su(c,_){return c!=null&&Ge.call(c,_)}function iu(c,_){return c!=null&&_ in er(c)}function fa(c,_,I){for(var V=I?u:a,ot=c[0].length,_t=c.length,Pt=_t,Ot=Qt(_t),qt=1/0,oe=[];Pt--;){var ne=c[Pt];Pt&&_&&(ne=p(ne,Lt(_))),qt=kr(ne.length,qt),Ot[Pt]=!I&&(_||ot>=120&&ne.length>=120)?new Un(Pt&&ne):void 0}ne=c[0];var ue=-1,we=Ot[0];t:for(;++ue<ot&&oe.length<qt;){var Ae=ne[ue],Fe=_?_(Ae):Ae;if(Ae=I||Ae!==0?Ae:0,!(we?ut(we,Fe):V(oe,Fe,I))){for(Pt=_t;--Pt;){var ae=Ot[Pt];if(!(ae?ut(ae,Fe):V(c[Pt],Fe,I)))continue t}we&&we.push(Fe),oe.push(Ae)}}return oe}function lo(c,_,I){var V=(c=ri(c,_=$n(_,c)))==null?c:c[dn(nn(_))];return V==null?void 0:Yt(V,c,I)}function gs(c){return _r(c)&&Dr(c)==o}function po(c,_,I,V,ot){return c===_||(c==null||_==null||!_r(c)&&!_r(_)?c!=c&&_!=_:function(_t,Pt,Ot,qt,oe,ne){var ue=je(_t),we=je(Pt),Ae=ue?f:$r(_t),Fe=we?f:$r(Pt),ae=(Ae=Ae==o?M:Ae)==M,fe=(Fe=Fe==o?M:Fe)==M,Pe=Ae==Fe;if(Pe&&Tn(_t)){if(!Tn(Pt))return!1;ue=!0,ae=!1}if(Pe&&!ae)return ne||(ne=new cn),ue||to(_t)?Ws(_t,Pt,Ot,qt,oe,ne):function(Ce,Oe,mr,vr,Nr,cr,Rr){switch(mr){case et:if(Ce.byteLength!=Oe.byteLength||Ce.byteOffset!=Oe.byteOffset)return!1;Ce=Ce.buffer,Oe=Oe.buffer;case at:return!(Ce.byteLength!=Oe.byteLength||!cr(new mo(Ce),new mo(Oe)));case d:case h:case U:return ln(+Ce,+Oe);case y:return Ce.name==Oe.name&&Ce.message==Oe.message;case Y:case D:return Ce==Oe+"";case T:var hn=Se;case Z:var Dn=1&vr;if(hn||(hn=ft),Ce.size!=Oe.size&&!Dn)return!1;var Gn=Rr.get(Ce);if(Gn)return Gn==Oe;vr|=2,Rr.set(Ce,Oe);var In=Ws(hn(Ce),hn(Oe),vr,Nr,cr,Rr);return Rr.delete(Ce),In;case nt:if(io)return io.call(Ce)==io.call(Oe)}return!1}(_t,Pt,Ae,Ot,qt,oe,ne);if(!(1&Ot)){var ve=ae&&Ge.call(_t,"__wrapped__"),De=fe&&Ge.call(Pt,"__wrapped__");if(ve||De){var qe=ve?_t.value():_t,Ze=De?Pt.value():Pt;return ne||(ne=new cn),oe(qe,Ze,Ot,qt,ne)}}return!!Pe&&(ne||(ne=new cn),function(Ce,Oe,mr,vr,Nr,cr){var Rr=1&mr,hn=Ia(Ce),Dn=hn.length;if(Dn!=Ia(Oe).length&&!Rr)return!1;for(var Gn=Dn;Gn--;){var In=hn[Gn];if(!(Rr?In in Oe:Ge.call(Oe,In)))return!1}var Li=cr.get(Ce),Ui=cr.get(Oe);if(Li&&Ui)return Li==Oe&&Ui==Ce;var Wo=!0;cr.set(Ce,Oe),cr.set(Oe,Ce);for(var Za=Rr;++Gn<Dn;){var Xo=Ce[In=hn[Gn]],Jo=Oe[In];if(vr)var Hi=Rr?vr(Jo,Xo,In,Oe,Ce,cr):vr(Xo,Jo,In,Ce,Oe,cr);if(!(Hi===void 0?Xo===Jo||Nr(Xo,Jo,mr,vr,cr):Hi)){Wo=!1;break}Za||(Za=In=="constructor")}if(Wo&&!Za){var Zo=Ce.constructor,Qo=Oe.constructor;Zo!=Qo&&"constructor"in Ce&&"constructor"in Oe&&!(typeof Zo=="function"&&Zo instanceof Zo&&typeof Qo=="function"&&Qo instanceof Qo)&&(Wo=!1)}return cr.delete(Ce),cr.delete(Oe),Wo}(_t,Pt,Ot,qt,oe,ne))}(c,_,I,V,po,ot))}function da(c,_,I,V){var ot=I.length,_t=ot,Pt=!V;if(c==null)return!_t;for(c=er(c);ot--;){var Ot=I[ot];if(Pt&&Ot[2]?Ot[1]!==c[Ot[0]]:!(Ot[0]in c))return!1}for(;++ot<_t;){var qt=(Ot=I[ot])[0],oe=c[qt],ne=Ot[1];if(Pt&&Ot[2]){if(oe===void 0&&!(qt in c))return!1}else{var ue=new cn;if(V)var we=V(oe,ne,qt,c,_,ue);if(!(we===void 0?po(ne,oe,3,V,ue):we))return!1}}return!0}function ys(c){return!(!dr(c)||(_=c,Yn&&Yn in _))&&(An(c)?ea:ee).test(Kn(c));var _}function ms(c){return typeof c=="function"?c:c==null?Mr:typeof c=="object"?je(c)?ws(c[0],c[1]):bs(c):Bi(c)}function ha(c){if(!_o(c))return Yi(c);var _=[];for(var I in er(c))Ge.call(c,I)&&I!="constructor"&&_.push(I);return _}function _a(c,_){return c<_}function vs(c,_){var I=-1,V=Ur(c)?Qt(c.length):[];return On(c,function(ot,_t,Pt){V[++I]=_(ot,_t,Pt)}),V}function bs(c){var _=Oa(c);return _.length==1&&_[0][2]?ti(_[0][0],_[0][1]):function(I){return I===c||da(I,c,_)}}function ws(c,_){return $a(c)&&Qs(_)?ti(dn(c),_):function(I){var V=Ma(I,c);return V===void 0&&V===_?qa(I,c):po(_,V,3)}}function Oo(c,_,I,V,ot){c!==_&&ca(_,function(_t,Pt){if(ot||(ot=new cn),dr(_t))(function(qt,oe,ne,ue,we,Ae,Fe){var ae=Ta(qt,ne),fe=Ta(oe,ne),Pe=Fe.get(fe);if(Pe)sa(qt,ne,Pe);else{var ve=Ae?Ae(ae,fe,ne+"",qt,oe,Fe):void 0,De=ve===void 0;if(De){var qe=je(fe),Ze=!qe&&Tn(fe),Ce=!qe&&!Ze&&to(fe);ve=fe,qe||Ze||Ce?je(ae)?ve=ae:yr(ae)?ve=Lr(ae):Ze?(De=!1,ve=Rs(fe,!0)):Ce?(De=!1,ve=Ts(fe,!0)):ve=[]:yo(fe)||Vn(fe)?(ve=ae,Vn(ae)?ve=Pi(ae):dr(ae)&&!An(ae)||(ve=Zs(fe))):De=!1}De&&(Fe.set(fe,ve),we(ve,fe,ue,Ae,Fe),Fe.delete(fe)),sa(qt,ne,ve)}})(c,_,Pt,I,Oo,V,ot);else{var Ot=V?V(Ta(c,Pt),_t,Pt+"",c,_,ot):void 0;Ot===void 0&&(Ot=_t),sa(c,Pt,Ot)}},Hr)}function Es(c,_){var I=c.length;if(I)return Sn(_+=_<0?I:0,I)?c[_]:void 0}function xs(c,_,I){_=_.length?p(_,function(ot){return je(ot)?function(_t){return Mn(_t,ot.length===1?ot[0]:ot)}:ot}):[Mr];var V=-1;return _=p(_,Lt(ke())),function(ot,_t){var Pt=ot.length;for(ot.sort(function(Ot,qt){return function(oe,ne,ue){for(var we=-1,Ae=oe.criteria,Fe=ne.criteria,ae=Ae.length,fe=ue.length;++we<ae;){var Pe=Ds(Ae[we],Fe[we]);if(Pe)return we>=fe?Pe:Pe*(ue[we]=="desc"?-1:1)}return oe.index-ne.index}(Ot,qt,I)});Pt--;)ot[Pt]=ot[Pt].value;return ot}(vs(c,function(ot,_t,Pt){return{criteria:p(_,function(Ot){return Ot(ot)}),index:++V,value:ot}}))}function Ss(c,_,I){for(var V=-1,ot=_.length,_t={};++V<ot;){var Pt=_[V],Ot=Mn(c,Pt);I(Ot,Pt)&&fo(_t,$n(Pt,c),Ot)}return _t}function ga(c,_,I,V){var ot=V?L:q,_t=-1,Pt=_.length,Ot=c;for(c===_&&(_=Lr(_)),I&&(Ot=p(c,Lt(I)));++_t<Pt;)for(var qt=0,oe=_[_t],ne=I?I(oe):oe;(qt=ot(Ot,ne,qt,V))>-1;)Ot!==c&&bo.call(Ot,qt,1),bo.call(c,qt,1);return c}function As(c,_){for(var I=c?_.length:0,V=I-1;I--;){var ot=_[I];if(I==V||ot!==_t){var _t=ot;Sn(ot)?bo.call(c,ot,1):ba(c,ot)}}return c}function ya(c,_){return c+xo(os()*(_-c+1))}function ma(c,_){var I="";if(!c||_<1||_>9007199254740991)return I;do _%2&&(I+=c),(_=xo(_/2))&&(c+=c);while(_);return I}function He(c,_){return Da(ei(c,_,Mr),c+"")}function uu(c){return is(eo(c))}function cu(c,_){var I=eo(c);return Uo(I,Hn(_,0,I.length))}function fo(c,_,I,V){if(!dr(c))return c;for(var ot=-1,_t=(_=$n(_,c)).length,Pt=_t-1,Ot=c;Ot!=null&&++ot<_t;){var qt=dn(_[ot]),oe=I;if(qt==="__proto__"||qt==="constructor"||qt==="prototype")return c;if(ot!=Pt){var ne=Ot[qt];(oe=V?V(ne,qt,Ot):void 0)===void 0&&(oe=dr(ne)?ne:Sn(_[ot+1])?[]:{})}uo(Ot,qt,oe),Ot=Ot[qt]}return c}var Cs=So?function(c,_){return So.set(c,_),c}:Mr,lu=wo?function(c,_){return wo(c,"toString",{configurable:!0,enumerable:!1,value:Va(_),writable:!0})}:Mr;function pu(c){return Uo(eo(c))}function rn(c,_,I){var V=-1,ot=c.length;_<0&&(_=-_>ot?0:ot+_),(I=I>ot?ot:I)<0&&(I+=ot),ot=_>I?0:I-_>>>0,_>>>=0;for(var _t=Qt(ot);++V<ot;)_t[V]=c[V+_];return _t}function fu(c,_){var I;return On(c,function(V,ot,_t){return!(I=_(V,ot,_t))}),!!I}function ko(c,_,I){var V=0,ot=c==null?V:c.length;if(typeof _=="number"&&_==_&&ot<=2147483647){for(;V<ot;){var _t=V+ot>>>1,Pt=c[_t];Pt!==null&&!Wr(Pt)&&(I?Pt<=_:Pt<_)?V=_t+1:ot=_t}return ot}return va(c,_,Mr,I)}function va(c,_,I,V){var ot=0,_t=c==null?0:c.length;if(_t===0)return 0;for(var Pt=(_=I(_))!=_,Ot=_===null,qt=Wr(_),oe=_===void 0;ot<_t;){var ne=xo((ot+_t)/2),ue=I(c[ne]),we=ue!==void 0,Ae=ue===null,Fe=ue==ue,ae=Wr(ue);if(Pt)var fe=V||Fe;else fe=oe?Fe&&(V||we):Ot?Fe&&we&&(V||!Ae):qt?Fe&&we&&!Ae&&(V||!ae):!Ae&&!ae&&(V?ue<=_:ue<_);fe?ot=ne+1:_t=ne}return kr(_t,4294967294)}function Is(c,_){for(var I=-1,V=c.length,ot=0,_t=[];++I<V;){var Pt=c[I],Ot=_?_(Pt):Pt;if(!I||!ln(Ot,qt)){var qt=Ot;_t[ot++]=Pt===0?0:Pt}}return _t}function Ps(c){return typeof c=="number"?c:Wr(c)?NaN:+c}function zr(c){if(typeof c=="string")return c;if(je(c))return p(c,zr)+"";if(Wr(c))return as?as.call(c):"";var _=c+"";return _=="0"&&1/c==-1/0?"-0":_}function kn(c,_,I){var V=-1,ot=a,_t=c.length,Pt=!0,Ot=[],qt=Ot;if(I)Pt=!1,ot=u;else if(_t>=200){var oe=_?null:hu(c);if(oe)return ft(oe);Pt=!1,ot=ut,qt=new Un}else qt=_?[]:Ot;t:for(;++V<_t;){var ne=c[V],ue=_?_(ne):ne;if(ne=I||ne!==0?ne:0,Pt&&ue==ue){for(var we=qt.length;we--;)if(qt[we]===ue)continue t;_&&qt.push(ue),Ot.push(ne)}else ot(qt,ue,I)||(qt!==Ot&&qt.push(ue),Ot.push(ne))}return Ot}function ba(c,_){return(c=ri(c,_=$n(_,c)))==null||delete c[dn(nn(_))]}function Fs(c,_,I,V){return fo(c,_,I(Mn(c,_)),V)}function $o(c,_,I,V){for(var ot=c.length,_t=V?ot:-1;(V?_t--:++_t<ot)&&_(c[_t],_t,c););return I?rn(c,V?0:_t,V?_t+1:ot):rn(c,V?_t+1:0,V?ot:_t)}function Os(c,_){var I=c;return I instanceof Ye&&(I=I.value()),m(_,function(V,ot){return ot.func.apply(ot.thisArg,g([V],ot.args))},I)}function wa(c,_,I){var V=c.length;if(V<2)return V?kn(c[0]):[];for(var ot=-1,_t=Qt(V);++ot<V;)for(var Pt=c[ot],Ot=-1;++Ot<V;)Ot!=ot&&(_t[ot]=co(_t[ot]||Pt,c[Ot],_,I));return kn(Cr(_t,1),_,I)}function ks(c,_,I){for(var V=-1,ot=c.length,_t=_.length,Pt={};++V<ot;){var Ot=V<_t?_[V]:void 0;I(Pt,c[V],Ot)}return Pt}function Ea(c){return yr(c)?c:[]}function xa(c){return typeof c=="function"?c:Mr}function $n(c,_){return je(c)?c:$a(c,_)?[c]:si(rr(c))}var du=He;function Rn(c,_,I){var V=c.length;return I=I===void 0?V:I,!_&&I>=V?c:rn(c,_,I)}var $s=Mi||function(c){return or.clearTimeout(c)};function Rs(c,_){if(_)return c.slice();var I=c.length,V=Qa?Qa(I):new c.constructor(I);return c.copy(V),V}function Sa(c){var _=new c.constructor(c.byteLength);return new mo(_).set(new mo(c)),_}function Ts(c,_){var I=_?Sa(c.buffer):c.buffer;return new c.constructor(I,c.byteOffset,c.length)}function Ds(c,_){if(c!==_){var I=c!==void 0,V=c===null,ot=c==c,_t=Wr(c),Pt=_!==void 0,Ot=_===null,qt=_==_,oe=Wr(_);if(!Ot&&!oe&&!_t&&c>_||_t&&Pt&&qt&&!Ot&&!oe||V&&Pt&&qt||!I&&qt||!ot)return 1;if(!V&&!_t&&!oe&&c<_||oe&&I&&ot&&!V&&!_t||Ot&&I&&ot||!Pt&&ot||!qt)return-1}return 0}function js(c,_,I,V){for(var ot=-1,_t=c.length,Pt=I.length,Ot=-1,qt=_.length,oe=br(_t-Pt,0),ne=Qt(qt+oe),ue=!V;++Ot<qt;)ne[Ot]=_[Ot];for(;++ot<Pt;)(ue||ot<_t)&&(ne[I[ot]]=c[ot]);for(;oe--;)ne[Ot++]=c[ot++];return ne}function Ns(c,_,I,V){for(var ot=-1,_t=c.length,Pt=-1,Ot=I.length,qt=-1,oe=_.length,ne=br(_t-Ot,0),ue=Qt(ne+oe),we=!V;++ot<ne;)ue[ot]=c[ot];for(var Ae=ot;++qt<oe;)ue[Ae+qt]=_[qt];for(;++Pt<Ot;)(we||ot<_t)&&(ue[Ae+I[Pt]]=c[ot++]);return ue}function Lr(c,_){var I=-1,V=c.length;for(_||(_=Qt(V));++I<V;)_[I]=c[I];return _}function fn(c,_,I,V){var ot=!I;I||(I={});for(var _t=-1,Pt=_.length;++_t<Pt;){var Ot=_[_t],qt=V?V(I[Ot],c[Ot],Ot,I,c):void 0;qt===void 0&&(qt=c[Ot]),ot?wn(I,Ot,qt):uo(I,Ot,qt)}return I}function Ro(c,_){return function(I,V){var ot=je(I)?Te:ou,_t=_?_():{};return ot(I,c,ke(V,2),_t)}}function Jn(c){return He(function(_,I){var V=-1,ot=I.length,_t=ot>1?I[ot-1]:void 0,Pt=ot>2?I[2]:void 0;for(_t=c.length>3&&typeof _t=="function"?(ot--,_t):void 0,Pt&&jr(I[0],I[1],Pt)&&(_t=ot<3?void 0:_t,ot=1),_=er(_);++V<ot;){var Ot=I[V];Ot&&c(_,Ot,V,_t)}return _})}function Bs(c,_){return function(I,V){if(I==null)return I;if(!Ur(I))return c(I,V);for(var ot=I.length,_t=_?ot:-1,Pt=er(I);(_?_t--:++_t<ot)&&V(Pt[_t],_t,Pt)!==!1;);return I}}function Ls(c){return function(_,I,V){for(var ot=-1,_t=er(_),Pt=V(_),Ot=Pt.length;Ot--;){var qt=Pt[c?Ot:++ot];if(I(_t[qt],qt,_t)===!1)break}return _}}function Us(c){return function(_){var I=Ht(_=rr(_))?Ft(_):void 0,V=I?I[0]:_.charAt(0),ot=I?Rn(I,1).join(""):_.slice(1);return V[c]()+ot}}function Zn(c){return function(_){return m(ji(Di(_).replace(tr,"")),c,"")}}function ho(c){return function(){var _=arguments;switch(_.length){case 0:return new c;case 1:return new c(_[0]);case 2:return new c(_[0],_[1]);case 3:return new c(_[0],_[1],_[2]);case 4:return new c(_[0],_[1],_[2],_[3]);case 5:return new c(_[0],_[1],_[2],_[3],_[4]);case 6:return new c(_[0],_[1],_[2],_[3],_[4],_[5]);case 7:return new c(_[0],_[1],_[2],_[3],_[4],_[5],_[6])}var I=Xn(c.prototype),V=c.apply(I,_);return dr(V)?V:I}}function Hs(c){return function(_,I,V){var ot=er(_);if(!Ur(_)){var _t=ke(I,3);_=xr(_),I=function(Ot){return _t(ot[Ot],Ot,ot)}}var Pt=c(_,I,V);return Pt>-1?ot[_t?_[Pt]:Pt]:void 0}}function Ms(c){return xn(function(_){var I=_.length,V=I,ot=tn.prototype.thru;for(c&&_.reverse();V--;){var _t=_[V];if(typeof _t!="function")throw new wr(e);if(ot&&!Pt&&Bo(_t)=="wrapper")var Pt=new tn([],!0)}for(V=Pt?V:I;++V<I;){var Ot=Bo(_t=_[V]),qt=Ot=="wrapper"?Fa(_t):void 0;Pt=qt&&Ra(qt[0])&&qt[1]==424&&!qt[4].length&&qt[9]==1?Pt[Bo(qt[0])].apply(Pt,qt[3]):_t.length==1&&Ra(_t)?Pt[Ot]():Pt.thru(_t)}return function(){var oe=arguments,ne=oe[0];if(Pt&&oe.length==1&&je(ne))return Pt.plant(ne).value();for(var ue=0,we=I?_[ue].apply(this,oe):ne;++ue<I;)we=_[ue].call(this,we);return we}})}function To(c,_,I,V,ot,_t,Pt,Ot,qt,oe){var ne=128&_,ue=1&_,we=2&_,Ae=24&_,Fe=512&_,ae=we?void 0:ho(c);return function fe(){for(var Pe=arguments.length,ve=Qt(Pe),De=Pe;De--;)ve[De]=arguments[De];if(Ae)var qe=Qn(fe),Ze=function(vr,Nr){for(var cr=vr.length,Rr=0;cr--;)vr[cr]===Nr&&++Rr;return Rr}(ve,qe);if(V&&(ve=js(ve,V,ot,Ae)),_t&&(ve=Ns(ve,_t,Pt,Ae)),Pe-=Ze,Ae&&Pe<oe){var Ce=Q(ve,qe);return Vs(c,_,To,fe.placeholder,I,ve,Ce,Ot,qt,oe-Pe)}var Oe=ue?I:this,mr=we?Oe[c]:c;return Pe=ve.length,Ot?ve=function(vr,Nr){for(var cr=vr.length,Rr=kr(Nr.length,cr),hn=Lr(vr);Rr--;){var Dn=Nr[Rr];vr[Rr]=Sn(Dn,cr)?hn[Dn]:void 0}return vr}(ve,Ot):Fe&&Pe>1&&ve.reverse(),ne&&qt<Pe&&(ve.length=qt),this&&this!==or&&this instanceof fe&&(mr=ae||ho(mr)),mr.apply(Oe,ve)}}function qs(c,_){return function(I,V){return function(ot,_t,Pt,Ot){return pn(ot,function(qt,oe,ne){_t(Ot,Pt(qt),oe,ne)}),Ot}(I,c,_(V),{})}}function Do(c,_){return function(I,V){var ot;if(I===void 0&&V===void 0)return _;if(I!==void 0&&(ot=I),V!==void 0){if(ot===void 0)return V;typeof I=="string"||typeof V=="string"?(I=zr(I),V=zr(V)):(I=Ps(I),V=Ps(V)),ot=c(I,V)}return ot}}function Aa(c){return xn(function(_){return _=p(_,Lt(ke())),He(function(I){var V=this;return c(_,function(ot){return Yt(ot,V,I)})})})}function jo(c,_){var I=(_=_===void 0?" ":zr(_)).length;if(I<2)return I?ma(_,c):_;var V=ma(_,Eo(c/Rt(_)));return Ht(_)?Rn(Ft(V),0,c).join(""):V.slice(0,c)}function Ks(c){return function(_,I,V){return V&&typeof V!="number"&&jr(_,I,V)&&(I=V=void 0),_=Cn(_),I===void 0?(I=_,_=0):I=Cn(I),function(ot,_t,Pt,Ot){for(var qt=-1,oe=br(Eo((_t-ot)/(Pt||1)),0),ne=Qt(oe);oe--;)ne[Ot?oe:++qt]=ot,ot+=Pt;return ne}(_,I,V=V===void 0?_<I?1:-1:Cn(V),c)}}function No(c){return function(_,I){return typeof _=="string"&&typeof I=="string"||(_=on(_),I=on(I)),c(_,I)}}function Vs(c,_,I,V,ot,_t,Pt,Ot,qt,oe){var ne=8&_;_|=ne?32:64,4&(_&=~(ne?64:32))||(_&=-4);var ue=[c,_,ot,ne?_t:void 0,ne?Pt:void 0,ne?void 0:_t,ne?void 0:Pt,Ot,qt,oe],we=I.apply(void 0,ue);return Ra(c)&&ni(we,ue),we.placeholder=V,oi(we,c,_)}function Ca(c){var _=Pr[c];return function(I,V){if(I=on(I),(V=V==null?0:kr(Ne(V),292))&&ns(I)){var ot=(rr(I)+"e").split("e");return+((ot=(rr(_(ot[0]+"e"+(+ot[1]+V)))+"e").split("e"))[0]+"e"+(+ot[1]-V))}return _(I)}}var hu=zn&&1/ft(new zn([,-0]))[1]==1/0?function(c){return new zn(c)}:za;function Gs(c){return function(_){var I=$r(_);return I==T?Se(_):I==Z?vt(_):function(V,ot){return p(ot,function(_t){return[_t,V[_t]]})}(_,c(_))}}function En(c,_,I,V,ot,_t,Pt,Ot){var qt=2&_;if(!qt&&typeof c!="function")throw new wr(e);var oe=V?V.length:0;if(oe||(_&=-97,V=ot=void 0),Pt=Pt===void 0?Pt:br(Ne(Pt),0),Ot=Ot===void 0?Ot:Ne(Ot),oe-=ot?ot.length:0,64&_){var ne=V,ue=ot;V=ot=void 0}var we=qt?void 0:Fa(c),Ae=[c,_,I,V,ot,ne,ue,_t,Pt,Ot];if(we&&function(ae,fe){var Pe=ae[1],ve=fe[1],De=Pe|ve,qe=De<131,Ze=ve==128&&Pe==8||ve==128&&Pe==256&&ae[7].length<=fe[8]||ve==384&&fe[7].length<=fe[8]&&Pe==8;if(!qe&&!Ze)return ae;1&ve&&(ae[2]=fe[2],De|=1&Pe?0:4);var Ce=fe[3];if(Ce){var Oe=ae[3];ae[3]=Oe?js(Oe,Ce,fe[4]):Ce,ae[4]=Oe?Q(ae[3],n):fe[4]}(Ce=fe[5])&&(Oe=ae[5],ae[5]=Oe?Ns(Oe,Ce,fe[6]):Ce,ae[6]=Oe?Q(ae[5],n):fe[6]),(Ce=fe[7])&&(ae[7]=Ce),128&ve&&(ae[8]=ae[8]==null?fe[8]:kr(ae[8],fe[8])),ae[9]==null&&(ae[9]=fe[9]),ae[0]=fe[0],ae[1]=De}(Ae,we),c=Ae[0],_=Ae[1],I=Ae[2],V=Ae[3],ot=Ae[4],!(Ot=Ae[9]=Ae[9]===void 0?qt?0:c.length:br(Ae[9]-oe,0))&&24&_&&(_&=-25),_&&_!=1)Fe=_==8||_==16?function(ae,fe,Pe){var ve=ho(ae);return function De(){for(var qe=arguments.length,Ze=Qt(qe),Ce=qe,Oe=Qn(De);Ce--;)Ze[Ce]=arguments[Ce];var mr=qe<3&&Ze[0]!==Oe&&Ze[qe-1]!==Oe?[]:Q(Ze,Oe);return(qe-=mr.length)<Pe?Vs(ae,fe,To,De.placeholder,void 0,Ze,mr,void 0,void 0,Pe-qe):Yt(this&&this!==or&&this instanceof De?ve:ae,this,Ze)}}(c,_,Ot):_!=32&&_!=33||ot.length?To.apply(void 0,Ae):function(ae,fe,Pe,ve){var De=1&fe,qe=ho(ae);return function Ze(){for(var Ce=-1,Oe=arguments.length,mr=-1,vr=ve.length,Nr=Qt(vr+Oe),cr=this&&this!==or&&this instanceof Ze?qe:ae;++mr<vr;)Nr[mr]=ve[mr];for(;Oe--;)Nr[mr++]=arguments[++Ce];return Yt(cr,De?Pe:this,Nr)}}(c,_,I,V);else var Fe=function(ae,fe,Pe){var ve=1&fe,De=ho(ae);return function qe(){return(this&&this!==or&&this instanceof qe?De:ae).apply(ve?Pe:this,arguments)}}(c,_,I);return oi((we?Cs:ni)(Fe,Ae),c,_)}function Ys(c,_,I,V){return c===void 0||ln(c,Or[I])&&!Ge.call(V,I)?_:c}function zs(c,_,I,V,ot,_t){return dr(c)&&dr(_)&&(_t.set(_,c),Oo(c,_,void 0,zs,_t),_t.delete(_)),c}function _u(c){return yo(c)?void 0:c}function Ws(c,_,I,V,ot,_t){var Pt=1&I,Ot=c.length,qt=_.length;if(Ot!=qt&&!(Pt&&qt>Ot))return!1;var oe=_t.get(c),ne=_t.get(_);if(oe&&ne)return oe==_&&ne==c;var ue=-1,we=!0,Ae=2&I?new Un:void 0;for(_t.set(c,_),_t.set(_,c);++ue<Ot;){var Fe=c[ue],ae=_[ue];if(V)var fe=Pt?V(ae,Fe,ue,_,c,_t):V(Fe,ae,ue,c,_,_t);if(fe!==void 0){if(fe)continue;we=!1;break}if(Ae){if(!O(_,function(Pe,ve){if(!ut(Ae,ve)&&(Fe===Pe||ot(Fe,Pe,I,V,_t)))return Ae.push(ve)})){we=!1;break}}else if(Fe!==ae&&!ot(Fe,ae,I,V,_t)){we=!1;break}}return _t.delete(c),_t.delete(_),we}function xn(c){return Da(ei(c,void 0,li),c+"")}function Ia(c){return _s(c,xr,ka)}function Pa(c){return _s(c,Hr,Xs)}var Fa=So?function(c){return So.get(c)}:za;function Bo(c){for(var _=c.name+"",I=Wn[_],V=Ge.call(Wn,_)?I.length:0;V--;){var ot=I[V],_t=ot.func;if(_t==null||_t==c)return ot.name}return _}function Qn(c){return(Ge.call(lt,"placeholder")?lt:c).placeholder}function ke(){var c=lt.iteratee||Ga;return c=c===Ga?ms:c,arguments.length?c(arguments[0],arguments[1]):c}function Lo(c,_){var I,V,ot=c.__data__;return((V=typeof(I=_))=="string"||V=="number"||V=="symbol"||V=="boolean"?I!=="__proto__":I===null)?ot[typeof _=="string"?"string":"hash"]:ot.map}function Oa(c){for(var _=xr(c),I=_.length;I--;){var V=_[I],ot=c[V];_[I]=[V,ot,Qs(ot)]}return _}function qn(c,_){var I=function(V,ot){return V?.[ot]}(c,_);return ys(I)?I:void 0}var ka=na?function(c){return c==null?[]:(c=er(c),Ee(na(c),function(_){return es.call(c,_)}))}:Wa,Xs=na?function(c){for(var _=[];c;)g(_,ka(c)),c=vo(c);return _}:Wa,$r=Dr;function Js(c,_,I){for(var V=-1,ot=(_=$n(_,c)).length,_t=!1;++V<ot;){var Pt=dn(_[V]);if(!(_t=c!=null&&I(c,Pt)))break;c=c[Pt]}return _t||++V!=ot?_t:!!(ot=c==null?0:c.length)&&Go(ot)&&Sn(Pt,ot)&&(je(c)||Vn(c))}function Zs(c){return typeof c.constructor!="function"||_o(c)?{}:Xn(vo(c))}function gu(c){return je(c)||Vn(c)||!!(rs&&c&&c[rs])}function Sn(c,_){var I=typeof c;return!!(_=_??9007199254740991)&&(I=="number"||I!="symbol"&&be.test(c))&&c>-1&&c%1==0&&c<_}function jr(c,_,I){if(!dr(I))return!1;var V=typeof _;return!!(V=="number"?Ur(I)&&Sn(_,I.length):V=="string"&&_ in I)&&ln(I[_],c)}function $a(c,_){if(je(c))return!1;var I=typeof c;return!(I!="number"&&I!="symbol"&&I!="boolean"&&c!=null&&!Wr(c))||j.test(c)||!C.test(c)||_!=null&&c in er(_)}function Ra(c){var _=Bo(c),I=lt[_];if(typeof I!="function"||!(_ in Ye.prototype))return!1;if(c===I)return!0;var V=Fa(I);return!!V&&c===V[0]}(oa&&$r(new oa(new ArrayBuffer(1)))!=et||oo&&$r(new oo)!=T||aa&&$r(aa.resolve())!="[object Promise]"||zn&&$r(new zn)!=Z||ao&&$r(new ao)!=ct)&&($r=function(c){var _=Dr(c),I=_==M?c.constructor:void 0,V=I?Kn(I):"";if(V)switch(V){case Ji:return et;case Zi:return T;case Qi:return"[object Promise]";case tu:return Z;case eu:return ct}return _});var yu=ir?An:Xa;function _o(c){var _=c&&c.constructor;return c===(typeof _=="function"&&_.prototype||Or)}function Qs(c){return c==c&&!dr(c)}function ti(c,_){return function(I){return I!=null&&I[c]===_&&(_!==void 0||c in er(I))}}function ei(c,_,I){return _=br(_===void 0?c.length-1:_,0),function(){for(var V=arguments,ot=-1,_t=br(V.length-_,0),Pt=Qt(_t);++ot<_t;)Pt[ot]=V[_+ot];ot=-1;for(var Ot=Qt(_+1);++ot<_;)Ot[ot]=V[ot];return Ot[_]=I(Pt),Yt(c,this,Ot)}}function ri(c,_){return _.length<2?c:Mn(c,rn(_,0,-1))}function Ta(c,_){if((_!=="constructor"||typeof c[_]!="function")&&_!="__proto__")return c[_]}var ni=ai(Cs),go=Ki||function(c,_){return or.setTimeout(c,_)},Da=ai(lu);function oi(c,_,I){var V=_+"";return Da(c,function(ot,_t){var Pt=_t.length;if(!Pt)return ot;var Ot=Pt-1;return _t[Ot]=(Pt>1?"& ":"")+_t[Ot],_t=_t.join(Pt>2?", ":" "),ot.replace(_e,`{
/* [wrapped with `+_t+`] */
`)}(V,function(ot,_t){return Jt(r,function(Pt){var Ot="_."+Pt[0];_t&Pt[1]&&!a(ot,Ot)&&ot.push(Ot)}),ot.sort()}(function(ot){var _t=ot.match(me);return _t?_t[1].split(de):[]}(V),I)))}function ai(c){var _=0,I=0;return function(){var V=zi(),ot=16-(V-I);if(I=V,ot>0){if(++_>=800)return arguments[0]}else _=0;return c.apply(void 0,arguments)}}function Uo(c,_){var I=-1,V=c.length,ot=V-1;for(_=_===void 0?V:_;++I<_;){var _t=ya(I,ot),Pt=c[_t];c[_t]=c[I],c[I]=Pt}return c.length=_,c}var si=function(c){var _=Ko(function(V){var ot=[];return V.charCodeAt(0)===46&&ot.push(""),V.replace(K,function(_t,Pt,Ot,qt){ot.push(Ot?qt.replace(pe,"$1"):Pt||_t)}),ot},function(V){return I.size===500&&I.clear(),V}),I=_.cache;return _}();function dn(c){if(typeof c=="string"||Wr(c))return c;var _=c+"";return _=="0"&&1/c==-1/0?"-0":_}function Kn(c){if(c!=null){try{return Br.call(c)}catch{}try{return c+""}catch{}}return""}function ii(c){if(c instanceof Ye)return c.clone();var _=new tn(c.__wrapped__,c.__chain__);return _.__actions__=Lr(c.__actions__),_.__index__=c.__index__,_.__values__=c.__values__,_}var mu=He(function(c,_){return yr(c)?co(c,Cr(_,1,yr,!0)):[]}),vu=He(function(c,_){var I=nn(_);return yr(I)&&(I=void 0),yr(c)?co(c,Cr(_,1,yr,!0),ke(I,2)):[]}),bu=He(function(c,_){var I=nn(_);return yr(I)&&(I=void 0),yr(c)?co(c,Cr(_,1,yr,!0),void 0,I):[]});function ui(c,_,I){var V=c==null?0:c.length;if(!V)return-1;var ot=I==null?0:Ne(I);return ot<0&&(ot=br(V+ot,0)),B(c,ke(_,3),ot)}function ci(c,_,I){var V=c==null?0:c.length;if(!V)return-1;var ot=V-1;return I!==void 0&&(ot=Ne(I),ot=I<0?br(V+ot,0):kr(ot,V-1)),B(c,ke(_,3),ot,!0)}function li(c){return c!=null&&c.length?Cr(c,1):[]}function pi(c){return c&&c.length?c[0]:void 0}var wu=He(function(c){var _=p(c,Ea);return _.length&&_[0]===c[0]?fa(_):[]}),Eu=He(function(c){var _=nn(c),I=p(c,Ea);return _===nn(I)?_=void 0:I.pop(),I.length&&I[0]===c[0]?fa(I,ke(_,2)):[]}),xu=He(function(c){var _=nn(c),I=p(c,Ea);return(_=typeof _=="function"?_:void 0)&&I.pop(),I.length&&I[0]===c[0]?fa(I,void 0,_):[]});function nn(c){var _=c==null?0:c.length;return _?c[_-1]:void 0}var Su=He(fi);function fi(c,_){return c&&c.length&&_&&_.length?ga(c,_):c}var Au=xn(function(c,_){var I=c==null?0:c.length,V=ia(c,_);return As(c,p(_,function(ot){return Sn(ot,I)?+ot:ot}).sort(Ds)),V});function ja(c){return c==null?c:Xi.call(c)}var Cu=He(function(c){return kn(Cr(c,1,yr,!0))}),Iu=He(function(c){var _=nn(c);return yr(_)&&(_=void 0),kn(Cr(c,1,yr,!0),ke(_,2))}),Pu=He(function(c){var _=nn(c);return _=typeof _=="function"?_:void 0,kn(Cr(c,1,yr,!0),void 0,_)});function Na(c){if(!c||!c.length)return[];var _=0;return c=Ee(c,function(I){if(yr(I))return _=br(I.length,_),!0}),It(_,function(I){return p(c,W(I))})}function di(c,_){if(!c||!c.length)return[];var I=Na(c);return _==null?I:p(I,function(V){return Yt(_,void 0,V)})}var Fu=He(function(c,_){return yr(c)?co(c,_):[]}),Ou=He(function(c){return wa(Ee(c,yr))}),ku=He(function(c){var _=nn(c);return yr(_)&&(_=void 0),wa(Ee(c,yr),ke(_,2))}),$u=He(function(c){var _=nn(c);return _=typeof _=="function"?_:void 0,wa(Ee(c,yr),void 0,_)}),Ru=He(Na),Tu=He(function(c){var _=c.length,I=_>1?c[_-1]:void 0;return I=typeof I=="function"?(c.pop(),I):void 0,di(c,I)});function hi(c){var _=lt(c);return _.__chain__=!0,_}function Ho(c,_){return _(c)}var Du=xn(function(c){var _=c.length,I=_?c[0]:0,V=this.__wrapped__,ot=function(_t){return ia(_t,c)};return!(_>1||this.__actions__.length)&&V instanceof Ye&&Sn(I)?((V=V.slice(I,+I+(_?1:0))).__actions__.push({func:Ho,args:[ot],thisArg:void 0}),new tn(V,this.__chain__).thru(function(_t){return _&&!_t.length&&_t.push(void 0),_t})):this.thru(ot)}),ju=Ro(function(c,_,I){Ge.call(c,I)?++c[I]:wn(c,I,1)}),Nu=Hs(ui),Bu=Hs(ci);function _i(c,_){return(je(c)?Jt:On)(c,ke(_,3))}function gi(c,_){return(je(c)?jn:ps)(c,ke(_,3))}var Lu=Ro(function(c,_,I){Ge.call(c,I)?c[I].push(_):wn(c,I,[_])}),Uu=He(function(c,_,I){var V=-1,ot=typeof _=="function",_t=Ur(c)?Qt(c.length):[];return On(c,function(Pt){_t[++V]=ot?Yt(_,Pt,I):lo(Pt,_,I)}),_t}),Hu=Ro(function(c,_,I){wn(c,I,_)});function Mo(c,_){return(je(c)?p:vs)(c,ke(_,3))}var Mu=Ro(function(c,_,I){c[I?0:1].push(_)},function(){return[[],[]]}),qu=He(function(c,_){if(c==null)return[];var I=_.length;return I>1&&jr(c,_[0],_[1])?_=[]:I>2&&jr(_[0],_[1],_[2])&&(_=[_[0]]),xs(c,Cr(_,1),[])}),qo=qi||function(){return or.Date.now()};function yi(c,_,I){return _=I?void 0:_,En(c,128,void 0,void 0,void 0,void 0,_=c&&_==null?c.length:_)}function mi(c,_){var I;if(typeof _!="function")throw new wr(e);return c=Ne(c),function(){return--c>0&&(I=_.apply(this,arguments)),c<=1&&(_=void 0),I}}var Ba=He(function(c,_,I){var V=1;if(I.length){var ot=Q(I,Qn(Ba));V|=32}return En(c,V,_,I,ot)}),vi=He(function(c,_,I){var V=3;if(I.length){var ot=Q(I,Qn(vi));V|=32}return En(_,V,c,I,ot)});function bi(c,_,I){var V,ot,_t,Pt,Ot,qt,oe=0,ne=!1,ue=!1,we=!0;if(typeof c!="function")throw new wr(e);function Ae(ve){var De=V,qe=ot;return V=ot=void 0,oe=ve,Pt=c.apply(qe,De)}function Fe(ve){var De=ve-qt;return qt===void 0||De>=_||De<0||ue&&ve-oe>=_t}function ae(){var ve=qo();if(Fe(ve))return fe(ve);Ot=go(ae,function(De){var qe=_-(De-qt);return ue?kr(qe,_t-(De-oe)):qe}(ve))}function fe(ve){return Ot=void 0,we&&V?Ae(ve):(V=ot=void 0,Pt)}function Pe(){var ve=qo(),De=Fe(ve);if(V=arguments,ot=this,qt=ve,De){if(Ot===void 0)return function(qe){return oe=qe,Ot=go(ae,_),ne?Ae(qe):Pt}(qt);if(ue)return $s(Ot),Ot=go(ae,_),Ae(qt)}return Ot===void 0&&(Ot=go(ae,_)),Pt}return _=on(_)||0,dr(I)&&(ne=!!I.leading,_t=(ue="maxWait"in I)?br(on(I.maxWait)||0,_):_t,we="trailing"in I?!!I.trailing:we),Pe.cancel=function(){Ot!==void 0&&$s(Ot),oe=0,V=qt=ot=Ot=void 0},Pe.flush=function(){return Ot===void 0?Pt:fe(qo())},Pe}var Ku=He(function(c,_){return ls(c,1,_)}),Vu=He(function(c,_,I){return ls(c,on(_)||0,I)});function Ko(c,_){if(typeof c!="function"||_!=null&&typeof _!="function")throw new wr(e);var I=function(){var V=arguments,ot=_?_.apply(this,V):V[0],_t=I.cache;if(_t.has(ot))return _t.get(ot);var Pt=c.apply(this,V);return I.cache=_t.set(ot,Pt)||_t,Pt};return I.cache=new(Ko.Cache||bn),I}function Vo(c){if(typeof c!="function")throw new wr(e);return function(){var _=arguments;switch(_.length){case 0:return!c.call(this);case 1:return!c.call(this,_[0]);case 2:return!c.call(this,_[0],_[1]);case 3:return!c.call(this,_[0],_[1],_[2])}return!c.apply(this,_)}}Ko.Cache=bn;var Gu=du(function(c,_){var I=(_=_.length==1&&je(_[0])?p(_[0],Lt(ke())):p(Cr(_,1),Lt(ke()))).length;return He(function(V){for(var ot=-1,_t=kr(V.length,I);++ot<_t;)V[ot]=_[ot].call(this,V[ot]);return Yt(c,this,V)})}),La=He(function(c,_){return En(c,32,void 0,_,Q(_,Qn(La)))}),wi=He(function(c,_){return En(c,64,void 0,_,Q(_,Qn(wi)))}),Yu=xn(function(c,_){return En(c,256,void 0,void 0,void 0,_)});function ln(c,_){return c===_||c!=c&&_!=_}var zu=No(pa),Wu=No(function(c,_){return c>=_}),Vn=gs(function(){return arguments}())?gs:function(c){return _r(c)&&Ge.call(c,"callee")&&!es.call(c,"callee")},je=Qt.isArray,Xu=Ut?Lt(Ut):function(c){return _r(c)&&Dr(c)==at};function Ur(c){return c!=null&&Go(c.length)&&!An(c)}function yr(c){return _r(c)&&Ur(c)}var Tn=Vi||Xa,Ju=sr?Lt(sr):function(c){return _r(c)&&Dr(c)==h};function Ua(c){if(!_r(c))return!1;var _=Dr(c);return _==y||_=="[object DOMException]"||typeof c.message=="string"&&typeof c.name=="string"&&!yo(c)}function An(c){if(!dr(c))return!1;var _=Dr(c);return _==F||_==S||_=="[object AsyncFunction]"||_=="[object Proxy]"}function Ei(c){return typeof c=="number"&&c==Ne(c)}function Go(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=9007199254740991}function dr(c){var _=typeof c;return c!=null&&(_=="object"||_=="function")}function _r(c){return c!=null&&typeof c=="object"}var xi=_n?Lt(_n):function(c){return _r(c)&&$r(c)==T};function Si(c){return typeof c=="number"||_r(c)&&Dr(c)==U}function yo(c){if(!_r(c)||Dr(c)!=M)return!1;var _=vo(c);if(_===null)return!0;var I=Ge.call(_,"constructor")&&_.constructor;return typeof I=="function"&&I instanceof I&&Br.call(I)==mn}var Ha=Ie?Lt(Ie):function(c){return _r(c)&&Dr(c)==Y},Ai=fr?Lt(fr):function(c){return _r(c)&&$r(c)==Z};function Yo(c){return typeof c=="string"||!je(c)&&_r(c)&&Dr(c)==D}function Wr(c){return typeof c=="symbol"||_r(c)&&Dr(c)==nt}var to=Ue?Lt(Ue):function(c){return _r(c)&&Go(c.length)&&!!ye[Dr(c)]},Zu=No(_a),Qu=No(function(c,_){return c<=_});function Ci(c){if(!c)return[];if(Ur(c))return Yo(c)?Ft(c):Lr(c);if(no&&c[no])return function(I){for(var V,ot=[];!(V=I.next()).done;)ot.push(V.value);return ot}(c[no]());var _=$r(c);return(_==T?Se:_==Z?ft:eo)(c)}function Cn(c){return c?(c=on(c))===1/0||c===-1/0?17976931348623157e292*(c<0?-1:1):c==c?c:0:c===0?c:0}function Ne(c){var _=Cn(c),I=_%1;return _==_?I?_-I:_:0}function Ii(c){return c?Hn(Ne(c),0,4294967295):0}function on(c){if(typeof c=="number")return c;if(Wr(c))return NaN;if(dr(c)){var _=typeof c.valueOf=="function"?c.valueOf():c;c=dr(_)?_+"":_}if(typeof c!="string")return c===0?c:+c;c=Mt(c);var I=ie.test(c);return I||Kt.test(c)?Zr(c.slice(2),I?2:8):Bt.test(c)?NaN:+c}function Pi(c){return fn(c,Hr(c))}function rr(c){return c==null?"":zr(c)}var tc=Jn(function(c,_){if(_o(_)||Ur(_))fn(_,xr(_),c);else for(var I in _)Ge.call(_,I)&&uo(c,I,_[I])}),Fi=Jn(function(c,_){fn(_,Hr(_),c)}),zo=Jn(function(c,_,I,V){fn(_,Hr(_),c,V)}),ec=Jn(function(c,_,I,V){fn(_,xr(_),c,V)}),rc=xn(ia),nc=He(function(c,_){c=er(c);var I=-1,V=_.length,ot=V>2?_[2]:void 0;for(ot&&jr(_[0],_[1],ot)&&(V=1);++I<V;)for(var _t=_[I],Pt=Hr(_t),Ot=-1,qt=Pt.length;++Ot<qt;){var oe=Pt[Ot],ne=c[oe];(ne===void 0||ln(ne,Or[oe])&&!Ge.call(c,oe))&&(c[oe]=_t[oe])}return c}),oc=He(function(c){return c.push(void 0,zs),Yt(Oi,void 0,c)});function Ma(c,_,I){var V=c==null?void 0:Mn(c,_);return V===void 0?I:V}function qa(c,_){return c!=null&&Js(c,_,iu)}var ac=qs(function(c,_,I){_!=null&&typeof _.toString!="function"&&(_=Qr.call(_)),c[_]=I},Va(Mr)),sc=qs(function(c,_,I){_!=null&&typeof _.toString!="function"&&(_=Qr.call(_)),Ge.call(c,_)?c[_].push(I):c[_]=[I]},ke),ic=He(lo);function xr(c){return Ur(c)?ss(c):ha(c)}function Hr(c){return Ur(c)?ss(c,!0):function(_){if(!dr(_))return function(_t){var Pt=[];if(_t!=null)for(var Ot in er(_t))Pt.push(Ot);return Pt}(_);var I=_o(_),V=[];for(var ot in _)(ot!="constructor"||!I&&Ge.call(_,ot))&&V.push(ot);return V}(c)}var uc=Jn(function(c,_,I){Oo(c,_,I)}),Oi=Jn(function(c,_,I,V){Oo(c,_,I,V)}),cc=xn(function(c,_){var I={};if(c==null)return I;var V=!1;_=p(_,function(_t){return _t=$n(_t,c),V||(V=_t.length>1),_t}),fn(c,Pa(c),I),V&&(I=en(I,7,_u));for(var ot=_.length;ot--;)ba(I,_[ot]);return I}),lc=xn(function(c,_){return c==null?{}:function(I,V){return Ss(I,V,function(ot,_t){return qa(I,_t)})}(c,_)});function ki(c,_){if(c==null)return{};var I=p(Pa(c),function(V){return[V]});return _=ke(_),Ss(c,I,function(V,ot){return _(V,ot[0])})}var $i=Gs(xr),Ri=Gs(Hr);function eo(c){return c==null?[]:tt(c,xr(c))}var pc=Zn(function(c,_,I){return _=_.toLowerCase(),c+(I?Ti(_):_)});function Ti(c){return Ka(rr(c).toLowerCase())}function Di(c){return(c=rr(c))&&c.replace(b,wt).replace(an,"")}var fc=Zn(function(c,_,I){return c+(I?"-":"")+_.toLowerCase()}),dc=Zn(function(c,_,I){return c+(I?" ":"")+_.toLowerCase()}),hc=Us("toLowerCase"),_c=Zn(function(c,_,I){return c+(I?"_":"")+_.toLowerCase()}),gc=Zn(function(c,_,I){return c+(I?" ":"")+Ka(_)}),yc=Zn(function(c,_,I){return c+(I?" ":"")+_.toUpperCase()}),Ka=Us("toUpperCase");function ji(c,_,I){return c=rr(c),(_=I?void 0:_)===void 0?function(V){return Jr.test(V)}(c)?function(V){return V.match(Gr)||[]}(c):function(V){return V.match(Zt)||[]}(c):c.match(_)||[]}var Ni=He(function(c,_){try{return Yt(c,void 0,_)}catch(I){return Ua(I)?I:new $e(I)}}),mc=xn(function(c,_){return Jt(_,function(I){I=dn(I),wn(c,I,Ba(c[I],c))}),c});function Va(c){return function(){return c}}var vc=Ms(),bc=Ms(!0);function Mr(c){return c}function Ga(c){return ms(typeof c=="function"?c:en(c,1))}var wc=He(function(c,_){return function(I){return lo(I,c,_)}}),Ec=He(function(c,_){return function(I){return lo(c,I,_)}});function Ya(c,_,I){var V=xr(_),ot=Fo(_,V);I!=null||dr(_)&&(ot.length||!V.length)||(I=_,_=c,c=this,ot=Fo(_,xr(_)));var _t=!(dr(I)&&"chain"in I&&!I.chain),Pt=An(c);return Jt(ot,function(Ot){var qt=_[Ot];c[Ot]=qt,Pt&&(c.prototype[Ot]=function(){var oe=this.__chain__;if(_t||oe){var ne=c(this.__wrapped__);return(ne.__actions__=Lr(this.__actions__)).push({func:qt,args:arguments,thisArg:c}),ne.__chain__=oe,ne}return qt.apply(c,g([this.value()],arguments))})}),c}function za(){}var xc=Aa(p),Sc=Aa(Pn),Ac=Aa(O);function Bi(c){return $a(c)?W(dn(c)):function(_){return function(I){return Mn(I,_)}}(c)}var Cc=Ks(),Ic=Ks(!0);function Wa(){return[]}function Xa(){return!1}var Ja,Pc=Do(function(c,_){return c+_},0),Fc=Ca("ceil"),Oc=Do(function(c,_){return c/_},1),kc=Ca("floor"),$c=Do(function(c,_){return c*_},1),Rc=Ca("round"),Tc=Do(function(c,_){return c-_},0);return lt.after=function(c,_){if(typeof _!="function")throw new wr(e);return c=Ne(c),function(){if(--c<1)return _.apply(this,arguments)}},lt.ary=yi,lt.assign=tc,lt.assignIn=Fi,lt.assignInWith=zo,lt.assignWith=ec,lt.at=rc,lt.before=mi,lt.bind=Ba,lt.bindAll=mc,lt.bindKey=vi,lt.castArray=function(){if(!arguments.length)return[];var c=arguments[0];return je(c)?c:[c]},lt.chain=hi,lt.chunk=function(c,_,I){_=(I?jr(c,_,I):_===void 0)?1:br(Ne(_),0);var V=c==null?0:c.length;if(!V||_<1)return[];for(var ot=0,_t=0,Pt=Qt(Eo(V/_));ot<V;)Pt[_t++]=rn(c,ot,ot+=_);return Pt},lt.compact=function(c){for(var _=-1,I=c==null?0:c.length,V=0,ot=[];++_<I;){var _t=c[_];_t&&(ot[V++]=_t)}return ot},lt.concat=function(){var c=arguments.length;if(!c)return[];for(var _=Qt(c-1),I=arguments[0],V=c;V--;)_[V-1]=arguments[V];return g(je(I)?Lr(I):[I],Cr(_,1))},lt.cond=function(c){var _=c==null?0:c.length,I=ke();return c=_?p(c,function(V){if(typeof V[1]!="function")throw new wr(e);return[I(V[0]),V[1]]}):[],He(function(V){for(var ot=-1;++ot<_;){var _t=c[ot];if(Yt(_t[0],this,V))return Yt(_t[1],this,V)}})},lt.conforms=function(c){return function(_){var I=xr(_);return function(V){return cs(V,_,I)}}(en(c,1))},lt.constant=Va,lt.countBy=ju,lt.create=function(c,_){var I=Xn(c);return _==null?I:us(I,_)},lt.curry=function c(_,I,V){var ot=En(_,8,void 0,void 0,void 0,void 0,void 0,I=V?void 0:I);return ot.placeholder=c.placeholder,ot},lt.curryRight=function c(_,I,V){var ot=En(_,16,void 0,void 0,void 0,void 0,void 0,I=V?void 0:I);return ot.placeholder=c.placeholder,ot},lt.debounce=bi,lt.defaults=nc,lt.defaultsDeep=oc,lt.defer=Ku,lt.delay=Vu,lt.difference=mu,lt.differenceBy=vu,lt.differenceWith=bu,lt.drop=function(c,_,I){var V=c==null?0:c.length;return V?rn(c,(_=I||_===void 0?1:Ne(_))<0?0:_,V):[]},lt.dropRight=function(c,_,I){var V=c==null?0:c.length;return V?rn(c,0,(_=V-(_=I||_===void 0?1:Ne(_)))<0?0:_):[]},lt.dropRightWhile=function(c,_){return c&&c.length?$o(c,ke(_,3),!0,!0):[]},lt.dropWhile=function(c,_){return c&&c.length?$o(c,ke(_,3),!0):[]},lt.fill=function(c,_,I,V){var ot=c==null?0:c.length;return ot?(I&&typeof I!="number"&&jr(c,_,I)&&(I=0,V=ot),function(_t,Pt,Ot,qt){var oe=_t.length;for((Ot=Ne(Ot))<0&&(Ot=-Ot>oe?0:oe+Ot),(qt=qt===void 0||qt>oe?oe:Ne(qt))<0&&(qt+=oe),qt=Ot>qt?0:Ii(qt);Ot<qt;)_t[Ot++]=Pt;return _t}(c,_,I,V)):[]},lt.filter=function(c,_){return(je(c)?Ee:ds)(c,ke(_,3))},lt.flatMap=function(c,_){return Cr(Mo(c,_),1)},lt.flatMapDeep=function(c,_){return Cr(Mo(c,_),1/0)},lt.flatMapDepth=function(c,_,I){return I=I===void 0?1:Ne(I),Cr(Mo(c,_),I)},lt.flatten=li,lt.flattenDeep=function(c){return c!=null&&c.length?Cr(c,1/0):[]},lt.flattenDepth=function(c,_){return c!=null&&c.length?Cr(c,_=_===void 0?1:Ne(_)):[]},lt.flip=function(c){return En(c,512)},lt.flow=vc,lt.flowRight=bc,lt.fromPairs=function(c){for(var _=-1,I=c==null?0:c.length,V={};++_<I;){var ot=c[_];V[ot[0]]=ot[1]}return V},lt.functions=function(c){return c==null?[]:Fo(c,xr(c))},lt.functionsIn=function(c){return c==null?[]:Fo(c,Hr(c))},lt.groupBy=Lu,lt.initial=function(c){return c!=null&&c.length?rn(c,0,-1):[]},lt.intersection=wu,lt.intersectionBy=Eu,lt.intersectionWith=xu,lt.invert=ac,lt.invertBy=sc,lt.invokeMap=Uu,lt.iteratee=Ga,lt.keyBy=Hu,lt.keys=xr,lt.keysIn=Hr,lt.map=Mo,lt.mapKeys=function(c,_){var I={};return _=ke(_,3),pn(c,function(V,ot,_t){wn(I,_(V,ot,_t),V)}),I},lt.mapValues=function(c,_){var I={};return _=ke(_,3),pn(c,function(V,ot,_t){wn(I,ot,_(V,ot,_t))}),I},lt.matches=function(c){return bs(en(c,1))},lt.matchesProperty=function(c,_){return ws(c,en(_,1))},lt.memoize=Ko,lt.merge=uc,lt.mergeWith=Oi,lt.method=wc,lt.methodOf=Ec,lt.mixin=Ya,lt.negate=Vo,lt.nthArg=function(c){return c=Ne(c),He(function(_){return Es(_,c)})},lt.omit=cc,lt.omitBy=function(c,_){return ki(c,Vo(ke(_)))},lt.once=function(c){return mi(2,c)},lt.orderBy=function(c,_,I,V){return c==null?[]:(je(_)||(_=_==null?[]:[_]),je(I=V?void 0:I)||(I=I==null?[]:[I]),xs(c,_,I))},lt.over=xc,lt.overArgs=Gu,lt.overEvery=Sc,lt.overSome=Ac,lt.partial=La,lt.partialRight=wi,lt.partition=Mu,lt.pick=lc,lt.pickBy=ki,lt.property=Bi,lt.propertyOf=function(c){return function(_){return c==null?void 0:Mn(c,_)}},lt.pull=Su,lt.pullAll=fi,lt.pullAllBy=function(c,_,I){return c&&c.length&&_&&_.length?ga(c,_,ke(I,2)):c},lt.pullAllWith=function(c,_,I){return c&&c.length&&_&&_.length?ga(c,_,void 0,I):c},lt.pullAt=Au,lt.range=Cc,lt.rangeRight=Ic,lt.rearg=Yu,lt.reject=function(c,_){return(je(c)?Ee:ds)(c,Vo(ke(_,3)))},lt.remove=function(c,_){var I=[];if(!c||!c.length)return I;var V=-1,ot=[],_t=c.length;for(_=ke(_,3);++V<_t;){var Pt=c[V];_(Pt,V,c)&&(I.push(Pt),ot.push(V))}return As(c,ot),I},lt.rest=function(c,_){if(typeof c!="function")throw new wr(e);return He(c,_=_===void 0?_:Ne(_))},lt.reverse=ja,lt.sampleSize=function(c,_,I){return _=(I?jr(c,_,I):_===void 0)?1:Ne(_),(je(c)?ru:cu)(c,_)},lt.set=function(c,_,I){return c==null?c:fo(c,_,I)},lt.setWith=function(c,_,I,V){return V=typeof V=="function"?V:void 0,c==null?c:fo(c,_,I,V)},lt.shuffle=function(c){return(je(c)?nu:pu)(c)},lt.slice=function(c,_,I){var V=c==null?0:c.length;return V?(I&&typeof I!="number"&&jr(c,_,I)?(_=0,I=V):(_=_==null?0:Ne(_),I=I===void 0?V:Ne(I)),rn(c,_,I)):[]},lt.sortBy=qu,lt.sortedUniq=function(c){return c&&c.length?Is(c):[]},lt.sortedUniqBy=function(c,_){return c&&c.length?Is(c,ke(_,2)):[]},lt.split=function(c,_,I){return I&&typeof I!="number"&&jr(c,_,I)&&(_=I=void 0),(I=I===void 0?4294967295:I>>>0)?(c=rr(c))&&(typeof _=="string"||_!=null&&!Ha(_))&&!(_=zr(_))&&Ht(c)?Rn(Ft(c),0,I):c.split(_,I):[]},lt.spread=function(c,_){if(typeof c!="function")throw new wr(e);return _=_==null?0:br(Ne(_),0),He(function(I){var V=I[_],ot=Rn(I,0,_);return V&&g(ot,V),Yt(c,this,ot)})},lt.tail=function(c){var _=c==null?0:c.length;return _?rn(c,1,_):[]},lt.take=function(c,_,I){return c&&c.length?rn(c,0,(_=I||_===void 0?1:Ne(_))<0?0:_):[]},lt.takeRight=function(c,_,I){var V=c==null?0:c.length;return V?rn(c,(_=V-(_=I||_===void 0?1:Ne(_)))<0?0:_,V):[]},lt.takeRightWhile=function(c,_){return c&&c.length?$o(c,ke(_,3),!1,!0):[]},lt.takeWhile=function(c,_){return c&&c.length?$o(c,ke(_,3)):[]},lt.tap=function(c,_){return _(c),c},lt.throttle=function(c,_,I){var V=!0,ot=!0;if(typeof c!="function")throw new wr(e);return dr(I)&&(V="leading"in I?!!I.leading:V,ot="trailing"in I?!!I.trailing:ot),bi(c,_,{leading:V,maxWait:_,trailing:ot})},lt.thru=Ho,lt.toArray=Ci,lt.toPairs=$i,lt.toPairsIn=Ri,lt.toPath=function(c){return je(c)?p(c,dn):Wr(c)?[c]:Lr(si(rr(c)))},lt.toPlainObject=Pi,lt.transform=function(c,_,I){var V=je(c),ot=V||Tn(c)||to(c);if(_=ke(_,4),I==null){var _t=c&&c.constructor;I=ot?V?new _t:[]:dr(c)&&An(_t)?Xn(vo(c)):{}}return(ot?Jt:pn)(c,function(Pt,Ot,qt){return _(I,Pt,Ot,qt)}),I},lt.unary=function(c){return yi(c,1)},lt.union=Cu,lt.unionBy=Iu,lt.unionWith=Pu,lt.uniq=function(c){return c&&c.length?kn(c):[]},lt.uniqBy=function(c,_){return c&&c.length?kn(c,ke(_,2)):[]},lt.uniqWith=function(c,_){return _=typeof _=="function"?_:void 0,c&&c.length?kn(c,void 0,_):[]},lt.unset=function(c,_){return c==null||ba(c,_)},lt.unzip=Na,lt.unzipWith=di,lt.update=function(c,_,I){return c==null?c:Fs(c,_,xa(I))},lt.updateWith=function(c,_,I,V){return V=typeof V=="function"?V:void 0,c==null?c:Fs(c,_,xa(I),V)},lt.values=eo,lt.valuesIn=function(c){return c==null?[]:tt(c,Hr(c))},lt.without=Fu,lt.words=ji,lt.wrap=function(c,_){return La(xa(_),c)},lt.xor=Ou,lt.xorBy=ku,lt.xorWith=$u,lt.zip=Ru,lt.zipObject=function(c,_){return ks(c||[],_||[],uo)},lt.zipObjectDeep=function(c,_){return ks(c||[],_||[],fo)},lt.zipWith=Tu,lt.entries=$i,lt.entriesIn=Ri,lt.extend=Fi,lt.extendWith=zo,Ya(lt,lt),lt.add=Pc,lt.attempt=Ni,lt.camelCase=pc,lt.capitalize=Ti,lt.ceil=Fc,lt.clamp=function(c,_,I){return I===void 0&&(I=_,_=void 0),I!==void 0&&(I=(I=on(I))==I?I:0),_!==void 0&&(_=(_=on(_))==_?_:0),Hn(on(c),_,I)},lt.clone=function(c){return en(c,4)},lt.cloneDeep=function(c){return en(c,5)},lt.cloneDeepWith=function(c,_){return en(c,5,_=typeof _=="function"?_:void 0)},lt.cloneWith=function(c,_){return en(c,4,_=typeof _=="function"?_:void 0)},lt.conformsTo=function(c,_){return _==null||cs(c,_,xr(_))},lt.deburr=Di,lt.defaultTo=function(c,_){return c==null||c!=c?_:c},lt.divide=Oc,lt.endsWith=function(c,_,I){c=rr(c),_=zr(_);var V=c.length,ot=I=I===void 0?V:Hn(Ne(I),0,V);return(I-=_.length)>=0&&c.slice(I,ot)==_},lt.eq=ln,lt.escape=function(c){return(c=rr(c))&&x.test(c)?c.replace(Et,$t):c},lt.escapeRegExp=function(c){return(c=rr(c))&&yt.test(c)?c.replace(J,"\\$&"):c},lt.every=function(c,_,I){var V=je(c)?Pn:au;return I&&jr(c,_,I)&&(_=void 0),V(c,ke(_,3))},lt.find=Nu,lt.findIndex=ui,lt.findKey=function(c,_){return P(c,ke(_,3),pn)},lt.findLast=Bu,lt.findLastIndex=ci,lt.findLastKey=function(c,_){return P(c,ke(_,3),la)},lt.floor=kc,lt.forEach=_i,lt.forEachRight=gi,lt.forIn=function(c,_){return c==null?c:ca(c,ke(_,3),Hr)},lt.forInRight=function(c,_){return c==null?c:hs(c,ke(_,3),Hr)},lt.forOwn=function(c,_){return c&&pn(c,ke(_,3))},lt.forOwnRight=function(c,_){return c&&la(c,ke(_,3))},lt.get=Ma,lt.gt=zu,lt.gte=Wu,lt.has=function(c,_){return c!=null&&Js(c,_,su)},lt.hasIn=qa,lt.head=pi,lt.identity=Mr,lt.includes=function(c,_,I,V){c=Ur(c)?c:eo(c),I=I&&!V?Ne(I):0;var ot=c.length;return I<0&&(I=br(ot+I,0)),Yo(c)?I<=ot&&c.indexOf(_,I)>-1:!!ot&&q(c,_,I)>-1},lt.indexOf=function(c,_,I){var V=c==null?0:c.length;if(!V)return-1;var ot=I==null?0:Ne(I);return ot<0&&(ot=br(V+ot,0)),q(c,_,ot)},lt.inRange=function(c,_,I){return _=Cn(_),I===void 0?(I=_,_=0):I=Cn(I),function(V,ot,_t){return V>=kr(ot,_t)&&V<br(ot,_t)}(c=on(c),_,I)},lt.invoke=ic,lt.isArguments=Vn,lt.isArray=je,lt.isArrayBuffer=Xu,lt.isArrayLike=Ur,lt.isArrayLikeObject=yr,lt.isBoolean=function(c){return c===!0||c===!1||_r(c)&&Dr(c)==d},lt.isBuffer=Tn,lt.isDate=Ju,lt.isElement=function(c){return _r(c)&&c.nodeType===1&&!yo(c)},lt.isEmpty=function(c){if(c==null)return!0;if(Ur(c)&&(je(c)||typeof c=="string"||typeof c.splice=="function"||Tn(c)||to(c)||Vn(c)))return!c.length;var _=$r(c);if(_==T||_==Z)return!c.size;if(_o(c))return!ha(c).length;for(var I in c)if(Ge.call(c,I))return!1;return!0},lt.isEqual=function(c,_){return po(c,_)},lt.isEqualWith=function(c,_,I){var V=(I=typeof I=="function"?I:void 0)?I(c,_):void 0;return V===void 0?po(c,_,void 0,I):!!V},lt.isError=Ua,lt.isFinite=function(c){return typeof c=="number"&&ns(c)},lt.isFunction=An,lt.isInteger=Ei,lt.isLength=Go,lt.isMap=xi,lt.isMatch=function(c,_){return c===_||da(c,_,Oa(_))},lt.isMatchWith=function(c,_,I){return I=typeof I=="function"?I:void 0,da(c,_,Oa(_),I)},lt.isNaN=function(c){return Si(c)&&c!=+c},lt.isNative=function(c){if(yu(c))throw new $e("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return ys(c)},lt.isNil=function(c){return c==null},lt.isNull=function(c){return c===null},lt.isNumber=Si,lt.isObject=dr,lt.isObjectLike=_r,lt.isPlainObject=yo,lt.isRegExp=Ha,lt.isSafeInteger=function(c){return Ei(c)&&c>=-9007199254740991&&c<=9007199254740991},lt.isSet=Ai,lt.isString=Yo,lt.isSymbol=Wr,lt.isTypedArray=to,lt.isUndefined=function(c){return c===void 0},lt.isWeakMap=function(c){return _r(c)&&$r(c)==ct},lt.isWeakSet=function(c){return _r(c)&&Dr(c)=="[object WeakSet]"},lt.join=function(c,_){return c==null?"":Gi.call(c,_)},lt.kebabCase=fc,lt.last=nn,lt.lastIndexOf=function(c,_,I){var V=c==null?0:c.length;if(!V)return-1;var ot=V;return I!==void 0&&(ot=(ot=Ne(I))<0?br(V+ot,0):kr(ot,V-1)),_==_?function(_t,Pt,Ot){for(var qt=Ot+1;qt--;)if(_t[qt]===Pt)return qt;return qt}(c,_,ot):B(c,k,ot,!0)},lt.lowerCase=dc,lt.lowerFirst=hc,lt.lt=Zu,lt.lte=Qu,lt.max=function(c){return c&&c.length?Po(c,Mr,pa):void 0},lt.maxBy=function(c,_){return c&&c.length?Po(c,ke(_,2),pa):void 0},lt.mean=function(c){return H(c,Mr)},lt.meanBy=function(c,_){return H(c,ke(_,2))},lt.min=function(c){return c&&c.length?Po(c,Mr,_a):void 0},lt.minBy=function(c,_){return c&&c.length?Po(c,ke(_,2),_a):void 0},lt.stubArray=Wa,lt.stubFalse=Xa,lt.stubObject=function(){return{}},lt.stubString=function(){return""},lt.stubTrue=function(){return!0},lt.multiply=$c,lt.nth=function(c,_){return c&&c.length?Es(c,Ne(_)):void 0},lt.noConflict=function(){return or._===this&&(or._=ta),this},lt.noop=za,lt.now=qo,lt.pad=function(c,_,I){c=rr(c);var V=(_=Ne(_))?Rt(c):0;if(!_||V>=_)return c;var ot=(_-V)/2;return jo(xo(ot),I)+c+jo(Eo(ot),I)},lt.padEnd=function(c,_,I){c=rr(c);var V=(_=Ne(_))?Rt(c):0;return _&&V<_?c+jo(_-V,I):c},lt.padStart=function(c,_,I){c=rr(c);var V=(_=Ne(_))?Rt(c):0;return _&&V<_?jo(_-V,I)+c:c},lt.parseInt=function(c,_,I){return I||_==null?_=0:_&&(_=+_),Wi(rr(c).replace(Dt,""),_||0)},lt.random=function(c,_,I){if(I&&typeof I!="boolean"&&jr(c,_,I)&&(_=I=void 0),I===void 0&&(typeof _=="boolean"?(I=_,_=void 0):typeof c=="boolean"&&(I=c,c=void 0)),c===void 0&&_===void 0?(c=0,_=1):(c=Cn(c),_===void 0?(_=c,c=0):_=Cn(_)),c>_){var V=c;c=_,_=V}if(I||c%1||_%1){var ot=os();return kr(c+ot*(_-c+he("1e-"+((ot+"").length-1))),_)}return ya(c,_)},lt.reduce=function(c,_,I){var V=je(c)?m:st,ot=arguments.length<3;return V(c,ke(_,4),I,ot,On)},lt.reduceRight=function(c,_,I){var V=je(c)?w:st,ot=arguments.length<3;return V(c,ke(_,4),I,ot,ps)},lt.repeat=function(c,_,I){return _=(I?jr(c,_,I):_===void 0)?1:Ne(_),ma(rr(c),_)},lt.replace=function(){var c=arguments,_=rr(c[0]);return c.length<3?_:_.replace(c[1],c[2])},lt.result=function(c,_,I){var V=-1,ot=(_=$n(_,c)).length;for(ot||(ot=1,c=void 0);++V<ot;){var _t=c?.[dn(_[V])];_t===void 0&&(V=ot,_t=I),c=An(_t)?_t.call(c):_t}return c},lt.round=Rc,lt.runInContext=St,lt.sample=function(c){return(je(c)?is:uu)(c)},lt.size=function(c){if(c==null)return 0;if(Ur(c))return Yo(c)?Rt(c):c.length;var _=$r(c);return _==T||_==Z?c.size:ha(c).length},lt.snakeCase=_c,lt.some=function(c,_,I){var V=je(c)?O:fu;return I&&jr(c,_,I)&&(_=void 0),V(c,ke(_,3))},lt.sortedIndex=function(c,_){return ko(c,_)},lt.sortedIndexBy=function(c,_,I){return va(c,_,ke(I,2))},lt.sortedIndexOf=function(c,_){var I=c==null?0:c.length;if(I){var V=ko(c,_);if(V<I&&ln(c[V],_))return V}return-1},lt.sortedLastIndex=function(c,_){return ko(c,_,!0)},lt.sortedLastIndexBy=function(c,_,I){return va(c,_,ke(I,2),!0)},lt.sortedLastIndexOf=function(c,_){if(c!=null&&c.length){var I=ko(c,_,!0)-1;if(ln(c[I],_))return I}return-1},lt.startCase=gc,lt.startsWith=function(c,_,I){return c=rr(c),I=I==null?0:Hn(Ne(I),0,c.length),_=zr(_),c.slice(I,I+_.length)==_},lt.subtract=Tc,lt.sum=function(c){return c&&c.length?bt(c,Mr):0},lt.sumBy=function(c,_){return c&&c.length?bt(c,ke(_,2)):0},lt.template=function(c,_,I){var V=lt.templateSettings;I&&jr(c,_,I)&&(_=void 0),c=rr(c),_=zo({},_,V,Ys);var ot,_t,Pt=zo({},_.imports,V.imports,Ys),Ot=xr(Pt),qt=tt(Pt,Ot),oe=0,ne=_.interpolate||Be,ue="__p += '",we=gn((_.escape||Be).source+"|"+ne.source+"|"+(ne===A?ge:Be).source+"|"+(_.evaluate||Be).source+"|$","g"),Ae="//# sourceURL="+(Ge.call(_,"sourceURL")?(_.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++se+"]")+`
`;c.replace(we,function(fe,Pe,ve,De,qe,Ze){return ve||(ve=De),ue+=c.slice(oe,Ze).replace(ce,Wt),Pe&&(ot=!0,ue+=`' +
__e(`+Pe+`) +
'`),qe&&(_t=!0,ue+=`';
`+qe+`;
__p += '`),ve&&(ue+=`' +
((__t = (`+ve+`)) == null ? '' : __t) +
'`),oe=Ze+fe.length,fe}),ue+=`';
`;var Fe=Ge.call(_,"variable")&&_.variable;if(Fe){if(Vt.test(Fe))throw new $e("Invalid `variable` option passed into `_.template`")}else ue=`with (obj) {
`+ue+`
}
`;ue=(_t?ue.replace($,""):ue).replace(E,"$1").replace(rt,"$1;"),ue="function("+(Fe||"obj")+`) {
`+(Fe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ot?", __e = _.escape":"")+(_t?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ue+`return __p
}`;var ae=Ni(function(){return pr(Ot,Ae+"return "+ue).apply(void 0,qt)});if(ae.source=ue,Ua(ae))throw ae;return ae},lt.times=function(c,_){if((c=Ne(c))<1||c>9007199254740991)return[];var I=4294967295,V=kr(c,4294967295);c-=4294967295;for(var ot=It(V,_=ke(_));++I<c;)_(I);return ot},lt.toFinite=Cn,lt.toInteger=Ne,lt.toLength=Ii,lt.toLower=function(c){return rr(c).toLowerCase()},lt.toNumber=on,lt.toSafeInteger=function(c){return c?Hn(Ne(c),-9007199254740991,9007199254740991):c===0?c:0},lt.toString=rr,lt.toUpper=function(c){return rr(c).toUpperCase()},lt.trim=function(c,_,I){if((c=rr(c))&&(I||_===void 0))return Mt(c);if(!c||!(_=zr(_)))return c;var V=Ft(c),ot=Ft(_);return Rn(V,pt(V,ot),it(V,ot)+1).join("")},lt.trimEnd=function(c,_,I){if((c=rr(c))&&(I||_===void 0))return c.slice(0,Nt(c)+1);if(!c||!(_=zr(_)))return c;var V=Ft(c);return Rn(V,0,it(V,Ft(_))+1).join("")},lt.trimStart=function(c,_,I){if((c=rr(c))&&(I||_===void 0))return c.replace(Dt,"");if(!c||!(_=zr(_)))return c;var V=Ft(c);return Rn(V,pt(V,Ft(_))).join("")},lt.truncate=function(c,_){var I=30,V="...";if(dr(_)){var ot="separator"in _?_.separator:ot;I="length"in _?Ne(_.length):I,V="omission"in _?zr(_.omission):V}var _t=(c=rr(c)).length;if(Ht(c)){var Pt=Ft(c);_t=Pt.length}if(I>=_t)return c;var Ot=I-Rt(V);if(Ot<1)return V;var qt=Pt?Rn(Pt,0,Ot).join(""):c.slice(0,Ot);if(ot===void 0)return qt+V;if(Pt&&(Ot+=qt.length-Ot),Ha(ot)){if(c.slice(Ot).search(ot)){var oe,ne=qt;for(ot.global||(ot=gn(ot.source,rr(jt.exec(ot))+"g")),ot.lastIndex=0;oe=ot.exec(ne);)var ue=oe.index;qt=qt.slice(0,ue===void 0?Ot:ue)}}else if(c.indexOf(zr(ot),Ot)!=Ot){var we=qt.lastIndexOf(ot);we>-1&&(qt=qt.slice(0,we))}return qt+V},lt.unescape=function(c){return(c=rr(c))&&Ct.test(c)?c.replace(gt,re):c},lt.uniqueId=function(c){var _=++Er;return rr(c)+_},lt.upperCase=yc,lt.upperFirst=Ka,lt.each=_i,lt.eachRight=gi,lt.first=pi,Ya(lt,(Ja={},pn(lt,function(c,_){Ge.call(lt.prototype,_)||(Ja[_]=c)}),Ja),{chain:!1}),lt.VERSION="4.17.21",Jt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(c){lt[c].placeholder=lt}),Jt(["drop","take"],function(c,_){Ye.prototype[c]=function(I){I=I===void 0?1:br(Ne(I),0);var V=this.__filtered__&&!_?new Ye(this):this.clone();return V.__filtered__?V.__takeCount__=kr(I,V.__takeCount__):V.__views__.push({size:kr(I,4294967295),type:c+(V.__dir__<0?"Right":"")}),V},Ye.prototype[c+"Right"]=function(I){return this.reverse()[c](I).reverse()}}),Jt(["filter","map","takeWhile"],function(c,_){var I=_+1,V=I==1||I==3;Ye.prototype[c]=function(ot){var _t=this.clone();return _t.__iteratees__.push({iteratee:ke(ot,3),type:I}),_t.__filtered__=_t.__filtered__||V,_t}}),Jt(["head","last"],function(c,_){var I="take"+(_?"Right":"");Ye.prototype[c]=function(){return this[I](1).value()[0]}}),Jt(["initial","tail"],function(c,_){var I="drop"+(_?"":"Right");Ye.prototype[c]=function(){return this.__filtered__?new Ye(this):this[I](1)}}),Ye.prototype.compact=function(){return this.filter(Mr)},Ye.prototype.find=function(c){return this.filter(c).head()},Ye.prototype.findLast=function(c){return this.reverse().find(c)},Ye.prototype.invokeMap=He(function(c,_){return typeof c=="function"?new Ye(this):this.map(function(I){return lo(I,c,_)})}),Ye.prototype.reject=function(c){return this.filter(Vo(ke(c)))},Ye.prototype.slice=function(c,_){c=Ne(c);var I=this;return I.__filtered__&&(c>0||_<0)?new Ye(I):(c<0?I=I.takeRight(-c):c&&(I=I.drop(c)),_!==void 0&&(I=(_=Ne(_))<0?I.dropRight(-_):I.take(_-c)),I)},Ye.prototype.takeRightWhile=function(c){return this.reverse().takeWhile(c).reverse()},Ye.prototype.toArray=function(){return this.take(4294967295)},pn(Ye.prototype,function(c,_){var I=/^(?:filter|find|map|reject)|While$/.test(_),V=/^(?:head|last)$/.test(_),ot=lt[V?"take"+(_=="last"?"Right":""):_],_t=V||/^find/.test(_);ot&&(lt.prototype[_]=function(){var Pt=this.__wrapped__,Ot=V?[1]:arguments,qt=Pt instanceof Ye,oe=Ot[0],ne=qt||je(Pt),ue=function(Pe){var ve=ot.apply(lt,g([Pe],Ot));return V&&we?ve[0]:ve};ne&&I&&typeof oe=="function"&&oe.length!=1&&(qt=ne=!1);var we=this.__chain__,Ae=!!this.__actions__.length,Fe=_t&&!we,ae=qt&&!Ae;if(!_t&&ne){Pt=ae?Pt:new Ye(this);var fe=c.apply(Pt,Ot);return fe.__actions__.push({func:Ho,args:[ue],thisArg:void 0}),new tn(fe,we)}return Fe&&ae?c.apply(this,Ot):(fe=this.thru(ue),Fe?V?fe.value()[0]:fe.value():fe)})}),Jt(["pop","push","shift","sort","splice","unshift"],function(c){var _=Fr[c],I=/^(?:push|sort|unshift)$/.test(c)?"tap":"thru",V=/^(?:pop|shift)$/.test(c);lt.prototype[c]=function(){var ot=arguments;if(V&&!this.__chain__){var _t=this.value();return _.apply(je(_t)?_t:[],ot)}return this[I](function(Pt){return _.apply(je(Pt)?Pt:[],ot)})}}),pn(Ye.prototype,function(c,_){var I=lt[_];if(I){var V=I.name+"";Ge.call(Wn,V)||(Wn[V]=[]),Wn[V].push({name:_,func:I})}}),Wn[To(void 0,2).name]=[{name:"wrapper",func:void 0}],Ye.prototype.clone=function(){var c=new Ye(this.__wrapped__);return c.__actions__=Lr(this.__actions__),c.__dir__=this.__dir__,c.__filtered__=this.__filtered__,c.__iteratees__=Lr(this.__iteratees__),c.__takeCount__=this.__takeCount__,c.__views__=Lr(this.__views__),c},Ye.prototype.reverse=function(){if(this.__filtered__){var c=new Ye(this);c.__dir__=-1,c.__filtered__=!0}else(c=this.clone()).__dir__*=-1;return c},Ye.prototype.value=function(){var c=this.__wrapped__.value(),_=this.__dir__,I=je(c),V=_<0,ot=I?c.length:0,_t=function(Ze,Ce,Oe){for(var mr=-1,vr=Oe.length;++mr<vr;){var Nr=Oe[mr],cr=Nr.size;switch(Nr.type){case"drop":Ze+=cr;break;case"dropRight":Ce-=cr;break;case"take":Ce=kr(Ce,Ze+cr);break;case"takeRight":Ze=br(Ze,Ce-cr)}}return{start:Ze,end:Ce}}(0,ot,this.__views__),Pt=_t.start,Ot=_t.end,qt=Ot-Pt,oe=V?Ot:Pt-1,ne=this.__iteratees__,ue=ne.length,we=0,Ae=kr(qt,this.__takeCount__);if(!I||!V&&ot==qt&&Ae==qt)return Os(c,this.__actions__);var Fe=[];t:for(;qt--&&we<Ae;){for(var ae=-1,fe=c[oe+=_];++ae<ue;){var Pe=ne[ae],ve=Pe.iteratee,De=Pe.type,qe=ve(fe);if(De==2)fe=qe;else if(!qe){if(De==1)continue t;break t}}Fe[we++]=fe}return Fe},lt.prototype.at=Du,lt.prototype.chain=function(){return hi(this)},lt.prototype.commit=function(){return new tn(this.value(),this.__chain__)},lt.prototype.next=function(){this.__values__===void 0&&(this.__values__=Ci(this.value()));var c=this.__index__>=this.__values__.length;return{done:c,value:c?void 0:this.__values__[this.__index__++]}},lt.prototype.plant=function(c){for(var _,I=this;I instanceof Co;){var V=ii(I);V.__index__=0,V.__values__=void 0,_?ot.__wrapped__=V:_=V;var ot=V;I=I.__wrapped__}return ot.__wrapped__=c,_},lt.prototype.reverse=function(){var c=this.__wrapped__;if(c instanceof Ye){var _=c;return this.__actions__.length&&(_=new Ye(this)),(_=_.reverse()).__actions__.push({func:Ho,args:[ja],thisArg:void 0}),new tn(_,this.__chain__)}return this.thru(ja)},lt.prototype.toJSON=lt.prototype.valueOf=lt.prototype.value=function(){return Os(this.__wrapped__,this.__actions__)},lt.prototype.first=lt.prototype.head,no&&(lt.prototype[no]=function(){return this}),lt}();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(or._=te,define(function(){return te})):xe?((xe.exports=te)._=te,X._=te):or._=te}).call(this)}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{}),_$lodash_53=_$lodash_53.exports;var _$env_136={};Object.defineProperty(_$env_136,"__esModule",{value:!0}),_$env_136.default=void 0;var _ENV=(0,_$openApi_151.ENV)(),__isNode_136=_ENV.isNode,__isQX_136=_ENV.isQX,__isLoon_136=_ENV.isLoon,__isSurge_136=_ENV.isSurge,__isStash_136=_ENV.isStash,__isShadowRocket_136=_ENV.isShadowRocket,__isLanceX_136=_ENV.isLanceX,__isEgern_136=_ENV.isEgern,__isGUIforCores_136=_ENV.isGUIforCores,backend="Node";__isNode_136&&(backend="Node"),__isQX_136&&(backend="QX"),__isLoon_136&&(backend="Loon"),__isSurge_136&&(backend="Surge"),__isStash_136&&(backend="Stash"),__isShadowRocket_136&&(backend="ShadowRocket"),__isEgern_136&&(backend="Egern"),__isLanceX_136&&(backend="LanceX"),__isGUIforCores_136&&(backend="GUI.for.Cores");var meta={},feature={};try{if(typeof $environment<"u"&&(meta.env=$environment),typeof $loon<"u"&&(meta.loon=$loon),typeof $script<"u"&&(meta.script=$script),typeof $Plugin<"u"&&(meta.plugin=$Plugin),__isNode_136){meta.node={version:eval("process.version"),argv:eval("process.argv"),filename:eval("__filename"),dirname:eval("__dirname"),env:{}};var env=eval("process.env");for(var key in env)/^SUB_STORE_/.test(key)&&(meta.node.env[key]=env[key])}}catch(t){}var ___default_136={backend,version:_$package_85.version,feature,meta};_$env_136.default=___default_136;var _$utils_109={};Object.defineProperty(_$utils_109,"__esModule",{value:!0}),_$utils_109.Result=void 0,_$utils_109.isPresent=__isPresent_109;var __obj_109,___lodash_109=(__obj_109=_$lodash_53)&&__obj_109.__esModule?__obj_109:{default:__obj_109};function ___defineProperties_109(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Result=function(){function t(r){(function(o,f){if(!(o instanceof f))throw new TypeError("Cannot call a class as a function")})(this,t),this.proxy=r,this.output=[]}var e,n;return e=t,(n=[{key:"append",value:function(r){if(r===void 0)throw new Error("required field is missing");this.output.push(r)}},{key:"appendIfPresent",value:function(r,o){__isPresent_109(this.proxy,o)&&this.append(r)}},{key:"toString",value:function(){return this.output.join("")}}])&&___defineProperties_109(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function __isPresent_109(t,e){return ___lodash_109.default.get(t,e)!=null}_$utils_109.Result=Result;var _$surge_106={};Object.defineProperty(_$surge_106,"__esModule",{value:!0}),_$surge_106.default=function(){return{produce:function(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};switch(t.name=t.name.replace(/=|,/g,""),t.ports&&(t.ports=String(t.ports)),t.type){case"ss":return function(r,o){var f,d=new _$utils_109.Result(r);if(d.append("".concat(r.name,"=").concat(r.type,",").concat(r.server,",").concat(r.port)),r.cipher||(r.cipher="none"),!["aes-128-gcm","aes-192-gcm","aes-256-gcm","chacha20-ietf-poly1305","xchacha20-ietf-poly1305","rc4","rc4-md5","aes-128-cfb","aes-192-cfb","aes-256-cfb","aes-128-ctr","aes-192-ctr","aes-256-ctr","bf-cfb","camellia-128-cfb","camellia-192-cfb","camellia-256-cfb","cast5-cfb","des-cfb","idea-cfb","rc2-cfb","seed-cfb","salsa20","chacha20","chacha20-ietf","none"].concat((f=o?["2022-blake3-aes-128-gcm","2022-blake3-aes-256-gcm"]:[],function(T){if(Array.isArray(T))return ___arrayLikeToArray_106(T)}(f)||function(T){if(typeof Symbol<"u"&&T[Symbol.iterator]!=null||T["@@iterator"]!=null)return Array.from(T)}(f)||function(T,U){if(T){if(typeof T=="string")return ___arrayLikeToArray_106(T,void 0);var M=Object.prototype.toString.call(T).slice(8,-1);return M==="Object"&&T.constructor&&(M=T.constructor.name),M==="Map"||M==="Set"?Array.from(T):M==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(M)?___arrayLikeToArray_106(T,void 0):void 0}}(f)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}())).includes(r.cipher))throw new Error("cipher ".concat(r.cipher," is not supported"));d.append(",encrypt-method=".concat(r.cipher)),d.appendIfPresent(',password="'.concat(r.password,'"'),"password");var h=ipVersions[r["ip-version"]]||r["ip-version"];if(d.appendIfPresent(",ip-version=".concat(h),"ip-version"),d.appendIfPresent(",no-error-alert=".concat(r["no-error-alert"]),"no-error-alert"),(0,_$utils_109.isPresent)(r,"plugin")){if(r.plugin==="obfs")d.append(",obfs=".concat(r["plugin-opts"].mode)),d.appendIfPresent(",obfs-host=".concat(r["plugin-opts"].host),"plugin-opts.host"),d.appendIfPresent(",obfs-uri=".concat(r["plugin-opts"].path),"plugin-opts.path");else if(!["shadow-tls"].includes(r.plugin))throw new Error("plugin ".concat(r.plugin," is not supported"))}if(d.appendIfPresent(",tfo=".concat(r.tfo),"tfo"),d.appendIfPresent(",udp-relay=".concat(r.udp),"udp"),d.appendIfPresent(",test-url=".concat(r["test-url"]),"test-url"),d.appendIfPresent(",test-timeout=".concat(r["test-timeout"]),"test-timeout"),d.appendIfPresent(",test-udp=".concat(r["test-udp"]),"test-udp"),d.appendIfPresent(",hybrid=".concat(r.hybrid),"hybrid"),d.appendIfPresent(",tos=".concat(r.tos),"tos"),d.appendIfPresent(",allow-other-interface=".concat(r["allow-other-interface"]),"allow-other-interface"),d.appendIfPresent(",interface=".concat(r["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(r,"shadow-tls-password"))d.append(",shadow-tls-password=".concat(r["shadow-tls-password"])),d.appendIfPresent(",shadow-tls-version=".concat(r["shadow-tls-version"]),"shadow-tls-version"),d.appendIfPresent(",shadow-tls-sni=".concat(r["shadow-tls-sni"]),"shadow-tls-sni"),d.appendIfPresent(",udp-port=".concat(r["udp-port"]),"udp-port");else if(["shadow-tls"].includes(r.plugin)&&r["plugin-opts"]){var y=r["plugin-opts"].password,F=r["plugin-opts"].host,S=r["plugin-opts"].version;if(y){if(d.append(",shadow-tls-password=".concat(y)),F&&d.append(",shadow-tls-sni=".concat(F)),S){if(S<2)throw new Error("shadow-tls version ".concat(S," is not supported"));d.append(",shadow-tls-version=".concat(S))}d.appendIfPresent(",udp-port=".concat(r["udp-port"]),"udp-port")}}return d.appendIfPresent(",block-quic=".concat(r["block-quic"]),"block-quic"),d.appendIfPresent(",underlying-proxy=".concat(r["underlying-proxy"]),"underlying-proxy"),d.toString()}(t,n["include-unsupported-proxy"]);case"trojan":return function(r){var o=new _$utils_109.Result(r);o.append("".concat(r.name,"=").concat(r.type,",").concat(r.server,",").concat(r.port)),o.appendIfPresent(',password="'.concat(r.password,'"'),"password");var f=ipVersions[r["ip-version"]]||r["ip-version"];return o.appendIfPresent(",ip-version=".concat(f),"ip-version"),o.appendIfPresent(",no-error-alert=".concat(r["no-error-alert"]),"no-error-alert"),handleTransport(o,r),o.appendIfPresent(",tls=".concat(r.tls),"tls"),o.appendIfPresent(",server-cert-fingerprint-sha256=".concat(r["tls-fingerprint"]),"tls-fingerprint"),o.appendIfPresent(",sni=".concat(r.sni),"sni"),o.appendIfPresent(",skip-cert-verify=".concat(r["skip-cert-verify"]),"skip-cert-verify"),o.appendIfPresent(",tfo=".concat(r.tfo),"tfo"),o.appendIfPresent(",udp-relay=".concat(r.udp),"udp"),o.appendIfPresent(",test-url=".concat(r["test-url"]),"test-url"),o.appendIfPresent(",test-timeout=".concat(r["test-timeout"]),"test-timeout"),o.appendIfPresent(",test-udp=".concat(r["test-udp"]),"test-udp"),o.appendIfPresent(",hybrid=".concat(r.hybrid),"hybrid"),o.appendIfPresent(",tos=".concat(r.tos),"tos"),o.appendIfPresent(",allow-other-interface=".concat(r["allow-other-interface"]),"allow-other-interface"),o.appendIfPresent(",interface=".concat(r["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(r,"shadow-tls-password")&&(o.append(",shadow-tls-password=".concat(r["shadow-tls-password"])),o.appendIfPresent(",shadow-tls-version=".concat(r["shadow-tls-version"]),"shadow-tls-version"),o.appendIfPresent(",shadow-tls-sni=".concat(r["shadow-tls-sni"]),"shadow-tls-sni")),o.appendIfPresent(",block-quic=".concat(r["block-quic"]),"block-quic"),o.appendIfPresent(",underlying-proxy=".concat(r["underlying-proxy"]),"underlying-proxy"),o.toString()}(t);case"vmess":return function(r,o){var f=new _$utils_109.Result(r);f.append("".concat(r.name,"=").concat(r.type,",").concat(r.server,",").concat(r.port)),f.appendIfPresent(",username=".concat(r.uuid),"uuid");var d=ipVersions[r["ip-version"]]||r["ip-version"];return f.appendIfPresent(",ip-version=".concat(d),"ip-version"),f.appendIfPresent(",no-error-alert=".concat(r["no-error-alert"]),"no-error-alert"),handleTransport(f,r,o),(0,_$utils_109.isPresent)(r,"aead")?f.append(",vmess-aead=".concat(r.aead)):f.append(",vmess-aead=".concat(r.alterId===0)),f.appendIfPresent(",server-cert-fingerprint-sha256=".concat(r["tls-fingerprint"]),"tls-fingerprint"),f.appendIfPresent(",tls=".concat(r.tls),"tls"),f.appendIfPresent(",sni=".concat(r.sni),"sni"),f.appendIfPresent(",skip-cert-verify=".concat(r["skip-cert-verify"]),"skip-cert-verify"),f.appendIfPresent(",tfo=".concat(r.tfo),"tfo"),f.appendIfPresent(",udp-relay=".concat(r.udp),"udp"),f.appendIfPresent(",test-url=".concat(r["test-url"]),"test-url"),f.appendIfPresent(",test-timeout=".concat(r["test-timeout"]),"test-timeout"),f.appendIfPresent(",test-udp=".concat(r["test-udp"]),"test-udp"),f.appendIfPresent(",hybrid=".concat(r.hybrid),"hybrid"),f.appendIfPresent(",tos=".concat(r.tos),"tos"),f.appendIfPresent(",allow-other-interface=".concat(r["allow-other-interface"]),"allow-other-interface"),f.appendIfPresent(",interface=".concat(r["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(r,"shadow-tls-password")&&(f.append(",shadow-tls-password=".concat(r["shadow-tls-password"])),f.appendIfPresent(",shadow-tls-version=".concat(r["shadow-tls-version"]),"shadow-tls-version"),f.appendIfPresent(",shadow-tls-sni=".concat(r["shadow-tls-sni"]),"shadow-tls-sni")),f.appendIfPresent(",block-quic=".concat(r["block-quic"]),"block-quic"),f.appendIfPresent(",underlying-proxy=".concat(r["underlying-proxy"]),"underlying-proxy"),f.toString()}(t,n["include-unsupported-proxy"]);case"http":return function(r){var o=new _$utils_109.Result(r),f=r.tls?"https":"http";o.append("".concat(r.name,"=").concat(f,",").concat(r.server,",").concat(r.port)),o.appendIfPresent(",".concat(r.username),"username"),o.appendIfPresent(',"'.concat(r.password,'"'),"password");var d=ipVersions[r["ip-version"]]||r["ip-version"];return o.appendIfPresent(",ip-version=".concat(d),"ip-version"),o.appendIfPresent(",no-error-alert=".concat(r["no-error-alert"]),"no-error-alert"),o.appendIfPresent(",server-cert-fingerprint-sha256=".concat(r["tls-fingerprint"]),"tls-fingerprint"),o.appendIfPresent(",sni=".concat(r.sni),"sni"),o.appendIfPresent(",skip-cert-verify=".concat(r["skip-cert-verify"]),"skip-cert-verify"),o.appendIfPresent(",tfo=".concat(r.tfo),"tfo"),o.appendIfPresent(",udp-relay=".concat(r.udp),"udp"),o.appendIfPresent(",test-url=".concat(r["test-url"]),"test-url"),o.appendIfPresent(",test-timeout=".concat(r["test-timeout"]),"test-timeout"),o.appendIfPresent(",test-udp=".concat(r["test-udp"]),"test-udp"),o.appendIfPresent(",hybrid=".concat(r.hybrid),"hybrid"),o.appendIfPresent(",tos=".concat(r.tos),"tos"),o.appendIfPresent(",allow-other-interface=".concat(r["allow-other-interface"]),"allow-other-interface"),o.appendIfPresent(",interface=".concat(r["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(r,"shadow-tls-password")&&(o.append(",shadow-tls-password=".concat(r["shadow-tls-password"])),o.appendIfPresent(",shadow-tls-version=".concat(r["shadow-tls-version"]),"shadow-tls-version"),o.appendIfPresent(",shadow-tls-sni=".concat(r["shadow-tls-sni"]),"shadow-tls-sni")),o.appendIfPresent(",block-quic=".concat(r["block-quic"]),"block-quic"),o.appendIfPresent(",underlying-proxy=".concat(r["underlying-proxy"]),"underlying-proxy"),o.toString()}(t);case"direct":return function(r){var o=new _$utils_109.Result(r);o.append("".concat(r.name,"=").concat("direct"));var f=ipVersions[r["ip-version"]]||r["ip-version"];return o.appendIfPresent(",ip-version=".concat(f),"ip-version"),o.appendIfPresent(",no-error-alert=".concat(r["no-error-alert"]),"no-error-alert"),o.appendIfPresent(",tfo=".concat(r.tfo),"tfo"),o.appendIfPresent(",udp-relay=".concat(r.udp),"udp"),o.appendIfPresent(",test-url=".concat(r["test-url"]),"test-url"),o.appendIfPresent(",test-timeout=".concat(r["test-timeout"]),"test-timeout"),o.appendIfPresent(",test-udp=".concat(r["test-udp"]),"test-udp"),o.appendIfPresent(",hybrid=".concat(r.hybrid),"hybrid"),o.appendIfPresent(",tos=".concat(r.tos),"tos"),o.appendIfPresent(",allow-other-interface=".concat(r["allow-other-interface"]),"allow-other-interface"),o.appendIfPresent(",interface=".concat(r["interface-name"]),"interface-name"),o.appendIfPresent(",block-quic=".concat(r["block-quic"]),"block-quic"),o.appendIfPresent(",underlying-proxy=".concat(r["underlying-proxy"]),"underlying-proxy"),o.toString()}(t);case"socks5":return function(r){var o=new _$utils_109.Result(r),f=r.tls?"socks5-tls":"socks5";o.append("".concat(r.name,"=").concat(f,",").concat(r.server,",").concat(r.port)),o.appendIfPresent(",".concat(r.username),"username"),o.appendIfPresent(',"'.concat(r.password,'"'),"password");var d=ipVersions[r["ip-version"]]||r["ip-version"];return o.appendIfPresent(",ip-version=".concat(d),"ip-version"),o.appendIfPresent(",no-error-alert=".concat(r["no-error-alert"]),"no-error-alert"),o.appendIfPresent(",server-cert-fingerprint-sha256=".concat(r["tls-fingerprint"]),"tls-fingerprint"),o.appendIfPresent(",sni=".concat(r.sni),"sni"),o.appendIfPresent(",skip-cert-verify=".concat(r["skip-cert-verify"]),"skip-cert-verify"),r.tfo&&___app_106.default.info("Option tfo is not supported by Surge, thus omitted"),o.appendIfPresent(",udp-relay=".concat(r.udp),"udp"),o.appendIfPresent(",test-url=".concat(r["test-url"]),"test-url"),o.appendIfPresent(",test-timeout=".concat(r["test-timeout"]),"test-timeout"),o.appendIfPresent(",test-udp=".concat(r["test-udp"]),"test-udp"),o.appendIfPresent(",hybrid=".concat(r.hybrid),"hybrid"),o.appendIfPresent(",tos=".concat(r.tos),"tos"),o.appendIfPresent(",allow-other-interface=".concat(r["allow-other-interface"]),"allow-other-interface"),o.appendIfPresent(",interface=".concat(r["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(r,"shadow-tls-password")&&(o.append(",shadow-tls-password=".concat(r["shadow-tls-password"])),o.appendIfPresent(",shadow-tls-version=".concat(r["shadow-tls-version"]),"shadow-tls-version"),o.appendIfPresent(",shadow-tls-sni=".concat(r["shadow-tls-sni"]),"shadow-tls-sni")),o.appendIfPresent(",block-quic=".concat(r["block-quic"]),"block-quic"),o.appendIfPresent(",underlying-proxy=".concat(r["underlying-proxy"]),"underlying-proxy"),o.toString()}(t);case"snell":return function(r){var o,f,d,h=new _$utils_109.Result(r);h.append("".concat(r.name,"=").concat(r.type,",").concat(r.server,",").concat(r.port)),h.appendIfPresent(",version=".concat(r.version),"version"),h.appendIfPresent(",psk=".concat(r.psk),"psk");var y=ipVersions[r["ip-version"]]||r["ip-version"];return h.appendIfPresent(",ip-version=".concat(y),"ip-version"),h.appendIfPresent(",no-error-alert=".concat(r["no-error-alert"]),"no-error-alert"),h.appendIfPresent(",obfs=".concat((o=r["obfs-opts"])===null||o===void 0?void 0:o.mode),"obfs-opts.mode"),h.appendIfPresent(",obfs-host=".concat((f=r["obfs-opts"])===null||f===void 0?void 0:f.host),"obfs-opts.host"),h.appendIfPresent(",obfs-uri=".concat((d=r["obfs-opts"])===null||d===void 0?void 0:d.path),"obfs-opts.path"),h.appendIfPresent(",tfo=".concat(r.tfo),"tfo"),h.appendIfPresent(",udp-relay=".concat(r.udp),"udp"),h.appendIfPresent(",test-url=".concat(r["test-url"]),"test-url"),h.appendIfPresent(",test-timeout=".concat(r["test-timeout"]),"test-timeout"),h.appendIfPresent(",test-udp=".concat(r["test-udp"]),"test-udp"),h.appendIfPresent(",hybrid=".concat(r.hybrid),"hybrid"),h.appendIfPresent(",tos=".concat(r.tos),"tos"),h.appendIfPresent(",allow-other-interface=".concat(r["allow-other-interface"]),"allow-other-interface"),h.appendIfPresent(",interface=".concat(r["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(r,"shadow-tls-password")&&(h.append(",shadow-tls-password=".concat(r["shadow-tls-password"])),h.appendIfPresent(",shadow-tls-version=".concat(r["shadow-tls-version"]),"shadow-tls-version"),h.appendIfPresent(",shadow-tls-sni=".concat(r["shadow-tls-sni"]),"shadow-tls-sni")),h.appendIfPresent(",block-quic=".concat(r["block-quic"]),"block-quic"),h.appendIfPresent(",underlying-proxy=".concat(r["underlying-proxy"]),"underlying-proxy"),h.appendIfPresent(",reuse=".concat(r.reuse),"reuse"),h.toString()}(t);case"tuic":return function(r){var o=new _$utils_109.Result(r),f=r.type;r.token&&r.token.length!==0||(f="tuic-v5"),o.append("".concat(r.name,"=").concat(f,",").concat(r.server,",").concat(r.port)),o.appendIfPresent(",uuid=".concat(r.uuid),"uuid"),o.appendIfPresent(',password="'.concat(r.password,'"'),"password"),o.appendIfPresent(",token=".concat(r.token),"token"),o.appendIfPresent(",alpn=".concat(Array.isArray(r.alpn)?r.alpn[0]:r.alpn),"alpn"),(0,_$utils_109.isPresent)(r,"ports")&&o.append(',port-hopping="'.concat(r.ports.replace(/,/g,";"),'"')),o.appendIfPresent(",port-hopping-interval=".concat(r["hop-interval"]),"hop-interval");var d=ipVersions[r["ip-version"]]||r["ip-version"];return o.appendIfPresent(",ip-version=".concat(d),"ip-version"),o.appendIfPresent(",no-error-alert=".concat(r["no-error-alert"]),"no-error-alert"),o.appendIfPresent(",sni=".concat(r.sni),"sni"),o.appendIfPresent(",skip-cert-verify=".concat(r["skip-cert-verify"]),"skip-cert-verify"),o.appendIfPresent(",server-cert-fingerprint-sha256=".concat(r["tls-fingerprint"]),"tls-fingerprint"),(0,_$utils_109.isPresent)(r,"tfo")?o.append(",tfo=".concat(r.tfo)):(0,_$utils_109.isPresent)(r,"fast-open")&&o.append(",tfo=".concat(r["fast-open"])),o.appendIfPresent(",test-url=".concat(r["test-url"]),"test-url"),o.appendIfPresent(",test-timeout=".concat(r["test-timeout"]),"test-timeout"),o.appendIfPresent(",test-udp=".concat(r["test-udp"]),"test-udp"),o.appendIfPresent(",hybrid=".concat(r.hybrid),"hybrid"),o.appendIfPresent(",tos=".concat(r.tos),"tos"),o.appendIfPresent(",allow-other-interface=".concat(r["allow-other-interface"]),"allow-other-interface"),o.appendIfPresent(",interface=".concat(r["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(r,"shadow-tls-password")&&(o.append(",shadow-tls-password=".concat(r["shadow-tls-password"])),o.appendIfPresent(",shadow-tls-version=".concat(r["shadow-tls-version"]),"shadow-tls-version"),o.appendIfPresent(",shadow-tls-sni=".concat(r["shadow-tls-sni"]),"shadow-tls-sni")),o.appendIfPresent(",block-quic=".concat(r["block-quic"]),"block-quic"),o.appendIfPresent(",underlying-proxy=".concat(r["underlying-proxy"]),"underlying-proxy"),o.appendIfPresent(",ecn=".concat(r.ecn),"ecn"),o.toString()}(t);case"wireguard-surge":return function(r){var o=new _$utils_109.Result(r);o.append("".concat(r.name,"=wireguard")),o.appendIfPresent(",section-name=".concat(r["section-name"]),"section-name"),o.appendIfPresent(",no-error-alert=".concat(r["no-error-alert"]),"no-error-alert");var f=ipVersions[r["ip-version"]]||r["ip-version"];return o.appendIfPresent(",ip-version=".concat(f),"ip-version"),o.appendIfPresent(",test-url=".concat(r["test-url"]),"test-url"),o.appendIfPresent(",test-timeout=".concat(r["test-timeout"]),"test-timeout"),o.appendIfPresent(",test-udp=".concat(r["test-udp"]),"test-udp"),o.appendIfPresent(",hybrid=".concat(r.hybrid),"hybrid"),o.appendIfPresent(",tos=".concat(r.tos),"tos"),o.appendIfPresent(",allow-other-interface=".concat(r["allow-other-interface"]),"allow-other-interface"),o.appendIfPresent(",interface=".concat(r["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(r,"shadow-tls-password")&&(o.append(",shadow-tls-password=".concat(r["shadow-tls-password"])),o.appendIfPresent(",shadow-tls-version=".concat(r["shadow-tls-version"]),"shadow-tls-version"),o.appendIfPresent(",shadow-tls-sni=".concat(r["shadow-tls-sni"]),"shadow-tls-sni")),o.appendIfPresent(",block-quic=".concat(r["block-quic"]),"block-quic"),o.appendIfPresent(",underlying-proxy=".concat(r["underlying-proxy"]),"underlying-proxy"),o.toString()}(t);case"hysteria2":return function(r){var o;if(r.obfs||r["obfs-password"])throw new Error("obfs is unsupported");var f=new _$utils_109.Result(r);f.append("".concat(r.name,"=hysteria2,").concat(r.server,",").concat(r.port)),f.appendIfPresent(',password="'.concat(r.password,'"'),"password"),(0,_$utils_109.isPresent)(r,"ports")&&f.append(',port-hopping="'.concat(r.ports.replace(/,/g,";"),'"')),f.appendIfPresent(",port-hopping-interval=".concat(r["hop-interval"]),"hop-interval");var d=ipVersions[r["ip-version"]]||r["ip-version"];return f.appendIfPresent(",ip-version=".concat(d),"ip-version"),f.appendIfPresent(",no-error-alert=".concat(r["no-error-alert"]),"no-error-alert"),f.appendIfPresent(",sni=".concat(r.sni),"sni"),f.appendIfPresent(",skip-cert-verify=".concat(r["skip-cert-verify"]),"skip-cert-verify"),f.appendIfPresent(",server-cert-fingerprint-sha256=".concat(r["tls-fingerprint"]),"tls-fingerprint"),(0,_$utils_109.isPresent)(r,"tfo")?f.append(",tfo=".concat(r.tfo)):(0,_$utils_109.isPresent)(r,"fast-open")&&f.append(",tfo=".concat(r["fast-open"])),f.appendIfPresent(",test-url=".concat(r["test-url"]),"test-url"),f.appendIfPresent(",test-timeout=".concat(r["test-timeout"]),"test-timeout"),f.appendIfPresent(",test-udp=".concat(r["test-udp"]),"test-udp"),f.appendIfPresent(",hybrid=".concat(r.hybrid),"hybrid"),f.appendIfPresent(",tos=".concat(r.tos),"tos"),f.appendIfPresent(",allow-other-interface=".concat(r["allow-other-interface"]),"allow-other-interface"),f.appendIfPresent(",interface=".concat(r["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(r,"shadow-tls-password")&&(f.append(",shadow-tls-password=".concat(r["shadow-tls-password"])),f.appendIfPresent(",shadow-tls-version=".concat(r["shadow-tls-version"]),"shadow-tls-version"),f.appendIfPresent(",shadow-tls-sni=".concat(r["shadow-tls-sni"]),"shadow-tls-sni")),f.appendIfPresent(",block-quic=".concat(r["block-quic"]),"block-quic"),f.appendIfPresent(",underlying-proxy=".concat(r["underlying-proxy"]),"underlying-proxy"),f.appendIfPresent(",download-bandwidth=".concat(((o="".concat(r.down).match(/\d+/))===null||o===void 0?void 0:o[0])||0),"down"),f.appendIfPresent(",ecn=".concat(r.ecn),"ecn"),f.toString()}(t);case"ssh":return function(r){var o=new _$utils_109.Result(r);o.append("".concat(r.name,"=ssh,").concat(r.server,",").concat(r.port)),o.appendIfPresent(",".concat(r.username),"username"),o.appendIfPresent(',"'.concat(r.password,'"'),"password"),o.appendIfPresent(",private-key=".concat(r["keystore-private-key"]),"keystore-private-key"),o.appendIfPresent(",idle-timeout=".concat(r["idle-timeout"]),"idle-timeout"),o.appendIfPresent(',server-fingerprint="'.concat(r["server-fingerprint"],'"'),"server-fingerprint");var f=ipVersions[r["ip-version"]]||r["ip-version"];return o.appendIfPresent(",ip-version=".concat(f),"ip-version"),o.appendIfPresent(",no-error-alert=".concat(r["no-error-alert"]),"no-error-alert"),o.appendIfPresent(",tfo=".concat(r.tfo),"tfo"),o.appendIfPresent(",udp-relay=".concat(r.udp),"udp"),o.appendIfPresent(",test-url=".concat(r["test-url"]),"test-url"),o.appendIfPresent(",test-timeout=".concat(r["test-timeout"]),"test-timeout"),o.appendIfPresent(",test-udp=".concat(r["test-udp"]),"test-udp"),o.appendIfPresent(",hybrid=".concat(r.hybrid),"hybrid"),o.appendIfPresent(",tos=".concat(r.tos),"tos"),o.appendIfPresent(",allow-other-interface=".concat(r["allow-other-interface"]),"allow-other-interface"),o.appendIfPresent(",interface=".concat(r["interface-name"]),"interface-name"),o.appendIfPresent(",block-quic=".concat(r["block-quic"]),"block-quic"),o.appendIfPresent(",underlying-proxy=".concat(r["underlying-proxy"]),"underlying-proxy"),o.toString()}(t)}if(n["include-unsupported-proxy"]&&t.type==="wireguard")return function(r){var o;Array.isArray(r.peers)&&r.peers.length>0&&(r.server=r.peers[0].server,r.port=r.peers[0].port,r.ip=r.peers[0].ip,r.ipv6=r.peers[0].ipv6,r["public-key"]=r.peers[0]["public-key"],r["preshared-key"]=r.peers[0]["pre-shared-key"],r["allowed-ips"]=r.peers[0]["allowed-ips"],r.reserved=r.peers[0].reserved);var f=new _$utils_109.Result(r);f.append("# > WireGuard Proxy ".concat(r.name,`
# `).concat(r.name,"=wireguard")),r["section-name"]=(0,_$utils_141.getIfNotBlank)(r["section-name"],r.name),f.appendIfPresent(",section-name=".concat(r["section-name"]),"section-name"),f.appendIfPresent(",no-error-alert=".concat(r["no-error-alert"]),"no-error-alert");var d=ipVersions[r["ip-version"]]||r["ip-version"];f.appendIfPresent(",ip-version=".concat(d),"ip-version"),f.appendIfPresent(",test-url=".concat(r["test-url"]),"test-url"),f.appendIfPresent(",test-timeout=".concat(r["test-timeout"]),"test-timeout"),f.appendIfPresent(",test-udp=".concat(r["test-udp"]),"test-udp"),f.appendIfPresent(",hybrid=".concat(r.hybrid),"hybrid"),f.appendIfPresent(",tos=".concat(r.tos),"tos"),f.appendIfPresent(",allow-other-interface=".concat(r["allow-other-interface"]),"allow-other-interface"),f.appendIfPresent(",interface=".concat(r["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(r,"shadow-tls-password")&&(f.append(",shadow-tls-password=".concat(r["shadow-tls-password"])),f.appendIfPresent(",shadow-tls-version=".concat(r["shadow-tls-version"]),"shadow-tls-version"),f.appendIfPresent(",shadow-tls-sni=".concat(r["shadow-tls-sni"]),"shadow-tls-sni")),f.appendIfPresent(",block-quic=".concat(r["block-quic"]),"block-quic"),f.appendIfPresent(",underlying-proxy=".concat(r["underlying-proxy"]),"underlying-proxy"),f.append(`
# > WireGuard Section `.concat(r.name,`
[WireGuard `).concat(r["section-name"],`]
private-key = `).concat(r["private-key"])),f.appendIfPresent(`
self-ip = `.concat(r.ip),"ip"),f.appendIfPresent(`
self-ip-v6 = `.concat(r.ipv6),"ipv6"),r.dns&&(Array.isArray(r.dns)&&(r.dns=r.dns.join(", ")),f.append(`
dns-server = `.concat(r.dns))),f.appendIfPresent(`
mtu = `.concat(r.mtu),"mtu"),d==="prefer-v6"&&f.append(`
prefer-ipv6 = true`);var h=Array.isArray(r["allowed-ips"])?r["allowed-ips"].join(","):r["allowed-ips"],y=Array.isArray(r.reserved)?r.reserved.join("/"):r.reserved,F=(o=r["preshared-key"])!==null&&o!==void 0?o:r["pre-shared-key"];F&&(F=',preshared-key="'.concat(F,'"'));var S={"public-key":r["public-key"],"allowed-ips":h?'"'.concat(h,'"'):void 0,endpoint:"".concat(r.server,":").concat(r.port),keepalive:r["persistent-keepalive"]||r.keepalive,"client-id":y,"preshared-key":F};return f.append(`
peer = (`.concat(Object.keys(S).filter(function(T){return S[T]!=null}).map(function(T){return"".concat(T," = ").concat(S[T])}).join(", "),")")),f.toString()}(t);throw new Error("Platform ".concat(targetPlatform," does not support proxy type: ").concat(t.type))}}};var __obj_106,___app_106=(__obj_106=_$app_87)&&__obj_106.__esModule?__obj_106:{default:__obj_106};function ___arrayLikeToArray_106(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var targetPlatform="Surge",ipVersions={dual:"dual",ipv4:"v4-only",ipv6:"v6-only","ipv4-prefer":"prefer-v4","ipv6-prefer":"prefer-v6"};function handleTransport(t,e,n){if((0,_$utils_109.isPresent)(e,"network"))if(e.network==="ws"){if(t.append(",ws=true"),(0,_$utils_109.isPresent)(e,"ws-opts")&&(t.appendIfPresent(",ws-path=".concat(e["ws-opts"].path),"ws-opts.path"),(0,_$utils_109.isPresent)(e,"ws-opts.headers"))){var r=e["ws-opts"].headers,o=Object.keys(r).map(function(f){var d=r[f];return["Host"].includes(f)&&(d='"'.concat(d,'"')),"".concat(f,":").concat(d)}).join("|");(0,_$utils_141.isNotBlank)(o)&&t.append(",ws-headers=".concat(o))}}else{if(!n||!["http"].includes(e.network))throw new Error("network ".concat(e.network," is unsupported"));___app_106.default.info("Include Unsupported Proxy: nework ".concat(e.network," -> tcp"))}}var _$clashmeta_97={};Object.defineProperty(_$clashmeta_97,"__esModule",{value:!0}),_$clashmeta_97.default=function(){return{type:"ALL",produce:function(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=t.filter(function(o){return!!n["include-unsupported-proxy"]||(o.type!=="snell"||String(o.version)!=="4")&&!["juicity"].includes(o.type)}).map(function(o){var f;if(o.type==="vmess")(0,_$utils_109.isPresent)(o,"aead")&&(o.aead&&(o.alterId=0),delete o.aead),(0,_$utils_109.isPresent)(o,"sni")&&(o.servername=o.sni,delete o.sni),(0,_$utils_109.isPresent)(o,"cipher")&&!["auto","aes-128-gcm","chacha20-poly1305","none"].includes(o.cipher)&&(o.cipher="auto");else if(o.type==="tuic")(0,_$utils_109.isPresent)(o,"alpn")?o.alpn=Array.isArray(o.alpn)?o.alpn:[o.alpn]:o.alpn=["h3"],(0,_$utils_109.isPresent)(o,"tfo")&&!(0,_$utils_109.isPresent)(o,"fast-open")&&(o["fast-open"]=o.tfo),o.token&&o.token.length!==0||(0,_$utils_109.isPresent)(o,"version")||(o.version=5);else if(o.type==="hysteria")(0,_$utils_109.isPresent)(o,"auth_str")&&!(0,_$utils_109.isPresent)(o,"auth-str")&&(o["auth-str"]=o.auth_str),(0,_$utils_109.isPresent)(o,"alpn")&&(o.alpn=Array.isArray(o.alpn)?o.alpn:[o.alpn]),(0,_$utils_109.isPresent)(o,"tfo")&&!(0,_$utils_109.isPresent)(o,"fast-open")&&(o["fast-open"]=o.tfo);else if(o.type==="wireguard"){var d,h;o.keepalive=(d=o.keepalive)!==null&&d!==void 0?d:o["persistent-keepalive"],o["persistent-keepalive"]=o.keepalive,o["preshared-key"]=(h=o["preshared-key"])!==null&&h!==void 0?h:o["pre-shared-key"],o["pre-shared-key"]=o["preshared-key"]}else o.type==="vless"?(0,_$utils_109.isPresent)(o,"sni")&&(o.servername=o.sni,delete o.sni):o.type==="ss"&&(0,_$utils_109.isPresent)(o,"shadow-tls-password")&&!(0,_$utils_109.isPresent)(o,"plugin")&&(o.plugin="shadow-tls",o["plugin-opts"]={host:o["shadow-tls-sni"],password:o["shadow-tls-password"],version:o["shadow-tls-version"]});if(["vmess","vless"].includes(o.type)&&o.network==="http"){var y,F,S,T=(y=o["http-opts"])===null||y===void 0?void 0:y.path;(0,_$utils_109.isPresent)(o,"http-opts.path")&&!Array.isArray(T)&&(o["http-opts"].path=[T]);var U=(F=o["http-opts"])===null||F===void 0||(S=F.headers)===null||S===void 0?void 0:S.Host;(0,_$utils_109.isPresent)(o,"http-opts.headers.Host")&&!Array.isArray(U)&&(o["http-opts"].headers.Host=[U])}if(["vmess","vless"].includes(o.type)&&o.network==="h2"){var M,Y,Z,D=(M=o["h2-opts"])===null||M===void 0?void 0:M.path;(0,_$utils_109.isPresent)(o,"h2-opts.path")&&Array.isArray(D)&&(o["h2-opts"].path=D[0]);var nt=(Y=o["h2-opts"])===null||Y===void 0||(Z=Y.headers)===null||Z===void 0?void 0:Z.host;(0,_$utils_109.isPresent)(o,"h2-opts.headers.Host")&&!Array.isArray(nt)&&(o["h2-opts"].headers.host=[nt])}if((f=o["plugin-opts"])!==null&&f!==void 0&&f.tls&&(0,_$utils_109.isPresent)(o,"skip-cert-verify")&&(o["plugin-opts"]["skip-cert-verify"]=o["skip-cert-verify"]),["trojan","tuic","hysteria","hysteria2","juicity"].includes(o.type)&&delete o.tls,o["tls-fingerprint"]&&(o.fingerprint=o["tls-fingerprint"]),delete o["tls-fingerprint"],o["underlying-proxy"]&&(o["dialer-proxy"]=o["underlying-proxy"]),delete o["underlying-proxy"],(0,_$utils_109.isPresent)(o,"tls")&&typeof o.tls!="boolean"&&delete o.tls,delete o.subName,delete o.collectionName,delete o.id,delete o.resolved,delete o["no-resolve"],e!=="internal"||n["delete-underscore-fields"])for(var ct in o)(o[ct]==null||/^_/i.test(ct))&&delete o[ct];return["grpc"].includes(o.network)&&o["".concat(o.network,"-opts")]&&(delete o["".concat(o.network,"-opts")]["_grpc-type"],delete o["".concat(o.network,"-opts")]["_grpc-authority"]),o});return e==="internal"?r:`proxies:
`+r.map(function(o){return"  - "+JSON.stringify(o)+`
`}).join("")}}};var _$surgemac_107={};Object.defineProperty(_$surgemac_107,"__esModule",{value:!0}),_$surgemac_107.default=function(){return{produce:function(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};switch(t.type){case"external":return external(t);default:try{return surge_Producer.produce(t,e,n)}catch{if(n.useMihomoExternal)return ___app_107.default.log("".concat(t.name," is not supported on ").concat(__targetPlatform_107,", try to use Mihomo(SurgeMac - External Proxy Program) instead")),function(o,f,d){var h,y=(h=(0,_clashmeta.default)().produce([o],"internal"))===null||h===void 0?void 0:h[0];if(y){var F=d?.localPort||o._localPort||65535,S=!["ipv4","v4-only"].includes(o["ip-version"]),T={name:o.name,type:"external",exec:o._exec||"/usr/local/bin/mihomo","local-port":F,args:["-config",_$base64_20.Base64.encode(JSON.stringify({"mixed-port":F,ipv6:S,mode:"global",dns:{enable:!0,ipv6:S,nameserver:["https://223.6.6.6/dns-query","https://120.53.53.53/dns-query"]},proxies:[___objectSpread_107(___objectSpread_107({},y),{},{name:"proxy"})],"proxy-groups":[{name:"GLOBAL",type:"select",proxies:["proxy"]}]}))],addresses:[]};return __isIP_107(o.server)?T.addresses.push(o.server):___app_107.default.log("Platform ".concat(__targetPlatform_107,", proxy type ").concat(o.type,": addresses should be an IP address, but got ").concat(o.server)),d.localPort=F-1,external(T)}}(t,0,n);throw new Error("Surge for macOS \u53EF\u624B\u52A8\u6307\u5B9A\u94FE\u63A5\u53C2\u6570 target=SurgeMac \u6216\u5728 \u540C\u6B65\u914D\u7F6E \u4E2D\u6307\u5B9A SurgeMac \u6765\u542F\u7528 mihomo \u652F\u63F4 Surge \u672C\u8EAB\u4E0D\u652F\u6301\u7684\u534F\u8BAE")}}}}};var _surge=___interopRequireDefault_107(_$surge_106),_clashmeta=___interopRequireDefault_107(_$clashmeta_97),___app_107=___interopRequireDefault_107(_$app_87);function ___interopRequireDefault_107(t){return t&&t.__esModule?t:{default:t}}function __ownKeys_107(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function ___objectSpread_107(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_107(Object(n),!0).forEach(function(r){___defineProperty_107(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):__ownKeys_107(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ___defineProperty_107(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var __targetPlatform_107="SurgeMac",surge_Producer=(0,_surge.default)();function external(t){var e=new _$utils_109.Result(t);if(!t.exec||!t["local-port"])throw new Error("".concat(t.type,": exec and local-port are required"));return e.append("".concat(t.name,'=external,exec="').concat(t.exec,'",local-port=').concat(t["local-port"])),Array.isArray(t.args)&&t.args.map(function(n){e.append(',args="'.concat(n,'"'))}),Array.isArray(t.addresses)&&t.addresses.map(function(n){e.append(",addresses=".concat(n))}),e.appendIfPresent(",no-error-alert=".concat(t["no-error-alert"]),"no-error-alert"),(0,_$utils_109.isPresent)(t,"tfo")?e.append(",tfo=".concat(t.tfo)):(0,_$utils_109.isPresent)(t,"fast-open")&&e.append(",tfo=".concat(t["fast-open"])),e.appendIfPresent(",test-url=".concat(t["test-url"]),"test-url"),e.appendIfPresent(",block-quic=".concat(t["block-quic"]),"block-quic"),e.toString()}function __isIP_107(t){return(0,_$utils_141.isIPv4)(t)||(0,_$utils_141.isIPv6)(t)}var _$clash_96={};Object.defineProperty(_$clash_96,"__esModule",{value:!0}),_$clash_96.default=function(){return{type:"ALL",produce:function(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=t.filter(function(o){return!!n["include-unsupported-proxy"]||!(!["ss","ssr","vmess","vless","socks5","http","snell","trojan","wireguard"].includes(o.type)||o.type==="ss"&&!["aes-128-gcm","aes-192-gcm","aes-256-gcm","aes-128-cfb","aes-192-cfb","aes-256-cfb","aes-128-ctr","aes-192-ctr","aes-256-ctr","rc4-md5","chacha20-ietf","xchacha20","chacha20-ietf-poly1305","xchacha20-ietf-poly1305"].includes(o.cipher)||o.type==="snell"&&String(o.version)==="4"||o.type==="vless"&&(o.flow!==void 0||o["reality-opts"]))}).map(function(o){var f;if(o.type==="vmess")(0,_$utils_109.isPresent)(o,"aead")&&(o.aead&&(o.alterId=0),delete o.aead),(0,_$utils_109.isPresent)(o,"sni")&&(o.servername=o.sni,delete o.sni),(0,_$utils_109.isPresent)(o,"cipher")&&!["auto","aes-128-gcm","chacha20-poly1305","none"].includes(o.cipher)&&(o.cipher="auto");else if(o.type==="wireguard"){var d,h;o.keepalive=(d=o.keepalive)!==null&&d!==void 0?d:o["persistent-keepalive"],o["persistent-keepalive"]=o.keepalive,o["preshared-key"]=(h=o["preshared-key"])!==null&&h!==void 0?h:o["pre-shared-key"],o["pre-shared-key"]=o["preshared-key"]}else o.type==="vless"&&(0,_$utils_109.isPresent)(o,"sni")&&(o.servername=o.sni,delete o.sni);if(["vmess","vless"].includes(o.type)&&o.network==="http"){var y,F,S,T=(y=o["http-opts"])===null||y===void 0?void 0:y.path;(0,_$utils_109.isPresent)(o,"http-opts.path")&&!Array.isArray(T)&&(o["http-opts"].path=[T]);var U=(F=o["http-opts"])===null||F===void 0||(S=F.headers)===null||S===void 0?void 0:S.Host;(0,_$utils_109.isPresent)(o,"http-opts.headers.Host")&&!Array.isArray(U)&&(o["http-opts"].headers.Host=[U])}if(["vmess","vless"].includes(o.type)&&o.network==="h2"){var M,Y,Z,D=(M=o["h2-opts"])===null||M===void 0?void 0:M.path;(0,_$utils_109.isPresent)(o,"h2-opts.path")&&Array.isArray(D)&&(o["h2-opts"].path=D[0]);var nt=(Y=o["h2-opts"])===null||Y===void 0||(Z=Y.headers)===null||Z===void 0?void 0:Z.host;(0,_$utils_109.isPresent)(o,"h2-opts.headers.Host")&&!Array.isArray(nt)&&(o["h2-opts"].headers.host=[nt])}if((f=o["plugin-opts"])!==null&&f!==void 0&&f.tls&&(0,_$utils_109.isPresent)(o,"skip-cert-verify")&&(o["plugin-opts"]["skip-cert-verify"]=o["skip-cert-verify"]),["trojan","tuic","hysteria","hysteria2","juicity"].includes(o.type)&&delete o.tls,o["tls-fingerprint"]&&(o.fingerprint=o["tls-fingerprint"]),delete o["tls-fingerprint"],o["underlying-proxy"]&&(o["dialer-proxy"]=o["underlying-proxy"]),delete o["underlying-proxy"],(0,_$utils_109.isPresent)(o,"tls")&&typeof o.tls!="boolean"&&delete o.tls,delete o.subName,delete o.collectionName,delete o.id,delete o.resolved,delete o["no-resolve"],e!=="internal")for(var ct in o)(o[ct]==null||/^_/i.test(ct))&&delete o[ct];return["grpc"].includes(o.network)&&o["".concat(o.network,"-opts")]&&(delete o["".concat(o.network,"-opts")]["_grpc-type"],delete o["".concat(o.network,"-opts")]["_grpc-authority"]),o});return e==="internal"?r:`proxies:
`+r.map(function(o){return"  - "+JSON.stringify(o)+`
`}).join("")}}};var _$stash_104={};function ___arrayLikeToArray_104(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}Object.defineProperty(_$stash_104,"__esModule",{value:!0}),_$stash_104.default=function(){return{type:"ALL",produce:function(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=t.filter(function(o){return!(!["ss","ssr","vmess","socks5","http","snell","trojan","tuic","vless","wireguard","hysteria","hysteria2","ssh","juicity"].includes(o.type)||o.type==="ss"&&!["aes-128-gcm","aes-192-gcm","aes-256-gcm","aes-128-cfb","aes-192-cfb","aes-256-cfb","aes-128-ctr","aes-192-ctr","aes-256-ctr","rc4-md5","chacha20-ietf","xchacha20","chacha20-ietf-poly1305","xchacha20-ietf-poly1305"].concat((f=n["include-unsupported-proxy"]?["2022-blake3-aes-128-gcm","2022-blake3-aes-256-gcm"]:[],function(d){if(Array.isArray(d))return ___arrayLikeToArray_104(d)}(f)||function(d){if(typeof Symbol<"u"&&d[Symbol.iterator]!=null||d["@@iterator"]!=null)return Array.from(d)}(f)||function(d,h){if(d){if(typeof d=="string")return ___arrayLikeToArray_104(d,void 0);var y=Object.prototype.toString.call(d).slice(8,-1);return y==="Object"&&d.constructor&&(y=d.constructor.name),y==="Map"||y==="Set"?Array.from(d):y==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(y)?___arrayLikeToArray_104(d,void 0):void 0}}(f)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}())).includes(o.cipher)||o.type==="snell"&&String(o.version)==="4"||o.type==="vless"&&o["reality-opts"]);var f}).map(function(o){var f;if(o.type==="vmess")(0,_$utils_109.isPresent)(o,"aead")&&(o.aead&&(o.alterId=0),delete o.aead),(0,_$utils_109.isPresent)(o,"sni")&&(o.servername=o.sni,delete o.sni),(0,_$utils_109.isPresent)(o,"cipher")&&!["auto","aes-128-gcm","chacha20-poly1305","none"].includes(o.cipher)&&(o.cipher="auto");else if(o.type==="tuic")(0,_$utils_109.isPresent)(o,"alpn")?o.alpn=Array.isArray(o.alpn)?o.alpn:[o.alpn]:o.alpn=["h3"],(0,_$utils_109.isPresent)(o,"tfo")&&!(0,_$utils_109.isPresent)(o,"fast-open")&&(o["fast-open"]=o.tfo,delete o.tfo),o.token&&o.token.length!==0||(0,_$utils_109.isPresent)(o,"version")||(o.version=5);else if(o.type==="hysteria"){var d,h;(0,_$utils_109.isPresent)(o,"auth_str")&&!(0,_$utils_109.isPresent)(o,"auth-str")&&(o["auth-str"]=o.auth_str),(0,_$utils_109.isPresent)(o,"alpn")&&(o.alpn=Array.isArray(o.alpn)?o.alpn:[o.alpn]),(0,_$utils_109.isPresent)(o,"tfo")&&!(0,_$utils_109.isPresent)(o,"fast-open")&&(o["fast-open"]=o.tfo,delete o.tfo),(0,_$utils_109.isPresent)(o,"down")&&!(0,_$utils_109.isPresent)(o,"down-speed")&&(o["down-speed"]=o.down,delete o.down),(0,_$utils_109.isPresent)(o,"up")&&!(0,_$utils_109.isPresent)(o,"up-speed")&&(o["up-speed"]=o.up,delete o.up),(0,_$utils_109.isPresent)(o,"down-speed")&&(o["down-speed"]=((d="".concat(o["down-speed"]).match(/\d+/))===null||d===void 0?void 0:d[0])||0),(0,_$utils_109.isPresent)(o,"up-speed")&&(o["up-speed"]=((h="".concat(o["up-speed"]).match(/\d+/))===null||h===void 0?void 0:h[0])||0)}else if(o.type==="hysteria2"){var y,F;(0,_$utils_109.isPresent)(o,"password")&&!(0,_$utils_109.isPresent)(o,"auth")&&(o.auth=o.password,delete o.password),(0,_$utils_109.isPresent)(o,"tfo")&&!(0,_$utils_109.isPresent)(o,"fast-open")&&(o["fast-open"]=o.tfo,delete o.tfo),(0,_$utils_109.isPresent)(o,"down")&&!(0,_$utils_109.isPresent)(o,"down-speed")&&(o["down-speed"]=o.down,delete o.down),(0,_$utils_109.isPresent)(o,"up")&&!(0,_$utils_109.isPresent)(o,"up-speed")&&(o["up-speed"]=o.up,delete o.up),(0,_$utils_109.isPresent)(o,"down-speed")&&(o["down-speed"]=((y="".concat(o["down-speed"]).match(/\d+/))===null||y===void 0?void 0:y[0])||0),(0,_$utils_109.isPresent)(o,"up-speed")&&(o["up-speed"]=((F="".concat(o["up-speed"]).match(/\d+/))===null||F===void 0?void 0:F[0])||0)}else if(o.type==="wireguard"){var S,T;o.keepalive=(S=o.keepalive)!==null&&S!==void 0?S:o["persistent-keepalive"],o["persistent-keepalive"]=o.keepalive,o["preshared-key"]=(T=o["preshared-key"])!==null&&T!==void 0?T:o["pre-shared-key"],o["pre-shared-key"]=o["preshared-key"]}else o.type==="vless"&&(0,_$utils_109.isPresent)(o,"sni")&&(o.servername=o.sni,delete o.sni);if(["vmess","vless"].includes(o.type)&&o.network==="http"){var U,M,Y,Z=(U=o["http-opts"])===null||U===void 0?void 0:U.path;(0,_$utils_109.isPresent)(o,"http-opts.path")&&!Array.isArray(Z)&&(o["http-opts"].path=[Z]);var D=(M=o["http-opts"])===null||M===void 0||(Y=M.headers)===null||Y===void 0?void 0:Y.Host;(0,_$utils_109.isPresent)(o,"http-opts.headers.Host")&&!Array.isArray(D)&&(o["http-opts"].headers.Host=[D])}if(["vmess","vless"].includes(o.type)&&o.network==="h2"){var nt,ct,at,et=(nt=o["h2-opts"])===null||nt===void 0?void 0:nt.path;(0,_$utils_109.isPresent)(o,"h2-opts.path")&&Array.isArray(et)&&(o["h2-opts"].path=et[0]);var mt=(ct=o["h2-opts"])===null||ct===void 0||(at=ct.headers)===null||at===void 0?void 0:at.host;(0,_$utils_109.isPresent)(o,"h2-opts.headers.Host")&&!Array.isArray(mt)&&(o["h2-opts"].headers.host=[mt])}if((f=o["plugin-opts"])!==null&&f!==void 0&&f.tls&&(0,_$utils_109.isPresent)(o,"skip-cert-verify")&&(o["plugin-opts"]["skip-cert-verify"]=o["skip-cert-verify"]),["trojan","tuic","hysteria","hysteria2","juicity"].includes(o.type)&&delete o.tls,o["tls-fingerprint"]&&(o["server-cert-fingerprint"]=o["tls-fingerprint"]),delete o["tls-fingerprint"],o["underlying-proxy"]&&(o["dialer-proxy"]=o["underlying-proxy"]),delete o["underlying-proxy"],(0,_$utils_109.isPresent)(o,"tls")&&typeof o.tls!="boolean"&&delete o.tls,o["test-url"]&&(o["benchmark-url"]=o["test-url"],delete o["test-url"]),o["test-timeout"]&&(o["benchmark-timeout"]=o["test-timeout"],delete o["test-timeout"]),delete o.subName,delete o.collectionName,delete o.id,delete o.resolved,delete o["no-resolve"],e!=="internal")for(var At in o)(o[At]==null||/^_/i.test(At))&&delete o[At];return["grpc"].includes(o.network)&&o["".concat(o.network,"-opts")]&&(delete o["".concat(o.network,"-opts")]["_grpc-type"],delete o["".concat(o.network,"-opts")]["_grpc-authority"]),o});return e==="internal"?r:`proxies:
`+r.map(function(o){return"  - "+JSON.stringify(o)+`
`}).join("")}}};var _$loon_100={};Object.defineProperty(_$loon_100,"__esModule",{value:!0}),_$loon_100.default=function(){return{produce:function(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};switch(t.type){case"ss":return function(r,o){var f,d=new _$utils_109.Result(r);if(!["rc4","rc4-md5","aes-128-cfb","aes-192-cfb","aes-256-cfb","aes-128-ctr","aes-192-ctr","aes-256-ctr","bf-cfb","camellia-128-cfb","camellia-192-cfb","camellia-256-cfb","salsa20","chacha20","chacha20-ietf","aes-128-gcm","aes-192-gcm","aes-256-gcm","chacha20-ietf-poly1305","xchacha20-ietf-poly1305","2022-blake3-aes-128-gcm","2022-blake3-aes-256-gcm"].includes(r.cipher))throw new Error("cipher ".concat(r.cipher," is not supported"));if(d.append("".concat(r.name,"=shadowsocks,").concat(r.server,",").concat(r.port,",").concat(r.cipher,',"').concat(r.password,'"')),(0,_$utils_109.isPresent)(r,"plugin")){if(r.plugin==="obfs")d.append(",obfs-name=".concat(r["plugin-opts"].mode)),d.appendIfPresent(",obfs-host=".concat(r["plugin-opts"].host),"plugin-opts.host"),d.appendIfPresent(",obfs-uri=".concat(r["plugin-opts"].path),"plugin-opts.path");else if(!["shadow-tls"].includes(r.plugin))throw new Error("plugin ".concat(r.plugin," is not supported"))}if((0,_$utils_109.isPresent)(r,"shadow-tls-password"))d.append(",shadow-tls-password=".concat(r["shadow-tls-password"])),d.appendIfPresent(",shadow-tls-version=".concat(r["shadow-tls-version"]),"shadow-tls-version"),d.appendIfPresent(",shadow-tls-sni=".concat(r["shadow-tls-sni"]),"shadow-tls-sni"),d.appendIfPresent(",udp-port=".concat(r["udp-port"]),"udp-port"),f=!0;else if(["shadow-tls"].includes(r.plugin)&&r["plugin-opts"]){var h=r["plugin-opts"].password,y=r["plugin-opts"].host,F=r["plugin-opts"].version;if(h){if(d.append(",shadow-tls-password=".concat(h)),y&&d.append(",shadow-tls-sni=".concat(y)),F){if(F<2)throw new Error("shadow-tls version ".concat(F," is not supported"));d.append(",shadow-tls-version=".concat(F))}d.appendIfPresent(",udp-port=".concat(r["udp-port"]),"udp-port"),f=!0}}if(d.appendIfPresent(",fast-open=".concat(r.tfo),"tfo"),r.udp&&d.append(",udp=true"),!o&&f)throw new Error("shadow-tls is not supported(\u8BF7\u4F7F\u7528 includeUnsupportedProxy \u53C2\u6570)");return d.toString()}(t,n["include-unsupported-proxy"]);case"ssr":return function(r,o){var f,d=new _$utils_109.Result(r);if(d.append("".concat(r.name,"=shadowsocksr,").concat(r.server,",").concat(r.port,",").concat(r.cipher,',"').concat(r.password,'"')),d.append(",protocol=".concat(r.protocol)),d.appendIfPresent(",protocol-param=".concat(r["protocol-param"]),"protocol-param"),d.appendIfPresent(",obfs=".concat(r.obfs),"obfs"),d.appendIfPresent(",obfs-param=".concat(r["obfs-param"]),"obfs-param"),(0,_$utils_109.isPresent)(r,"shadow-tls-password"))d.append(",shadow-tls-password=".concat(r["shadow-tls-password"])),d.appendIfPresent(",shadow-tls-version=".concat(r["shadow-tls-version"]),"shadow-tls-version"),d.appendIfPresent(",shadow-tls-sni=".concat(r["shadow-tls-sni"]),"shadow-tls-sni"),d.appendIfPresent(",udp-port=".concat(r["udp-port"]),"udp-port"),f=!0;else if(["shadow-tls"].includes(r.plugin)&&r["plugin-opts"]){var h=r["plugin-opts"].password,y=r["plugin-opts"].host,F=r["plugin-opts"].version;if(h){if(d.append(",shadow-tls-password=".concat(h)),y&&d.append(",shadow-tls-sni=".concat(y)),F){if(F<2)throw new Error("shadow-tls version ".concat(F," is not supported"));d.append(",shadow-tls-version=".concat(F))}d.appendIfPresent(",udp-port=".concat(r["udp-port"]),"udp-port"),f=!0}}if(d.appendIfPresent(",fast-open=".concat(r.tfo),"tfo"),r.udp&&d.append(",udp=true"),!o&&f)throw new Error("shadow-tls is not supported(\u8BF7\u4F7F\u7528 includeUnsupportedProxy \u53C2\u6570)");return d.toString()}(t,n["include-unsupported-proxy"]);case"trojan":return function(r){var o=new _$utils_109.Result(r);if(o.append("".concat(r.name,"=trojan,").concat(r.server,",").concat(r.port,',"').concat(r.password,'"')),r.network==="tcp"&&delete r.network,(0,_$utils_109.isPresent)(r,"network")){if(r.network!=="ws")throw new Error("network ".concat(r.network," is unsupported"));var f,d,h;o.append(",transport=ws"),o.appendIfPresent(",path=".concat((f=r["ws-opts"])===null||f===void 0?void 0:f.path),"ws-opts.path"),o.appendIfPresent(",host=".concat((d=r["ws-opts"])===null||d===void 0||(h=d.headers)===null||h===void 0?void 0:h.Host),"ws-opts.headers.Host")}return o.appendIfPresent(",skip-cert-verify=".concat(r["skip-cert-verify"]),"skip-cert-verify"),o.appendIfPresent(",tls-name=".concat(r.sni),"sni"),o.appendIfPresent(",tls-cert-sha256=".concat(r["tls-fingerprint"]),"tls-fingerprint"),o.appendIfPresent(",tls-pubkey-sha256=".concat(r["tls-pubkey-sha256"]),"tls-pubkey-sha256"),o.appendIfPresent(",fast-open=".concat(r.tfo),"tfo"),r.udp&&o.append(",udp=true"),o.toString()}(t);case"vmess":return function(r){var o=new _$utils_109.Result(r);if(o.append("".concat(r.name,"=vmess,").concat(r.server,",").concat(r.port,",").concat(r.cipher,',"').concat(r.uuid,'"')),r.network==="tcp"&&delete r.network,(0,_$utils_109.isPresent)(r,"network"))if(r.network==="ws"){var f,d,h;o.append(",transport=ws"),o.appendIfPresent(",path=".concat((f=r["ws-opts"])===null||f===void 0?void 0:f.path),"ws-opts.path"),o.appendIfPresent(",host=".concat((d=r["ws-opts"])===null||d===void 0||(h=d.headers)===null||h===void 0?void 0:h.Host),"ws-opts.headers.Host")}else{if(r.network!=="http")throw new Error("network ".concat(r.network," is unsupported"));var y,F,S;o.append(",transport=http");var T=(y=r["http-opts"])===null||y===void 0?void 0:y.path,U=(F=r["http-opts"])===null||F===void 0||(S=F.headers)===null||S===void 0?void 0:S.Host;o.appendIfPresent(",path=".concat(Array.isArray(T)?T[0]:T),"http-opts.path"),o.appendIfPresent(",host=".concat(Array.isArray(U)?U[0]:U),"http-opts.headers.Host")}else o.append(",transport=tcp");return o.appendIfPresent(",over-tls=".concat(r.tls),"tls"),o.appendIfPresent(",skip-cert-verify=".concat(r["skip-cert-verify"]),"skip-cert-verify"),o.appendIfPresent(",tls-name=".concat(r.sni),"sni"),o.appendIfPresent(",tls-cert-sha256=".concat(r["tls-fingerprint"]),"tls-fingerprint"),o.appendIfPresent(",tls-pubkey-sha256=".concat(r["tls-pubkey-sha256"]),"tls-pubkey-sha256"),(0,_$utils_109.isPresent)(r,"aead")?o.append(",alterId=0"):o.append(",alterId=".concat(r.alterId)),o.appendIfPresent(",fast-open=".concat(r.tfo),"tfo"),r.udp&&o.append(",udp=true"),o.toString()}(t);case"vless":return function(r){if(r["reality-opts"])throw new Error("VLESS REALITY is unsupported");var o=new _$utils_109.Result(r);if(o.append("".concat(r.name,"=vless,").concat(r.server,",").concat(r.port,',"').concat(r.uuid,'"')),r.network==="tcp"&&delete r.network,(0,_$utils_109.isPresent)(r,"network"))if(r.network==="ws"){var f,d,h;o.append(",transport=ws"),o.appendIfPresent(",path=".concat((f=r["ws-opts"])===null||f===void 0?void 0:f.path),"ws-opts.path"),o.appendIfPresent(",host=".concat((d=r["ws-opts"])===null||d===void 0||(h=d.headers)===null||h===void 0?void 0:h.Host),"ws-opts.headers.Host")}else{if(r.network!=="http")throw new Error("network ".concat(r.network," is unsupported"));var y,F,S;o.append(",transport=http");var T=(y=r["http-opts"])===null||y===void 0?void 0:y.path,U=(F=r["http-opts"])===null||F===void 0||(S=F.headers)===null||S===void 0?void 0:S.Host;o.appendIfPresent(",path=".concat(Array.isArray(T)?T[0]:T),"http-opts.path"),o.appendIfPresent(",host=".concat(Array.isArray(U)?U[0]:U),"http-opts.headers.Host")}else o.append(",transport=tcp");return o.appendIfPresent(",over-tls=".concat(r.tls),"tls"),o.appendIfPresent(",skip-cert-verify=".concat(r["skip-cert-verify"]),"skip-cert-verify"),o.appendIfPresent(",tls-name=".concat(r.sni),"sni"),o.appendIfPresent(",tls-cert-sha256=".concat(r["tls-fingerprint"]),"tls-fingerprint"),o.appendIfPresent(",tls-pubkey-sha256=".concat(r["tls-pubkey-sha256"]),"tls-pubkey-sha256"),o.appendIfPresent(",fast-open=".concat(r.tfo),"tfo"),r.udp&&o.append(",udp=true"),o.toString()}(t);case"http":return function(r){var o=new _$utils_109.Result(r),f=r.tls?"https":"http";return o.append("".concat(r.name,"=").concat(f,",").concat(r.server,",").concat(r.port)),o.appendIfPresent(",".concat(r.username),"username"),o.appendIfPresent(',"'.concat(r.password,'"'),"password"),o.appendIfPresent(",sni=".concat(r.sni),"sni"),o.appendIfPresent(",skip-cert-verify=".concat(r["skip-cert-verify"]),"skip-cert-verify"),o.appendIfPresent(",tfo=".concat(r.tfo),"tfo"),o.toString()}(t);case"socks5":return function(r){var o=new _$utils_109.Result(r);return o.append("".concat(r.name,"=socks5,").concat(r.server,",").concat(r.port)),o.appendIfPresent(",".concat(r.username),"username"),o.appendIfPresent(',"'.concat(r.password,'"'),"password"),o.appendIfPresent(",over-tls=".concat(r.tls),"tls"),o.appendIfPresent(",sni=".concat(r.sni),"sni"),o.appendIfPresent(",skip-cert-verify=".concat(r["skip-cert-verify"]),"skip-cert-verify"),o.appendIfPresent(",tfo=".concat(r.tfo),"tfo"),r.udp&&o.append(",udp=true"),o.toString()}(t);case"wireguard":return function(r){var o,f,d;Array.isArray(r.peers)&&r.peers.length>0&&(r.server=r.peers[0].server,r.port=r.peers[0].port,r.ip=r.peers[0].ip,r.ipv6=r.peers[0].ipv6,r["public-key"]=r.peers[0]["public-key"],r["preshared-key"]=r.peers[0]["pre-shared-key"],r["allowed-ips"]=r.peers[0]["allowed-ips"],r.reserved=r.peers[0].reserved);var h=new _$utils_109.Result(r);if(h.append("".concat(r.name,"=wireguard")),h.appendIfPresent(",interface-ip=".concat(r.ip),"ip"),h.appendIfPresent(",interface-ipv6=".concat(r.ipv6),"ipv6"),h.appendIfPresent(',private-key="'.concat(r["private-key"],'"'),"private-key"),h.appendIfPresent(",mtu=".concat(r.mtu),"mtu"),r.dns&&Array.isArray(r.dns)){r.dnsv6=r.dns.find(function(U){return(0,_$utils_141.isIPv6)(U)});var y=r.dns.find(function(U){return(0,_$utils_141.isIPv4)(U)});y||(y=r.dns.find(function(U){return!(0,_$utils_141.isIPv4)(U)&&!(0,_$utils_141.isIPv6)(U)})),r.dns=y}h.appendIfPresent(",dns=".concat(r.dns),"dns"),h.appendIfPresent(",dnsv6=".concat(r.dnsv6),"dnsv6"),h.appendIfPresent(",keepalive=".concat(r["persistent-keepalive"]),"persistent-keepalive"),h.appendIfPresent(",keepalive=".concat(r.keepalive),"keepalive");var F=Array.isArray(r["allowed-ips"])?r["allowed-ips"].join(","):r["allowed-ips"],S=Array.isArray(r.reserved)?r.reserved.join(","):r.reserved;S&&(S=",reserved=[".concat(S,"]"));var T=(o=r["preshared-key"])!==null&&o!==void 0?o:r["pre-shared-key"];return T&&(T=',preshared-key="'.concat(T,'"')),h.append(',peers=[{public-key="'.concat(r["public-key"],'",allowed-ips="').concat(F??"0.0.0.0/0,::/0",'",endpoint=').concat(r.server,":").concat(r.port).concat((f=S)!==null&&f!==void 0?f:"").concat((d=T)!==null&&d!==void 0?d:"","}]")),h.toString()}(t);case"hysteria2":return function(r){var o;if(r["obfs-password"]&&r.obfs!="salamander")throw new Error("only salamander obfs is supported");var f=new _$utils_109.Result(r);return f.append("".concat(r.name,"=Hysteria2,").concat(r.server,",").concat(r.port)),f.appendIfPresent(',"'.concat(r.password,'"'),"password"),f.appendIfPresent(",tls-name=".concat(r.sni),"sni"),f.appendIfPresent(",tls-cert-sha256=".concat(r["tls-fingerprint"]),"tls-fingerprint"),f.appendIfPresent(",tls-pubkey-sha256=".concat(r["tls-pubkey-sha256"]),"tls-pubkey-sha256"),f.appendIfPresent(",skip-cert-verify=".concat(r["skip-cert-verify"]),"skip-cert-verify"),r["obfs-password"]&&r.obfs=="salamander"&&f.append(",salamander-password=".concat(r["obfs-password"])),f.appendIfPresent(",fast-open=".concat(r.tfo),"tfo"),r.udp&&f.append(",udp=true"),f.appendIfPresent(",download-bandwidth=".concat(((o="".concat(r.down).match(/\d+/))===null||o===void 0?void 0:o[0])||0),"down"),f.appendIfPresent(",ecn=".concat(r.ecn),"ecn"),f.toString()}(t)}throw new Error("Platform ".concat(__targetPlatform_100," does not support proxy type: ").concat(t.type))}}};var __targetPlatform_100="Loon",_$uri_108={};Object.defineProperty(_$uri_108,"__esModule",{value:!0}),_$uri_108.default=function(){return{type:"SINGLE",produce:function(t){var e,n,r,o,f,d,h,y="";for(var F in delete t.subName,delete t.collectionName,delete t.id,delete t.resolved,delete t["no-resolve"],t)(t[F]==null||/^_/i.test(F))&&delete t[F];switch(["trojan","tuic","hysteria","hysteria2","juicity"].includes(t.type)&&delete t.tls,t.server&&(0,_$utils_141.isIPv6)(t.server)&&(t.server="[".concat(t.server,"]")),t.type){case"ss":var S="".concat(t.cipher,":").concat(t.password);if(y="ss://".concat((e=t.cipher)!==null&&e!==void 0&&e.startsWith("2022-blake3-")?"".concat(encodeURIComponent(t.cipher),":").concat(encodeURIComponent(t.password)):_$base64_20.Base64.encode(S),"@").concat(t.server,":").concat(t.port).concat(t.plugin?"/":""),t.plugin){y+="?plugin=";var T=t["plugin-opts"];switch(t.plugin){case"obfs":y+=encodeURIComponent("simple-obfs;obfs=".concat(T.mode).concat(T.host?";obfs-host="+T.host:""));break;case"v2ray-plugin":y+=encodeURIComponent("v2ray-plugin;obfs=".concat(T.mode).concat(T.host?";obfs-host"+T.host:"").concat(T.tls?";tls":""));break;default:throw new Error("Unsupported plugin option: ".concat(t.plugin))}}t["udp-over-tcp"]&&(y="".concat(y).concat(t.plugin?"&":"?","uot=1")),t.tfo&&(y="".concat(y).concat(t.plugin||t["udp-over-tcp"]?"&":"?","tfo=1")),y+="#".concat(encodeURIComponent(t.name));break;case"ssr":y="".concat(t.server,":").concat(t.port,":").concat(t.protocol,":").concat(t.cipher,":").concat(t.obfs,":").concat(_$base64_20.Base64.encode(t.password),"/"),y+="?remarks=".concat(_$base64_20.Base64.encode(t.name)).concat(t["obfs-param"]?"&obfsparam="+_$base64_20.Base64.encode(t["obfs-param"]):"").concat(t["protocol-param"]?"&protocolparam="+_$base64_20.Base64.encode(t["protocol-param"]):""),y="ssr://"+_$base64_20.Base64.encode(y);break;case"vmess":var U="",M=t.network||"tcp";if(t.network==="http"?(M="tcp",U="http"):t.network==="ws"&&(n=t["ws-opts"])!==null&&n!==void 0&&n["v2ray-http-upgrade"]&&(M="httpupgrade"),y={v:"2",ps:t.name,add:t.server,port:t.port,id:t.uuid,type:U,aid:t.alterId||0,net:M,tls:t.tls?"tls":""},t.tls&&t.sni&&(y.sni=t.sni),t.network){var Y,Z,D,nt,ct,at,et=(Y=t["".concat(t.network,"-opts")])===null||Y===void 0?void 0:Y.path,mt=(Z=t["".concat(t.network,"-opts")])===null||Z===void 0||(D=Z.headers)===null||D===void 0?void 0:D.Host;et&&(y.path=Array.isArray(et)?et[0]:et),mt&&(y.host=Array.isArray(mt)?mt[0]:mt),["grpc"].includes(t.network)&&(y.path=(nt=t["".concat(t.network,"-opts")])===null||nt===void 0?void 0:nt["grpc-service-name"],y.type=((ct=t["".concat(t.network,"-opts")])===null||ct===void 0?void 0:ct["_grpc-type"])||"gun",y.host=(at=t["".concat(t.network,"-opts")])===null||at===void 0?void 0:at["_grpc-authority"])}y="vmess://"+_$base64_20.Base64.encode(JSON.stringify(y));break;case"vless":var At="none",dt="",ht="";if(t["reality-opts"]){var xt,l;At="reality";var s=(xt=t["reality-opts"])===null||xt===void 0?void 0:xt["public-key"];s&&(ht="&pbk=".concat(encodeURIComponent(s)));var v=(l=t["reality-opts"])===null||l===void 0?void 0:l["short-id"];v&&(dt="&sid=".concat(encodeURIComponent(v)))}else t.tls&&(At="tls");var $="";t.alpn&&($="&alpn=".concat(encodeURIComponent(Array.isArray(t.alpn)?t.alpn:t.alpn.join(","))));var E="";t["skip-cert-verify"]&&(E="&allowInsecure=1");var rt="";t.sni&&(rt="&sni=".concat(encodeURIComponent(t.sni)));var gt="";t["client-fingerprint"]&&(gt="&fp=".concat(encodeURIComponent(t["client-fingerprint"])));var Et="";t.flow&&(Et="&flow=".concat(encodeURIComponent(t.flow)));var Ct=t.network;t.network==="ws"&&(r=t["ws-opts"])!==null&&r!==void 0&&r["v2ray-http-upgrade"]&&(Ct="httpupgrade");var x="&type=".concat(encodeURIComponent(Ct));if(["grpc"].includes(t.network)){var N,G;x+="&mode=".concat(encodeURIComponent(((N=t["".concat(t.network,"-opts")])===null||N===void 0?void 0:N["_grpc-type"])||"gun"));var A=(G=t["".concat(t.network,"-opts")])===null||G===void 0?void 0:G["_grpc-authority"];A&&(x+="&authority=".concat(encodeURIComponent(A)))}var C=(o=t["".concat(t.network,"-opts")])===null||o===void 0?void 0:o["".concat(t.network,"-service-name")],j=(f=t["".concat(t.network,"-opts")])===null||f===void 0?void 0:f.path,K=(d=t["".concat(t.network,"-opts")])===null||d===void 0||(h=d.headers)===null||h===void 0?void 0:h.Host;j&&(x+="&path=".concat(encodeURIComponent(Array.isArray(j)?j[0]:j))),K&&(x+="&host=".concat(encodeURIComponent(Array.isArray(K)?K[0]:K))),C&&(x+="&serviceName=".concat(encodeURIComponent(C))),t.network==="kcp"&&(t.seed&&(x+="&seed=".concat(encodeURIComponent(t.seed))),t.headerType&&(x+="&headerType=".concat(encodeURIComponent(t.headerType)))),y="vless://".concat(t.uuid,"@").concat(t.server,":").concat(t.port,"?security=").concat(encodeURIComponent(At)).concat(x).concat($).concat(E).concat(rt).concat(gt).concat(Et).concat(dt).concat(ht,"#").concat(encodeURIComponent(t.name));break;case"trojan":var J="";if(t.network){var yt,Dt,Xt,_e,me=t.network;if(t.network==="ws"&&(yt=t["ws-opts"])!==null&&yt!==void 0&&yt["v2ray-http-upgrade"]&&(me="httpupgrade"),J="&type=".concat(encodeURIComponent(me)),["grpc"].includes(t.network)){var de,Zt,Vt,pe=(de=t["".concat(t.network,"-opts")])===null||de===void 0?void 0:de["".concat(t.network,"-service-name")],ge=(Zt=t["".concat(t.network,"-opts")])===null||Zt===void 0?void 0:Zt["_grpc-authority"];pe&&(J+="&serviceName=".concat(encodeURIComponent(pe))),ge&&(J+="&authority=".concat(encodeURIComponent(ge))),J+="&mode=".concat(encodeURIComponent(((Vt=t["".concat(t.network,"-opts")])===null||Vt===void 0?void 0:Vt["_grpc-type"])||"gun"))}var jt=(Dt=t["".concat(t.network,"-opts")])===null||Dt===void 0?void 0:Dt.path,Bt=(Xt=t["".concat(t.network,"-opts")])===null||Xt===void 0||(_e=Xt.headers)===null||_e===void 0?void 0:_e.Host;jt&&(J+="&path=".concat(encodeURIComponent(Array.isArray(jt)?jt[0]:jt))),Bt&&(J+="&host=".concat(encodeURIComponent(Array.isArray(Bt)?Bt[0]:Bt)))}var ie="";t["client-fingerprint"]&&(ie="&fp=".concat(encodeURIComponent(t["client-fingerprint"])));var ee="";t.alpn&&(ee="&alpn=".concat(encodeURIComponent(Array.isArray(t.alpn)?t.alpn:t.alpn.join(",")))),y="trojan://".concat(t.password,"@").concat(t.server,":").concat(t.port,"?sni=").concat(encodeURIComponent(t.sni||t.server)).concat(t["skip-cert-verify"]?"&allowInsecure=1":"").concat(J).concat(ee).concat(ie,"#").concat(encodeURIComponent(t.name));break;case"hysteria2":var Kt=[];t["skip-cert-verify"]&&Kt.push("insecure=1"),t.obfs&&(Kt.push("obfs=".concat(encodeURIComponent(t.obfs))),t["obfs-password"]&&Kt.push("obfs-password=".concat(encodeURIComponent(t["obfs-password"])))),t.sni&&Kt.push("sni=".concat(encodeURIComponent(t.sni))),t.ports&&Kt.push("mport=".concat(t.ports)),t["tls-fingerprint"]&&Kt.push("pinSHA256=".concat(encodeURIComponent(t["tls-fingerprint"]))),t.tfo&&Kt.push("fastopen=1"),y="hysteria2://".concat(encodeURIComponent(t.password),"@").concat(t.server,":").concat(t.port,"?").concat(Kt.join("&"),"#").concat(encodeURIComponent(t.name));break;case"hysteria":var be=[];Object.keys(t).forEach(function(ce){if(!["name","type","server","port"].includes(ce)){var Gt=ce.replace(/-/,"_");["alpn"].includes(ce)?t[ce]&&be.push("".concat(Gt,"=").concat(encodeURIComponent(Array.isArray(t[ce])?t[ce][0]:t[ce]))):["skip-cert-verify"].includes(ce)?t[ce]&&be.push("insecure=1"):["tfo","fast-open"].includes(ce)?t[ce]&&!be.includes("fastopen=1")&&be.push("fastopen=1"):["ports"].includes(ce)?be.push("mport=".concat(t[ce])):["auth-str"].includes(ce)?be.push("auth=".concat(t[ce])):["up"].includes(ce)?be.push("upmbps=".concat(t[ce])):["down"].includes(ce)?be.push("downmbps=".concat(t[ce])):["_obfs"].includes(ce)?be.push("obfs=".concat(t[ce])):["obfs"].includes(ce)?be.push("obfsParam=".concat(t[ce])):["sni"].includes(ce)?be.push("peer=".concat(t[ce])):t[ce]&&be.push("".concat(Gt,"=").concat(encodeURIComponent(t[ce])))}}),y="hysteria://".concat(t.server,":").concat(t.port,"?").concat(be.join("&"),"#").concat(encodeURIComponent(t.name));break;case"tuic":if(!t.token||t.token.length===0){var b=[];Object.keys(t).forEach(function(ce){if(!["name","type","uuid","password","server","port"].includes(ce)){var Gt=ce.replace(/-/,"_");["alpn"].includes(ce)?t[ce]&&b.push("".concat(Gt,"=").concat(encodeURIComponent(Array.isArray(t[ce])?t[ce][0]:t[ce]))):["skip-cert-verify"].includes(ce)?t[ce]&&b.push("allow_insecure=1"):["tfo","fast-open"].includes(ce)?t[ce]&&!b.includes("fast_open=1")&&b.push("fast_open=1"):["disable-sni","reduce-rtt"].includes(ce)&&t[ce]?b.push("".concat(Gt,"=1")):t[ce]&&b.push("".concat(Gt,"=").concat(encodeURIComponent(t[ce])))}}),y="tuic://".concat(encodeURIComponent(t.uuid),":").concat(encodeURIComponent(t.password),"@").concat(t.server,":").concat(t.port,"?").concat(b.join("&"),"#").concat(encodeURIComponent(t.name))}break;case"wireguard":var Be=[];Object.keys(t).forEach(function(ce){["name","type","server","port","ip","ipv6","private-key"].includes(ce)||(["public-key"].includes(ce)?Be.push("publickey=".concat(t[ce])):["udp"].includes(ce)?t[ce]&&Be.push("".concat(ce,"=1")):t[ce]&&Be.push("".concat(ce,"=").concat(encodeURIComponent(t[ce]))))}),t.ip&&t.ipv6?Be.push("address=".concat(t.ip,"/32,").concat(t.ipv6,"/128")):t.ip?Be.push("address=".concat(t.ip,"/32")):t.ipv6&&Be.push("address=".concat(t.ipv6,"/128")),y="wireguard://".concat(encodeURIComponent(t["private-key"]),"@").concat(t.server,":").concat(t.port,"/?").concat(Be.join("&"),"#").concat(encodeURIComponent(t.name))}return y}}};var _$v2ray_110={};Object.defineProperty(_$v2ray_110,"__esModule",{value:!0}),_$v2ray_110.default=function(){return{type:"ALL",produce:function(t){var e=[];return t.map(function(n){try{e.push(URI.produce(n))}catch(r){___app_110.default.error("Cannot produce proxy: ".concat(JSON.stringify(n,null,2),`
Reason: `).concat(r))}}),_$base64_20.Base64.encode(e.join(`
`))}}};var _uri=___interopRequireDefault_110(_$uri_108),___app_110=___interopRequireDefault_110(_$app_87);function ___interopRequireDefault_110(t){return t&&t.__esModule?t:{default:t}}var URI=(0,_uri.default)(),_$qx_101={};Object.defineProperty(_$qx_101,"__esModule",{value:!0}),_$qx_101.default=function(){return{produce:function(t,e){switch(t.type){case"ss":return function(n){var r=new _$utils_109.Result(n),o=r.append.bind(r),f=r.appendIfPresent.bind(r);if(n.cipher||(n.cipher="none"),!["none","rc4-md5","rc4-md5-6","aes-128-cfb","aes-192-cfb","aes-256-cfb","aes-128-ctr","aes-192-ctr","aes-256-ctr","bf-cfb","cast5-cfb","des-cfb","rc2-cfb","salsa20","chacha20","chacha20-ietf","aes-128-gcm","aes-192-gcm","aes-256-gcm","chacha20-ietf-poly1305","xchacha20-ietf-poly1305"].includes(n.cipher))throw new Error("cipher ".concat(n.cipher," is not supported"));if(o("shadowsocks=".concat(n.server,":").concat(n.port)),o(",method=".concat(n.cipher)),o(",password=".concat(n.password)),needTls(n)&&(n.tls=!0),(0,_$utils_109.isPresent)(n,"plugin")){if(n.plugin==="obfs"){var d=n["plugin-opts"];o(",obfs=".concat(d.mode))}else{if(n.plugin!=="v2ray-plugin"||n["plugin-opts"].mode!=="websocket")throw new Error("plugin is not supported");n["plugin-opts"].tls?o(",obfs=wss"):o(",obfs=ws")}f(",obfs-host=".concat(n["plugin-opts"].host),"plugin-opts.host"),f(",obfs-uri=".concat(n["plugin-opts"].path),"plugin-opts.path")}return needTls(n)&&(f(",tls-pubkey-sha256=".concat(n["tls-pubkey-sha256"]),"tls-pubkey-sha256"),f(",tls-alpn=".concat(n["tls-alpn"]),"tls-alpn"),f(",tls-no-session-ticket=".concat(n["tls-no-session-ticket"]),"tls-no-session-ticket"),f(",tls-no-session-reuse=".concat(n["tls-no-session-reuse"]),"tls-no-session-reuse"),f(",tls-cert-sha256=".concat(n["tls-fingerprint"]),"tls-fingerprint"),f(",tls-verification=".concat(!n["skip-cert-verify"]),"skip-cert-verify"),f(",tls-host=".concat(n.sni),"sni")),f(",fast-open=".concat(n.tfo),"tfo"),f(",udp-relay=".concat(n.udp),"udp"),r.appendIfPresent(",server_check_url=".concat(n["test-url"]),"test-url"),o(",tag=".concat(n.name)),r.toString()}(t);case"ssr":return function(n){var r=new _$utils_109.Result(n),o=r.append.bind(r),f=r.appendIfPresent.bind(r);return o("shadowsocks=".concat(n.server,":").concat(n.port)),o(",method=".concat(n.cipher)),o(",password=".concat(n.password)),o(",ssr-protocol=".concat(n.protocol)),f(",ssr-protocol-param=".concat(n["protocol-param"]),"protocol-param"),f(",obfs=".concat(n.obfs),"obfs"),f(",obfs-host=".concat(n["obfs-param"]),"obfs-param"),f(",fast-open=".concat(n.tfo),"tfo"),f(",udp-relay=".concat(n.udp),"udp"),r.appendIfPresent(",server_check_url=".concat(n["test-url"]),"test-url"),o(",tag=".concat(n.name)),r.toString()}(t);case"trojan":return function(n){var r=new _$utils_109.Result(n),o=r.append.bind(r),f=r.appendIfPresent.bind(r);if(o("trojan=".concat(n.server,":").concat(n.port)),o(",password=".concat(n.password)),(0,_$utils_109.isPresent)(n,"network")){if(n.network!=="ws")throw new Error("network ".concat(n.network," is unsupported"));var d,h,y;needTls(n)?o(",obfs=wss"):o(",obfs=ws"),f(",obfs-uri=".concat((d=n["ws-opts"])===null||d===void 0?void 0:d.path),"ws-opts.path"),f(",obfs-host=".concat((h=n["ws-opts"])===null||h===void 0||(y=h.headers)===null||y===void 0?void 0:y.Host),"ws-opts.headers.Host")}return n.network!=="ws"&&needTls(n)&&o(",over-tls=true"),needTls(n)&&(f(",tls-pubkey-sha256=".concat(n["tls-pubkey-sha256"]),"tls-pubkey-sha256"),f(",tls-alpn=".concat(n["tls-alpn"]),"tls-alpn"),f(",tls-no-session-ticket=".concat(n["tls-no-session-ticket"]),"tls-no-session-ticket"),f(",tls-no-session-reuse=".concat(n["tls-no-session-reuse"]),"tls-no-session-reuse"),f(",tls-cert-sha256=".concat(n["tls-fingerprint"]),"tls-fingerprint"),f(",tls-verification=".concat(!n["skip-cert-verify"]),"skip-cert-verify"),f(",tls-host=".concat(n.sni),"sni")),f(",fast-open=".concat(n.tfo),"tfo"),f(",udp-relay=".concat(n.udp),"udp"),r.appendIfPresent(",server_check_url=".concat(n["test-url"]),"test-url"),o(",tag=".concat(n.name)),r.toString()}(t);case"vmess":return function(n){var r,o=new _$utils_109.Result(n),f=o.append.bind(o),d=o.appendIfPresent.bind(o);if(f("vmess=".concat(n.server,":").concat(n.port)),r=n.cipher==="auto"?"chacha20-ietf-poly1305":n.cipher,f(",method=".concat(r)),f(",password=".concat(n.uuid)),needTls(n)&&(n.tls=!0),(0,_$utils_109.isPresent)(n,"network")){var h,y,F;if(n.network==="ws")n.tls?f(",obfs=wss"):f(",obfs=ws");else{if(n.network!=="http")throw new Error("network ".concat(n.network," is unsupported"));f(",obfs=http")}var S=(h=n["".concat(n.network,"-opts")])===null||h===void 0?void 0:h.path,T=(y=n["".concat(n.network,"-opts")])===null||y===void 0||(F=y.headers)===null||F===void 0?void 0:F.Host;d(",obfs-uri=".concat(Array.isArray(S)?S[0]:S),"".concat(n.network,"-opts.path")),d(",obfs-host=".concat(Array.isArray(T)?T[0]:T),"".concat(n.network,"-opts.headers.Host"))}else n.tls&&f(",obfs=over-tls");return needTls(n)&&(d(",tls-pubkey-sha256=".concat(n["tls-pubkey-sha256"]),"tls-pubkey-sha256"),d(",tls-alpn=".concat(n["tls-alpn"]),"tls-alpn"),d(",tls-no-session-ticket=".concat(n["tls-no-session-ticket"]),"tls-no-session-ticket"),d(",tls-no-session-reuse=".concat(n["tls-no-session-reuse"]),"tls-no-session-reuse"),d(",tls-cert-sha256=".concat(n["tls-fingerprint"]),"tls-fingerprint"),d(",tls-verification=".concat(!n["skip-cert-verify"]),"skip-cert-verify"),d(",tls-host=".concat(n.sni),"sni")),(0,_$utils_109.isPresent)(n,"aead")?f(",aead=".concat(n.aead)):f(",aead=".concat(n.alterId===0)),d(",fast-open=".concat(n.tfo),"tfo"),d(",udp-relay=".concat(n.udp),"udp"),o.appendIfPresent(",server_check_url=".concat(n["test-url"]),"test-url"),f(",tag=".concat(n.name)),o.toString()}(t);case"http":return function(n){var r=new _$utils_109.Result(n),o=r.append.bind(r),f=r.appendIfPresent.bind(r);return o("http=".concat(n.server,":").concat(n.port)),f(",username=".concat(n.username),"username"),f(",password=".concat(n.password),"password"),needTls(n)&&(n.tls=!0),f(",over-tls=".concat(n.tls),"tls"),needTls(n)&&(f(",tls-pubkey-sha256=".concat(n["tls-pubkey-sha256"]),"tls-pubkey-sha256"),f(",tls-alpn=".concat(n["tls-alpn"]),"tls-alpn"),f(",tls-no-session-ticket=".concat(n["tls-no-session-ticket"]),"tls-no-session-ticket"),f(",tls-no-session-reuse=".concat(n["tls-no-session-reuse"]),"tls-no-session-reuse"),f(",tls-cert-sha256=".concat(n["tls-fingerprint"]),"tls-fingerprint"),f(",tls-verification=".concat(!n["skip-cert-verify"]),"skip-cert-verify"),f(",tls-host=".concat(n.sni),"sni")),f(",fast-open=".concat(n.tfo),"tfo"),f(",udp-relay=".concat(n.udp),"udp"),r.appendIfPresent(",server_check_url=".concat(n["test-url"]),"test-url"),o(",tag=".concat(n.name)),r.toString()}(t);case"socks5":return function(n){var r=new _$utils_109.Result(n),o=r.append.bind(r),f=r.appendIfPresent.bind(r);return o("socks5=".concat(n.server,":").concat(n.port)),f(",username=".concat(n.username),"username"),f(",password=".concat(n.password),"password"),needTls(n)&&(n.tls=!0),f(",over-tls=".concat(n.tls),"tls"),needTls(n)&&(f(",tls-pubkey-sha256=".concat(n["tls-pubkey-sha256"]),"tls-pubkey-sha256"),f(",tls-alpn=".concat(n["tls-alpn"]),"tls-alpn"),f(",tls-no-session-ticket=".concat(n["tls-no-session-ticket"]),"tls-no-session-ticket"),f(",tls-no-session-reuse=".concat(n["tls-no-session-reuse"]),"tls-no-session-reuse"),f(",tls-cert-sha256=".concat(n["tls-fingerprint"]),"tls-fingerprint"),f(",tls-verification=".concat(!n["skip-cert-verify"]),"skip-cert-verify"),f(",tls-host=".concat(n.sni),"sni")),f(",fast-open=".concat(n.tfo),"tfo"),f(",udp-relay=".concat(n.udp),"udp"),r.appendIfPresent(",server_check_url=".concat(n["test-url"]),"test-url"),o(",tag=".concat(n.name)),r.toString()}(t);case"vless":return function(n){if(n.flow!==void 0||n["reality-opts"])throw new Error("VLESS XTLS/REALITY is not supported");var r=new _$utils_109.Result(n),o=r.append.bind(r),f=r.appendIfPresent.bind(r);if(o("vless=".concat(n.server,":").concat(n.port)),o(",method=".concat("none")),o(",password=".concat(n.uuid)),needTls(n)&&(n.tls=!0),(0,_$utils_109.isPresent)(n,"network")){var d,h,y;if(n.network==="ws")n.tls?o(",obfs=wss"):o(",obfs=ws");else if(n.network==="http")o(",obfs=http");else if(!["tcp"].includes(n.network))throw new Error("network ".concat(n.network," is unsupported"));var F=(d=n["".concat(n.network,"-opts")])===null||d===void 0?void 0:d.path,S=(h=n["".concat(n.network,"-opts")])===null||h===void 0||(y=h.headers)===null||y===void 0?void 0:y.Host;f(",obfs-uri=".concat(Array.isArray(F)?F[0]:F),"".concat(n.network,"-opts.path")),f(",obfs-host=".concat(Array.isArray(S)?S[0]:S),"".concat(n.network,"-opts.headers.Host"))}else n.tls&&o(",obfs=over-tls");return needTls(n)&&(f(",tls-pubkey-sha256=".concat(n["tls-pubkey-sha256"]),"tls-pubkey-sha256"),f(",tls-alpn=".concat(n["tls-alpn"]),"tls-alpn"),f(",tls-no-session-ticket=".concat(n["tls-no-session-ticket"]),"tls-no-session-ticket"),f(",tls-no-session-reuse=".concat(n["tls-no-session-reuse"]),"tls-no-session-reuse"),f(",tls-cert-sha256=".concat(n["tls-fingerprint"]),"tls-fingerprint"),f(",tls-verification=".concat(!n["skip-cert-verify"]),"skip-cert-verify"),f(",tls-host=".concat(n.sni),"sni")),f(",fast-open=".concat(n.tfo),"tfo"),f(",udp-relay=".concat(n.udp),"udp"),r.appendIfPresent(",server_check_url=".concat(n["test-url"]),"test-url"),o(",tag=".concat(n.name)),r.toString()}(t)}throw new Error("Platform ".concat(__targetPlatform_101," does not support proxy type: ").concat(t.type))}}};var __targetPlatform_101="QX";function needTls(t){return t.tls}var _$shadowrocket_102={};Object.defineProperty(_$shadowrocket_102,"__esModule",{value:!0}),_$shadowrocket_102.default=function(){return{type:"ALL",produce:function(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=t.filter(function(o){return!!n["include-unsupported-proxy"]||(o.type!=="snell"||String(o.version)!=="4")&&!["mieru"].includes(o.type)}).map(function(o){var f;if(o.type==="vmess")(0,_$utils_109.isPresent)(o,"aead")&&(o.aead&&(o.alterId=0),delete o.aead),(0,_$utils_109.isPresent)(o,"sni")&&(o.servername=o.sni,delete o.sni),(0,_$utils_109.isPresent)(o,"cipher")&&!["auto","aes-128-gcm","chacha20-poly1305","none"].includes(o.cipher)&&(o.cipher="auto");else if(o.type==="tuic")(0,_$utils_109.isPresent)(o,"alpn")?o.alpn=Array.isArray(o.alpn)?o.alpn:[o.alpn]:o.alpn=["h3"],(0,_$utils_109.isPresent)(o,"tfo")&&!(0,_$utils_109.isPresent)(o,"fast-open")&&(o["fast-open"]=o.tfo),o.token&&o.token.length!==0||(0,_$utils_109.isPresent)(o,"version")||(o.version=5);else if(o.type==="hysteria")(0,_$utils_109.isPresent)(o,"auth_str")&&!(0,_$utils_109.isPresent)(o,"auth-str")&&(o["auth-str"]=o.auth_str),(0,_$utils_109.isPresent)(o,"alpn")&&(o.alpn=Array.isArray(o.alpn)?o.alpn:[o.alpn]),(0,_$utils_109.isPresent)(o,"tfo")&&!(0,_$utils_109.isPresent)(o,"fast-open")&&(o["fast-open"]=o.tfo);else if(o.type==="hysteria2")o["obfs-password"]&&o.obfs=="salamander"&&(o.obfs=o["obfs-password"],delete o["obfs-password"]),(0,_$utils_109.isPresent)(o,"alpn")&&(o.alpn=Array.isArray(o.alpn)?o.alpn:[o.alpn]),(0,_$utils_109.isPresent)(o,"tfo")&&!(0,_$utils_109.isPresent)(o,"fast-open")&&(o["fast-open"]=o.tfo);else if(o.type==="wireguard"){var d,h;o.keepalive=(d=o.keepalive)!==null&&d!==void 0?d:o["persistent-keepalive"],o["persistent-keepalive"]=o.keepalive,o["preshared-key"]=(h=o["preshared-key"])!==null&&h!==void 0?h:o["pre-shared-key"],o["pre-shared-key"]=o["preshared-key"]}else o.type==="vless"&&(0,_$utils_109.isPresent)(o,"sni")&&(o.servername=o.sni,delete o.sni);if(["vmess","vless"].includes(o.type)&&o.network==="http"){var y,F,S,T=(y=o["http-opts"])===null||y===void 0?void 0:y.path;(0,_$utils_109.isPresent)(o,"http-opts.path")&&!Array.isArray(T)&&(o["http-opts"].path=[T]);var U=(F=o["http-opts"])===null||F===void 0||(S=F.headers)===null||S===void 0?void 0:S.Host;(0,_$utils_109.isPresent)(o,"http-opts.headers.Host")&&!Array.isArray(U)&&(o["http-opts"].headers.Host=[U])}if(["vmess","vless"].includes(o.type)&&o.network==="h2"){var M,Y,Z,D=(M=o["h2-opts"])===null||M===void 0?void 0:M.path;(0,_$utils_109.isPresent)(o,"h2-opts.path")&&Array.isArray(D)&&(o["h2-opts"].path=D[0]);var nt=(Y=o["h2-opts"])===null||Y===void 0||(Z=Y.headers)===null||Z===void 0?void 0:Z.host;(0,_$utils_109.isPresent)(o,"h2-opts.headers.Host")&&!Array.isArray(nt)&&(o["h2-opts"].headers.host=[nt])}if((f=o["plugin-opts"])!==null&&f!==void 0&&f.tls&&(0,_$utils_109.isPresent)(o,"skip-cert-verify")&&(o["plugin-opts"]["skip-cert-verify"]=o["skip-cert-verify"]),["trojan","tuic","hysteria","hysteria2","juicity"].includes(o.type)&&delete o.tls,o["tls-fingerprint"]&&(o.fingerprint=o["tls-fingerprint"]),delete o["tls-fingerprint"],o["underlying-proxy"]&&(o["dialer-proxy"]=o["underlying-proxy"]),delete o["underlying-proxy"],(0,_$utils_109.isPresent)(o,"tls")&&typeof o.tls!="boolean"&&delete o.tls,delete o.subName,delete o.collectionName,delete o.id,delete o.resolved,delete o["no-resolve"],e!=="internal")for(var ct in o)(o[ct]==null||/^_/i.test(ct))&&delete o[ct];return["grpc"].includes(o.network)&&o["".concat(o.network,"-opts")]&&(delete o["".concat(o.network,"-opts")]["_grpc-type"],delete o["".concat(o.network,"-opts")]["_grpc-authority"]),o});return e==="internal"?r:`proxies:
`+r.map(function(o){return"  - "+JSON.stringify(o)+`
`}).join("")}}};var _$surfboard_105={};Object.defineProperty(_$surfboard_105,"__esModule",{value:!0}),_$surfboard_105.default=function(){return{produce:function(t){switch(t.name=t.name.replace(/=|,/g,""),t.type){case"ss":return function(e){var n=new _$utils_109.Result(e);if(n.append("".concat(e.name,"=").concat(e.type,",").concat(e.server,",").concat(e.port)),!["aes-128-gcm","aes-192-gcm","aes-256-gcm","chacha20-ietf-poly1305","xchacha20-ietf-poly1305","rc4","rc4-md5","aes-128-cfb","aes-192-cfb","aes-256-cfb","aes-128-ctr","aes-192-ctr","aes-256-ctr","bf-cfb","camellia-128-cfb","camellia-192-cfb","camellia-256-cfb","salsa20","chacha20","chacha20-ietf"].includes(e.cipher))throw new Error("cipher ".concat(e.cipher," is not supported"));if(n.append(",encrypt-method=".concat(e.cipher)),n.appendIfPresent(",password=".concat(e.password),"password"),(0,_$utils_109.isPresent)(e,"plugin")){if(e.plugin!=="obfs")throw new Error("plugin ".concat(e.plugin," is not supported"));n.append(",obfs=".concat(e["plugin-opts"].mode)),n.appendIfPresent(",obfs-host=".concat(e["plugin-opts"].host),"plugin-opts.host"),n.appendIfPresent(",obfs-uri=".concat(e["plugin-opts"].path),"plugin-opts.path")}return n.appendIfPresent(",udp-relay=".concat(e.udp),"udp"),n.toString()}(t);case"trojan":return function(e){var n=new _$utils_109.Result(e);return n.append("".concat(e.name,"=").concat(e.type,",").concat(e.server,",").concat(e.port)),n.appendIfPresent(",password=".concat(e.password),"password"),__handleTransport_105(n,e),n.appendIfPresent(",tls=".concat(e.tls),"tls"),n.appendIfPresent(",sni=".concat(e.sni),"sni"),n.appendIfPresent(",skip-cert-verify=".concat(e["skip-cert-verify"]),"skip-cert-verify"),n.appendIfPresent(",tfo=".concat(e.tfo),"tfo"),n.appendIfPresent(",udp-relay=".concat(e.udp),"udp"),n.toString()}(t);case"vmess":return function(e){var n=new _$utils_109.Result(e);return n.append("".concat(e.name,"=").concat(e.type,",").concat(e.server,",").concat(e.port)),n.appendIfPresent(",username=".concat(e.uuid),"uuid"),__handleTransport_105(n,e),(0,_$utils_109.isPresent)(e,"aead")?n.append(",vmess-aead=".concat(e.aead)):n.append(",vmess-aead=".concat(e.alterId===0)),n.appendIfPresent(",tls=".concat(e.tls),"tls"),n.appendIfPresent(",sni=".concat(e.sni),"sni"),n.appendIfPresent(",skip-cert-verify=".concat(e["skip-cert-verify"]),"skip-cert-verify"),n.appendIfPresent(",udp-relay=".concat(e.udp),"udp"),n.toString()}(t);case"http":return function(e){var n=new _$utils_109.Result(e),r=e.tls?"https":"http";return n.append("".concat(e.name,"=").concat(r,",").concat(e.server,",").concat(e.port)),n.appendIfPresent(",".concat(e.username),"username"),n.appendIfPresent(",".concat(e.password),"password"),n.appendIfPresent(",sni=".concat(e.sni),"sni"),n.appendIfPresent(",skip-cert-verify=".concat(e["skip-cert-verify"]),"skip-cert-verify"),n.appendIfPresent(",udp-relay=".concat(e.udp),"udp"),n.toString()}(t);case"socks5":return function(e){var n=new _$utils_109.Result(e),r=e.tls?"socks5-tls":"socks5";return n.append("".concat(e.name,"=").concat(r,",").concat(e.server,",").concat(e.port)),n.appendIfPresent(",".concat(e.username),"username"),n.appendIfPresent(",".concat(e.password),"password"),n.appendIfPresent(",sni=".concat(e.sni),"sni"),n.appendIfPresent(",skip-cert-verify=".concat(e["skip-cert-verify"]),"skip-cert-verify"),n.appendIfPresent(",udp-relay=".concat(e.udp),"udp"),n.toString()}(t);case"wireguard-surge":return function(e){var n=new _$utils_109.Result(e);return n.append("".concat(e.name,"=wireguard")),n.appendIfPresent(",section-name=".concat(e["section-name"]),"section-name"),n.toString()}(t)}throw new Error("Platform ".concat(__targetPlatform_105," does not support proxy type: ").concat(t.type))}}};var __targetPlatform_105="Surfboard";function __handleTransport_105(t,e){if((0,_$utils_109.isPresent)(e,"network")){if(e.network!=="ws")throw new Error("network ".concat(e.network," is unsupported"));if(t.append(",ws=true"),(0,_$utils_109.isPresent)(e,"ws-opts")&&(t.appendIfPresent(",ws-path=".concat(e["ws-opts"].path),"ws-opts.path"),(0,_$utils_109.isPresent)(e,"ws-opts.headers"))){var n=e["ws-opts"].headers,r=Object.keys(n).map(function(o){var f=n[o];return["Host"].includes(o)&&(f='"'.concat(f,'"')),"".concat(o,":").concat(f)}).join("|");(0,_$utils_141.isNotBlank)(r)&&t.append(",ws-headers=".concat(r))}}}var _$singBox_103={};Object.defineProperty(_$singBox_103,"__esModule",{value:!0}),_$singBox_103.default=function(){return{type:"ALL",produce:function(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=[];return(0,___clashmeta_103.default)().produce(t,"internal",{"include-unsupported-proxy":!0}).map(function(o){try{switch(o.type){case"ssh":r.push(sshParser(o));break;case"http":r.push(httpParser(o));break;case"socks5":if(o.tls)throw new Error("Platform sing-box does not support proxy type: ".concat(o.type," with tls"));r.push(socks5Parser(o));break;case"ss":if(o.plugin==="shadow-tls"){var f=shadowTLSParser(o),d=f.ssPart,h=f.stPart;r.push(d),r.push(h)}else r.push(ssParser(o));break;case"ssr":if(!n["include-unsupported-proxy"])throw new Error("Platform sing-box does not support proxy type: ".concat(o.type));r.push(ssrParser(o));break;case"vmess":if(o.network&&!["ws","grpc","h2","http"].includes(o.network))throw new Error("Platform sing-box does not support proxy type: ".concat(o.type," with network ").concat(o.network));r.push(vmessParser(o));break;case"vless":if(o.flow&&!["xtls-rprx-vision"].includes(o.flow))throw new Error("Platform sing-box does not support proxy type: ".concat(o.type," with flow ").concat(o.flow));r.push(vlessParser(o));break;case"trojan":if(o.flow)throw new Error("Platform sing-box does not support proxy type: ".concat(o.type," with flow ").concat(o.flow));r.push(trojanParser(o));break;case"hysteria":r.push(hysteriaParser(o));break;case"hysteria2":r.push(hysteria2Parser(o,n["include-unsupported-proxy"]));break;case"tuic":if(o.token&&o.token.length!==0)throw new Error("Platform sing-box does not support proxy type: TUIC v4");r.push(tuic5Parser(o));break;case"wireguard":r.push(wireguardParser(o));break;default:throw new Error("Platform sing-box does not support proxy type: ".concat(o.type))}}catch(F){var y;___app_103.default.error((y=F.message)!==null&&y!==void 0?y:F)}}),e==="internal"?r:JSON.stringify({outbounds:r},null,2)}}};var ___clashmeta_103=___interopRequireDefault_103(_$clashmeta_97),___app_103=___interopRequireDefault_103(_$app_87);function ___interopRequireDefault_103(t){return t&&t.__esModule?t:{default:t}}function ___slicedToArray_103(t,e){return function(n){if(Array.isArray(n))return n}(t)||function(n,r){var o=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(o!=null){var f,d,h=[],y=!0,F=!1;try{for(o=o.call(n);!(y=(f=o.next()).done)&&(h.push(f.value),!r||h.length!==r);y=!0);}catch(S){F=!0,d=S}finally{try{y||o.return==null||o.return()}finally{if(F)throw d}}return h}}(t,e)||___unsupportedIterableToArray_103(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ___createForOfIteratorHelper_103(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=___unsupportedIterableToArray_103(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){n=n.call(t)},n:function(){var y=n.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||n.return==null||n.return()}finally{if(h)throw f}}}}function ___unsupportedIterableToArray_103(t,e){if(t){if(typeof t=="string")return ___arrayLikeToArray_103(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?___arrayLikeToArray_103(t,e):void 0}}function ___arrayLikeToArray_103(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var detourParser=function(t,e){e.detour=t["dialer-proxy"]||t.detour},networkParser=function(t,e){["tcp","udp"].includes(t._network)&&(e.network=t._network)},tfoParser=function(t,e){e.tcp_fast_open=!1,t.tfo&&(e.tcp_fast_open=!0),t.tcp_fast_open&&(e.tcp_fast_open=!0),t["tcp-fast-open"]&&(e.tcp_fast_open=!0),e.tcp_fast_open||delete e.tcp_fast_open},smuxParser=function(t,e){t&&t.enabled&&(e.multiplex={enabled:!0},e.multiplex.protocol=t.protocol,t["max-connections"]&&(e.multiplex.max_connections=parseInt("".concat(t["max-connections"]),10)),t["max-streams"]&&(e.multiplex.max_streams=parseInt("".concat(t["max-streams"]),10)),t["min-streams"]&&(e.multiplex.min_streams=parseInt("".concat(t["min-streams"]),10)),t.padding&&(e.multiplex.padding=!0))},wsParser=function(t,e){var n={type:"ws",headers:{}};if(t["ws-opts"]){var r=t["ws-opts"],o=r.path,f=o===void 0?"":o,d=r.headers,h=d===void 0?{}:d;if(f!==""&&(n.path="".concat(f)),Object.keys(h).length>0){for(var y={},F=0,S=Object.keys(h);F<S.length;F++){var T=S[F],U=h[T];U!==""&&(Array.isArray(U)||(U=["".concat(U)]),U.length>0&&(y[T]=U))}var M=y.Host;if(M.length===1){var Y,Z=___createForOfIteratorHelper_103("Host:".concat(M[0]).split(`
`));try{for(Z.s();!(Y=Z.n()).done;){var D=___slicedToArray_103(Y.value.split(":"),2),nt=D[0],ct=D[1];ct.trim()!==""&&(y[nt.trim()]=ct.trim().split(","))}}catch(J){Z.e(J)}finally{Z.f()}}n.headers=y}}if(t["ws-headers"]){for(var at={},et=0,mt=Object.keys(t["ws-headers"]);et<mt.length;et++){var At=mt[et],dt=t["ws-headers"][At];dt!==""&&(Array.isArray(dt)||(dt=["".concat(dt)]),dt.length>0&&(at[At]=dt))}var ht=at.Host;if(ht.length===1){var xt,l=___createForOfIteratorHelper_103("Host:".concat(ht[0]).split(`
`));try{for(l.s();!(xt=l.n()).done;){var s=___slicedToArray_103(xt.value.split(":"),2),v=s[0],$=s[1];$.trim()!==""&&(at[v.trim()]=$.trim().split(","))}}catch(J){l.e(J)}finally{l.f()}}for(var E=0,rt=Object.keys(at);E<rt.length;E++){var gt=rt[E];n.headers[gt]=at[gt]}}if(t["ws-path"]&&t["ws-path"]!==""&&(n.path="".concat(t["ws-path"])),n.path){var Et=___slicedToArray_103(/^(.*?)(?:\?ed=(\d+))?$/.exec(n.path),3),Ct=(Et[0],Et[1]),x=Ct===void 0?"":Ct,N=Et[2],G=N===void 0?"":N;n.path=x,G!==""&&(n.early_data_header_name="Sec-WebSocket-Protocol",n.max_early_data=parseInt(G,10))}e.tls.insecure&&(e.tls.server_name=n.headers.Host[0]),t["ws-opts"]&&t["ws-opts"]["v2ray-http-upgrade"]&&(n.type="httpupgrade",n.headers.Host&&(n.host=n.headers.Host[0],delete n.headers.Host),n.max_early_data&&delete n.max_early_data,n.early_data_header_name&&delete n.early_data_header_name);for(var A=0,C=Object.keys(n.headers);A<C.length;A++){var j=C[A],K=n.headers[j];K.length===1&&(n.headers[j]=K[0])}e.transport=n},grpcParser=function(t,e){var n={type:"grpc"};if(t["grpc-opts"]){var r=t["grpc-opts"]["grpc-service-name"];r!=null&&r!==""&&(n.service_name="".concat(r))}e.transport=n},tlsParser=function(t,e){t.tls&&(e.tls.enabled=!0),t.servername&&t.servername!==""&&(e.tls.server_name=t.servername),t.peer&&t.peer!==""&&(e.tls.server_name=t.peer),t.sni&&t.sni!==""&&(e.tls.server_name=t.sni),t["skip-cert-verify"]&&(e.tls.insecure=!0),t.insecure&&(e.tls.insecure=!0),t["disable-sni"]&&(e.tls.disable_sni=!0),typeof t.alpn=="string"?e.tls.alpn=[t.alpn]:Array.isArray(t.alpn)&&(e.tls.alpn=t.alpn),t.ca&&(e.tls.certificate_path="".concat(t.ca)),t.ca_str&&(e.tls.certificate=[t.ca_str]),t["ca-str"]&&(e.tls.certificate=[t["ca-str"]]),t["reality-opts"]&&(e.tls.reality={enabled:!0},t["reality-opts"]["public-key"]&&(e.tls.reality.public_key=t["reality-opts"]["public-key"]),t["reality-opts"]["short-id"]&&(e.tls.reality.short_id=t["reality-opts"]["short-id"]),e.tls.utls={enabled:!0}),!["hysteria","hysteria2","tuic"].includes(t.type)&&t["client-fingerprint"]&&t["client-fingerprint"]!==""&&(e.tls.utls={enabled:!0,fingerprint:t["client-fingerprint"]}),e.tls.enabled||delete e.tls},sshParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"ssh",server:t.server,server_port:parseInt("".concat(t.port),10)};if(e.server_port<0||e.server_port>65535)throw"invalid port";return t.username&&(e.user=t.username),t.password&&(e.password=t.password),t.privateKey&&(e.private_key_path=t.privateKey),t["private-key"]&&(e.private_key_path=t["private-key"]),t["private-key-passphrase"]&&(e.private_key_passphrase=t["private-key-passphrase"]),t["server-fingerprint"]&&(e.host_key=[t["server-fingerprint"]],e.host_key_algorithms=[t["server-fingerprint"].split(" ")[0]]),t["host-key"]&&(e.host_key=t["host-key"]),t["host-key-algorithms"]&&(e.host_key_algorithms=t["host-key-algorithms"]),t["fast-open"]&&(e.udp_fragment=!0),tfoParser(t,e),detourParser(t,e),e},httpParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"http",server:t.server,server_port:parseInt("".concat(t.port),10),tls:{enabled:!1,server_name:t.server,insecure:!1}};if(e.server_port<0||e.server_port>65535)throw"invalid port";if(t.username&&(e.username=t.username),t.password&&(e.password=t.password),t.headers){e.headers={};for(var n=0,r=Object.keys(t.headers);n<r.length;n++){var o=r[n];e.headers[o]="".concat(t.headers[o])}Object.keys(e.headers).length===0&&delete e.headers}return t["fast-open"]&&(e.udp_fragment=!0),tfoParser(t,e),detourParser(t,e),tlsParser(t,e),e},socks5Parser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"socks",server:t.server,server_port:parseInt("".concat(t.port),10),password:t.password,version:"5"};if(e.server_port<0||e.server_port>65535)throw"invalid port";return t.username&&(e.username=t.username),t.password&&(e.password=t.password),t.uot&&(e.udp_over_tcp=!0),t["udp-over-tcp"]&&(e.udp_over_tcp=!0),t["fast-open"]&&(e.udp_fragment=!0),networkParser(t,e),tfoParser(t,e),detourParser(t,e),e},shadowTLSParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"shadowsocks",method:t.cipher,password:t.password,detour:"".concat(t.name,"_shadowtls")},n={tag:"".concat(t.name,"_shadowtls"),type:"shadowtls",server:t.server,server_port:parseInt("".concat(t.port),10),version:t["plugin-opts"].version,password:t["plugin-opts"].password,tls:{enabled:!0,server_name:t["plugin-opts"].host,utls:{enabled:!0,fingerprint:t["client-fingerprint"]}}};if(n.server_port<0||n.server_port>65535)throw"\u7AEF\u53E3\u503C\u975E\u6CD5";return t["fast-open"]===!0&&(n.udp_fragment=!0),tfoParser(t,n),detourParser(t,n),smuxParser(t.smux,e),{type:"ss-with-st",ssPart:e,stPart:n}},ssParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"shadowsocks",server:t.server,server_port:parseInt("".concat(t.port),10),method:t.cipher,password:t.password};if(e.server_port<0||e.server_port>65535)throw"invalid port";if(t.uot&&(e.udp_over_tcp=!0),t["udp-over-tcp"]&&(e.udp_over_tcp=!0),t["fast-open"]&&(e.udp_fragment=!0),networkParser(t,e),tfoParser(t,e),detourParser(t,e),smuxParser(t.smux,e),t.plugin){var n=[];t.plugin==="obfs"&&(e.plugin="obfs-local",e.plugin_opts="",t["obfs-host"]&&(t["plugin-opts"].host=t["obfs-host"]),Object.keys(t["plugin-opts"]).forEach(function(r){switch(r){case"mode":n.push("obfs=".concat(t["plugin-opts"].mode));break;case"host":n.push("obfs-host=".concat(t["plugin-opts"].host));break;default:n.push("".concat(r,"=").concat(t["plugin-opts"][r]))}})),t.plugin==="v2ray-plugin"&&(e.plugin="v2ray-plugin",t["ws-host"]&&(t["plugin-opts"].host=t["ws-host"]),t["ws-path"]&&(t["plugin-opts"].path=t["ws-path"]),Object.keys(t["plugin-opts"]).forEach(function(r){switch(r){case"tls":t["plugin-opts"].tls&&n.push("tls");break;case"host":n.push("host=".concat(t["plugin-opts"].host));break;case"path":n.push("path=".concat(t["plugin-opts"].path));break;case"headers":n.push("headers=".concat(JSON.stringify(t["plugin-opts"].headers)));break;case"mux":t["plugin-opts"].mux&&(e.multiplex={enabled:!0});break;default:n.push("".concat(r,"=").concat(t["plugin-opts"][r]))}})),e.plugin_opts=n.join(";")}return e},ssrParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"shadowsocksr",server:t.server,server_port:parseInt("".concat(t.port),10),method:t.cipher,password:t.password,obfs:t.obfs,protocol:t.protocol};if(e.server_port<0||e.server_port>65535)throw"invalid port";return t["obfs-param"]&&(e.obfs_param=t["obfs-param"]),t["protocol-param"]&&t["protocol-param"]!==""&&(e.protocol_param=t["protocol-param"]),t["fast-open"]&&(e.udp_fragment=!0),tfoParser(t,e),detourParser(t,e),smuxParser(t.smux,e),e},vmessParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"vmess",server:t.server,server_port:parseInt("".concat(t.port),10),uuid:t.uuid,security:t.cipher,alter_id:parseInt("".concat(t.alterId),10),tls:{enabled:!1,server_name:t.server,insecure:!1}};if(["auto","none","zero","aes-128-gcm","chacha20-poly1305","aes-128-ctr"].indexOf(e.security)===-1&&(e.security="auto"),e.server_port<0||e.server_port>65535)throw"invalid port";return t.xudp&&(e.packet_encoding="xudp"),t["fast-open"]&&(e.udp_fragment=!0),t.network==="ws"&&wsParser(t,e),t.network==="h2"&&function(n,r){var o={type:"http"};if(n["h2-opts"]){var f=n["h2-opts"],d=f.host,h=d===void 0?"":d,y=f.path,F=y===void 0?"":y;F!==""&&(o.path="".concat(F)),h!==""&&(Array.isArray(h)||(h="".concat(h).split(",").map(function(T){return T.trim()})),h.length>0&&(o.host=h))}if(n["h2-host"]&&n["h2-host"]!==""){var S=n["h2-host"];Array.isArray(S)||(S="".concat(S).split(",").map(function(T){return T.trim()})),S.length>0&&(o.host=S)}n["h2-path"]&&n["h2-path"]!==""&&(o.path="".concat(n["h2-path"])),r.tls.enabled=!0,r.tls.insecure&&(r.tls.server_name=o.host[0]),o.host.length===1&&(o.host=o.host[0]),r.transport=o}(t,e),t.network==="http"&&function(n,r){var o={type:"http",headers:{}};if(n["http-opts"]){var f=n["http-opts"],d=f.method,h=d===void 0?"":d,y=f.path,F=y===void 0?"":y,S=f.headers,T=S===void 0?{}:S;h!==""&&(o.method=h),Array.isArray(F)?o.path="".concat(F[0]):F!==""&&(o.path="".concat(F));for(var U=0,M=Object.keys(T);U<M.length;U++){var Y=M[U],Z=T[Y];if(Z!=="")if(Y.toLowerCase()!=="host")Array.isArray(Z)||(Z="".concat(Z).split(",").map(function(dt){return dt.trim()})),Z.length>0&&(o.headers[Y]=Z);else{var D=Z;Array.isArray(D)||(D="".concat(D).split(",").map(function(dt){return dt.trim()})),D.length>0&&(o.host=D)}}}if(n["http-host"]&&n["http-host"]!==""){var nt=n["http-host"];Array.isArray(nt)||(nt="".concat(nt).split(",").map(function(dt){return dt.trim()})),nt.length>0&&(o.host=nt)}if(o.host){if(n["http-path"]&&n["http-path"]!==""){var ct=n["http-path"];Array.isArray(ct)?o.path="".concat(ct[0]):ct!==""&&(o.path="".concat(ct))}r.tls.insecure&&(r.tls.server_name=o.host[0]),o.host.length===1&&(o.host=o.host[0]);for(var at=0,et=Object.keys(o.headers);at<et.length;at++){var mt=et[at],At=o.headers[mt];At.length===1&&(o.headers[mt]=At[0])}r.transport=o}}(t,e),t.network==="grpc"&&grpcParser(t,e),networkParser(t,e),tfoParser(t,e),detourParser(t,e),tlsParser(t,e),smuxParser(t.smux,e),e},vlessParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"vless",server:t.server,server_port:parseInt("".concat(t.port),10),uuid:t.uuid,tls:{enabled:!1,server_name:t.server,insecure:!1}};if(e.server_port<0||e.server_port>65535)throw"invalid port";return t["fast-open"]&&(e.udp_fragment=!0),t.flow==="xtls-rprx-vision"&&(e.flow=t.flow),t.network==="ws"&&wsParser(t,e),t.network==="grpc"&&grpcParser(t,e),networkParser(t,e),tfoParser(t,e),detourParser(t,e),smuxParser(t.smux,e),tlsParser(t,e),e},trojanParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"trojan",server:t.server,server_port:parseInt("".concat(t.port),10),password:t.password,tls:{enabled:!0,server_name:t.server,insecure:!1}};if(e.server_port<0||e.server_port>65535)throw"invalid port";return t["fast-open"]&&(e.udp_fragment=!0),t.network==="grpc"&&grpcParser(t,e),t.network==="ws"&&wsParser(t,e),networkParser(t,e),tfoParser(t,e),detourParser(t,e),tlsParser(t,e),smuxParser(t.smux,e),e},hysteriaParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"hysteria",server:t.server,server_port:parseInt("".concat(t.port),10),disable_mtu_discovery:!1,tls:{enabled:!0,server_name:t.server,insecure:!1}};if(e.server_port<0||e.server_port>65535)throw"invalid port";t.auth_str&&(e.auth_str="".concat(t.auth_str)),t["auth-str"]&&(e.auth_str="".concat(t["auth-str"])),t["fast-open"]&&(e.udp_fragment=!0);var n=new RegExp("^[0-9]+[ 	]*[KMGT]*[Bb]ps$");return n.test("".concat(t.up))?e.up="".concat(t.up):e.up_mbps=parseInt("".concat(t.up),10),n.test("".concat(t.down))?e.down="".concat(t.down):e.down_mbps=parseInt("".concat(t.down),10),t.obfs&&(e.obfs=t.obfs),t.recv_window_conn&&(e.recv_window_conn=t.recv_window_conn),t["recv-window-conn"]&&(e.recv_window_conn=t["recv-window-conn"]),t.recv_window&&(e.recv_window=t.recv_window),t["recv-window"]&&(e.recv_window=t["recv-window"]),t.disable_mtu_discovery&&(typeof t.disable_mtu_discovery=="boolean"?e.disable_mtu_discovery=t.disable_mtu_discovery:t.disable_mtu_discovery===1&&(e.disable_mtu_discovery=!0)),networkParser(t,e),tlsParser(t,e),detourParser(t,e),tfoParser(t,e),smuxParser(t.smux,e),e},hysteria2Parser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n={tag:t.name,type:"hysteria2",server:t.server,server_port:parseInt("".concat(t.port),10),password:t.password,obfs:{},tls:{enabled:!0,server_name:t.server,insecure:!1}};if(n.server_port<0||n.server_port>65535)throw"invalid port";return e&&(t["hop-interval"]&&(n.hop_interval=/^\d+$/.test(t["hop-interval"])?"".concat(t["hop-interval"],"s"):t["hop-interval"]),t.ports&&(n.server_ports=t.ports.split(/\s*,\s*/).map(function(r){return r.replace(/\s*-\s*/g,":")}))),t.up&&(n.up_mbps=parseInt("".concat(t.up),10)),t.down&&(n.down_mbps=parseInt("".concat(t.down),10)),t.obfs==="salamander"&&(n.obfs.type="salamander"),t["obfs-password"]&&(n.obfs.password=t["obfs-password"]),n.obfs.type||delete n.obfs,networkParser(t,n),tlsParser(t,n),tfoParser(t,n),detourParser(t,n),smuxParser(t.smux,n),n},tuic5Parser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"tuic",server:t.server,server_port:parseInt("".concat(t.port),10),uuid:t.uuid,password:t.password,tls:{enabled:!0,server_name:t.server,insecure:!1}};if(e.server_port<0||e.server_port>65535)throw"invalid port";return t["fast-open"]&&(e.udp_fragment=!0),t["congestion-controller"]&&t["congestion-controller"]!=="cubic"&&(e.congestion_control=t["congestion-controller"]),t["udp-relay-mode"]&&t["udp-relay-mode"]!=="native"&&(e.udp_relay_mode=t["udp-relay-mode"]),t["reduce-rtt"]&&(e.zero_rtt_handshake=!0),t["udp-over-stream"]&&(e.udp_over_stream=!0),t["heartbeat-interval"]&&(e.heartbeat="".concat(t["heartbeat-interval"],"ms")),networkParser(t,e),tfoParser(t,e),detourParser(t,e),tlsParser(t,e),smuxParser(t.smux,e),e},wireguardParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=["ip","ipv6"].map(function(M){return t[M]}).map(function(M){return(0,_$utils_141.isIPv4)(M)?"".concat(M,"/32"):(0,_$utils_141.isIPv6)(M)?"".concat(M,"/128"):void 0}).filter(function(M){return M}),n={tag:t.name,type:"wireguard",server:t.server,server_port:parseInt("".concat(t.port),10),local_address:e,private_key:t["private-key"],peer_public_key:t["public-key"],pre_shared_key:t["pre-shared-key"],reserved:[]};if(n.server_port<0||n.server_port>65535)throw"invalid port";if(t["fast-open"]&&(n.udp_fragment=!0),typeof t.reserved=="string")n.reserved=t.reserved;else if(Array.isArray(t.reserved)){var r,o=___createForOfIteratorHelper_103(t.reserved);try{for(o.s();!(r=o.n()).done;){var f=r.value;n.reserved.push(f)}}catch(M){o.e(M)}finally{o.f()}}else delete n.reserved;if(t.peers&&t.peers.length>0){n.peers=[];var d,h=___createForOfIteratorHelper_103(t.peers);try{for(h.s();!(d=h.n()).done;){var y=d.value,F={server:y.server,server_port:parseInt("".concat(y.port),10),public_key:y["public-key"],allowed_ips:y["allowed-ips"]||y.allowed_ips,reserved:[]};if(typeof y.reserved=="string")F.reserved.push(y.reserved);else if(Array.isArray(y.reserved)){var S,T=___createForOfIteratorHelper_103(y.reserved);try{for(T.s();!(S=T.n()).done;){var U=S.value;F.reserved.push(U)}}catch(M){T.e(M)}finally{T.f()}}else delete F.reserved;y["pre-shared-key"]&&(F.pre_shared_key=y["pre-shared-key"]),n.peers.push(F)}}catch(M){h.e(M)}finally{h.f()}}return networkParser(t,n),tfoParser(t,n),detourParser(t,n),smuxParser(t.smux,n),n},_$egern_98={};function __ownKeys_98(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function ___objectSpread_98(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_98(Object(n),!0).forEach(function(r){___defineProperty_98(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):__ownKeys_98(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ___defineProperty_98(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ___arrayLikeToArray_98(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}Object.defineProperty(_$egern_98,"__esModule",{value:!0}),_$egern_98.default=function(){return{type:"ALL",produce:function(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=t.filter(function(o){var f,d;return!(!["http","socks5","ss","trojan","hysteria2","vless","vmess"].includes(o.type)||o.type==="ss"&&(o.plugin==="obfs"&&!["http","tls"].includes((f=o["plugin-opts"])===null||f===void 0?void 0:f.mode)||!["chacha20-ietf-poly1305","chacha20-poly1305","aes-256-gcm","aes-128-gcm","none","tbale","rc4","rc4-md5","aes-128-cfb","aes-192-cfb","aes-256-cfb","aes-128-ctr","aes-192-ctr","aes-256-ctr","bf-cfb","camellia-128-cfb","camellia-192-cfb","camellia-256-cfb","cast5-cfb","des-cfb","idea-cfb","rc2-cfb","seed-cfb","salsa20","chacha20","chacha20-ietf"].concat((d=n["include-unsupported-proxy"]?["2022-blake3-aes-128-gcm","2022-blake3-aes-256-gcm"]:[],function(h){if(Array.isArray(h))return ___arrayLikeToArray_98(h)}(d)||function(h){if(typeof Symbol<"u"&&h[Symbol.iterator]!=null||h["@@iterator"]!=null)return Array.from(h)}(d)||function(h,y){if(h){if(typeof h=="string")return ___arrayLikeToArray_98(h,void 0);var F=Object.prototype.toString.call(h).slice(8,-1);return F==="Object"&&h.constructor&&(F=h.constructor.name),F==="Map"||F==="Set"?Array.from(h):F==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(F)?___arrayLikeToArray_98(h,void 0):void 0}}(d)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}())).includes(o.cipher))||o.type==="vmess"&&(!["auto","aes-128-gcm","chacha20-poly1305","none","zero"].includes(o.cipher)||!["http","ws","tcp"].includes(o.network)&&o.network)||o.type==="trojan"&&!["http","ws","tcp"].includes(o.network)&&o.network||o.type==="vless"&&(o.flow!==void 0||o["reality-opts"]||!["http","ws","tcp"].includes(o.network)&&o.network))}).map(function(o){o.tls&&!o.sni&&(o.sni=o.server);var f=o.prev_hop||o["underlying-proxy"]||o["dialer-proxy"]||o.detour;if(o.type==="http")o={type:"http",name:o.name,server:o.server,port:o.port,username:o.username,password:o.password,tfo:o.tfo||o["fast-open"],next_hop:o.next_hop};else if(o.type==="socks5")o={type:"socks5",name:o.name,server:o.server,port:o.port,username:o.username,password:o.password,tfo:o.tfo||o["fast-open"],udp_relay:o.udp||o.udp_relay||o.udp_relay,next_hop:o.next_hop};else if(o.type==="ss")(o={type:"shadowsocks",name:o.name,method:o.cipher==="chacha20-ietf-poly1305"?"chacha20-poly1305":o.cipher,server:o.server,port:o.port,password:o.password,tfo:o.tfo||o["fast-open"],udp_relay:o.udp||o.udp_relay||o.udp_relay,next_hop:o.next_hop}).plugin==="obfs"&&(o.obfs=o["plugin-opts"].mode,o.obfs_host=o["plugin-opts"].host,o.obfs_uri=o["plugin-opts"].path);else if(o.type==="hysteria2")(o={type:"hysteria2",name:o.name,server:o.server,port:o.port,auth:o.password,tfo:o.tfo||o["fast-open"],udp_relay:o.udp||o.udp_relay||o.udp_relay,next_hop:o.next_hop,sni:o.sni,skip_tls_verify:o["skip-cert-verify"],port_hopping:o.ports,port_hopping_interval:o["hop-interval"]})["obfs-password"]&&o.obfs=="salamander"&&(o.obfs="salamander",o.obfs_password=o["obfs-password"]);else if(o.type==="trojan"){var d,h,y;o.network==="ws"&&(o.websocket={path:(d=o["ws-opts"])===null||d===void 0?void 0:d.path,host:(h=o["ws-opts"])===null||h===void 0||(y=h.headers)===null||y===void 0?void 0:y.Host}),o={type:"trojan",name:o.name,server:o.server,port:o.port,password:o.password,tfo:o.tfo||o["fast-open"],udp_relay:o.udp||o.udp_relay||o.udp_relay,next_hop:o.next_hop,sni:o.sni,skip_tls_verify:o["skip-cert-verify"],websocket:o.websocket}}else if(o.type==="vmess"){var F,S,T;if(o.network==="ws")o.transport=___defineProperty_98({},o.tls?"wss":"ws",{path:(F=o["ws-opts"])===null||F===void 0?void 0:F.path,headers:{Host:(S=o["ws-opts"])===null||S===void 0||(T=S.headers)===null||T===void 0?void 0:T.Host},sni:o.tls?o.sni:void 0,skip_tls_verify:o.tls?o["skip-cert-verify"]:void 0});else if(o.network==="http"){var U,M,Y,Z,D,nt,ct,at;o.transport={http:{method:(U=o["http-opts"])===null||U===void 0?void 0:U.method,path:(M=o["http-opts"])===null||M===void 0?void 0:M.path,headers:{Host:Array.isArray((Y=o["http-opts"])===null||Y===void 0||(Z=Y.headers)===null||Z===void 0?void 0:Z.Host)?(D=o["http-opts"])===null||D===void 0||(nt=D.headers)===null||nt===void 0?void 0:nt.Host[0]:(ct=o["http-opts"])===null||ct===void 0||(at=ct.headers)===null||at===void 0?void 0:at.Host},skip_tls_verify:o["skip-cert-verify"]}}}else o.network!=="tcp"&&o.network||(o.transport=___defineProperty_98({},o.tls?"tls":"tcp",{sni:o.tls?o.sni:void 0,skip_tls_verify:o.tls?o["skip-cert-verify"]:void 0}));o={type:"vmess",name:o.name,server:o.server,port:o.port,user_id:o.uuid,security:o.cipher,tfo:o.tfo||o["fast-open"],legacy:o.legacy,udp_relay:o.udp||o.udp_relay||o.udp_relay,next_hop:o.next_hop,transport:o.transport}}else if(o.type==="vless"){var et,mt,At;if(o.network==="ws")o.transport=___defineProperty_98({},o.tls?"wss":"ws",{path:(et=o["ws-opts"])===null||et===void 0?void 0:et.path,headers:{Host:(mt=o["ws-opts"])===null||mt===void 0||(At=mt.headers)===null||At===void 0?void 0:At.Host},sni:o.tls?o.sni:void 0,skip_tls_verify:o.tls?o["skip-cert-verify"]:void 0});else if(o.network==="http"){var dt,ht,xt,l,s,v,$,E;o.transport={http:{method:(dt=o["http-opts"])===null||dt===void 0?void 0:dt.method,path:(ht=o["http-opts"])===null||ht===void 0?void 0:ht.path,headers:{Host:Array.isArray((xt=o["http-opts"])===null||xt===void 0||(l=xt.headers)===null||l===void 0?void 0:l.Host)?(s=o["http-opts"])===null||s===void 0||(v=s.headers)===null||v===void 0?void 0:v.Host[0]:($=o["http-opts"])===null||$===void 0||(E=$.headers)===null||E===void 0?void 0:E.Host},skip_tls_verify:o["skip-cert-verify"]}}}else o.network!=="tcp"&&o.network||(o.transport=___defineProperty_98({},o.tls?"tls":"tcp",{sni:o.tls?o.sni:void 0,skip_tls_verify:o.tls?o["skip-cert-verify"]:void 0}));o={type:"vless",name:o.name,server:o.server,port:o.port,user_id:o.uuid,security:o.cipher,tfo:o.tfo||o["fast-open"],legacy:o.legacy,udp_relay:o.udp||o.udp_relay||o.udp_relay,next_hop:o.next_hop,transport:o.transport}}if(delete o.subName,delete o.collectionName,delete o.id,delete o.resolved,delete o["no-resolve"],e!=="internal")for(var rt in o)(o[rt]==null||/^_/i.test(rt))&&delete o[rt];return ___defineProperty_98({},o.type,___objectSpread_98(___objectSpread_98({},o),{},{type:void 0,prev_hop:f}))});return e==="internal"?r:`proxies:
`+r.map(function(o){return"  - "+JSON.stringify(o)+`
`}).join("")}}};var _$producers_99={};Object.defineProperty(_$producers_99,"__esModule",{value:!0}),_$producers_99.default=void 0;var ___surge_99=___interopRequireDefault_99(_$surge_106),_surgemac=___interopRequireDefault_99(_$surgemac_107),_clash=___interopRequireDefault_99(_$clash_96),___clashmeta_99=___interopRequireDefault_99(_$clashmeta_97),_stash=___interopRequireDefault_99(_$stash_104),_loon=___interopRequireDefault_99(_$loon_100),___uri_99=___interopRequireDefault_99(_$uri_108),_v2ray=___interopRequireDefault_99(_$v2ray_110),_qx=___interopRequireDefault_99(_$qx_101),_shadowrocket=___interopRequireDefault_99(_$shadowrocket_102),_surfboard=___interopRequireDefault_99(_$surfboard_105),_singBox=___interopRequireDefault_99(_$singBox_103),_egern=___interopRequireDefault_99(_$egern_98);function ___interopRequireDefault_99(t){return t&&t.__esModule?t:{default:t}}function JSON_Producer(){return{type:"ALL",produce:function(t,e){return e==="internal"?t:JSON.stringify(t,null,2)}}}var ___default_99={qx:(0,_qx.default)(),QX:(0,_qx.default)(),QuantumultX:(0,_qx.default)(),surge:(0,___surge_99.default)(),Surge:(0,___surge_99.default)(),SurgeMac:(0,_surgemac.default)(),Loon:(0,_loon.default)(),Clash:(0,_clash.default)(),meta:(0,___clashmeta_99.default)(),clashmeta:(0,___clashmeta_99.default)(),"clash.meta":(0,___clashmeta_99.default)(),"Clash.Meta":(0,___clashmeta_99.default)(),ClashMeta:(0,___clashmeta_99.default)(),mihomo:(0,___clashmeta_99.default)(),Mihomo:(0,___clashmeta_99.default)(),uri:(0,___uri_99.default)(),URI:(0,___uri_99.default)(),v2:(0,_v2ray.default)(),v2ray:(0,_v2ray.default)(),V2Ray:(0,_v2ray.default)(),json:JSON_Producer(),JSON:JSON_Producer(),stash:(0,_stash.default)(),Stash:(0,_stash.default)(),shadowrocket:(0,_shadowrocket.default)(),Shadowrocket:(0,_shadowrocket.default)(),ShadowRocket:(0,_shadowrocket.default)(),surfboard:(0,_surfboard.default)(),Surfboard:(0,_surfboard.default)(),singbox:(0,_singBox.default)(),"sing-box":(0,_singBox.default)(),egern:(0,_egern.default)(),Egern:(0,_egern.default)()};_$producers_99.default=___default_99;const setProtoOf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])};class GrammarError extends Error{constructor(e,n,r){super(e),setProtoOf(this,GrammarError.prototype),this.name="GrammarError",this.location=n,r===void 0&&(r=[]),this.diagnostics=r,this.stage=null,this.problems=[["error",e,n,r]]}toString(){let e=super.toString();this.location&&(e+=`
 at `,this.location.source!==void 0&&this.location.source!==null&&(e+=this.location.source+":"),e+=`${this.location.start.line}:${this.location.start.column}`);for(const n of this.diagnostics)e+=`
 from `,n.location.source!==void 0&&n.location.source!==null&&(e+=n.location.source+":"),e+=`${n.location.start.line}:${n.location.start.column}: ${n.message}`;return e}format(e){const n=e.map(({source:o,text:f})=>({source:o,text:f.split(/\r\n|\n|\r/g)}));function r(o,f,d=""){let h="";const y=n.find(({source:S})=>S===o.source),F=o.start;if(y){const S=o.end,T=y.text[F.line-1],U=(F.line===S.line?S.column:T.length+1)-F.column||1;d&&(h+=`
note: `+d),h+=`
 --> ${o.source}:${F.line}:${F.column}
${"".padEnd(f)} |
${F.line.toString().padStart(f)} | ${T}
${"".padEnd(f)} | ${"".padEnd(F.column-1)}${"".padEnd(U,"^")}`}else h+=`
 at ${o.source}:${F.line}:${F.column}`,d&&(h+=": "+d);return h}return this.problems.filter(o=>o[0]!=="info").map(o=>function(f,d,h,y=[]){let F;F=(F=h?y.reduce((T,{location:U})=>Math.max(T,U.start.line),h.start.line):Math.max.apply(null,y.map(T=>T.location.start.line))).toString().length;let S=`${f}: ${d}`;h&&(S+=r(h,F));for(const T of y)S+=r(T.location,F,T.message);return S}(...o)).join(`

`)}}var _$GrammarError_71=GrammarError;const visitor={build(t){function e(d,...h){return t[d.type](d,...h)}function n(){}function r(d,...h){return e(d.expression,...h)}function o(d){return function(h,...y){h[d].forEach(F=>e(F,...y))}}const f={grammar(d,...h){d.topLevelInitializer&&e(d.topLevelInitializer,...h),d.initializer&&e(d.initializer,...h),d.rules.forEach(y=>e(y,...h))},top_level_initializer:n,initializer:n,rule:r,named:r,choice:o("alternatives"),action:r,sequence:o("elements"),labeled:r,text:r,simple_and:r,simple_not:r,optional:r,zero_or_more:r,one_or_more:r,group:r,semantic_and:n,semantic_not:n,rule_ref:n,literal:n,class:n,any:n};return Object.keys(f).forEach(d=>{Object.prototype.hasOwnProperty.call(t,d)||(t[d]=f[d])}),e}};var _$visitor_70=visitor;const asts={findRule(t,e){for(let n=0;n<t.rules.length;n++)if(t.rules[n].name===e)return t.rules[n]},indexOfRule(t,e){for(let n=0;n<t.rules.length;n++)if(t.rules[n].name===e)return n;return-1},alwaysConsumesOnSuccess(t,e){function n(){return!0}function r(){return!1}const o=_$visitor_70.build({choice:f=>f.alternatives.every(o),sequence:f=>f.elements.some(o),simple_and:r,simple_not:r,optional:r,zero_or_more:r,semantic_and:r,semantic_not:r,rule_ref(f){const d=asts.findRule(t,f.name);return d?o(d):void 0},literal:f=>f.value!=="",class:n,any:n});return o(e)}};var _$asts_54=asts,_$opcodes_56={PUSH:0,PUSH_EMPTY_STRING:35,PUSH_UNDEFINED:1,PUSH_NULL:2,PUSH_FAILED:3,PUSH_EMPTY_ARRAY:4,PUSH_CURR_POS:5,POP:6,POP_CURR_POS:7,POP_N:8,NIP:9,APPEND:10,WRAP:11,TEXT:12,PLUCK:36,IF:13,IF_ERROR:14,IF_NOT_ERROR:15,WHILE_NOT_ERROR:16,MATCH_ANY:17,MATCH_STRING:18,MATCH_STRING_IC:19,MATCH_CHAR_CLASS:20,MATCH_REGEXP:20,ACCEPT_N:21,ACCEPT_STRING:22,FAIL:23,LOAD_SAVED_POS:24,UPDATE_SAVED_POS:25,CALL:26,RULE:27,SILENT_FAILS_ON:28,SILENT_FAILS_OFF:29},_$inferenceMatchResult_59={};const ALWAYS_MATCH=1,SOMETIMES_MATCH=0,NEVER_MATCH=-1;function inferenceMatchResult(t){function e(d){return d.match=SOMETIMES_MATCH}function n(d){return f(d.expression),d.match=ALWAYS_MATCH}function r(d){return d.match=f(d.expression)}function o(d,h){const y=d.length;let F=0,S=0;for(let T=0;T<y;++T){const U=f(d[T]);U===ALWAYS_MATCH&&++F,U===NEVER_MATCH&&++S}return F===y?ALWAYS_MATCH:h?S===y?NEVER_MATCH:SOMETIMES_MATCH:S>0?NEVER_MATCH:SOMETIMES_MATCH}const f=_$visitor_70.build({rule(d){let h,y=0;if(d.match===void 0){d.match=SOMETIMES_MATCH;do if(h=d.match,d.match=f(d.expression),++y>6)throw new _$GrammarError_71("Infinity cycle detected when trying to evaluate node match result",d.location);while(h!==d.match)}return d.match},named:r,choice:d=>d.match=o(d.alternatives,!0),action:r,sequence:d=>d.match=o(d.elements,!1),labeled:r,text:r,simple_and:r,simple_not:d=>d.match=-f(d.expression),optional:n,zero_or_more:n,one_or_more:r,group:r,semantic_and:e,semantic_not:e,rule_ref(d){const h=_$asts_54.findRule(t,d.name);return d.match=f(h)},literal(d){const h=d.value.length===0?ALWAYS_MATCH:SOMETIMES_MATCH;return d.match=h},class(d){const h=d.parts.length===0?NEVER_MATCH:SOMETIMES_MATCH;return d.match=h},any:e});f(t)}inferenceMatchResult.ALWAYS_MATCH=ALWAYS_MATCH,inferenceMatchResult.SOMETIMES_MATCH=SOMETIMES_MATCH,inferenceMatchResult.NEVER_MATCH=NEVER_MATCH,_$inferenceMatchResult_59=inferenceMatchResult;const{ALWAYS_MATCH:__ALWAYS_MATCH_57,SOMETIMES_MATCH:__SOMETIMES_MATCH_57,NEVER_MATCH:__NEVER_MATCH_57}=_$inferenceMatchResult_59;var _$generateBytecode_57=function(t){const e=[],n=[],r=[],o=[];function f(Z){const D=JSON.stringify(Z),nt=r.findIndex(ct=>JSON.stringify(ct)===D);return nt===-1?r.push(Z)-1:nt}function d(Z,D,nt){const ct={predicate:Z,params:D,body:nt.code,location:nt.codeLocation},at=JSON.stringify(ct),et=o.findIndex(mt=>JSON.stringify(mt)===at);return et===-1?o.push(ct)-1:et}function h(Z){const D={};return Object.keys(Z).forEach(nt=>{D[nt]=Z[nt]}),D}function y(Z,...D){return Z.concat(...D)}function F(Z,D,nt,ct){return Z===__ALWAYS_MATCH_57?nt:Z===__NEVER_MATCH_57?ct:D.concat([nt.length,ct.length],nt,ct)}function S(Z,D,nt,ct){const at=Object.keys(nt).map(et=>ct-nt[et]);return[_$opcodes_56.CALL,Z,D,at.length].concat(at)}function T(Z,D,nt){const ct=0|Z.match;return y([_$opcodes_56.PUSH_CURR_POS],[_$opcodes_56.SILENT_FAILS_ON],Y(Z,{sp:nt.sp+1,env:h(nt.env),action:null}),[_$opcodes_56.SILENT_FAILS_OFF],F(D?-ct:ct,[D?_$opcodes_56.IF_ERROR:_$opcodes_56.IF_NOT_ERROR],y([_$opcodes_56.POP],[D?_$opcodes_56.POP:_$opcodes_56.POP_CURR_POS],[_$opcodes_56.PUSH_UNDEFINED]),y([_$opcodes_56.POP],[D?_$opcodes_56.POP_CURR_POS:_$opcodes_56.POP],[_$opcodes_56.PUSH_FAILED])))}function U(Z,D,nt){const ct=d(!0,Object.keys(nt.env),Z);return y([_$opcodes_56.UPDATE_SAVED_POS],S(ct,0,nt.env,nt.sp),F(0|Z.match,[_$opcodes_56.IF],y([_$opcodes_56.POP],D?[_$opcodes_56.PUSH_FAILED]:[_$opcodes_56.PUSH_UNDEFINED]),y([_$opcodes_56.POP],D?[_$opcodes_56.PUSH_UNDEFINED]:[_$opcodes_56.PUSH_FAILED])))}function M(Z){return D=[_$opcodes_56.WHILE_NOT_ERROR],nt=y([_$opcodes_56.APPEND],Z),D.concat([nt.length],nt);var D,nt}const Y=_$visitor_70.build({grammar(Z){Z.rules.forEach(Y),Z.literals=e,Z.classes=n,Z.expectations=r,Z.functions=o},rule(Z){Z.bytecode=Y(Z.expression,{sp:-1,env:{},pluck:[],action:null})},named(Z,D){const nt=0|Z.match,ct=nt===__NEVER_MATCH_57?null:f({type:"rule",value:Z.name});return y([_$opcodes_56.SILENT_FAILS_ON],Y(Z.expression,D),[_$opcodes_56.SILENT_FAILS_OFF],F(nt,[_$opcodes_56.IF_ERROR],[_$opcodes_56.FAIL,ct],[]))},choice:(Z,D)=>function nt(ct,at){const et=0|ct[0].match,mt=Y(ct[0],{sp:at.sp,env:h(at.env),action:null});return et===__ALWAYS_MATCH_57?mt:y(mt,ct.length>1?F(__SOMETIMES_MATCH_57,[_$opcodes_56.IF_ERROR],y([_$opcodes_56.POP],nt(ct.slice(1),at)),[]):[])}(Z.alternatives,D),action(Z,D){const nt=h(D.env),ct=Z.expression.type!=="sequence"||Z.expression.elements.length===0,at=Y(Z.expression,{sp:D.sp+(ct?1:0),env:nt,action:Z}),et=0|Z.expression.match,mt=ct&&et!==__NEVER_MATCH_57?d(!1,Object.keys(nt),Z):null;return ct?y([_$opcodes_56.PUSH_CURR_POS],at,F(et,[_$opcodes_56.IF_NOT_ERROR],y([_$opcodes_56.LOAD_SAVED_POS,1],S(mt,1,nt,D.sp+2)),[]),[_$opcodes_56.NIP]):at},sequence:(Z,D)=>y([_$opcodes_56.PUSH_CURR_POS],function nt(ct,at){if(ct.length>0){const et=Z.elements.length-ct.length+1;return y(Y(ct[0],{sp:at.sp,env:at.env,pluck:at.pluck,action:null}),F(0|ct[0].match,[_$opcodes_56.IF_NOT_ERROR],nt(ct.slice(1),{sp:at.sp+1,env:at.env,pluck:at.pluck,action:at.action}),y(et>1?[_$opcodes_56.POP_N,et]:[_$opcodes_56.POP],[_$opcodes_56.POP_CURR_POS],[_$opcodes_56.PUSH_FAILED])))}if(at.pluck.length>0)return y([_$opcodes_56.PLUCK,Z.elements.length+1,at.pluck.length],at.pluck.map(et=>at.sp-et));if(at.action){const et=d(!1,Object.keys(at.env),at.action);return y([_$opcodes_56.LOAD_SAVED_POS,Z.elements.length],S(et,Z.elements.length+1,at.env,at.sp))}return y([_$opcodes_56.WRAP,Z.elements.length],[_$opcodes_56.NIP])}(Z.elements,{sp:D.sp+1,env:D.env,pluck:[],action:D.action})),labeled(Z,D){let nt=D.env;const ct=Z.label,at=D.sp+1;return ct&&(nt=h(D.env),D.env[Z.label]=at),Z.pick&&D.pluck.push(at),Y(Z.expression,{sp:D.sp,env:nt,action:null})},text:(Z,D)=>y([_$opcodes_56.PUSH_CURR_POS],Y(Z.expression,{sp:D.sp+1,env:h(D.env),action:null}),F(0|Z.match,[_$opcodes_56.IF_NOT_ERROR],y([_$opcodes_56.POP],[_$opcodes_56.TEXT]),[_$opcodes_56.NIP])),simple_and:(Z,D)=>T(Z.expression,!1,D),simple_not:(Z,D)=>T(Z.expression,!0,D),optional:(Z,D)=>y(Y(Z.expression,{sp:D.sp,env:h(D.env),action:null}),F(-(0|Z.expression.match),[_$opcodes_56.IF_ERROR],y([_$opcodes_56.POP],[_$opcodes_56.PUSH_NULL]),[])),zero_or_more(Z,D){const nt=Y(Z.expression,{sp:D.sp+1,env:h(D.env),action:null});return y([_$opcodes_56.PUSH_EMPTY_ARRAY],nt,M(nt),[_$opcodes_56.POP])},one_or_more(Z,D){const nt=Y(Z.expression,{sp:D.sp+1,env:h(D.env),action:null});return y([_$opcodes_56.PUSH_EMPTY_ARRAY],nt,F(0|Z.expression.match,[_$opcodes_56.IF_NOT_ERROR],y(M(nt),[_$opcodes_56.POP]),y([_$opcodes_56.POP],[_$opcodes_56.POP],[_$opcodes_56.PUSH_FAILED])))},group:(Z,D)=>Y(Z.expression,{sp:D.sp,env:h(D.env),action:null}),semantic_and:(Z,D)=>U(Z,!1,D),semantic_not:(Z,D)=>U(Z,!0,D),rule_ref:Z=>[_$opcodes_56.RULE,_$asts_54.indexOfRule(t,Z.name)],literal(Z){if(Z.value.length>0){const D=0|Z.match,nt=D===__SOMETIMES_MATCH_57||D===__ALWAYS_MATCH_57&&!Z.ignoreCase?function(at){const et=e.indexOf(at);return et===-1?e.push(at)-1:et}(Z.ignoreCase?Z.value.toLowerCase():Z.value):null,ct=D!==__ALWAYS_MATCH_57?f({type:"literal",value:Z.value,ignoreCase:Z.ignoreCase}):null;return F(D,Z.ignoreCase?[_$opcodes_56.MATCH_STRING_IC,nt]:[_$opcodes_56.MATCH_STRING,nt],Z.ignoreCase?[_$opcodes_56.ACCEPT_N,Z.value.length]:[_$opcodes_56.ACCEPT_STRING,nt],[_$opcodes_56.FAIL,ct])}return[_$opcodes_56.PUSH_EMPTY_STRING]},class(Z){const D=0|Z.match,nt=D===__SOMETIMES_MATCH_57?function(at){const et={value:at.parts,inverted:at.inverted,ignoreCase:at.ignoreCase},mt=JSON.stringify(et),At=n.findIndex(dt=>JSON.stringify(dt)===mt);return At===-1?n.push(et)-1:At}(Z):null,ct=D!==__ALWAYS_MATCH_57?f({type:"class",value:Z.parts,inverted:Z.inverted,ignoreCase:Z.ignoreCase}):null;return F(D,[_$opcodes_56.MATCH_CHAR_CLASS,nt],[_$opcodes_56.ACCEPT_N,1],[_$opcodes_56.FAIL,ct])},any(Z){const D=0|Z.match,nt=D!==__ALWAYS_MATCH_57?f({type:"any"}):null;return F(D,[_$opcodes_56.MATCH_ANY],[_$opcodes_56.ACCEPT_N,1],[_$opcodes_56.FAIL,nt])}});Y(t)},_$stack_68=class{constructor(t,e,n){this.sp=-1,this.maxSp=-1,this.varName=e,this.ruleName=t,this.type=n}name(t){if(t<0)throw new RangeError(`Rule '${this.ruleName}': The variable stack underflow: attempt to use a variable '${this.varName}<x>' at an index ${t}`);return this.varName+t}push(t){const e=this.name(++this.sp)+" = "+t+";";return this.sp>this.maxSp&&(this.maxSp=this.sp),e}pop(t){return t!==void 0?(this.sp-=t,Array.from({length:t},(e,n)=>this.name(this.sp+1+n))):this.name(this.sp--)}top(){return this.name(this.sp)}index(t){if(t<0)throw new RangeError(`Rule '${this.ruleName}': The variable stack overflow: attempt to get a variable at a negative index ${t}`);return this.name(this.sp-t)}result(){if(this.maxSp<0)throw new RangeError(`Rule '${this.ruleName}': The variable stack is empty, can't get the result'`);return this.name(0)}defines(){return this.maxSp<0?"":this.type+" "+Array.from({length:this.maxSp+1},(t,e)=>this.name(e)).join(", ")+";"}checkedIf(t,e,n){const r=this.sp;if(e(),n){const o=this.sp;if(this.sp=r,n(),o!==this.sp)throw new Error("Rule '"+this.ruleName+"', position "+t+": Branches of a condition can't move the stack pointer differently (before: "+r+", after then: "+o+", after else: "+this.sp+").")}}checkedLoop(t,e){const n=this.sp;if(e(),n!==this.sp)throw new Error("Rule '"+this.ruleName+"', position "+t+": Body of a loop can't move the stack pointer (before: "+n+", after: "+this.sp+").")}},_$version_74="2.0.1",_$utils_69={};function hex(t){return t.charCodeAt(0).toString(16).toUpperCase()}_$utils_69.hex=hex,_$utils_69.stringEscape=function(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\v/g,"\\v").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,e=>"\\x0"+hex(e)).replace(/[\x10-\x1F\x7F-\xFF]/g,e=>"\\x"+hex(e)).replace(/[\u0100-\u0FFF]/g,e=>"\\u0"+hex(e)).replace(/[\u1000-\uFFFF]/g,e=>"\\u"+hex(e))},_$utils_69.regexpClassEscape=function(t){return t.replace(/\\/g,"\\\\").replace(/\//g,"\\/").replace(/]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\v/g,"\\v").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,e=>"\\x0"+hex(e)).replace(/[\x10-\x1F\x7F-\xFF]/g,e=>"\\x"+hex(e)).replace(/[\u0100-\u0FFF]/g,e=>"\\u0"+hex(e)).replace(/[\u1000-\uFFFF]/g,e=>"\\u"+hex(e))};var _$base64_77={};const intToCharMap="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");_$base64_77.encode=function(t){if(0<=t&&t<intToCharMap.length)return intToCharMap[t];throw new TypeError("Must be between 0 and 63: "+t)};var _$base64Vlq_76={encode:function(t){let e,n="",r=function(o){return o<0?1+(-o<<1):0+(o<<1)}(t);do e=31&r,(r>>>=5)>0&&(e|=32),n+=_$base64_77.encode(e);while(r>0);return n}},_$util_81={getArg:function(t,e,n){if(e in t)return t[e];if(arguments.length===3)return n;throw new Error('"'+e+'" is a required argument.')}};const supportsNullProto=!("__proto__"in Object.create(null));function identity(t){return t}function isProtoString(t){if(!t)return!1;const e=t.length;if(e<9||t.charCodeAt(e-1)!==95||t.charCodeAt(e-2)!==95||t.charCodeAt(e-3)!==111||t.charCodeAt(e-4)!==116||t.charCodeAt(e-5)!==111||t.charCodeAt(e-6)!==114||t.charCodeAt(e-7)!==112||t.charCodeAt(e-8)!==95||t.charCodeAt(e-9)!==95)return!1;for(let n=e-10;n>=0;n--)if(t.charCodeAt(n)!==36)return!1;return!0}function strcmp(t,e){return t===e?0:t===null?1:e===null?-1:t>e?1:-1}_$util_81.toSetString=supportsNullProto?identity:function(t){return isProtoString(t)?"$"+t:t},_$util_81.fromSetString=supportsNullProto?identity:function(t){return isProtoString(t)?t.slice(1):t},_$util_81.compareByGeneratedPositionsInflated=function(t,e){let n=t.generatedLine-e.generatedLine;return n!==0||(n=t.generatedColumn-e.generatedColumn)!=0||(n=strcmp(t.source,e.source))!==0||(n=t.originalLine-e.originalLine)!=0||(n=t.originalColumn-e.originalColumn)!=0?n:strcmp(t.name,e.name)};const PROTOCOL="http:",PROTOCOL_AND_HOST=PROTOCOL+"//host";function createSafeHandler(t){return e=>{const n=getURLType(e),r=buildSafeBase(e),o=new URL(e,r);t(o);const f=o.toString();return n==="absolute"?f:n==="scheme-relative"?f.slice(PROTOCOL.length):n==="path-absolute"?f.slice(PROTOCOL_AND_HOST.length):computeRelativeURL(r,f)}}function withBase(t,e){return new URL(t,e).toString()}function buildSafeBase(t){const e=t.split("..").length-1,n=function(o,f){let d=0;for(;;){const h="p"+d++;if(f.indexOf(h)===-1)return h}}(0,t);let r=PROTOCOL_AND_HOST+"/";for(let o=0;o<e;o++)r+=n+"/";return r}const ABSOLUTE_SCHEME=/^[A-Za-z0-9\+\-\.]+:/;function getURLType(t){return t[0]==="/"?t[1]==="/"?"scheme-relative":"path-absolute":ABSOLUTE_SCHEME.test(t)?"absolute":"path-relative"}function computeRelativeURL(t,e){typeof t=="string"&&(t=new URL(t)),typeof e=="string"&&(e=new URL(e));const n=e.pathname.split("/"),r=t.pathname.split("/");for(r.length>0&&!r[r.length-1]&&r.pop();n.length>0&&r.length>0&&n[0]===r[0];)n.shift(),r.shift();return r.map(()=>"..").concat(n).join("/")+e.search+e.hash}const ensureDirectory=createSafeHandler(t=>{t.pathname=t.pathname.replace(/\/?$/,"/")}),normalize=createSafeHandler(t=>{});_$util_81.normalize=normalize,_$util_81.join=function(t,e){const n=getURLType(e),r=getURLType(t);if(t=ensureDirectory(t),n==="absolute")return withBase(e,void 0);if(r==="absolute")return withBase(e,t);if(n==="scheme-relative")return normalize(e);if(r==="scheme-relative")return withBase(e,withBase(t,PROTOCOL_AND_HOST)).slice(PROTOCOL.length);if(n==="path-absolute")return normalize(e);if(r==="path-absolute")return withBase(e,withBase(t,PROTOCOL_AND_HOST)).slice(PROTOCOL_AND_HOST.length);const o=buildSafeBase(e+t);return computeRelativeURL(o,withBase(e,withBase(t,o)))},_$util_81.relative=function(t,e){const n=function(r,o){if(getURLType(r)!==getURLType(o))return null;const f=buildSafeBase(r+o),d=new URL(r,f),h=new URL(o,f);try{new URL("",h.toString())}catch{return null}return h.protocol!==d.protocol||h.user!==d.user||h.password!==d.password||h.hostname!==d.hostname||h.port!==d.port?null:computeRelativeURL(d,h)}(t,e);return typeof n=="string"?n:normalize(e)};var _$arraySet_75={};class ArraySet{constructor(){this._array=[],this._set=new Map}static fromArray(e,n){const r=new ArraySet;for(let o=0,f=e.length;o<f;o++)r.add(e[o],n);return r}size(){return this._set.size}add(e,n){const r=this.has(e),o=this._array.length;r&&!n||this._array.push(e),r||this._set.set(e,o)}has(e){return this._set.has(e)}indexOf(e){const n=this._set.get(e);if(n>=0)return n;throw new Error('"'+e+'" is not in the set.')}at(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)}toArray(){return this._array.slice()}}_$arraySet_75.ArraySet=ArraySet;var _$mappingList_78={MappingList:class{constructor(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}unsortedForEach(t,e){this._array.forEach(t,e)}add(t){(function(e,n){const r=e.generatedLine,o=n.generatedLine,f=e.generatedColumn,d=n.generatedColumn;return o>r||o==r&&d>=f||_$util_81.compareByGeneratedPositionsInflated(e,n)<=0})(this._last,t)?(this._last=t,this._array.push(t)):(this._sorted=!1,this._array.push(t))}toArray(){return this._sorted||(this._array.sort(_$util_81.compareByGeneratedPositionsInflated),this._sorted=!0),this._array}}},_$sourceMapGenerator_79={};const __ArraySet_79=_$arraySet_75.ArraySet,MappingList=_$mappingList_78.MappingList;class SourceMapGenerator{constructor(e){e||(e={}),this._file=_$util_81.getArg(e,"file",null),this._sourceRoot=_$util_81.getArg(e,"sourceRoot",null),this._skipValidation=_$util_81.getArg(e,"skipValidation",!1),this._sources=new __ArraySet_79,this._names=new __ArraySet_79,this._mappings=new MappingList,this._sourcesContents=null}static fromSourceMap(e){const n=e.sourceRoot,r=new SourceMapGenerator({file:e.file,sourceRoot:n});return e.eachMapping(function(o){const f={generated:{line:o.generatedLine,column:o.generatedColumn}};o.source!=null&&(f.source=o.source,n!=null&&(f.source=_$util_81.relative(n,f.source)),f.original={line:o.originalLine,column:o.originalColumn},o.name!=null&&(f.name=o.name)),r.addMapping(f)}),e.sources.forEach(function(o){let f=o;n!=null&&(f=_$util_81.relative(n,o)),r._sources.has(f)||r._sources.add(f);const d=e.sourceContentFor(o);d!=null&&r.setSourceContent(o,d)}),r}addMapping(e){const n=_$util_81.getArg(e,"generated"),r=_$util_81.getArg(e,"original",null);let o=_$util_81.getArg(e,"source",null),f=_$util_81.getArg(e,"name",null);this._skipValidation||this._validateMapping(n,r,o,f),o!=null&&(o=String(o),this._sources.has(o)||this._sources.add(o)),f!=null&&(f=String(f),this._names.has(f)||this._names.add(f)),this._mappings.add({generatedLine:n.line,generatedColumn:n.column,originalLine:r&&r.line,originalColumn:r&&r.column,source:o,name:f})}setSourceContent(e,n){let r=e;this._sourceRoot!=null&&(r=_$util_81.relative(this._sourceRoot,r)),n!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[_$util_81.toSetString(r)]=n):this._sourcesContents&&(delete this._sourcesContents[_$util_81.toSetString(r)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))}applySourceMap(e,n,r){let o=n;if(n==null){if(e.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);o=e.file}const f=this._sourceRoot;f!=null&&(o=_$util_81.relative(f,o));const d=this._mappings.toArray().length>0?new __ArraySet_79:this._sources,h=new __ArraySet_79;this._mappings.unsortedForEach(function(y){if(y.source===o&&y.originalLine!=null){const T=e.originalPositionFor({line:y.originalLine,column:y.originalColumn});T.source!=null&&(y.source=T.source,r!=null&&(y.source=_$util_81.join(r,y.source)),f!=null&&(y.source=_$util_81.relative(f,y.source)),y.originalLine=T.line,y.originalColumn=T.column,T.name!=null&&(y.name=T.name))}const F=y.source;F==null||d.has(F)||d.add(F);const S=y.name;S==null||h.has(S)||h.add(S)},this),this._sources=d,this._names=h,e.sources.forEach(function(y){const F=e.sourceContentFor(y);F!=null&&(r!=null&&(y=_$util_81.join(r,y)),f!=null&&(y=_$util_81.relative(f,y)),this.setSourceContent(y,F))},this)}_validateMapping(e,n,r,o){if(n&&typeof n.line!="number"&&typeof n.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!n&&!r&&!o)){if(!(e&&"line"in e&&"column"in e&&n&&"line"in n&&"column"in n&&e.line>0&&e.column>=0&&n.line>0&&n.column>=0&&r))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:r,original:n,name:o}))}}_serializeMappings(){let e,n,r,o,f=0,d=1,h=0,y=0,F=0,S=0,T="";const U=this._mappings.toArray();for(let M=0,Y=U.length;M<Y;M++){if(e="",(n=U[M]).generatedLine!==d)for(f=0;n.generatedLine!==d;)e+=";",d++;else if(M>0){if(!_$util_81.compareByGeneratedPositionsInflated(n,U[M-1]))continue;e+=","}e+=_$base64Vlq_76.encode(n.generatedColumn-f),f=n.generatedColumn,n.source!=null&&(o=this._sources.indexOf(n.source),e+=_$base64Vlq_76.encode(o-S),S=o,e+=_$base64Vlq_76.encode(n.originalLine-1-y),y=n.originalLine-1,e+=_$base64Vlq_76.encode(n.originalColumn-h),h=n.originalColumn,n.name!=null&&(r=this._names.indexOf(n.name),e+=_$base64Vlq_76.encode(r-F),F=r)),T+=e}return T}_generateSourcesContent(e,n){return e.map(function(r){if(!this._sourcesContents)return null;n!=null&&(r=_$util_81.relative(n,r));const o=_$util_81.toSetString(r);return Object.prototype.hasOwnProperty.call(this._sourcesContents,o)?this._sourcesContents[o]:null},this)}toJSON(){const e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(e.file=this._file),this._sourceRoot!=null&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e}toString(){return JSON.stringify(this.toJSON())}}SourceMapGenerator.prototype._version=3,_$sourceMapGenerator_79.SourceMapGenerator=SourceMapGenerator;var _$sourceNode_80={};const __SourceMapGenerator_80=_$sourceMapGenerator_79.SourceMapGenerator,REGEX_NEWLINE=/(\r?\n)/,NEWLINE_CODE=10,isSourceNode="$$$isSourceNode$$$";class SourceNode{constructor(e,n,r,o,f){this.children=[],this.sourceContents={},this.line=e??null,this.column=n??null,this.source=r??null,this.name=f??null,this[isSourceNode]=!0,o!=null&&this.add(o)}static fromStringWithSourceMap(e,n,r){const o=new SourceNode,f=e.split(REGEX_NEWLINE);let d=0;const h=function(){return M()+(M()||"");function M(){return d<f.length?f[d++]:void 0}};let y,F=1,S=0,T=null;return n.eachMapping(function(M){if(T!==null){if(!(F<M.generatedLine)){const Y=(y=f[d]||"").substr(0,M.generatedColumn-S);return f[d]=y.substr(M.generatedColumn-S),S=M.generatedColumn,U(T,Y),void(T=M)}U(T,h()),F++,S=0}for(;F<M.generatedLine;)o.add(h()),F++;S<M.generatedColumn&&(y=f[d]||"",o.add(y.substr(0,M.generatedColumn)),f[d]=y.substr(M.generatedColumn),S=M.generatedColumn),T=M},this),d<f.length&&(T&&U(T,h()),o.add(f.splice(d).join(""))),n.sources.forEach(function(M){const Y=n.sourceContentFor(M);Y!=null&&(r!=null&&(M=_$util_81.join(r,M)),o.setSourceContent(M,Y))}),o;function U(M,Y){if(M===null||M.source===void 0)o.add(Y);else{const Z=r?_$util_81.join(r,M.source):M.source;o.add(new SourceNode(M.originalLine,M.originalColumn,Z,Y,M.name))}}}add(e){if(Array.isArray(e))e.forEach(function(n){this.add(n)},this);else{if(!e[isSourceNode]&&typeof e!="string")throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);e&&this.children.push(e)}return this}prepend(e){if(Array.isArray(e))for(let n=e.length-1;n>=0;n--)this.prepend(e[n]);else{if(!e[isSourceNode]&&typeof e!="string")throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);this.children.unshift(e)}return this}walk(e){let n;for(let r=0,o=this.children.length;r<o;r++)(n=this.children[r])[isSourceNode]?n.walk(e):n!==""&&e(n,{source:this.source,line:this.line,column:this.column,name:this.name})}join(e){let n,r;const o=this.children.length;if(o>0){for(n=[],r=0;r<o-1;r++)n.push(this.children[r]),n.push(e);n.push(this.children[r]),this.children=n}return this}replaceRight(e,n){const r=this.children[this.children.length-1];return r[isSourceNode]?r.replaceRight(e,n):typeof r=="string"?this.children[this.children.length-1]=r.replace(e,n):this.children.push("".replace(e,n)),this}setSourceContent(e,n){this.sourceContents[_$util_81.toSetString(e)]=n}walkSourceContents(e){for(let r=0,o=this.children.length;r<o;r++)this.children[r][isSourceNode]&&this.children[r].walkSourceContents(e);const n=Object.keys(this.sourceContents);for(let r=0,o=n.length;r<o;r++)e(_$util_81.fromSetString(n[r]),this.sourceContents[n[r]])}toString(){let e="";return this.walk(function(n){e+=n}),e}toStringWithSourceMap(e){const n={code:"",line:1,column:0},r=new __SourceMapGenerator_80(e);let o=!1,f=null,d=null,h=null,y=null;return this.walk(function(F,S){n.code+=F,S.source!==null&&S.line!==null&&S.column!==null?(f===S.source&&d===S.line&&h===S.column&&y===S.name||r.addMapping({source:S.source,original:{line:S.line,column:S.column},generated:{line:n.line,column:n.column},name:S.name}),f=S.source,d=S.line,h=S.column,y=S.name,o=!0):o&&(r.addMapping({generated:{line:n.line,column:n.column}}),f=null,o=!1);for(let T=0,U=F.length;T<U;T++)F.charCodeAt(T)===NEWLINE_CODE?(n.line++,n.column=0,T+1===U?(f=null,o=!1):o&&r.addMapping({source:S.source,original:{line:S.line,column:S.column},generated:{line:n.line,column:n.column},name:S.name})):n.column++}),this.walkSourceContents(function(F,S){r.setSourceContent(F,S)}),{code:n.code,map:r}}}_$sourceNode_80.SourceNode=SourceNode;var _$sourceMap_82={};_$sourceMap_82.SourceMapGenerator=_$sourceMapGenerator_79.SourceMapGenerator,_$sourceMap_82.SourceNode=_$sourceNode_80.SourceNode;const{stringEscape,regexpClassEscape}=_$utils_69,{SourceNode:__SourceNode_58}=_$sourceMap_82;function toSourceNode(t,e,n){const r=e.start.line,o=e.start.column-1,f=t.split(`
`);return f.length===1?new __SourceNode_58(r,o,e.source,t,n):new __SourceNode_58(null,null,e.source,f.map((d,h)=>new __SourceNode_58(r+h,h===0?o:0,e.source,h===f.length-1?d:[d,`
`],n)))}function wrapInSourceNode(t,e,n,r,o){return n?new __SourceNode_58(null,null,n.source,[t,toSourceNode(e,n,o),new __SourceNode_58(n.end.line,n.end.column-1,n.source,r)]):new __SourceNode_58(null,null,null,[t,e,r])}var _$generateJs_58=function(t,e){function n(F){return F instanceof __SourceNode_58?F:F.replace(/^(.+)$/gm,"  $1")}function r(F){return"peg$c"+F}function o(F){return"peg$r"+F}function f(F){return"peg$e"+F}function d(F){return"peg$f"+F}function h(F){return"peg$parse"+F}function y(F){return F.codeLocation?toSourceNode(F.code,F.codeLocation,"$"+F.type):F.code}t.code=function(F){function S(){return[`// Generated by Peggy ${_$version_74}.`,"//","// https://peggyjs.org/"]}function T(){return e.trace?["{","  SyntaxError: peg$SyntaxError,","  DefaultTracer: peg$DefaultTracer,","  parse: peg$parse","}"].join(`
`):["{","  SyntaxError: peg$SyntaxError,","  parse: peg$parse","}"].join(`
`)}const U={bare:()=>[...S(),"(function() {",'  "use strict";',"",F,"",n("return "+T()+";"),"})()"],commonjs(){const M=Object.keys(e.dependencies),Y=S();return Y.push("",'"use strict";',""),M.length>0&&(M.forEach(Z=>{Y.push("var "+Z+' = require("'+stringEscape(e.dependencies[Z])+'");')}),Y.push("")),Y.push(F,"","module.exports = "+T()+";"),Y},es(){const M=Object.keys(e.dependencies),Y=S();return Y.push(""),M.length>0&&(M.forEach(Z=>{Y.push("import "+Z+' from "'+stringEscape(e.dependencies[Z])+'";')}),Y.push("")),Y.push(F,"","export {","  peg$SyntaxError as SyntaxError,",e.trace?"  peg$DefaultTracer as DefaultTracer,":"","  peg$parse as parse","};"),Y},amd(){const M=Object.keys(e.dependencies),Y="["+M.map(D=>e.dependencies[D]).map(D=>'"'+stringEscape(D)+'"').join(", ")+"]",Z=M.join(", ");return[...S(),"define("+Y+", function("+Z+") {",'  "use strict";',"",F,"",n("return "+T()+";"),"});"]},globals:()=>[...S(),"(function(root) {",'  "use strict";',"",F,"",n("root."+e.exportVar+" = "+T()+";"),"})(this);"],umd(){const M=Object.keys(e.dependencies),Y=M.map(at=>e.dependencies[at]),Z="["+Y.map(at=>'"'+stringEscape(at)+'"').join(", ")+"]",D=Y.map(at=>'require("'+stringEscape(at)+'")').join(", "),nt=M.join(", "),ct=S();return ct.push("(function(root, factory) {",'  if (typeof define === "function" && define.amd) {',"    define("+Z+", factory);",'  } else if (typeof module === "object" && module.exports) {',"    module.exports = factory("+D+");"),e.exportVar!==null&&ct.push("  } else {","    root."+e.exportVar+" = factory();"),ct.push("  }","})(this, function("+nt+") {",'  "use strict";',"",F,"",n("return "+T()+";"),"});"),ct}}[e.format]();return new __SourceNode_58(null,null,e.grammarSource,U.map(M=>M instanceof __SourceNode_58?M:M+`
`))}(function(){const F=[];t.topLevelInitializer&&(F.push(y(t.topLevelInitializer)),F.push("")),F.push("function peg$subclass(child, parent) {","  function C() { this.constructor = child; }","  C.prototype = parent.prototype;","  child.prototype = new C();","}","","function peg$SyntaxError(message, expected, found, location) {","  var self = Error.call(this, message);","  // istanbul ignore next Check is a necessary evil to support older environments","  if (Object.setPrototypeOf) {","    Object.setPrototypeOf(self, peg$SyntaxError.prototype);","  }","  self.expected = expected;","  self.found = found;","  self.location = location;",'  self.name = "SyntaxError";',"  return self;","}","","peg$subclass(peg$SyntaxError, Error);","","function peg$padEnd(str, targetLength, padString) {",'  padString = padString || " ";',"  if (str.length > targetLength) { return str; }","  targetLength -= str.length;","  padString += padString.repeat(targetLength);","  return str + padString.slice(0, targetLength);","}","","peg$SyntaxError.prototype.format = function(sources) {",'  var str = "Error: " + this.message;',"  if (this.location) {","    var src = null;","    var k;","    for (k = 0; k < sources.length; k++) {","      if (sources[k].source === this.location.source) {","        src = sources[k].text.split(/\\r\\n|\\n|\\r/g);","        break;","      }","    }","    var s = this.location.start;",'    var loc = this.location.source + ":" + s.line + ":" + s.column;',"    if (src) {","      var e = this.location.end;",`      var filler = peg$padEnd("", s.line.toString().length, ' ');`,"      var line = src[s.line - 1];","      var last = s.line === e.line ? e.column : line.length + 1;","      var hatLen = (last - s.column) || 1;",'      str += "\\n --> " + loc + "\\n"','          + filler + " |\\n"','          + s.line + " | " + line + "\\n"',`          + filler + " | " + peg$padEnd("", s.column - 1, ' ')`,'          + peg$padEnd("", hatLen, "^");',"    } else {",'      str += "\\n at " + loc;',"    }","  }","  return str;","};","","peg$SyntaxError.buildMessage = function(expected, found) {","  var DESCRIBE_EXPECTATION_FNS = {","    literal: function(expectation) {",'      return "\\"" + literalEscape(expectation.text) + "\\"";',"    },","","    class: function(expectation) {","      var escapedParts = expectation.parts.map(function(part) {","        return Array.isArray(part)",'          ? classEscape(part[0]) + "-" + classEscape(part[1])',"          : classEscape(part);","      });","",'      return "[" + (expectation.inverted ? "^" : "") + escapedParts.join("") + "]";',"    },","","    any: function() {",'      return "any character";',"    },","","    end: function() {",'      return "end of input";',"    },","","    other: function(expectation) {","      return expectation.description;","    }","  };","","  function hex(ch) {","    return ch.charCodeAt(0).toString(16).toUpperCase();","  }","","  function literalEscape(s) {","    return s",'      .replace(/\\\\/g, "\\\\\\\\")','      .replace(/"/g,  "\\\\\\"")','      .replace(/\\0/g, "\\\\0")','      .replace(/\\t/g, "\\\\t")','      .replace(/\\n/g, "\\\\n")','      .replace(/\\r/g, "\\\\r")','      .replace(/[\\x00-\\x0F]/g,          function(ch) { return "\\\\x0" + hex(ch); })','      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return "\\\\x"  + hex(ch); });',"  }","","  function classEscape(s) {","    return s",'      .replace(/\\\\/g, "\\\\\\\\")','      .replace(/\\]/g, "\\\\]")','      .replace(/\\^/g, "\\\\^")','      .replace(/-/g,  "\\\\-")','      .replace(/\\0/g, "\\\\0")','      .replace(/\\t/g, "\\\\t")','      .replace(/\\n/g, "\\\\n")','      .replace(/\\r/g, "\\\\r")','      .replace(/[\\x00-\\x0F]/g,          function(ch) { return "\\\\x0" + hex(ch); })','      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return "\\\\x"  + hex(ch); });',"  }","","  function describeExpectation(expectation) {","    return DESCRIBE_EXPECTATION_FNS[expectation.type](expectation);","  }","","  function describeExpected(expected) {","    var descriptions = expected.map(describeExpectation);","    var i, j;","","    descriptions.sort();","","    if (descriptions.length > 0) {","      for (i = 1, j = 1; i < descriptions.length; i++) {","        if (descriptions[i - 1] !== descriptions[i]) {","          descriptions[j] = descriptions[i];","          j++;","        }","      }","      descriptions.length = j;","    }","","    switch (descriptions.length) {","      case 1:","        return descriptions[0];","","      case 2:",'        return descriptions[0] + " or " + descriptions[1];',"","      default:",'        return descriptions.slice(0, -1).join(", ")','          + ", or "',"          + descriptions[descriptions.length - 1];","    }","  }","","  function describeFound(found) {",'    return found ? "\\"" + literalEscape(found) + "\\"" : "end of input";',"  }","",'  return "Expected " + describeExpected(expected) + " but " + describeFound(found) + " found.";',"};",""),e.trace&&F.push("function peg$DefaultTracer() {","  this.indentLevel = 0;","}","","peg$DefaultTracer.prototype.trace = function(event) {","  var that = this;","","  function log(event) {","    function repeat(string, n) {",'       var result = "", i;',"","       for (i = 0; i < n; i++) {","         result += string;","       }","","       return result;","    }","","    function pad(string, length) {",'      return string + repeat(" ", length - string.length);',"    }","",'    if (typeof console === "object") {',"      console.log(",'        event.location.start.line + ":" + event.location.start.column + "-"','          + event.location.end.line + ":" + event.location.end.column + " "','          + pad(event.type, 10) + " "','          + repeat("  ", that.indentLevel) + event.rule',"      );","    }","  }","","  switch (event.type) {",'    case "rule.enter":',"      log(event);","      this.indentLevel++;","      break;","",'    case "rule.match":',"      this.indentLevel--;","      log(event);","      break;","",'    case "rule.fail":',"      this.indentLevel--;","      log(event);","      break;","","    default:",'      throw new Error("Invalid event type: " + event.type + ".");',"  }","};","");const S="{ "+e.allowedStartRules.map(U=>U+": "+h(U)).join(", ")+" }",T=h(e.allowedStartRules[0]);return F.push("function peg$parse(input, options) {","  options = options !== undefined ? options : {};","","  var peg$FAILED = {};","  var peg$source = options.grammarSource;","","  var peg$startRuleFunctions = "+S+";","  var peg$startRuleFunction = "+T+";","",new __SourceNode_58(null,null,e.grammarSource,[t.literals.map((U,M)=>"  var "+r(M)+' = "'+stringEscape(U)+'";').concat("",t.classes.map((U,M)=>{return"  var "+o(M)+" = /^["+((Y=U).inverted?"^":"")+Y.value.map(Z=>Array.isArray(Z)?regexpClassEscape(Z[0])+"-"+regexpClassEscape(Z[1]):regexpClassEscape(Z)).join("")+"]/"+(Y.ignoreCase?"i":"")+";";var Y})).concat("",t.expectations.map((U,M)=>"  var "+f(M)+" = "+function(Y){switch(Y.type){case"rule":return'peg$otherExpectation("'+stringEscape(Y.value)+'")';case"literal":return'peg$literalExpectation("'+stringEscape(Y.value)+'", '+Y.ignoreCase+")";case"class":return"peg$classExpectation(["+Y.value.map(Z=>Array.isArray(Z)?'["'+stringEscape(Z[0])+'", "'+stringEscape(Z[1])+'"]':'"'+stringEscape(Z)+'"').join(", ")+"], "+Y.inverted+", "+Y.ignoreCase+")";case"any":return"peg$anyExpectation()";default:throw new Error("Unknown expectation type ("+JSON.stringify(Y)+")")}}(U)+";")).concat("").join(`
`),t.functions.map(function(U,M){return wrapInSourceNode(`
  var ${d(M)} = function(${U.params.join(", ")}) {`,U.body,U.location,"};")})]),"","  var peg$currPos = 0;","  var peg$savedPos = 0;","  var peg$posDetailsCache = [{ line: 1, column: 1 }];","  var peg$maxFailPos = 0;","  var peg$maxFailExpected = [];","  var peg$silentFails = 0;",""),e.cache&&F.push("  var peg$resultsCache = {};",""),e.trace&&F.push('  var peg$tracer = "tracer" in options ? options.tracer : new peg$DefaultTracer();',""),F.push("  var peg$result;","",'  if ("startRule" in options) {',"    if (!(options.startRule in peg$startRuleFunctions)) {",`      throw new Error("Can't start parsing from rule \\"" + options.startRule + "\\".");`,"    }","","    peg$startRuleFunction = peg$startRuleFunctions[options.startRule];","  }","","  function text() {","    return input.substring(peg$savedPos, peg$currPos);","  }","","  function offset() {","    return peg$savedPos;","  }","","  function range() {","    return {","      source: peg$source,","      start: peg$savedPos,","      end: peg$currPos","    };","  }","","  function location() {","    return peg$computeLocation(peg$savedPos, peg$currPos);","  }","","  function expected(description, location) {","    location = location !== undefined","      ? location","      : peg$computeLocation(peg$savedPos, peg$currPos);","","    throw peg$buildStructuredError(","      [peg$otherExpectation(description)],","      input.substring(peg$savedPos, peg$currPos),","      location","    );","  }","","  function error(message, location) {","    location = location !== undefined","      ? location","      : peg$computeLocation(peg$savedPos, peg$currPos);","","    throw peg$buildSimpleError(message, location);","  }","","  function peg$literalExpectation(text, ignoreCase) {",'    return { type: "literal", text: text, ignoreCase: ignoreCase };',"  }","","  function peg$classExpectation(parts, inverted, ignoreCase) {",'    return { type: "class", parts: parts, inverted: inverted, ignoreCase: ignoreCase };',"  }","","  function peg$anyExpectation() {",'    return { type: "any" };',"  }","","  function peg$endExpectation() {",'    return { type: "end" };',"  }","","  function peg$otherExpectation(description) {",'    return { type: "other", description: description };',"  }","","  function peg$computePosDetails(pos) {","    var details = peg$posDetailsCache[pos];","    var p;","","    if (details) {","      return details;","    } else {","      p = pos - 1;","      while (!peg$posDetailsCache[p]) {","        p--;","      }","","      details = peg$posDetailsCache[p];","      details = {","        line: details.line,","        column: details.column","      };","","      while (p < pos) {","        if (input.charCodeAt(p) === 10) {","          details.line++;","          details.column = 1;","        } else {","          details.column++;","        }","","        p++;","      }","","      peg$posDetailsCache[pos] = details;","","      return details;","    }","  }","","  function peg$computeLocation(startPos, endPos) {","    var startPosDetails = peg$computePosDetails(startPos);","    var endPosDetails = peg$computePosDetails(endPos);","","    return {","      source: peg$source,","      start: {","        offset: startPos,","        line: startPosDetails.line,","        column: startPosDetails.column","      },","      end: {","        offset: endPos,","        line: endPosDetails.line,","        column: endPosDetails.column","      }","    };","  }","","  function peg$fail(expected) {","    if (peg$currPos < peg$maxFailPos) { return; }","","    if (peg$currPos > peg$maxFailPos) {","      peg$maxFailPos = peg$currPos;","      peg$maxFailExpected = [];","    }","","    peg$maxFailExpected.push(expected);","  }","","  function peg$buildSimpleError(message, location) {","    return new peg$SyntaxError(message, null, null, location);","  }","","  function peg$buildStructuredError(expected, found, location) {","    return new peg$SyntaxError(","      peg$SyntaxError.buildMessage(expected, found),","      expected,","      found,","      location","    );","  }",""),t.rules.forEach(U=>{F.push(...function(M){const Y=[],Z=new _$stack_68(M.name,"s","var"),D=function nt(ct){let at=0;const et=ct.length,mt=[];let At;function dt(l,s){const v=s+3,$=ct[at+v-2],E=ct[at+v-1];let rt,gt;Z.checkedIf(at,()=>{at+=v,rt=nt(ct.slice(at,at+$)),at+=$},E>0?()=>{gt=nt(ct.slice(at,at+E)),at+=E}:null),mt.push("if ("+l+") {"),mt.push(...rt.map(n)),E>0&&(mt.push("} else {"),mt.push(...gt.map(n))),mt.push("}")}function ht(l){const s=ct[at+2-1];let v;Z.checkedLoop(at,()=>{at+=2,v=nt(ct.slice(at,at+s)),at+=s}),mt.push("while ("+l+") {"),mt.push(...v.map(n)),mt.push("}")}function xt(){const l=ct[at+4-1],s=d(ct[at+1])+"("+ct.slice(at+4,at+4+l).map(v=>Z.index(v)).join(", ")+")";Z.pop(ct[at+2]),mt.push(Z.push(s)),at+=4+l}for(;at<et;)switch(ct[at]){case _$opcodes_56.PUSH_EMPTY_STRING:mt.push(Z.push("''")),at++;break;case _$opcodes_56.PUSH_CURR_POS:mt.push(Z.push("peg$currPos")),at++;break;case _$opcodes_56.PUSH_UNDEFINED:mt.push(Z.push("undefined")),at++;break;case _$opcodes_56.PUSH_NULL:mt.push(Z.push("null")),at++;break;case _$opcodes_56.PUSH_FAILED:mt.push(Z.push("peg$FAILED")),at++;break;case _$opcodes_56.PUSH_EMPTY_ARRAY:mt.push(Z.push("[]")),at++;break;case _$opcodes_56.POP:Z.pop(),at++;break;case _$opcodes_56.POP_CURR_POS:mt.push("peg$currPos = "+Z.pop()+";"),at++;break;case _$opcodes_56.POP_N:Z.pop(ct[at+1]),at+=2;break;case _$opcodes_56.NIP:At=Z.pop(),Z.pop(),mt.push(Z.push(At)),at++;break;case _$opcodes_56.APPEND:At=Z.pop(),mt.push(Z.top()+".push("+At+");"),at++;break;case _$opcodes_56.WRAP:mt.push(Z.push("["+Z.pop(ct[at+1]).join(", ")+"]")),at+=2;break;case _$opcodes_56.TEXT:mt.push(Z.push("input.substring("+Z.pop()+", peg$currPos)")),at++;break;case _$opcodes_56.PLUCK:{const s=ct[at+3-1],v=3+s;At=ct.slice(at+3,at+v),At=s===1?Z.index(At[0]):`[ ${At.map($=>Z.index($)).join(", ")} ]`,Z.pop(ct[at+1]),mt.push(Z.push(At)),at+=v;break}case _$opcodes_56.IF:dt(Z.top(),0);break;case _$opcodes_56.IF_ERROR:dt(Z.top()+" === peg$FAILED",0);break;case _$opcodes_56.IF_NOT_ERROR:dt(Z.top()+" !== peg$FAILED",0);break;case _$opcodes_56.WHILE_NOT_ERROR:ht(Z.top()+" !== peg$FAILED");break;case _$opcodes_56.MATCH_ANY:dt("input.length > peg$currPos",0);break;case _$opcodes_56.MATCH_STRING:dt(t.literals[ct[at+1]].length>1?"input.substr(peg$currPos, "+t.literals[ct[at+1]].length+") === "+r(ct[at+1]):"input.charCodeAt(peg$currPos) === "+t.literals[ct[at+1]].charCodeAt(0),1);break;case _$opcodes_56.MATCH_STRING_IC:dt("input.substr(peg$currPos, "+t.literals[ct[at+1]].length+").toLowerCase() === "+r(ct[at+1]),1);break;case _$opcodes_56.MATCH_CHAR_CLASS:dt(o(ct[at+1])+".test(input.charAt(peg$currPos))",1);break;case _$opcodes_56.ACCEPT_N:mt.push(Z.push(ct[at+1]>1?"input.substr(peg$currPos, "+ct[at+1]+")":"input.charAt(peg$currPos)")),mt.push(ct[at+1]>1?"peg$currPos += "+ct[at+1]+";":"peg$currPos++;"),at+=2;break;case _$opcodes_56.ACCEPT_STRING:mt.push(Z.push(r(ct[at+1]))),mt.push(t.literals[ct[at+1]].length>1?"peg$currPos += "+t.literals[ct[at+1]].length+";":"peg$currPos++;"),at+=2;break;case _$opcodes_56.FAIL:mt.push(Z.push("peg$FAILED")),mt.push("if (peg$silentFails === 0) { peg$fail("+f(ct[at+1])+"); }"),at+=2;break;case _$opcodes_56.LOAD_SAVED_POS:mt.push("peg$savedPos = "+Z.index(ct[at+1])+";"),at+=2;break;case _$opcodes_56.UPDATE_SAVED_POS:mt.push("peg$savedPos = peg$currPos;"),at++;break;case _$opcodes_56.CALL:xt();break;case _$opcodes_56.RULE:mt.push(Z.push(h(t.rules[ct[at+1]].name)+"()")),at+=2;break;case _$opcodes_56.SILENT_FAILS_ON:mt.push("peg$silentFails++;"),at++;break;case _$opcodes_56.SILENT_FAILS_OFF:mt.push("peg$silentFails--;"),at++;break;default:throw new Error("Invalid opcode: "+ct[at]+".")}return mt}(M.bytecode);return Y.push(wrapInSourceNode("  function ",h(M.name),M.nameLocation,`() {
`,M.name)),e.trace&&Y.push("  var startPos = peg$currPos;"),Y.push(n(Z.defines())),Y.push(...function(nt,ct){const at=[];return at.push(""),e.trace&&at.push("peg$tracer.trace({",'  type: "rule.enter",',"  rule: "+nt+",","  location: peg$computeLocation(startPos, startPos)","});",""),e.cache&&(at.push("var key = peg$currPos * "+t.rules.length+" + "+ct+";","var cached = peg$resultsCache[key];","","if (cached) {","  peg$currPos = cached.nextPos;",""),e.trace&&at.push("if (cached.result !== peg$FAILED) {","  peg$tracer.trace({",'    type: "rule.match",',"    rule: "+nt+",","    result: cached.result,","    location: peg$computeLocation(startPos, peg$currPos)","  });","} else {","  peg$tracer.trace({",'    type: "rule.fail",',"    rule: "+nt+",","    location: peg$computeLocation(startPos, startPos)","  });","}",""),at.push("  return cached.result;","}","")),at}('"'+stringEscape(M.name)+'"',_$asts_54.indexOfRule(t,M.name)).map(n)),Y.push(...D.map(n)),Y.push(...function(nt,ct){const at=[];return e.cache&&at.push("","peg$resultsCache[key] = { nextPos: peg$currPos, result: "+ct+" };"),e.trace&&at.push("","if ("+ct+" !== peg$FAILED) {","  peg$tracer.trace({",'    type: "rule.match",',"    rule: "+nt+",","    result: "+ct+",","    location: peg$computeLocation(startPos, peg$currPos)","  });","} else {","  peg$tracer.trace({",'    type: "rule.fail",',"    rule: "+nt+",","    location: peg$computeLocation(startPos, startPos)","  });","}"),at.push("","return "+ct+";"),at}('"'+stringEscape(M.name)+'"',Z.result()).map(n)),Y.push("}"),Y}(U).map(n)),F.push("")}),t.initializer&&(F.push(y(t.initializer)),F.push("")),F.push("  peg$result = peg$startRuleFunction();","","  if (peg$result !== peg$FAILED && peg$currPos === input.length) {","    return peg$result;","  } else {","    if (peg$result !== peg$FAILED && peg$currPos < input.length) {","      peg$fail(peg$endExpectation());","    }","","    throw peg$buildStructuredError(","      peg$maxFailExpected,","      peg$maxFailPos < input.length ? input.charAt(peg$maxFailPos) : null,","      peg$maxFailPos < input.length","        ? peg$computeLocation(peg$maxFailPos, peg$maxFailPos + 1)","        : peg$computeLocation(peg$maxFailPos, peg$maxFailPos)","    );","  }","}"),new __SourceNode_58(null,null,e.grammarSource,F.map(U=>U instanceof __SourceNode_58?U:U+`
`))}())},_$removeProxyRules_60=function(t,e,n){const r=[];t.rules.forEach((o,f)=>{var d;(d=o).type==="rule"&&d.expression.type==="rule_ref"&&(function(h,y,F){_$visitor_70.build({rule_ref(S){S.name===y&&(S.name=F,n.info(`Proxy rule "${y}" replaced by the rule "${F}"`,S.location,[{message:"This rule will be used",location:_$asts_54.findRule(h,F).nameLocation}]))}})(h)}(t,o.name,o.expression.name),e.allowedStartRules.indexOf(o.name)===-1&&r.push(f))}),r.reverse(),r.forEach(o=>{t.rules.splice(o,1)})},_$reportDuplicateLabels_61=function(t,e,n){function r(d){const h={};return Object.keys(d).forEach(y=>{h[y]=d[y]}),h}function o(d,h){f(d.expression,r(h))}const f=_$visitor_70.build({rule(d){f(d.expression,{})},choice(d,h){d.alternatives.forEach(y=>{f(y,r(h))})},action:o,labeled(d,h){const y=d.label;y&&Object.prototype.hasOwnProperty.call(h,y)&&n.error(`Label "${d.label}" is already defined`,d.labelLocation,[{message:"Original label location",location:h[y]}]),f(d.expression,h),h[d.label]=d.labelLocation},text:o,simple_and:o,simple_not:o,optional:o,zero_or_more:o,one_or_more:o,group:o});f(t)},_$reportDuplicateRules_62=function(t,e,n){const r={};_$visitor_70.build({rule(o){Object.prototype.hasOwnProperty.call(r,o.name)?n.error(`Rule "${o.name}" is already defined`,o.nameLocation,[{message:"Original rule location",location:r[o.name]}]):r[o.name]=o.nameLocation}})(t)},_$reportInfiniteRecursion_64=function(t,e,n){const r=[],o=[],f=_$visitor_70.build({rule(d){r.push(d.name),f(d.expression),r.pop()},sequence(d){d.elements.every(h=>(f(h),!_$asts_54.alwaysConsumesOnSuccess(t,h)))},rule_ref(d){o.push(d);const h=_$asts_54.findRule(t,d.name);if(r.indexOf(d.name)!==-1)return r.push(d.name),void n.error("Possible infinite loop when parsing (left recursion: "+r.join(" -> ")+")",h.nameLocation,o.map((y,F,S)=>({message:F+1!==S.length?`Step ${F+1}: call of the rule "${y.name}" without input consumption`:`Step ${F+1}: call itself without input consumption - left recursion`,location:y.location})));h&&f(h),o.pop()}});f(t)},_$reportInfiniteRepetition_65=function(t,e,n){_$visitor_70.build({zero_or_more(r){_$asts_54.alwaysConsumesOnSuccess(t,r.expression)||n.error("Possible infinite loop when parsing (repetition used with an expression that may not consume any input)",r.location)},one_or_more(r){_$asts_54.alwaysConsumesOnSuccess(t,r.expression)||n.error("Possible infinite loop when parsing (repetition used with an expression that may not consume any input)",r.location)}})(t)},_$reportUndefinedRules_66=function(t,e,n){_$visitor_70.build({rule_ref(r){_$asts_54.findRule(t,r.name)||n.error(`Rule "${r.name}" is not defined`,r.location)}})(t)},_$reportIncorrectPlucking_63=function(t,e,n){const r=_$visitor_70.build({action(o){r(o.expression,o)},labeled(o,f){o.pick&&f&&n.error('"@" cannot be used with an action block',o.labelLocation,[{message:"Action block location",location:f.codeLocation}]),r(o.expression)}});r(t)};class Defaults{constructor(e){typeof(e=e!==void 0?e:{}).error=="function"&&(this.error=e.error),typeof e.warning=="function"&&(this.warning=e.warning),typeof e.info=="function"&&(this.info=e.info)}error(){}warning(){}info(){}}var _$session_67=class{constructor(t){this._callbacks=new Defaults(t),this._firstError=null,this.errors=0,this.problems=[],this.stage=null}error(...t){++this.errors,this._firstError===null&&(this._firstError=new _$GrammarError_71(...t),this._firstError.stage=this.stage,this._firstError.problems=this.problems),this.problems.push(["error",...t]),this._callbacks.error(this.stage,...t)}warning(...t){this.problems.push(["warning",...t]),this._callbacks.warning(this.stage,...t)}info(...t){this.problems.push(["info",...t]),this._callbacks.info(this.stage,...t)}checkErrors(){if(this.errors!==0)throw this._firstError}};function processOptions(t,e){const n={};return Object.keys(t).forEach(r=>{n[r]=t[r]}),Object.keys(e).forEach(r=>{Object.prototype.hasOwnProperty.call(n,r)||(n[r]=e[r])}),n}const compiler={visitor:_$visitor_70,passes:{check:[_$reportUndefinedRules_66,_$reportDuplicateRules_62,_$reportDuplicateLabels_61,_$reportInfiniteRecursion_64,_$reportInfiniteRepetition_65,_$reportIncorrectPlucking_63],transform:[_$removeProxyRules_60,_$inferenceMatchResult_59],generate:[_$generateBytecode_57,_$generateJs_58]},compile(ast,passes,options){if(options=options!==void 0?options:{},options=processOptions(options,{allowedStartRules:[ast.rules[0].name],cache:!1,dependencies:{},exportVar:null,format:"bare",output:"parser",trace:!1}),!Array.isArray(options.allowedStartRules))throw new Error("allowedStartRules must be an array");if(options.allowedStartRules.length===0)throw new Error("Must have at least one start rule");const allRules=ast.rules.map(t=>t.name);for(const t of options.allowedStartRules)if(allRules.indexOf(t)===-1)throw new Error(`Unknown start rule "${t}"`);const session=new _$session_67(options);switch(Object.keys(passes).forEach(t=>{session.stage=t,session.info("Process stage "+t),passes[t].forEach(e=>{session.info(`Process pass ${t}.${e.name}`),e(ast,options,session)}),session.checkErrors()}),options.output){case"parser":return eval(ast.code.toString());case"source":return ast.code.toString();case"source-and-map":return ast.code;default:throw new Error("Invalid output format: "+options.output+".")}}};var _$compiler_55=compiler,_$parser_72={};const OPS_TO_PREFIXED_TYPES={$:"text","&":"simple_and","!":"simple_not"},OPS_TO_SUFFIXED_TYPES={"?":"optional","*":"zero_or_more","+":"one_or_more"},OPS_TO_SEMANTIC_PREDICATE_TYPES={"&":"semantic_and","!":"semantic_not"};function peg$SyntaxError(t,e,n,r){var o=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(o,peg$SyntaxError.prototype),o.expected=e,o.found=n,o.location=r,o.name="SyntaxError",o}function peg$padEnd(t,e,n){return n=n||" ",t.length>e?t:(e-=t.length,t+(n+=n.repeat(e)).slice(0,e))}(function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n})(peg$SyntaxError,Error),peg$SyntaxError.prototype.format=function(t){var e="Error: "+this.message;if(this.location){var n,r=null;for(n=0;n<t.length;n++)if(t[n].source===this.location.source){r=t[n].text.split(/\r\n|\n|\r/g);break}var o=this.location.start,f=this.location.source+":"+o.line+":"+o.column;if(r){var d=this.location.end,h=peg$padEnd("",o.line.toString().length," "),y=r[o.line-1],F=(o.line===d.line?d.column:y.length+1)-o.column||1;e+=`
 --> `+f+`
`+h+` |
`+o.line+" | "+y+`
`+h+" | "+peg$padEnd("",o.column-1," ")+peg$padEnd("",F,"^")}else e+=`
 at `+f}return e},peg$SyntaxError.buildMessage=function(t,e){var n={literal:function(h){return'"'+o(h.text)+'"'},class:function(h){var y=h.parts.map(function(F){return Array.isArray(F)?f(F[0])+"-"+f(F[1]):f(F)});return"["+(h.inverted?"^":"")+y.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(h){return h.description}};function r(h){return h.charCodeAt(0).toString(16).toUpperCase()}function o(h){return h.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(y){return"\\x0"+r(y)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(y){return"\\x"+r(y)})}function f(h){return h.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(y){return"\\x0"+r(y)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(y){return"\\x"+r(y)})}function d(h){return n[h.type](h)}return"Expected "+function(h){var y,F,S=h.map(d);if(S.sort(),S.length>0){for(y=1,F=1;y<S.length;y++)S[y-1]!==S[y]&&(S[F]=S[y],F++);S.length=F}switch(S.length){case 1:return S[0];case 2:return S[0]+" or "+S[1];default:return S.slice(0,-1).join(", ")+", or "+S[S.length-1]}}(t)+" but "+function(h){return h?'"'+o(h)+'"':"end of input"}(e)+" found."},_$parser_72={SyntaxError:peg$SyntaxError,parse:function(t,e){var n,r={},o=(e=e!==void 0?e:{}).grammarSource,f={Grammar:jn},d=jn,h=/^[\n\r\u2028\u2029]/,y=/^[0-9]/,F=/^[0-9a-f]/i,S=/^[{}]/,T=/^[a-z\xB5\xDF-\xF6\xF8-\xFF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137-\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148-\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C-\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA-\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9-\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC-\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF-\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F-\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0-\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB-\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE-\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0529\u052B\u052D\u052F\u0561-\u0587\u13F8-\u13FD\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6-\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FC7\u1FD0-\u1FD3\u1FD6-\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6-\u1FF7\u210A\u210E-\u210F\u2113\u212F\u2134\u2139\u213C-\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5E\u2C61\u2C65-\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73-\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3-\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA699\uA69B\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793-\uA795\uA797\uA799\uA79B\uA79D\uA79F\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7B5\uA7B7\uA7FA\uAB30-\uAB5A\uAB60-\uAB65\uAB70-\uABBF\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A]/,U=/^[\u02B0-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0374\u037A\u0559\u0640\u06E5-\u06E6\u07F4-\u07F5\u07FA\u081A\u0824\u0828\u0971\u0E46\u0EC6\u10FC\u17D7\u1843\u1AA7\u1C78-\u1C7D\u1D2C-\u1D6A\u1D78\u1D9B-\u1DBF\u2071\u207F\u2090-\u209C\u2C7C-\u2C7D\u2D6F\u2E2F\u3005\u3031-\u3035\u303B\u309D-\u309E\u30FC-\u30FE\uA015\uA4F8-\uA4FD\uA60C\uA67F\uA69C-\uA69D\uA717-\uA71F\uA770\uA788\uA7F8-\uA7F9\uA9CF\uA9E6\uAA70\uAADD\uAAF3-\uAAF4\uAB5C-\uAB5F\uFF70\uFF9E-\uFF9F]/,M=/^[\xAA\xBA\u01BB\u01C0-\u01C3\u0294\u05D0-\u05EA\u05F0-\u05F2\u0620-\u063F\u0641-\u064A\u066E-\u066F\u0671-\u06D3\u06D5\u06EE-\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u0800-\u0815\u0840-\u0858\u08A0-\u08B4\u0904-\u0939\u093D\u0950\u0958-\u0961\u0972-\u0980\u0985-\u098C\u098F-\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC-\u09DD\u09DF-\u09E1\u09F0-\u09F1\u0A05-\u0A0A\u0A0F-\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32-\u0A33\u0A35-\u0A36\u0A38-\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2-\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0-\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F-\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32-\u0B33\u0B35-\u0B39\u0B3D\u0B5C-\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99-\u0B9A\u0B9C\u0B9E-\u0B9F\u0BA3-\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60-\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0-\u0CE1\u0CF1-\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32-\u0E33\u0E40-\u0E45\u0E81-\u0E82\u0E84\u0E87-\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA-\u0EAB\u0EAD-\u0EB0\u0EB2-\u0EB3\u0EBD\u0EC0-\u0EC4\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065-\u1066\u106E-\u1070\u1075-\u1081\u108E\u10D0-\u10FA\u10FD-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17DC\u1820-\u1842\u1844-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE-\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C77\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5-\u1CF6\u2135-\u2138\u2D30-\u2D67\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3006\u303C\u3041-\u3096\u309F\u30A1-\u30FA\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA014\uA016-\uA48C\uA4D0-\uA4F7\uA500-\uA60B\uA610-\uA61F\uA62A-\uA62B\uA66E\uA6A0-\uA6E5\uA78F\uA7F7\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9E0-\uA9E4\uA9E7-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA6F\uAA71-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5-\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADC\uAAE0-\uAAEA\uAAF2\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF66-\uFF6F\uFF71-\uFF9D\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,Y=/^[\u01C5\u01C8\u01CB\u01F2\u1F88-\u1F8F\u1F98-\u1F9F\u1FA8-\u1FAF\u1FBC\u1FCC\u1FFC]/,Z=/^[A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178-\u0179\u017B\u017D\u0181-\u0182\u0184\u0186-\u0187\u0189-\u018B\u018E-\u0191\u0193-\u0194\u0196-\u0198\u019C-\u019D\u019F-\u01A0\u01A2\u01A4\u01A6-\u01A7\u01A9\u01AC\u01AE-\u01AF\u01B1-\u01B3\u01B5\u01B7-\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A-\u023B\u023D-\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E-\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9-\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0-\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E-\u213F\u2145\u2183\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D-\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AD\uA7B0-\uA7B4\uA7B6\uFF21-\uFF3A]/,D=/^[\u0903\u093B\u093E-\u0940\u0949-\u094C\u094E-\u094F\u0982-\u0983\u09BE-\u09C0\u09C7-\u09C8\u09CB-\u09CC\u09D7\u0A03\u0A3E-\u0A40\u0A83\u0ABE-\u0AC0\u0AC9\u0ACB-\u0ACC\u0B02-\u0B03\u0B3E\u0B40\u0B47-\u0B48\u0B4B-\u0B4C\u0B57\u0BBE-\u0BBF\u0BC1-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCC\u0BD7\u0C01-\u0C03\u0C41-\u0C44\u0C82-\u0C83\u0CBE\u0CC0-\u0CC4\u0CC7-\u0CC8\u0CCA-\u0CCB\u0CD5-\u0CD6\u0D02-\u0D03\u0D3E-\u0D40\u0D46-\u0D48\u0D4A-\u0D4C\u0D57\u0D82-\u0D83\u0DCF-\u0DD1\u0DD8-\u0DDF\u0DF2-\u0DF3\u0F3E-\u0F3F\u0F7F\u102B-\u102C\u1031\u1038\u103B-\u103C\u1056-\u1057\u1062-\u1064\u1067-\u106D\u1083-\u1084\u1087-\u108C\u108F\u109A-\u109C\u17B6\u17BE-\u17C5\u17C7-\u17C8\u1923-\u1926\u1929-\u192B\u1930-\u1931\u1933-\u1938\u1A19-\u1A1A\u1A55\u1A57\u1A61\u1A63-\u1A64\u1A6D-\u1A72\u1B04\u1B35\u1B3B\u1B3D-\u1B41\u1B43-\u1B44\u1B82\u1BA1\u1BA6-\u1BA7\u1BAA\u1BE7\u1BEA-\u1BEC\u1BEE\u1BF2-\u1BF3\u1C24-\u1C2B\u1C34-\u1C35\u1CE1\u1CF2-\u1CF3\u302E-\u302F\uA823-\uA824\uA827\uA880-\uA881\uA8B4-\uA8C3\uA952-\uA953\uA983\uA9B4-\uA9B5\uA9BA-\uA9BB\uA9BD-\uA9C0\uAA2F-\uAA30\uAA33-\uAA34\uAA4D\uAA7B\uAA7D\uAAEB\uAAEE-\uAAEF\uAAF5\uABE3-\uABE4\uABE6-\uABE7\uABE9-\uABEA\uABEC]/,nt=/^[\u0300-\u036F\u0483-\u0487\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962-\u0963\u0981\u09BC\u09C1-\u09C4\u09CD\u09E2-\u09E3\u0A01-\u0A02\u0A3C\u0A41-\u0A42\u0A47-\u0A48\u0A4B-\u0A4D\u0A51\u0A70-\u0A71\u0A75\u0A81-\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7-\u0AC8\u0ACD\u0AE2-\u0AE3\u0B01\u0B3C\u0B3F\u0B41-\u0B44\u0B4D\u0B56\u0B62-\u0B63\u0B82\u0BC0\u0BCD\u0C00\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55-\u0C56\u0C62-\u0C63\u0C81\u0CBC\u0CBF\u0CC6\u0CCC-\u0CCD\u0CE2-\u0CE3\u0D01\u0D41-\u0D44\u0D4D\u0D62-\u0D63\u0DCA\u0DD2-\u0DD4\u0DD6\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB-\u0EBC\u0EC8-\u0ECD\u0F18-\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86-\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039-\u103A\u103D-\u103E\u1058-\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085-\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752-\u1753\u1772-\u1773\u17B4-\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u1922\u1927-\u1928\u1932\u1939-\u193B\u1A17-\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ABD\u1B00-\u1B03\u1B34\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80-\u1B81\u1BA2-\u1BA5\u1BA8-\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8-\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8-\u1CF9\u1DC0-\u1DF5\u1DFC-\u1DFF\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302D\u3099-\u309A\uA66F\uA674-\uA67D\uA69E-\uA69F\uA6F0-\uA6F1\uA802\uA806\uA80B\uA825-\uA826\uA8C4\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9E5\uAA29-\uAA2E\uAA31-\uAA32\uAA35-\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7-\uAAB8\uAABE-\uAABF\uAAC1\uAAEC-\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/,ct=/^[0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19]/,at=/^[\u16EE-\u16F0\u2160-\u2182\u2185-\u2188\u3007\u3021-\u3029\u3038-\u303A\uA6E6-\uA6EF]/,et=/^[_\u203F-\u2040\u2054\uFE33-\uFE34\uFE4D-\uFE4F\uFF3F]/,mt=/^[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,At=Ie("{",!1),dt=Ie("}",!1),ht=Ie("=",!1),xt=Ie("/",!1),l=Ie("@",!1),s=Ie(":",!1),v=Ie("$",!1),$=Ie("&",!1),E=Ie("!",!1),rt=Ie("?",!1),gt=Ie("*",!1),Et=Ie("+",!1),Ct=Ie("(",!1),x=Ie(")",!1),N={type:"any"},G=Ue("whitespace"),A=Ie("	",!1),C=Ie("\v",!1),j=Ie("\f",!1),K=Ie(" ",!1),J=Ie("\xA0",!1),yt=Ie("\uFEFF",!1),Dt=fr([`
`,"\r","\u2028","\u2029"],!1,!1),Xt=Ue("end of line"),_e=Ie(`
`,!1),me=Ie(`\r
`,!1),de=Ie("\r",!1),Zt=Ie("\u2028",!1),Vt=Ie("\u2029",!1),pe=Ue("comment"),ge=Ie("/*",!1),jt=Ie("*/",!1),Bt=Ie("//",!1),ie=Ue("identifier"),ee=Ie("_",!1),Kt=Ie("\\",!1),be=Ie("\u200C",!1),b=Ie("\u200D",!1),Be=Ue("literal"),ce=Ie("i",!1),Gt=Ue("string"),ze=Ie('"',!1),We=Ie("'",!1),Xe=Ue("character class"),nr=Ie("[",!1),lr=Ie("^",!1),ur=Ie("]",!1),Me=Ie("-",!1),Ke=Ie("0",!1),Ir=Ie("b",!1),Le=Ie("f",!1),qr=Ie("n",!1),hr=Ie("r",!1),Sr=Ie("t",!1),Xr=Ie("v",!1),Kr=Ie("x",!1),Qe=Ie("u",!1),Je=fr([["0","9"]],!1,!1),tr=fr([["0","9"],["a","f"]],!1,!0),an=Ie(".",!1),Vr=Ue("code block"),Gr=fr(["{","}"],!1,!1),Yr=fr([["a","z"],"\xB5",["\xDF","\xF6"],["\xF8","\xFF"],"\u0101","\u0103","\u0105","\u0107","\u0109","\u010B","\u010D","\u010F","\u0111","\u0113","\u0115","\u0117","\u0119","\u011B","\u011D","\u011F","\u0121","\u0123","\u0125","\u0127","\u0129","\u012B","\u012D","\u012F","\u0131","\u0133","\u0135",["\u0137","\u0138"],"\u013A","\u013C","\u013E","\u0140","\u0142","\u0144","\u0146",["\u0148","\u0149"],"\u014B","\u014D","\u014F","\u0151","\u0153","\u0155","\u0157","\u0159","\u015B","\u015D","\u015F","\u0161","\u0163","\u0165","\u0167","\u0169","\u016B","\u016D","\u016F","\u0171","\u0173","\u0175","\u0177","\u017A","\u017C",["\u017E","\u0180"],"\u0183","\u0185","\u0188",["\u018C","\u018D"],"\u0192","\u0195",["\u0199","\u019B"],"\u019E","\u01A1","\u01A3","\u01A5","\u01A8",["\u01AA","\u01AB"],"\u01AD","\u01B0","\u01B4","\u01B6",["\u01B9","\u01BA"],["\u01BD","\u01BF"],"\u01C6","\u01C9","\u01CC","\u01CE","\u01D0","\u01D2","\u01D4","\u01D6","\u01D8","\u01DA",["\u01DC","\u01DD"],"\u01DF","\u01E1","\u01E3","\u01E5","\u01E7","\u01E9","\u01EB","\u01ED",["\u01EF","\u01F0"],"\u01F3","\u01F5","\u01F9","\u01FB","\u01FD","\u01FF","\u0201","\u0203","\u0205","\u0207","\u0209","\u020B","\u020D","\u020F","\u0211","\u0213","\u0215","\u0217","\u0219","\u021B","\u021D","\u021F","\u0221","\u0223","\u0225","\u0227","\u0229","\u022B","\u022D","\u022F","\u0231",["\u0233","\u0239"],"\u023C",["\u023F","\u0240"],"\u0242","\u0247","\u0249","\u024B","\u024D",["\u024F","\u0293"],["\u0295","\u02AF"],"\u0371","\u0373","\u0377",["\u037B","\u037D"],"\u0390",["\u03AC","\u03CE"],["\u03D0","\u03D1"],["\u03D5","\u03D7"],"\u03D9","\u03DB","\u03DD","\u03DF","\u03E1","\u03E3","\u03E5","\u03E7","\u03E9","\u03EB","\u03ED",["\u03EF","\u03F3"],"\u03F5","\u03F8",["\u03FB","\u03FC"],["\u0430","\u045F"],"\u0461","\u0463","\u0465","\u0467","\u0469","\u046B","\u046D","\u046F","\u0471","\u0473","\u0475","\u0477","\u0479","\u047B","\u047D","\u047F","\u0481","\u048B","\u048D","\u048F","\u0491","\u0493","\u0495","\u0497","\u0499","\u049B","\u049D","\u049F","\u04A1","\u04A3","\u04A5","\u04A7","\u04A9","\u04AB","\u04AD","\u04AF","\u04B1","\u04B3","\u04B5","\u04B7","\u04B9","\u04BB","\u04BD","\u04BF","\u04C2","\u04C4","\u04C6","\u04C8","\u04CA","\u04CC",["\u04CE","\u04CF"],"\u04D1","\u04D3","\u04D5","\u04D7","\u04D9","\u04DB","\u04DD","\u04DF","\u04E1","\u04E3","\u04E5","\u04E7","\u04E9","\u04EB","\u04ED","\u04EF","\u04F1","\u04F3","\u04F5","\u04F7","\u04F9","\u04FB","\u04FD","\u04FF","\u0501","\u0503","\u0505","\u0507","\u0509","\u050B","\u050D","\u050F","\u0511","\u0513","\u0515","\u0517","\u0519","\u051B","\u051D","\u051F","\u0521","\u0523","\u0525","\u0527","\u0529","\u052B","\u052D","\u052F",["\u0561","\u0587"],["\u13F8","\u13FD"],["\u1D00","\u1D2B"],["\u1D6B","\u1D77"],["\u1D79","\u1D9A"],"\u1E01","\u1E03","\u1E05","\u1E07","\u1E09","\u1E0B","\u1E0D","\u1E0F","\u1E11","\u1E13","\u1E15","\u1E17","\u1E19","\u1E1B","\u1E1D","\u1E1F","\u1E21","\u1E23","\u1E25","\u1E27","\u1E29","\u1E2B","\u1E2D","\u1E2F","\u1E31","\u1E33","\u1E35","\u1E37","\u1E39","\u1E3B","\u1E3D","\u1E3F","\u1E41","\u1E43","\u1E45","\u1E47","\u1E49","\u1E4B","\u1E4D","\u1E4F","\u1E51","\u1E53","\u1E55","\u1E57","\u1E59","\u1E5B","\u1E5D","\u1E5F","\u1E61","\u1E63","\u1E65","\u1E67","\u1E69","\u1E6B","\u1E6D","\u1E6F","\u1E71","\u1E73","\u1E75","\u1E77","\u1E79","\u1E7B","\u1E7D","\u1E7F","\u1E81","\u1E83","\u1E85","\u1E87","\u1E89","\u1E8B","\u1E8D","\u1E8F","\u1E91","\u1E93",["\u1E95","\u1E9D"],"\u1E9F","\u1EA1","\u1EA3","\u1EA5","\u1EA7","\u1EA9","\u1EAB","\u1EAD","\u1EAF","\u1EB1","\u1EB3","\u1EB5","\u1EB7","\u1EB9","\u1EBB","\u1EBD","\u1EBF","\u1EC1","\u1EC3","\u1EC5","\u1EC7","\u1EC9","\u1ECB","\u1ECD","\u1ECF","\u1ED1","\u1ED3","\u1ED5","\u1ED7","\u1ED9","\u1EDB","\u1EDD","\u1EDF","\u1EE1","\u1EE3","\u1EE5","\u1EE7","\u1EE9","\u1EEB","\u1EED","\u1EEF","\u1EF1","\u1EF3","\u1EF5","\u1EF7","\u1EF9","\u1EFB","\u1EFD",["\u1EFF","\u1F07"],["\u1F10","\u1F15"],["\u1F20","\u1F27"],["\u1F30","\u1F37"],["\u1F40","\u1F45"],["\u1F50","\u1F57"],["\u1F60","\u1F67"],["\u1F70","\u1F7D"],["\u1F80","\u1F87"],["\u1F90","\u1F97"],["\u1FA0","\u1FA7"],["\u1FB0","\u1FB4"],["\u1FB6","\u1FB7"],"\u1FBE",["\u1FC2","\u1FC4"],["\u1FC6","\u1FC7"],["\u1FD0","\u1FD3"],["\u1FD6","\u1FD7"],["\u1FE0","\u1FE7"],["\u1FF2","\u1FF4"],["\u1FF6","\u1FF7"],"\u210A",["\u210E","\u210F"],"\u2113","\u212F","\u2134","\u2139",["\u213C","\u213D"],["\u2146","\u2149"],"\u214E","\u2184",["\u2C30","\u2C5E"],"\u2C61",["\u2C65","\u2C66"],"\u2C68","\u2C6A","\u2C6C","\u2C71",["\u2C73","\u2C74"],["\u2C76","\u2C7B"],"\u2C81","\u2C83","\u2C85","\u2C87","\u2C89","\u2C8B","\u2C8D","\u2C8F","\u2C91","\u2C93","\u2C95","\u2C97","\u2C99","\u2C9B","\u2C9D","\u2C9F","\u2CA1","\u2CA3","\u2CA5","\u2CA7","\u2CA9","\u2CAB","\u2CAD","\u2CAF","\u2CB1","\u2CB3","\u2CB5","\u2CB7","\u2CB9","\u2CBB","\u2CBD","\u2CBF","\u2CC1","\u2CC3","\u2CC5","\u2CC7","\u2CC9","\u2CCB","\u2CCD","\u2CCF","\u2CD1","\u2CD3","\u2CD5","\u2CD7","\u2CD9","\u2CDB","\u2CDD","\u2CDF","\u2CE1",["\u2CE3","\u2CE4"],"\u2CEC","\u2CEE","\u2CF3",["\u2D00","\u2D25"],"\u2D27","\u2D2D","\uA641","\uA643","\uA645","\uA647","\uA649","\uA64B","\uA64D","\uA64F","\uA651","\uA653","\uA655","\uA657","\uA659","\uA65B","\uA65D","\uA65F","\uA661","\uA663","\uA665","\uA667","\uA669","\uA66B","\uA66D","\uA681","\uA683","\uA685","\uA687","\uA689","\uA68B","\uA68D","\uA68F","\uA691","\uA693","\uA695","\uA697","\uA699","\uA69B","\uA723","\uA725","\uA727","\uA729","\uA72B","\uA72D",["\uA72F","\uA731"],"\uA733","\uA735","\uA737","\uA739","\uA73B","\uA73D","\uA73F","\uA741","\uA743","\uA745","\uA747","\uA749","\uA74B","\uA74D","\uA74F","\uA751","\uA753","\uA755","\uA757","\uA759","\uA75B","\uA75D","\uA75F","\uA761","\uA763","\uA765","\uA767","\uA769","\uA76B","\uA76D","\uA76F",["\uA771","\uA778"],"\uA77A","\uA77C","\uA77F","\uA781","\uA783","\uA785","\uA787","\uA78C","\uA78E","\uA791",["\uA793","\uA795"],"\uA797","\uA799","\uA79B","\uA79D","\uA79F","\uA7A1","\uA7A3","\uA7A5","\uA7A7","\uA7A9","\uA7B5","\uA7B7","\uA7FA",["\uAB30","\uAB5A"],["\uAB60","\uAB65"],["\uAB70","\uABBF"],["\uFB00","\uFB06"],["\uFB13","\uFB17"],["\uFF41","\uFF5A"]],!1,!1),Jr=fr([["\u02B0","\u02C1"],["\u02C6","\u02D1"],["\u02E0","\u02E4"],"\u02EC","\u02EE","\u0374","\u037A","\u0559","\u0640",["\u06E5","\u06E6"],["\u07F4","\u07F5"],"\u07FA","\u081A","\u0824","\u0828","\u0971","\u0E46","\u0EC6","\u10FC","\u17D7","\u1843","\u1AA7",["\u1C78","\u1C7D"],["\u1D2C","\u1D6A"],"\u1D78",["\u1D9B","\u1DBF"],"\u2071","\u207F",["\u2090","\u209C"],["\u2C7C","\u2C7D"],"\u2D6F","\u2E2F","\u3005",["\u3031","\u3035"],"\u303B",["\u309D","\u309E"],["\u30FC","\u30FE"],"\uA015",["\uA4F8","\uA4FD"],"\uA60C","\uA67F",["\uA69C","\uA69D"],["\uA717","\uA71F"],"\uA770","\uA788",["\uA7F8","\uA7F9"],"\uA9CF","\uA9E6","\uAA70","\uAADD",["\uAAF3","\uAAF4"],["\uAB5C","\uAB5F"],"\uFF70",["\uFF9E","\uFF9F"]],!1,!1),sn=fr(["\xAA","\xBA","\u01BB",["\u01C0","\u01C3"],"\u0294",["\u05D0","\u05EA"],["\u05F0","\u05F2"],["\u0620","\u063F"],["\u0641","\u064A"],["\u066E","\u066F"],["\u0671","\u06D3"],"\u06D5",["\u06EE","\u06EF"],["\u06FA","\u06FC"],"\u06FF","\u0710",["\u0712","\u072F"],["\u074D","\u07A5"],"\u07B1",["\u07CA","\u07EA"],["\u0800","\u0815"],["\u0840","\u0858"],["\u08A0","\u08B4"],["\u0904","\u0939"],"\u093D","\u0950",["\u0958","\u0961"],["\u0972","\u0980"],["\u0985","\u098C"],["\u098F","\u0990"],["\u0993","\u09A8"],["\u09AA","\u09B0"],"\u09B2",["\u09B6","\u09B9"],"\u09BD","\u09CE",["\u09DC","\u09DD"],["\u09DF","\u09E1"],["\u09F0","\u09F1"],["\u0A05","\u0A0A"],["\u0A0F","\u0A10"],["\u0A13","\u0A28"],["\u0A2A","\u0A30"],["\u0A32","\u0A33"],["\u0A35","\u0A36"],["\u0A38","\u0A39"],["\u0A59","\u0A5C"],"\u0A5E",["\u0A72","\u0A74"],["\u0A85","\u0A8D"],["\u0A8F","\u0A91"],["\u0A93","\u0AA8"],["\u0AAA","\u0AB0"],["\u0AB2","\u0AB3"],["\u0AB5","\u0AB9"],"\u0ABD","\u0AD0",["\u0AE0","\u0AE1"],"\u0AF9",["\u0B05","\u0B0C"],["\u0B0F","\u0B10"],["\u0B13","\u0B28"],["\u0B2A","\u0B30"],["\u0B32","\u0B33"],["\u0B35","\u0B39"],"\u0B3D",["\u0B5C","\u0B5D"],["\u0B5F","\u0B61"],"\u0B71","\u0B83",["\u0B85","\u0B8A"],["\u0B8E","\u0B90"],["\u0B92","\u0B95"],["\u0B99","\u0B9A"],"\u0B9C",["\u0B9E","\u0B9F"],["\u0BA3","\u0BA4"],["\u0BA8","\u0BAA"],["\u0BAE","\u0BB9"],"\u0BD0",["\u0C05","\u0C0C"],["\u0C0E","\u0C10"],["\u0C12","\u0C28"],["\u0C2A","\u0C39"],"\u0C3D",["\u0C58","\u0C5A"],["\u0C60","\u0C61"],["\u0C85","\u0C8C"],["\u0C8E","\u0C90"],["\u0C92","\u0CA8"],["\u0CAA","\u0CB3"],["\u0CB5","\u0CB9"],"\u0CBD","\u0CDE",["\u0CE0","\u0CE1"],["\u0CF1","\u0CF2"],["\u0D05","\u0D0C"],["\u0D0E","\u0D10"],["\u0D12","\u0D3A"],"\u0D3D","\u0D4E",["\u0D5F","\u0D61"],["\u0D7A","\u0D7F"],["\u0D85","\u0D96"],["\u0D9A","\u0DB1"],["\u0DB3","\u0DBB"],"\u0DBD",["\u0DC0","\u0DC6"],["\u0E01","\u0E30"],["\u0E32","\u0E33"],["\u0E40","\u0E45"],["\u0E81","\u0E82"],"\u0E84",["\u0E87","\u0E88"],"\u0E8A","\u0E8D",["\u0E94","\u0E97"],["\u0E99","\u0E9F"],["\u0EA1","\u0EA3"],"\u0EA5","\u0EA7",["\u0EAA","\u0EAB"],["\u0EAD","\u0EB0"],["\u0EB2","\u0EB3"],"\u0EBD",["\u0EC0","\u0EC4"],["\u0EDC","\u0EDF"],"\u0F00",["\u0F40","\u0F47"],["\u0F49","\u0F6C"],["\u0F88","\u0F8C"],["\u1000","\u102A"],"\u103F",["\u1050","\u1055"],["\u105A","\u105D"],"\u1061",["\u1065","\u1066"],["\u106E","\u1070"],["\u1075","\u1081"],"\u108E",["\u10D0","\u10FA"],["\u10FD","\u1248"],["\u124A","\u124D"],["\u1250","\u1256"],"\u1258",["\u125A","\u125D"],["\u1260","\u1288"],["\u128A","\u128D"],["\u1290","\u12B0"],["\u12B2","\u12B5"],["\u12B8","\u12BE"],"\u12C0",["\u12C2","\u12C5"],["\u12C8","\u12D6"],["\u12D8","\u1310"],["\u1312","\u1315"],["\u1318","\u135A"],["\u1380","\u138F"],["\u1401","\u166C"],["\u166F","\u167F"],["\u1681","\u169A"],["\u16A0","\u16EA"],["\u16F1","\u16F8"],["\u1700","\u170C"],["\u170E","\u1711"],["\u1720","\u1731"],["\u1740","\u1751"],["\u1760","\u176C"],["\u176E","\u1770"],["\u1780","\u17B3"],"\u17DC",["\u1820","\u1842"],["\u1844","\u1877"],["\u1880","\u18A8"],"\u18AA",["\u18B0","\u18F5"],["\u1900","\u191E"],["\u1950","\u196D"],["\u1970","\u1974"],["\u1980","\u19AB"],["\u19B0","\u19C9"],["\u1A00","\u1A16"],["\u1A20","\u1A54"],["\u1B05","\u1B33"],["\u1B45","\u1B4B"],["\u1B83","\u1BA0"],["\u1BAE","\u1BAF"],["\u1BBA","\u1BE5"],["\u1C00","\u1C23"],["\u1C4D","\u1C4F"],["\u1C5A","\u1C77"],["\u1CE9","\u1CEC"],["\u1CEE","\u1CF1"],["\u1CF5","\u1CF6"],["\u2135","\u2138"],["\u2D30","\u2D67"],["\u2D80","\u2D96"],["\u2DA0","\u2DA6"],["\u2DA8","\u2DAE"],["\u2DB0","\u2DB6"],["\u2DB8","\u2DBE"],["\u2DC0","\u2DC6"],["\u2DC8","\u2DCE"],["\u2DD0","\u2DD6"],["\u2DD8","\u2DDE"],"\u3006","\u303C",["\u3041","\u3096"],"\u309F",["\u30A1","\u30FA"],"\u30FF",["\u3105","\u312D"],["\u3131","\u318E"],["\u31A0","\u31BA"],["\u31F0","\u31FF"],["\u3400","\u4DB5"],["\u4E00","\u9FD5"],["\uA000","\uA014"],["\uA016","\uA48C"],["\uA4D0","\uA4F7"],["\uA500","\uA60B"],["\uA610","\uA61F"],["\uA62A","\uA62B"],"\uA66E",["\uA6A0","\uA6E5"],"\uA78F","\uA7F7",["\uA7FB","\uA801"],["\uA803","\uA805"],["\uA807","\uA80A"],["\uA80C","\uA822"],["\uA840","\uA873"],["\uA882","\uA8B3"],["\uA8F2","\uA8F7"],"\uA8FB","\uA8FD",["\uA90A","\uA925"],["\uA930","\uA946"],["\uA960","\uA97C"],["\uA984","\uA9B2"],["\uA9E0","\uA9E4"],["\uA9E7","\uA9EF"],["\uA9FA","\uA9FE"],["\uAA00","\uAA28"],["\uAA40","\uAA42"],["\uAA44","\uAA4B"],["\uAA60","\uAA6F"],["\uAA71","\uAA76"],"\uAA7A",["\uAA7E","\uAAAF"],"\uAAB1",["\uAAB5","\uAAB6"],["\uAAB9","\uAABD"],"\uAAC0","\uAAC2",["\uAADB","\uAADC"],["\uAAE0","\uAAEA"],"\uAAF2",["\uAB01","\uAB06"],["\uAB09","\uAB0E"],["\uAB11","\uAB16"],["\uAB20","\uAB26"],["\uAB28","\uAB2E"],["\uABC0","\uABE2"],["\uAC00","\uD7A3"],["\uD7B0","\uD7C6"],["\uD7CB","\uD7FB"],["\uF900","\uFA6D"],["\uFA70","\uFAD9"],"\uFB1D",["\uFB1F","\uFB28"],["\uFB2A","\uFB36"],["\uFB38","\uFB3C"],"\uFB3E",["\uFB40","\uFB41"],["\uFB43","\uFB44"],["\uFB46","\uFBB1"],["\uFBD3","\uFD3D"],["\uFD50","\uFD8F"],["\uFD92","\uFDC7"],["\uFDF0","\uFDFB"],["\uFE70","\uFE74"],["\uFE76","\uFEFC"],["\uFF66","\uFF6F"],["\uFF71","\uFF9D"],["\uFFA0","\uFFBE"],["\uFFC2","\uFFC7"],["\uFFCA","\uFFCF"],["\uFFD2","\uFFD7"],["\uFFDA","\uFFDC"]],!1,!1),se=fr(["\u01C5","\u01C8","\u01CB","\u01F2",["\u1F88","\u1F8F"],["\u1F98","\u1F9F"],["\u1FA8","\u1FAF"],"\u1FBC","\u1FCC","\u1FFC"],!1,!1),ye=fr([["A","Z"],["\xC0","\xD6"],["\xD8","\xDE"],"\u0100","\u0102","\u0104","\u0106","\u0108","\u010A","\u010C","\u010E","\u0110","\u0112","\u0114","\u0116","\u0118","\u011A","\u011C","\u011E","\u0120","\u0122","\u0124","\u0126","\u0128","\u012A","\u012C","\u012E","\u0130","\u0132","\u0134","\u0136","\u0139","\u013B","\u013D","\u013F","\u0141","\u0143","\u0145","\u0147","\u014A","\u014C","\u014E","\u0150","\u0152","\u0154","\u0156","\u0158","\u015A","\u015C","\u015E","\u0160","\u0162","\u0164","\u0166","\u0168","\u016A","\u016C","\u016E","\u0170","\u0172","\u0174","\u0176",["\u0178","\u0179"],"\u017B","\u017D",["\u0181","\u0182"],"\u0184",["\u0186","\u0187"],["\u0189","\u018B"],["\u018E","\u0191"],["\u0193","\u0194"],["\u0196","\u0198"],["\u019C","\u019D"],["\u019F","\u01A0"],"\u01A2","\u01A4",["\u01A6","\u01A7"],"\u01A9","\u01AC",["\u01AE","\u01AF"],["\u01B1","\u01B3"],"\u01B5",["\u01B7","\u01B8"],"\u01BC","\u01C4","\u01C7","\u01CA","\u01CD","\u01CF","\u01D1","\u01D3","\u01D5","\u01D7","\u01D9","\u01DB","\u01DE","\u01E0","\u01E2","\u01E4","\u01E6","\u01E8","\u01EA","\u01EC","\u01EE","\u01F1","\u01F4",["\u01F6","\u01F8"],"\u01FA","\u01FC","\u01FE","\u0200","\u0202","\u0204","\u0206","\u0208","\u020A","\u020C","\u020E","\u0210","\u0212","\u0214","\u0216","\u0218","\u021A","\u021C","\u021E","\u0220","\u0222","\u0224","\u0226","\u0228","\u022A","\u022C","\u022E","\u0230","\u0232",["\u023A","\u023B"],["\u023D","\u023E"],"\u0241",["\u0243","\u0246"],"\u0248","\u024A","\u024C","\u024E","\u0370","\u0372","\u0376","\u037F","\u0386",["\u0388","\u038A"],"\u038C",["\u038E","\u038F"],["\u0391","\u03A1"],["\u03A3","\u03AB"],"\u03CF",["\u03D2","\u03D4"],"\u03D8","\u03DA","\u03DC","\u03DE","\u03E0","\u03E2","\u03E4","\u03E6","\u03E8","\u03EA","\u03EC","\u03EE","\u03F4","\u03F7",["\u03F9","\u03FA"],["\u03FD","\u042F"],"\u0460","\u0462","\u0464","\u0466","\u0468","\u046A","\u046C","\u046E","\u0470","\u0472","\u0474","\u0476","\u0478","\u047A","\u047C","\u047E","\u0480","\u048A","\u048C","\u048E","\u0490","\u0492","\u0494","\u0496","\u0498","\u049A","\u049C","\u049E","\u04A0","\u04A2","\u04A4","\u04A6","\u04A8","\u04AA","\u04AC","\u04AE","\u04B0","\u04B2","\u04B4","\u04B6","\u04B8","\u04BA","\u04BC","\u04BE",["\u04C0","\u04C1"],"\u04C3","\u04C5","\u04C7","\u04C9","\u04CB","\u04CD","\u04D0","\u04D2","\u04D4","\u04D6","\u04D8","\u04DA","\u04DC","\u04DE","\u04E0","\u04E2","\u04E4","\u04E6","\u04E8","\u04EA","\u04EC","\u04EE","\u04F0","\u04F2","\u04F4","\u04F6","\u04F8","\u04FA","\u04FC","\u04FE","\u0500","\u0502","\u0504","\u0506","\u0508","\u050A","\u050C","\u050E","\u0510","\u0512","\u0514","\u0516","\u0518","\u051A","\u051C","\u051E","\u0520","\u0522","\u0524","\u0526","\u0528","\u052A","\u052C","\u052E",["\u0531","\u0556"],["\u10A0","\u10C5"],"\u10C7","\u10CD",["\u13A0","\u13F5"],"\u1E00","\u1E02","\u1E04","\u1E06","\u1E08","\u1E0A","\u1E0C","\u1E0E","\u1E10","\u1E12","\u1E14","\u1E16","\u1E18","\u1E1A","\u1E1C","\u1E1E","\u1E20","\u1E22","\u1E24","\u1E26","\u1E28","\u1E2A","\u1E2C","\u1E2E","\u1E30","\u1E32","\u1E34","\u1E36","\u1E38","\u1E3A","\u1E3C","\u1E3E","\u1E40","\u1E42","\u1E44","\u1E46","\u1E48","\u1E4A","\u1E4C","\u1E4E","\u1E50","\u1E52","\u1E54","\u1E56","\u1E58","\u1E5A","\u1E5C","\u1E5E","\u1E60","\u1E62","\u1E64","\u1E66","\u1E68","\u1E6A","\u1E6C","\u1E6E","\u1E70","\u1E72","\u1E74","\u1E76","\u1E78","\u1E7A","\u1E7C","\u1E7E","\u1E80","\u1E82","\u1E84","\u1E86","\u1E88","\u1E8A","\u1E8C","\u1E8E","\u1E90","\u1E92","\u1E94","\u1E9E","\u1EA0","\u1EA2","\u1EA4","\u1EA6","\u1EA8","\u1EAA","\u1EAC","\u1EAE","\u1EB0","\u1EB2","\u1EB4","\u1EB6","\u1EB8","\u1EBA","\u1EBC","\u1EBE","\u1EC0","\u1EC2","\u1EC4","\u1EC6","\u1EC8","\u1ECA","\u1ECC","\u1ECE","\u1ED0","\u1ED2","\u1ED4","\u1ED6","\u1ED8","\u1EDA","\u1EDC","\u1EDE","\u1EE0","\u1EE2","\u1EE4","\u1EE6","\u1EE8","\u1EEA","\u1EEC","\u1EEE","\u1EF0","\u1EF2","\u1EF4","\u1EF6","\u1EF8","\u1EFA","\u1EFC","\u1EFE",["\u1F08","\u1F0F"],["\u1F18","\u1F1D"],["\u1F28","\u1F2F"],["\u1F38","\u1F3F"],["\u1F48","\u1F4D"],"\u1F59","\u1F5B","\u1F5D","\u1F5F",["\u1F68","\u1F6F"],["\u1FB8","\u1FBB"],["\u1FC8","\u1FCB"],["\u1FD8","\u1FDB"],["\u1FE8","\u1FEC"],["\u1FF8","\u1FFB"],"\u2102","\u2107",["\u210B","\u210D"],["\u2110","\u2112"],"\u2115",["\u2119","\u211D"],"\u2124","\u2126","\u2128",["\u212A","\u212D"],["\u2130","\u2133"],["\u213E","\u213F"],"\u2145","\u2183",["\u2C00","\u2C2E"],"\u2C60",["\u2C62","\u2C64"],"\u2C67","\u2C69","\u2C6B",["\u2C6D","\u2C70"],"\u2C72","\u2C75",["\u2C7E","\u2C80"],"\u2C82","\u2C84","\u2C86","\u2C88","\u2C8A","\u2C8C","\u2C8E","\u2C90","\u2C92","\u2C94","\u2C96","\u2C98","\u2C9A","\u2C9C","\u2C9E","\u2CA0","\u2CA2","\u2CA4","\u2CA6","\u2CA8","\u2CAA","\u2CAC","\u2CAE","\u2CB0","\u2CB2","\u2CB4","\u2CB6","\u2CB8","\u2CBA","\u2CBC","\u2CBE","\u2CC0","\u2CC2","\u2CC4","\u2CC6","\u2CC8","\u2CCA","\u2CCC","\u2CCE","\u2CD0","\u2CD2","\u2CD4","\u2CD6","\u2CD8","\u2CDA","\u2CDC","\u2CDE","\u2CE0","\u2CE2","\u2CEB","\u2CED","\u2CF2","\uA640","\uA642","\uA644","\uA646","\uA648","\uA64A","\uA64C","\uA64E","\uA650","\uA652","\uA654","\uA656","\uA658","\uA65A","\uA65C","\uA65E","\uA660","\uA662","\uA664","\uA666","\uA668","\uA66A","\uA66C","\uA680","\uA682","\uA684","\uA686","\uA688","\uA68A","\uA68C","\uA68E","\uA690","\uA692","\uA694","\uA696","\uA698","\uA69A","\uA722","\uA724","\uA726","\uA728","\uA72A","\uA72C","\uA72E","\uA732","\uA734","\uA736","\uA738","\uA73A","\uA73C","\uA73E","\uA740","\uA742","\uA744","\uA746","\uA748","\uA74A","\uA74C","\uA74E","\uA750","\uA752","\uA754","\uA756","\uA758","\uA75A","\uA75C","\uA75E","\uA760","\uA762","\uA764","\uA766","\uA768","\uA76A","\uA76C","\uA76E","\uA779","\uA77B",["\uA77D","\uA77E"],"\uA780","\uA782","\uA784","\uA786","\uA78B","\uA78D","\uA790","\uA792","\uA796","\uA798","\uA79A","\uA79C","\uA79E","\uA7A0","\uA7A2","\uA7A4","\uA7A6","\uA7A8",["\uA7AA","\uA7AD"],["\uA7B0","\uA7B4"],"\uA7B6",["\uFF21","\uFF3A"]],!1,!1),Re=fr(["\u0903","\u093B",["\u093E","\u0940"],["\u0949","\u094C"],["\u094E","\u094F"],["\u0982","\u0983"],["\u09BE","\u09C0"],["\u09C7","\u09C8"],["\u09CB","\u09CC"],"\u09D7","\u0A03",["\u0A3E","\u0A40"],"\u0A83",["\u0ABE","\u0AC0"],"\u0AC9",["\u0ACB","\u0ACC"],["\u0B02","\u0B03"],"\u0B3E","\u0B40",["\u0B47","\u0B48"],["\u0B4B","\u0B4C"],"\u0B57",["\u0BBE","\u0BBF"],["\u0BC1","\u0BC2"],["\u0BC6","\u0BC8"],["\u0BCA","\u0BCC"],"\u0BD7",["\u0C01","\u0C03"],["\u0C41","\u0C44"],["\u0C82","\u0C83"],"\u0CBE",["\u0CC0","\u0CC4"],["\u0CC7","\u0CC8"],["\u0CCA","\u0CCB"],["\u0CD5","\u0CD6"],["\u0D02","\u0D03"],["\u0D3E","\u0D40"],["\u0D46","\u0D48"],["\u0D4A","\u0D4C"],"\u0D57",["\u0D82","\u0D83"],["\u0DCF","\u0DD1"],["\u0DD8","\u0DDF"],["\u0DF2","\u0DF3"],["\u0F3E","\u0F3F"],"\u0F7F",["\u102B","\u102C"],"\u1031","\u1038",["\u103B","\u103C"],["\u1056","\u1057"],["\u1062","\u1064"],["\u1067","\u106D"],["\u1083","\u1084"],["\u1087","\u108C"],"\u108F",["\u109A","\u109C"],"\u17B6",["\u17BE","\u17C5"],["\u17C7","\u17C8"],["\u1923","\u1926"],["\u1929","\u192B"],["\u1930","\u1931"],["\u1933","\u1938"],["\u1A19","\u1A1A"],"\u1A55","\u1A57","\u1A61",["\u1A63","\u1A64"],["\u1A6D","\u1A72"],"\u1B04","\u1B35","\u1B3B",["\u1B3D","\u1B41"],["\u1B43","\u1B44"],"\u1B82","\u1BA1",["\u1BA6","\u1BA7"],"\u1BAA","\u1BE7",["\u1BEA","\u1BEC"],"\u1BEE",["\u1BF2","\u1BF3"],["\u1C24","\u1C2B"],["\u1C34","\u1C35"],"\u1CE1",["\u1CF2","\u1CF3"],["\u302E","\u302F"],["\uA823","\uA824"],"\uA827",["\uA880","\uA881"],["\uA8B4","\uA8C3"],["\uA952","\uA953"],"\uA983",["\uA9B4","\uA9B5"],["\uA9BA","\uA9BB"],["\uA9BD","\uA9C0"],["\uAA2F","\uAA30"],["\uAA33","\uAA34"],"\uAA4D","\uAA7B","\uAA7D","\uAAEB",["\uAAEE","\uAAEF"],"\uAAF5",["\uABE3","\uABE4"],["\uABE6","\uABE7"],["\uABE9","\uABEA"],"\uABEC"],!1,!1),ar=fr([["\u0300","\u036F"],["\u0483","\u0487"],["\u0591","\u05BD"],"\u05BF",["\u05C1","\u05C2"],["\u05C4","\u05C5"],"\u05C7",["\u0610","\u061A"],["\u064B","\u065F"],"\u0670",["\u06D6","\u06DC"],["\u06DF","\u06E4"],["\u06E7","\u06E8"],["\u06EA","\u06ED"],"\u0711",["\u0730","\u074A"],["\u07A6","\u07B0"],["\u07EB","\u07F3"],["\u0816","\u0819"],["\u081B","\u0823"],["\u0825","\u0827"],["\u0829","\u082D"],["\u0859","\u085B"],["\u08E3","\u0902"],"\u093A","\u093C",["\u0941","\u0948"],"\u094D",["\u0951","\u0957"],["\u0962","\u0963"],"\u0981","\u09BC",["\u09C1","\u09C4"],"\u09CD",["\u09E2","\u09E3"],["\u0A01","\u0A02"],"\u0A3C",["\u0A41","\u0A42"],["\u0A47","\u0A48"],["\u0A4B","\u0A4D"],"\u0A51",["\u0A70","\u0A71"],"\u0A75",["\u0A81","\u0A82"],"\u0ABC",["\u0AC1","\u0AC5"],["\u0AC7","\u0AC8"],"\u0ACD",["\u0AE2","\u0AE3"],"\u0B01","\u0B3C","\u0B3F",["\u0B41","\u0B44"],"\u0B4D","\u0B56",["\u0B62","\u0B63"],"\u0B82","\u0BC0","\u0BCD","\u0C00",["\u0C3E","\u0C40"],["\u0C46","\u0C48"],["\u0C4A","\u0C4D"],["\u0C55","\u0C56"],["\u0C62","\u0C63"],"\u0C81","\u0CBC","\u0CBF","\u0CC6",["\u0CCC","\u0CCD"],["\u0CE2","\u0CE3"],"\u0D01",["\u0D41","\u0D44"],"\u0D4D",["\u0D62","\u0D63"],"\u0DCA",["\u0DD2","\u0DD4"],"\u0DD6","\u0E31",["\u0E34","\u0E3A"],["\u0E47","\u0E4E"],"\u0EB1",["\u0EB4","\u0EB9"],["\u0EBB","\u0EBC"],["\u0EC8","\u0ECD"],["\u0F18","\u0F19"],"\u0F35","\u0F37","\u0F39",["\u0F71","\u0F7E"],["\u0F80","\u0F84"],["\u0F86","\u0F87"],["\u0F8D","\u0F97"],["\u0F99","\u0FBC"],"\u0FC6",["\u102D","\u1030"],["\u1032","\u1037"],["\u1039","\u103A"],["\u103D","\u103E"],["\u1058","\u1059"],["\u105E","\u1060"],["\u1071","\u1074"],"\u1082",["\u1085","\u1086"],"\u108D","\u109D",["\u135D","\u135F"],["\u1712","\u1714"],["\u1732","\u1734"],["\u1752","\u1753"],["\u1772","\u1773"],["\u17B4","\u17B5"],["\u17B7","\u17BD"],"\u17C6",["\u17C9","\u17D3"],"\u17DD",["\u180B","\u180D"],"\u18A9",["\u1920","\u1922"],["\u1927","\u1928"],"\u1932",["\u1939","\u193B"],["\u1A17","\u1A18"],"\u1A1B","\u1A56",["\u1A58","\u1A5E"],"\u1A60","\u1A62",["\u1A65","\u1A6C"],["\u1A73","\u1A7C"],"\u1A7F",["\u1AB0","\u1ABD"],["\u1B00","\u1B03"],"\u1B34",["\u1B36","\u1B3A"],"\u1B3C","\u1B42",["\u1B6B","\u1B73"],["\u1B80","\u1B81"],["\u1BA2","\u1BA5"],["\u1BA8","\u1BA9"],["\u1BAB","\u1BAD"],"\u1BE6",["\u1BE8","\u1BE9"],"\u1BED",["\u1BEF","\u1BF1"],["\u1C2C","\u1C33"],["\u1C36","\u1C37"],["\u1CD0","\u1CD2"],["\u1CD4","\u1CE0"],["\u1CE2","\u1CE8"],"\u1CED","\u1CF4",["\u1CF8","\u1CF9"],["\u1DC0","\u1DF5"],["\u1DFC","\u1DFF"],["\u20D0","\u20DC"],"\u20E1",["\u20E5","\u20F0"],["\u2CEF","\u2CF1"],"\u2D7F",["\u2DE0","\u2DFF"],["\u302A","\u302D"],["\u3099","\u309A"],"\uA66F",["\uA674","\uA67D"],["\uA69E","\uA69F"],["\uA6F0","\uA6F1"],"\uA802","\uA806","\uA80B",["\uA825","\uA826"],"\uA8C4",["\uA8E0","\uA8F1"],["\uA926","\uA92D"],["\uA947","\uA951"],["\uA980","\uA982"],"\uA9B3",["\uA9B6","\uA9B9"],"\uA9BC","\uA9E5",["\uAA29","\uAA2E"],["\uAA31","\uAA32"],["\uAA35","\uAA36"],"\uAA43","\uAA4C","\uAA7C","\uAAB0",["\uAAB2","\uAAB4"],["\uAAB7","\uAAB8"],["\uAABE","\uAABF"],"\uAAC1",["\uAAEC","\uAAED"],"\uAAF6","\uABE5","\uABE8","\uABED","\uFB1E",["\uFE00","\uFE0F"],["\uFE20","\uFE2F"]],!1,!1),he=fr([["0","9"],["\u0660","\u0669"],["\u06F0","\u06F9"],["\u07C0","\u07C9"],["\u0966","\u096F"],["\u09E6","\u09EF"],["\u0A66","\u0A6F"],["\u0AE6","\u0AEF"],["\u0B66","\u0B6F"],["\u0BE6","\u0BEF"],["\u0C66","\u0C6F"],["\u0CE6","\u0CEF"],["\u0D66","\u0D6F"],["\u0DE6","\u0DEF"],["\u0E50","\u0E59"],["\u0ED0","\u0ED9"],["\u0F20","\u0F29"],["\u1040","\u1049"],["\u1090","\u1099"],["\u17E0","\u17E9"],["\u1810","\u1819"],["\u1946","\u194F"],["\u19D0","\u19D9"],["\u1A80","\u1A89"],["\u1A90","\u1A99"],["\u1B50","\u1B59"],["\u1BB0","\u1BB9"],["\u1C40","\u1C49"],["\u1C50","\u1C59"],["\uA620","\uA629"],["\uA8D0","\uA8D9"],["\uA900","\uA909"],["\uA9D0","\uA9D9"],["\uA9F0","\uA9F9"],["\uAA50","\uAA59"],["\uABF0","\uABF9"],["\uFF10","\uFF19"]],!1,!1),Zr=fr([["\u16EE","\u16F0"],["\u2160","\u2182"],["\u2185","\u2188"],"\u3007",["\u3021","\u3029"],["\u3038","\u303A"],["\uA6E6","\uA6EF"]],!1,!1),Ar=fr(["_",["\u203F","\u2040"],"\u2054",["\uFE33","\uFE34"],["\uFE4D","\uFE4F"],"\uFF3F"],!1,!1),un=fr([" ","\xA0","\u1680",["\u2000","\u200A"],"\u202F","\u205F","\u3000"],!1,!1),or=Ie(";",!1),X=0,xe=0,Tr=[{line:1,column:1}],gr=0,Ve=[],Ut=0;if("startRule"in e){if(!(e.startRule in f))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');d=f[e.startRule]}function sr(){return Te(xe,X)}function _n(Q,ft){throw function(vt,Rt){return new peg$SyntaxError(vt,null,null,Rt)}(Q,ft=ft!==void 0?ft:Te(xe,X))}function Ie(Q,ft){return{type:"literal",text:Q,ignoreCase:ft}}function fr(Q,ft,vt){return{type:"class",parts:Q,inverted:ft,ignoreCase:vt}}function Ue(Q){return{type:"other",description:Q}}function Yt(Q){var ft,vt=Tr[Q];if(vt)return vt;for(ft=Q-1;!Tr[ft];)ft--;for(vt={line:(vt=Tr[ft]).line,column:vt.column};ft<Q;)t.charCodeAt(ft)===10?(vt.line++,vt.column=1):vt.column++,ft++;return Tr[Q]=vt,vt}function Te(Q,ft){var vt=Yt(Q),Rt=Yt(ft);return{source:o,start:{offset:Q,line:vt.line,column:vt.column},end:{offset:ft,line:Rt.line,column:Rt.column}}}function Jt(Q){X<gr||(X>gr&&(gr=X,Ve=[]),Ve.push(Q))}function jn(){var Q,ft,vt,Rt,Ft,Nt;if(Q=X,Ht(),ft=X,(vt=function(){var re,te,St,kt;return re=X,t.charCodeAt(X)===123?(te="{",X++):(te=r,Ut===0&&Jt(At)),te!==r&&(St=Wt())!==r?(t.charCodeAt(X)===125?(kt="}",X++):(kt=r,Ut===0&&Jt(dt)),kt!==r&&Se()!==r?(xe=re,re=function(Tt){return{type:"top_level_initializer",code:Tt[0],codeLocation:Tt[1],location:sr()}}(St)):(X=re,re=r)):(X=re,re=r),re}())!==r?(Rt=Ht(),ft=vt):(X=ft,ft=r),ft===r&&(ft=null),vt=X,(Rt=function(){var re,te;return re=X,(te=Wt())!==r&&Se()!==r?(xe=re,re=function(St){return{type:"initializer",code:St[0],codeLocation:St[1],location:sr()}}(te)):(X=re,re=r),re}())!==r?(Ft=Ht(),vt=Rt):(X=vt,vt=r),vt===r&&(vt=null),Rt=[],Ft=X,(Nt=Pn())!==r?(Ht(),Ft=Nt):(X=Ft,Ft=r),Ft!==r)for(;Ft!==r;)Rt.push(Ft),Ft=X,(Nt=Pn())!==r?(Ht(),Ft=Nt):(X=Ft,Ft=r);else Rt=r;return Rt!==r?(xe=Q,Q={type:"grammar",topLevelInitializer:ft,initializer:vt,rules:Rt,location:sr()}):(X=Q,Q=r),Q}function Pn(){var Q,ft,vt,Rt,Ft;return Q=X,(ft=H())!==r?(Ht(),vt=X,(Rt=st())!==r?(Ht(),vt=Rt):(X=vt,vt=r),vt===r&&(vt=null),t.charCodeAt(X)===61?(Rt="=",X++):(Rt=r,Ut===0&&Jt(ht)),Rt!==r?(Ht(),(Ft=Ee())!==r&&Se()!==r?(xe=Q,Q=function(Nt,re,te){return{type:"rule",name:Nt[0],nameLocation:Nt[1],expression:re!==null?{type:"named",name:re,expression:te,location:sr()}:te,location:sr()}}(ft,vt,Ft)):(X=Q,Q=r)):(X=Q,Q=r)):(X=Q,Q=r),Q}function Ee(){var Q,ft,vt,Rt,Ft,Nt,re,te;if(Q=X,(ft=a())!==r){for(vt=[],Rt=X,Ht(),t.charCodeAt(X)===47?(Ft="/",X++):(Ft=r,Ut===0&&Jt(xt)),Ft!==r?(Ht(),(Nt=a())!==r?Rt=Nt:(X=Rt,Rt=r)):(X=Rt,Rt=r);Rt!==r;)vt.push(Rt),Rt=X,Ht(),t.charCodeAt(X)===47?(Ft="/",X++):(Ft=r,Ut===0&&Jt(xt)),Ft!==r?(Ht(),(Nt=a())!==r?Rt=Nt:(X=Rt,Rt=r)):(X=Rt,Rt=r);xe=Q,re=ft,Q=(te=vt).length>0?{type:"choice",alternatives:[re].concat(te),location:sr()}:re}else X=Q,Q=r;return Q}function a(){var Q,ft,vt,Rt;return Q=X,(ft=function(){var Ft,Nt,re,te,St,kt,Tt;if(Ft=X,(Nt=u())!==r){for(re=[],te=X,Ht(),(St=u())!==r?te=St:(X=te,te=r);te!==r;)re.push(te),te=X,Ht(),(St=u())!==r?te=St:(X=te,te=r);xe=Ft,kt=Nt,Ft=(Tt=re).length>0||kt.type==="labeled"&&kt.pick?{type:"sequence",elements:[kt].concat(Tt),location:sr()}:kt}else X=Ft,Ft=r;return Ft}())!==r?(vt=X,Ht(),(Rt=Wt())!==r?vt=Rt:(X=vt,vt=r),vt===r&&(vt=null),xe=Q,Q=function(Ft,Nt){return Nt!==null?{type:"action",expression:Ft,code:Nt[0],codeLocation:Nt[1],location:sr()}:Ft}(ft,vt)):(X=Q,Q=r),Q}function u(){var Q,ft,vt,Rt,Ft,Nt,re;return Q=X,(ft=function(){var te,St;return te=X,t.charCodeAt(X)===64?(St="@",X++):(St=r,Ut===0&&Jt(l)),St!==r&&(xe=te,St=sr()),St}())!==r?((vt=p())===r&&(vt=null),(Rt=g())!==r?(xe=Q,Ft=ft,Nt=vt,(re=Rt).type.startsWith("semantic_")&&_n('"@" cannot be used on a semantic predicate',Ft),Q={type:"labeled",label:Nt!==null?Nt[0]:null,labelLocation:Nt!==null?Nt[1]:Ft,pick:!0,expression:re,location:sr()}):(X=Q,Q=r)):(X=Q,Q=r),Q===r&&(Q=X,(ft=p())!==r?(vt=Ht(),(Rt=g())!==r?(xe=Q,Q=function(te,St){return{type:"labeled",label:te[0],labelLocation:te[1],expression:St,location:sr()}}(ft,Rt)):(X=Q,Q=r)):(X=Q,Q=r),Q===r&&(Q=g())),Q}function p(){var Q,ft,vt,Rt;return Q=X,(ft=H())!==r?(Ht(),t.charCodeAt(X)===58?(vt=":",X++):(vt=r,Ut===0&&Jt(s)),vt!==r?(xe=Q,Rt=ft,zt.indexOf(Rt[0])>=0&&_n(`Label can't be a reserved word "${Rt[0]}"`,Rt[1]),Q=Rt):(X=Q,Q=r)):(X=Q,Q=r),Q}function g(){var Q,ft,vt,Rt;return Q=X,(ft=function(){var Ft;return t.charCodeAt(X)===36?(Ft="$",X++):(Ft=r,Ut===0&&Jt(v)),Ft===r&&(t.charCodeAt(X)===38?(Ft="&",X++):(Ft=r,Ut===0&&Jt($)),Ft===r&&(t.charCodeAt(X)===33?(Ft="!",X++):(Ft=r,Ut===0&&Jt(E)))),Ft}())!==r?(Ht(),(vt=m())!==r?(xe=Q,Rt=vt,Q={type:OPS_TO_PREFIXED_TYPES[ft],expression:Rt,location:sr()}):(X=Q,Q=r)):(X=Q,Q=r),Q===r&&(Q=m()),Q}function m(){var Q,ft,vt,Rt;return Q=X,(ft=w())!==r?(Ht(),(vt=function(){var Ft;return t.charCodeAt(X)===63?(Ft="?",X++):(Ft=r,Ut===0&&Jt(rt)),Ft===r&&(t.charCodeAt(X)===42?(Ft="*",X++):(Ft=r,Ut===0&&Jt(gt)),Ft===r&&(t.charCodeAt(X)===43?(Ft="+",X++):(Ft=r,Ut===0&&Jt(Et)))),Ft}())!==r?(xe=Q,Rt=ft,Q={type:OPS_TO_SUFFIXED_TYPES[vt],expression:Rt,location:sr()}):(X=Q,Q=r)):(X=Q,Q=r),Q===r&&(Q=w()),Q}function w(){var Q,ft,vt,Rt,Ft;return(Q=function(){var Nt,re,te;return Ut++,Nt=X,(re=st())!==r?(t.charCodeAt(X)===105?(te="i",X++):(te=r,Ut===0&&Jt(ce)),te===r&&(te=null),xe=Nt,Nt={type:"literal",value:re,ignoreCase:te!==null,location:sr()}):(X=Nt,Nt=r),Ut--,Nt===r&&(re=r,Ut===0&&Jt(Be)),Nt}())===r&&(Q=function(){var Nt,re,te,St,kt,Tt,Qt,le;if(Ut++,Nt=X,t.charCodeAt(X)===91?(re="[",X++):(re=r,Ut===0&&Jt(nr)),re!==r){for(t.charCodeAt(X)===94?(te="^",X++):(te=r,Ut===0&&Jt(lr)),te===r&&(te=null),St=[],(kt=Mt())===r&&(kt=Lt());kt!==r;)St.push(kt),(kt=Mt())===r&&(kt=Lt());t.charCodeAt(X)===93?(kt="]",X++):(kt=r,Ut===0&&Jt(ur)),kt!==r?(t.charCodeAt(X)===105?(Tt="i",X++):(Tt=r,Ut===0&&Jt(ce)),Tt===r&&(Tt=null),xe=Nt,Qt=te,le=Tt,Nt={type:"class",parts:St.filter($e=>$e!==""),inverted:Qt!==null,ignoreCase:le!==null,location:sr()}):(X=Nt,Nt=r)}else X=Nt,Nt=r;return Ut--,Nt===r&&(re=r,Ut===0&&Jt(Xe)),Nt}())===r&&(Q=function(){var Nt,re;return Nt=X,t.charCodeAt(X)===46?(re=".",X++):(re=r,Ut===0&&Jt(an)),re!==r&&(xe=Nt,re={type:"any",location:sr()}),re}())===r&&(Q=function(){var Nt,re,te,St,kt,Tt,Qt;return Nt=X,(re=H())!==r?(te=X,Ut++,St=X,kt=Ht(),Tt=X,(Qt=st())!==r?Tt=Qt=[Qt,Ht()]:(X=Tt,Tt=r),Tt===r&&(Tt=null),t.charCodeAt(X)===61?(Qt="=",X++):(Qt=r,Ut===0&&Jt(ht)),Qt!==r?St=kt=[kt,Tt,Qt]:(X=St,St=r),Ut--,St===r?te=void 0:(X=te,te=r),te!==r?(xe=Nt,Nt=function(le){return{type:"rule_ref",name:le[0],location:sr()}}(re)):(X=Nt,Nt=r)):(X=Nt,Nt=r),Nt}())===r&&(Q=function(){var Nt,re,te;return Nt=X,(re=function(){var St;return t.charCodeAt(X)===38?(St="&",X++):(St=r,Ut===0&&Jt($)),St===r&&(t.charCodeAt(X)===33?(St="!",X++):(St=r,Ut===0&&Jt(E))),St}())!==r?(Ht(),(te=Wt())!==r?(xe=Nt,Nt=function(St,kt){return{type:OPS_TO_SEMANTIC_PREDICATE_TYPES[St],code:kt[0],codeLocation:kt[1],location:sr()}}(re,te)):(X=Nt,Nt=r)):(X=Nt,Nt=r),Nt}())===r&&(Q=X,t.charCodeAt(X)===40?(ft="(",X++):(ft=r,Ut===0&&Jt(Ct)),ft!==r?(Ht(),(vt=Ee())!==r?(Ht(),t.charCodeAt(X)===41?(Rt=")",X++):(Rt=r,Ut===0&&Jt(x)),Rt!==r?(xe=Q,Q=(Ft=vt).type==="labeled"||Ft.type==="sequence"?{type:"group",expression:Ft,location:sr()}:Ft):(X=Q,Q=r)):(X=Q,Q=r)):(X=Q,Q=r)),Q}function O(){var Q;return t.length>X?(Q=t.charAt(X),X++):(Q=r,Ut===0&&Jt(N)),Q}function R(){var Q;return Ut++,t.charCodeAt(X)===9?(Q="	",X++):(Q=r,Ut===0&&Jt(A)),Q===r&&(t.charCodeAt(X)===11?(Q="\v",X++):(Q=r,Ut===0&&Jt(C)),Q===r&&(t.charCodeAt(X)===12?(Q="\f",X++):(Q=r,Ut===0&&Jt(j)),Q===r&&(t.charCodeAt(X)===32?(Q=" ",X++):(Q=r,Ut===0&&Jt(K)),Q===r&&(t.charCodeAt(X)===160?(Q="\xA0",X++):(Q=r,Ut===0&&Jt(J)),Q===r&&(t.charCodeAt(X)===65279?(Q="\uFEFF",X++):(Q=r,Ut===0&&Jt(yt)),Q===r&&(Q=function(){var ft;return mt.test(t.charAt(X))?(ft=t.charAt(X),X++):(ft=r,Ut===0&&Jt(un)),ft}())))))),Ut--,Q===r&&Ut===0&&Jt(G),Q}function P(){var Q;return h.test(t.charAt(X))?(Q=t.charAt(X),X++):(Q=r,Ut===0&&Jt(Dt)),Q}function B(){var Q;return Ut++,t.charCodeAt(X)===10?(Q=`
`,X++):(Q=r,Ut===0&&Jt(_e)),Q===r&&(t.substr(X,2)===`\r
`?(Q=`\r
`,X+=2):(Q=r,Ut===0&&Jt(me)),Q===r&&(t.charCodeAt(X)===13?(Q="\r",X++):(Q=r,Ut===0&&Jt(de)),Q===r&&(t.charCodeAt(X)===8232?(Q="\u2028",X++):(Q=r,Ut===0&&Jt(Zt)),Q===r&&(t.charCodeAt(X)===8233?(Q="\u2029",X++):(Q=r,Ut===0&&Jt(Vt)))))),Ut--,Q===r&&Ut===0&&Jt(Xt),Q}function q(){var Q;return Ut++,(Q=function(){var ft,vt,Rt,Ft,Nt,re;if(ft=X,t.substr(X,2)==="/*"?(vt="/*",X+=2):(vt=r,Ut===0&&Jt(ge)),vt!==r){for(Rt=[],Ft=X,Nt=X,Ut++,t.substr(X,2)==="*/"?(re="*/",X+=2):(re=r,Ut===0&&Jt(jt)),Ut--,re===r?Nt=void 0:(X=Nt,Nt=r),Nt!==r&&(re=O())!==r?Ft=Nt=[Nt,re]:(X=Ft,Ft=r);Ft!==r;)Rt.push(Ft),Ft=X,Nt=X,Ut++,t.substr(X,2)==="*/"?(re="*/",X+=2):(re=r,Ut===0&&Jt(jt)),Ut--,re===r?Nt=void 0:(X=Nt,Nt=r),Nt!==r&&(re=O())!==r?Ft=Nt=[Nt,re]:(X=Ft,Ft=r);t.substr(X,2)==="*/"?(Ft="*/",X+=2):(Ft=r,Ut===0&&Jt(jt)),Ft!==r?ft=vt=[vt,Rt,Ft]:(X=ft,ft=r)}else X=ft,ft=r;return ft}())===r&&(Q=k()),Ut--,Q===r&&Ut===0&&Jt(pe),Q}function L(){var Q,ft,vt,Rt,Ft,Nt;if(Q=X,t.substr(X,2)==="/*"?(ft="/*",X+=2):(ft=r,Ut===0&&Jt(ge)),ft!==r){for(vt=[],Rt=X,Ft=X,Ut++,t.substr(X,2)==="*/"?(Nt="*/",X+=2):(Nt=r,Ut===0&&Jt(jt)),Nt===r&&(Nt=P()),Ut--,Nt===r?Ft=void 0:(X=Ft,Ft=r),Ft!==r&&(Nt=O())!==r?Rt=Ft=[Ft,Nt]:(X=Rt,Rt=r);Rt!==r;)vt.push(Rt),Rt=X,Ft=X,Ut++,t.substr(X,2)==="*/"?(Nt="*/",X+=2):(Nt=r,Ut===0&&Jt(jt)),Nt===r&&(Nt=P()),Ut--,Nt===r?Ft=void 0:(X=Ft,Ft=r),Ft!==r&&(Nt=O())!==r?Rt=Ft=[Ft,Nt]:(X=Rt,Rt=r);t.substr(X,2)==="*/"?(Rt="*/",X+=2):(Rt=r,Ut===0&&Jt(jt)),Rt!==r?Q=ft=[ft,vt,Rt]:(X=Q,Q=r)}else X=Q,Q=r;return Q}function k(){var Q,ft,vt,Rt,Ft,Nt;if(Q=X,t.substr(X,2)==="//"?(ft="//",X+=2):(ft=r,Ut===0&&Jt(Bt)),ft!==r){for(vt=[],Rt=X,Ft=X,Ut++,Nt=P(),Ut--,Nt===r?Ft=void 0:(X=Ft,Ft=r),Ft!==r&&(Nt=O())!==r?Rt=Ft=[Ft,Nt]:(X=Rt,Rt=r);Rt!==r;)vt.push(Rt),Rt=X,Ft=X,Ut++,Nt=P(),Ut--,Nt===r?Ft=void 0:(X=Ft,Ft=r),Ft!==r&&(Nt=O())!==r?Rt=Ft=[Ft,Nt]:(X=Rt,Rt=r);Q=ft=[ft,vt]}else X=Q,Q=r;return Q}function H(){var Q,ft,vt,Rt;if(Ut++,Q=X,(ft=W())!==r){for(vt=[],Rt=z();Rt!==r;)vt.push(Rt),Rt=z();xe=Q,Q=[ft+vt.join(""),sr()]}else X=Q,Q=r;return Ut--,Q===r&&(ft=r,Ut===0&&Jt(ie)),Q}function W(){var Q,ft,vt;return(Q=function(){var Rt;return(Rt=function(){var Ft;return Z.test(t.charAt(X))?(Ft=t.charAt(X),X++):(Ft=r,Ut===0&&Jt(ye)),Ft}())===r&&(Rt=function(){var Ft;return T.test(t.charAt(X))?(Ft=t.charAt(X),X++):(Ft=r,Ut===0&&Jt(Yr)),Ft}())===r&&(Rt=function(){var Ft;return Y.test(t.charAt(X))?(Ft=t.charAt(X),X++):(Ft=r,Ut===0&&Jt(se)),Ft}())===r&&(Rt=function(){var Ft;return U.test(t.charAt(X))?(Ft=t.charAt(X),X++):(Ft=r,Ut===0&&Jt(Jr)),Ft}())===r&&(Rt=function(){var Ft;return M.test(t.charAt(X))?(Ft=t.charAt(X),X++):(Ft=r,Ut===0&&Jt(sn)),Ft}())===r&&(Rt=function(){var Ft;return at.test(t.charAt(X))?(Ft=t.charAt(X),X++):(Ft=r,Ut===0&&Jt(Zr)),Ft}()),Rt}())===r&&(t.charCodeAt(X)===36?(Q="$",X++):(Q=r,Ut===0&&Jt(v)),Q===r&&(t.charCodeAt(X)===95?(Q="_",X++):(Q=r,Ut===0&&Jt(ee)),Q===r&&(Q=X,t.charCodeAt(X)===92?(ft="\\",X++):(ft=r,Ut===0&&Jt(Kt)),ft!==r&&(vt=it())!==r?Q=vt:(X=Q,Q=r)))),Q}function z(){var Q;return(Q=W())===r&&(Q=function(){var ft;return(ft=function(){var vt;return nt.test(t.charAt(X))?(vt=t.charAt(X),X++):(vt=r,Ut===0&&Jt(ar)),vt}())===r&&(ft=function(){var vt;return D.test(t.charAt(X))?(vt=t.charAt(X),X++):(vt=r,Ut===0&&Jt(Re)),vt}()),ft}())===r&&(Q=function(){var ft;return ct.test(t.charAt(X))?(ft=t.charAt(X),X++):(ft=r,Ut===0&&Jt(he)),ft}())===r&&(Q=function(){var ft;return et.test(t.charAt(X))?(ft=t.charAt(X),X++):(ft=r,Ut===0&&Jt(Ar)),ft}())===r&&(t.charCodeAt(X)===8204?(Q="\u200C",X++):(Q=r,Ut===0&&Jt(be)),Q===r&&(t.charCodeAt(X)===8205?(Q="\u200D",X++):(Q=r,Ut===0&&Jt(b)))),Q}function st(){var Q,ft,vt,Rt;if(Ut++,Q=X,t.charCodeAt(X)===34?(ft='"',X++):(ft=r,Ut===0&&Jt(ze)),ft!==r){for(vt=[],Rt=bt();Rt!==r;)vt.push(Rt),Rt=bt();t.charCodeAt(X)===34?(Rt='"',X++):(Rt=r,Ut===0&&Jt(ze)),Rt!==r?(xe=Q,Q=vt.join("")):(X=Q,Q=r)}else X=Q,Q=r;if(Q===r)if(Q=X,t.charCodeAt(X)===39?(ft="'",X++):(ft=r,Ut===0&&Jt(We)),ft!==r){for(vt=[],Rt=It();Rt!==r;)vt.push(Rt),Rt=It();t.charCodeAt(X)===39?(Rt="'",X++):(Rt=r,Ut===0&&Jt(We)),Rt!==r?(xe=Q,Q=function(Ft){return Ft.join("")}(vt)):(X=Q,Q=r)}else X=Q,Q=r;return Ut--,Q===r&&(ft=r,Ut===0&&Jt(Gt)),Q}function bt(){var Q,ft,vt,Rt;return Q=X,ft=X,vt=X,Ut++,t.charCodeAt(X)===34?(Rt='"',X++):(Rt=r,Ut===0&&Jt(ze)),Rt===r&&(t.charCodeAt(X)===92?(Rt="\\",X++):(Rt=r,Ut===0&&Jt(Kt)),Rt===r&&(Rt=P())),Ut--,Rt===r?vt=void 0:(X=vt,vt=r),vt!==r&&(Rt=O())!==r?ft=vt=[vt,Rt]:(X=ft,ft=r),(Q=ft!==r?t.substring(Q,X):ft)===r&&(Q=X,t.charCodeAt(X)===92?(ft="\\",X++):(ft=r,Ut===0&&Jt(Kt)),ft!==r&&(vt=ut())!==r?Q=vt:(X=Q,Q=r),Q===r&&(Q=tt())),Q}function It(){var Q,ft,vt,Rt;return Q=X,ft=X,vt=X,Ut++,t.charCodeAt(X)===39?(Rt="'",X++):(Rt=r,Ut===0&&Jt(We)),Rt===r&&(t.charCodeAt(X)===92?(Rt="\\",X++):(Rt=r,Ut===0&&Jt(Kt)),Rt===r&&(Rt=P())),Ut--,Rt===r?vt=void 0:(X=vt,vt=r),vt!==r&&(Rt=O())!==r?ft=vt=[vt,Rt]:(X=ft,ft=r),(Q=ft!==r?t.substring(Q,X):ft)===r&&(Q=X,t.charCodeAt(X)===92?(ft="\\",X++):(ft=r,Ut===0&&Jt(Kt)),ft!==r&&(vt=ut())!==r?Q=vt:(X=Q,Q=r),Q===r&&(Q=tt())),Q}function Mt(){var Q,ft,vt,Rt,Ft,Nt;return Q=X,(ft=Lt())!==r?(t.charCodeAt(X)===45?(vt="-",X++):(vt=r,Ut===0&&Jt(Me)),vt!==r&&(Rt=Lt())!==r?(xe=Q,Nt=Rt,(Ft=ft).charCodeAt(0)>Nt.charCodeAt(0)&&_n("Invalid character range: "+t.substring(xe,X)+"."),Q=[Ft,Nt]):(X=Q,Q=r)):(X=Q,Q=r),Q}function Lt(){var Q,ft,vt,Rt;return Q=X,ft=X,vt=X,Ut++,t.charCodeAt(X)===93?(Rt="]",X++):(Rt=r,Ut===0&&Jt(ur)),Rt===r&&(t.charCodeAt(X)===92?(Rt="\\",X++):(Rt=r,Ut===0&&Jt(Kt)),Rt===r&&(Rt=P())),Ut--,Rt===r?vt=void 0:(X=vt,vt=r),vt!==r&&(Rt=O())!==r?ft=vt=[vt,Rt]:(X=ft,ft=r),(Q=ft!==r?t.substring(Q,X):ft)===r&&(Q=X,t.charCodeAt(X)===92?(ft="\\",X++):(ft=r,Ut===0&&Jt(Kt)),ft!==r&&(vt=ut())!==r?Q=vt:(X=Q,Q=r),Q===r&&(Q=tt())),Q}function tt(){var Q,ft;return Q=X,t.charCodeAt(X)===92?(ft="\\",X++):(ft=r,Ut===0&&Jt(Kt)),ft!==r&&B()!==r?(xe=Q,Q=""):(X=Q,Q=r),Q}function ut(){var Q,ft,vt,Rt;return(Q=function(){var Ft;return(Ft=pt())===r&&(Ft=function(){var Nt,re,te,St;return Nt=X,re=X,te=X,Ut++,(St=function(){var kt;return(kt=pt())===r&&(kt=wt())===r&&(t.charCodeAt(X)===120?(kt="x",X++):(kt=r,Ut===0&&Jt(Kr)),kt===r&&(t.charCodeAt(X)===117?(kt="u",X++):(kt=r,Ut===0&&Jt(Qe)))),kt}())===r&&(St=P()),Ut--,St===r?te=void 0:(X=te,te=r),te!==r&&(St=O())!==r?re=te=[te,St]:(X=re,re=r),re!==r?t.substring(Nt,X):re}()),Ft}())===r&&(Q=X,t.charCodeAt(X)===48?(ft="0",X++):(ft=r,Ut===0&&Jt(Ke)),ft!==r?(vt=X,Ut++,Rt=wt(),Ut--,Rt===r?vt=void 0:(X=vt,vt=r),vt!==r?(xe=Q,Q="\0"):(X=Q,Q=r)):(X=Q,Q=r),Q===r&&(Q=function(){var Ft,Nt,re,te,St,kt,Tt;return Ft=X,t.charCodeAt(X)===120?(Nt="x",X++):(Nt=r,Ut===0&&Jt(Kr)),Nt!==r?(re=X,te=X,(St=$t())!==r&&(kt=$t())!==r?te=St=[St,kt]:(X=te,te=r),(re=te!==r?t.substring(re,X):te)!==r?(xe=Ft,Tt=re,Ft=String.fromCharCode(parseInt(Tt,16))):(X=Ft,Ft=r)):(X=Ft,Ft=r),Ft}())===r&&(Q=it())),Q}function pt(){var Q,ft;return t.charCodeAt(X)===39?(Q="'",X++):(Q=r,Ut===0&&Jt(We)),Q===r&&(t.charCodeAt(X)===34?(Q='"',X++):(Q=r,Ut===0&&Jt(ze)),Q===r&&(t.charCodeAt(X)===92?(Q="\\",X++):(Q=r,Ut===0&&Jt(Kt)),Q===r&&(Q=X,t.charCodeAt(X)===98?(ft="b",X++):(ft=r,Ut===0&&Jt(Ir)),ft!==r&&(xe=Q,ft="\b"),(Q=ft)===r&&(Q=X,t.charCodeAt(X)===102?(ft="f",X++):(ft=r,Ut===0&&Jt(Le)),ft!==r&&(xe=Q,ft="\f"),(Q=ft)===r&&(Q=X,t.charCodeAt(X)===110?(ft="n",X++):(ft=r,Ut===0&&Jt(qr)),ft!==r&&(xe=Q,ft=`
`),(Q=ft)===r&&(Q=X,t.charCodeAt(X)===114?(ft="r",X++):(ft=r,Ut===0&&Jt(hr)),ft!==r&&(xe=Q,ft="\r"),(Q=ft)===r&&(Q=X,t.charCodeAt(X)===116?(ft="t",X++):(ft=r,Ut===0&&Jt(Sr)),ft!==r&&(xe=Q,ft="	"),(Q=ft)===r&&(Q=X,t.charCodeAt(X)===118?(ft="v",X++):(ft=r,Ut===0&&Jt(Xr)),ft!==r&&(xe=Q,ft="\v"),Q=ft)))))))),Q}function it(){var Q,ft,vt,Rt,Ft,Nt,re,te,St;return Q=X,t.charCodeAt(X)===117?(ft="u",X++):(ft=r,Ut===0&&Jt(Qe)),ft!==r?(vt=X,Rt=X,(Ft=$t())!==r&&(Nt=$t())!==r&&(re=$t())!==r&&(te=$t())!==r?Rt=Ft=[Ft,Nt,re,te]:(X=Rt,Rt=r),(vt=Rt!==r?t.substring(vt,X):Rt)!==r?(xe=Q,St=vt,Q=String.fromCharCode(parseInt(St,16))):(X=Q,Q=r)):(X=Q,Q=r),Q}function wt(){var Q;return y.test(t.charAt(X))?(Q=t.charAt(X),X++):(Q=r,Ut===0&&Jt(Je)),Q}function $t(){var Q;return F.test(t.charAt(X))?(Q=t.charAt(X),X++):(Q=r,Ut===0&&Jt(tr)),Q}function Wt(){var Q,ft,vt,Rt;return Ut++,Q=X,t.charCodeAt(X)===123?(ft="{",X++):(ft=r,Ut===0&&Jt(At)),ft!==r?(vt=function(){var Ft,Nt;return Ft=X,Nt=function re(){var te,St,kt,Tt,Qt,le;if(te=X,St=[],kt=[],Tt=X,Qt=X,Ut++,S.test(t.charAt(X))?(le=t.charAt(X),X++):(le=r,Ut===0&&Jt(Gr)),Ut--,le===r?Qt=void 0:(X=Qt,Qt=r),Qt!==r&&(le=O())!==r?Tt=Qt=[Qt,le]:(X=Tt,Tt=r),Tt!==r)for(;Tt!==r;)kt.push(Tt),Tt=X,Qt=X,Ut++,S.test(t.charAt(X))?(le=t.charAt(X),X++):(le=r,Ut===0&&Jt(Gr)),Ut--,le===r?Qt=void 0:(X=Qt,Qt=r),Qt!==r&&(le=O())!==r?Tt=Qt=[Qt,le]:(X=Tt,Tt=r);else kt=r;for(kt===r&&(kt=X,t.charCodeAt(X)===123?(Tt="{",X++):(Tt=r,Ut===0&&Jt(At)),Tt!==r?(Qt=re(),t.charCodeAt(X)===125?(le="}",X++):(le=r,Ut===0&&Jt(dt)),le!==r?kt=Tt=[Tt,Qt,le]:(X=kt,kt=r)):(X=kt,kt=r));kt!==r;){if(St.push(kt),kt=[],Tt=X,Qt=X,Ut++,S.test(t.charAt(X))?(le=t.charAt(X),X++):(le=r,Ut===0&&Jt(Gr)),Ut--,le===r?Qt=void 0:(X=Qt,Qt=r),Qt!==r&&(le=O())!==r?Tt=Qt=[Qt,le]:(X=Tt,Tt=r),Tt!==r)for(;Tt!==r;)kt.push(Tt),Tt=X,Qt=X,Ut++,S.test(t.charAt(X))?(le=t.charAt(X),X++):(le=r,Ut===0&&Jt(Gr)),Ut--,le===r?Qt=void 0:(X=Qt,Qt=r),Qt!==r&&(le=O())!==r?Tt=Qt=[Qt,le]:(X=Tt,Tt=r);else kt=r;kt===r&&(kt=X,t.charCodeAt(X)===123?(Tt="{",X++):(Tt=r,Ut===0&&Jt(At)),Tt!==r?(Qt=re(),t.charCodeAt(X)===125?(le="}",X++):(le=r,Ut===0&&Jt(dt)),le!==r?kt=Tt=[Tt,Qt,le]:(X=kt,kt=r)):(X=kt,kt=r))}return t.substring(te,X)}(),xe=Ft,Nt=function(re){return[re,sr()]}(Nt)}(),t.charCodeAt(X)===125?(Rt="}",X++):(Rt=r,Ut===0&&Jt(dt)),Rt!==r?Q=vt:(X=Q,Q=r)):(X=Q,Q=r),Ut--,Q===r&&(ft=r,Ut===0&&Jt(Vr)),Q}function Ht(){var Q,ft;for(Q=[],(ft=R())===r&&(ft=B())===r&&(ft=q());ft!==r;)Q.push(ft),(ft=R())===r&&(ft=B())===r&&(ft=q());return Q}function Se(){var Q,ft,vt,Rt;return Q=X,ft=Ht(),t.charCodeAt(X)===59?(vt=";",X++):(vt=r,Ut===0&&Jt(or)),vt!==r?Q=ft=[ft,vt]:(X=Q,Q=r),Q===r&&(Q=X,ft=function(){var Ft,Nt;for(Ft=[],(Nt=R())===r&&(Nt=L());Nt!==r;)Ft.push(Nt),(Nt=R())===r&&(Nt=L());return Ft}(),(vt=k())===r&&(vt=null),(Rt=B())!==r?Q=ft=[ft,vt,Rt]:(X=Q,Q=r),Q===r&&(Q=X,ft=Ht(),(vt=function(){var Ft,Nt;return Ft=X,Ut++,t.length>X?(Nt=t.charAt(X),X++):(Nt=r,Ut===0&&Jt(N)),Ut--,Nt===r?Ft=void 0:(X=Ft,Ft=r),Ft}())!==r?Q=ft=[ft,vt]:(X=Q,Q=r))),Q}const zt=e.reservedWords||[];if((n=d())!==r&&X===t.length)return n;throw n!==r&&X<t.length&&Jt({type:"end"}),function(Q,ft,vt){return new peg$SyntaxError(peg$SyntaxError.buildMessage(Q,ft),Q,ft,vt)}(Ve,gr<t.length?t.charAt(gr):null,gr<t.length?Te(gr,gr+1):Te(gr,gr))}};const peg={VERSION:_$version_74,RESERVED_WORDS:["break","case","catch","class","const","continue","debugger","default","delete","do","else","export","extends","finally","for","function","if","import","in","instanceof","new","return","super","switch","this","throw","try","typeof","var","void","while","with","null","true","false","enum","implements","interface","let","package","private","protected","public","static","yield","await"],GrammarError:_$GrammarError_71,parser:_$parser_72,compiler:_$compiler_55,generate(t,e){const n="plugins"in(e=e!==void 0?e:{})?e.plugins:[],r={parser:peg.parser,passes:function(o){const f={};return Object.keys(o).forEach(d=>{f[d]=o[d].slice()}),f}(peg.compiler.passes),reservedWords:peg.RESERVED_WORDS.slice()};return n.forEach(o=>{o.use(r,e)}),peg.compiler.compile(r.parser.parse(t,{grammarSource:e.grammarSource,reservedWords:r.reservedWords}),r.passes,e)}};var _$peg_73=peg,_$surge_92={};function ___typeof_92(t){return(___typeof_92=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$surge_92,"__esModule",{value:!0}),_$surge_92.default=function(){return __parser_92||(__parser_92=peggy.generate(grammars)),__parser_92};var _templateObject,peggy=function(t,e){if(t&&t.__esModule)return t;if(t===null||___typeof_92(t)!=="object"&&typeof t!="function")return{default:t};var n=___getRequireWildcardCache_92(void 0);if(n&&n.has(t))return n.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var d=o?Object.getOwnPropertyDescriptor(t,f):null;d&&(d.get||d.set)?Object.defineProperty(r,f,d):r[f]=t[f]}return r.default=t,n&&n.set(t,r),r}(_$peg_73);function ___getRequireWildcardCache_92(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(___getRequireWildcardCache_92=function(r){return r?n:e})(t)}var strings,raw,__parser_92,grammars=String.raw(_templateObject||(strings=[`
// global initializer
{{
    function $set(obj, path, value) {
      if (Object(obj) !== obj) return obj;
      if (!Array.isArray(path)) path = path.toString().match(/[^.[]]+/g) || [];
      path
        .slice(0, -1)
        .reduce((a, c, i) => (Object(a[c]) === a[c] ? a[c] : (a[c] = Math.abs(path[i + 1]) >> 0 === +path[i + 1] ? [] : {})), obj)[
        path[path.length - 1]
      ] = value;
      return obj;
    }
}}

// per-parser initializer
{
    const proxy = {};
    const obfs = {};
    const $ = {};

    function handleWebsocket() {
        if (obfs.type === "ws") {
            proxy.network = "ws";
            $set(proxy, "ws-opts.path", obfs.path);
            $set(proxy, "ws-opts.headers", obfs['ws-headers']);
            if (proxy['ws-opts'] && proxy['ws-opts']['headers'] && proxy['ws-opts']['headers'].Host) {
                proxy['ws-opts']['headers'].Host = proxy['ws-opts']['headers'].Host.replace(/^"(.*)"$/, '$1')
            }
        }
    }
    function handleShadowTLS() {
        if (proxy['shadow-tls-password'] && !proxy['shadow-tls-version']) {
            proxy['shadow-tls-version'] = 2;
        }
    }
}

start = (shadowsocks/vmess/trojan/https/http/snell/socks5/socks5_tls/tuic/tuic_v5/wireguard/hysteria2/ssh/direct) {
    return proxy;
}

shadowsocks = tag equals "ss" address (method/passwordk/obfs/obfs_host/obfs_uri/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/udp_relay/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/udp_port/others)* {
    proxy.type = "ss";
    // handle obfs
    if (obfs.type == "http" || obfs.type === "tls") {
        proxy.plugin = "obfs";
        $set(proxy, "plugin-opts.mode", obfs.type);
        $set(proxy, "plugin-opts.host", obfs.host);
        $set(proxy, "plugin-opts.path", obfs.path);
    }
    handleShadowTLS();
}
vmess = tag equals "vmess" address (vmess_uuid/vmess_aead/ws/ws_path/ws_headers/method/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/tls/sni/tls_fingerprint/tls_verification/fast_open/udp_relay/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "vmess";
    proxy.cipher = proxy.cipher || "none";
    if (proxy.aead) {
        proxy.alterId = 0;
    } else {
        proxy.alterId = proxy.alterId || 0;
    }
    handleWebsocket();
    handleShadowTLS();
}
trojan = tag equals "trojan" address (passwordk/ws/ws_path/ws_headers/tls/sni/tls_fingerprint/tls_verification/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/udp_relay/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "trojan";
    handleWebsocket();
    handleShadowTLS();
}
https = tag equals "https" address (username password)? (usernamek passwordk)? (sni/tls_fingerprint/tls_verification/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "http";
    proxy.tls = true;
    handleShadowTLS();
}
http = tag equals "http" address (username password)? (usernamek passwordk)? (ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "http";
    handleShadowTLS();
}
ssh = tag equals "ssh" address (username password)? (usernamek passwordk)? (server_fingerprint/idle_timeout/private_key/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "ssh";
    handleShadowTLS();
}
snell = tag equals "snell" address (snell_version/snell_psk/obfs/obfs_host/obfs_uri/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/udp_relay/reuse/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "snell";
    // handle obfs
    if (obfs.type == "http" || obfs.type === "tls") {
        $set(proxy, "obfs-opts.mode", obfs.type);
        $set(proxy, "obfs-opts.host", obfs.host);
        $set(proxy, "obfs-opts.path", obfs.path);
    }
    handleShadowTLS();
}
tuic = tag equals "tuic" address (alpn/token/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/tls_fingerprint/tls_verification/sni/fast_open/tfo/ecn/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/port_hopping_interval/others)* {
    proxy.type = "tuic";
    handleShadowTLS();
}
tuic_v5 = tag equals "tuic-v5" address (alpn/passwordk/uuidk/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/tls_fingerprint/tls_verification/sni/fast_open/tfo/ecn/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/port_hopping_interval/others)* {
    proxy.type = "tuic";
    proxy.version = 5;
    handleShadowTLS();
}
wireguard = tag equals "wireguard" (section_name/no_error_alert/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "wireguard-surge";
    handleShadowTLS();
}
hysteria2 = tag equals "hysteria2" address (no_error_alert/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/sni/tls_verification/passwordk/tls_fingerprint/download_bandwidth/ecn/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/port_hopping_interval/others)* {
    proxy.type = "hysteria2";
    handleShadowTLS();
}
socks5 = tag equals "socks5" address (username password)? (usernamek passwordk)? (udp_relay/no_error_alert/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "socks5";
    handleShadowTLS();
}
socks5_tls = tag equals "socks5-tls" address (username password)? (usernamek passwordk)? (udp_relay/no_error_alert/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/sni/tls_fingerprint/tls_verification/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "socks5";
    proxy.tls = true;
    handleShadowTLS();
}
direct = tag equals "direct" (udp_relay/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/block_quic/others)* {
    proxy.type = "direct";
}
address = comma server:server comma port:port {
    proxy.server = server;
    proxy.port = port;
}

server = ip/domain

ip = & {
    const start = peg$currPos;
    let j = start;
    while (j < input.length) {
        if (input[j] === ",") break;
        j++;
    }
    peg$currPos = j;
    $.ip = input.substring(start, j).trim();
    return true;
} { return $.ip; }

domain = match:[0-9a-zA-z-_.]+ { 
    const domain = match.join(""); 
    if (/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/.test(domain)) {
        return domain;
    }
}

port = digits:[0-9]+ { 
    const port = parseInt(digits.join(""), 10); 
    if (port >= 0 && port <= 65535) {
    	return port;
    }
}

port_hopping_interval = comma "port-hopping-interval" equals match:$[0-9]+ { proxy["hop-interval"] = parseInt(match.trim()); }

username = & {
    let j = peg$currPos; 
    let start, end;
    let first = true;
    while (j < input.length) {
        if (input[j] === ',') {
            if (first) {
                start = j + 1;
                first = false;
            } else {
                end = j;
                break;
            }
        }
        j++;
    }
    const match = input.substring(start, end);
    if (match.indexOf("=") === -1) {
        $.username = match;
        peg$currPos = end;
        return true;
    }
} { proxy.username = $.username; }
password = comma match:[^,]+ { proxy.password = match.join(""); }

tls = comma "tls" equals flag:bool { proxy.tls = flag; }
sni = comma "sni" equals sni:("off"/domain) { 
    if (sni === "off") {
        proxy["disable-sni"] = true;
    } else {
        proxy.sni = sni;
    }
}
tls_verification = comma "skip-cert-verify" equals flag:bool { proxy["skip-cert-verify"] = flag; }
tls_fingerprint = comma "server-cert-fingerprint-sha256" equals tls_fingerprint:$[^,]+ { proxy["tls-fingerprint"] = tls_fingerprint.trim(); }

snell_psk = comma "psk" equals match:[^,]+ { proxy.psk = match.join(""); }
snell_version = comma "version" equals match:$[0-9]+ { proxy.version = parseInt(match.trim()); }

usernamek = comma "username" equals match:[^,]+ { proxy.username = match.join(""); }
passwordk = comma "password" equals match:[^,]+ { proxy.password = match.join("").replace(/^"(.*?)"$/, '$1').replace(/^'(.*?)'$/, '$1'); }
vmess_uuid = comma "username" equals match:[^,]+ { proxy.uuid = match.join(""); }
vmess_aead = comma "vmess-aead" equals flag:bool { proxy.aead = flag; }

method = comma "encrypt-method" equals cipher:cipher {
    proxy.cipher = cipher;
}
cipher = ("aes-128-cfb"/"aes-128-ctr"/"aes-128-gcm"/"aes-192-cfb"/"aes-192-ctr"/"aes-192-gcm"/"aes-256-cfb"/"aes-256-ctr"/"aes-256-gcm"/"bf-cfb"/"camellia-128-cfb"/"camellia-192-cfb"/"camellia-256-cfb"/"cast5-cfb"/"chacha20-ietf-poly1305"/"chacha20-ietf"/"chacha20-poly1305"/"chacha20"/"des-cfb"/"idea-cfb"/"none"/"rc2-cfb"/"rc4-md5"/"rc4"/"salsa20"/"seed-cfb"/"xchacha20-ietf-poly1305"/"2022-blake3-aes-128-gcm"/"2022-blake3-aes-256-gcm");

ws = comma "ws" equals flag:bool { obfs.type = "ws"; }
ws_headers = comma "ws-headers" equals headers:$[^,]+ {
    const pairs = headers.split("|");
    const result = {};
    pairs.forEach(pair => {
        const [key, value] = pair.trim().split(":");
        result[key.trim()] = value.trim();
    })
    obfs["ws-headers"] = result;
}
ws_path = comma "ws-path" equals path:uri { obfs.path = path; }

obfs = comma "obfs" equals type:("http"/"tls") { obfs.type = type; }
obfs_host = comma "obfs-host" equals host:domain { obfs.host = host; };
obfs_uri = comma "obfs-uri" equals path:uri { obfs.path = path }
uri = $[^,]+

udp_relay = comma "udp-relay" equals flag:bool { proxy.udp = flag; }
fast_open = comma "fast-open" equals flag:bool { proxy.tfo = flag; }
reuse = comma "reuse" equals flag:bool { proxy.reuse = flag; }
ecn = comma "ecn" equals flag:bool { proxy.ecn = flag; }
tfo = comma "tfo" equals flag:bool { proxy.tfo = flag; }
ip_version = comma "ip-version" equals match:[^,]+ { proxy["ip-version"] = match.join(""); }
section_name = comma "section-name" equals match:[^,]+ { proxy["section-name"] = match.join(""); }
no_error_alert = comma "no-error-alert" equals match:[^,]+ { proxy["no-error-alert"] = match.join(""); }
underlying_proxy = comma "underlying-proxy" equals match:[^,]+ { proxy["underlying-proxy"] = match.join(""); }
download_bandwidth = comma "download-bandwidth" equals match:[^,]+ { proxy.down = match.join(""); }
test_url = comma "test-url" equals match:[^,]+ { proxy["test-url"] = match.join(""); }
test_udp = comma "test-udp" equals match:[^,]+ { proxy["test-udp"] = match.join(""); }
test_timeout = comma "test-timeout" equals match:$[0-9]+ { proxy["test-timeout"] = parseInt(match.trim()); }
tos = comma "tos" equals match:$[0-9]+ { proxy.tos = parseInt(match.trim()); }
interface = comma "interface" equals match:[^,]+ { proxy.interface = match.join(""); }
allow_other_interface = comma "allow-other-interface" equals flag:bool { proxy["allow-other-interface"] = flag; }
hybrid = comma "hybrid" equals flag:bool { proxy.hybrid = flag; }
idle_timeout = comma "idle-timeout" equals match:$[0-9]+ { proxy["idle-timeout"] = parseInt(match.trim()); }
private_key = comma "private-key" equals match:[^,]+ { proxy["keystore-private-key"] = match.join("").replace(/^"(.*)"$/, '$1'); }
server_fingerprint = comma "server-fingerprint" equals match:[^,]+ { proxy["server-fingerprint"] = match.join("").replace(/^"(.*)"$/, '$1'); }
block_quic = comma "block-quic" equals match:[^,]+ { proxy["block-quic"] = match.join(""); }
udp_port = comma "udp-port" equals match:$[0-9]+ { proxy["udp-port"] = parseInt(match.trim()); }
shadow_tls_version = comma "shadow-tls-version" equals match:$[0-9]+ { proxy["shadow-tls-version"] = parseInt(match.trim()); }
shadow_tls_sni = comma "shadow-tls-sni" equals match:[^,]+ { proxy["shadow-tls-sni"] = match.join(""); }
shadow_tls_password = comma "shadow-tls-password" equals match:[^,]+ { proxy["shadow-tls-password"] = match.join(""); }
token = comma "token" equals match:[^,]+ { proxy.token = match.join(""); }
alpn = comma "alpn" equals match:[^,]+ { proxy.alpn = match.join(""); }
uuidk = comma "uuid" equals match:[^,]+ { proxy.uuid = match.join(""); }

tag = match:[^=,]* { proxy.name = match.join("").trim(); }
comma = _ "," _
equals = _ "=" _
_ = [ \r	]*
bool = b:("true"/"false") { return b === "true" }
others = comma [^=,]+ equals [^=,]+
`],(raw=[`
// global initializer
{{
    function $set(obj, path, value) {
      if (Object(obj) !== obj) return obj;
      if (!Array.isArray(path)) path = path.toString().match(/[^.[\\]]+/g) || [];
      path
        .slice(0, -1)
        .reduce((a, c, i) => (Object(a[c]) === a[c] ? a[c] : (a[c] = Math.abs(path[i + 1]) >> 0 === +path[i + 1] ? [] : {})), obj)[
        path[path.length - 1]
      ] = value;
      return obj;
    }
}}

// per-parser initializer
{
    const proxy = {};
    const obfs = {};
    const $ = {};

    function handleWebsocket() {
        if (obfs.type === "ws") {
            proxy.network = "ws";
            $set(proxy, "ws-opts.path", obfs.path);
            $set(proxy, "ws-opts.headers", obfs['ws-headers']);
            if (proxy['ws-opts'] && proxy['ws-opts']['headers'] && proxy['ws-opts']['headers'].Host) {
                proxy['ws-opts']['headers'].Host = proxy['ws-opts']['headers'].Host.replace(/^"(.*)"$/, '$1')
            }
        }
    }
    function handleShadowTLS() {
        if (proxy['shadow-tls-password'] && !proxy['shadow-tls-version']) {
            proxy['shadow-tls-version'] = 2;
        }
    }
}

start = (shadowsocks/vmess/trojan/https/http/snell/socks5/socks5_tls/tuic/tuic_v5/wireguard/hysteria2/ssh/direct) {
    return proxy;
}

shadowsocks = tag equals "ss" address (method/passwordk/obfs/obfs_host/obfs_uri/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/udp_relay/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/udp_port/others)* {
    proxy.type = "ss";
    // handle obfs
    if (obfs.type == "http" || obfs.type === "tls") {
        proxy.plugin = "obfs";
        $set(proxy, "plugin-opts.mode", obfs.type);
        $set(proxy, "plugin-opts.host", obfs.host);
        $set(proxy, "plugin-opts.path", obfs.path);
    }
    handleShadowTLS();
}
vmess = tag equals "vmess" address (vmess_uuid/vmess_aead/ws/ws_path/ws_headers/method/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/tls/sni/tls_fingerprint/tls_verification/fast_open/udp_relay/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "vmess";
    proxy.cipher = proxy.cipher || "none";
    if (proxy.aead) {
        proxy.alterId = 0;
    } else {
        proxy.alterId = proxy.alterId || 0;
    }
    handleWebsocket();
    handleShadowTLS();
}
trojan = tag equals "trojan" address (passwordk/ws/ws_path/ws_headers/tls/sni/tls_fingerprint/tls_verification/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/udp_relay/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "trojan";
    handleWebsocket();
    handleShadowTLS();
}
https = tag equals "https" address (username password)? (usernamek passwordk)? (sni/tls_fingerprint/tls_verification/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "http";
    proxy.tls = true;
    handleShadowTLS();
}
http = tag equals "http" address (username password)? (usernamek passwordk)? (ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "http";
    handleShadowTLS();
}
ssh = tag equals "ssh" address (username password)? (usernamek passwordk)? (server_fingerprint/idle_timeout/private_key/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "ssh";
    handleShadowTLS();
}
snell = tag equals "snell" address (snell_version/snell_psk/obfs/obfs_host/obfs_uri/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/udp_relay/reuse/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "snell";
    // handle obfs
    if (obfs.type == "http" || obfs.type === "tls") {
        $set(proxy, "obfs-opts.mode", obfs.type);
        $set(proxy, "obfs-opts.host", obfs.host);
        $set(proxy, "obfs-opts.path", obfs.path);
    }
    handleShadowTLS();
}
tuic = tag equals "tuic" address (alpn/token/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/tls_fingerprint/tls_verification/sni/fast_open/tfo/ecn/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/port_hopping_interval/others)* {
    proxy.type = "tuic";
    handleShadowTLS();
}
tuic_v5 = tag equals "tuic-v5" address (alpn/passwordk/uuidk/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/tls_fingerprint/tls_verification/sni/fast_open/tfo/ecn/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/port_hopping_interval/others)* {
    proxy.type = "tuic";
    proxy.version = 5;
    handleShadowTLS();
}
wireguard = tag equals "wireguard" (section_name/no_error_alert/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "wireguard-surge";
    handleShadowTLS();
}
hysteria2 = tag equals "hysteria2" address (no_error_alert/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/sni/tls_verification/passwordk/tls_fingerprint/download_bandwidth/ecn/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/port_hopping_interval/others)* {
    proxy.type = "hysteria2";
    handleShadowTLS();
}
socks5 = tag equals "socks5" address (username password)? (usernamek passwordk)? (udp_relay/no_error_alert/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "socks5";
    handleShadowTLS();
}
socks5_tls = tag equals "socks5-tls" address (username password)? (usernamek passwordk)? (udp_relay/no_error_alert/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/sni/tls_fingerprint/tls_verification/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "socks5";
    proxy.tls = true;
    handleShadowTLS();
}
direct = tag equals "direct" (udp_relay/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/block_quic/others)* {
    proxy.type = "direct";
}
address = comma server:server comma port:port {
    proxy.server = server;
    proxy.port = port;
}

server = ip/domain

ip = & {
    const start = peg$currPos;
    let j = start;
    while (j < input.length) {
        if (input[j] === ",") break;
        j++;
    }
    peg$currPos = j;
    $.ip = input.substring(start, j).trim();
    return true;
} { return $.ip; }

domain = match:[0-9a-zA-z-_.]+ { 
    const domain = match.join(""); 
    if (/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/.test(domain)) {
        return domain;
    }
}

port = digits:[0-9]+ { 
    const port = parseInt(digits.join(""), 10); 
    if (port >= 0 && port <= 65535) {
    	return port;
    }
}

port_hopping_interval = comma "port-hopping-interval" equals match:$[0-9]+ { proxy["hop-interval"] = parseInt(match.trim()); }

username = & {
    let j = peg$currPos; 
    let start, end;
    let first = true;
    while (j < input.length) {
        if (input[j] === ',') {
            if (first) {
                start = j + 1;
                first = false;
            } else {
                end = j;
                break;
            }
        }
        j++;
    }
    const match = input.substring(start, end);
    if (match.indexOf("=") === -1) {
        $.username = match;
        peg$currPos = end;
        return true;
    }
} { proxy.username = $.username; }
password = comma match:[^,]+ { proxy.password = match.join(""); }

tls = comma "tls" equals flag:bool { proxy.tls = flag; }
sni = comma "sni" equals sni:("off"/domain) { 
    if (sni === "off") {
        proxy["disable-sni"] = true;
    } else {
        proxy.sni = sni;
    }
}
tls_verification = comma "skip-cert-verify" equals flag:bool { proxy["skip-cert-verify"] = flag; }
tls_fingerprint = comma "server-cert-fingerprint-sha256" equals tls_fingerprint:$[^,]+ { proxy["tls-fingerprint"] = tls_fingerprint.trim(); }

snell_psk = comma "psk" equals match:[^,]+ { proxy.psk = match.join(""); }
snell_version = comma "version" equals match:$[0-9]+ { proxy.version = parseInt(match.trim()); }

usernamek = comma "username" equals match:[^,]+ { proxy.username = match.join(""); }
passwordk = comma "password" equals match:[^,]+ { proxy.password = match.join("").replace(/^"(.*?)"$/, '$1').replace(/^'(.*?)'$/, '$1'); }
vmess_uuid = comma "username" equals match:[^,]+ { proxy.uuid = match.join(""); }
vmess_aead = comma "vmess-aead" equals flag:bool { proxy.aead = flag; }

method = comma "encrypt-method" equals cipher:cipher {
    proxy.cipher = cipher;
}
cipher = ("aes-128-cfb"/"aes-128-ctr"/"aes-128-gcm"/"aes-192-cfb"/"aes-192-ctr"/"aes-192-gcm"/"aes-256-cfb"/"aes-256-ctr"/"aes-256-gcm"/"bf-cfb"/"camellia-128-cfb"/"camellia-192-cfb"/"camellia-256-cfb"/"cast5-cfb"/"chacha20-ietf-poly1305"/"chacha20-ietf"/"chacha20-poly1305"/"chacha20"/"des-cfb"/"idea-cfb"/"none"/"rc2-cfb"/"rc4-md5"/"rc4"/"salsa20"/"seed-cfb"/"xchacha20-ietf-poly1305"/"2022-blake3-aes-128-gcm"/"2022-blake3-aes-256-gcm");

ws = comma "ws" equals flag:bool { obfs.type = "ws"; }
ws_headers = comma "ws-headers" equals headers:$[^,]+ {
    const pairs = headers.split("|");
    const result = {};
    pairs.forEach(pair => {
        const [key, value] = pair.trim().split(":");
        result[key.trim()] = value.trim();
    })
    obfs["ws-headers"] = result;
}
ws_path = comma "ws-path" equals path:uri { obfs.path = path; }

obfs = comma "obfs" equals type:("http"/"tls") { obfs.type = type; }
obfs_host = comma "obfs-host" equals host:domain { obfs.host = host; };
obfs_uri = comma "obfs-uri" equals path:uri { obfs.path = path }
uri = $[^,]+

udp_relay = comma "udp-relay" equals flag:bool { proxy.udp = flag; }
fast_open = comma "fast-open" equals flag:bool { proxy.tfo = flag; }
reuse = comma "reuse" equals flag:bool { proxy.reuse = flag; }
ecn = comma "ecn" equals flag:bool { proxy.ecn = flag; }
tfo = comma "tfo" equals flag:bool { proxy.tfo = flag; }
ip_version = comma "ip-version" equals match:[^,]+ { proxy["ip-version"] = match.join(""); }
section_name = comma "section-name" equals match:[^,]+ { proxy["section-name"] = match.join(""); }
no_error_alert = comma "no-error-alert" equals match:[^,]+ { proxy["no-error-alert"] = match.join(""); }
underlying_proxy = comma "underlying-proxy" equals match:[^,]+ { proxy["underlying-proxy"] = match.join(""); }
download_bandwidth = comma "download-bandwidth" equals match:[^,]+ { proxy.down = match.join(""); }
test_url = comma "test-url" equals match:[^,]+ { proxy["test-url"] = match.join(""); }
test_udp = comma "test-udp" equals match:[^,]+ { proxy["test-udp"] = match.join(""); }
test_timeout = comma "test-timeout" equals match:$[0-9]+ { proxy["test-timeout"] = parseInt(match.trim()); }
tos = comma "tos" equals match:$[0-9]+ { proxy.tos = parseInt(match.trim()); }
interface = comma "interface" equals match:[^,]+ { proxy.interface = match.join(""); }
allow_other_interface = comma "allow-other-interface" equals flag:bool { proxy["allow-other-interface"] = flag; }
hybrid = comma "hybrid" equals flag:bool { proxy.hybrid = flag; }
idle_timeout = comma "idle-timeout" equals match:$[0-9]+ { proxy["idle-timeout"] = parseInt(match.trim()); }
private_key = comma "private-key" equals match:[^,]+ { proxy["keystore-private-key"] = match.join("").replace(/^"(.*)"$/, '$1'); }
server_fingerprint = comma "server-fingerprint" equals match:[^,]+ { proxy["server-fingerprint"] = match.join("").replace(/^"(.*)"$/, '$1'); }
block_quic = comma "block-quic" equals match:[^,]+ { proxy["block-quic"] = match.join(""); }
udp_port = comma "udp-port" equals match:$[0-9]+ { proxy["udp-port"] = parseInt(match.trim()); }
shadow_tls_version = comma "shadow-tls-version" equals match:$[0-9]+ { proxy["shadow-tls-version"] = parseInt(match.trim()); }
shadow_tls_sni = comma "shadow-tls-sni" equals match:[^,]+ { proxy["shadow-tls-sni"] = match.join(""); }
shadow_tls_password = comma "shadow-tls-password" equals match:[^,]+ { proxy["shadow-tls-password"] = match.join(""); }
token = comma "token" equals match:[^,]+ { proxy.token = match.join(""); }
alpn = comma "alpn" equals match:[^,]+ { proxy.alpn = match.join(""); }
uuidk = comma "uuid" equals match:[^,]+ { proxy.uuid = match.join(""); }

tag = match:[^=,]* { proxy.name = match.join("").trim(); }
comma = _ "," _
equals = _ "=" _
_ = [ \\r\\t]*
bool = b:("true"/"false") { return b === "true" }
others = comma [^=,]+ equals [^=,]+
`])||(raw=strings.slice(0)),_templateObject=Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}})))),_$loon_90={};function ___typeof_90(t){return(___typeof_90=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$loon_90,"__esModule",{value:!0}),_$loon_90.default=function(){return __parser_90||(__parser_90=__peggy_90.generate(__grammars_90)),__parser_90};var ___templateObject_90,__peggy_90=function(t,e){if(t&&t.__esModule)return t;if(t===null||___typeof_90(t)!=="object"&&typeof t!="function")return{default:t};var n=___getRequireWildcardCache_90(void 0);if(n&&n.has(t))return n.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var d=o?Object.getOwnPropertyDescriptor(t,f):null;d&&(d.get||d.set)?Object.defineProperty(r,f,d):r[f]=t[f]}return r.default=t,n&&n.set(t,r),r}(_$peg_73);function ___getRequireWildcardCache_90(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(___getRequireWildcardCache_90=function(r){return r?n:e})(t)}var __strings_90,__raw_90,__parser_90,__grammars_90=String.raw(___templateObject_90||(__strings_90=[`
// global initializer
{{
    function $set(obj, path, value) {
      if (Object(obj) !== obj) return obj;
      if (!Array.isArray(path)) path = path.toString().match(/[^.[]]+/g) || [];
      path
        .slice(0, -1)
        .reduce((a, c, i) => (Object(a[c]) === a[c] ? a[c] : (a[c] = Math.abs(path[i + 1]) >> 0 === +path[i + 1] ? [] : {})), obj)[
        path[path.length - 1]
      ] = value;
      return obj;
    }
}}

// per-parser initializer
{
    const proxy = {};
    const obfs = {};
    const transport = {};
    const $ = {};

    function handleTransport() {
        if (transport.type === "tcp") { /* do nothing */ }
        else if (transport.type === "ws") {
            proxy.network = "ws";
            $set(proxy, "ws-opts.path", transport.path);
            $set(proxy, "ws-opts.headers.Host", transport.host);
        } else if (transport.type === "http") {
            proxy.network = "http";
            $set(proxy, "http-opts.path", transport.path);
            $set(proxy, "http-opts.headers.Host", transport.host);
        }
    }
}

start = (shadowsocksr/shadowsocks/vmess/vless/trojan/https/http/socks5/hysteria2) {
    return proxy;
}

shadowsocksr = tag equals "shadowsocksr"i address method password (ssr_protocol/ssr_protocol_param/obfs_ssr/obfs_ssr_param/obfs_host/obfs_uri/fast_open/udp_relay/udp_port/shadow_tls_version/shadow_tls_sni/shadow_tls_password/others)*{
    proxy.type = "ssr";
    // handle ssr obfs
    proxy.obfs = obfs.type;
}
shadowsocks = tag equals "shadowsocks"i address method password (obfs_typev obfs_hostv)? (obfs_ss/obfs_host/obfs_uri/fast_open/udp_relay/udp_port/shadow_tls_version/shadow_tls_sni/shadow_tls_password/others)* {
    proxy.type = "ss";
    // handle ss obfs
    if (obfs.type == "http" || obfs.type === "tls") {
        proxy.plugin = "obfs";
        $set(proxy, "plugin-opts.mode", obfs.type);
        $set(proxy, "plugin-opts.host", obfs.host);
        $set(proxy, "plugin-opts.path", obfs.path);
    }
}
vmess = tag equals "vmess"i address method uuid (transport/transport_host/transport_path/over_tls/tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/vmess_alterId/fast_open/udp_relay/others)* {
    proxy.type = "vmess";
    proxy.cipher = proxy.cipher || "none";
    proxy.alterId = proxy.alterId || 0;
    handleTransport();
}
vless = tag equals "vless"i address uuid (transport/transport_host/transport_path/over_tls/tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/fast_open/udp_relay/others)* {
    proxy.type = "vless";
    handleTransport();
}
trojan = tag equals "trojan"i address password (transport/transport_host/transport_path/over_tls/tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/fast_open/udp_relay/others)* {
    proxy.type = "trojan";
    handleTransport();
}
hysteria2 = tag equals "hysteria2"i address password (tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/udp_relay/fast_open/download_bandwidth/salamander_password/ecn/others)* {
    proxy.type = "hysteria2";
}
https = tag equals "https"i address (username password)? (tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/fast_open/udp_relay/others)* {
    proxy.type = "http";
    proxy.tls = true;
}
http = tag equals "http"i address (username password)? (fast_open/udp_relay/others)* {
    proxy.type = "http";
}
socks5 = tag equals "socks5"i address (username password)? (over_tls/tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/fast_open/udp_relay/others)* {
    proxy.type = "socks5";
}

address = comma server:server comma port:port {
    proxy.server = server;
    proxy.port = port;
}

server = ip/domain

ip = & {
    const start = peg$currPos;
    let j = start;
    while (j < input.length) {
        if (input[j] === ",") break;
        j++;
    }
    peg$currPos = j;
    $.ip = input.substring(start, j).trim();
    return true;
} { return $.ip; }

domain = match:[0-9a-zA-z-_.]+ { 
    const domain = match.join(""); 
    if (/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/.test(domain)) {
        return domain;
    }
    throw new Error("Invalid domain: " + domain);
}

port = digits:[0-9]+ { 
    const port = parseInt(digits.join(""), 10); 
    if (port >= 0 && port <= 65535) {
    	return port;
    }
    throw new Error("Invalid port number: " + port);
}

method = comma cipher:cipher { 
    proxy.cipher = cipher;
}
cipher = ("aes-128-cfb"/"aes-128-ctr"/"aes-128-gcm"/"aes-192-cfb"/"aes-192-ctr"/"aes-192-gcm"/"aes-256-cfb"/"aes-256-ctr"/"aes-256-gcm"/"auto"/"bf-cfb"/"camellia-128-cfb"/"camellia-192-cfb"/"camellia-256-cfb"/"chacha20-ietf-poly1305"/"chacha20-ietf"/"chacha20-poly1305"/"chacha20"/"none"/"rc4-md5"/"rc4"/"salsa20"/"xchacha20-ietf-poly1305"/"2022-blake3-aes-128-gcm"/"2022-blake3-aes-256-gcm");

username = & {
    let j = peg$currPos; 
    let start, end;
    let first = true;
    while (j < input.length) {
        if (input[j] === ',') {
            if (first) {
                start = j + 1;
                first = false;
            } else {
                end = j;
                break;
            }
        }
        j++;
    }
    const match = input.substring(start, end);
    if (match.indexOf("=") === -1) {
        $.username = match;
        peg$currPos = end;
        return true;
    }
} { proxy.username = $.username; }
password = comma '"' match:[^"]* '"' { proxy.password = match.join(""); }
uuid = comma '"' match:[^"]+ '"' { proxy.uuid = match.join(""); }

obfs_typev = comma type:("http"/"tls") { obfs.type = type; }
obfs_hostv = comma match:[^,]+ { obfs.host = match.join(""); }

obfs_ss = comma "obfs-name" equals type:("http"/"tls") { obfs.type = type; }

obfs_ssr = comma "obfs" equals type:("plain"/"http_simple"/"http_post"/"random_head"/"tls1.2_ticket_auth"/"tls1.2_ticket_fastauth") { obfs.type = type; }
obfs_ssr_param = comma "obfs-param" equals match:$[^,]+ { proxy["obfs-param"] = match; }

obfs_host = comma "obfs-host" equals host:domain { obfs.host = host; }
obfs_uri = comma "obfs-uri" equals uri:uri { obfs.path = uri; }
uri = $[^,]+

transport = comma "transport" equals type:("tcp"/"ws"/"http") { transport.type = type; }
transport_host = comma "host" equals host:domain { transport.host = host; }
transport_path = comma "path" equals path:uri { transport.path = path; }

ssr_protocol = comma "protocol" equals protocol:("origin"/"auth_sha1_v4"/"auth_aes128_md5"/"auth_aes128_sha1"/"auth_chain_a"/"auth_chain_b") { proxy.protocol = protocol; }
ssr_protocol_param = comma "protocol-param" equals param:$[^=,]+ { proxy["protocol-param"] = param; }

vmess_alterId = comma "alterId" equals alterId:$[0-9]+ { proxy.alterId = parseInt(alterId); } 

udp_port = comma "udp-port" equals match:$[0-9]+ { proxy["udp-port"] = parseInt(match.trim()); }
shadow_tls_version = comma "shadow-tls-version" equals match:$[0-9]+ { proxy["shadow-tls-version"] = parseInt(match.trim()); }
shadow_tls_sni = comma "shadow-tls-sni" equals match:[^,]+ { proxy["shadow-tls-sni"] = match.join(""); }
shadow_tls_password = comma "shadow-tls-password" equals match:[^,]+ { proxy["shadow-tls-password"] = match.join(""); }

over_tls = comma "over-tls" equals flag:bool { proxy.tls = flag; }
tls_host = comma sni:("tls-name"/"sni") equals host:domain { proxy.sni = host; }
tls_verification = comma "skip-cert-verify" equals flag:bool { proxy["skip-cert-verify"] = flag; }
tls_cert_sha256 = comma "tls-cert-sha256" equals match:[^,]+ { proxy["tls-fingerprint"] = match.join("").replace(/^"(.*)"$/, '$1'); }
tls_pubkey_sha256 = comma "tls-pubkey-sha256" equals match:[^,]+ { proxy["tls-pubkey-sha256"] = match.join("").replace(/^"(.*)"$/, '$1'); }

fast_open = comma "fast-open" equals flag:bool { proxy.tfo = flag; }
udp_relay = comma "udp" equals flag:bool { proxy.udp = flag; }

ecn = comma "ecn" equals flag:bool { proxy.ecn = flag; }
download_bandwidth = comma "download-bandwidth" equals match:[^,]+ { proxy.down = match.join(""); }
salamander_password = comma "salamander-password" equals match:[^,]+ { proxy['obfs-password'] = match.join(""); proxy.obfs = 'salamander'; }

tag = match:[^=,]* { proxy.name = match.join("").trim(); }
comma = _ "," _
equals = _ "=" _
_ = [ \r	]*
bool = b:("true"/"false") { return b === "true" }
others = comma [^=,]+ equals [^=,]+
`],(__raw_90=[`
// global initializer
{{
    function $set(obj, path, value) {
      if (Object(obj) !== obj) return obj;
      if (!Array.isArray(path)) path = path.toString().match(/[^.[\\]]+/g) || [];
      path
        .slice(0, -1)
        .reduce((a, c, i) => (Object(a[c]) === a[c] ? a[c] : (a[c] = Math.abs(path[i + 1]) >> 0 === +path[i + 1] ? [] : {})), obj)[
        path[path.length - 1]
      ] = value;
      return obj;
    }
}}

// per-parser initializer
{
    const proxy = {};
    const obfs = {};
    const transport = {};
    const $ = {};

    function handleTransport() {
        if (transport.type === "tcp") { /* do nothing */ }
        else if (transport.type === "ws") {
            proxy.network = "ws";
            $set(proxy, "ws-opts.path", transport.path);
            $set(proxy, "ws-opts.headers.Host", transport.host);
        } else if (transport.type === "http") {
            proxy.network = "http";
            $set(proxy, "http-opts.path", transport.path);
            $set(proxy, "http-opts.headers.Host", transport.host);
        }
    }
}

start = (shadowsocksr/shadowsocks/vmess/vless/trojan/https/http/socks5/hysteria2) {
    return proxy;
}

shadowsocksr = tag equals "shadowsocksr"i address method password (ssr_protocol/ssr_protocol_param/obfs_ssr/obfs_ssr_param/obfs_host/obfs_uri/fast_open/udp_relay/udp_port/shadow_tls_version/shadow_tls_sni/shadow_tls_password/others)*{
    proxy.type = "ssr";
    // handle ssr obfs
    proxy.obfs = obfs.type;
}
shadowsocks = tag equals "shadowsocks"i address method password (obfs_typev obfs_hostv)? (obfs_ss/obfs_host/obfs_uri/fast_open/udp_relay/udp_port/shadow_tls_version/shadow_tls_sni/shadow_tls_password/others)* {
    proxy.type = "ss";
    // handle ss obfs
    if (obfs.type == "http" || obfs.type === "tls") {
        proxy.plugin = "obfs";
        $set(proxy, "plugin-opts.mode", obfs.type);
        $set(proxy, "plugin-opts.host", obfs.host);
        $set(proxy, "plugin-opts.path", obfs.path);
    }
}
vmess = tag equals "vmess"i address method uuid (transport/transport_host/transport_path/over_tls/tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/vmess_alterId/fast_open/udp_relay/others)* {
    proxy.type = "vmess";
    proxy.cipher = proxy.cipher || "none";
    proxy.alterId = proxy.alterId || 0;
    handleTransport();
}
vless = tag equals "vless"i address uuid (transport/transport_host/transport_path/over_tls/tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/fast_open/udp_relay/others)* {
    proxy.type = "vless";
    handleTransport();
}
trojan = tag equals "trojan"i address password (transport/transport_host/transport_path/over_tls/tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/fast_open/udp_relay/others)* {
    proxy.type = "trojan";
    handleTransport();
}
hysteria2 = tag equals "hysteria2"i address password (tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/udp_relay/fast_open/download_bandwidth/salamander_password/ecn/others)* {
    proxy.type = "hysteria2";
}
https = tag equals "https"i address (username password)? (tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/fast_open/udp_relay/others)* {
    proxy.type = "http";
    proxy.tls = true;
}
http = tag equals "http"i address (username password)? (fast_open/udp_relay/others)* {
    proxy.type = "http";
}
socks5 = tag equals "socks5"i address (username password)? (over_tls/tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/fast_open/udp_relay/others)* {
    proxy.type = "socks5";
}

address = comma server:server comma port:port {
    proxy.server = server;
    proxy.port = port;
}

server = ip/domain

ip = & {
    const start = peg$currPos;
    let j = start;
    while (j < input.length) {
        if (input[j] === ",") break;
        j++;
    }
    peg$currPos = j;
    $.ip = input.substring(start, j).trim();
    return true;
} { return $.ip; }

domain = match:[0-9a-zA-z-_.]+ { 
    const domain = match.join(""); 
    if (/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/.test(domain)) {
        return domain;
    }
    throw new Error("Invalid domain: " + domain);
}

port = digits:[0-9]+ { 
    const port = parseInt(digits.join(""), 10); 
    if (port >= 0 && port <= 65535) {
    	return port;
    }
    throw new Error("Invalid port number: " + port);
}

method = comma cipher:cipher { 
    proxy.cipher = cipher;
}
cipher = ("aes-128-cfb"/"aes-128-ctr"/"aes-128-gcm"/"aes-192-cfb"/"aes-192-ctr"/"aes-192-gcm"/"aes-256-cfb"/"aes-256-ctr"/"aes-256-gcm"/"auto"/"bf-cfb"/"camellia-128-cfb"/"camellia-192-cfb"/"camellia-256-cfb"/"chacha20-ietf-poly1305"/"chacha20-ietf"/"chacha20-poly1305"/"chacha20"/"none"/"rc4-md5"/"rc4"/"salsa20"/"xchacha20-ietf-poly1305"/"2022-blake3-aes-128-gcm"/"2022-blake3-aes-256-gcm");

username = & {
    let j = peg$currPos; 
    let start, end;
    let first = true;
    while (j < input.length) {
        if (input[j] === ',') {
            if (first) {
                start = j + 1;
                first = false;
            } else {
                end = j;
                break;
            }
        }
        j++;
    }
    const match = input.substring(start, end);
    if (match.indexOf("=") === -1) {
        $.username = match;
        peg$currPos = end;
        return true;
    }
} { proxy.username = $.username; }
password = comma '"' match:[^"]* '"' { proxy.password = match.join(""); }
uuid = comma '"' match:[^"]+ '"' { proxy.uuid = match.join(""); }

obfs_typev = comma type:("http"/"tls") { obfs.type = type; }
obfs_hostv = comma match:[^,]+ { obfs.host = match.join(""); }

obfs_ss = comma "obfs-name" equals type:("http"/"tls") { obfs.type = type; }

obfs_ssr = comma "obfs" equals type:("plain"/"http_simple"/"http_post"/"random_head"/"tls1.2_ticket_auth"/"tls1.2_ticket_fastauth") { obfs.type = type; }
obfs_ssr_param = comma "obfs-param" equals match:$[^,]+ { proxy["obfs-param"] = match; }

obfs_host = comma "obfs-host" equals host:domain { obfs.host = host; }
obfs_uri = comma "obfs-uri" equals uri:uri { obfs.path = uri; }
uri = $[^,]+

transport = comma "transport" equals type:("tcp"/"ws"/"http") { transport.type = type; }
transport_host = comma "host" equals host:domain { transport.host = host; }
transport_path = comma "path" equals path:uri { transport.path = path; }

ssr_protocol = comma "protocol" equals protocol:("origin"/"auth_sha1_v4"/"auth_aes128_md5"/"auth_aes128_sha1"/"auth_chain_a"/"auth_chain_b") { proxy.protocol = protocol; }
ssr_protocol_param = comma "protocol-param" equals param:$[^=,]+ { proxy["protocol-param"] = param; }

vmess_alterId = comma "alterId" equals alterId:$[0-9]+ { proxy.alterId = parseInt(alterId); } 

udp_port = comma "udp-port" equals match:$[0-9]+ { proxy["udp-port"] = parseInt(match.trim()); }
shadow_tls_version = comma "shadow-tls-version" equals match:$[0-9]+ { proxy["shadow-tls-version"] = parseInt(match.trim()); }
shadow_tls_sni = comma "shadow-tls-sni" equals match:[^,]+ { proxy["shadow-tls-sni"] = match.join(""); }
shadow_tls_password = comma "shadow-tls-password" equals match:[^,]+ { proxy["shadow-tls-password"] = match.join(""); }

over_tls = comma "over-tls" equals flag:bool { proxy.tls = flag; }
tls_host = comma sni:("tls-name"/"sni") equals host:domain { proxy.sni = host; }
tls_verification = comma "skip-cert-verify" equals flag:bool { proxy["skip-cert-verify"] = flag; }
tls_cert_sha256 = comma "tls-cert-sha256" equals match:[^,]+ { proxy["tls-fingerprint"] = match.join("").replace(/^"(.*)"$/, '$1'); }
tls_pubkey_sha256 = comma "tls-pubkey-sha256" equals match:[^,]+ { proxy["tls-pubkey-sha256"] = match.join("").replace(/^"(.*)"$/, '$1'); }

fast_open = comma "fast-open" equals flag:bool { proxy.tfo = flag; }
udp_relay = comma "udp" equals flag:bool { proxy.udp = flag; }

ecn = comma "ecn" equals flag:bool { proxy.ecn = flag; }
download_bandwidth = comma "download-bandwidth" equals match:[^,]+ { proxy.down = match.join(""); }
salamander_password = comma "salamander-password" equals match:[^,]+ { proxy['obfs-password'] = match.join(""); proxy.obfs = 'salamander'; }

tag = match:[^=,]* { proxy.name = match.join("").trim(); }
comma = _ "," _
equals = _ "=" _
_ = [ \\r\\t]*
bool = b:("true"/"false") { return b === "true" }
others = comma [^=,]+ equals [^=,]+
`])||(__raw_90=__strings_90.slice(0)),___templateObject_90=Object.freeze(Object.defineProperties(__strings_90,{raw:{value:Object.freeze(__raw_90)}})))),_$qx_91={};function ___typeof_91(t){return(___typeof_91=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$qx_91,"__esModule",{value:!0}),_$qx_91.default=function(){return __parser_91||(__parser_91=__peggy_91.generate(__grammars_91)),__parser_91};var ___templateObject_91,__peggy_91=function(t,e){if(t&&t.__esModule)return t;if(t===null||___typeof_91(t)!=="object"&&typeof t!="function")return{default:t};var n=___getRequireWildcardCache_91(void 0);if(n&&n.has(t))return n.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var d=o?Object.getOwnPropertyDescriptor(t,f):null;d&&(d.get||d.set)?Object.defineProperty(r,f,d):r[f]=t[f]}return r.default=t,n&&n.set(t,r),r}(_$peg_73);function ___getRequireWildcardCache_91(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(___getRequireWildcardCache_91=function(r){return r?n:e})(t)}var __strings_91,__raw_91,__parser_91,__grammars_91=String.raw(___templateObject_91||(__strings_91=[`
// global initializer
{{
    function $set(obj, path, value) {
      if (Object(obj) !== obj) return obj;
      if (!Array.isArray(path)) path = path.toString().match(/[^.[]]+/g) || [];
      path
        .slice(0, -1)
        .reduce((a, c, i) => (Object(a[c]) === a[c] ? a[c] : (a[c] = Math.abs(path[i + 1]) >> 0 === +path[i + 1] ? [] : {})), obj)[
        path[path.length - 1]
      ] = value;
      return obj;
    }
}}

// per-parse initializer
{
	const proxy = {};
    const obfs = {};
    const $ = {};

    function handleObfs() {
        if (obfs.type === "ws" || obfs.type === "wss") {
            proxy.network = "ws";
            if (obfs.type === 'wss') {
                proxy.tls = true;
            }
            $set(proxy, "ws-opts.path", obfs.path);
            $set(proxy, "ws-opts.headers.Host", obfs.host);
        } else if (obfs.type === "over-tls") {
            proxy.tls = true;
        } else if (obfs.type === "http") {
            proxy.network = "http";
            $set(proxy, "http-opts.path", obfs.path);
            $set(proxy, "http-opts.headers.Host", obfs.host);
        }
    }
}

start = (trojan/shadowsocks/vmess/vless/http/socks5) {
    return proxy
}

trojan = "trojan" equals address
    (password/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/obfs/obfs_host/obfs_uri/tag/udp_relay/udp_over_tcp/fast_open/server_check_url/others)* {
    proxy.type = "trojan";
    handleObfs();
}

shadowsocks = "shadowsocks" equals address
    (password/method/obfs_ssr/obfs_ss/obfs_host/obfs_uri/ssr_protocol/ssr_protocol_param/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/udp_relay/udp_over_tcp/fast_open/tag/server_check_url/others)* {
    if (proxy.protocol || proxy.type === "ssr") {
        proxy.type = "ssr";
        if (!proxy.protocol) {
            proxy.protocol = "origin";
        }
        // handle ssr obfs
        if (obfs.host) proxy["obfs-param"] = obfs.host;
        if (obfs.type) proxy.obfs = obfs.type;
    } else {
        proxy.type = "ss";
        // handle ss obfs
        if (obfs.type == "http" || obfs.type === "tls") {
            proxy.plugin = "obfs";
            $set(proxy, "plugin-opts", {
                mode: obfs.type
            });
        } else if (obfs.type === "ws" || obfs.type === "wss") {
            proxy.plugin = "v2ray-plugin";
            $set(proxy, "plugin-opts.mode", "websocket");
            if (obfs.type === "wss") {
                $set(proxy, "plugin-opts.tls", true);
            }
        } else if (obfs.type === 'over-tls') {
            throw new Error('ss over-tls is not supported');
        }
        if (obfs.type) {
            $set(proxy, "plugin-opts.host", obfs.host);
            $set(proxy, "plugin-opts.path", obfs.path);
        }
    }
}

vmess = "vmess" equals address
    (uuid/method/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/tag/obfs/obfs_host/obfs_uri/udp_relay/udp_over_tcp/fast_open/aead/server_check_url/others)* {
    proxy.type = "vmess";
    proxy.cipher = proxy.cipher || "none";
    if (proxy.aead) {
        proxy.alterId = 0;
    } else {
        proxy.alterId = proxy.alterId || 0;
    }
    handleObfs();
}

vless = "vless" equals address
    (uuid/method/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/tag/obfs/obfs_host/obfs_uri/udp_relay/udp_over_tcp/fast_open/aead/server_check_url/others)* {
    proxy.type = "vless";
    proxy.cipher = proxy.cipher || "none";
    handleObfs();
}

http = "http" equals address 
    (username/password/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/tag/fast_open/udp_relay/udp_over_tcp/server_check_url/others)*{
    proxy.type = "http";
}

socks5 = "socks5" equals address
    (username/password/password/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/tag/fast_open/udp_relay/udp_over_tcp/server_check_url/others)* {
    proxy.type = "socks5";
}
    
address = server:server ":" port:port {
    proxy.server = server;
    proxy.port = port;
}
server = ip/domain

domain = match:[0-9a-zA-z-_.]+ { 
    const domain = match.join(""); 
    if (/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/.test(domain)) {
        return domain;
    }
}

ip = & {
    const start = peg$currPos;
    let end;
    let j = start;
    while (j < input.length) {
        if (input[j] === ",") break;
        if (input[j] === ":") end = j;
        j++;
    }
    peg$currPos = end || j;
    $.ip = input.substring(start, end).trim();
    return true;
} { return $.ip; }

port = digits:[0-9]+ { 
    const port = parseInt(digits.join(""), 10); 
    if (port >= 0 && port <= 65535) {
    	return port;
    }
}

username = comma "username" equals username:[^=,]+ { proxy.username = username.join("").trim(); }
password = comma "password" equals password:[^=,]+ { proxy.password = password.join("").trim(); }
uuid = comma "password" equals uuid:[^=,]+ { proxy.uuid = uuid.join("").trim(); }

method = comma "method" equals cipher:cipher { 
    proxy.cipher = cipher;
};
cipher = ("aes-128-cfb"/"aes-128-ctr"/"aes-128-gcm"/"aes-192-cfb"/"aes-192-ctr"/"aes-192-gcm"/"aes-256-cfb"/"aes-256-ctr"/"aes-256-gcm"/"bf-cfb"/"cast5-cfb"/"chacha20-ietf-poly1305"/"chacha20-ietf"/"chacha20-poly1305"/"chacha20"/"des-cfb"/"none"/"rc2-cfb"/"rc4-md5-6"/"rc4-md5"/"salsa20"/"xchacha20-ietf-poly1305");
aead = comma "aead" equals flag:bool { proxy.aead = flag; }

udp_relay = comma "udp-relay" equals flag:bool { proxy.udp = flag; }
udp_over_tcp = comma "udp-over-tcp" equals flag:bool { throw new Error("UDP over TCP is not supported"); }
fast_open = comma "fast-open" equals flag:bool { proxy.tfo = flag; }

over_tls = comma "over-tls" equals flag:bool { proxy.tls = flag; }
tls_host = comma "tls-host" equals sni:domain { proxy.sni = sni; }
tls_verification = comma "tls-verification" equals flag:bool { 
    proxy["skip-cert-verify"] = !flag;
}
tls_fingerprint = comma "tls-cert-sha256" equals tls_fingerprint:$[^,]+ { proxy["tls-fingerprint"] = tls_fingerprint.trim(); }
tls_pubkey_sha256 = comma "tls-pubkey-sha256" equals param:$[^=,]+ { proxy["tls-pubkey-sha256"] = param; }
tls_alpn = comma "tls-alpn" equals param:$[^=,]+ { proxy["tls-alpn"] = param; }
tls_no_session_ticket = comma "tls-no-session-ticket" equals flag:bool { 
    proxy["tls-no-session-ticket"] = flag;
}
tls_no_session_reuse = comma "tls-no-session-reuse" equals flag:bool { 
    proxy["tls-no-session-reuse"] = flag;
}

obfs_ss = comma "obfs" equals type:("http"/"tls"/"wss"/"ws"/"over-tls") { obfs.type = type; return type; }
obfs_ssr = comma "obfs" equals type:("plain"/"http_simple"/"http_post"/"random_head"/"tls1.2_ticket_auth"/"tls1.2_ticket_fastauth") { proxy.type = "ssr"; obfs.type = type; return type; }
obfs = comma "obfs" equals type:("wss"/"ws"/"over-tls"/"http") { obfs.type = type; return type; };

obfs_host = comma "obfs-host" equals host:domain { obfs.host = host; }
obfs_uri = comma "obfs-uri" equals uri:uri { obfs.path = uri; }

ssr_protocol = comma "ssr-protocol" equals protocol:("origin"/"auth_sha1_v4"/"auth_aes128_md5"/"auth_aes128_sha1"/"auth_chain_a"/"auth_chain_b") { proxy.protocol = protocol; return protocol; }
ssr_protocol_param = comma "ssr-protocol-param" equals param:$[^=,]+ { proxy["protocol-param"] = param; }

server_check_url = comma "server_check_url" equals param:$[^=,]+ { proxy["test-url"] = param; }

uri = $[^,]+

tag = comma "tag" equals tag:[^=,]+ { proxy.name = tag.join(""); }
others = comma [^=,]+ equals [^=,]+
comma = _ "," _
equals = _ "=" _
_ = [ \r	]*
bool = b:("true"/"false") { return b === "true" }
`],(__raw_91=[`
// global initializer
{{
    function $set(obj, path, value) {
      if (Object(obj) !== obj) return obj;
      if (!Array.isArray(path)) path = path.toString().match(/[^.[\\]]+/g) || [];
      path
        .slice(0, -1)
        .reduce((a, c, i) => (Object(a[c]) === a[c] ? a[c] : (a[c] = Math.abs(path[i + 1]) >> 0 === +path[i + 1] ? [] : {})), obj)[
        path[path.length - 1]
      ] = value;
      return obj;
    }
}}

// per-parse initializer
{
	const proxy = {};
    const obfs = {};
    const $ = {};

    function handleObfs() {
        if (obfs.type === "ws" || obfs.type === "wss") {
            proxy.network = "ws";
            if (obfs.type === 'wss') {
                proxy.tls = true;
            }
            $set(proxy, "ws-opts.path", obfs.path);
            $set(proxy, "ws-opts.headers.Host", obfs.host);
        } else if (obfs.type === "over-tls") {
            proxy.tls = true;
        } else if (obfs.type === "http") {
            proxy.network = "http";
            $set(proxy, "http-opts.path", obfs.path);
            $set(proxy, "http-opts.headers.Host", obfs.host);
        }
    }
}

start = (trojan/shadowsocks/vmess/vless/http/socks5) {
    return proxy
}

trojan = "trojan" equals address
    (password/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/obfs/obfs_host/obfs_uri/tag/udp_relay/udp_over_tcp/fast_open/server_check_url/others)* {
    proxy.type = "trojan";
    handleObfs();
}

shadowsocks = "shadowsocks" equals address
    (password/method/obfs_ssr/obfs_ss/obfs_host/obfs_uri/ssr_protocol/ssr_protocol_param/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/udp_relay/udp_over_tcp/fast_open/tag/server_check_url/others)* {
    if (proxy.protocol || proxy.type === "ssr") {
        proxy.type = "ssr";
        if (!proxy.protocol) {
            proxy.protocol = "origin";
        }
        // handle ssr obfs
        if (obfs.host) proxy["obfs-param"] = obfs.host;
        if (obfs.type) proxy.obfs = obfs.type;
    } else {
        proxy.type = "ss";
        // handle ss obfs
        if (obfs.type == "http" || obfs.type === "tls") {
            proxy.plugin = "obfs";
            $set(proxy, "plugin-opts", {
                mode: obfs.type
            });
        } else if (obfs.type === "ws" || obfs.type === "wss") {
            proxy.plugin = "v2ray-plugin";
            $set(proxy, "plugin-opts.mode", "websocket");
            if (obfs.type === "wss") {
                $set(proxy, "plugin-opts.tls", true);
            }
        } else if (obfs.type === 'over-tls') {
            throw new Error('ss over-tls is not supported');
        }
        if (obfs.type) {
            $set(proxy, "plugin-opts.host", obfs.host);
            $set(proxy, "plugin-opts.path", obfs.path);
        }
    }
}

vmess = "vmess" equals address
    (uuid/method/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/tag/obfs/obfs_host/obfs_uri/udp_relay/udp_over_tcp/fast_open/aead/server_check_url/others)* {
    proxy.type = "vmess";
    proxy.cipher = proxy.cipher || "none";
    if (proxy.aead) {
        proxy.alterId = 0;
    } else {
        proxy.alterId = proxy.alterId || 0;
    }
    handleObfs();
}

vless = "vless" equals address
    (uuid/method/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/tag/obfs/obfs_host/obfs_uri/udp_relay/udp_over_tcp/fast_open/aead/server_check_url/others)* {
    proxy.type = "vless";
    proxy.cipher = proxy.cipher || "none";
    handleObfs();
}

http = "http" equals address 
    (username/password/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/tag/fast_open/udp_relay/udp_over_tcp/server_check_url/others)*{
    proxy.type = "http";
}

socks5 = "socks5" equals address
    (username/password/password/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/tag/fast_open/udp_relay/udp_over_tcp/server_check_url/others)* {
    proxy.type = "socks5";
}
    
address = server:server ":" port:port {
    proxy.server = server;
    proxy.port = port;
}
server = ip/domain

domain = match:[0-9a-zA-z-_.]+ { 
    const domain = match.join(""); 
    if (/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/.test(domain)) {
        return domain;
    }
}

ip = & {
    const start = peg$currPos;
    let end;
    let j = start;
    while (j < input.length) {
        if (input[j] === ",") break;
        if (input[j] === ":") end = j;
        j++;
    }
    peg$currPos = end || j;
    $.ip = input.substring(start, end).trim();
    return true;
} { return $.ip; }

port = digits:[0-9]+ { 
    const port = parseInt(digits.join(""), 10); 
    if (port >= 0 && port <= 65535) {
    	return port;
    }
}

username = comma "username" equals username:[^=,]+ { proxy.username = username.join("").trim(); }
password = comma "password" equals password:[^=,]+ { proxy.password = password.join("").trim(); }
uuid = comma "password" equals uuid:[^=,]+ { proxy.uuid = uuid.join("").trim(); }

method = comma "method" equals cipher:cipher { 
    proxy.cipher = cipher;
};
cipher = ("aes-128-cfb"/"aes-128-ctr"/"aes-128-gcm"/"aes-192-cfb"/"aes-192-ctr"/"aes-192-gcm"/"aes-256-cfb"/"aes-256-ctr"/"aes-256-gcm"/"bf-cfb"/"cast5-cfb"/"chacha20-ietf-poly1305"/"chacha20-ietf"/"chacha20-poly1305"/"chacha20"/"des-cfb"/"none"/"rc2-cfb"/"rc4-md5-6"/"rc4-md5"/"salsa20"/"xchacha20-ietf-poly1305");
aead = comma "aead" equals flag:bool { proxy.aead = flag; }

udp_relay = comma "udp-relay" equals flag:bool { proxy.udp = flag; }
udp_over_tcp = comma "udp-over-tcp" equals flag:bool { throw new Error("UDP over TCP is not supported"); }
fast_open = comma "fast-open" equals flag:bool { proxy.tfo = flag; }

over_tls = comma "over-tls" equals flag:bool { proxy.tls = flag; }
tls_host = comma "tls-host" equals sni:domain { proxy.sni = sni; }
tls_verification = comma "tls-verification" equals flag:bool { 
    proxy["skip-cert-verify"] = !flag;
}
tls_fingerprint = comma "tls-cert-sha256" equals tls_fingerprint:$[^,]+ { proxy["tls-fingerprint"] = tls_fingerprint.trim(); }
tls_pubkey_sha256 = comma "tls-pubkey-sha256" equals param:$[^=,]+ { proxy["tls-pubkey-sha256"] = param; }
tls_alpn = comma "tls-alpn" equals param:$[^=,]+ { proxy["tls-alpn"] = param; }
tls_no_session_ticket = comma "tls-no-session-ticket" equals flag:bool { 
    proxy["tls-no-session-ticket"] = flag;
}
tls_no_session_reuse = comma "tls-no-session-reuse" equals flag:bool { 
    proxy["tls-no-session-reuse"] = flag;
}

obfs_ss = comma "obfs" equals type:("http"/"tls"/"wss"/"ws"/"over-tls") { obfs.type = type; return type; }
obfs_ssr = comma "obfs" equals type:("plain"/"http_simple"/"http_post"/"random_head"/"tls1.2_ticket_auth"/"tls1.2_ticket_fastauth") { proxy.type = "ssr"; obfs.type = type; return type; }
obfs = comma "obfs" equals type:("wss"/"ws"/"over-tls"/"http") { obfs.type = type; return type; };

obfs_host = comma "obfs-host" equals host:domain { obfs.host = host; }
obfs_uri = comma "obfs-uri" equals uri:uri { obfs.path = uri; }

ssr_protocol = comma "ssr-protocol" equals protocol:("origin"/"auth_sha1_v4"/"auth_aes128_md5"/"auth_aes128_sha1"/"auth_chain_a"/"auth_chain_b") { proxy.protocol = protocol; return protocol; }
ssr_protocol_param = comma "ssr-protocol-param" equals param:$[^=,]+ { proxy["protocol-param"] = param; }

server_check_url = comma "server_check_url" equals param:$[^=,]+ { proxy["test-url"] = param; }

uri = $[^,]+

tag = comma "tag" equals tag:[^=,]+ { proxy.name = tag.join(""); }
others = comma [^=,]+ equals [^=,]+
comma = _ "," _
equals = _ "=" _
_ = [ \\r\\t]*
bool = b:("true"/"false") { return b === "true" }
`])||(__raw_91=__strings_91.slice(0)),___templateObject_91=Object.freeze(Object.defineProperties(__strings_91,{raw:{value:Object.freeze(__raw_91)}})))),_$trojanUri_93={};function ___typeof_93(t){return(___typeof_93=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$trojanUri_93,"__esModule",{value:!0}),_$trojanUri_93.default=function(){return __parser_93||(__parser_93=__peggy_93.generate(__grammars_93)),__parser_93};var ___templateObject_93,__peggy_93=function(t,e){if(t&&t.__esModule)return t;if(t===null||___typeof_93(t)!=="object"&&typeof t!="function")return{default:t};var n=___getRequireWildcardCache_93(void 0);if(n&&n.has(t))return n.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var d=o?Object.getOwnPropertyDescriptor(t,f):null;d&&(d.get||d.set)?Object.defineProperty(r,f,d):r[f]=t[f]}return r.default=t,n&&n.set(t,r),r}(_$peg_73);function ___getRequireWildcardCache_93(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(___getRequireWildcardCache_93=function(r){return r?n:e})(t)}var __strings_93,__raw_93,__parser_93,__grammars_93=String.raw(___templateObject_93||(__strings_93=[`
// global initializer
{{
  function $set(obj, path, value) {
    if (Object(obj) !== obj) return obj;
    if (!Array.isArray(path)) path = path.toString().match(/[^.[]]+/g) || [];
    path
      .slice(0, -1)
      .reduce((a, c, i) => (Object(a[c]) === a[c] ? a[c] : (a[c] = Math.abs(path[i + 1]) >> 0 === +path[i + 1] ? [] : {})), obj)[
      path[path.length - 1]
    ] = value;
    return obj;
  }

  function toBool(str) {
    if (typeof str === 'undefined' || str === null) return undefined;
    return /(TRUE)|1/i.test(str);
  }
}}

{
  const proxy = {};
  const obfs = {};
  const $ = {};
  const params = {};
}

start = (trojan) {
  return proxy
}

trojan = "trojan://" password:password "@" server:server ":" port:port "/"? params? name:name?{
  proxy.type = "trojan";
  proxy.password = password;
  proxy.server = server;
  proxy.port = port;
  proxy.name = name;

  // name may be empty
  if (!proxy.name) {
    proxy.name = server + ":" + port;
  }
};

password = match:$[^@]+ {
  return decodeURIComponent(match);
};

server = ip/domain;

domain = match:[0-9a-zA-z-_.]+ { 
  const domain = match.join(""); 
  if (/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/.test(domain)) {
    return domain;
  }
}

ip = & {
  const start = peg$currPos;
  let end;
  let j = start;
  while (j < input.length) {
    if (input[j] === ",") break;
    if (input[j] === ":") end = j;
    j++;
  }
  peg$currPos = end || j;
  $.ip = input.substring(start, end).trim();
  return true;
} { return $.ip; }

port = digits:[0-9]+ { 
  const port = parseInt(digits.join(""), 10); 
  if (port >= 0 && port <= 65535) {
    return port;
  } else {
    throw new Error("Invalid port: " + port);
  }
}

params = "?" head:param tail:("&"@param)* {
  proxy["skip-cert-verify"] = toBool(params["allowInsecure"]);
  proxy.sni = params["sni"] || params["peer"];
  proxy['client-fingerprint'] = params.fp;
  proxy.alpn = params.alpn ? decodeURIComponent(params.alpn).split(',') : undefined;

  if (toBool(params["ws"])) {
    proxy.network = "ws";
    $set(proxy, "ws-opts.path", params["wspath"]);
  }
  
  if (params["type"]) {
    let httpupgrade
    proxy.network = params["type"]
    if(proxy.network === 'httpupgrade') {
      proxy.network = 'ws'
      httpupgrade = true
    }
    if (['grpc'].includes(proxy.network)) {
        proxy[proxy.network + '-opts'] = {
            'grpc-service-name': params["serviceName"],
            '_grpc-type': params["mode"],
            '_grpc-authority': params["authority"],
        };
    } else {
      if (params["path"]) {
        $set(proxy, proxy.network+"-opts.path", decodeURIComponent(params["path"]));  
      }
      if (params["host"]) {
        $set(proxy, proxy.network+"-opts.headers.Host", decodeURIComponent(params["host"])); 
      }
      if (httpupgrade) {
        $set(proxy, proxy.network+"-opts.v2ray-http-upgrade", true); 
        $set(proxy, proxy.network+"-opts.v2ray-http-upgrade-fast-open", true); 
      }
    }
  }

  proxy.udp = toBool(params["udp"]);
  proxy.tfo = toBool(params["tfo"]);
}

param = kv/single;

kv = key:$[a-z]i+ "=" value:$[^&#]i* {
  params[key] = value;
}

single = key:$[a-z]i+ {
  params[key] = true;
};

name = "#" + match:$.* {
  return decodeURIComponent(match);
}
`],(__raw_93=[`
// global initializer
{{
  function $set(obj, path, value) {
    if (Object(obj) !== obj) return obj;
    if (!Array.isArray(path)) path = path.toString().match(/[^.[\\]]+/g) || [];
    path
      .slice(0, -1)
      .reduce((a, c, i) => (Object(a[c]) === a[c] ? a[c] : (a[c] = Math.abs(path[i + 1]) >> 0 === +path[i + 1] ? [] : {})), obj)[
      path[path.length - 1]
    ] = value;
    return obj;
  }

  function toBool(str) {
    if (typeof str === 'undefined' || str === null) return undefined;
    return /(TRUE)|1/i.test(str);
  }
}}

{
  const proxy = {};
  const obfs = {};
  const $ = {};
  const params = {};
}

start = (trojan) {
  return proxy
}

trojan = "trojan://" password:password "@" server:server ":" port:port "/"? params? name:name?{
  proxy.type = "trojan";
  proxy.password = password;
  proxy.server = server;
  proxy.port = port;
  proxy.name = name;

  // name may be empty
  if (!proxy.name) {
    proxy.name = server + ":" + port;
  }
};

password = match:$[^@]+ {
  return decodeURIComponent(match);
};

server = ip/domain;

domain = match:[0-9a-zA-z-_.]+ { 
  const domain = match.join(""); 
  if (/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/.test(domain)) {
    return domain;
  }
}

ip = & {
  const start = peg$currPos;
  let end;
  let j = start;
  while (j < input.length) {
    if (input[j] === ",") break;
    if (input[j] === ":") end = j;
    j++;
  }
  peg$currPos = end || j;
  $.ip = input.substring(start, end).trim();
  return true;
} { return $.ip; }

port = digits:[0-9]+ { 
  const port = parseInt(digits.join(""), 10); 
  if (port >= 0 && port <= 65535) {
    return port;
  } else {
    throw new Error("Invalid port: " + port);
  }
}

params = "?" head:param tail:("&"@param)* {
  proxy["skip-cert-verify"] = toBool(params["allowInsecure"]);
  proxy.sni = params["sni"] || params["peer"];
  proxy['client-fingerprint'] = params.fp;
  proxy.alpn = params.alpn ? decodeURIComponent(params.alpn).split(',') : undefined;

  if (toBool(params["ws"])) {
    proxy.network = "ws";
    $set(proxy, "ws-opts.path", params["wspath"]);
  }
  
  if (params["type"]) {
    let httpupgrade
    proxy.network = params["type"]
    if(proxy.network === 'httpupgrade') {
      proxy.network = 'ws'
      httpupgrade = true
    }
    if (['grpc'].includes(proxy.network)) {
        proxy[proxy.network + '-opts'] = {
            'grpc-service-name': params["serviceName"],
            '_grpc-type': params["mode"],
            '_grpc-authority': params["authority"],
        };
    } else {
      if (params["path"]) {
        $set(proxy, proxy.network+"-opts.path", decodeURIComponent(params["path"]));  
      }
      if (params["host"]) {
        $set(proxy, proxy.network+"-opts.headers.Host", decodeURIComponent(params["host"])); 
      }
      if (httpupgrade) {
        $set(proxy, proxy.network+"-opts.v2ray-http-upgrade", true); 
        $set(proxy, proxy.network+"-opts.v2ray-http-upgrade-fast-open", true); 
      }
    }
  }

  proxy.udp = toBool(params["udp"]);
  proxy.tfo = toBool(params["tfo"]);
}

param = kv/single;

kv = key:$[a-z]i+ "=" value:$[^&#]i* {
  params[key] = value;
}

single = key:$[a-z]i+ {
  params[key] = true;
};

name = "#" + match:$.* {
  return decodeURIComponent(match);
}
`])||(__raw_93=__strings_93.slice(0)),___templateObject_93=Object.freeze(Object.defineProperties(__strings_93,{raw:{value:Object.freeze(__raw_93)}})))),_$parsers_89={};Object.defineProperty(_$parsers_89,"__esModule",{value:!0}),_$parsers_89.default=void 0;var ___surge_89=___interopRequireDefault_89(_$surge_92),___loon_89=___interopRequireDefault_89(_$loon_90),___qx_89=___interopRequireDefault_89(_$qx_91),_trojanUri=___interopRequireDefault_89(_$trojanUri_93);function ___interopRequireDefault_89(t){return t&&t.__esModule?t:{default:t}}function __ownKeys_89(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function ___objectSpread_89(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_89(Object(n),!0).forEach(function(r){___defineProperty_89(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):__ownKeys_89(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ___defineProperty_89(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ___createForOfIteratorHelper_89(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=___unsupportedIterableToArray_89(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){n=n.call(t)},n:function(){var y=n.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||n.return==null||n.return()}finally{if(h)throw f}}}}function ___slicedToArray_89(t,e){return function(n){if(Array.isArray(n))return n}(t)||function(n,r){var o=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(o!=null){var f,d,h=[],y=!0,F=!1;try{for(o=o.call(n);!(y=(f=o.next()).done)&&(h.push(f.value),!r||h.length!==r);y=!0);}catch(S){F=!0,d=S}finally{try{y||o.return==null||o.return()}finally{if(F)throw d}}return h}}(t,e)||___unsupportedIterableToArray_89(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ___unsupportedIterableToArray_89(t,e){if(t){if(typeof t=="string")return ___arrayLikeToArray_89(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?___arrayLikeToArray_89(t,e):void 0}}function ___arrayLikeToArray_89(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function surge_port_hopping(t){var e=___slicedToArray_89(t.match(/,\s*?port-hopping\s*?=\s*?["']?\s*?((\d+(-\d+)?)([,;]\d+(-\d+)?)*)\s*?["']?\s*?/)||[],2),n=e[0],r=e[1];return{port_hopping:r?r.replace(/;/g,","):void 0,line:n?t.replace(n,""):t}}function __isIP_89(t){return(0,_$utils_141.isIPv4)(t)||(0,_$utils_141.isIPv6)(t)}var ___default_89=[{name:"URI PROXY Parser",test:function(t){return/^(socks5\+tls|socks5|http|https):\/\//.test(t)},parse:function(t){var e=___slicedToArray_89(t.match(/^(socks5|http|http)(\+tls|s)?:\/\/(?:(.*?):(.*?)@)?(.*?):(\d+?)(\?.*?)?(?:#(.*?))?$/),9),n=(e[0],e[1]),r=e[2],o=e[3],f=e[4],d=e[5],h=e[6],y=(e[7],e[8]);return{name:y!=null?decodeURIComponent(y):"".concat(n," ").concat(d,":").concat(h),type:n,tls:!!r,server:d,port:h,username:o!=null?decodeURIComponent(o):void 0,password:f!=null?decodeURIComponent(f):void 0}}},{name:"URI SS Parser",test:function(t){return/^ss:\/\//.test(t)},parse:function(t){var e,n,r=t.split("ss://")[1],o={name:decodeURIComponent(t.split("#")[1]),type:"ss"},f=(r=r.split("#")[0]).match(/@([^/]*)(\/|$)/),d=decodeURIComponent(r.split("@")[0]);n=d!=null&&d.startsWith("2022-blake3-")?d:_$base64_20.Base64.decode(d);var h="";if(!f){if(r.includes("?")){var y=r.match(/^(.*)(\?.*)$/);r=y[1],h=y[2]}if(r=_$base64_20.Base64.decode(r),h){if(/(&|\?)v2ray-plugin=/.test(h)){var F=h.match(/(&|\?)v2ray-plugin=(.*?)(&|$)/)[2];F&&(o.plugin="v2ray-plugin",o["plugin-opts"]=JSON.parse(_$base64_20.Base64.decode(F)))}r="".concat(r).concat(h)}n=r.split("@")[0],f=r.match(/@([^/]*)(\/|$)/)}var S=f[1],T=S.lastIndexOf(":");o.server=S.substring(0,T),o.port=(e="".concat(S.substring(T+1)).match(/\d+/))===null||e===void 0?void 0:e[0];var U=n.match(/(^.*?):(.*$)/);if(o.cipher=U?.[1],o.password=U?.[2],r.indexOf("?plugin=")!==-1){var M,Y={},Z=___createForOfIteratorHelper_89(("plugin="+decodeURIComponent(r.split("?plugin=")[1].split("&")[0])).split(";"));try{for(Z.s();!(M=Z.n()).done;){var D=___slicedToArray_89(M.value.split("="),2),nt=D[0],ct=D[1];nt&&(Y[nt]=ct||!0)}}catch(at){Z.e(at)}finally{Z.f()}switch(Y.plugin){case"obfs-local":case"simple-obfs":o.plugin="obfs",o["plugin-opts"]={mode:Y.obfs,host:(0,_$utils_141.getIfNotBlank)(Y["obfs-host"])};break;case"v2ray-plugin":o.plugin="v2ray-plugin",o["plugin-opts"]={mode:"websocket",host:(0,_$utils_141.getIfNotBlank)(Y["obfs-host"]),path:(0,_$utils_141.getIfNotBlank)(Y.path),tls:(0,_$utils_141.getIfPresent)(Y.tls)};break;default:throw new Error("Unsupported plugin option: ".concat(Y.plugin))}}return/(&|\?)uot=(1|true)/i.test(h)&&(o["udp-over-tcp"]=!0),/(&|\?)tfo=(1|true)/i.test(h)&&(o.tfo=!0),o}},{name:"URI SSR Parser",test:function(t){return/^ssr:\/\//.test(t)},parse:function(t){var e=(t=_$base64_20.Base64.decode(t.split("ssr://")[1])).indexOf(":origin");e===-1&&(e=t.indexOf(":auth_"));var n=t.substring(0,e),r=n.substring(0,n.lastIndexOf(":")),o=n.substring(n.lastIndexOf(":")+1),f=t.substring(e+1).split("/?")[0].split(":"),d={type:"ssr",server:r,port:o,protocol:f[0],cipher:f[1],obfs:f[2],password:_$base64_20.Base64.decode(f[3])},h={};if((t=t.split("/?")[1].split("&")).length>1){var y,F=___createForOfIteratorHelper_89(t);try{for(F.s();!(y=F.n()).done;){var S=___slicedToArray_89(y.value.split("="),2),T=S[0],U=S[1];(U=U.trim()).length>0&&U!=="(null)"&&(h[T]=U)}}catch(M){F.e(M)}finally{F.f()}}return ___objectSpread_89(___objectSpread_89({},d),{},{name:h.remarks?_$base64_20.Base64.decode(h.remarks):d.server,"protocol-param":(0,_$utils_141.getIfNotBlank)(_$base64_20.Base64.decode(h.protoparam||"").replace(/\s/g,"")),"obfs-param":(0,_$utils_141.getIfNotBlank)(_$base64_20.Base64.decode(h.obfsparam||"").replace(/\s/g,""))})}},{name:"URI VMess Parser",test:function(t){return/^vmess:\/\//.test(t)},parse:function(t){t=t.split("vmess://")[1];var e=_$base64_20.Base64.decode(t);if(/=\s*vmess/.test(e)){var n,r=e.split(",").map(function(K){return K.trim()}),o={},f=___createForOfIteratorHelper_89(r);try{for(f.s();!(n=f.n()).done;){var d=n.value;if(d.indexOf("=")!==-1){var h=___slicedToArray_89(d.split("="),2),y=h[0],F=h[1];o[y.trim()]=F.trim()}}}catch(K){f.e(K)}finally{f.f()}var S={name:r[0].split("=")[0].trim(),type:"vmess",server:r[1],port:r[2],cipher:(0,_$utils_141.getIfNotBlank)(r[3],"auto"),uuid:r[4].match(/^"(.*)"$/)[1],tls:o.obfs==="wss",udp:(0,_$utils_141.getIfPresent)(o["udp-relay"]),tfo:(0,_$utils_141.getIfPresent)(o["fast-open"]),"skip-cert-verify":(0,_$utils_141.isPresent)(o["tls-verification"])?!o["tls-verification"]:void 0};if((0,_$utils_141.isPresent)(o.obfs)){if(o.obfs!=="ws"&&o.obfs!=="wss")throw new Error("Unsupported obfs: ".concat(o.obfs));S.network="ws",S["ws-opts"].path=((0,_$utils_141.getIfNotBlank)(o["obfs-path"])||'"/"').match(/^"(.*)"$/)[1];var T=o["obfs-header"];T&&T.indexOf("Host")!==-1&&(T=T.match(/Host:\s*([a-zA-Z0-9-.]*)/)[1]),(0,_$utils_141.isNotBlank)(T)&&(S["ws-opts"].headers={Host:T})}return S}var U,M,Y,Z,D={};try{D=JSON.parse(e)}catch{var nt=___slicedToArray_89(/(^[^?]+?)\/?\?(.*)$/.exec(t),3),ct=(nt[0],nt[1]),at=nt[2];e=_$base64_20.Base64.decode(ct);var et,mt=___createForOfIteratorHelper_89(at.split("&"));try{for(mt.s();!(et=mt.n()).done;){var At=___slicedToArray_89(et.value.split("="),2),dt=At[0],ht=At[1],xt=ht;(xt=decodeURIComponent(ht)).indexOf(",")===-1?D[dt]=xt:D[dt]=xt.split(",")}}catch(J){mt.e(J)}finally{mt.f()}var l=___slicedToArray_89(/(^[^:]+?):([^:]+?)@(.*):(\d+)$/.exec(e),5),s=(l[0],l[1]),v=l[2],$=l[3],E=l[4];D.scy=s,D.id=v,D.port=E,D.add=$}var rt=D.add,gt=parseInt((0,_$utils_141.getIfPresent)(D.port),10),Et={name:(U=(M=(Y=D.ps)!==null&&Y!==void 0?Y:D.remarks)!==null&&M!==void 0?M:D.remark)!==null&&U!==void 0?U:"VMess ".concat(rt,":").concat(gt),type:"vmess",server:rt,port:gt,cipher:(0,_$utils_141.getIfPresent)(D.scy,"auto"),uuid:D.id,alterId:parseInt((0,_$utils_141.getIfPresent)((Z=D.aid)!==null&&Z!==void 0?Z:D.alterId,0),10),tls:["tls",!0,1,"1"].includes(D.tls),"skip-cert-verify":(0,_$utils_141.isPresent)(D.verify_cert)?!D.verify_cert:void 0};!Et["skip-cert-verify"]&&(0,_$utils_141.isPresent)(D.allowInsecure)&&(Et["skip-cert-verify"]=/(TRUE)|1/i.test(D.allowInsecure)),Et.tls&&D.sni&&D.sni!==""&&(Et.sni=D.sni);var Ct=!1;if(D.net==="ws"||D.obfs==="websocket"?Et.network="ws":["http"].includes(D.net)||["http"].includes(D.obfs)||["http"].includes(D.type)?Et.network="http":["grpc"].includes(D.net)?Et.network="grpc":D.net==="httpupgrade"||Et.network==="httpupgrade"?(Et.network="ws",Ct=!0):D.net!=="h2"&&Et.network!=="h2"||(Et.network="h2"),Et.network){var x,N=(x=D.host)!==null&&x!==void 0?x:D.obfsParam;try{var G=JSON.parse(N),A=G?.Host;A&&(N=A)}catch{}var C=D.path;if(Et.network==="http"&&(N&&(N=N.split(",").map(function(K){return K.trim()}),N=Array.isArray(N)?N[0]:N),C=C?Array.isArray(C)?C[0]:C:"/"),C||N)if(["grpc"].includes(Et.network))Et["".concat(Et.network,"-opts")]={"grpc-service-name":(0,_$utils_141.getIfNotBlank)(C),"_grpc-type":(0,_$utils_141.getIfNotBlank)(D.type),"_grpc-authority":(0,_$utils_141.getIfNotBlank)(D.authority)};else{var j={path:(0,_$utils_141.getIfNotBlank)(C),headers:{Host:(0,_$utils_141.getIfNotBlank)(N)}};Ct&&(j["v2ray-http-upgrade"]=!0,j["v2ray-http-upgrade-fast-open"]=!0),Et["".concat(Et.network,"-opts")]=j}else delete Et.network}return Et}},{name:"URI VLESS Parser",test:function(t){return/^vless:\/\//.test(t)},parse:function(t){var e,n,r,o;t=t.split("vless://")[1];var f=/^(.*?)@(.*?):(\d+)\/?(\?(.*?))?(?:#(.*?))?$/.exec(t);if(!f){var d=___slicedToArray_89(/^(.*?)(\?.*?$)/.exec(t),3),h=(d[0],d[1]),y=d[2];t="".concat(_$base64_20.Base64.decode(h)).concat(y),f=/^(.*?)@(.*?):(\d+)\/?(\?(.*?))?(?:#(.*?))?$/.exec(t),o=!0}var F=___slicedToArray_89(f,7),S=(F[0],F[1]),T=F[2],U=F[3],M=(F[4],F[5]),Y=M===void 0?"":M,Z=F[6];o&&(S=S.replace(/^.*?:/g,"")),U=parseInt("".concat(U),10),S=decodeURIComponent(S),Z!=null&&(Z=decodeURIComponent(Z));var D,nt,ct={type:"vless",name:Z,server:T,port:U,uuid:S},at={},et=___createForOfIteratorHelper_89(Y.split("&"));try{for(et.s();!(D=et.n()).done;){var mt,At=___slicedToArray_89(D.value.split("="),2),dt=At[0],ht=At[1];mt=decodeURIComponent(ht),at[dt]=mt}}catch(gt){et.e(gt)}finally{et.f()}if(ct.name=(e=(n=(r=Z)!==null&&r!==void 0?r:at.remarks)!==null&&n!==void 0?n:at.remark)!==null&&e!==void 0?e:"VLESS ".concat(T,":").concat(U),ct.tls=at.security&&at.security!=="none",o&&/TRUE|1/i.test(at.tls)&&(ct.tls=!0,at.security=(nt=at.security)!==null&&nt!==void 0?nt:"reality"),ct.sni=at.sni||at.peer,ct.flow=at.flow,!ct.flow&&o&&at.xtls){var xt=[void 0,"xtls-rprx-direct","xtls-rprx-vision"][at.xtls];xt&&(ct.flow=xt)}if(ct["client-fingerprint"]=at.fp,ct.alpn=at.alpn?at.alpn.split(","):void 0,ct["skip-cert-verify"]=/(TRUE)|1/i.test(at.allowInsecure),["reality"].includes(at.security)){var l={};at.pbk&&(l["public-key"]=at.pbk),at.sid&&(l["short-id"]=at.sid),Object.keys(l).length>0&&(ct["".concat(at.security,"-opts")]=l)}var s=!1;if(ct.network=at.type,ct.network==="tcp"&&at.headerType==="http"?ct.network="http":ct.network==="httpupgrade"&&(ct.network="ws",s=!0),!ct.network&&o&&at.obfs&&(ct.network=at.obfs),["websocket"].includes(ct.network)&&(ct.network="ws"),ct.network&&!["tcp","none"].includes(ct.network)){var v,$={},E=(v=at.host)!==null&&v!==void 0?v:at.obfsParam;if(E)if(at.obfsParam)try{var rt=JSON.parse(E);$.headers=rt}catch{$.headers={Host:E}}else $.headers={Host:E};at.serviceName?($["".concat(ct.network,"-service-name")]=at.serviceName,["grpc"].includes(ct.network)&&at.authority&&($["_grpc-authority"]=at.authority)):o&&at.path&&(["ws","http","h2"].includes(ct.network)||($["".concat(ct.network,"-service-name")]=at.path,delete at.path)),at.path&&($.path=at.path),["grpc"].includes(ct.network)&&($["_grpc-type"]=at.mode||"gun"),s&&($["v2ray-http-upgrade"]=!0,$["v2ray-http-upgrade-fast-open"]=!0),Object.keys($).length>0&&(ct["".concat(ct.network,"-opts")]=$),ct.network==="kcp"&&(at.seed&&(ct.seed=at.seed),ct.headerType=at.headerType||"none")}return ct}},{name:"URI TUIC Parser",test:function(t){return/^tuic:\/\//.test(t)},parse:function(t){var e;t=t.split(/tuic:\/\//)[1];var n=___slicedToArray_89(/^(.*?):(.*?)@(.*?)(:(\d+))?\/?(\?(.*?))?(?:#(.*?))?$/.exec(t),9),r=(n[0],n[1]),o=n[2],f=n[3],d=(n[4],n[5]),h=(n[6],n[7]),y=h===void 0?"":h,F=n[8];d=parseInt("".concat(d),10),isNaN(d)&&(d=443),o=decodeURIComponent(o),F!=null&&(F=decodeURIComponent(F));var S,T={type:"tuic",name:F=(e=F)!==null&&e!==void 0?e:"TUIC ".concat(f,":").concat(d),server:f,port:d,password:o,uuid:r},U=___createForOfIteratorHelper_89(y.split("&"));try{for(U.s();!(S=U.n()).done;){var M=___slicedToArray_89(S.value.split("="),2),Y=M[0],Z=M[1];Y=Y.replace(/_/,"-"),Z=decodeURIComponent(Z),["alpn"].includes(Y)?T[Y]=Z?Z.split(","):void 0:["allow-insecure"].includes(Y)?T["skip-cert-verify"]=/(TRUE)|1/i.test(Z):["disable-sni","reduce-rtt"].includes(Y)?T[Y]=/(TRUE)|1/i.test(Z):T[Y]=Z}}catch(D){U.e(D)}finally{U.f()}return T}},{name:"URI WireGuard Parser",test:function(t){return/^(wireguard|wg):\/\//.test(t)},parse:function(t){var e;t=t.split(/(wireguard|wg):\/\//)[2];var n=___slicedToArray_89(/^((.*?)@)?(.*?)(:(\d+))?\/?(\?(.*?))?(?:#(.*?))?$/.exec(t),9),r=(n[0],n[1],n[2]),o=n[3],f=(n[4],n[5]),d=(n[6],n[7]),h=d===void 0?"":d,y=n[8];f=parseInt("".concat(f),10),isNaN(f)&&(f=51820),r=decodeURIComponent(r),y!=null&&(y=decodeURIComponent(y));var F,S={type:"wireguard",name:y=(e=y)!==null&&e!==void 0?e:"WireGuard ".concat(o,":").concat(f),server:o,port:f,"private-key":r,udp:!0},T=___createForOfIteratorHelper_89(h.split("&"));try{for(T.s();!(F=T.n()).done;){var U=___slicedToArray_89(F.value.split("="),2),M=U[0],Y=U[1];if(M=M.replace(/_/,"-"),Y=decodeURIComponent(Y),["reserved"].includes(M)){var Z=Y.split(",").map(function(nt){return parseInt(nt.trim(),10)}).filter(function(nt){return Number.isInteger(nt)});Z.length===3&&(S[M]=Z)}else if(["address","ip"].includes(M))Y.split(",").map(function(nt){var ct=nt.trim().replace(/\/\d+$/,"").replace(/^\[/,"").replace(/\]$/,"");(0,_$utils_141.isIPv4)(ct)?S.ip=ct:(0,_$utils_141.isIPv6)(ct)&&(S.ipv6=ct)});else if(["mtu"].includes(M)){var D=parseInt(Y.trim(),10);Number.isInteger(D)&&(S[M]=D)}else/publickey/i.test(M)?S["public-key"]=Y:/privatekey/i.test(M)?S["private-key"]=Y:["udp"].includes(M)?S[M]=/(TRUE)|1/i.test(Y):["flag"].includes(M)||(S[M]=Y)}}catch(nt){T.e(nt)}finally{T.f()}return S}},{name:"URI Hysteria Parser",test:function(t){return/^(hysteria|hy):\/\//.test(t)},parse:function(t){var e;t=t.split(/(hysteria|hy):\/\//)[2];var n=___slicedToArray_89(/^(.*?)(:(\d+))?\/?(\?(.*?))?(?:#(.*?))?$/.exec(t),7),r=(n[0],n[1]),o=(n[2],n[3]),f=(n[4],n[5]),d=f===void 0?"":f,h=n[6];o=parseInt("".concat(o),10),isNaN(o)&&(o=443),h!=null&&(h=decodeURIComponent(h));var y,F={type:"hysteria",name:h=(e=h)!==null&&e!==void 0?e:"Hysteria ".concat(r,":").concat(o),server:r,port:o},S={},T=___createForOfIteratorHelper_89(d.split("&"));try{for(T.s();!(y=T.n()).done;){var U=___slicedToArray_89(y.value.split("="),2),M=U[0],Y=U[1];M=M.replace(/_/,"-"),Y=decodeURIComponent(Y),["alpn"].includes(M)?F[M]=Y?Y.split(","):void 0:["insecure"].includes(M)?F["skip-cert-verify"]=/(TRUE)|1/i.test(Y):["auth"].includes(M)?F["auth-str"]=Y:["mport"].includes(M)?F.ports=Y:["obfsParam"].includes(M)?F.obfs=Y:["upmbps"].includes(M)?F.up=Y:["downmbps"].includes(M)?F.down=Y:["obfs"].includes(M)?F._obfs=Y||"":["fast-open","peer"].includes(M)?S[M]=Y:F[M]=Y}}catch(Z){T.e(Z)}finally{T.f()}return!F.sni&&S.peer&&(F.sni=S.peer),!F["fast-open"]&&S.fastopen&&(F["fast-open"]=!0),F.protocol||(F.protocol="udp"),F}},{name:"URI Hysteria2 Parser",test:function(t){return/^(hysteria2|hy2):\/\//.test(t)},parse:function(t){var e,n;t=t.split(/(hysteria2|hy2):\/\//)[2];var r=___slicedToArray_89(/^(.*?)@(.*?)(:((\d+(-\d+)?)([,;]\d+(-\d+)?)*))?\/?(\?(.*?))?(?:#(.*?))?$/.exec(t),12),o=(r[0],r[1]),f=r[2],d=(r[3],r[4]),h=(r[5],r[6],r[7],r[8],r[9],r[10]),y=h===void 0?"":h,F=r[11];/^\d+$/.test(d)?(d=parseInt("".concat(d),10),isNaN(d)&&(d=443)):d?(n=d,d=(0,_$utils_141.getRandomPort)(n)):d=443,o=decodeURIComponent(o),F!=null&&(F=decodeURIComponent(F));var S,T={type:"hysteria2",name:F=(e=F)!==null&&e!==void 0?e:"Hysteria2 ".concat(f,":").concat(d),server:f,port:d,ports:n,password:o},U={},M=___createForOfIteratorHelper_89(y.split("&"));try{for(M.s();!(S=M.n()).done;){var Y,Z=___slicedToArray_89(S.value.split("="),2),D=Z[0],nt=Z[1];Y=decodeURIComponent(nt),U[D]=Y}}catch(ct){M.e(ct)}finally{M.f()}return T.sni=U.sni,!T.sni&&U.peer&&(T.sni=U.peer),U.obfs&&U.obfs!=="none"&&(T.obfs=U.obfs),T.ports=U.mport,T["obfs-password"]=U["obfs-password"],T["skip-cert-verify"]=/(TRUE)|1/i.test(U.insecure),T.tfo=/(TRUE)|1/i.test(U.fastopen),T["tls-fingerprint"]=U.pinSHA256,T}},{name:"URI Trojan Parser",test:function(t){return/^trojan:\/\//.test(t)},parse:function(t){var e=/^(trojan:\/\/.*?@.*?)(:(\d+))?\/?(\?.*?)?$/.exec(t);e?.[2]||(t=t.replace(e[1],"".concat(e[1],":443")));var n=___slicedToArray_89(t.split(/#(.+)/,2),2),r=n[0],o=n[1],f=(0,_trojanUri.default)().parse(r);if((0,_$utils_141.isNotBlank)(o))try{f.name=decodeURIComponent(o)}catch{}return f}},{name:"Clash Parser",test:function(t){try{JSON.parse(t)}catch{return!1}return!0},parse:function(t){var e=JSON.parse(t);if(!["mieru","juicity","ss","ssr","vmess","socks5","http","snell","trojan","tuic","vless","hysteria","hysteria2","wireguard","ssh","direct"].includes(e.type))throw new Error("Clash does not support proxy with type: ".concat(e.type));return["vmess","vless"].includes(e.type)&&(e.sni=e.servername,delete e.servername),e["server-cert-fingerprint"]&&(e["tls-fingerprint"]=e["server-cert-fingerprint"]),e.fingerprint&&(e["tls-fingerprint"]=e.fingerprint),e["dialer-proxy"]&&(e["underlying-proxy"]=e["dialer-proxy"]),e["benchmark-url"]&&(e["test-url"]=e["benchmark-url"]),e["benchmark-timeout"]&&(e["test-timeout"]=e["benchmark-timeout"]),e}},{name:"Surge Direct Parser",test:function(t){return/^.*=\s*direct/.test(t.split(",")[0])},parse:function(t){return(0,___surge_89.default)().parse(t)}},{name:"Surge SSH Parser",test:function(t){return/^.*=\s*ssh/.test(t.split(",")[0])},parse:function(t){return(0,___surge_89.default)().parse(t)}},{name:"Surge SS Parser",test:function(t){return/^.*=\s*ss/.test(t.split(",")[0])},parse:function(t){return(0,___surge_89.default)().parse(t)}},{name:"Surge VMess Parser",test:function(t){return/^.*=\s*vmess/.test(t.split(",")[0])&&t.indexOf("username")!==-1},parse:function(t){return(0,___surge_89.default)().parse(t)}},{name:"Surge Trojan Parser",test:function(t){return/^.*=\s*trojan/.test(t.split(",")[0])},parse:function(t){return(0,___surge_89.default)().parse(t)}},{name:"Surge HTTP Parser",test:function(t){return/^.*=\s*https?/.test(t.split(",")[0])},parse:function(t){return(0,___surge_89.default)().parse(t)}},{name:"Surge Snell Parser",test:function(t){return/^.*=\s*snell/.test(t.split(",")[0])},parse:function(t){return(0,___surge_89.default)().parse(t)}},{name:"Surge Tuic Parser",test:function(t){return/^.*=\s*tuic(-v5)?/.test(t.split(",")[0])},parse:function(t){var e=surge_port_hopping(t),n=e.port_hopping,r=e.line,o=(0,___surge_89.default)().parse(r);return o.ports=n,o}},{name:"Surge WireGuard Parser",test:function(t){return/^.*=\s*wireguard/.test(t.split(",")[0])},parse:function(t){return(0,___surge_89.default)().parse(t)}},{name:"Surge Hysteria2 Parser",test:function(t){return/^.*=\s*hysteria2/.test(t.split(",")[0])},parse:function(t){var e=surge_port_hopping(t),n=e.port_hopping,r=e.line,o=(0,___surge_89.default)().parse(r);return o.ports=n,o}},{name:"Surge Socks5 Parser",test:function(t){return/^.*=\s*socks5(-tls)?/.test(t.split(",")[0])},parse:function(t){return(0,___surge_89.default)().parse(t)}},{name:"Surge External Parser",test:function(t){return/^.*=\s*external/.test(t.split(",")[0])},parse:function(t){var e,n,r,o=___slicedToArray_89(/^\s*(.*?)\s*?=\s*?external\s*?,\s*(.*?)\s*$/.exec(t),3),f=(o[0],o[1]),d=o[2],h=(e=/(,|^)\s*?exec\s*?=\s*"(.*?)"\s*?(,|$)/.exec(t=d))===null||e===void 0?void 0:e[2];h||(h=(r=/(,|^)\s*?exec\s*?=\s*(.*?)\s*?(,|$)/.exec(t))===null||r===void 0?void 0:r[2]);var y,F=(n=/(,|^)\s*?local-port\s*?=\s*"(.*?)"\s*?(,|$)/.exec(t))===null||n===void 0?void 0:n[2];F||(F=(y=/(,|^)\s*?local-port\s*?=\s*(.*?)\s*?(,|$)/.exec(t))===null||y===void 0?void 0:y[2]);for(var S,T=/(,|^)\s*?args\s*?=\s*("(.*?)"|(.*?))(?=\s*?(,|$))/g,U=[];(S=T.exec(t))!==null;)S[3]!=null?U.push(S[3]):S[4]!=null&&U.push(S[4]);for(var M,Y=/(,|^)\s*?addresses\s*?=\s*("(.*?)"|(.*?))(?=\s*?(,|$))/g,Z=[];(M=Y.exec(t))!==null;){var D=void 0;M[3]!=null?D=M[3]:M[4]!=null&&(D=M[4]),D!=null&&(D="".concat(D).trim().replace(/^\[/,"").replace(/\]$/,"")),__isIP_89(D)&&Z.push(D)}return{type:"external",name:f,exec:h,"local-port":F,args:U,addresses:Z}}},{name:"Loon SS Parser",test:function(t){return t.split(",")[0].split("=")[1].trim().toLowerCase()==="shadowsocks"},parse:function(t){return(0,___loon_89.default)().parse(t)}},{name:"Loon SSR Parser",test:function(t){return t.split(",")[0].split("=")[1].trim().toLowerCase()==="shadowsocksr"},parse:function(t){return(0,___loon_89.default)().parse(t)}},{name:"Loon VMess Parser",test:function(t){return/^.*=\s*vmess/i.test(t.split(",")[0])&&t.indexOf("username")===-1},parse:function(t){return(0,___loon_89.default)().parse(t)}},{name:"Loon Vless Parser",test:function(t){return/^.*=\s*vless/i.test(t.split(",")[0])},parse:function(t){return(0,___loon_89.default)().parse(t)}},{name:"Loon Hysteria2 Parser",test:function(t){return/^.*=\s*Hysteria2/i.test(t.split(",")[0])},parse:function(t){return(0,___loon_89.default)().parse(t)}},{name:"Loon Trojan Parser",test:function(t){return/^.*=\s*trojan/i.test(t.split(",")[0])},parse:function(t){return(0,___loon_89.default)().parse(t)}},{name:"Loon HTTP Parser",test:function(t){return/^.*=\s*http/i.test(t.split(",")[0])},parse:function(t){return(0,___loon_89.default)().parse(t)}},{name:"Loon SOCKS5 Parser",test:function(t){return/^.*=\s*socks5/i.test(t.split(",")[0])},parse:function(t){return(0,___loon_89.default)().parse(t)}},{name:"Loon WireGuard Parser",test:function(t){return/^.*=\s*wireguard/i.test(t.split(",")[0])},parse:function(t){var e,n,r,o,f,d,h,y,F,S,T,U,M,Y,Z=(e=t.match(/(^.*?)\s*?=\s*?wireguard\s*?,.+?\s*?=\s*?.+?/i))===null||e===void 0?void 0:e[1],D=(n=(t=t.replace(Z,"").replace(/^\s*?=\s*?wireguard\s*/i,"")).match(/,\s*?peers\s*?=\s*?\[\s*?\{\s*?(.+?)\s*?\}\s*?\]/i))===null||n===void 0?void 0:n[1],nt=D.match(/(,|^)\s*?endpoint\s*?=\s*?"?(.+?):(\d+)"?\s*?(,|$)/i),ct=nt?.[2],at=parseInt(nt?.[3],10),et=(r=t.match(/(,|^)\s*?mtu\s*?=\s*?"?(\d+?)"?\s*?(,|$)/i))===null||r===void 0?void 0:r[2];et&&(et=parseInt(et,10));var mt=(o=t.match(/(,|^)\s*?keepalive\s*?=\s*?"?(\d+?)"?\s*?(,|$)/i))===null||o===void 0?void 0:o[2];mt&&(mt=parseInt(mt,10));var At,dt=(f=D.match(/(,|^)\s*?reserved\s*?=\s*?"?(\[\s*?.+?\s*?\])"?\s*?(,|$)/i))===null||f===void 0?void 0:f[2];dt&&(dt=JSON.parse(dt));var ht=(d=t.match(/(,|^)\s*?dns\s*?=\s*?"?(.+?)"?\s*?(,|$)/i))===null||d===void 0?void 0:d[2],xt=(h=t.match(/(,|^)\s*?dnsv6\s*?=\s*?"?(.+?)"?\s*?(,|$)/i))===null||h===void 0?void 0:h[2];(ht||xt)&&(At=[],ht&&At.push(ht),xt&&At.push(xt));var l=(y=D.match(/(,|^)\s*?allowed-ips\s*?=\s*?"(.+?)"\s*?(,|$)/i))===null||y===void 0||(F=y[2])===null||F===void 0?void 0:F.split(",").map(function(gt){return gt.trim()}),s=(S=D.match(/(,|^)\s*?preshared-key\s*?=\s*?"?(.+?)"?\s*?(,|$)/i))===null||S===void 0?void 0:S[2],v=(T=t.match(/(,|^)\s*?interface-ip\s*?=\s*?"?(.+?)"?\s*?(,|$)/i))===null||T===void 0?void 0:T[2],$=(U=t.match(/(,|^)\s*?interface-ipv6\s*?=\s*?"?(.+?)"?\s*?(,|$)/i))===null||U===void 0?void 0:U[2],E=(M=D.match(/(,|^)\s*?public-key\s*?=\s*?"?(.+?)"?\s*?(,|$)/i))===null||M===void 0?void 0:M[2],rt={type:"wireguard",name:Z,server:ct,port:at,ip:v,ipv6:$,"private-key":(Y=t.match(/(,|^)\s*?private-key\s*?=\s*?"?(.+?)"?\s*?(,|$)/i))===null||Y===void 0?void 0:Y[2],"public-key":E,mtu:et,keepalive:mt,reserved:dt,"allowed-ips":l,"preshared-key":s,dns:At,udp:!0,peers:[{server:ct,port:at,ip:v,ipv6:$,"public-key":E,"pre-shared-key":s,"allowed-ips":l,reserved:dt}]};return Array.isArray(rt.dns)&&rt.dns.length>0&&(rt["remote-dns-resolve"]=!0),rt}},{name:"QX SS Parser",test:function(t){return/^shadowsocks\s*=/.test(t.split(",")[0].trim())&&t.indexOf("ssr-protocol")===-1},parse:function(t){return(0,___qx_89.default)().parse(t)}},{name:"QX SSR Parser",test:function(t){return/^shadowsocks\s*=/.test(t.split(",")[0].trim())&&t.indexOf("ssr-protocol")!==-1},parse:function(t){return(0,___qx_89.default)().parse(t)}},{name:"QX VMess Parser",test:function(t){return/^vmess\s*=/.test(t.split(",")[0].trim())},parse:function(t){return(0,___qx_89.default)().parse(t)}},{name:"QX VLESS Parser",test:function(t){return/^vless\s*=/.test(t.split(",")[0].trim())},parse:function(t){return(0,___qx_89.default)().parse(t)}},{name:"QX Trojan Parser",test:function(t){return/^trojan\s*=/.test(t.split(",")[0].trim())},parse:function(t){return(0,___qx_89.default)().parse(t)}},{name:"QX HTTP Parser",test:function(t){return/^http\s*=/.test(t.split(",")[0].trim())},parse:function(t){return(0,___qx_89.default)().parse(t)}},{name:"QX Socks5 Parser",test:function(t){return/^socks5\s*=/.test(t.split(",")[0].trim())},parse:function(t){return(0,___qx_89.default)().parse(t)}}];_$parsers_89.default=___default_89;var _$gist_139={};function ___typeof_139(t){return(___typeof_139=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$gist_139,"__esModule",{value:!0}),_$gist_139.default=void 0;var ___app_139=___interopRequireDefault_139(_$app_87);function ___interopRequireDefault_139(t){return t&&t.__esModule?t:{default:t}}function ___slicedToArray_139(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||___unsupportedIterableToArray_139(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArrayLimit(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,o,f=[],d=!0,h=!1;try{for(n=n.call(t);!(d=(r=n.next()).done)&&(f.push(r.value),!e||f.length!==e);d=!0);}catch(y){h=!0,o=y}finally{try{d||n.return==null||n.return()}finally{if(h)throw o}}return f}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function ___regeneratorRuntime_139(){___regeneratorRuntime_139=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=typeof Symbol=="function"?Symbol:{},o=r.iterator||"@@iterator",f=r.asyncIterator||"@@asyncIterator",d=r.toStringTag||"@@toStringTag";function h(l,s,v){return Object.defineProperty(l,s,{value:v,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,v,$){return s[v]=$}}function y(l,s,v,$){var E=s&&s.prototype instanceof T?s:T,rt=Object.create(E.prototype),gt=new dt($||[]);return rt._invoke=function(Et,Ct,x){var N="suspendedStart";return function(G,A){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(G==="throw")throw A;return{value:void 0,done:!0}}for(x.method=G,x.arg=A;;){var C=x.delegate;if(C){var j=et(C,x);if(j){if(j===S)continue;return j}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var K=F(Et,Ct,x);if(K.type==="normal"){if(N=x.done?"completed":"suspendedYield",K.arg===S)continue;return{value:K.arg,done:x.done}}K.type==="throw"&&(N="completed",x.method="throw",x.arg=K.arg)}}}(l,v,gt),rt}function F(l,s,v){try{return{type:"normal",arg:l.call(s,v)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var S={};function T(){}function U(){}function M(){}var Y={};h(Y,o,function(){return this});var Z=Object.getPrototypeOf,D=Z&&Z(Z(ht([])));D&&D!==e&&n.call(D,o)&&(Y=D);var nt=M.prototype=T.prototype=Object.create(Y);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(v){return this._invoke(s,v)})})}function at(l,s){var v;this._invoke=function($,E){function rt(){return new s(function(gt,Et){(function Ct(x,N,G,A){var C=F(l[x],l,N);if(C.type!=="throw"){var j=C.arg,K=j.value;return K&&___typeof_139(K)=="object"&&n.call(K,"__await")?s.resolve(K.__await).then(function(J){Ct("next",J,G,A)},function(J){Ct("throw",J,G,A)}):s.resolve(K).then(function(J){j.value=J,G(j)},function(J){return Ct("throw",J,G,A)})}A(C.arg)})($,E,gt,Et)})}return v=v?v.then(rt,rt):rt()}}function et(l,s){var v=l.iterator[s.method];if(v===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,et(l,s),s.method==="throw"))return S;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var $=F(v,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,S;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,S):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,S)}function mt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function At(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function dt(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(mt,this),this.reset(!0)}function ht(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var v=-1,$=function E(){for(;++v<l.length;)if(n.call(l,v))return E.value=l[v],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:xt}}function xt(){return{value:void 0,done:!0}}return U.prototype=M,h(nt,"constructor",M),h(M,"constructor",U),U.displayName=h(M,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===U||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,M):(l.__proto__=M,h(l,d,"GeneratorFunction")),l.prototype=Object.create(nt),l},t.awrap=function(l){return{__await:l}},ct(at.prototype),h(at.prototype,f,function(){return this}),t.AsyncIterator=at,t.async=function(l,s,v,$,E){E===void 0&&(E=Promise);var rt=new at(y(l,s,v,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(gt){return gt.done?gt.value:rt.next()})},ct(nt),h(nt,d,"Generator"),h(nt,o,function(){return this}),h(nt,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var v in l)s.push(v);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=ht,dt.prototype={constructor:dt,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(At),!l)for(var s in this)s.charAt(0)==="t"&&n.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function v(Ct,x){return rt.type="throw",rt.arg=l,s.next=Ct,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return v("end");if(E.tryLoc<=this.prev){var gt=n.call(E,"catchLoc"),Et=n.call(E,"finallyLoc");if(gt&&Et){if(this.prev<E.catchLoc)return v(E.catchLoc,!0);if(this.prev<E.finallyLoc)return v(E.finallyLoc)}else if(gt){if(this.prev<E.catchLoc)return v(E.catchLoc,!0)}else{if(!Et)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return v(E.finallyLoc)}}}},abrupt:function(l,s){for(var v=this.tryEntries.length-1;v>=0;--v){var $=this.tryEntries[v];if($.tryLoc<=this.prev&&n.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,S):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),S},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.finallyLoc===l)return this.complete(v.completion,v.afterLoc),At(v),S}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.tryLoc===l){var $=v.completion;if($.type==="throw"){var E=$.arg;At(v)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,v){return this.delegate={iterator:ht(l),resultName:s,nextLoc:v},this.method==="next"&&(this.arg=void 0),S}},t}function ___createForOfIteratorHelper_139(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=___unsupportedIterableToArray_139(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){n=n.call(t)},n:function(){var y=n.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||n.return==null||n.return()}finally{if(h)throw f}}}}function ___unsupportedIterableToArray_139(t,e){if(t){if(typeof t=="string")return ___arrayLikeToArray_139(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?___arrayLikeToArray_139(t,e):void 0}}function ___arrayLikeToArray_139(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function __asyncGeneratorStep_139(t,e,n,r,o,f,d){try{var h=t[f](d),y=h.value}catch(F){return void n(F)}h.done?e(y):Promise.resolve(y).then(r,o)}function ___asyncToGenerator_139(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var f=t.apply(e,n);function d(y){__asyncGeneratorStep_139(f,r,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_139(f,r,o,d,h,"throw",y)}d(void 0)})}}function __ownKeys_139(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function ___objectSpread_139(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_139(Object(n),!0).forEach(function(r){___defineProperty_139(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):__ownKeys_139(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ___defineProperty_139(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ___classCallCheck_139(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ___defineProperties_139(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ___createClass_139(t,e,n){return e&&___defineProperties_139(t.prototype,e),n&&___defineProperties_139(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var Gist=function(){function Gist(_ref){var token=_ref.token,key=_ref.key,syncPlatform=_ref.syncPlatform;___classCallCheck_139(this,Gist);var _ENV=(0,_$openApi_151.ENV)(),isStash=_ENV.isStash,isLoon=_ENV.isLoon,isShadowRocket=_ENV.isShadowRocket,isQX=_ENV.isQX,_$$read=___app_139.default.read(_$constants_86.SETTINGS_KEY),defaultProxy=_$$read.defaultProxy,timeout=_$$read.defaultTimeout,proxy=defaultProxy;___app_139.default.env.isNode&&(proxy=proxy||eval("process.env.SUB_STORE_BACKEND_DEFAULT_PROXY")),syncPlatform==="gitlab"?(this.headers={"PRIVATE-TOKEN":"".concat(token),"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.141 Safari/537.36"},this.http=(0,_$openApi_151.HTTP)(___objectSpread_139(___objectSpread_139(___objectSpread_139(___objectSpread_139(___objectSpread_139({baseURL:"https://gitlab.com/api/v4",headers:___objectSpread_139(___objectSpread_139(___objectSpread_139({},this.headers),isStash&&proxy?{"X-Stash-Selected-Proxy":encodeURIComponent(proxy)}:{}),isShadowRocket&&proxy?{"X-Surge-Policy":proxy}:{})},proxy?{proxy}:{}),isLoon&&proxy?{node:proxy}:{}),isQX&&proxy?{opts:{policy:proxy}}:{}),proxy?(0,_$utils_141.getPolicyDescriptor)(proxy):{}),{},{timeout:timeout||8e3,events:{onResponse:function(t){if(/^[45]/.test(String(t.statusCode))){var e,n,r=JSON.parse(t.body);return Promise.reject("ERROR: ".concat((e=(n=r.message)===null||n===void 0?void 0:n.error)!==null&&e!==void 0?e:r.message))}return t}}}))):(this.headers={Authorization:"token ".concat(token),"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.141 Safari/537.36"},this.http=(0,_$openApi_151.HTTP)(___objectSpread_139(___objectSpread_139(___objectSpread_139(___objectSpread_139(___objectSpread_139({baseURL:"https://api.github.com",headers:___objectSpread_139(___objectSpread_139(___objectSpread_139({},this.headers),isStash&&proxy?{"X-Stash-Selected-Proxy":encodeURIComponent(proxy)}:{}),isShadowRocket&&proxy?{"X-Surge-Policy":proxy}:{})},proxy?{proxy}:{}),isLoon&&proxy?{node:proxy}:{}),isQX&&proxy?{opts:{policy:proxy}}:{}),proxy?(0,_$utils_141.getPolicyDescriptor)(proxy):{}),{},{timeout:timeout||8e3,events:{onResponse:function(t){return/^[45]/.test(String(t.statusCode))?Promise.reject("ERROR: ".concat(JSON.parse(t.body).message)):t}}}))),this.key=key,this.syncPlatform=syncPlatform}return ___createClass_139(Gist,[{key:"locate",value:(_locate=___asyncToGenerator_139(___regeneratorRuntime_139().mark(function t(){var e=this;return ___regeneratorRuntime_139().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(this.syncPlatform!=="gitlab"){n.next=4;break}return n.abrupt("return",this.http.get("/snippets").then(function(r){var o,f=___createForOfIteratorHelper_139(JSON.parse(r.body));try{for(f.s();!(o=f.n()).done;){var d=o.value;if(d.title===e.key)return d}}catch(h){f.e(h)}finally{f.f()}}));case 4:return n.abrupt("return",this.http.get("/gists?per_page=100&page=1").then(function(r){var o,f=___createForOfIteratorHelper_139(JSON.parse(r.body));try{for(f.s();!(o=f.n()).done;){var d=o.value;if(d.description===e.key)return d}}catch(h){f.e(h)}finally{f.f()}}));case 5:case"end":return n.stop()}},t,this)})),function(){return _locate.apply(this,arguments)})},{key:"upload",value:(_upload=___asyncToGenerator_139(___regeneratorRuntime_139().mark(function t(e){var n,r,o,f;return ___regeneratorRuntime_139().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(Object.keys(e).length!==0){d.next=2;break}return d.abrupt("return",Promise.reject("\u672A\u63D0\u4F9B\u9700\u4E0A\u4F20\u7684\u6587\u4EF6"));case 2:return d.next=4,this.locate();case 4:if(n=d.sent,r=e,n==null||!n.id){d.next=25;break}if(this.syncPlatform==="gitlab"&&(n.files=n.files.reduce(function(h,y){return h[y.path]=y,h},{})),o=[],f=___objectSpread_139({},n.files),Object.keys(r).map(function(h){f[h]?r[h].content==null||r[h].content===""?(delete f[h],o.push({action:"delete",file_path:h})):(f[h]=r[h],o.push({action:"update",file_path:h,content:r[h].content})):r[h].content==null||r[h].content===""?(delete f[h],delete r[h]):(f[h]=r[h],o.push({action:"create",file_path:h,content:r[h].content}))}),this.syncPlatform!=="gitlab"){d.next=20;break}if(Object.keys(f).length!==0){d.next=14;break}return d.abrupt("return",Promise.reject("\u672C\u6B21\u64CD\u4F5C\u5C06\u5BFC\u81F4\u6240\u6709\u6587\u4EF6\u7684\u5185\u5BB9\u90FD\u4E3A\u7A7A, \u65E0\u6CD5\u66F4\u65B0 snippet"));case 14:if(!(Object.keys(f).length>10)){d.next=16;break}return d.abrupt("return",Promise.reject("\u672C\u6B21\u64CD\u4F5C\u5C06\u5BFC\u81F4 snippet \u7684\u6587\u4EF6\u6570\u8D85\u8FC7 10, \u65E0\u6CD5\u66F4\u65B0 snippet"));case 16:return r=o,d.abrupt("return",this.http.put({headers:___objectSpread_139(___objectSpread_139({},this.headers),{},{"Content-Type":"application/json"}),url:"/snippets/".concat(n.id),body:JSON.stringify({files:r})}));case 20:if(Object.keys(f).length!==0){d.next=22;break}return d.abrupt("return",Promise.reject("\u672C\u6B21\u64CD\u4F5C\u5C06\u5BFC\u81F4\u6240\u6709\u6587\u4EF6\u7684\u5185\u5BB9\u90FD\u4E3A\u7A7A, \u65E0\u6CD5\u66F4\u65B0 gist"));case 22:return d.abrupt("return",this.http.patch({url:"/gists/".concat(n.id),body:JSON.stringify({files:r})}));case 23:d.next=36;break;case 25:if(r=Object.entries(r).reduce(function(h,y){var F=___slicedToArray_139(y,2),S=F[0],T=F[1];return T.content!==null&&T.content!==""&&(h[S]=T),h},{}),this.syncPlatform!=="gitlab"){d.next=33;break}if(Object.keys(r).length!==0){d.next=29;break}return d.abrupt("return",Promise.reject("\u6240\u6709\u6587\u4EF6\u7684\u5185\u5BB9\u90FD\u4E3A\u7A7A, \u65E0\u6CD5\u521B\u5EFA snippet"));case 29:return r=Object.keys(r).map(function(h){return{file_path:h,content:r[h].content}}),d.abrupt("return",this.http.post({headers:___objectSpread_139(___objectSpread_139({},this.headers),{},{"Content-Type":"application/json"}),url:"/snippets",body:JSON.stringify({title:this.key,visibility:"private",files:r})}));case 33:if(Object.keys(r).length!==0){d.next=35;break}return d.abrupt("return",Promise.reject("\u6240\u6709\u6587\u4EF6\u7684\u5185\u5BB9\u90FD\u4E3A\u7A7A, \u65E0\u6CD5\u521B\u5EFA gist"));case 35:return d.abrupt("return",this.http.post({url:"/gists",body:JSON.stringify({description:this.key,public:!1,files:r})}));case 36:case"end":return d.stop()}},t,this)})),function(t){return _upload.apply(this,arguments)})},{key:"download",value:function(){var t=___asyncToGenerator_139(___regeneratorRuntime_139().mark(function e(n){var r,o,f,d;return ___regeneratorRuntime_139().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.locate();case 2:if((r=h.sent)==null||!r.id){h.next=20;break}return h.prev=4,h.next=7,this.http.get("/gists/".concat(r.id)).then(function(y){return JSON.parse(y.body)});case 7:return o=h.sent,f=o.files,d=f[n].raw_url,h.next=12,this.http.get(d).then(function(y){return y.body});case 12:return h.abrupt("return",h.sent);case 15:return h.prev=15,h.t0=h.catch(4),h.abrupt("return",Promise.reject(h.t0));case 18:h.next=21;break;case 20:return h.abrupt("return",Promise.reject("\u627E\u4E0D\u5230 Sub-Store Gist"));case 21:case"end":return h.stop()}},e,this,[[4,15]])}));return function(e){return t.apply(this,arguments)}}()}]),Gist;var _upload,_locate}();_$gist_139.default=Gist;var _$preprocessors_113={};Object.defineProperty(_$preprocessors_113,"__esModule",{value:!0}),_$preprocessors_113.default=void 0;var ___default_113=[{name:"HTML",test:function(t){return/^<!DOCTYPE html>/.test(t)},parse:function(){return""}},{name:"Clash Provider",test:function(t){return/^payload:/gm.exec(t).index>=0},parse:function(t){return t.replace("payload:","").replace(/^\s*-\s*/gm,"")}}];_$preprocessors_113.default=___default_113;var _$producers_114={};Object.defineProperty(_$producers_114,"__esModule",{value:!0}),_$producers_114.default=void 0;var __obj_114,___yaml_114=(__obj_114=_$yaml_148)&&__obj_114.__esModule?__obj_114:{default:__obj_114},___default_114={QX:{type:"SINGLE",func:function(t){return["URL-REGEX","DEST-PORT","SRC-IP","IN-PORT","PROTOCOL","GEOSITE","GEOIP"].indexOf(t.type)!==-1?null:"".concat({"DOMAIN-KEYWORD":"HOST-KEYWORD","DOMAIN-SUFFIX":"HOST-SUFFIX",DOMAIN:"HOST","IP-CIDR6":"IP6-CIDR"}[t.type]||t.type,",").concat(t.content,",SUB-STORE")}},Surge:{type:"SINGLE",func:function(t){if(["GEOSITE","GEOIP"].indexOf(t.type)!==-1)return null;var e,n="".concat(t.type,",").concat(t.content);return["IP-CIDR","IP-CIDR6"].includes(t.type)&&(n+=((e=t.options)===null||e===void 0?void 0:e.length)>0?",".concat(t.options.join(",")):""),n}},Loon:{type:"SINGLE",func:function(t){return["SRC-IP","GEOSITE","GEOIP"].indexOf(t.type)!==-1?null:(["IP-CIDR","IP-CIDR6"].includes(t.type)&&t.options&&(t.options=t.options.filter(function(e){return["no-resolve"].includes(e)})),function(e){if(["GEOSITE","GEOIP"].indexOf(e.type)!==-1)return null;var n,r="".concat(e.type,",").concat(e.content);return["IP-CIDR","IP-CIDR6"].includes(e.type)&&(r+=((n=e.options)===null||n===void 0?void 0:n.length)>0?",".concat(e.options.join(",")):""),r}(t))}},Clash:{type:"ALL",func:function(t){var e={"DEST-PORT":"DST-PORT","SRC-IP":"SRC-IP-CIDR","IN-PORT":"SRC-PORT"},n={payload:t.map(function(r){var o,f="".concat(e[r.type]||r.type,",").concat(r.content);return["IP-CIDR","IP-CIDR6","GEOIP"].includes(r.type)&&(r.options&&(r.options=r.options.filter(function(d){return["no-resolve"].includes(d)})),f+=((o=r.options)===null||o===void 0?void 0:o.length)>0?",".concat(r.options.join(",")):""),f})};return ___yaml_114.default.dump(n)}}};_$producers_114.default=___default_114;var _$parsers_112={};function ___createForOfIteratorHelper_112(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(y,F){if(y){if(typeof y=="string")return ___arrayLikeToArray_112(y,void 0);var S=Object.prototype.toString.call(y).slice(8,-1);return S==="Object"&&y.constructor&&(S=y.constructor.name),S==="Map"||S==="Set"?Array.from(y):S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S)?___arrayLikeToArray_112(y,void 0):void 0}}(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){n=n.call(t)},n:function(){var y=n.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||n.return==null||n.return()}finally{if(h)throw f}}}}function ___arrayLikeToArray_112(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}Object.defineProperty(_$parsers_112,"__esModule",{value:!0}),_$parsers_112.default=void 0;var RULE_TYPES_MAPPING=[[/^(DOMAIN|host|HOST)$/,"DOMAIN"],[/^(DOMAIN-KEYWORD|host-keyword|HOST-KEYWORD)$/,"DOMAIN-KEYWORD"],[/^(DOMAIN-SUFFIX|host-suffix|HOST-SUFFIX)$/,"DOMAIN-SUFFIX"],[/^USER-AGENT$/i,"USER-AGENT"],[/^PROCESS-NAME$/,"PROCESS-NAME"],[/^(DEST-PORT|DST-PORT)$/,"DST-PORT"],[/^SRC-IP(-CIDR)?$/,"SRC-IP"],[/^(IN|SRC)-PORT$/,"IN-PORT"],[/^PROTOCOL$/,"PROTOCOL"],[/^IP-CIDR$/i,"IP-CIDR"],[/^(IP-CIDR6|ip6-cidr|IP6-CIDR)$/,"IP-CIDR6"],[/^GEOIP$/i,"GEOIP"],[/^GEOSITE$/i,"GEOSITE"]],___default_112=[{name:"Universal Rule Parser",test:function(){return!0},parse:function(t){var e,n=[],r=___createForOfIteratorHelper_112(t.split(`
`));try{for(r.s();!(e=r.n()).done;){var o=e.value;if((o=o.trim()).length!==0&&!/\s*#/.test(o))try{var f,d=o.split(",").map(function(U){return U.trim()}),h=d[0],y=!1,F=___createForOfIteratorHelper_112(RULE_TYPES_MAPPING);try{for(F.s();!(f=F.n()).done;){var S=f.value;if(S[0].test(h)){y=!0;var T={type:S[1],content:d[1]};["IP-CIDR","IP-CIDR6","GEOIP"].includes(T.type)&&(T.options=d.slice(2)),n.push(T)}}}catch(U){F.e(U)}finally{F.f()}if(!y)throw new Error("Invalid rule type: "+h)}catch{}}}catch(U){r.e(U)}finally{r.f()}return n}}];_$parsers_112.default=___default_112;var _$ruleUtils_111={};Object.defineProperty(_$ruleUtils_111,"__esModule",{value:!0}),_$ruleUtils_111.RuleUtils=void 0;var ___preprocessors_111=___interopRequireDefault_111(_$preprocessors_113),___producers_111=___interopRequireDefault_111(_$producers_114),___parsers_111=___interopRequireDefault_111(_$parsers_112),___app_111=___interopRequireDefault_111(_$app_87);function ___interopRequireDefault_111(t){return t&&t.__esModule?t:{default:t}}function ___createForOfIteratorHelper_111(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(y,F){if(y){if(typeof y=="string")return ___arrayLikeToArray_111(y,void 0);var S=Object.prototype.toString.call(y).slice(8,-1);return S==="Object"&&y.constructor&&(S=y.constructor.name),S==="Map"||S==="Set"?Array.from(y):S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S)?___arrayLikeToArray_111(y,void 0):void 0}}(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){n=n.call(t)},n:function(){var y=n.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||n.return==null||n.return()}finally{if(h)throw f}}}}function ___arrayLikeToArray_111(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var RuleUtils={parse:function(t){t=function(f){var d,h=___createForOfIteratorHelper_111(___preprocessors_111.default);try{for(h.s();!(d=h.n()).done;){var y=d.value;try{if(y.test(f))return ___app_111.default.info("Pre-processor [".concat(y.name,"] activated")),y.parse(f)}catch(F){___app_111.default.error("Parser [".concat(y.name,`] failed
 Reason: `).concat(F))}}}catch(F){h.e(F)}finally{h.f()}return f}(t);var e,n=___createForOfIteratorHelper_111(___parsers_111.default);try{for(n.s();!(e=n.n()).done;){var r=e.value,o=void 0;try{o=r.test(t)}catch{o=!1}if(o)return ___app_111.default.info("Rule parser [".concat(r.name,"] is activated!")),r.parse(t)}}catch(f){n.e(f)}finally{n.f()}},produce:function(t,e){var n=___producers_111.default[e];if(!n)throw new Error("Target platform: ".concat(e," is not supported!"));return n.type===void 0||n.type==="SINGLE"?t.map(function(r){try{return n.func(r)}catch{return""}}).filter(function(r){return r.length>0}).join(`
`):n.type==="ALL"?n.func(t):void 0}};_$ruleUtils_111.RuleUtils=RuleUtils;var _$artifacts_116={};function ___typeof_116(t){return(___typeof_116=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$artifacts_116,"__esModule",{value:!0}),_$artifacts_116.default=function(t){___app_116.default.read(_$constants_86.ARTIFACTS_KEY)||___app_116.default.write({},_$constants_86.ARTIFACTS_KEY),t.get("/api/artifacts/restore",restoreArtifacts),t.route("/api/artifacts").get(getAllArtifacts).post(createArtifact).put(replaceArtifact),t.route("/api/artifact/:name").get(getArtifact).patch(updateArtifact).delete(deleteArtifact)},_$artifacts_116.syncToGist=syncToGist;var ___app_116=___interopRequireDefault_116(_$app_87),___gist_116=___interopRequireDefault_116(_$gist_139);function ___interopRequireDefault_116(t){return t&&t.__esModule?t:{default:t}}function ___regeneratorRuntime_116(){___regeneratorRuntime_116=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=typeof Symbol=="function"?Symbol:{},o=r.iterator||"@@iterator",f=r.asyncIterator||"@@asyncIterator",d=r.toStringTag||"@@toStringTag";function h(l,s,v){return Object.defineProperty(l,s,{value:v,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,v,$){return s[v]=$}}function y(l,s,v,$){var E=s&&s.prototype instanceof T?s:T,rt=Object.create(E.prototype),gt=new dt($||[]);return rt._invoke=function(Et,Ct,x){var N="suspendedStart";return function(G,A){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(G==="throw")throw A;return{value:void 0,done:!0}}for(x.method=G,x.arg=A;;){var C=x.delegate;if(C){var j=et(C,x);if(j){if(j===S)continue;return j}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var K=F(Et,Ct,x);if(K.type==="normal"){if(N=x.done?"completed":"suspendedYield",K.arg===S)continue;return{value:K.arg,done:x.done}}K.type==="throw"&&(N="completed",x.method="throw",x.arg=K.arg)}}}(l,v,gt),rt}function F(l,s,v){try{return{type:"normal",arg:l.call(s,v)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var S={};function T(){}function U(){}function M(){}var Y={};h(Y,o,function(){return this});var Z=Object.getPrototypeOf,D=Z&&Z(Z(ht([])));D&&D!==e&&n.call(D,o)&&(Y=D);var nt=M.prototype=T.prototype=Object.create(Y);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(v){return this._invoke(s,v)})})}function at(l,s){var v;this._invoke=function($,E){function rt(){return new s(function(gt,Et){(function Ct(x,N,G,A){var C=F(l[x],l,N);if(C.type!=="throw"){var j=C.arg,K=j.value;return K&&___typeof_116(K)=="object"&&n.call(K,"__await")?s.resolve(K.__await).then(function(J){Ct("next",J,G,A)},function(J){Ct("throw",J,G,A)}):s.resolve(K).then(function(J){j.value=J,G(j)},function(J){return Ct("throw",J,G,A)})}A(C.arg)})($,E,gt,Et)})}return v=v?v.then(rt,rt):rt()}}function et(l,s){var v=l.iterator[s.method];if(v===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,et(l,s),s.method==="throw"))return S;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var $=F(v,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,S;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,S):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,S)}function mt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function At(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function dt(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(mt,this),this.reset(!0)}function ht(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var v=-1,$=function E(){for(;++v<l.length;)if(n.call(l,v))return E.value=l[v],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:xt}}function xt(){return{value:void 0,done:!0}}return U.prototype=M,h(nt,"constructor",M),h(M,"constructor",U),U.displayName=h(M,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===U||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,M):(l.__proto__=M,h(l,d,"GeneratorFunction")),l.prototype=Object.create(nt),l},t.awrap=function(l){return{__await:l}},ct(at.prototype),h(at.prototype,f,function(){return this}),t.AsyncIterator=at,t.async=function(l,s,v,$,E){E===void 0&&(E=Promise);var rt=new at(y(l,s,v,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(gt){return gt.done?gt.value:rt.next()})},ct(nt),h(nt,d,"Generator"),h(nt,o,function(){return this}),h(nt,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var v in l)s.push(v);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=ht,dt.prototype={constructor:dt,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(At),!l)for(var s in this)s.charAt(0)==="t"&&n.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function v(Ct,x){return rt.type="throw",rt.arg=l,s.next=Ct,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return v("end");if(E.tryLoc<=this.prev){var gt=n.call(E,"catchLoc"),Et=n.call(E,"finallyLoc");if(gt&&Et){if(this.prev<E.catchLoc)return v(E.catchLoc,!0);if(this.prev<E.finallyLoc)return v(E.finallyLoc)}else if(gt){if(this.prev<E.catchLoc)return v(E.catchLoc,!0)}else{if(!Et)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return v(E.finallyLoc)}}}},abrupt:function(l,s){for(var v=this.tryEntries.length-1;v>=0;--v){var $=this.tryEntries[v];if($.tryLoc<=this.prev&&n.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,S):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),S},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.finallyLoc===l)return this.complete(v.completion,v.afterLoc),At(v),S}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.tryLoc===l){var $=v.completion;if($.type==="throw"){var E=$.arg;At(v)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,v){return this.delegate={iterator:ht(l),resultName:s,nextLoc:v},this.method==="next"&&(this.arg=void 0),S}},t}function __ownKeys_116(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function ___objectSpread_116(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_116(Object(n),!0).forEach(function(r){___defineProperty_116(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):__ownKeys_116(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ___defineProperty_116(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function __asyncGeneratorStep_116(t,e,n,r,o,f,d){try{var h=t[f](d),y=h.value}catch(F){return void n(F)}h.done?e(y):Promise.resolve(y).then(r,o)}function ___asyncToGenerator_116(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var f=t.apply(e,n);function d(y){__asyncGeneratorStep_116(f,r,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_116(f,r,o,d,h,"throw",y)}d(void 0)})}}function restoreArtifacts(t,e){return _restoreArtifacts.apply(this,arguments)}function _restoreArtifacts(){return(_restoreArtifacts=___asyncToGenerator_116(___regeneratorRuntime_116().mark(function t(e,n){var r,o,f,d,h,y,F,S,T,U;return ___regeneratorRuntime_116().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(___app_116.default.info("\u5F00\u59CB\u6062\u590D\u8FDC\u7A0B\u914D\u7F6E..."),M.prev=1,r=___app_116.default.read(_$constants_86.SETTINGS_KEY),o=r.gistToken,f=r.syncPlatform,o){M.next=5;break}return M.abrupt("return",Promise.reject("\u672A\u8BBE\u7F6E GitHub Token\uFF01"));case 5:return d=new ___gist_116.default({token:o,key:_$constants_86.ARTIFACT_REPOSITORY_KEY,syncPlatform:f}),M.prev=6,M.next=9,d.locate();case 9:if((h=M.sent)!=null&&h.files){M.next=12;break}throw new Error("\u627E\u4E0D\u5230 Sub-Store Gist \u6587\u4EF6\u5217\u8868");case 12:y=___app_116.default.read(_$constants_86.ARTIFACTS_KEY),F=[],Object.keys(h.files).map(function(Y){var Z,D=(Z=h.files[Y])===null||Z===void 0?void 0:Z.filename;if(D)if(encodeURIComponent(D)!==D)___app_116.default.error("\u6587\u4EF6\u540D ".concat(D," \u672A\u7F16\u7801 \u4E0D\u4FDD\u5B58")),F.push(D);else{var nt,ct,at=(0,_$database_133.findByName)(y,D);at?(0,_$database_133.updateByName)(y,D,___objectSpread_116(___objectSpread_116({},at),{},{url:(nt=h.files[Y])===null||nt===void 0?void 0:nt.raw_url.replace(/\/raw\/[^/]*\/(.*)/,"/raw/$1")})):y.push({name:"".concat(D),url:(ct=h.files[Y])===null||ct===void 0?void 0:ct.raw_url.replace(/\/raw\/[^/]*\/(.*)/,"/raw/$1")})}}),___app_116.default.write(y,_$constants_86.ARTIFACTS_KEY),M.next=22;break;case 18:throw M.prev=18,M.t0=M.catch(6),___app_116.default.error("\u67E5\u627E Sub-Store Gist \u65F6\u53D1\u751F\u9519\u8BEF: ".concat((S=M.t0.message)!==null&&S!==void 0?S:M.t0)),M.t0;case 22:(0,_$response_127.success)(n),M.next=29;break;case 25:M.prev=25,M.t1=M.catch(1),___app_116.default.error("\u6062\u590D\u8FDC\u7A0B\u914D\u7F6E\u5931\u8D25\uFF0C\u539F\u56E0\uFF1A".concat((T=M.t1.message)!==null&&T!==void 0?T:M.t1)),(0,_$response_127.failed)(n,new _$errors_119.InternalServerError("FAILED_TO_RESTORE_ARTIFACTS","Failed to restore artifacts","Reason: ".concat((U=M.t1.message)!==null&&U!==void 0?U:M.t1)));case 29:case"end":return M.stop()}},t,null,[[1,25],[6,18]])}))).apply(this,arguments)}function getAllArtifacts(t,e){var n=___app_116.default.read(_$constants_86.ARTIFACTS_KEY);(0,_$response_127.success)(e,n)}function replaceArtifact(t,e){var n=t.body;___app_116.default.write(n,_$constants_86.ARTIFACTS_KEY),(0,_$response_127.success)(e)}function getArtifact(t,e){return _getArtifact.apply(this,arguments)}function _getArtifact(){return(_getArtifact=___asyncToGenerator_116(___regeneratorRuntime_116().mark(function t(e,n){var r,o,f;return ___regeneratorRuntime_116().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:r=e.params.name,r=decodeURIComponent(r),o=___app_116.default.read(_$constants_86.ARTIFACTS_KEY),(f=(0,_$database_133.findByName)(o,r))?(0,_$response_127.success)(n,f):(0,_$response_127.failed)(n,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","Artifact ".concat(r," does not exist!")),404);case 5:case"end":return d.stop()}},t)}))).apply(this,arguments)}function createArtifact(t,e){var n=t.body;if(validateArtifactName(n.name)){___app_116.default.info("\u6B63\u5728\u521B\u5EFA\u8FDC\u7A0B\u914D\u7F6E\uFF1A".concat(n.name));var r=___app_116.default.read(_$constants_86.ARTIFACTS_KEY);(0,_$database_133.findByName)(r,n.name)?(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("DUPLICATE_KEY","Artifact ".concat(n.name," already exists."))):(r.push(n),___app_116.default.write(r,_$constants_86.ARTIFACTS_KEY),(0,_$response_127.success)(e,n,201))}else(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("INVALID_ARTIFACT_NAME","Artifact name ".concat(n.name," is invalid.")))}function updateArtifact(t,e){var n=___app_116.default.read(_$constants_86.ARTIFACTS_KEY),r=t.params.name;r=decodeURIComponent(r);var o=(0,_$database_133.findByName)(n,r);if(o){___app_116.default.info("\u6B63\u5728\u66F4\u65B0\u8FDC\u7A0B\u914D\u7F6E\uFF1A".concat(o.name));var f=___objectSpread_116(___objectSpread_116({},o),t.body);if(!validateArtifactName(f.name))return void(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("INVALID_ARTIFACT_NAME","Artifact name ".concat(f.name," is invalid.")));(0,_$database_133.updateByName)(n,r,f),___app_116.default.write(n,_$constants_86.ARTIFACTS_KEY),(0,_$response_127.success)(e,f)}else(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("DUPLICATE_KEY","Artifact ".concat(r," already exists.")))}function deleteArtifact(t,e){return _deleteArtifact.apply(this,arguments)}function _deleteArtifact(){return(_deleteArtifact=___asyncToGenerator_116(___regeneratorRuntime_116().mark(function t(e,n){var r,o,f,d;return ___regeneratorRuntime_116().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(r=e.params.name,r=decodeURIComponent(r),___app_116.default.info("\u6B63\u5728\u5220\u9664\u8FDC\u7A0B\u914D\u7F6E\uFF1A".concat(r)),o=___app_116.default.read(_$constants_86.ARTIFACTS_KEY),h.prev=4,f=(0,_$database_133.findByName)(o,r)){h.next=8;break}throw new Error("\u8FDC\u7A0B\u914D\u7F6E\uFF1A".concat(r,"\u4E0D\u5B58\u5728\uFF01"));case 8:if(!f.updated){h.next=20;break}return(d={})[encodeURIComponent(f.name)]={content:""},encodeURIComponent(f.name)!==f.name&&(d[f.name]={content:""}),h.prev=12,h.next=15,syncToGist(d);case 15:h.next=20;break;case 17:h.prev=17,h.t0=h.catch(12),___app_116.default.error("Function syncToGist: ".concat(r," : ").concat(h.t0));case 20:(0,_$database_133.deleteByName)(o,r),___app_116.default.write(o,_$constants_86.ARTIFACTS_KEY),(0,_$response_127.success)(n),h.next=29;break;case 25:h.prev=25,h.t1=h.catch(4),___app_116.default.error("\u65E0\u6CD5\u5220\u9664\u8FDC\u7A0B\u914D\u7F6E\uFF1A".concat(r,"\uFF0C\u539F\u56E0\uFF1A").concat(h.t1)),(0,_$response_127.failed)(n,new _$errors_119.InternalServerError("FAILED_TO_DELETE_ARTIFACT","Failed to delete artifact ".concat(r),"Reason: ".concat(h.t1)));case 29:case"end":return h.stop()}},t,null,[[4,25],[12,17]])}))).apply(this,arguments)}function validateArtifactName(t){return/^[a-zA-Z0-9._-]*$/.test(t)}function syncToGist(t){return _syncToGist.apply(this,arguments)}function _syncToGist(){return(_syncToGist=___asyncToGenerator_116(___regeneratorRuntime_116().mark(function t(e){var n,r,o,f,d,h,y,F,S,T,U;return ___regeneratorRuntime_116().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(f=___app_116.default.read(_$constants_86.SETTINGS_KEY),d=f.gistToken,h=f.syncPlatform,d){M.next=3;break}return M.abrupt("return",Promise.reject("\u672A\u8BBE\u7F6E GitHub Token\uFF01"));case 3:return y=new ___gist_116.default({token:d,key:_$constants_86.ARTIFACT_REPOSITORY_KEY,syncPlatform:h}),M.next=6,y.upload(e);case 6:F=M.sent,S={};try{S=JSON.parse(F.body)}catch{}return T=(n=(r=S)===null||r===void 0?void 0:r.html_url)!==null&&n!==void 0?n:(o=S)===null||o===void 0?void 0:o.web_url,U=___app_116.default.read(_$constants_86.SETTINGS_KEY),T?(___app_116.default.log("\u540C\u6B65 Gist \u540E, \u627E\u5230 Sub-Store Gist: ".concat(T)),U.artifactStore=T,U.artifactStoreStatus="VALID"):(___app_116.default.error("\u540C\u6B65 Gist \u540E, \u627E\u4E0D\u5230 Sub-Store Gist"),U.artifactStoreStatus="NOT FOUND"),___app_116.default.write(U,_$constants_86.SETTINGS_KEY),M.abrupt("return",F);case 14:case"end":return M.stop()}},t)}))).apply(this,arguments)}var _$settings_128={};Object.defineProperty(_$settings_128,"__esModule",{value:!0}),_$settings_128.default=function(t){___app_128.default.read(_$constants_86.SETTINGS_KEY)||___app_128.default.write({},_$constants_86.SETTINGS_KEY),t.route("/api/settings").get(getSettings).patch(updateSettings)},_$settings_128.updateArtifactStore=updateArtifactStore,_$settings_128.updateAvatar=updateAvatar;var ___app_128=___interopRequireDefault_128(_$app_87),___gist_128=___interopRequireDefault_128(_$gist_139);function ___interopRequireDefault_128(t){return t&&t.__esModule?t:{default:t}}function ___typeof_128(t){return(___typeof_128=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function __ownKeys_128(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function ___objectSpread_128(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_128(Object(n),!0).forEach(function(r){___defineProperty_128(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):__ownKeys_128(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ___defineProperty_128(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ___regeneratorRuntime_128(){___regeneratorRuntime_128=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=typeof Symbol=="function"?Symbol:{},o=r.iterator||"@@iterator",f=r.asyncIterator||"@@asyncIterator",d=r.toStringTag||"@@toStringTag";function h(l,s,v){return Object.defineProperty(l,s,{value:v,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,v,$){return s[v]=$}}function y(l,s,v,$){var E=s&&s.prototype instanceof T?s:T,rt=Object.create(E.prototype),gt=new dt($||[]);return rt._invoke=function(Et,Ct,x){var N="suspendedStart";return function(G,A){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(G==="throw")throw A;return{value:void 0,done:!0}}for(x.method=G,x.arg=A;;){var C=x.delegate;if(C){var j=et(C,x);if(j){if(j===S)continue;return j}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var K=F(Et,Ct,x);if(K.type==="normal"){if(N=x.done?"completed":"suspendedYield",K.arg===S)continue;return{value:K.arg,done:x.done}}K.type==="throw"&&(N="completed",x.method="throw",x.arg=K.arg)}}}(l,v,gt),rt}function F(l,s,v){try{return{type:"normal",arg:l.call(s,v)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var S={};function T(){}function U(){}function M(){}var Y={};h(Y,o,function(){return this});var Z=Object.getPrototypeOf,D=Z&&Z(Z(ht([])));D&&D!==e&&n.call(D,o)&&(Y=D);var nt=M.prototype=T.prototype=Object.create(Y);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(v){return this._invoke(s,v)})})}function at(l,s){var v;this._invoke=function($,E){function rt(){return new s(function(gt,Et){(function Ct(x,N,G,A){var C=F(l[x],l,N);if(C.type!=="throw"){var j=C.arg,K=j.value;return K&&___typeof_128(K)=="object"&&n.call(K,"__await")?s.resolve(K.__await).then(function(J){Ct("next",J,G,A)},function(J){Ct("throw",J,G,A)}):s.resolve(K).then(function(J){j.value=J,G(j)},function(J){return Ct("throw",J,G,A)})}A(C.arg)})($,E,gt,Et)})}return v=v?v.then(rt,rt):rt()}}function et(l,s){var v=l.iterator[s.method];if(v===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,et(l,s),s.method==="throw"))return S;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var $=F(v,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,S;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,S):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,S)}function mt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function At(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function dt(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(mt,this),this.reset(!0)}function ht(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var v=-1,$=function E(){for(;++v<l.length;)if(n.call(l,v))return E.value=l[v],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:xt}}function xt(){return{value:void 0,done:!0}}return U.prototype=M,h(nt,"constructor",M),h(M,"constructor",U),U.displayName=h(M,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===U||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,M):(l.__proto__=M,h(l,d,"GeneratorFunction")),l.prototype=Object.create(nt),l},t.awrap=function(l){return{__await:l}},ct(at.prototype),h(at.prototype,f,function(){return this}),t.AsyncIterator=at,t.async=function(l,s,v,$,E){E===void 0&&(E=Promise);var rt=new at(y(l,s,v,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(gt){return gt.done?gt.value:rt.next()})},ct(nt),h(nt,d,"Generator"),h(nt,o,function(){return this}),h(nt,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var v in l)s.push(v);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=ht,dt.prototype={constructor:dt,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(At),!l)for(var s in this)s.charAt(0)==="t"&&n.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function v(Ct,x){return rt.type="throw",rt.arg=l,s.next=Ct,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return v("end");if(E.tryLoc<=this.prev){var gt=n.call(E,"catchLoc"),Et=n.call(E,"finallyLoc");if(gt&&Et){if(this.prev<E.catchLoc)return v(E.catchLoc,!0);if(this.prev<E.finallyLoc)return v(E.finallyLoc)}else if(gt){if(this.prev<E.catchLoc)return v(E.catchLoc,!0)}else{if(!Et)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return v(E.finallyLoc)}}}},abrupt:function(l,s){for(var v=this.tryEntries.length-1;v>=0;--v){var $=this.tryEntries[v];if($.tryLoc<=this.prev&&n.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,S):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),S},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.finallyLoc===l)return this.complete(v.completion,v.afterLoc),At(v),S}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.tryLoc===l){var $=v.completion;if($.type==="throw"){var E=$.arg;At(v)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,v){return this.delegate={iterator:ht(l),resultName:s,nextLoc:v},this.method==="next"&&(this.arg=void 0),S}},t}function __asyncGeneratorStep_128(t,e,n,r,o,f,d){try{var h=t[f](d),y=h.value}catch(F){return void n(F)}h.done?e(y):Promise.resolve(y).then(r,o)}function ___asyncToGenerator_128(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var f=t.apply(e,n);function d(y){__asyncGeneratorStep_128(f,r,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_128(f,r,o,d,h,"throw",y)}d(void 0)})}}function getSettings(t,e){return _getSettings.apply(this,arguments)}function _getSettings(){return(_getSettings=___asyncToGenerator_128(___regeneratorRuntime_128().mark(function t(e,n){var r,o,f;return ___regeneratorRuntime_128().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(d.prev=0,(r=___app_128.default.read(_$constants_86.SETTINGS_KEY))||(r={},___app_128.default.write(r,_$constants_86.SETTINGS_KEY)),r.avatarUrl){d.next=6;break}return d.next=6,updateAvatar();case 6:if(r.artifactStore){d.next=9;break}return d.next=9,updateArtifactStore();case 9:(0,_$response_127.success)(n,r),d.next=16;break;case 12:d.prev=12,d.t0=d.catch(0),___app_128.default.error("Failed to get settings: ".concat((o=d.t0.message)!==null&&o!==void 0?o:d.t0)),(0,_$response_127.failed)(n,new _$errors_119.InternalServerError("FAILED_TO_GET_SETTINGS","Failed to get settings","Reason: ".concat((f=d.t0.message)!==null&&f!==void 0?f:d.t0)));case 16:case"end":return d.stop()}},t,null,[[0,12]])}))).apply(this,arguments)}function updateSettings(t,e){return _updateSettings.apply(this,arguments)}function _updateSettings(){return(_updateSettings=___asyncToGenerator_128(___regeneratorRuntime_128().mark(function t(e,n){var r,o,f,d;return ___regeneratorRuntime_128().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.prev=0,r=___app_128.default.read(_$constants_86.SETTINGS_KEY),o=___objectSpread_128(___objectSpread_128({},r),e.body),___app_128.default.write(o,_$constants_86.SETTINGS_KEY),h.next=6,updateAvatar();case 6:return h.next=8,updateArtifactStore();case 8:(0,_$response_127.success)(n,o),h.next=15;break;case 11:h.prev=11,h.t0=h.catch(0),___app_128.default.error("Failed to update settings: ".concat((f=h.t0.message)!==null&&f!==void 0?f:h.t0)),(0,_$response_127.failed)(n,new _$errors_119.InternalServerError("FAILED_TO_UPDATE_SETTINGS","Failed to update settings","Reason: ".concat((d=h.t0.message)!==null&&d!==void 0?d:h.t0)));case 15:case"end":return h.stop()}},t,null,[[0,11]])}))).apply(this,arguments)}function updateAvatar(){return _updateAvatar.apply(this,arguments)}function _updateAvatar(){return(_updateAvatar=___asyncToGenerator_128(___regeneratorRuntime_128().mark(function t(){var e,n,r,o,f,d,h;return ___regeneratorRuntime_128().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(e=___app_128.default.read(_$constants_86.SETTINGS_KEY),n=e.githubUser,r=e.syncPlatform,!n){y.next=28;break}if(r!=="gitlab"){y.next=17;break}return y.prev=4,y.next=7,___app_128.default.http.get({url:"https://gitlab.com/api/v4/users?username=".concat(encodeURIComponent(n)),headers:{"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.141 Safari/537.36"}}).then(function(F){return JSON.parse(F.body)});case 7:o=y.sent,e.avatarUrl=o[0].avatar_url.replace(/(\?|&)s=\d+(&|$)/,"$1s=160$2"),___app_128.default.write(e,_$constants_86.SETTINGS_KEY),y.next=15;break;case 12:y.prev=12,y.t0=y.catch(4),___app_128.default.error("Failed to fetch GitLab avatar for User: ".concat(n,". Reason: ").concat((f=y.t0.message)!==null&&f!==void 0?f:y.t0));case 15:y.next=28;break;case 17:return y.prev=17,y.next=20,___app_128.default.http.get({url:"https://api.github.com/users/".concat(encodeURIComponent(n)),headers:{"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.141 Safari/537.36"}}).then(function(F){return JSON.parse(F.body)});case 20:d=y.sent,e.avatarUrl=d.avatar_url,___app_128.default.write(e,_$constants_86.SETTINGS_KEY),y.next=28;break;case 25:y.prev=25,y.t1=y.catch(17),___app_128.default.error("Failed to fetch GitHub avatar for User: ".concat(n,". Reason: ").concat((h=y.t1.message)!==null&&h!==void 0?h:y.t1));case 28:case"end":return y.stop()}},t,null,[[4,12],[17,25]])}))).apply(this,arguments)}function updateArtifactStore(){return _updateArtifactStore.apply(this,arguments)}function _updateArtifactStore(){return(_updateArtifactStore=___asyncToGenerator_128(___regeneratorRuntime_128().mark(function t(){var e,n,r,o,f,d,h,y;return ___regeneratorRuntime_128().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(___app_128.default.log("Updating artifact store"),e=___app_128.default.read(_$constants_86.SETTINGS_KEY),n=e.gistToken,r=e.syncPlatform,!n){F.next=18;break}return o=new ___gist_128.default({token:n,key:_$constants_86.ARTIFACT_REPOSITORY_KEY,syncPlatform:r}),F.prev=5,F.next=8,o.locate();case 8:d=F.sent,(h=(f=d?.html_url)!==null&&f!==void 0?f:d?.web_url)?(___app_128.default.log("\u627E\u5230 Sub-Store Gist: ".concat(h)),e.artifactStore=h,e.artifactStoreStatus="VALID"):(___app_128.default.error("\u627E\u4E0D\u5230 Sub-Store Gist"),e.artifactStoreStatus="NOT FOUND"),F.next=17;break;case 13:F.prev=13,F.t0=F.catch(5),___app_128.default.error("\u67E5\u627E Sub-Store Gist \u65F6\u53D1\u751F\u9519\u8BEF: ".concat((y=F.t0.message)!==null&&y!==void 0?y:F.t0)),e.artifactStoreStatus="ERROR";case 17:___app_128.default.write(e,_$constants_86.SETTINGS_KEY);case 18:case"end":return F.stop()}},t,null,[[5,13]])}))).apply(this,arguments)}var _$miscs_122={};function ___typeof_122(t){return(___typeof_122=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$miscs_122,"__esModule",{value:!0}),_$miscs_122.default=function(t){var e,n;t.get("/api/utils/env",getEnv),t.get("/api/utils/backup",gistBackup),t.get("/api/utils/refresh",refresh),t.route("/api/storage").get(function(r,o){o.set("content-type","application/json").set("content-disposition",'attachment; filename="sub-store.json"').send(___app_122.default.env.isNode?JSON.stringify(___app_122.default.cache):___app_122.default.read("#sub-store"))}).post(function(r,o){var f=r.body.content;___app_122.default.write(f,"#sub-store"),___app_122.default.env.isNode&&(___app_122.default.cache=JSON.parse(f),___app_122.default.persistCache()),(0,_migration.default)(),(0,_$response_127.success)(o)}),t.get("/",(n=___asyncToGenerator_122(___regeneratorRuntime_122().mark(function r(o,f){return ___regeneratorRuntime_122().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:f.set("location","https://sub-store.vercel.app/").status(302).end();case 1:case"end":return d.stop()}},r)})),function(r,o){return n.apply(this,arguments)})),(0,_$openApi_151.ENV)().isQX&&t.options("/",(e=___asyncToGenerator_122(___regeneratorRuntime_122().mark(function r(o,f){return ___regeneratorRuntime_122().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:f.status(200).end();case 1:case"end":return d.stop()}},r)})),function(r,o){return e.apply(this,arguments)})),t.all("/",function(r,o){o.send("Hello from sub-store, made with \u2764\uFE0F by Peng-YM")})},_$miscs_122.gistBackupAction=gistBackupAction;var ___app_122=___interopRequireDefault_122(_$app_87),___resourceCache_122=___interopRequireDefault_122(_$resourceCache_144),___scriptResourceCache_122=___interopRequireDefault_122(_$scriptResourceCache_146),___headersResourceCache_122=___interopRequireDefault_122(_$headersResourceCache_140),___gist_122=___interopRequireDefault_122(_$gist_139),_migration=___interopRequireDefault_122(_$migration_143),___env_122=___interopRequireDefault_122(_$env_136);function ___interopRequireDefault_122(t){return t&&t.__esModule?t:{default:t}}function ___regeneratorRuntime_122(){___regeneratorRuntime_122=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=typeof Symbol=="function"?Symbol:{},o=r.iterator||"@@iterator",f=r.asyncIterator||"@@asyncIterator",d=r.toStringTag||"@@toStringTag";function h(l,s,v){return Object.defineProperty(l,s,{value:v,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,v,$){return s[v]=$}}function y(l,s,v,$){var E=s&&s.prototype instanceof T?s:T,rt=Object.create(E.prototype),gt=new dt($||[]);return rt._invoke=function(Et,Ct,x){var N="suspendedStart";return function(G,A){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(G==="throw")throw A;return{value:void 0,done:!0}}for(x.method=G,x.arg=A;;){var C=x.delegate;if(C){var j=et(C,x);if(j){if(j===S)continue;return j}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var K=F(Et,Ct,x);if(K.type==="normal"){if(N=x.done?"completed":"suspendedYield",K.arg===S)continue;return{value:K.arg,done:x.done}}K.type==="throw"&&(N="completed",x.method="throw",x.arg=K.arg)}}}(l,v,gt),rt}function F(l,s,v){try{return{type:"normal",arg:l.call(s,v)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var S={};function T(){}function U(){}function M(){}var Y={};h(Y,o,function(){return this});var Z=Object.getPrototypeOf,D=Z&&Z(Z(ht([])));D&&D!==e&&n.call(D,o)&&(Y=D);var nt=M.prototype=T.prototype=Object.create(Y);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(v){return this._invoke(s,v)})})}function at(l,s){var v;this._invoke=function($,E){function rt(){return new s(function(gt,Et){(function Ct(x,N,G,A){var C=F(l[x],l,N);if(C.type!=="throw"){var j=C.arg,K=j.value;return K&&___typeof_122(K)=="object"&&n.call(K,"__await")?s.resolve(K.__await).then(function(J){Ct("next",J,G,A)},function(J){Ct("throw",J,G,A)}):s.resolve(K).then(function(J){j.value=J,G(j)},function(J){return Ct("throw",J,G,A)})}A(C.arg)})($,E,gt,Et)})}return v=v?v.then(rt,rt):rt()}}function et(l,s){var v=l.iterator[s.method];if(v===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,et(l,s),s.method==="throw"))return S;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var $=F(v,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,S;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,S):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,S)}function mt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function At(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function dt(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(mt,this),this.reset(!0)}function ht(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var v=-1,$=function E(){for(;++v<l.length;)if(n.call(l,v))return E.value=l[v],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:xt}}function xt(){return{value:void 0,done:!0}}return U.prototype=M,h(nt,"constructor",M),h(M,"constructor",U),U.displayName=h(M,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===U||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,M):(l.__proto__=M,h(l,d,"GeneratorFunction")),l.prototype=Object.create(nt),l},t.awrap=function(l){return{__await:l}},ct(at.prototype),h(at.prototype,f,function(){return this}),t.AsyncIterator=at,t.async=function(l,s,v,$,E){E===void 0&&(E=Promise);var rt=new at(y(l,s,v,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(gt){return gt.done?gt.value:rt.next()})},ct(nt),h(nt,d,"Generator"),h(nt,o,function(){return this}),h(nt,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var v in l)s.push(v);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=ht,dt.prototype={constructor:dt,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(At),!l)for(var s in this)s.charAt(0)==="t"&&n.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function v(Ct,x){return rt.type="throw",rt.arg=l,s.next=Ct,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return v("end");if(E.tryLoc<=this.prev){var gt=n.call(E,"catchLoc"),Et=n.call(E,"finallyLoc");if(gt&&Et){if(this.prev<E.catchLoc)return v(E.catchLoc,!0);if(this.prev<E.finallyLoc)return v(E.finallyLoc)}else if(gt){if(this.prev<E.catchLoc)return v(E.catchLoc,!0)}else{if(!Et)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return v(E.finallyLoc)}}}},abrupt:function(l,s){for(var v=this.tryEntries.length-1;v>=0;--v){var $=this.tryEntries[v];if($.tryLoc<=this.prev&&n.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,S):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),S},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.finallyLoc===l)return this.complete(v.completion,v.afterLoc),At(v),S}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.tryLoc===l){var $=v.completion;if($.type==="throw"){var E=$.arg;At(v)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,v){return this.delegate={iterator:ht(l),resultName:s,nextLoc:v},this.method==="next"&&(this.arg=void 0),S}},t}function __asyncGeneratorStep_122(t,e,n,r,o,f,d){try{var h=t[f](d),y=h.value}catch(F){return void n(F)}h.done?e(y):Promise.resolve(y).then(r,o)}function ___asyncToGenerator_122(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var f=t.apply(e,n);function d(y){__asyncGeneratorStep_122(f,r,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_122(f,r,o,d,h,"throw",y)}d(void 0)})}}function getEnv(t,e){t.query.share&&(___env_122.default.feature.share=!0),(0,_$response_127.success)(e,___env_122.default)}function refresh(t,e){return _refresh.apply(this,arguments)}function _refresh(){return(_refresh=___asyncToGenerator_122(___regeneratorRuntime_122().mark(function t(e,n){return ___regeneratorRuntime_122().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,_$settings_128.updateAvatar)();case 2:return r.next=4,(0,_$settings_128.updateArtifactStore)();case 4:___resourceCache_122.default.revokeAll(),___scriptResourceCache_122.default.revokeAll(),___headersResourceCache_122.default.revokeAll(),(0,_$response_127.success)(n);case 8:case"end":return r.stop()}},t)}))).apply(this,arguments)}function gistBackupAction(t){return _gistBackupAction.apply(this,arguments)}function _gistBackupAction(){return(_gistBackupAction=___asyncToGenerator_122(___regeneratorRuntime_122().mark(function t(e){var n,r,o,f,d,h,y,F;return ___regeneratorRuntime_122().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(n=___app_122.default.read(_$constants_86.SETTINGS_KEY),r=n.gistToken,o=n.syncPlatform,r){S.next=3;break}throw new Error("GitHub Token is required for backup!");case 3:f=new ___gist_122.default({token:r,key:_$constants_86.GIST_BACKUP_KEY,syncPlatform:o}),h=___app_122.default.read(_$constants_86.SETTINGS_KEY),y=h.syncTime,S.t0=e,S.next=S.t0==="upload"?9:S.t0==="download"?26:46;break;case 9:return h.syncTime=new Date().getTime(),___app_122.default.write(h,_$constants_86.SETTINGS_KEY),d=___app_122.default.read("#sub-store"),___app_122.default.env.isNode&&(d=JSON.stringify(___app_122.default.cache,null,"  ")),___app_122.default.info("\u4E0A\u4F20\u5907\u4EFD\u4E2D..."),S.prev=14,S.next=17,f.upload((T={},U=_$constants_86.GIST_BACKUP_FILE_NAME,M={content:d},U in T?Object.defineProperty(T,U,{value:M,enumerable:!0,configurable:!0,writable:!0}):T[U]=M,T));case 17:___app_122.default.info("\u4E0A\u4F20\u5907\u4EFD\u5B8C\u6210"),S.next=25;break;case 20:throw S.prev=20,S.t1=S.catch(14),h.syncTime=y,___app_122.default.write(h,_$constants_86.SETTINGS_KEY),S.t1;case 25:return S.abrupt("break",46);case 26:return ___app_122.default.info("\u8FD8\u539F\u5907\u4EFD\u4E2D..."),S.next=29,f.download(_$constants_86.GIST_BACKUP_FILE_NAME);case 29:if(d=S.sent,S.prev=30,Object.keys(JSON.parse(d).settings).length!==0){S.next=33;break}throw new Error("\u5907\u4EFD\u6587\u4EF6\u5E94\u8BE5\u81F3\u5C11\u5305\u542B settings \u5B57\u6BB5");case 33:S.next=39;break;case 35:throw S.prev=35,S.t2=S.catch(30),___app_122.default.error(`Gist \u5907\u4EFD\u6587\u4EF6\u6821\u9A8C\u5931\u8D25, \u65E0\u6CD5\u8FD8\u539F
Reason: `.concat((F=S.t2.message)!==null&&F!==void 0?F:S.t2)),new Error("Gist \u5907\u4EFD\u6587\u4EF6\u6821\u9A8C\u5931\u8D25, \u65E0\u6CD5\u8FD8\u539F");case 39:return ___app_122.default.write(d,"#sub-store"),___app_122.default.env.isNode&&(d=JSON.parse(d),___app_122.default.cache=d,___app_122.default.persistCache()),___app_122.default.info("perform migration after restoring from gist..."),(0,_migration.default)(),___app_122.default.info("migration completed"),___app_122.default.info("\u8FD8\u539F\u5907\u4EFD\u5B8C\u6210"),S.abrupt("break",46);case 46:case"end":return S.stop()}var T,U,M},t,null,[[14,20],[30,35]])}))).apply(this,arguments)}function gistBackup(t,e){return _gistBackup.apply(this,arguments)}function _gistBackup(){return(_gistBackup=___asyncToGenerator_122(___regeneratorRuntime_122().mark(function t(e,n){var r,o,f;return ___regeneratorRuntime_122().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(r=e.query.action,___app_122.default.read(_$constants_86.SETTINGS_KEY).gistToken){d.next=6;break}(0,_$response_127.failed)(n,new _$errors_119.RequestInvalidError("GIST_TOKEN_NOT_FOUND","GitHub Token is required for backup!")),d.next=16;break;case 6:return d.prev=6,d.next=9,gistBackupAction(r);case 9:(0,_$response_127.success)(n),d.next=16;break;case 12:d.prev=12,d.t0=d.catch(6),___app_122.default.error("Failed to ".concat(r,` gist data.
Reason: `).concat((o=d.t0.message)!==null&&o!==void 0?o:d.t0)),(0,_$response_127.failed)(n,new _$errors_119.InternalServerError("BACKUP_FAILED","Failed to ".concat(r," gist data!"),"Reason: ".concat((f=d.t0.message)!==null&&f!==void 0?f:d.t0)));case 16:case"end":return d.stop()}},t,null,[[6,12]])}))).apply(this,arguments)}var _$subscriptions_130={};function ___typeof_130(t){return(___typeof_130=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$subscriptions_130,"__esModule",{value:!0}),_$subscriptions_130.default=function(t){t.get("/api/sub/flow/:name",getFlowInfo),t.route("/api/sub/:name").get(getSubscription).patch(updateSubscription).delete(deleteSubscription),t.route("/api/subs").get(getAllSubscriptions).post(createSubscription).put(replaceSubscriptions)};var __obj_130,___app_130=(__obj_130=_$app_87)&&__obj_130.__esModule?__obj_130:{default:__obj_130};function ___regeneratorRuntime_130(){___regeneratorRuntime_130=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=typeof Symbol=="function"?Symbol:{},o=r.iterator||"@@iterator",f=r.asyncIterator||"@@asyncIterator",d=r.toStringTag||"@@toStringTag";function h(l,s,v){return Object.defineProperty(l,s,{value:v,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,v,$){return s[v]=$}}function y(l,s,v,$){var E=s&&s.prototype instanceof T?s:T,rt=Object.create(E.prototype),gt=new dt($||[]);return rt._invoke=function(Et,Ct,x){var N="suspendedStart";return function(G,A){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(G==="throw")throw A;return{value:void 0,done:!0}}for(x.method=G,x.arg=A;;){var C=x.delegate;if(C){var j=et(C,x);if(j){if(j===S)continue;return j}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var K=F(Et,Ct,x);if(K.type==="normal"){if(N=x.done?"completed":"suspendedYield",K.arg===S)continue;return{value:K.arg,done:x.done}}K.type==="throw"&&(N="completed",x.method="throw",x.arg=K.arg)}}}(l,v,gt),rt}function F(l,s,v){try{return{type:"normal",arg:l.call(s,v)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var S={};function T(){}function U(){}function M(){}var Y={};h(Y,o,function(){return this});var Z=Object.getPrototypeOf,D=Z&&Z(Z(ht([])));D&&D!==e&&n.call(D,o)&&(Y=D);var nt=M.prototype=T.prototype=Object.create(Y);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(v){return this._invoke(s,v)})})}function at(l,s){var v;this._invoke=function($,E){function rt(){return new s(function(gt,Et){(function Ct(x,N,G,A){var C=F(l[x],l,N);if(C.type!=="throw"){var j=C.arg,K=j.value;return K&&___typeof_130(K)=="object"&&n.call(K,"__await")?s.resolve(K.__await).then(function(J){Ct("next",J,G,A)},function(J){Ct("throw",J,G,A)}):s.resolve(K).then(function(J){j.value=J,G(j)},function(J){return Ct("throw",J,G,A)})}A(C.arg)})($,E,gt,Et)})}return v=v?v.then(rt,rt):rt()}}function et(l,s){var v=l.iterator[s.method];if(v===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,et(l,s),s.method==="throw"))return S;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var $=F(v,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,S;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,S):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,S)}function mt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function At(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function dt(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(mt,this),this.reset(!0)}function ht(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var v=-1,$=function E(){for(;++v<l.length;)if(n.call(l,v))return E.value=l[v],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:xt}}function xt(){return{value:void 0,done:!0}}return U.prototype=M,h(nt,"constructor",M),h(M,"constructor",U),U.displayName=h(M,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===U||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,M):(l.__proto__=M,h(l,d,"GeneratorFunction")),l.prototype=Object.create(nt),l},t.awrap=function(l){return{__await:l}},ct(at.prototype),h(at.prototype,f,function(){return this}),t.AsyncIterator=at,t.async=function(l,s,v,$,E){E===void 0&&(E=Promise);var rt=new at(y(l,s,v,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(gt){return gt.done?gt.value:rt.next()})},ct(nt),h(nt,d,"Generator"),h(nt,o,function(){return this}),h(nt,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var v in l)s.push(v);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=ht,dt.prototype={constructor:dt,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(At),!l)for(var s in this)s.charAt(0)==="t"&&n.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function v(Ct,x){return rt.type="throw",rt.arg=l,s.next=Ct,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return v("end");if(E.tryLoc<=this.prev){var gt=n.call(E,"catchLoc"),Et=n.call(E,"finallyLoc");if(gt&&Et){if(this.prev<E.catchLoc)return v(E.catchLoc,!0);if(this.prev<E.finallyLoc)return v(E.finallyLoc)}else if(gt){if(this.prev<E.catchLoc)return v(E.catchLoc,!0)}else{if(!Et)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return v(E.finallyLoc)}}}},abrupt:function(l,s){for(var v=this.tryEntries.length-1;v>=0;--v){var $=this.tryEntries[v];if($.tryLoc<=this.prev&&n.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,S):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),S},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.finallyLoc===l)return this.complete(v.completion,v.afterLoc),At(v),S}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.tryLoc===l){var $=v.completion;if($.type==="throw"){var E=$.arg;At(v)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,v){return this.delegate={iterator:ht(l),resultName:s,nextLoc:v},this.method==="next"&&(this.arg=void 0),S}},t}function ___createForOfIteratorHelper_130(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(y,F){if(y){if(typeof y=="string")return ___arrayLikeToArray_130(y,void 0);var S=Object.prototype.toString.call(y).slice(8,-1);return S==="Object"&&y.constructor&&(S=y.constructor.name),S==="Map"||S==="Set"?Array.from(y):S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S)?___arrayLikeToArray_130(y,void 0):void 0}}(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){n=n.call(t)},n:function(){var y=n.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||n.return==null||n.return()}finally{if(h)throw f}}}}function ___arrayLikeToArray_130(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function __ownKeys_130(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function ___objectSpread_130(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_130(Object(n),!0).forEach(function(r){___defineProperty_130(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):__ownKeys_130(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ___defineProperty_130(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function __asyncGeneratorStep_130(t,e,n,r,o,f,d){try{var h=t[f](d),y=h.value}catch(F){return void n(F)}h.done?e(y):Promise.resolve(y).then(r,o)}function getFlowInfo(t,e){return _getFlowInfo.apply(this,arguments)}function _getFlowInfo(){var t;return t=___regeneratorRuntime_130().mark(function e(n,r){var o,f,d,h,y,F,S,T,U,M,Y,Z,D,nt,ct,at,et,mt,At,dt;return ___regeneratorRuntime_130().wrap(function(ht){for(;;)switch(ht.prev=ht.next){case 0:if(o=n.params.name,o=decodeURIComponent(o),(f=n.query.url)&&(f=decodeURIComponent(f),___app_130.default.info("\u6307\u5B9A\u8FDC\u7A0B\u8BA2\u9605 URL: ".concat(f))),d=___app_130.default.read(_$constants_86.SUBS_KEY),h=(0,_$database_133.findByName)(d,o)){ht.next=9;break}return(0,_$response_127.failed)(r,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","Subscription ".concat(o," does not exist!")),404),ht.abrupt("return");case 9:if(h.source!=="local"||["localFirst","remoteFirst"].includes(h.mergeSources)){ht.next=29;break}if(!h.subUserinfo){ht.next=27;break}if(!/^https?:\/\//.test(h.subUserinfo)){ht.next=23;break}return ht.prev=12,ht.next=15,(0,_$flow_137.getFlowHeaders)(void 0,void 0,void 0,h.proxy,h.subUserinfo);case 15:y=ht.sent,ht.next=21;break;case 18:ht.prev=18,ht.t0=ht.catch(12),___app_130.default.error("\u8BA2\u9605 ".concat(o," \u4F7F\u7528\u81EA\u5B9A\u4E49\u6D41\u91CF\u94FE\u63A5 ").concat(h.subUserinfo," \u83B7\u53D6\u6D41\u91CF\u4FE1\u606F\u65F6\u53D1\u751F\u9519\u8BEF: ").concat(JSON.stringify(ht.t0)));case 21:ht.next=24;break;case 23:y=h.subUserinfo;case 24:try{(0,_$response_127.success)(r,___objectSpread_130({},(0,_$flow_137.parseFlowHeaders)(y)))}catch(xt){___app_130.default.error("Failed to parse flow info for local subscription ".concat(o,": ").concat((F=xt.message)!==null&&F!==void 0?F:xt)),(0,_$response_127.failed)(r,new _$errors_119.RequestInvalidError("NO_FLOW_INFO","N/A","Failed to parse flow info"))}ht.next=28;break;case 27:(0,_$response_127.failed)(r,new _$errors_119.RequestInvalidError("NO_FLOW_INFO","N/A","Local subscription ".concat(o," has no flow information!")));case 28:return ht.abrupt("return");case 29:if(ht.prev=29,f=((S="".concat(f||h.url).split(/[\r\n]+/).map(function(xt){return xt.trim()}).filter(function(xt){return xt.length}))===null||S===void 0?void 0:S[0])||"",U={},M=f.split("#"),f=f.split("#")[0],M.length>1)try{U=JSON.parse(decodeURIComponent(M[1]))}catch{Y=___createForOfIteratorHelper_130(M[1].split("&"));try{for(Y.s();!(Z=Y.n()).done;)D=Z.value,nt=D.split("=")[0],ct=D.split("=")[1],U[nt]=ct==null||ct===""||decodeURIComponent(ct)}catch(l){Y.e(l)}finally{Y.f()}}if(!U.noFlow){ht.next=38;break}return(0,_$response_127.failed)(r,new _$errors_119.RequestInvalidError("NO_FLOW_INFO","N/A","Subscription ".concat(o,": noFlow"))),ht.abrupt("return");case 38:return ht.next=40,(0,_$flow_137.getFlowHeaders)((T=U)!==null&&T!==void 0&&T.insecure?"".concat(f,"#insecure"):f,U.flowUserAgent,void 0,h.proxy,U.flowUrl);case 40:if((at=ht.sent)||h.subUserinfo){ht.next=44;break}return(0,_$response_127.failed)(r,new _$errors_119.InternalServerError("NO_FLOW_INFO","No flow info","Failed to fetch flow headers")),ht.abrupt("return");case 44:if(ht.prev=44,et=(0,_$flow_137.getRmainingDays)({resetDay:U.resetDay,startDate:U.startDate,cycleDays:U.cycleDays}),!/^https?:\/\//.test(h.subUserinfo)){ht.next=58;break}return ht.prev=47,ht.next=50,(0,_$flow_137.getFlowHeaders)(void 0,void 0,void 0,h.proxy,h.subUserinfo);case 50:mt=ht.sent,ht.next=56;break;case 53:ht.prev=53,ht.t1=ht.catch(47),___app_130.default.error("\u8BA2\u9605 ".concat(o," \u4F7F\u7528\u81EA\u5B9A\u4E49\u6D41\u91CF\u94FE\u63A5 ").concat(h.subUserinfo," \u83B7\u53D6\u6D41\u91CF\u4FE1\u606F\u65F6\u53D1\u751F\u9519\u8BEF: ").concat(JSON.stringify(ht.t1)));case 56:ht.next=59;break;case 58:mt=h.subUserinfo;case 59:At=___objectSpread_130({},(0,_$flow_137.parseFlowHeaders)([mt,at].filter(function(xt){return xt}).join("; "))),et!=null&&(At.remainingDays=et),(0,_$response_127.success)(r,At),ht.next=68;break;case 64:ht.prev=64,ht.t2=ht.catch(44),___app_130.default.error("Failed to parse flow info for local subscription ".concat(o,": ").concat((dt=ht.t2.message)!==null&&dt!==void 0?dt:ht.t2)),(0,_$response_127.failed)(r,new _$errors_119.RequestInvalidError("NO_FLOW_INFO","N/A","Failed to parse flow info"));case 68:ht.next=73;break;case 70:ht.prev=70,ht.t3=ht.catch(29),(0,_$response_127.failed)(r,new _$errors_119.NetworkError("URL_NOT_ACCESSIBLE","The URL for subscription ".concat(o," is inaccessible.")));case 73:case"end":return ht.stop()}},e,null,[[12,18],[29,70],[44,64],[47,53]])}),(_getFlowInfo=function(){var e=this,n=arguments;return new Promise(function(r,o){var f=t.apply(e,n);function d(y){__asyncGeneratorStep_130(f,r,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_130(f,r,o,d,h,"throw",y)}d(void 0)})}).apply(this,arguments)}function createSubscription(t,e){var n=t.body;if(___app_130.default.info("\u6B63\u5728\u521B\u5EFA\u8BA2\u9605\uFF1A ".concat(n.name)),/\//.test(n.name))(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("INVALID_NAME","Subscription ".concat(n.name," is invalid")));else{var r=___app_130.default.read(_$constants_86.SUBS_KEY);(0,_$database_133.findByName)(r,n.name)?(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("DUPLICATE_KEY","Subscription ".concat(n.name," already exists."))):(r.push(n),___app_130.default.write(r,_$constants_86.SUBS_KEY),(0,_$response_127.success)(e,n,201))}}function getSubscription(t,e){var n=t.params.name,r=t.query.raw;n=decodeURIComponent(n);var o=___app_130.default.read(_$constants_86.SUBS_KEY),f=(0,_$database_133.findByName)(o,n);f?r?e.set("content-type","application/json").set("content-disposition",'attachment; filename="'.concat(encodeURIComponent(n),'.json"')).send(JSON.stringify(f)):(0,_$response_127.success)(e,f):(0,_$response_127.failed)(e,new _$errors_119.ResourceNotFoundError("SUBSCRIPTION_NOT_FOUND","Subscription ".concat(n," does not exist"),404))}function updateSubscription(t,e){var n=t.params.name;n=decodeURIComponent(n);var r=t.body,o=___app_130.default.read(_$constants_86.SUBS_KEY),f=(0,_$database_133.findByName)(o,n);if(f){var d=___objectSpread_130(___objectSpread_130({},f),r);if(___app_130.default.info("\u6B63\u5728\u66F4\u65B0\u8BA2\u9605\uFF1A ".concat(n)),n!==r.name){var h,y=___app_130.default.read(_$constants_86.COLLECTIONS_KEY)||[],F=___createForOfIteratorHelper_130(y);try{for(F.s();!(h=F.n()).done;){var S=h.value,T=S.subscriptions.indexOf(n);T!==-1&&(S.subscriptions[T]=r.name)}}catch(D){F.e(D)}finally{F.f()}var U,M=___app_130.default.read(_$constants_86.ARTIFACTS_KEY)||[],Y=___createForOfIteratorHelper_130(M);try{for(Y.s();!(U=Y.n()).done;){var Z=U.value;Z.type==="subscription"&&Z.source==n&&(Z.source=r.name)}}catch(D){Y.e(D)}finally{Y.f()}___app_130.default.write(y,_$constants_86.COLLECTIONS_KEY),___app_130.default.write(M,_$constants_86.ARTIFACTS_KEY)}(0,_$database_133.updateByName)(o,n,d),___app_130.default.write(o,_$constants_86.SUBS_KEY),(0,_$response_127.success)(e,d)}else(0,_$response_127.failed)(e,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","Subscription ".concat(n," does not exist!")),404)}function deleteSubscription(t,e){var n=t.params.name;n=decodeURIComponent(n),___app_130.default.info("\u5220\u9664\u8BA2\u9605\uFF1A".concat(n,"..."));var r=___app_130.default.read(_$constants_86.SUBS_KEY);(0,_$database_133.deleteByName)(r,n),___app_130.default.write(r,_$constants_86.SUBS_KEY);var o,f=___app_130.default.read(_$constants_86.COLLECTIONS_KEY),d=___createForOfIteratorHelper_130(f);try{for(d.s();!(o=d.n()).done;){var h=o.value;h.subscriptions=h.subscriptions.filter(function(y){return y!==n})}}catch(y){d.e(y)}finally{d.f()}___app_130.default.write(f,_$constants_86.COLLECTIONS_KEY),(0,_$response_127.success)(e)}function getAllSubscriptions(t,e){var n=___app_130.default.read(_$constants_86.SUBS_KEY);(0,_$response_127.success)(e,n)}function replaceSubscriptions(t,e){var n=t.body;___app_130.default.write(n,_$constants_86.SUBS_KEY),(0,_$response_127.success)(e)}___app_130.default.read(_$constants_86.SUBS_KEY)||___app_130.default.write({},_$constants_86.SUBS_KEY);var _$collections_117={};Object.defineProperty(_$collections_117,"__esModule",{value:!0}),_$collections_117.default=function(t){___app_117.default.read(_$constants_86.COLLECTIONS_KEY)||___app_117.default.write({},_$constants_86.COLLECTIONS_KEY),t.route("/api/collection/:name").get(getCollection).patch(updateCollection).delete(deleteCollection),t.route("/api/collections").get(getAllCollections).post(createCollection).put(replaceCollection)};var __obj_117,___app_117=(__obj_117=_$app_87)&&__obj_117.__esModule?__obj_117:{default:__obj_117};function ___createForOfIteratorHelper_117(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(y,F){if(y){if(typeof y=="string")return ___arrayLikeToArray_117(y,void 0);var S=Object.prototype.toString.call(y).slice(8,-1);return S==="Object"&&y.constructor&&(S=y.constructor.name),S==="Map"||S==="Set"?Array.from(y):S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S)?___arrayLikeToArray_117(y,void 0):void 0}}(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){n=n.call(t)},n:function(){var y=n.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||n.return==null||n.return()}finally{if(h)throw f}}}}function ___arrayLikeToArray_117(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function __ownKeys_117(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function ___objectSpread_117(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_117(Object(n),!0).forEach(function(r){___defineProperty_117(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):__ownKeys_117(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ___defineProperty_117(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function createCollection(t,e){var n=t.body;if(___app_117.default.info("\u6B63\u5728\u521B\u5EFA\u7EC4\u5408\u8BA2\u9605\uFF1A".concat(n.name)),/\//.test(n.name))(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("INVALID_NAME","Collection ".concat(n.name," is invalid")));else{var r=___app_117.default.read(_$constants_86.COLLECTIONS_KEY);(0,_$database_133.findByName)(r,n.name)?(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("DUPLICATE_KEY","Collection ".concat(n.name," already exists."))):(r.push(n),___app_117.default.write(r,_$constants_86.COLLECTIONS_KEY),(0,_$response_127.success)(e,n,201))}}function getCollection(t,e){var n=t.params.name,r=t.query.raw;n=decodeURIComponent(n);var o=___app_117.default.read(_$constants_86.COLLECTIONS_KEY),f=(0,_$database_133.findByName)(o,n);f?r?e.set("content-type","application/json").set("content-disposition",'attachment; filename="'.concat(encodeURIComponent(n),'.json"')).send(JSON.stringify(f)):(0,_$response_127.success)(e,f):(0,_$response_127.failed)(e,new _$errors_119.ResourceNotFoundError("SUBSCRIPTION_NOT_FOUND","Collection ".concat(n," does not exist"),404))}function updateCollection(t,e){var n=t.params.name;n=decodeURIComponent(n);var r=t.body,o=___app_117.default.read(_$constants_86.COLLECTIONS_KEY),f=(0,_$database_133.findByName)(o,n);if(f){var d=___objectSpread_117(___objectSpread_117({},f),r);if(___app_117.default.info("\u6B63\u5728\u66F4\u65B0\u7EC4\u5408\u8BA2\u9605\uFF1A".concat(n,"...")),n!==d.name){var h,y=___app_117.default.read(_$constants_86.ARTIFACTS_KEY)||[],F=___createForOfIteratorHelper_117(y);try{for(F.s();!(h=F.n()).done;){var S=h.value;S.type==="collection"&&S.source===f.name&&(S.source=d.name)}}catch(T){F.e(T)}finally{F.f()}___app_117.default.write(y,_$constants_86.ARTIFACTS_KEY)}(0,_$database_133.updateByName)(o,n,d),___app_117.default.write(o,_$constants_86.COLLECTIONS_KEY),(0,_$response_127.success)(e,d)}else(0,_$response_127.failed)(e,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","Collection ".concat(n," does not exist!")),404)}function deleteCollection(t,e){var n=t.params.name;n=decodeURIComponent(n),___app_117.default.info("\u6B63\u5728\u5220\u9664\u7EC4\u5408\u8BA2\u9605\uFF1A".concat(n));var r=___app_117.default.read(_$constants_86.COLLECTIONS_KEY);(0,_$database_133.deleteByName)(r,n),___app_117.default.write(r,_$constants_86.COLLECTIONS_KEY),(0,_$response_127.success)(e)}function getAllCollections(t,e){var n=___app_117.default.read(_$constants_86.COLLECTIONS_KEY);(0,_$response_127.success)(e,n)}function replaceCollection(t,e){var n=t.body;___app_117.default.write(n,_$constants_86.COLLECTIONS_KEY),(0,_$response_127.success)(e)}var _$file_120={};function ___typeof_120(t){return(___typeof_120=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$file_120,"__esModule",{value:!0}),_$file_120.default=function(t){___app_120.default.read(_$constants_86.FILES_KEY)||___app_120.default.write([],_$constants_86.FILES_KEY),t.get("/share/file/:name",getFile),t.route("/api/file/:name").get(getFile).patch(updateFile).delete(deleteFile),t.route("/api/wholeFile/:name").get(getWholeFile),t.route("/api/files").get(getAllFiles).post(createFile).put(replaceFile),t.route("/api/wholeFiles").get(getAllWholeFiles)};var __obj_120,___app_120=(__obj_120=_$app_87)&&__obj_120.__esModule?__obj_120:{default:__obj_120},___sync_120=_$sync_131({}),_excluded=["content"];function ___regeneratorRuntime_120(){___regeneratorRuntime_120=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=typeof Symbol=="function"?Symbol:{},o=r.iterator||"@@iterator",f=r.asyncIterator||"@@asyncIterator",d=r.toStringTag||"@@toStringTag";function h(l,s,v){return Object.defineProperty(l,s,{value:v,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,v,$){return s[v]=$}}function y(l,s,v,$){var E=s&&s.prototype instanceof T?s:T,rt=Object.create(E.prototype),gt=new dt($||[]);return rt._invoke=function(Et,Ct,x){var N="suspendedStart";return function(G,A){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(G==="throw")throw A;return{value:void 0,done:!0}}for(x.method=G,x.arg=A;;){var C=x.delegate;if(C){var j=et(C,x);if(j){if(j===S)continue;return j}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var K=F(Et,Ct,x);if(K.type==="normal"){if(N=x.done?"completed":"suspendedYield",K.arg===S)continue;return{value:K.arg,done:x.done}}K.type==="throw"&&(N="completed",x.method="throw",x.arg=K.arg)}}}(l,v,gt),rt}function F(l,s,v){try{return{type:"normal",arg:l.call(s,v)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var S={};function T(){}function U(){}function M(){}var Y={};h(Y,o,function(){return this});var Z=Object.getPrototypeOf,D=Z&&Z(Z(ht([])));D&&D!==e&&n.call(D,o)&&(Y=D);var nt=M.prototype=T.prototype=Object.create(Y);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(v){return this._invoke(s,v)})})}function at(l,s){var v;this._invoke=function($,E){function rt(){return new s(function(gt,Et){(function Ct(x,N,G,A){var C=F(l[x],l,N);if(C.type!=="throw"){var j=C.arg,K=j.value;return K&&___typeof_120(K)=="object"&&n.call(K,"__await")?s.resolve(K.__await).then(function(J){Ct("next",J,G,A)},function(J){Ct("throw",J,G,A)}):s.resolve(K).then(function(J){j.value=J,G(j)},function(J){return Ct("throw",J,G,A)})}A(C.arg)})($,E,gt,Et)})}return v=v?v.then(rt,rt):rt()}}function et(l,s){var v=l.iterator[s.method];if(v===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,et(l,s),s.method==="throw"))return S;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var $=F(v,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,S;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,S):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,S)}function mt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function At(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function dt(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(mt,this),this.reset(!0)}function ht(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var v=-1,$=function E(){for(;++v<l.length;)if(n.call(l,v))return E.value=l[v],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:xt}}function xt(){return{value:void 0,done:!0}}return U.prototype=M,h(nt,"constructor",M),h(M,"constructor",U),U.displayName=h(M,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===U||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,M):(l.__proto__=M,h(l,d,"GeneratorFunction")),l.prototype=Object.create(nt),l},t.awrap=function(l){return{__await:l}},ct(at.prototype),h(at.prototype,f,function(){return this}),t.AsyncIterator=at,t.async=function(l,s,v,$,E){E===void 0&&(E=Promise);var rt=new at(y(l,s,v,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(gt){return gt.done?gt.value:rt.next()})},ct(nt),h(nt,d,"Generator"),h(nt,o,function(){return this}),h(nt,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var v in l)s.push(v);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=ht,dt.prototype={constructor:dt,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(At),!l)for(var s in this)s.charAt(0)==="t"&&n.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function v(Ct,x){return rt.type="throw",rt.arg=l,s.next=Ct,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return v("end");if(E.tryLoc<=this.prev){var gt=n.call(E,"catchLoc"),Et=n.call(E,"finallyLoc");if(gt&&Et){if(this.prev<E.catchLoc)return v(E.catchLoc,!0);if(this.prev<E.finallyLoc)return v(E.finallyLoc)}else if(gt){if(this.prev<E.catchLoc)return v(E.catchLoc,!0)}else{if(!Et)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return v(E.finallyLoc)}}}},abrupt:function(l,s){for(var v=this.tryEntries.length-1;v>=0;--v){var $=this.tryEntries[v];if($.tryLoc<=this.prev&&n.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,S):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),S},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.finallyLoc===l)return this.complete(v.completion,v.afterLoc),At(v),S}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.tryLoc===l){var $=v.completion;if($.type==="throw"){var E=$.arg;At(v)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,v){return this.delegate={iterator:ht(l),resultName:s,nextLoc:v},this.method==="next"&&(this.arg=void 0),S}},t}function ___createForOfIteratorHelper_120(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(y,F){if(y){if(typeof y=="string")return ___arrayLikeToArray_120(y,void 0);var S=Object.prototype.toString.call(y).slice(8,-1);return S==="Object"&&y.constructor&&(S=y.constructor.name),S==="Map"||S==="Set"?Array.from(y):S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S)?___arrayLikeToArray_120(y,void 0):void 0}}(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){n=n.call(t)},n:function(){var y=n.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||n.return==null||n.return()}finally{if(h)throw f}}}}function ___arrayLikeToArray_120(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _objectWithoutProperties(t,e){if(t==null)return{};var n,r,o=function(d,h){if(d==null)return{};var y,F,S={},T=Object.keys(d);for(F=0;F<T.length;F++)y=T[F],h.indexOf(y)>=0||(S[y]=d[y]);return S}(t,e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(t);for(r=0;r<f.length;r++)n=f[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function __ownKeys_120(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function ___objectSpread_120(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_120(Object(n),!0).forEach(function(r){___defineProperty_120(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):__ownKeys_120(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ___defineProperty_120(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function __asyncGeneratorStep_120(t,e,n,r,o,f,d){try{var h=t[f](d),y=h.value}catch(F){return void n(F)}h.done?e(y):Promise.resolve(y).then(r,o)}function createFile(t,e){var n,r=t.body;r.name="".concat((n=r.name)!==null&&n!==void 0?n:Date.now()),___app_120.default.info("\u6B63\u5728\u521B\u5EFA\u6587\u4EF6\uFF1A".concat(r.name));var o=___app_120.default.read(_$constants_86.FILES_KEY);if((0,_$database_133.findByName)(o,r.name))return(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("DUPLICATE_KEY",t.body.name?"\u5DF2\u5B58\u5728 name \u4E3A ".concat(r.name," \u7684\u6587\u4EF6"):"\u65E0\u6CD5\u540C\u65F6\u521B\u5EFA\u76F8\u540C\u7684\u6587\u4EF6 \u53EF\u7A0D\u540E\u91CD\u8BD5"));o.push(r),___app_120.default.write(o,_$constants_86.FILES_KEY),(0,_$response_127.success)(e,r,201)}function getFile(t,e){return _getFile.apply(this,arguments)}function _getFile(){var t;return t=___regeneratorRuntime_120().mark(function e(n,r){var o,f,d,h,y,F,S,T,U,M,Y,Z,D,nt,ct,at,et,mt,At,dt,ht,xt,l,s;return ___regeneratorRuntime_120().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(o=n.params.name,o=decodeURIComponent(o),___app_120.default.info("\u6B63\u5728\u4E0B\u8F7D\u6587\u4EF6\uFF1A".concat(o)),f=n.query,d=f.url,h=f.subInfoUrl,y=f.subInfoUserAgent,F=f.ua,S=f.content,T=f.mergeSources,U=f.ignoreFailedRemoteFile,M=f.proxy,Y=f.noCache,Z={},n.query.$options){try{Z=JSON.parse(decodeURIComponent(n.query.$options))}catch{D=___createForOfIteratorHelper_120(n.query.$options.split("&"));try{for(D.s();!(nt=D.n()).done;)ct=nt.value,at=ct.split("=")[0],et=ct.split("=")[1],Z[at]=et==null||et===""||decodeURIComponent(et)}catch(E){D.e(E)}finally{D.f()}}___app_120.default.info("\u4F20\u5165 $options: ".concat(JSON.stringify(Z)))}if(d&&(d=decodeURIComponent(d),___app_120.default.info("\u6307\u5B9A\u8FDC\u7A0B\u6587\u4EF6 URL: ".concat(d))),M&&(M=decodeURIComponent(M),___app_120.default.info("\u6307\u5B9A\u8FDC\u7A0B\u8BA2\u9605\u4F7F\u7528\u4EE3\u7406/\u7B56\u7565 proxy: ".concat(M))),F&&(F=decodeURIComponent(F),___app_120.default.info("\u6307\u5B9A\u8FDC\u7A0B\u6587\u4EF6 User-Agent: ".concat(F))),h&&(h=decodeURIComponent(h),___app_120.default.info("\u6307\u5B9A\u83B7\u53D6\u6D41\u91CF\u7684 subInfoUrl: ".concat(h))),y&&(y=decodeURIComponent(y),___app_120.default.info("\u6307\u5B9A\u83B7\u53D6\u6D41\u91CF\u7684 subInfoUserAgent: ".concat(y))),S&&(S=decodeURIComponent(S),___app_120.default.info("\u6307\u5B9A\u672C\u5730\u6587\u4EF6: ".concat(S))),T&&(T=decodeURIComponent(T),___app_120.default.info("\u6307\u5B9A\u5408\u5E76\u6765\u6E90: ".concat(T))),U!=null&&U!==""&&(U=decodeURIComponent(U),___app_120.default.info("\u6307\u5B9A\u5FFD\u7565\u5931\u8D25\u7684\u8FDC\u7A0B\u6587\u4EF6: ".concat(U))),Y&&___app_120.default.info("\u6307\u5B9A\u4E0D\u4F7F\u7528\u7F13\u5B58: ".concat(Y)),mt=___app_120.default.read(_$constants_86.FILES_KEY),!(At=(0,_$database_133.findByName)(mt,o))){v.next=45;break}return v.prev=18,v.next=21,(0,___sync_120.produceArtifact)({type:"file",name:o,url:d,ua:F,content:S,mergeSources:T,ignoreFailedRemoteFile:U,$options:Z,proxy:M,noCache:Y});case 21:if(dt=v.sent,v.prev=22,!(h=h||At.subInfoUrl)){v.next=29;break}return v.next=27,(0,_$flow_137.getFlowHeaders)(h,y||At.subInfoUserAgent,void 0,M||At.proxy);case 27:(ht=v.sent)&&r.set("subscription-userinfo",ht);case 29:v.next=34;break;case 31:v.prev=31,v.t0=v.catch(22),___app_120.default.error("\u6587\u4EF6 ".concat(o," \u83B7\u53D6\u6D41\u91CF\u4FE1\u606F\u65F6\u53D1\u751F\u9519\u8BEF: ").concat(JSON.stringify(v.t0)));case 34:At.download&&r.set("Content-Disposition","attachment; filename*=UTF-8''".concat(encodeURIComponent(At.displayName||At.name))),r.set("Content-Type","text/plain; charset=utf-8").send(dt??""),v.next=43;break;case 38:v.prev=38,v.t1=v.catch(18),___app_120.default.notify("\u{1F30D} Sub-Store \u4E0B\u8F7D\u6587\u4EF6\u5931\u8D25","\u274C \u65E0\u6CD5\u4E0B\u8F7D\u6587\u4EF6\uFF1A".concat(o,"\uFF01"),"\u{1F914} \u539F\u56E0\uFF1A".concat((xt=v.t1.message)!==null&&xt!==void 0?xt:v.t1)),___app_120.default.error((l=v.t1.message)!==null&&l!==void 0?l:v.t1),(0,_$response_127.failed)(r,new _$errors_119.InternalServerError("INTERNAL_SERVER_ERROR","Failed to download file: ".concat(o),"Reason: ".concat((s=v.t1.message)!==null&&s!==void 0?s:v.t1)));case 43:v.next=47;break;case 45:___app_120.default.error(`\u{1F30D} Sub-Store \u4E0B\u8F7D\u6587\u4EF6\u5931\u8D25
\u274C \u672A\u627E\u5230\u6587\u4EF6\uFF1A`.concat(o,"\uFF01")),(0,_$response_127.failed)(r,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","File ".concat(o," does not exist!")),404);case 47:case"end":return v.stop()}},e,null,[[18,38],[22,31]])}),(_getFile=function(){var e=this,n=arguments;return new Promise(function(r,o){var f=t.apply(e,n);function d(y){__asyncGeneratorStep_120(f,r,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_120(f,r,o,d,h,"throw",y)}d(void 0)})}).apply(this,arguments)}function getWholeFile(t,e){var n=t.params.name,r=t.query.raw;n=decodeURIComponent(n);var o=___app_120.default.read(_$constants_86.FILES_KEY),f=(0,_$database_133.findByName)(o,n);f?r?e.set("content-type","application/json").set("content-disposition",'attachment; filename="'.concat(encodeURIComponent(n),'.json"')).send(JSON.stringify(f)):(0,_$response_127.success)(e,f):(0,_$response_127.failed)(e,new _$errors_119.ResourceNotFoundError("FILE_NOT_FOUND","File ".concat(n," does not exist"),404))}function updateFile(t,e){var n=t.params.name;n=decodeURIComponent(n);var r=t.body,o=___app_120.default.read(_$constants_86.FILES_KEY),f=(0,_$database_133.findByName)(o,n);if(f){var d=___objectSpread_120(___objectSpread_120({},f),r);___app_120.default.info("\u6B63\u5728\u66F4\u65B0\u6587\u4EF6\uFF1A".concat(n,"...")),(0,_$database_133.updateByName)(o,n,d),___app_120.default.write(o,_$constants_86.FILES_KEY),(0,_$response_127.success)(e,d)}else(0,_$response_127.failed)(e,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","File ".concat(n," does not exist!")),404)}function deleteFile(t,e){var n=t.params.name;n=decodeURIComponent(n),___app_120.default.info("\u6B63\u5728\u5220\u9664\u6587\u4EF6\uFF1A".concat(n));var r=___app_120.default.read(_$constants_86.FILES_KEY);(0,_$database_133.deleteByName)(r,n),___app_120.default.write(r,_$constants_86.FILES_KEY),(0,_$response_127.success)(e)}function getAllFiles(t,e){var n=___app_120.default.read(_$constants_86.FILES_KEY);(0,_$response_127.success)(e,n.map(function(r){return r.content,_objectWithoutProperties(r,_excluded)}))}function getAllWholeFiles(t,e){var n=___app_120.default.read(_$constants_86.FILES_KEY);(0,_$response_127.success)(e,n)}function replaceFile(t,e){var n=t.body;___app_120.default.write(n,_$constants_86.FILES_KEY),(0,_$response_127.success)(e)}var _$token_132={};Object.defineProperty(_$token_132,"__esModule",{value:!0}),_$token_132.default=register;var ___app_132=___interopRequireDefault_132(_$app_87);function ___interopRequireDefault_132(t){return t&&t.__esModule?t:{default:t}}function ___regeneratorRuntime_132(){___regeneratorRuntime_132=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=typeof Symbol=="function"?Symbol:{},o=r.iterator||"@@iterator",f=r.asyncIterator||"@@asyncIterator",d=r.toStringTag||"@@toStringTag";function h(l,s,v){return Object.defineProperty(l,s,{value:v,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,v,$){return s[v]=$}}function y(l,s,v,$){var E=s&&s.prototype instanceof T?s:T,rt=Object.create(E.prototype),gt=new dt($||[]);return rt._invoke=function(Et,Ct,x){var N="suspendedStart";return function(G,A){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(G==="throw")throw A;return{value:void 0,done:!0}}for(x.method=G,x.arg=A;;){var C=x.delegate;if(C){var j=et(C,x);if(j){if(j===S)continue;return j}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var K=F(Et,Ct,x);if(K.type==="normal"){if(N=x.done?"completed":"suspendedYield",K.arg===S)continue;return{value:K.arg,done:x.done}}K.type==="throw"&&(N="completed",x.method="throw",x.arg=K.arg)}}}(l,v,gt),rt}function F(l,s,v){try{return{type:"normal",arg:l.call(s,v)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var S={};function T(){}function U(){}function M(){}var Y={};h(Y,o,function(){return this});var Z=Object.getPrototypeOf,D=Z&&Z(Z(ht([])));D&&D!==e&&n.call(D,o)&&(Y=D);var nt=M.prototype=T.prototype=Object.create(Y);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(v){return this._invoke(s,v)})})}function at(l,s){var v;this._invoke=function($,E){function rt(){return new s(function(gt,Et){(function Ct(x,N,G,A){var C=F(l[x],l,N);if(C.type!=="throw"){var j=C.arg,K=j.value;return K&&___typeof_132(K)=="object"&&n.call(K,"__await")?s.resolve(K.__await).then(function(J){Ct("next",J,G,A)},function(J){Ct("throw",J,G,A)}):s.resolve(K).then(function(J){j.value=J,G(j)},function(J){return Ct("throw",J,G,A)})}A(C.arg)})($,E,gt,Et)})}return v=v?v.then(rt,rt):rt()}}function et(l,s){var v=l.iterator[s.method];if(v===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,et(l,s),s.method==="throw"))return S;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var $=F(v,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,S;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,S):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,S)}function mt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function At(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function dt(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(mt,this),this.reset(!0)}function ht(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var v=-1,$=function E(){for(;++v<l.length;)if(n.call(l,v))return E.value=l[v],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:xt}}function xt(){return{value:void 0,done:!0}}return U.prototype=M,h(nt,"constructor",M),h(M,"constructor",U),U.displayName=h(M,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===U||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,M):(l.__proto__=M,h(l,d,"GeneratorFunction")),l.prototype=Object.create(nt),l},t.awrap=function(l){return{__await:l}},ct(at.prototype),h(at.prototype,f,function(){return this}),t.AsyncIterator=at,t.async=function(l,s,v,$,E){E===void 0&&(E=Promise);var rt=new at(y(l,s,v,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(gt){return gt.done?gt.value:rt.next()})},ct(nt),h(nt,d,"Generator"),h(nt,o,function(){return this}),h(nt,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var v in l)s.push(v);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=ht,dt.prototype={constructor:dt,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(At),!l)for(var s in this)s.charAt(0)==="t"&&n.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function v(Ct,x){return rt.type="throw",rt.arg=l,s.next=Ct,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return v("end");if(E.tryLoc<=this.prev){var gt=n.call(E,"catchLoc"),Et=n.call(E,"finallyLoc");if(gt&&Et){if(this.prev<E.catchLoc)return v(E.catchLoc,!0);if(this.prev<E.finallyLoc)return v(E.finallyLoc)}else if(gt){if(this.prev<E.catchLoc)return v(E.catchLoc,!0)}else{if(!Et)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return v(E.finallyLoc)}}}},abrupt:function(l,s){for(var v=this.tryEntries.length-1;v>=0;--v){var $=this.tryEntries[v];if($.tryLoc<=this.prev&&n.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,S):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),S},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.finallyLoc===l)return this.complete(v.completion,v.afterLoc),At(v),S}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.tryLoc===l){var $=v.completion;if($.type==="throw"){var E=$.arg;At(v)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,v){return this.delegate={iterator:ht(l),resultName:s,nextLoc:v},this.method==="next"&&(this.arg=void 0),S}},t}function ___typeof_132(t){return(___typeof_132=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function __ownKeys_132(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function ___objectSpread_132(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_132(Object(n),!0).forEach(function(r){___defineProperty_132(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):__ownKeys_132(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ___defineProperty_132(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function __asyncGeneratorStep_132(t,e,n,r,o,f,d){try{var h=t[f](d),y=h.value}catch(F){return void n(F)}h.done?e(y):Promise.resolve(y).then(r,o)}function ___asyncToGenerator_132(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var f=t.apply(e,n);function d(y){__asyncGeneratorStep_132(f,r,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_132(f,r,o,d,h,"throw",y)}d(void 0)})}}function register(t){___app_132.default.read(_$constants_86.TOKENS_KEY)||___app_132.default.write([],_$constants_86.TOKENS_KEY),t.post("/api/token",signToken),t.route("/api/token/:token").delete(deleteToken),t.route("/api/tokens").get(getAllTokens)}function deleteToken(t,e){var n=t.params.token;n=decodeURIComponent(n),___app_132.default.info("\u6B63\u5728\u5220\u9664\uFF1A".concat(n));var r=___app_132.default.read(_$constants_86.TOKENS_KEY);(0,_$database_133.deleteByName)(r,n,"token"),___app_132.default.write(r,_$constants_86.TOKENS_KEY),(0,_$response_127.success)(e)}function getAllTokens(t,e){var n=t.query,r=n.type,o=n.name,f=___app_132.default.read(_$constants_86.TOKENS_KEY)||[];(0,_$response_127.success)(e,r||o?f.filter(function(d){return!(r&&d.type!==r||o&&d.name!==o)}):f)}function signToken(t,e){return _signToken.apply(this,arguments)}function _signToken(){return _signToken=___asyncToGenerator_132(___regeneratorRuntime_132().mark(function t(e,n){var r,o;return ___regeneratorRuntime_132().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if((0,_$openApi_151.ENV)().isNode){d.next=2;break}return d.abrupt("return",(0,_$response_127.failed)(n,new _$errors_119.RequestInvalidError("INVALID_ENV","This endpoint is only available in Node.js environment")));case 2:if(d.prev=2,r=function(){var h=e.body,y=h.payload,F=h.options,S=require("ms"),T=y?.token;if(T!=null){if(typeof T!="string"||T.length<1)return{v:(0,_$response_127.failed)(n,new _$errors_119.RequestInvalidError("INVALID_CUSTOM_TOKEN","Invalid custom token: ".concat(T)))};var U=___app_132.default.read(_$constants_86.TOKENS_KEY)||[];if(U.find(function(ht){return ht.token===T}))return{v:(0,_$response_127.failed)(n,new _$errors_119.RequestInvalidError("DUPLICATE_TOKEN","Token ".concat(T," already exists")))}}var M=y?.type,Y=y?.name;if(!M||!Y)return{v:(0,_$response_127.failed)(n,new _$errors_119.RequestInvalidError("INVALID_PAYLOAD","payload type and name are required"))};if(M==="col"){var Z=___app_132.default.read(_$constants_86.COLLECTIONS_KEY)||[],D=Z.find(function(ht){return ht.name===Y});if(!D)return{v:(0,_$response_127.failed)(n,new _$errors_119.RequestInvalidError("INVALID_COLLECTION","collection ".concat(Y," not found")))}}else if(M==="file"){var nt=___app_132.default.read(_$constants_86.FILES_KEY)||[],ct=nt.find(function(ht){return ht.name===Y});if(!ct)return{v:(0,_$response_127.failed)(n,new _$errors_119.RequestInvalidError("INVALID_FILE","file ".concat(Y," not found")))}}else{if(M!=="sub")return{v:(0,_$response_127.failed)(n,new _$errors_119.RequestInvalidError("INVALID_TYPE","type ".concat(Y," not supported")))};var at=___app_132.default.read(_$constants_86.SUBS_KEY)||[],et=at.find(function(ht){return ht.name===Y});if(!et)return{v:(0,_$response_127.failed)(n,new _$errors_119.RequestInvalidError("INVALID_SUB","sub ".concat(Y," not found")))}}var mt=F?.expiresIn;if(F?.expiresIn!=null&&(mt=S(F.expiresIn),mt==null||isNaN(mt)||mt<=0))return{v:(0,_$response_127.failed)(n,new _$errors_119.RequestInvalidError("INVALID_EXPIRES_IN","Invalid expiresIn option: ".concat(F.expiresIn)))};var At=require("nanoid"),dt=___app_132.default.read(_$constants_86.TOKENS_KEY)||[];if(!T)do T=At.customAlphabet(At.urlAlphabet)();while(dt.find(function(ht){return ht.token===T}));return dt.push(___objectSpread_132(___objectSpread_132({},y),{},{token:T,createdAt:Date.now(),expiresIn:mt>0?F?.expiresIn:void 0,exp:mt>0?Date.now()+mt:void 0})),___app_132.default.write(dt,_$constants_86.TOKENS_KEY),{v:(0,_$response_127.success)(n,{token:T})}}(),___typeof_132(r)!=="object"){d.next=6;break}return d.abrupt("return",r.v);case 6:d.next=11;break;case 8:return d.prev=8,d.t0=d.catch(2),d.abrupt("return",(0,_$response_127.failed)(n,new _$errors_119.InternalServerError("TOKEN_SIGN_FAILED","Failed to sign token","Reason: ".concat((o=d.t0.message)!==null&&o!==void 0?o:d.t0))));case 11:case"end":return d.stop()}},t,null,[[2,8]])})),_signToken.apply(this,arguments)}var _$module_123={};Object.defineProperty(_$module_123,"__esModule",{value:!0}),_$module_123.default=function(t){___app_123.default.read(_$constants_86.MODULES_KEY)||___app_123.default.write([],_$constants_86.MODULES_KEY),t.route("/api/module/:name").get(getModule).patch(updateModule).delete(deleteModule),t.route("/api/modules").get(getAllModules).post(createModule).put(replaceModule)};var __obj_123,___app_123=(__obj_123=_$app_87)&&__obj_123.__esModule?__obj_123:{default:__obj_123},___excluded_123=["content"];function ___objectWithoutProperties_123(t,e){if(t==null)return{};var n,r,o=function(d,h){if(d==null)return{};var y,F,S={},T=Object.keys(d);for(F=0;F<T.length;F++)y=T[F],h.indexOf(y)>=0||(S[y]=d[y]);return S}(t,e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(t);for(r=0;r<f.length;r++)n=f[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function __ownKeys_123(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function ___objectSpread_123(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_123(Object(n),!0).forEach(function(r){___defineProperty_123(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):__ownKeys_123(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ___defineProperty_123(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function createModule(t,e){var n,r=t.body;r.name="".concat((n=r.name)!==null&&n!==void 0?n:(0,_$md5_150.hex_md5)(JSON.stringify(r))),___app_123.default.info("\u6B63\u5728\u521B\u5EFA\u6A21\u5757\uFF1A".concat(r.name));var o=___app_123.default.read(_$constants_86.MODULES_KEY);if((0,_$database_133.findByName)(o,r.name))return(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("DUPLICATE_KEY",t.body.name?"\u5DF2\u5B58\u5728 name \u4E3A ".concat(r.name," \u7684\u6A21\u5757"):"\u5DF2\u5B58\u5728\u76F8\u540C\u7684\u6A21\u5757 \u8BF7\u52FF\u91CD\u590D\u6DFB\u52A0"));o.push(r),___app_123.default.write(o,_$constants_86.MODULES_KEY),(0,_$response_127.success)(e,r,201)}function getModule(t,e){var n=t.params.name;n=decodeURIComponent(n);var r=___app_123.default.read(_$constants_86.MODULES_KEY),o=(0,_$database_133.findByName)(r,n);o?e.set("Content-Type","text/plain; charset=utf-8").send(o.content):(0,_$response_127.failed)(e,new _$errors_119.ResourceNotFoundError("MODULE_NOT_FOUND","Module ".concat(n," does not exist"),404))}function updateModule(t,e){var n=t.params.name;n=decodeURIComponent(n);var r=t.body,o=___app_123.default.read(_$constants_86.MODULES_KEY),f=(0,_$database_133.findByName)(o,n);if(f){var d=___objectSpread_123(___objectSpread_123({},f),r);___app_123.default.info("\u6B63\u5728\u66F4\u65B0\u6A21\u5757\uFF1A".concat(n,"...")),(0,_$database_133.updateByName)(o,n,d),___app_123.default.write(o,_$constants_86.MODULES_KEY),(0,_$response_127.success)(e,d)}else(0,_$response_127.failed)(e,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","Module ".concat(n," does not exist!")),404)}function deleteModule(t,e){var n=t.params.name;n=decodeURIComponent(n),___app_123.default.info("\u6B63\u5728\u5220\u9664\u6A21\u5757\uFF1A".concat(n));var r=___app_123.default.read(_$constants_86.MODULES_KEY);(0,_$database_133.deleteByName)(r,n),___app_123.default.write(r,_$constants_86.MODULES_KEY),(0,_$response_127.success)(e)}function getAllModules(t,e){var n=___app_123.default.read(_$constants_86.MODULES_KEY);(0,_$response_127.success)(e,n.map(function(r){return r.content,___objectWithoutProperties_123(r,___excluded_123)}))}function replaceModule(t,e){var n=t.body;___app_123.default.write(n,_$constants_86.MODULES_KEY),(0,_$response_127.success)(e)}var _$userAgent_147={};function getUserAgentFromHeaders(t){for(var e="",n="",r="",o=0,f=Object.keys(t);o<f.length;o++){var d=f[o],h=d.toLowerCase();h==="user-agent"?n=(e=t[d]).toLowerCase():h==="accept"&&(r=t[d])}return{UA:e,ua:n,accept:r}}function getPlatformFromUserAgent(t){var e=t.ua,n=t.UA,r=t.accept;return n.indexOf("Quantumult%20X")!==-1?"QX":e.indexOf("egern")!==-1?"Egern":n.indexOf("Surfboard")!==-1?"Surfboard":n.indexOf("Surge Mac")!==-1?"SurgeMac":n.indexOf("Surge")!==-1?"Surge":n.indexOf("Decar")!==-1||n.indexOf("Loon")!==-1?"Loon":n.indexOf("Shadowrocket")!==-1?"Shadowrocket":n.indexOf("Stash")!==-1?"Stash":e==="meta"||e.indexOf("clash")!==-1&&e.indexOf("meta")!==-1||e.indexOf("clash-verge")!==-1||e.indexOf("flclash")!==-1?"ClashMeta":e.indexOf("clash")!==-1?"Clash":e.indexOf("v2ray")!==-1?"V2Ray":e.indexOf("sing-box")!==-1?"sing-box":r.indexOf("application/json")===0?"JSON":"V2Ray"}Object.defineProperty(_$userAgent_147,"__esModule",{value:!0}),_$userAgent_147.getPlatformFromHeaders=function(t){var e=getUserAgentFromHeaders(t),n=e.UA;return getPlatformFromUserAgent({ua:e.ua,UA:n,accept:e.accept})},_$userAgent_147.getPlatformFromUserAgent=getPlatformFromUserAgent,_$userAgent_147.getUserAgentFromHeaders=getUserAgentFromHeaders;var _$download_118={};function ___typeof_118(t){return(___typeof_118=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$download_118,"__esModule",{value:!0}),_$download_118.default=function(t){var e,n,r,o,f,d,h,y;t.get("/share/col/:name/:target",(y=___asyncToGenerator_118(___regeneratorRuntime_118().mark(function F(S,T){var U;return ___regeneratorRuntime_118().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return(U=S.params.target)&&(S.query.target=U,___app_118.default.info("\u4F7F\u7528\u8DEF\u7531\u6307\u5B9A\u76EE\u6807: ".concat(U))),M.next=4,downloadCollection(S,T);case 4:case"end":return M.stop()}},F)})),function(F,S){return y.apply(this,arguments)})),t.get("/share/col/:name",downloadCollection),t.get("/share/sub/:name/:target",(h=___asyncToGenerator_118(___regeneratorRuntime_118().mark(function F(S,T){var U;return ___regeneratorRuntime_118().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return(U=S.params.target)&&(S.query.target=U,___app_118.default.info("\u4F7F\u7528\u8DEF\u7531\u6307\u5B9A\u76EE\u6807: ".concat(U))),M.next=4,downloadSubscription(S,T);case 4:case"end":return M.stop()}},F)})),function(F,S){return h.apply(this,arguments)})),t.get("/share/sub/:name",downloadSubscription),t.get("/download/collection/:name/:target",(d=___asyncToGenerator_118(___regeneratorRuntime_118().mark(function F(S,T){var U;return ___regeneratorRuntime_118().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return(U=S.params.target)&&(S.query.target=U,___app_118.default.info("\u4F7F\u7528\u8DEF\u7531\u6307\u5B9A\u76EE\u6807: ".concat(U))),M.next=4,downloadCollection(S,T);case 4:case"end":return M.stop()}},F)})),function(F,S){return d.apply(this,arguments)})),t.get("/download/collection/:name",downloadCollection),t.get("/download/:name/:target",(f=___asyncToGenerator_118(___regeneratorRuntime_118().mark(function F(S,T){var U;return ___regeneratorRuntime_118().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return(U=S.params.target)&&(S.query.target=U,___app_118.default.info("\u4F7F\u7528\u8DEF\u7531\u6307\u5B9A\u76EE\u6807: ".concat(U))),M.next=4,downloadSubscription(S,T);case 4:case"end":return M.stop()}},F)})),function(F,S){return f.apply(this,arguments)})),t.get("/download/:name",downloadSubscription),t.get("/download/collection/:name/api/v1/server/details",(o=___asyncToGenerator_118(___regeneratorRuntime_118().mark(function F(S,T){return ___regeneratorRuntime_118().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return S.query.platform="JSON",S.query.produceType="internal",S.query.resultFormat="nezha",U.next=5,downloadCollection(S,T);case 5:case"end":return U.stop()}},F)})),function(F,S){return o.apply(this,arguments)})),t.get("/download/:name/api/v1/server/details",(r=___asyncToGenerator_118(___regeneratorRuntime_118().mark(function F(S,T){return ___regeneratorRuntime_118().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return S.query.platform="JSON",S.query.produceType="internal",S.query.resultFormat="nezha",U.next=5,downloadSubscription(S,T);case 5:case"end":return U.stop()}},F)})),function(F,S){return r.apply(this,arguments)})),t.get("/download/collection/:name/api/v1/monitor/:nezhaIndex",(n=___asyncToGenerator_118(___regeneratorRuntime_118().mark(function F(S,T){return ___regeneratorRuntime_118().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return S.query.platform="JSON",S.query.produceType="internal",S.query.resultFormat="nezha-monitor",U.next=5,downloadCollection(S,T);case 5:case"end":return U.stop()}},F)})),function(F,S){return n.apply(this,arguments)})),t.get("/download/:name/api/v1/monitor/:nezhaIndex",(e=___asyncToGenerator_118(___regeneratorRuntime_118().mark(function F(S,T){return ___regeneratorRuntime_118().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return S.query.platform="JSON",S.query.produceType="internal",S.query.resultFormat="nezha-monitor",U.next=5,downloadSubscription(S,T);case 5:case"end":return U.stop()}},F)})),function(F,S){return e.apply(this,arguments)}))};var ___proxyUtils_118=_$proxyUtils_88({}),___app_118=___interopRequireDefault_118(_$app_87),___sync_118=_$sync_131({}),___env_118=___interopRequireDefault_118(_$env_136);function ___interopRequireDefault_118(t){return t&&t.__esModule?t:{default:t}}function ___toConsumableArray_118(t){return function(e){if(Array.isArray(e))return ___arrayLikeToArray_118(e)}(t)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(t)||___unsupportedIterableToArray_118(t)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ___createForOfIteratorHelper_118(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=___unsupportedIterableToArray_118(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){n=n.call(t)},n:function(){var y=n.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||n.return==null||n.return()}finally{if(h)throw f}}}}function ___unsupportedIterableToArray_118(t,e){if(t){if(typeof t=="string")return ___arrayLikeToArray_118(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?___arrayLikeToArray_118(t,e):void 0}}function ___arrayLikeToArray_118(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ___regeneratorRuntime_118(){___regeneratorRuntime_118=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=typeof Symbol=="function"?Symbol:{},o=r.iterator||"@@iterator",f=r.asyncIterator||"@@asyncIterator",d=r.toStringTag||"@@toStringTag";function h(l,s,v){return Object.defineProperty(l,s,{value:v,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,v,$){return s[v]=$}}function y(l,s,v,$){var E=s&&s.prototype instanceof T?s:T,rt=Object.create(E.prototype),gt=new dt($||[]);return rt._invoke=function(Et,Ct,x){var N="suspendedStart";return function(G,A){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(G==="throw")throw A;return{value:void 0,done:!0}}for(x.method=G,x.arg=A;;){var C=x.delegate;if(C){var j=et(C,x);if(j){if(j===S)continue;return j}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var K=F(Et,Ct,x);if(K.type==="normal"){if(N=x.done?"completed":"suspendedYield",K.arg===S)continue;return{value:K.arg,done:x.done}}K.type==="throw"&&(N="completed",x.method="throw",x.arg=K.arg)}}}(l,v,gt),rt}function F(l,s,v){try{return{type:"normal",arg:l.call(s,v)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var S={};function T(){}function U(){}function M(){}var Y={};h(Y,o,function(){return this});var Z=Object.getPrototypeOf,D=Z&&Z(Z(ht([])));D&&D!==e&&n.call(D,o)&&(Y=D);var nt=M.prototype=T.prototype=Object.create(Y);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(v){return this._invoke(s,v)})})}function at(l,s){var v;this._invoke=function($,E){function rt(){return new s(function(gt,Et){(function Ct(x,N,G,A){var C=F(l[x],l,N);if(C.type!=="throw"){var j=C.arg,K=j.value;return K&&___typeof_118(K)=="object"&&n.call(K,"__await")?s.resolve(K.__await).then(function(J){Ct("next",J,G,A)},function(J){Ct("throw",J,G,A)}):s.resolve(K).then(function(J){j.value=J,G(j)},function(J){return Ct("throw",J,G,A)})}A(C.arg)})($,E,gt,Et)})}return v=v?v.then(rt,rt):rt()}}function et(l,s){var v=l.iterator[s.method];if(v===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,et(l,s),s.method==="throw"))return S;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var $=F(v,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,S;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,S):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,S)}function mt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function At(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function dt(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(mt,this),this.reset(!0)}function ht(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var v=-1,$=function E(){for(;++v<l.length;)if(n.call(l,v))return E.value=l[v],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:xt}}function xt(){return{value:void 0,done:!0}}return U.prototype=M,h(nt,"constructor",M),h(M,"constructor",U),U.displayName=h(M,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===U||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,M):(l.__proto__=M,h(l,d,"GeneratorFunction")),l.prototype=Object.create(nt),l},t.awrap=function(l){return{__await:l}},ct(at.prototype),h(at.prototype,f,function(){return this}),t.AsyncIterator=at,t.async=function(l,s,v,$,E){E===void 0&&(E=Promise);var rt=new at(y(l,s,v,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(gt){return gt.done?gt.value:rt.next()})},ct(nt),h(nt,d,"Generator"),h(nt,o,function(){return this}),h(nt,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var v in l)s.push(v);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=ht,dt.prototype={constructor:dt,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(At),!l)for(var s in this)s.charAt(0)==="t"&&n.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function v(Ct,x){return rt.type="throw",rt.arg=l,s.next=Ct,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return v("end");if(E.tryLoc<=this.prev){var gt=n.call(E,"catchLoc"),Et=n.call(E,"finallyLoc");if(gt&&Et){if(this.prev<E.catchLoc)return v(E.catchLoc,!0);if(this.prev<E.finallyLoc)return v(E.finallyLoc)}else if(gt){if(this.prev<E.catchLoc)return v(E.catchLoc,!0)}else{if(!Et)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return v(E.finallyLoc)}}}},abrupt:function(l,s){for(var v=this.tryEntries.length-1;v>=0;--v){var $=this.tryEntries[v];if($.tryLoc<=this.prev&&n.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,S):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),S},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.finallyLoc===l)return this.complete(v.completion,v.afterLoc),At(v),S}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.tryLoc===l){var $=v.completion;if($.type==="throw"){var E=$.arg;At(v)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,v){return this.delegate={iterator:ht(l),resultName:s,nextLoc:v},this.method==="next"&&(this.arg=void 0),S}},t}function __asyncGeneratorStep_118(t,e,n,r,o,f,d){try{var h=t[f](d),y=h.value}catch(F){return void n(F)}h.done?e(y):Promise.resolve(y).then(r,o)}function ___asyncToGenerator_118(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var f=t.apply(e,n);function d(y){__asyncGeneratorStep_118(f,r,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_118(f,r,o,d,h,"throw",y)}d(void 0)})}}function downloadSubscription(t,e){return _downloadSubscription.apply(this,arguments)}function _downloadSubscription(){return(_downloadSubscription=___asyncToGenerator_118(___regeneratorRuntime_118().mark(function t(e,n){var r,o,f,d,h,y,F,S,T,U,M,Y,Z,D,nt,ct,at,et,mt,At,dt,ht,xt,l,s,v,$,E,rt,gt,Et,Ct,x,N,G,A,C,j,K,J;return ___regeneratorRuntime_118().wrap(function(yt){for(;;)switch(yt.prev=yt.next){case 0:if(r=e.params,o=r.name,f=r.nezhaIndex,o=decodeURIComponent(o),f=decodeURIComponent(f),d=e.query.target==="SurgeMac",h=e.query.target||(0,_$userAgent_147.getPlatformFromHeaders)(e.headers)||"JSON",y=e.headers["user-agent"]||e.headers["User-Agent"],___app_118.default.info("\u6B63\u5728\u4E0B\u8F7D\u8BA2\u9605\uFF1A".concat(o,`
\u8BF7\u6C42 User-Agent: `).concat(y,`
\u8BF7\u6C42 target: `).concat(e.query.target,`
\u5B9E\u9645\u8F93\u51FA: `).concat(h)),F=e.query,S=F.url,T=F.ua,U=F.content,M=F.mergeSources,Y=F.ignoreFailedRemoteSub,Z=F.produceType,D=F.includeUnsupportedProxy,nt=F.resultFormat,ct=F.proxy,at=F.noCache,et={},e.query.$options){try{et=JSON.parse(decodeURIComponent(e.query.$options))}catch{mt=___createForOfIteratorHelper_118(e.query.$options.split("&"));try{for(mt.s();!(At=mt.n()).done;)dt=At.value,ht=dt.split("=")[0],xt=dt.split("=")[1],et[ht]=xt==null||xt===""||decodeURIComponent(xt)}catch(Xt){mt.e(Xt)}finally{mt.f()}}___app_118.default.info("\u4F20\u5165 $options: ".concat(JSON.stringify(et)))}if(S&&(S=decodeURIComponent(S),___app_118.default.info("\u6307\u5B9A\u8FDC\u7A0B\u8BA2\u9605 URL: ".concat(S)),/^https?:\/\//.test(S)||(U=S,___app_118.default.info("URL \u4E0D\u662F\u94FE\u63A5\uFF0C\u89C6\u4E3A\u672C\u5730\u8BA2\u9605"))),U&&(U=decodeURIComponent(U),___app_118.default.info("\u6307\u5B9A\u672C\u5730\u8BA2\u9605: ".concat(U))),ct&&(ct=decodeURIComponent(ct),___app_118.default.info("\u6307\u5B9A\u8FDC\u7A0B\u8BA2\u9605\u4F7F\u7528\u4EE3\u7406/\u7B56\u7565 proxy: ".concat(ct))),T&&(T=decodeURIComponent(T),___app_118.default.info("\u6307\u5B9A\u8FDC\u7A0B\u8BA2\u9605 User-Agent: ".concat(T))),M&&(M=decodeURIComponent(M),___app_118.default.info("\u6307\u5B9A\u5408\u5E76\u6765\u6E90: ".concat(M))),Y!=null&&Y!==""&&(Y=decodeURIComponent(Y),___app_118.default.info("\u6307\u5B9A\u5FFD\u7565\u5931\u8D25\u7684\u8FDC\u7A0B\u8BA2\u9605: ".concat(Y))),Z&&(Z=decodeURIComponent(Z),___app_118.default.info("\u6307\u5B9A\u751F\u4EA7\u7C7B\u578B: ".concat(Z))),D&&(D=decodeURIComponent(D),___app_118.default.info("\u5305\u542B\u4E0D\u652F\u6301\u7684\u8282\u70B9: ".concat(D))),d&&___app_118.default.info("\u624B\u52A8\u6307\u5B9A\u4E86 target \u4E3A SurgeMac, \u5C06\u4F7F\u7528 Mihomo External"),at&&___app_118.default.info("\u6307\u5B9A\u4E0D\u4F7F\u7528\u7F13\u5B58: ".concat(at)),l=___app_118.default.read(_$constants_86.SUBS_KEY),!(s=(0,_$database_133.findByName)(l,o))){yt.next=84;break}return yt.prev=23,s.passThroughUA&&(___app_118.default.info("\u8BA2\u9605\u5F00\u542F\u4E86\u900F\u4F20 User-Agent, \u4F7F\u7528\u8BF7\u6C42\u7684 User-Agent: ".concat(y)),T=y),yt.next=28,(0,___sync_118.produceArtifact)({type:"subscription",name:o,platform:h,url:S,ua:T,content:U,mergeSources:M,ignoreFailedRemoteSub:Y,produceType:Z,produceOpts:{"include-unsupported-proxy":D,useMihomoExternal:d},$options:et,proxy:ct,noCache:at});case 28:if(v=yt.sent,s.source==="local"&&!["localFirst","remoteFirst"].includes(s.mergeSources)){yt.next=46;break}if(yt.prev=30,S=((E="".concat(S||s.url).split(/[\r\n]+/).map(function(Dt){return Dt.trim()}).filter(function(Dt){return Dt.length}))===null||E===void 0?void 0:E[0])||"",rt={},gt=S.split("#"),S=S.split("#")[0],gt.length>1)try{rt=JSON.parse(decodeURIComponent(gt[1]))}catch{Et=___createForOfIteratorHelper_118(gt[1].split("&"));try{for(Et.s();!(Ct=Et.n()).done;)x=Ct.value,N=x.split("=")[0],G=x.split("=")[1],rt[N]=G==null||G===""||decodeURIComponent(G)}catch(Xt){Et.e(Xt)}finally{Et.f()}}if(rt.noFlow){yt.next=41;break}return yt.next=39,(0,_$flow_137.getFlowHeaders)((A=rt)!==null&&A!==void 0&&A.insecure?"".concat(S,"#insecure"):S,rt.flowUserAgent,void 0,ct||s.proxy,rt.flowUrl);case 39:($=yt.sent)&&n.set("subscription-userinfo",$);case 41:yt.next=46;break;case 43:yt.prev=43,yt.t0=yt.catch(30),___app_118.default.error("\u8BA2\u9605 ".concat(o," \u83B7\u53D6\u6D41\u91CF\u4FE1\u606F\u65F6\u53D1\u751F\u9519\u8BEF: ").concat(JSON.stringify(yt.t0)));case 46:if(!s.subUserinfo){yt.next=61;break}if(!/^https?:\/\//.test(s.subUserinfo)){yt.next=59;break}return yt.prev=48,yt.next=51,(0,_$flow_137.getFlowHeaders)(void 0,void 0,void 0,ct||s.proxy,s.subUserinfo);case 51:C=yt.sent,yt.next=57;break;case 54:yt.prev=54,yt.t1=yt.catch(48),___app_118.default.error("\u8BA2\u9605 ".concat(o," \u4F7F\u7528\u81EA\u5B9A\u4E49\u6D41\u91CF\u94FE\u63A5 ").concat(s.subUserinfo," \u83B7\u53D6\u6D41\u91CF\u4FE1\u606F\u65F6\u53D1\u751F\u9519\u8BEF: ").concat(JSON.stringify(yt.t1)));case 57:yt.next=60;break;case 59:C=s.subUserinfo;case 60:n.set("subscription-userinfo",[C,$].filter(function(Dt){return Dt}).join("; "));case 61:if(h!=="JSON"){yt.next=74;break}if(nt!=="nezha"){yt.next=66;break}v=nezhaTransform(v),yt.next=71;break;case 66:if(nt!=="nezha-monitor"){yt.next=71;break}return f=/^\d+$/.test(f)?parseInt(f,10):v.findIndex(function(Dt){return Dt.name===f}),yt.next=70,nezhaMonitor(v[f],f,e.query);case 70:v=yt.sent;case 71:n.set("Content-Type","application/json;charset=utf-8").send(v),yt.next=75;break;case 74:n.send(v);case 75:yt.next=82;break;case 77:yt.prev=77,yt.t2=yt.catch(23),___app_118.default.notify("\u{1F30D} Sub-Store \u4E0B\u8F7D\u8BA2\u9605\u5931\u8D25","\u274C \u65E0\u6CD5\u4E0B\u8F7D\u8BA2\u9605\uFF1A".concat(o,"\uFF01"),"\u{1F914} \u539F\u56E0\uFF1A".concat((j=yt.t2.message)!==null&&j!==void 0?j:yt.t2)),___app_118.default.error((K=yt.t2.message)!==null&&K!==void 0?K:yt.t2),(0,_$response_127.failed)(n,new _$errors_119.InternalServerError("INTERNAL_SERVER_ERROR","Failed to download subscription: ".concat(o),"Reason: ".concat((J=yt.t2.message)!==null&&J!==void 0?J:yt.t2)));case 82:yt.next=86;break;case 84:___app_118.default.error(`\u{1F30D} Sub-Store \u4E0B\u8F7D\u8BA2\u9605\u5931\u8D25
\u274C \u672A\u627E\u5230\u8BA2\u9605\uFF1A`.concat(o,"\uFF01")),(0,_$response_127.failed)(n,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","Subscription ".concat(o," does not exist!")),404);case 86:case"end":return yt.stop()}},t,null,[[23,77],[30,43],[48,54]])}))).apply(this,arguments)}function downloadCollection(t,e){return _downloadCollection.apply(this,arguments)}function _downloadCollection(){return(_downloadCollection=___asyncToGenerator_118(___regeneratorRuntime_118().mark(function t(e,n){var r,o,f,d,h,y,F,S,T,U,M,Y,Z,D,nt,ct,at,et,mt,At,dt,ht,xt,l,s,v,$,E,rt,gt,Et,Ct,x,N,G,A,C,j,K;return ___regeneratorRuntime_118().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:if(r=e.params,o=r.name,f=r.nezhaIndex,o=decodeURIComponent(o),f=decodeURIComponent(f),d=e.query.target==="SurgeMac",h=e.query.target||(0,_$userAgent_147.getPlatformFromHeaders)(e.headers)||"JSON",y=___app_118.default.read(_$constants_86.COLLECTIONS_KEY),F=(0,_$database_133.findByName)(y,o),___app_118.default.info("\u6B63\u5728\u4E0B\u8F7D\u7EC4\u5408\u8BA2\u9605\uFF1A".concat(o,`
\u8BF7\u6C42 User-Agent: `).concat(e.headers["user-agent"]||e.headers["User-Agent"],`
\u8BF7\u6C42 target: `).concat(e.query.target,`
\u5B9E\u9645\u8F93\u51FA: `).concat(h)),S=e.query,T=S.ignoreFailedRemoteSub,U=S.produceType,M=S.includeUnsupportedProxy,Y=S.resultFormat,Z=S.proxy,D=S.noCache,nt={},e.query.$options){try{nt=JSON.parse(decodeURIComponent(e.query.$options))}catch{ct=___createForOfIteratorHelper_118(e.query.$options.split("&"));try{for(ct.s();!(at=ct.n()).done;)et=at.value,mt=et.split("=")[0],At=et.split("=")[1],nt[mt]=At==null||At===""||decodeURIComponent(At)}catch(Dt){ct.e(Dt)}finally{ct.f()}}___app_118.default.info("\u4F20\u5165 $options: ".concat(JSON.stringify(nt)))}if(Z&&(Z=decodeURIComponent(Z),___app_118.default.info("\u6307\u5B9A\u8FDC\u7A0B\u8BA2\u9605\u4F7F\u7528\u4EE3\u7406/\u7B56\u7565 proxy: ".concat(Z))),T!=null&&T!==""&&(T=decodeURIComponent(T),___app_118.default.info("\u6307\u5B9A\u5FFD\u7565\u5931\u8D25\u7684\u8FDC\u7A0B\u8BA2\u9605: ".concat(T))),U&&(U=decodeURIComponent(U),___app_118.default.info("\u6307\u5B9A\u751F\u4EA7\u7C7B\u578B: ".concat(U))),M&&(M=decodeURIComponent(M),___app_118.default.info("\u5305\u542B\u4E0D\u652F\u6301\u7684\u8282\u70B9: ".concat(M))),d&&___app_118.default.info("\u624B\u52A8\u6307\u5B9A\u4E86 target \u4E3A SurgeMac, \u5C06\u4F7F\u7528 Mihomo External"),D&&___app_118.default.info("\u6307\u5B9A\u4E0D\u4F7F\u7528\u7F13\u5B58: ".concat(D)),!F){J.next=94;break}return J.prev=18,J.next=21,(0,___sync_118.produceArtifact)({type:"collection",name:o,platform:h,ignoreFailedRemoteSub:T,produceType:U,produceOpts:{"include-unsupported-proxy":M,useMihomoExternal:d},$options:nt,proxy:Z,noCache:D});case 21:if(dt=J.sent,xt=___app_118.default.read(_$constants_86.SUBS_KEY),!((l=F.subscriptions).length>0)){J.next=57;break}if((s=(0,_$database_133.findByName)(xt,l[0])).source==="local"&&!["localFirst","remoteFirst"].includes(s.mergeSources)){J.next=42;break}if(J.prev=27,$=((v="".concat(s.url).split(/[\r\n]+/).map(function(yt){return yt.trim()}).filter(function(yt){return yt.length}))===null||v===void 0?void 0:v[0])||"",E={},rt=$.split("#"),$=$.split("#")[0],rt.length>1)try{E=JSON.parse(decodeURIComponent(rt[1]))}catch{gt=___createForOfIteratorHelper_118(rt[1].split("&"));try{for(gt.s();!(Et=gt.n()).done;)Ct=Et.value,x=Ct.split("=")[0],N=Ct.split("=")[1],E[x]=N==null||N===""||decodeURIComponent(N)}catch(Dt){gt.e(Dt)}finally{gt.f()}}if(E.noFlow){J.next=37;break}return J.next=36,(0,_$flow_137.getFlowHeaders)((G=E)!==null&&G!==void 0&&G.insecure?"".concat($,"#insecure"):$,E.flowUserAgent,void 0,Z||s.proxy||F.proxy,E.flowUrl);case 36:ht=J.sent;case 37:J.next=42;break;case 39:J.prev=39,J.t0=J.catch(27),___app_118.default.error("\u7EC4\u5408\u8BA2\u9605 ".concat(o," \u4E2D\u7684\u5B50\u8BA2\u9605 ").concat(s.name," \u83B7\u53D6\u6D41\u91CF\u4FE1\u606F\u65F6\u53D1\u751F\u9519\u8BEF: ").concat((A=J.t0.message)!==null&&A!==void 0?A:J.t0));case 42:if(!s.subUserinfo){J.next=57;break}if(!/^https?:\/\//.test(s.subUserinfo)){J.next=55;break}return J.prev=44,J.next=47,(0,_$flow_137.getFlowHeaders)(void 0,void 0,void 0,Z||s.proxy,s.subUserinfo);case 47:C=J.sent,J.next=53;break;case 50:J.prev=50,J.t1=J.catch(44),___app_118.default.error("\u7EC4\u5408\u8BA2\u9605 ".concat(o," \u4F7F\u7528\u81EA\u5B9A\u4E49\u6D41\u91CF\u94FE\u63A5 ").concat(s.subUserinfo," \u83B7\u53D6\u6D41\u91CF\u4FE1\u606F\u65F6\u53D1\u751F\u9519\u8BEF: ").concat(JSON.stringify(J.t1)));case 53:J.next=56;break;case 55:C=s.subUserinfo;case 56:ht=[C,ht].filter(function(yt){return yt}).join("; ");case 57:if(___app_118.default.info("\u7EC4\u5408\u8BA2\u9605 ".concat(o," \u900F\u4F20\u7684\u7684\u6D41\u91CF\u4FE1\u606F: ").concat(ht)),!/^https?:\/\//.test(F.subUserinfo)){J.next=70;break}return J.prev=59,J.next=62,(0,_$flow_137.getFlowHeaders)(void 0,void 0,void 0,Z||F.proxy,F.subUserinfo);case 62:j=J.sent,J.next=68;break;case 65:J.prev=65,J.t2=J.catch(59),___app_118.default.error("\u7EC4\u5408\u8BA2\u9605 ".concat(o," \u4F7F\u7528\u81EA\u5B9A\u4E49\u6D41\u91CF\u94FE\u63A5 ").concat(F.subUserinfo," \u83B7\u53D6\u6D41\u91CF\u4FE1\u606F\u65F6\u53D1\u751F\u9519\u8BEF: ").concat(JSON.stringify(J.t2)));case 68:J.next=71;break;case 70:j=F.subUserinfo;case 71:if(n.set("subscription-userinfo",[j,ht].filter(function(yt){return yt}).join("; ")),h!=="JSON"){J.next=85;break}if(Y!=="nezha"){J.next=77;break}dt=nezhaTransform(dt),J.next=82;break;case 77:if(Y!=="nezha-monitor"){J.next=82;break}return f=/^\d+$/.test(f)?parseInt(f,10):dt.findIndex(function(yt){return yt.name===f}),J.next=81,nezhaMonitor(dt[f],f,e.query);case 81:dt=J.sent;case 82:n.set("Content-Type","application/json;charset=utf-8").send(dt),J.next=86;break;case 85:n.send(dt);case 86:J.next=92;break;case 88:J.prev=88,J.t3=J.catch(18),___app_118.default.notify("\u{1F30D} Sub-Store \u4E0B\u8F7D\u7EC4\u5408\u8BA2\u9605\u5931\u8D25","\u274C \u4E0B\u8F7D\u7EC4\u5408\u8BA2\u9605\u9519\u8BEF\uFF1A".concat(o,"\uFF01"),"\u{1F914} \u539F\u56E0\uFF1A".concat(J.t3)),(0,_$response_127.failed)(n,new _$errors_119.InternalServerError("INTERNAL_SERVER_ERROR","Failed to download collection: ".concat(o),"Reason: ".concat((K=J.t3.message)!==null&&K!==void 0?K:J.t3)));case 92:J.next=96;break;case 94:___app_118.default.error("\u{1F30D} Sub-Store \u4E0B\u8F7D\u7EC4\u5408\u8BA2\u9605\u5931\u8D25","\u274C \u672A\u627E\u5230\u7EC4\u5408\u8BA2\u9605\uFF1A".concat(o,"\uFF01")),(0,_$response_127.failed)(n,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","Collection ".concat(o," does not exist!")),404);case 96:case"end":return J.stop()}},t,null,[[18,88],[27,39],[44,50],[59,65]])}))).apply(this,arguments)}function nezhaMonitor(t,e,n){return _nezhaMonitor.apply(this,arguments)}function _nezhaMonitor(){return(_nezhaMonitor=___asyncToGenerator_118(___regeneratorRuntime_118().mark(function t(e,n,r){var o,f,d,h,y,F,S,T,U,M,Y,Z,D,nt,ct,at;return ___regeneratorRuntime_118().wrap(function(et){for(;;)switch(et.prev=et.next){case 0:if(o={code:0,message:"success",result:[]},et.prev=1,f=___app_118.default.env,d=f.isLoon,h=f.isSurge,d||h){et.next=5;break}throw new Error("\u4EC5\u652F\u6301 Loon \u548C Surge(ability=http-client-policy)");case 5:if(y=___proxyUtils_118.ProxyUtils.produce([e],d?"Loon":"Surge")){et.next=8;break}throw new Error("\u5F53\u524D\u5BA2\u6237\u7AEF\u4E0D\u517C\u5BB9\u6B64\u8282\u70B9");case 8:F=e._monitors||[{name:"Cloudflare",url:"http://cp.cloudflare.com/generate_204",method:"HEAD",number:3,timeout:2e3},{name:"Google",url:"http://www.google.com/generate_204",method:"HEAD",number:3,timeout:2e3}],S=r.number||Math.max.apply(Math,___toConsumableArray_118(F.map(function(mt){return mt.number})))||3,T=___createForOfIteratorHelper_118(F),et.prev=11,T.s();case 13:if((U=T.n()).done){et.next=39;break}M=U.value,Y=6e5,Z={monitor_id:F.indexOf(M),server_id:n,monitor_name:M.name,server_name:e.name,created_at:[],avg_delay:[]},D=0;case 18:if(!(D<S)){et.next=36;break}return nt=Date.now(),et.prev=20,et.next=23,___app_118.default.http[(M.method||"HEAD").toLowerCase()]({timeout:M.timeout||2e3,url:M.url,"policy-descriptor":y,node:y});case 23:ct=Date.now()-nt,___app_118.default.info("".concat(M.name," latency: ").concat(ct)),Z.avg_delay.push(ct),et.next=32;break;case 28:et.prev=28,et.t0=et.catch(20),___app_118.default.error(et.t0),Z.avg_delay.push(0);case 32:Z.created_at.push(Date.now()-Y*(M.number-D-1));case 33:D++,et.next=18;break;case 36:o.result.push(Z);case 37:et.next=13;break;case 39:et.next=44;break;case 41:et.prev=41,et.t1=et.catch(11),T.e(et.t1);case 44:return et.prev=44,T.f(),et.finish(44);case 47:et.next=53;break;case 49:et.prev=49,et.t2=et.catch(1),___app_118.default.error(et.t2),o.result.push({monitor_id:0,server_id:0,monitor_name:"\u274C ".concat((at=et.t2.message)!==null&&at!==void 0?at:et.t2),server_name:e.name,created_at:[Date.now()],avg_delay:[0]});case 53:return et.abrupt("return",JSON.stringify(o,null,2));case 54:case"end":return et.stop()}},t,null,[[1,49],[11,41,44,47],[20,28]])}))).apply(this,arguments)}function nezhaTransform(t){var e={code:0,message:"success",result:[]};return t.map(function(n,r){var o,f,d=((o=n._geo)===null||o===void 0?void 0:o.countryCode)||((f=n._geo)===null||f===void 0?void 0:f.country);if(/^[a-z]{2}$/i.test(d)||(d=(0,_$geo_138.getISO)(n.name)),/^[a-z]{2}$/i.test(d)){var h,y=Math.round(new Date().getTime()/1e3),F=n._unavailable?0:y,S=parseInt(n._uptime||0,10);e.result.push({id:r,name:n.name,tag:"".concat((h=n._tag)!==null&&h!==void 0?h:""),last_active:F,valid_ip:n._IP||n.server,ipv4:n._IPv4||n.server,ipv6:n._IPv6||((0,_$utils_141.isIPv6)(n.server)?n.server:""),host:{Platform:"Sub-Store",PlatformVersion:___env_118.default.version,CPU:[],MemTotal:1024,DiskTotal:1024,SwapTotal:1024,Arch:"",Virtualization:"",BootTime:y-S,CountryCode:d,Version:"0.0.1"},status:{CPU:0,MemUsed:0,SwapUsed:0,DiskUsed:0,NetInTransfer:0,NetOutTransfer:0,NetInSpeed:0,NetOutSpeed:0,Uptime:S,Load1:0,Load5:0,Load15:0,TcpConnCount:0,UdpConnCount:0,ProcessCount:0}})}}),JSON.stringify(e,null,2)}var _$preview_126={};Object.defineProperty(_$preview_126,"__esModule",{value:!0}),_$preview_126.default=function(t){t.post("/api/preview/sub",compareSub),t.post("/api/preview/collection",compareCollection),t.post("/api/preview/file",previewFile)};var ___proxyUtils_126=_$proxyUtils_88({}),___download_126=___interopRequireDefault_126(_$download_135),___app_126=___interopRequireDefault_126(_$app_87);function ___interopRequireDefault_126(t){return t&&t.__esModule?t:{default:t}}function ___typeof_126(t){return(___typeof_126=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function ___toConsumableArray_126(t){return function(e){if(Array.isArray(e))return ___arrayLikeToArray_126(e)}(t)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(t)||function(e,n){if(e){if(typeof e=="string")return ___arrayLikeToArray_126(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?___arrayLikeToArray_126(e,void 0):void 0}}(t)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ___arrayLikeToArray_126(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ___defineProperty_126(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ___regeneratorRuntime_126(){___regeneratorRuntime_126=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=typeof Symbol=="function"?Symbol:{},o=r.iterator||"@@iterator",f=r.asyncIterator||"@@asyncIterator",d=r.toStringTag||"@@toStringTag";function h(l,s,v){return Object.defineProperty(l,s,{value:v,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,v,$){return s[v]=$}}function y(l,s,v,$){var E=s&&s.prototype instanceof T?s:T,rt=Object.create(E.prototype),gt=new dt($||[]);return rt._invoke=function(Et,Ct,x){var N="suspendedStart";return function(G,A){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(G==="throw")throw A;return{value:void 0,done:!0}}for(x.method=G,x.arg=A;;){var C=x.delegate;if(C){var j=et(C,x);if(j){if(j===S)continue;return j}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var K=F(Et,Ct,x);if(K.type==="normal"){if(N=x.done?"completed":"suspendedYield",K.arg===S)continue;return{value:K.arg,done:x.done}}K.type==="throw"&&(N="completed",x.method="throw",x.arg=K.arg)}}}(l,v,gt),rt}function F(l,s,v){try{return{type:"normal",arg:l.call(s,v)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var S={};function T(){}function U(){}function M(){}var Y={};h(Y,o,function(){return this});var Z=Object.getPrototypeOf,D=Z&&Z(Z(ht([])));D&&D!==e&&n.call(D,o)&&(Y=D);var nt=M.prototype=T.prototype=Object.create(Y);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(v){return this._invoke(s,v)})})}function at(l,s){var v;this._invoke=function($,E){function rt(){return new s(function(gt,Et){(function Ct(x,N,G,A){var C=F(l[x],l,N);if(C.type!=="throw"){var j=C.arg,K=j.value;return K&&___typeof_126(K)=="object"&&n.call(K,"__await")?s.resolve(K.__await).then(function(J){Ct("next",J,G,A)},function(J){Ct("throw",J,G,A)}):s.resolve(K).then(function(J){j.value=J,G(j)},function(J){return Ct("throw",J,G,A)})}A(C.arg)})($,E,gt,Et)})}return v=v?v.then(rt,rt):rt()}}function et(l,s){var v=l.iterator[s.method];if(v===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,et(l,s),s.method==="throw"))return S;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var $=F(v,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,S;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,S):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,S)}function mt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function At(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function dt(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(mt,this),this.reset(!0)}function ht(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var v=-1,$=function E(){for(;++v<l.length;)if(n.call(l,v))return E.value=l[v],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:xt}}function xt(){return{value:void 0,done:!0}}return U.prototype=M,h(nt,"constructor",M),h(M,"constructor",U),U.displayName=h(M,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===U||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,M):(l.__proto__=M,h(l,d,"GeneratorFunction")),l.prototype=Object.create(nt),l},t.awrap=function(l){return{__await:l}},ct(at.prototype),h(at.prototype,f,function(){return this}),t.AsyncIterator=at,t.async=function(l,s,v,$,E){E===void 0&&(E=Promise);var rt=new at(y(l,s,v,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(gt){return gt.done?gt.value:rt.next()})},ct(nt),h(nt,d,"Generator"),h(nt,o,function(){return this}),h(nt,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var v in l)s.push(v);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=ht,dt.prototype={constructor:dt,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(At),!l)for(var s in this)s.charAt(0)==="t"&&n.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function v(Ct,x){return rt.type="throw",rt.arg=l,s.next=Ct,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return v("end");if(E.tryLoc<=this.prev){var gt=n.call(E,"catchLoc"),Et=n.call(E,"finallyLoc");if(gt&&Et){if(this.prev<E.catchLoc)return v(E.catchLoc,!0);if(this.prev<E.finallyLoc)return v(E.finallyLoc)}else if(gt){if(this.prev<E.catchLoc)return v(E.catchLoc,!0)}else{if(!Et)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return v(E.finallyLoc)}}}},abrupt:function(l,s){for(var v=this.tryEntries.length-1;v>=0;--v){var $=this.tryEntries[v];if($.tryLoc<=this.prev&&n.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,S):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),S},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.finallyLoc===l)return this.complete(v.completion,v.afterLoc),At(v),S}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.tryLoc===l){var $=v.completion;if($.type==="throw"){var E=$.arg;At(v)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,v){return this.delegate={iterator:ht(l),resultName:s,nextLoc:v},this.method==="next"&&(this.arg=void 0),S}},t}function __asyncGeneratorStep_126(t,e,n,r,o,f,d){try{var h=t[f](d),y=h.value}catch(F){return void n(F)}h.done?e(y):Promise.resolve(y).then(r,o)}function ___asyncToGenerator_126(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var f=t.apply(e,n);function d(y){__asyncGeneratorStep_126(f,r,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_126(f,r,o,d,h,"throw",y)}d(void 0)})}}function previewFile(t,e){return _previewFile.apply(this,arguments)}function _previewFile(){return(_previewFile=___asyncToGenerator_126(___regeneratorRuntime_126().mark(function t(e,n){var r,o,f,d,h,y,F,S,T;return ___regeneratorRuntime_126().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(U.prev=0,(o=e.body).source!=="local"||["localFirst","remoteFirst"].includes(o.mergeSources)){U.next=6;break}f=o.content,U.next=13;break;case 6:return d={},U.next=9,Promise.all(o.url.split(/[\r\n]+/).map(function(M){return M.trim()}).filter(function(M){return M.length}).map(function(){var M=___asyncToGenerator_126(___regeneratorRuntime_126().mark(function Y(Z){return ___regeneratorRuntime_126().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.prev=0,D.next=3,(0,___download_126.default)(Z,o.ua);case 3:return D.abrupt("return",D.sent);case 6:return D.prev=6,D.t0=D.catch(0),d[Z]=D.t0,___app_126.default.error("\u6587\u4EF6 ".concat(o.name," \u7684\u8FDC\u7A0B\u6587\u4EF6 ").concat(Z," \u53D1\u751F\u9519\u8BEF: ").concat(D.t0)),D.abrupt("return","");case 11:case"end":return D.stop()}},Y,null,[[0,6]])}));return function(Y){return M.apply(this,arguments)}}()));case 9:if(f=U.sent,o.ignoreFailedRemoteFile||!(Object.keys(d).length>0)){U.next=12;break}throw new Error("\u6587\u4EF6 ".concat(o.name," \u7684\u8FDC\u7A0B\u6587\u4EF6 ").concat(Object.keys(d).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 12:o.mergeSources==="localFirst"?f.unshift(o.content):o.mergeSources==="remoteFirst"&&f.push(o.content);case 13:if(h=(Array.isArray(f)?f:[f]).flat(),y=h.filter(function(M){return M!=null&&M!==""}).join(`
`),!(Array.isArray(o.process)&&o.process.length>0)){U.next=21;break}return U.next=18,___proxyUtils_126.ProxyUtils.process({$files:h,$content:y,$file:o},o.process);case 18:U.t0=U.sent,U.next=22;break;case 21:U.t0={$content:y,$files:h};case 22:F=U.t0,(0,_$response_127.success)(n,{original:y,processed:(r=F?.$content)!==null&&r!==void 0?r:""}),U.next=30;break;case 26:U.prev=26,U.t1=U.catch(0),___app_126.default.error((S=U.t1.message)!==null&&S!==void 0?S:U.t1),(0,_$response_127.failed)(n,new _$errors_119.InternalServerError("INTERNAL_SERVER_ERROR","Failed to preview file","Reason: ".concat((T=U.t1.message)!==null&&T!==void 0?T:U.t1)));case 30:case"end":return U.stop()}},t,null,[[0,26]])}))).apply(this,arguments)}function compareSub(t,e){return _compareSub.apply(this,arguments)}function _compareSub(){return(_compareSub=___asyncToGenerator_126(___regeneratorRuntime_126().mark(function t(e,n){var r,o,f,d,h,y,F,S;return ___regeneratorRuntime_126().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(T.prev=0,r=e.body,o=e.query.target||"JSON",r.source!=="local"||["localFirst","remoteFirst"].includes(r.mergeSources)){T.next=7;break}f=r.content,T.next=14;break;case 7:return d={},T.next=10,Promise.all(r.url.split(/[\r\n]+/).map(function(U){return U.trim()}).filter(function(U){return U.length}).map(function(){var U=___asyncToGenerator_126(___regeneratorRuntime_126().mark(function M(Y){return ___regeneratorRuntime_126().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.prev=0,Z.next=3,(0,___download_126.default)(Y,r.ua,void 0,r.proxy,void 0,void 0,void 0,!0);case 3:return Z.abrupt("return",Z.sent);case 6:return Z.prev=6,Z.t0=Z.catch(0),d[Y]=Z.t0,___app_126.default.error("\u8BA2\u9605 ".concat(r.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(Y," \u53D1\u751F\u9519\u8BEF: ").concat(Z.t0)),Z.abrupt("return","");case 11:case"end":return Z.stop()}},M,null,[[0,6]])}));return function(M){return U.apply(this,arguments)}}()));case 10:if(f=T.sent,r.ignoreFailedRemoteSub||!(Object.keys(d).length>0)){T.next=13;break}throw new Error("\u8BA2\u9605 ".concat(r.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(Object.keys(d).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 13:r.mergeSources==="localFirst"?f.unshift(r.content):r.mergeSources==="remoteFirst"&&f.push(r.content);case 14:return(h=(Array.isArray(f)?f:[f]).map(function(U){return ___proxyUtils_126.ProxyUtils.parse(U)}).flat()).forEach(function(U,M){U.id=M,U._subName=r.name,U._subDisplayName=r.displayName}),T.next=18,___proxyUtils_126.ProxyUtils.process(h,r.process||[],o,___defineProperty_126({},r.name,r));case 18:y=T.sent,(0,_$response_127.success)(n,{original:h,processed:y}),T.next=26;break;case 22:T.prev=22,T.t0=T.catch(0),___app_126.default.error((F=T.t0.message)!==null&&F!==void 0?F:T.t0),(0,_$response_127.failed)(n,new _$errors_119.InternalServerError("INTERNAL_SERVER_ERROR","Failed to preview subscription","Reason: ".concat((S=T.t0.message)!==null&&S!==void 0?S:T.t0)));case 26:case"end":return T.stop()}},t,null,[[0,22]])}))).apply(this,arguments)}function compareCollection(t,e){return _compareCollection.apply(this,arguments)}function _compareCollection(){return(_compareCollection=___asyncToGenerator_126(___regeneratorRuntime_126().mark(function t(e,n){var r,o,f,d,h,y,F,S,T,U;return ___regeneratorRuntime_126().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.prev=0,r=___app_126.default.read(_$constants_86.SUBS_KEY),o=e.body,f=___toConsumableArray_126(o.subscriptions),d=o.subscriptionTags,Array.isArray(d)&&d.length>0&&r.forEach(function(Y){Array.isArray(Y.tag)&&Y.tag.length>0&&!f.includes(Y.name)&&Y.tag.some(function(Z){return d.includes(Z)})&&f.push(Y.name)}),h={},y={},M.next=10,Promise.all(f.map(function(){var Y=___asyncToGenerator_126(___regeneratorRuntime_126().mark(function Z(D){var nt,ct,at,et,mt;return ___regeneratorRuntime_126().wrap(function(At){for(;;)switch(At.prev=At.next){case 0:if(nt=(0,_$database_133.findByName)(r,D),At.prev=1,nt.source!=="local"||["localFirst","remoteFirst"].includes(nt.mergeSources)){At.next=6;break}at=nt.content,At.next=13;break;case 6:return et={},At.next=9,Promise.all(nt.url.split(/[\r\n]+/).map(function(dt){return dt.trim()}).filter(function(dt){return dt.length}).map(function(){var dt=___asyncToGenerator_126(___regeneratorRuntime_126().mark(function ht(xt){return ___regeneratorRuntime_126().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,(0,___download_126.default)(xt,nt.ua,void 0,nt.proxy,void 0,void 0,void 0,!0);case 3:return l.abrupt("return",l.sent);case 6:return l.prev=6,l.t0=l.catch(0),et[xt]=l.t0,___app_126.default.error("\u8BA2\u9605 ".concat(nt.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(xt," \u53D1\u751F\u9519\u8BEF: ").concat(l.t0)),l.abrupt("return","");case 11:case"end":return l.stop()}},ht,null,[[0,6]])}));return function(ht){return dt.apply(this,arguments)}}()));case 9:if(at=At.sent,nt.ignoreFailedRemoteSub||!(Object.keys(et).length>0)){At.next=12;break}throw new Error("\u8BA2\u9605 ".concat(nt.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(Object.keys(et).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 12:nt.mergeSources==="localFirst"?at.unshift(nt.content):nt.mergeSources==="remoteFirst"&&at.push(nt.content);case 13:return(mt=(Array.isArray(at)?at:[at]).map(function(dt){return ___proxyUtils_126.ProxyUtils.parse(dt)}).flat()).forEach(function(dt){dt._subName=nt.name,dt._subDisplayName=nt.displayName,dt._collectionName=o.name,dt._collectionDisplayName=o.displayName}),At.next=17,___proxyUtils_126.ProxyUtils.process(mt,nt.process||[],"JSON",(___defineProperty_126(ct={},nt.name,nt),___defineProperty_126(ct,"_collection",o),ct));case 17:mt=At.sent,h[D]=mt,At.next=25;break;case 21:At.prev=21,At.t0=At.catch(1),y[D]=At.t0,___app_126.default.error("\u274C \u5904\u7406\u7EC4\u5408\u8BA2\u9605 ".concat(o.name," \u4E2D\u7684\u5B50\u8BA2\u9605: ").concat(nt.name,"\u65F6\u51FA\u73B0\u9519\u8BEF\uFF1A").concat(At.t0,"\uFF01"));case 25:case"end":return At.stop()}},Z,null,[[1,21]])}));return function(Z){return Y.apply(this,arguments)}}()));case 10:if(o.ignoreFailedRemoteSub||!(Object.keys(y).length>0)){M.next=12;break}throw new Error("\u7EC4\u5408\u8BA2\u9605 ".concat(o.name," \u4E2D\u7684\u5B50\u8BA2\u9605 ").concat(Object.keys(y).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 12:return(F=Array.prototype.concat.apply([],f.map(function(Y){return h[Y]||[]}))).forEach(function(Y,Z){Y.id=Z,Y._collectionName=o.name,Y._collectionDisplayName=o.displayName}),M.next=16,___proxyUtils_126.ProxyUtils.process(F,o.process||[],"JSON",{_collection:o});case 16:S=M.sent,(0,_$response_127.success)(n,{original:F,processed:S}),M.next=24;break;case 20:M.prev=20,M.t0=M.catch(0),___app_126.default.error((T=M.t0.message)!==null&&T!==void 0?T:M.t0),(0,_$response_127.failed)(n,new _$errors_119.InternalServerError("INTERNAL_SERVER_ERROR","Failed to preview collection","Reason: ".concat((U=M.t0.message)!==null&&U!==void 0?U:M.t0)));case 24:case"end":return M.stop()}},t,null,[[0,20]])}))).apply(this,arguments)}var _$sort_129={};Object.defineProperty(_$sort_129,"__esModule",{value:!0}),_$sort_129.default=function(t){t.post("/api/sort/subs",sortSubs),t.post("/api/sort/collections",sortCollections),t.post("/api/sort/artifacts",sortArtifacts),t.post("/api/sort/files",sortFiles)};var __obj_129,___app_129=(__obj_129=_$app_87)&&__obj_129.__esModule?__obj_129:{default:__obj_129};function sortSubs(t,e){var n=t.body,r=___app_129.default.read(_$constants_86.SUBS_KEY);r.sort(function(o,f){return n.indexOf(o.name)-n.indexOf(f.name)}),___app_129.default.write(r,_$constants_86.SUBS_KEY),(0,_$response_127.success)(e,r)}function sortCollections(t,e){var n=t.body,r=___app_129.default.read(_$constants_86.COLLECTIONS_KEY);r.sort(function(o,f){return n.indexOf(o.name)-n.indexOf(f.name)}),___app_129.default.write(r,_$constants_86.COLLECTIONS_KEY),(0,_$response_127.success)(e,r)}function sortArtifacts(t,e){var n=t.body,r=___app_129.default.read(_$constants_86.ARTIFACTS_KEY);r.sort(function(o,f){return n.indexOf(o.name)-n.indexOf(f.name)}),___app_129.default.write(r,_$constants_86.ARTIFACTS_KEY),(0,_$response_127.success)(e,r)}function sortFiles(t,e){var n=t.body,r=___app_129.default.read(_$constants_86.FILES_KEY);r.sort(function(o,f){return n.indexOf(o.name)-n.indexOf(f.name)}),___app_129.default.write(r,_$constants_86.FILES_KEY),(0,_$response_127.success)(e,r)}var _$nodeInfo_124={};Object.defineProperty(_$nodeInfo_124,"__esModule",{value:!0}),_$nodeInfo_124.default=function(t){t.post("/api/utils/node-info",getNodeInfo)};var __obj_124,___producers_124=(__obj_124=_$producers_99)&&__obj_124.__esModule?__obj_124:{default:__obj_124};function ___typeof_124(t){return(___typeof_124=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function ___regeneratorRuntime_124(){___regeneratorRuntime_124=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=typeof Symbol=="function"?Symbol:{},o=r.iterator||"@@iterator",f=r.asyncIterator||"@@asyncIterator",d=r.toStringTag||"@@toStringTag";function h(l,s,v){return Object.defineProperty(l,s,{value:v,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,v,$){return s[v]=$}}function y(l,s,v,$){var E=s&&s.prototype instanceof T?s:T,rt=Object.create(E.prototype),gt=new dt($||[]);return rt._invoke=function(Et,Ct,x){var N="suspendedStart";return function(G,A){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(G==="throw")throw A;return{value:void 0,done:!0}}for(x.method=G,x.arg=A;;){var C=x.delegate;if(C){var j=et(C,x);if(j){if(j===S)continue;return j}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var K=F(Et,Ct,x);if(K.type==="normal"){if(N=x.done?"completed":"suspendedYield",K.arg===S)continue;return{value:K.arg,done:x.done}}K.type==="throw"&&(N="completed",x.method="throw",x.arg=K.arg)}}}(l,v,gt),rt}function F(l,s,v){try{return{type:"normal",arg:l.call(s,v)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var S={};function T(){}function U(){}function M(){}var Y={};h(Y,o,function(){return this});var Z=Object.getPrototypeOf,D=Z&&Z(Z(ht([])));D&&D!==e&&n.call(D,o)&&(Y=D);var nt=M.prototype=T.prototype=Object.create(Y);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(v){return this._invoke(s,v)})})}function at(l,s){var v;this._invoke=function($,E){function rt(){return new s(function(gt,Et){(function Ct(x,N,G,A){var C=F(l[x],l,N);if(C.type!=="throw"){var j=C.arg,K=j.value;return K&&___typeof_124(K)=="object"&&n.call(K,"__await")?s.resolve(K.__await).then(function(J){Ct("next",J,G,A)},function(J){Ct("throw",J,G,A)}):s.resolve(K).then(function(J){j.value=J,G(j)},function(J){return Ct("throw",J,G,A)})}A(C.arg)})($,E,gt,Et)})}return v=v?v.then(rt,rt):rt()}}function et(l,s){var v=l.iterator[s.method];if(v===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,et(l,s),s.method==="throw"))return S;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var $=F(v,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,S;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,S):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,S)}function mt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function At(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function dt(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(mt,this),this.reset(!0)}function ht(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var v=-1,$=function E(){for(;++v<l.length;)if(n.call(l,v))return E.value=l[v],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:xt}}function xt(){return{value:void 0,done:!0}}return U.prototype=M,h(nt,"constructor",M),h(M,"constructor",U),U.displayName=h(M,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===U||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,M):(l.__proto__=M,h(l,d,"GeneratorFunction")),l.prototype=Object.create(nt),l},t.awrap=function(l){return{__await:l}},ct(at.prototype),h(at.prototype,f,function(){return this}),t.AsyncIterator=at,t.async=function(l,s,v,$,E){E===void 0&&(E=Promise);var rt=new at(y(l,s,v,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(gt){return gt.done?gt.value:rt.next()})},ct(nt),h(nt,d,"Generator"),h(nt,o,function(){return this}),h(nt,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var v in l)s.push(v);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=ht,dt.prototype={constructor:dt,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(At),!l)for(var s in this)s.charAt(0)==="t"&&n.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function v(Ct,x){return rt.type="throw",rt.arg=l,s.next=Ct,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return v("end");if(E.tryLoc<=this.prev){var gt=n.call(E,"catchLoc"),Et=n.call(E,"finallyLoc");if(gt&&Et){if(this.prev<E.catchLoc)return v(E.catchLoc,!0);if(this.prev<E.finallyLoc)return v(E.finallyLoc)}else if(gt){if(this.prev<E.catchLoc)return v(E.catchLoc,!0)}else{if(!Et)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return v(E.finallyLoc)}}}},abrupt:function(l,s){for(var v=this.tryEntries.length-1;v>=0;--v){var $=this.tryEntries[v];if($.tryLoc<=this.prev&&n.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,S):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),S},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.finallyLoc===l)return this.complete(v.completion,v.afterLoc),At(v),S}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.tryLoc===l){var $=v.completion;if($.type==="throw"){var E=$.arg;At(v)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,v){return this.delegate={iterator:ht(l),resultName:s,nextLoc:v},this.method==="next"&&(this.arg=void 0),S}},t}function __asyncGeneratorStep_124(t,e,n,r,o,f,d){try{var h=t[f](d),y=h.value}catch(F){return void n(F)}h.done?e(y):Promise.resolve(y).then(r,o)}function getNodeInfo(t,e){return _getNodeInfo.apply(this,arguments)}function _getNodeInfo(){var t;return t=___regeneratorRuntime_124().mark(function e(n,r){var o,f,d,h,y;return ___regeneratorRuntime_124().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:o=n.body,f=n.query.lang||"zh-CN";try{d=___producers_124.default.URI.produce(o)}catch{}return F.prev=3,h=(0,_$openApi_151.HTTP)(),F.next=7,h.get({url:"http://ip-api.com/json/".concat(encodeURIComponent("".concat(o.server).trim().replace(/^\[/,"").replace(/\]$/,"")),"?lang=").concat(f),headers:{"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 12_4) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Safari/605.1.15"}}).then(function(S){var T=JSON.parse(S.body);if(T.status!=="success")throw new Error(T.message);return delete T.status,T});case 7:y=F.sent,(0,_$response_127.success)(r,{shareUrl:d,info:y}),F.next=14;break;case 11:F.prev=11,F.t0=F.catch(3),(0,_$response_127.failed)(r,new _$errors_119.NetworkError("FAILED_TO_GET_NODE_INFO","Failed to get node info","Reason: ".concat(F.t0)));case 14:case"end":return F.stop()}},e,null,[[3,11]])}),(_getNodeInfo=function(){var e=this,n=arguments;return new Promise(function(r,o){var f=t.apply(e,n);function d(y){__asyncGeneratorStep_124(f,r,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_124(f,r,o,d,h,"throw",y)}d(void 0)})}).apply(this,arguments)}var _$parser_125={};Object.defineProperty(_$parser_125,"__esModule",{value:!0}),_$parser_125.default=function(t){t.route("/api/proxy/parse").post(proxy_parser),t.route("/api/rule/parse").post(rule_parser)};var ___proxyUtils_125=_$proxyUtils_88({});function proxy_parser(t,e){var n=t.body,r=n.data,o=n.client,f=n.content,d=n.platform,h={};try{var y=___proxyUtils_125.ProxyUtils.parse(r??f),F=___proxyUtils_125.ProxyUtils.produce(y,o??d);h.par_res=F}catch(S){return void(0,_$response_127.failed)(e,S)}(0,_$response_127.success)(e,h)}function rule_parser(t,e){var n=t.body,r=n.data,o=n.client,f=n.content,d=n.platform,h={};try{var y=_$ruleUtils_111.RuleUtils.parse(r??f),F=_$ruleUtils_111.RuleUtils.produce(y,o??d);h.par_res=F}catch(S){return void(0,_$response_127.failed)(e,S)}(0,_$response_127.success)(e,h)}var _$restful_121={};(function(__dirname){(function(){"use strict";function _typeof(t){return(_typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$restful_121,"__esModule",{value:!0}),_$restful_121.default=serve;var _express=_interopRequireDefault(_$express_149),_app=_interopRequireDefault(_$app_87),_migration=_interopRequireDefault(_$migration_143),_download=_interopRequireDefault(_$download_135),_sync=_interopRequireWildcard(_$sync_131({})),_miscs=_interopRequireWildcard(_$miscs_122),_subscriptions=_interopRequireDefault(_$subscriptions_130),_collections=_interopRequireDefault(_$collections_117),_artifacts=_interopRequireDefault(_$artifacts_116),_file=_interopRequireDefault(_$file_120),_token=_interopRequireDefault(_$token_132),_module=_interopRequireDefault(_$module_123),_download2=_interopRequireDefault(_$download_118),_settings=_interopRequireDefault(_$settings_128),_preview=_interopRequireDefault(_$preview_126),_sort=_interopRequireDefault(_$sort_129),_nodeInfo=_interopRequireDefault(_$nodeInfo_124),_parser=_interopRequireDefault(_$parser_125);function _getRequireWildcardCache(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(r){return r?n:e})(t)}function _interopRequireWildcard(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||_typeof(t)!=="object"&&typeof t!="function")return{default:t};var n=_getRequireWildcardCache(e);if(n&&n.has(t))return n.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var d=o?Object.getOwnPropertyDescriptor(t,f):null;d&&(d.get||d.set)?Object.defineProperty(r,f,d):r[f]=t[f]}return r.default=t,n&&n.set(t,r),r}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=typeof Symbol=="function"?Symbol:{},o=r.iterator||"@@iterator",f=r.asyncIterator||"@@asyncIterator",d=r.toStringTag||"@@toStringTag";function h(l,s,v){return Object.defineProperty(l,s,{value:v,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,v,$){return s[v]=$}}function y(l,s,v,$){var E=s&&s.prototype instanceof T?s:T,rt=Object.create(E.prototype),gt=new dt($||[]);return rt._invoke=function(Et,Ct,x){var N="suspendedStart";return function(G,A){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(G==="throw")throw A;return{value:void 0,done:!0}}for(x.method=G,x.arg=A;;){var C=x.delegate;if(C){var j=et(C,x);if(j){if(j===S)continue;return j}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var K=F(Et,Ct,x);if(K.type==="normal"){if(N=x.done?"completed":"suspendedYield",K.arg===S)continue;return{value:K.arg,done:x.done}}K.type==="throw"&&(N="completed",x.method="throw",x.arg=K.arg)}}}(l,v,gt),rt}function F(l,s,v){try{return{type:"normal",arg:l.call(s,v)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var S={};function T(){}function U(){}function M(){}var Y={};h(Y,o,function(){return this});var Z=Object.getPrototypeOf,D=Z&&Z(Z(ht([])));D&&D!==e&&n.call(D,o)&&(Y=D);var nt=M.prototype=T.prototype=Object.create(Y);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(v){return this._invoke(s,v)})})}function at(l,s){var v;this._invoke=function($,E){function rt(){return new s(function(gt,Et){(function Ct(x,N,G,A){var C=F(l[x],l,N);if(C.type!=="throw"){var j=C.arg,K=j.value;return K&&_typeof(K)=="object"&&n.call(K,"__await")?s.resolve(K.__await).then(function(J){Ct("next",J,G,A)},function(J){Ct("throw",J,G,A)}):s.resolve(K).then(function(J){j.value=J,G(j)},function(J){return Ct("throw",J,G,A)})}A(C.arg)})($,E,gt,Et)})}return v=v?v.then(rt,rt):rt()}}function et(l,s){var v=l.iterator[s.method];if(v===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,et(l,s),s.method==="throw"))return S;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var $=F(v,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,S;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,S):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,S)}function mt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function At(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function dt(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(mt,this),this.reset(!0)}function ht(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var v=-1,$=function E(){for(;++v<l.length;)if(n.call(l,v))return E.value=l[v],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:xt}}function xt(){return{value:void 0,done:!0}}return U.prototype=M,h(nt,"constructor",M),h(M,"constructor",U),U.displayName=h(M,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===U||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,M):(l.__proto__=M,h(l,d,"GeneratorFunction")),l.prototype=Object.create(nt),l},t.awrap=function(l){return{__await:l}},ct(at.prototype),h(at.prototype,f,function(){return this}),t.AsyncIterator=at,t.async=function(l,s,v,$,E){E===void 0&&(E=Promise);var rt=new at(y(l,s,v,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(gt){return gt.done?gt.value:rt.next()})},ct(nt),h(nt,d,"Generator"),h(nt,o,function(){return this}),h(nt,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var v in l)s.push(v);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=ht,dt.prototype={constructor:dt,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(At),!l)for(var s in this)s.charAt(0)==="t"&&n.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function v(Ct,x){return rt.type="throw",rt.arg=l,s.next=Ct,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return v("end");if(E.tryLoc<=this.prev){var gt=n.call(E,"catchLoc"),Et=n.call(E,"finallyLoc");if(gt&&Et){if(this.prev<E.catchLoc)return v(E.catchLoc,!0);if(this.prev<E.finallyLoc)return v(E.finallyLoc)}else if(gt){if(this.prev<E.catchLoc)return v(E.catchLoc,!0)}else{if(!Et)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return v(E.finallyLoc)}}}},abrupt:function(l,s){for(var v=this.tryEntries.length-1;v>=0;--v){var $=this.tryEntries[v];if($.tryLoc<=this.prev&&n.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,S):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),S},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.finallyLoc===l)return this.complete(v.completion,v.afterLoc),At(v),S}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var v=this.tryEntries[s];if(v.tryLoc===l){var $=v.completion;if($.type==="throw"){var E=$.arg;At(v)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,v){return this.delegate={iterator:ht(l),resultName:s,nextLoc:v},this.method==="next"&&(this.arg=void 0),S}},t}function asyncGeneratorStep(t,e,n,r,o,f,d){try{var h=t[f](d),y=h.value}catch(F){return void n(F)}h.done?e(y):Promise.resolve(y).then(r,o)}function _asyncToGenerator(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var f=t.apply(e,n);function d(y){asyncGeneratorStep(f,r,o,d,h,"next",y)}function h(y){asyncGeneratorStep(f,r,o,d,h,"throw",y)}d(void 0)})}}function serve(){var port,host;_app.default.env.isNode&&(port=eval("process.env.SUB_STORE_BACKEND_API_PORT")||3e3,host=eval("process.env.SUB_STORE_BACKEND_API_HOST")||"::");var $app=(0,_express.default)({substore:_app.default,port,host});if((0,_collections.default)($app),(0,_subscriptions.default)($app),(0,_download2.default)($app),(0,_preview.default)($app),(0,_sort.default)($app),(0,_settings.default)($app),(0,_artifacts.default)($app),(0,_file.default)($app),(0,_token.default)($app),(0,_module.default)($app),(0,_sync.default)($app),(0,_nodeInfo.default)($app),(0,_miscs.default)($app),(0,_parser.default)($app),$app.start(),_app.default.env.isNode){var backend_sync_cron=eval("process.env.SUB_STORE_BACKEND_SYNC_CRON")||eval("process.env.SUB_STORE_BACKEND_CRON");if(backend_sync_cron){_app.default.info("[SYNC CRON] ".concat(backend_sync_cron," enabled"));var _eval=require("cron"),CronJob=_eval.CronJob;new CronJob(backend_sync_cron,_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e;return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,_app.default.info("[SYNC CRON] ".concat(backend_sync_cron," started")),n.next=4,(0,_sync.syncArtifacts)();case 4:_app.default.info("[SYNC CRON] ".concat(backend_sync_cron," finished")),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),_app.default.error("[SYNC CRON] ".concat(backend_sync_cron," error: ").concat((e=n.t0.message)!==null&&e!==void 0?e:n.t0));case 10:case"end":return n.stop()}},t,null,[[0,7]])})),null,!0)}var backend_download_cron=eval("process.env.SUB_STORE_BACKEND_DOWNLOAD_CRON");if(backend_download_cron){_app.default.info("[DOWNLOAD CRON] ".concat(backend_download_cron," enabled"));var _eval2=require("cron"),_CronJob=_eval2.CronJob;new _CronJob(backend_download_cron,_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e;return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,_app.default.info("[DOWNLOAD CRON] ".concat(backend_download_cron," started")),n.next=4,(0,_miscs.gistBackupAction)("download");case 4:_app.default.info("[DOWNLOAD CRON] ".concat(backend_download_cron," finished")),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),_app.default.error("[DOWNLOAD CRON] ".concat(backend_download_cron," error: ").concat((e=n.t0.message)!==null&&e!==void 0?e:n.t0));case 10:case"end":return n.stop()}},t,null,[[0,7]])})),null,!0)}var backend_upload_cron=eval("process.env.SUB_STORE_BACKEND_UPLOAD_CRON");if(backend_upload_cron){_app.default.info("[UPLOAD CRON] ".concat(backend_upload_cron," enabled"));var _eval3=require("cron"),_CronJob2=_eval3.CronJob;new _CronJob2(backend_upload_cron,_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e;return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,_app.default.info("[UPLOAD CRON] ".concat(backend_upload_cron," started")),n.next=4,(0,_miscs.gistBackupAction)("upload");case 4:_app.default.info("[UPLOAD CRON] ".concat(backend_upload_cron," finished")),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),_app.default.error("[UPLOAD CRON] ".concat(backend_upload_cron," error: ").concat((e=n.t0.message)!==null&&e!==void 0?e:n.t0));case 10:case"end":return n.stop()}},t,null,[[0,7]])})),null,!0)}var path=require("path"),fs=require("fs"),data_url=eval("process.env.SUB_STORE_DATA_URL"),fe_be_path=eval("process.env.SUB_STORE_FRONTEND_BACKEND_PATH"),fe_port=eval("process.env.SUB_STORE_FRONTEND_PORT")||3001,fe_host=eval("process.env.SUB_STORE_FRONTEND_HOST")||host||"::",fe_path=eval("process.env.SUB_STORE_FRONTEND_PATH"),fe_abs_path=path.resolve(fe_path||path.join(__dirname,"frontend"));if(fe_path){try{fs.accessSync(path.join(fe_abs_path,"index.html"))}catch{_app.default.error("[FRONTEND] index.html file not found in ".concat(fe_abs_path))}var express_=require("express"),history=require("connect-history-api-fallback"),_eval4=require("http-proxy-middleware"),createProxyMiddleware=_eval4.createProxyMiddleware,app=express_(),staticFileMiddleware=express_.static(fe_path),be_share_rewrite="/share/:type/:name",be_api_rewrite="",be_download_rewrite="",be_api="/api/",be_download="/download/";if(fe_be_path){if(!fe_be_path.startsWith("/"))throw new Error("SUB_STORE_FRONTEND_BACKEND_PATH should start with /");be_api_rewrite="".concat(fe_be_path==="/"?"":fe_be_path).concat(be_api),be_download_rewrite="".concat(fe_be_path==="/"?"":fe_be_path).concat(be_download),app.use(be_share_rewrite,createProxyMiddleware({target:"http://127.0.0.1:".concat(port),changeOrigin:!0,pathRewrite:function(t,e){if(e.method.toLowerCase()!=="get")throw new Error("Method not allowed");if(!(_app.default.read(_$constants_86.TOKENS_KEY)||[]).find(function(n){return n.token===e.query.token&&n.type===e.params.type&&n.name===e.params.name&&(n.exp==null||n.exp>Date.now())}))throw new Error("Forbbiden");return t}})),app.use(be_api_rewrite,createProxyMiddleware({target:"http://127.0.0.1:".concat(port),pathRewrite:function(t){var e=t.startsWith(be_api_rewrite)?t.replace(be_api_rewrite,be_api):t;return e.includes("?")?"".concat(e,"&share=true"):"".concat(e,"?share=true")}})),app.use(be_download_rewrite,createProxyMiddleware({target:"http://127.0.0.1:".concat(port),changeOrigin:!0,pathRewrite:function(t){return t.startsWith(be_download_rewrite)?t.replace(be_download_rewrite,be_download):t}}))}app.use(staticFileMiddleware),app.use(history({disableDotRule:!0,verbose:!1})),app.use(staticFileMiddleware);var listener=app.listen(fe_port,fe_host,function(){var t=listener.address(),e=t.address,n=t.port;_app.default.info("[FRONTEND] ".concat(e,":").concat(n)),fe_be_path&&(_app.default.info("[FRONTEND -> BACKEND] ".concat(e,":").concat(n).concat(be_api_rewrite," -> http://127.0.0.1:").concat(port).concat(be_api)),_app.default.info("[FRONTEND -> BACKEND] ".concat(e,":").concat(n).concat(be_download_rewrite," -> http://127.0.0.1:").concat(port).concat(be_download)),_app.default.info("[SHARE BACKEND] ".concat(e,":").concat(n).concat(be_share_rewrite)))})}data_url&&(_app.default.info("[BACKEND] downloading data from ".concat(data_url)),(0,_download.default)(data_url).then(function(t){_app.default.write(t,"#sub-store"),_app.default.cache=JSON.parse(t),_app.default.persistCache(),(0,_migration.default)(),_app.default.info("[BACKEND] restored data from ".concat(data_url))}).catch(function(t){throw _app.default.error("[BACKEND] restore data failed"),t}))}}}).call(this)}).call(this,"/src/restful");var _$main_115={},___migration_115=___interopRequireDefault_115(_$migration_143),_restful=___interopRequireDefault_115(_$restful_121);function ___interopRequireDefault_115(t){return t&&t.__esModule?t:{default:t}}(0,___migration_115.default)(),(0,_restful.default)()})();
