// https://raw.githubusercontent.com/ElementRef/AboutConfig/main/script/peng.ym.sub.store.js
(function(){var createModuleFactory=function(t){var e;return function(r){return e||t(e={exports:{},parent:r},e.exports),e.exports}},_$sync_131=createModuleFactory(function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(ft){r.default.read(_$constants_86.ARTIFACTS_KEY)||r.default.write({},_$constants_86.ARTIFACTS_KEY),ft.get("/api/sync/artifacts",ot),ft.get("/api/sync/artifact/:name",gt)},e.produceArtifact=Z,e.syncArtifacts=at;var r=f(_$app_87),n=f(_$download_135),o=_$proxyUtils_88({});function f(ft){return ft&&ft.__esModule?ft:{default:ft}}function d(ft){return(d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(yt){return typeof yt}:function(yt){return yt&&typeof Symbol=="function"&&yt.constructor===Symbol&&yt!==Symbol.prototype?"symbol":typeof yt})(ft)}function h(ft){return function(yt){if(Array.isArray(yt))return A(yt)}(ft)||function(yt){if(typeof Symbol<"u"&&yt[Symbol.iterator]!=null||yt["@@iterator"]!=null)return Array.from(yt)}(ft)||k(ft)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function y(ft,yt){var Ct=typeof Symbol<"u"&&ft[Symbol.iterator]||ft["@@iterator"];if(!Ct){if(Array.isArray(ft)||(Ct=k(ft))||yt&&ft&&typeof ft.length=="number"){Ct&&(ft=Ct);var l=0,s=function(){};return{s,n:function(){return l>=ft.length?{done:!0}:{done:!1,value:ft[l++]}},e:function(rt){throw rt},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var b,$=!0,E=!1;return{s:function(){Ct=Ct.call(ft)},n:function(){var rt=Ct.next();return $=rt.done,rt},e:function(rt){E=!0,b=rt},f:function(){try{$||Ct.return==null||Ct.return()}finally{if(E)throw b}}}}function k(ft,yt){if(ft){if(typeof ft=="string")return A(ft,yt);var Ct=Object.prototype.toString.call(ft).slice(8,-1);return Ct==="Object"&&ft.constructor&&(Ct=ft.constructor.name),Ct==="Map"||Ct==="Set"?Array.from(ft):Ct==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ct)?A(ft,yt):void 0}}function A(ft,yt){(yt==null||yt>ft.length)&&(yt=ft.length);for(var Ct=0,l=new Array(yt);Ct<yt;Ct++)l[Ct]=ft[Ct];return l}function D(ft,yt,Ct){return yt in ft?Object.defineProperty(ft,yt,{value:Ct,enumerable:!0,configurable:!0,writable:!0}):ft[yt]=Ct,ft}function q(){q=function(){return ft};var ft={},yt=Object.prototype,Ct=yt.hasOwnProperty,l=typeof Symbol=="function"?Symbol:{},s=l.iterator||"@@iterator",b=l.asyncIterator||"@@asyncIterator",$=l.toStringTag||"@@toStringTag";function E(Xt,Gt,pe){return Object.defineProperty(Xt,Gt,{value:pe,enumerable:!0,configurable:!0,writable:!0}),Xt[Gt]}try{E({},"")}catch{E=function(Gt,pe,ge){return Gt[pe]=ge}}function rt(Xt,Gt,pe,ge){var Dt=Gt&&Gt.prototype instanceof St?Gt:St,Nt=Object.create(Dt.prototype),ie=new _e(ge||[]);return Nt._invoke=function(ee,Kt,be){var v="suspendedStart";return function(Be,ce){if(v==="executing")throw new Error("Generator is already running");if(v==="completed"){if(Be==="throw")throw ce;return{value:void 0,done:!0}}for(be.method=Be,be.arg=ce;;){var Vt=be.delegate;if(Vt){var ze=Pt(Vt,be);if(ze){if(ze===xt)continue;return ze}}if(be.method==="next")be.sent=be._sent=be.arg;else if(be.method==="throw"){if(v==="suspendedStart")throw v="completed",be.arg;be.dispatchException(be.arg)}else be.method==="return"&&be.abrupt("return",be.arg);v="executing";var We=_t(ee,Kt,be);if(We.type==="normal"){if(v=be.done?"completed":"suspendedYield",We.arg===xt)continue;return{value:We.arg,done:be.done}}We.type==="throw"&&(v="completed",be.method="throw",be.arg=We.arg)}}}(Xt,pe,ie),Nt}function _t(Xt,Gt,pe){try{return{type:"normal",arg:Xt.call(Gt,pe)}}catch(ge){return{type:"throw",arg:ge}}}ft.wrap=rt;var xt={};function St(){}function x(){}function N(){}var V={};E(V,s,function(){return this});var S=Object.getPrototypeOf,C=S&&S(S(me([])));C&&C!==yt&&Ct.call(C,s)&&(V=C);var T=N.prototype=St.prototype=Object.create(V);function M(Xt){["next","throw","return"].forEach(function(Gt){E(Xt,Gt,function(pe){return this._invoke(Gt,pe)})})}function et(Xt,Gt){var pe;this._invoke=function(ge,Dt){function Nt(){return new Gt(function(ie,ee){(function Kt(be,v,Be,ce){var Vt=_t(Xt[be],Xt,v);if(Vt.type!=="throw"){var ze=Vt.arg,We=ze.value;return We&&d(We)=="object"&&Ct.call(We,"__await")?Gt.resolve(We.__await).then(function(Je){Kt("next",Je,Be,ce)},function(Je){Kt("throw",Je,Be,ce)}):Gt.resolve(We).then(function(Je){ze.value=Je,Be(ze)},function(Je){return Kt("throw",Je,Be,ce)})}ce(Vt.arg)})(ge,Dt,ie,ee)})}return pe=pe?pe.then(Nt,Nt):Nt()}}function Pt(Xt,Gt){var pe=Xt.iterator[Gt.method];if(pe===void 0){if(Gt.delegate=null,Gt.method==="throw"){if(Xt.iterator.return&&(Gt.method="return",Gt.arg=void 0,Pt(Xt,Gt),Gt.method==="throw"))return xt;Gt.method="throw",Gt.arg=new TypeError("The iterator does not provide a 'throw' method")}return xt}var ge=_t(pe,Xt.iterator,Gt.arg);if(ge.type==="throw")return Gt.method="throw",Gt.arg=ge.arg,Gt.delegate=null,xt;var Dt=ge.arg;return Dt?Dt.done?(Gt[Xt.resultName]=Dt.value,Gt.next=Xt.nextLoc,Gt.method!=="return"&&(Gt.method="next",Gt.arg=void 0),Gt.delegate=null,xt):Dt:(Gt.method="throw",Gt.arg=new TypeError("iterator result is not an object"),Gt.delegate=null,xt)}function Ut(Xt){var Gt={tryLoc:Xt[0]};1 in Xt&&(Gt.catchLoc=Xt[1]),2 in Xt&&(Gt.finallyLoc=Xt[2],Gt.afterLoc=Xt[3]),this.tryEntries.push(Gt)}function Zt(Xt){var Gt=Xt.completion||{};Gt.type="normal",delete Gt.arg,Xt.completion=Gt}function _e(Xt){this.tryEntries=[{tryLoc:"root"}],Xt.forEach(Ut,this),this.reset(!0)}function me(Xt){if(Xt){var Gt=Xt[s];if(Gt)return Gt.call(Xt);if(typeof Xt.next=="function")return Xt;if(!isNaN(Xt.length)){var pe=-1,ge=function Dt(){for(;++pe<Xt.length;)if(Ct.call(Xt,pe))return Dt.value=Xt[pe],Dt.done=!1,Dt;return Dt.value=void 0,Dt.done=!0,Dt};return ge.next=ge}}return{next:de}}function de(){return{value:void 0,done:!0}}return x.prototype=N,E(T,"constructor",N),E(N,"constructor",x),x.displayName=E(N,$,"GeneratorFunction"),ft.isGeneratorFunction=function(Xt){var Gt=typeof Xt=="function"&&Xt.constructor;return!!Gt&&(Gt===x||(Gt.displayName||Gt.name)==="GeneratorFunction")},ft.mark=function(Xt){return Object.setPrototypeOf?Object.setPrototypeOf(Xt,N):(Xt.__proto__=N,E(Xt,$,"GeneratorFunction")),Xt.prototype=Object.create(T),Xt},ft.awrap=function(Xt){return{__await:Xt}},M(et.prototype),E(et.prototype,b,function(){return this}),ft.AsyncIterator=et,ft.async=function(Xt,Gt,pe,ge,Dt){Dt===void 0&&(Dt=Promise);var Nt=new et(rt(Xt,Gt,pe,ge),Dt);return ft.isGeneratorFunction(Gt)?Nt:Nt.next().then(function(ie){return ie.done?ie.value:Nt.next()})},M(T),E(T,$,"Generator"),E(T,s,function(){return this}),E(T,"toString",function(){return"[object Generator]"}),ft.keys=function(Xt){var Gt=[];for(var pe in Xt)Gt.push(pe);return Gt.reverse(),function ge(){for(;Gt.length;){var Dt=Gt.pop();if(Dt in Xt)return ge.value=Dt,ge.done=!1,ge}return ge.done=!0,ge}},ft.values=me,_e.prototype={constructor:_e,reset:function(Xt){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Zt),!Xt)for(var Gt in this)Gt.charAt(0)==="t"&&Ct.call(this,Gt)&&!isNaN(+Gt.slice(1))&&(this[Gt]=void 0)},stop:function(){this.done=!0;var Xt=this.tryEntries[0].completion;if(Xt.type==="throw")throw Xt.arg;return this.rval},dispatchException:function(Xt){if(this.done)throw Xt;var Gt=this;function pe(Kt,be){return Nt.type="throw",Nt.arg=Xt,Gt.next=Kt,be&&(Gt.method="next",Gt.arg=void 0),!!be}for(var ge=this.tryEntries.length-1;ge>=0;--ge){var Dt=this.tryEntries[ge],Nt=Dt.completion;if(Dt.tryLoc==="root")return pe("end");if(Dt.tryLoc<=this.prev){var ie=Ct.call(Dt,"catchLoc"),ee=Ct.call(Dt,"finallyLoc");if(ie&&ee){if(this.prev<Dt.catchLoc)return pe(Dt.catchLoc,!0);if(this.prev<Dt.finallyLoc)return pe(Dt.finallyLoc)}else if(ie){if(this.prev<Dt.catchLoc)return pe(Dt.catchLoc,!0)}else{if(!ee)throw new Error("try statement without catch or finally");if(this.prev<Dt.finallyLoc)return pe(Dt.finallyLoc)}}}},abrupt:function(Xt,Gt){for(var pe=this.tryEntries.length-1;pe>=0;--pe){var ge=this.tryEntries[pe];if(ge.tryLoc<=this.prev&&Ct.call(ge,"finallyLoc")&&this.prev<ge.finallyLoc){var Dt=ge;break}}Dt&&(Xt==="break"||Xt==="continue")&&Dt.tryLoc<=Gt&&Gt<=Dt.finallyLoc&&(Dt=null);var Nt=Dt?Dt.completion:{};return Nt.type=Xt,Nt.arg=Gt,Dt?(this.method="next",this.next=Dt.finallyLoc,xt):this.complete(Nt)},complete:function(Xt,Gt){if(Xt.type==="throw")throw Xt.arg;return Xt.type==="break"||Xt.type==="continue"?this.next=Xt.arg:Xt.type==="return"?(this.rval=this.arg=Xt.arg,this.method="return",this.next="end"):Xt.type==="normal"&&Gt&&(this.next=Gt),xt},finish:function(Xt){for(var Gt=this.tryEntries.length-1;Gt>=0;--Gt){var pe=this.tryEntries[Gt];if(pe.finallyLoc===Xt)return this.complete(pe.completion,pe.afterLoc),Zt(pe),xt}},catch:function(Xt){for(var Gt=this.tryEntries.length-1;Gt>=0;--Gt){var pe=this.tryEntries[Gt];if(pe.tryLoc===Xt){var ge=pe.completion;if(ge.type==="throw"){var Dt=ge.arg;Zt(pe)}return Dt}}throw new Error("illegal catch attempt")},delegateYield:function(Xt,Gt,pe){return this.delegate={iterator:me(Xt),resultName:Gt,nextLoc:pe},this.method==="next"&&(this.arg=void 0),xt}},ft}function H(ft,yt,Ct,l,s,b,$){try{var E=ft[b]($),rt=E.value}catch(_t){return void Ct(_t)}E.done?yt(rt):Promise.resolve(rt).then(l,s)}function z(ft){return function(){var yt=this,Ct=arguments;return new Promise(function(l,s){var b=ft.apply(yt,Ct);function $(rt){H(b,l,s,$,E,"next",rt)}function E(rt){H(b,l,s,$,E,"throw",rt)}$(void 0)})}}function Z(ft){return j.apply(this,arguments)}function j(){return(j=z(q().mark(function ft(yt){var Ct,l,s,b,$,E,rt,_t,xt,St,x,N,V,S,C,T,M,et,Pt,Ut,Zt,_e,me,de,Xt,Gt,pe,ge,Dt,Nt,ie,ee,Kt,be,v,Be,ce,Vt,ze,We,Je,nr,lr,ur,Me,Ke,Ir,Le,qr,hr,Sr,Jr,Kr,tr,Xe,Qe,an,Gr,Vr,Yr,Xr,sn;return q().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:if(Ct=yt.type,l=yt.name,s=yt.platform,b=yt.url,$=yt.ua,E=yt.content,rt=yt.mergeSources,_t=yt.ignoreFailedRemoteSub,xt=yt.ignoreFailedRemoteFile,St=yt.produceType,x=yt.produceOpts,N=x===void 0?{}:x,V=yt.subscription,S=yt.awaitCustomCache,C=yt.$options,T=yt.proxy,M=yt.noCache,s=s||"JSON",Ct!=="subscription"){se.next=74;break}if(!l){se.next=10;break}if(Pt=r.default.read(_$constants_86.SUBS_KEY),et=(0,_$database_133.findByName)(Pt,l)){se.next=8;break}throw new Error("\u627E\u4E0D\u5230\u8BA2\u9605 ".concat(l));case 8:se.next=15;break;case 10:if(!V){se.next=14;break}et=V,se.next=15;break;case 14:throw new Error("\u672A\u63D0\u4F9B\u8BA2\u9605\u540D\u79F0\u6216\u8BA2\u9605\u6570\u636E");case 15:if(!E||["localFirst","remoteFirst"].includes(rt)){se.next=19;break}Ut=E,se.next=44;break;case 19:if(!b){se.next=31;break}return Zt={},se.next=23,Promise.all(b.split(/[\r\n]+/).map(function(ye){return ye.trim()}).filter(function(ye){return ye.length}).map(function(){var ye=z(q().mark(function Re(ar){return q().wrap(function(he){for(;;)switch(he.prev=he.next){case 0:return he.prev=0,he.next=3,(0,n.default)(ar,$||et.ua,void 0,T||et.proxy,void 0,S,M);case 3:return he.abrupt("return",he.sent);case 6:return he.prev=6,he.t0=he.catch(0),Zt[ar]=he.t0,r.default.error("\u8BA2\u9605 ".concat(et.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(ar," \u53D1\u751F\u9519\u8BEF: ").concat(he.t0)),he.abrupt("return","");case 11:case"end":return he.stop()}},Re,null,[[0,6]])}));return function(Re){return ye.apply(this,arguments)}}()));case 23:if(Ut=se.sent,_e=et.ignoreFailedRemoteSub,_t!=null&&_t!==""&&(_e=_t),_e||!(Object.keys(Zt).length>0)){se.next=28;break}throw new Error("\u8BA2\u9605 ".concat(et.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(Object.keys(Zt).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 28:rt==="localFirst"?Ut.unshift(E):rt==="remoteFirst"&&Ut.push(E),se.next=44;break;case 31:if(et.source!=="local"||["localFirst","remoteFirst"].includes(et.mergeSources)){se.next=35;break}Ut=et.content,se.next=44;break;case 35:return me={},se.next=38,Promise.all(et.url.split(/[\r\n]+/).map(function(ye){return ye.trim()}).filter(function(ye){return ye.length}).map(function(){var ye=z(q().mark(function Re(ar){return q().wrap(function(he){for(;;)switch(he.prev=he.next){case 0:return he.prev=0,he.next=3,(0,n.default)(ar,$||et.ua,void 0,T||et.proxy,void 0,S,M);case 3:return he.abrupt("return",he.sent);case 6:return he.prev=6,he.t0=he.catch(0),me[ar]=he.t0,r.default.error("\u8BA2\u9605 ".concat(et.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(ar," \u53D1\u751F\u9519\u8BEF: ").concat(he.t0)),he.abrupt("return","");case 11:case"end":return he.stop()}},Re,null,[[0,6]])}));return function(Re){return ye.apply(this,arguments)}}()));case 38:if(Ut=se.sent,de=et.ignoreFailedRemoteSub,_t!=null&&_t!==""&&(de=_t),de||!(Object.keys(me).length>0)){se.next=43;break}throw new Error("\u8BA2\u9605 ".concat(et.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(Object.keys(me).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 43:et.mergeSources==="localFirst"?Ut.unshift(et.content):et.mergeSources==="remoteFirst"&&Ut.push(et.content);case 44:return(Xt=(Array.isArray(Ut)?Ut:[Ut]).map(function(ye){return o.ProxyUtils.parse(ye)}).flat()).forEach(function(ye){ye._subName=et.name,ye._subDisplayName=et.displayName}),se.next=48,o.ProxyUtils.process(Xt,et.process||[],s,D({},et.name,et),C);case 48:if((Xt=se.sent).length!==0){se.next=51;break}throw new Error("\u8BA2\u9605 ".concat(l," \u4E2D\u4E0D\u542B\u6709\u6548\u8282\u70B9"));case 51:Gt={},pe=y(Xt),se.prev=53,pe.s();case 55:if((ge=pe.n()).done){se.next=63;break}if(Dt=ge.value,!Gt[Dt.name]){se.next=60;break}return r.default.notify("\u{1F30D} Sub-Store","\u26A0\uFE0F \u8BA2\u9605 ".concat(l," \u5305\u542B\u91CD\u590D\u8282\u70B9 ").concat(Dt.name,"\uFF01"),"\u8BF7\u4ED4\u7EC6\u68C0\u6D4B\u914D\u7F6E\uFF01",{"media-url":"https://cdn3.iconfinder.com/data/icons/seo-outline-1/512/25_code_program_programming_develop_bug_search_developer-512.png"}),se.abrupt("break",63);case 60:Gt[Dt.name]=!0;case 61:se.next=55;break;case 63:se.next=68;break;case 65:se.prev=65,se.t0=se.catch(53),pe.e(se.t0);case 68:return se.prev=68,pe.f(),se.finish(68);case 71:return se.abrupt("return",o.ProxyUtils.produce(Xt,s,St,N));case 74:if(Ct!=="collection"){se.next=122;break}if(Nt=r.default.read(_$constants_86.SUBS_KEY),ie=r.default.read(_$constants_86.COLLECTIONS_KEY),ee=(0,_$database_133.findByName)(ie,l)){se.next=80;break}throw new Error("\u627E\u4E0D\u5230\u7EC4\u5408\u8BA2\u9605 ".concat(l));case 80:return Kt=h(ee.subscriptions),be=ee.subscriptionTags,Array.isArray(be)&&be.length>0&&Nt.forEach(function(ye){Array.isArray(ye.tag)&&ye.tag.length>0&&!Kt.includes(ye.name)&&ye.tag.some(function(Re){return be.includes(Re)})&&Kt.push(ye.name)}),v={},Be={},ce=0,se.next=88,Promise.all(Kt.map(function(){var ye=z(q().mark(function Re(ar){var he,Zr,Ar,un,or;return q().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:if(he=(0,_$database_133.findByName)(Nt,ar),J.prev=1,r.default.info("\u6B63\u5728\u5904\u7406\u5B50\u8BA2\u9605\uFF1A".concat(he.name,"...")),he.source!=="local"||["localFirst","remoteFirst"].includes(he.mergeSources)){J.next=7;break}Ar=he.content,J.next=16;break;case 7:return un={},J.next=10,Promise.all(he.url.split(/[\r\n]+/).map(function(xe){return xe.trim()}).filter(function(xe){return xe.length}).map(function(){var xe=z(q().mark(function Tr(gr){return q().wrap(function(Ge){for(;;)switch(Ge.prev=Ge.next){case 0:return Ge.prev=0,Ge.next=3,(0,n.default)(gr,he.ua,void 0,T||he.proxy||ee.proxy,void 0,void 0,M);case 3:return Ge.abrupt("return",Ge.sent);case 6:return Ge.prev=6,Ge.t0=Ge.catch(0),un[gr]=Ge.t0,r.default.error("\u8BA2\u9605 ".concat(he.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(gr," \u53D1\u751F\u9519\u8BEF: ").concat(Ge.t0)),Ge.abrupt("return","");case 11:case"end":return Ge.stop()}},Tr,null,[[0,6]])}));return function(Tr){return xe.apply(this,arguments)}}()));case 10:return J.next=12,J.sent;case 12:if(Ar=J.sent,he.ignoreFailedRemoteSub||!(Object.keys(un).length>0)){J.next=15;break}throw new Error("\u8BA2\u9605 ".concat(he.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(Object.keys(un).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 15:he.mergeSources==="localFirst"?Ar.unshift(he.content):he.mergeSources==="remoteFirst"&&Ar.push(he.content);case 16:return(or=(Array.isArray(Ar)?Ar:[Ar]).map(function(xe){return o.ProxyUtils.parse(xe)}).flat()).forEach(function(xe){xe._subName=he.name,xe._subDisplayName=he.displayName,xe._collectionName=ee.name,xe._collectionDisplayName=ee.displayName}),J.next=20,o.ProxyUtils.process(or,he.process||[],s,(D(Zr={},he.name,he),D(Zr,"_collection",ee),D(Zr,"$options",C),Zr));case 20:or=J.sent,v[ar]=or,ce++,r.default.info("\u2705 \u5B50\u8BA2\u9605\uFF1A".concat(he.name,"\u52A0\u8F7D\u6210\u529F\uFF0C\u8FDB\u5EA6--").concat(100*(ce/Kt.length).toFixed(1),"% ")),J.next=31;break;case 26:J.prev=26,J.t0=J.catch(1),ce++,Be[ar]=J.t0,r.default.error("\u274C \u5904\u7406\u7EC4\u5408\u8BA2\u9605\u4E2D\u7684\u5B50\u8BA2\u9605: ".concat(he.name,"\u65F6\u51FA\u73B0\u9519\u8BEF\uFF1A").concat(J.t0,"\uFF01\u8FDB\u5EA6--").concat(100*(ce/Kt.length).toFixed(1),"%"));case 31:case"end":return J.stop()}},Re,null,[[1,26]])}));return function(Re){return ye.apply(this,arguments)}}()));case 88:if(Vt=ee.ignoreFailedRemoteSub,_t!=null&&_t!==""&&(Vt=_t),Vt||!(Object.keys(Be).length>0)){se.next=92;break}throw new Error("\u7EC4\u5408\u8BA2\u9605 ".concat(l," \u4E2D\u7684\u5B50\u8BA2\u9605 ").concat(Object.keys(Be).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 92:return(ze=Array.prototype.concat.apply([],Kt.map(function(ye){return v[ye]||[]}))).forEach(function(ye){ye._collectionName=ee.name,ye._collectionDisplayName=ee.displayName}),se.next=96,o.ProxyUtils.process(ze,ee.process||[],s,{_collection:ee},C);case 96:if((ze=se.sent).length!==0){se.next=99;break}throw new Error("\u7EC4\u5408\u8BA2\u9605 ".concat(l," \u4E2D\u4E0D\u542B\u6709\u6548\u8282\u70B9"));case 99:We={},Je=y(ze),se.prev=101,Je.s();case 103:if((nr=Je.n()).done){se.next=111;break}if(lr=nr.value,!We[lr.name]){se.next=108;break}return r.default.notify("\u{1F30D} Sub-Store","\u26A0\uFE0F \u7EC4\u5408\u8BA2\u9605 ".concat(l," \u5305\u542B\u91CD\u590D\u8282\u70B9 ").concat(lr.name,"\uFF01"),"\u8BF7\u4ED4\u7EC6\u68C0\u6D4B\u914D\u7F6E\uFF01",{"media-url":"https://cdn3.iconfinder.com/data/icons/seo-outline-1/512/25_code_program_programming_develop_bug_search_developer-512.png"}),se.abrupt("break",111);case 108:We[lr.name]=!0;case 109:se.next=103;break;case 111:se.next=116;break;case 113:se.prev=113,se.t1=se.catch(101),Je.e(se.t1);case 116:return se.prev=116,Je.f(),se.finish(116);case 119:return se.abrupt("return",o.ProxyUtils.produce(ze,s,St,N));case 122:if(Ct!=="rule"){se.next=153;break}if(ur=r.default.read(_$constants_86.RULES_KEY),Me=(0,_$database_133.findByName)(ur,l)){se.next=127;break}throw new Error("\u627E\u4E0D\u5230\u89C4\u5219 ".concat(l));case 127:Ke=[],Ir=0;case 129:if(!(Ir<Me.urls.length)){se.next=147;break}return Le=Me.urls[Ir],r.default.info("\u6B63\u5728\u5904\u7406URL\uFF1A".concat(Le,"\uFF0C\u8FDB\u5EA6--").concat(100*((Ir+1)/Me.urls.length).toFixed(1),"% ")),se.prev=132,se.next=135,(0,n.default)(Le);case 135:qr=se.sent,hr=qr.body,Sr=_$ruleUtils_111.RuleUtils.parse(hr),Ke=Ke.concat(Sr),se.next=144;break;case 141:se.prev=141,se.t2=se.catch(132),r.default.error("\u5904\u7406\u5206\u6D41\u8BA2\u9605\u4E2D\u7684URL: ".concat(Le,"\u65F6\u51FA\u73B0\u9519\u8BEF\uFF1A").concat(se.t2,"! \u8BE5\u8BA2\u9605\u5DF2\u88AB\u8DF3\u8FC7\u3002"));case 144:Ir++,se.next=129;break;case 147:return se.next=149,_$ruleUtils_111.RuleUtils.process(Ke,[{type:"Remove Duplicate Filter"}]);case 149:return Ke=se.sent,se.abrupt("return",_$ruleUtils_111.RuleUtils.produce(Ke,s));case 153:if(Ct!=="file"){se.next=198;break}if(Kr=r.default.read(_$constants_86.FILES_KEY),tr=(0,_$database_133.findByName)(Kr,l)){se.next=158;break}throw new Error("\u627E\u4E0D\u5230\u6587\u4EF6 ".concat(l));case 158:if(!E||["localFirst","remoteFirst"].includes(rt)){se.next=162;break}Xe=E,se.next=187;break;case 162:if(!b){se.next=174;break}return Qe={},se.next=166,Promise.all(b.split(/[\r\n]+/).map(function(ye){return ye.trim()}).filter(function(ye){return ye.length}).map(function(){var ye=z(q().mark(function Re(ar){return q().wrap(function(he){for(;;)switch(he.prev=he.next){case 0:return he.prev=0,he.next=3,(0,n.default)(ar,$||tr.ua,void 0,tr.proxy||T,void 0,void 0,M);case 3:return he.abrupt("return",he.sent);case 6:return he.prev=6,he.t0=he.catch(0),Qe[ar]=he.t0,r.default.error("\u6587\u4EF6 ".concat(tr.name," \u7684\u8FDC\u7A0B\u6587\u4EF6 ").concat(ar," \u53D1\u751F\u9519\u8BEF: ").concat(he.t0)),he.abrupt("return","");case 11:case"end":return he.stop()}},Re,null,[[0,6]])}));return function(Re){return ye.apply(this,arguments)}}()));case 166:if(Xe=se.sent,an=tr.ignoreFailedRemoteFile,xt!=null&&xt!==""&&(an=xt),an||!(Object.keys(Qe).length>0)){se.next=171;break}throw new Error("\u6587\u4EF6 ".concat(tr.name," \u7684\u8FDC\u7A0B\u6587\u4EF6 ").concat(Object.keys(Qe).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 171:rt==="localFirst"?Xe.unshift(E):rt==="remoteFirst"&&Xe.push(E),se.next=187;break;case 174:if(tr.source!=="local"||["localFirst","remoteFirst"].includes(tr.mergeSources)){se.next=178;break}Xe=tr.content,se.next=187;break;case 178:return Gr={},se.next=181,Promise.all(tr.url.split(/[\r\n]+/).map(function(ye){return ye.trim()}).filter(function(ye){return ye.length}).map(function(){var ye=z(q().mark(function Re(ar){return q().wrap(function(he){for(;;)switch(he.prev=he.next){case 0:return he.prev=0,he.next=3,(0,n.default)(ar,$||tr.ua,void 0,tr.proxy||T,void 0,void 0,M);case 3:return he.abrupt("return",he.sent);case 6:return he.prev=6,he.t0=he.catch(0),Gr[ar]=he.t0,r.default.error("\u6587\u4EF6 ".concat(tr.name," \u7684\u8FDC\u7A0B\u6587\u4EF6 ").concat(ar," \u53D1\u751F\u9519\u8BEF: ").concat(he.t0)),he.abrupt("return","");case 11:case"end":return he.stop()}},Re,null,[[0,6]])}));return function(Re){return ye.apply(this,arguments)}}()));case 181:if(Xe=se.sent,Vr=tr.ignoreFailedRemoteFile,xt!=null&&xt!==""&&(Vr=xt),Vr||!(Object.keys(Gr).length>0)){se.next=186;break}throw new Error("\u6587\u4EF6 ".concat(tr.name," \u7684\u8FDC\u7A0B\u6587\u4EF6 ").concat(Object.keys(Gr).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 186:tr.mergeSources==="localFirst"?Xe.unshift(tr.content):tr.mergeSources==="remoteFirst"&&Xe.push(tr.content);case 187:if(Yr=(Array.isArray(Xe)?Xe:[Xe]).flat(),Xr=Yr.filter(function(ye){return ye!=null&&ye!==""}).join(`
`),!(Array.isArray(tr.process)&&tr.process.length>0)){se.next=195;break}return se.next=192,o.ProxyUtils.process({$files:Yr,$content:Xr,$options:C},tr.process);case 192:se.t3=se.sent,se.next=196;break;case 195:se.t3={$content:Xr,$files:Yr,$options:C};case 196:return sn=se.t3,se.abrupt("return",(Jr=sn?.$content)!==null&&Jr!==void 0?Jr:"");case 198:case"end":return se.stop()}},ft,null,[[53,65,68,71],[101,113,116,119],[132,141]])}))).apply(this,arguments)}function at(){return ct.apply(this,arguments)}function ct(){return(ct=z(q().mark(function ft(){var yt,Ct,l,s,b,$,E,rt,_t,xt,St,x,N,V,S,C,T;return q().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(r.default.info("\u5F00\u59CB\u540C\u6B65\u6240\u6709\u8FDC\u7A0B\u914D\u7F6E..."),yt=r.default.read(_$constants_86.ARTIFACTS_KEY),Ct={},M.prev=3,l=[],s=r.default.read(_$constants_86.SUBS_KEY),b=r.default.read(_$constants_86.COLLECTIONS_KEY),$=[],yt.map(function(et){if(et.sync&&et.source){if(et.type==="subscription"){var Pt=et.source,Ut=(0,_$database_133.findByName)(s,Pt);Ut&&Ut.url&&!$.includes(Pt)&&$.push(Pt)}else if(et.type==="collection"){var Zt=(0,_$database_133.findByName)(b,et.source);Zt&&Array.isArray(Zt.subscriptions)&&Zt.subscriptions.map(function(_e){var me=(0,_$database_133.findByName)(s,_e);me&&me.url&&!$.includes(_e)&&$.push(_e)})}}}),!($.length>0)){M.next=12;break}return M.next=12,Promise.all($.map(function(){var et=z(q().mark(function Pt(Ut){return q().wrap(function(Zt){for(;;)switch(Zt.prev=Zt.next){case 0:return Zt.prev=0,Zt.next=3,Z({type:"subscription",name:Ut,awaitCustomCache:!0});case 3:Zt.next=7;break;case 5:Zt.prev=5,Zt.t0=Zt.catch(0);case 7:case"end":return Zt.stop()}},Pt,null,[[0,5]])}));return function(Pt){return et.apply(this,arguments)}}()));case 12:return M.next=14,Promise.all(yt.map(function(){var et=z(q().mark(function Pt(Ut){var Zt,_e,me;return q().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:if(de.prev=0,!Ut.sync||!Ut.source){de.next=9;break}return r.default.info("\u6B63\u5728\u540C\u6B65\u4E91\u914D\u7F6E\uFF1A".concat(Ut.name,"...")),(Zt=Ut.platform==="SurgeMac")&&r.default.info("\u624B\u52A8\u6307\u5B9A\u4E86 target \u4E3A SurgeMac, \u5C06\u4F7F\u7528 Mihomo External"),de.next=7,Z({type:Ut.type,name:Ut.source,platform:Ut.platform,produceOpts:{"include-unsupported-proxy":Ut.includeUnsupportedProxy,useMihomoExternal:Zt}});case 7:_e=de.sent,Ct[encodeURIComponent(Ut.name)]={content:_e};case 9:de.next=15;break;case 11:de.prev=11,de.t0=de.catch(0),r.default.error("\u540C\u6B65\u914D\u7F6E ".concat(Ut.name," \u53D1\u751F\u9519\u8BEF: ").concat((me=de.t0.message)!==null&&me!==void 0?me:de.t0)),l.push(Ut.name);case 15:case"end":return de.stop()}},Pt,null,[[0,11]])}));return function(Pt){return et.apply(this,arguments)}}()));case 14:if(!(l.length>0)){M.next=16;break}throw new Error("\u540C\u6B65\u914D\u7F6E ".concat(l.join(", ")," \u53D1\u751F\u9519\u8BEF \u8BE6\u60C5\u8BF7\u67E5\u770B\u65E5\u5FD7"));case 16:return M.next=18,(0,_$artifacts_116.syncToGist)(Ct);case 18:E=M.sent,rt=JSON.parse(E.body),_t=y(yt);try{for(_t.s();!(xt=_t.n()).done;)(St=xt.value).sync&&(St.updated=new Date().getTime(),N=rt.files,V=void 0,Array.isArray(N)&&(V=!0,N=Object.fromEntries(N.map(function(et){return[et.path,et]}))),S=(x=N[encodeURIComponent(St.name)])===null||x===void 0?void 0:x.raw_url,C=V?S:S?.replace(/\/raw\/[^/]*\/(.*)/,"/raw/$1"),r.default.info(`\u4E0A\u4F20\u914D\u7F6E\u5B8C\u6210
\u6587\u4EF6\u5217\u8868: `.concat(Object.keys(N).join(", "),`
\u5F53\u524D\u6587\u4EF6: `).concat(encodeURIComponent(St.name),`
\u54CD\u5E94\u8FD4\u56DE\u7684\u539F\u59CB\u94FE\u63A5: `).concat(S,`
\u5904\u7406\u5B8C\u7684\u65B0\u94FE\u63A5: `).concat(C)),St.url=C)}catch(et){_t.e(et)}finally{_t.f()}r.default.write(yt,_$constants_86.ARTIFACTS_KEY),r.default.info("\u5168\u90E8\u8BA2\u9605\u540C\u6B65\u6210\u529F\uFF01"),M.next=30;break;case 26:throw M.prev=26,M.t0=M.catch(3),r.default.error("\u540C\u6B65\u8BA2\u9605\u5931\u8D25\uFF0C\u539F\u56E0\uFF1A".concat((T=M.t0.message)!==null&&T!==void 0?T:M.t0)),M.t0;case 30:case"end":return M.stop()}},ft,null,[[3,26]])}))).apply(this,arguments)}function ot(ft,yt){return tt.apply(this,arguments)}function tt(){return(tt=z(q().mark(function ft(yt,Ct){var l,s;return q().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return r.default.info("\u5F00\u59CB\u540C\u6B65\u6240\u6709\u8FDC\u7A0B\u914D\u7F6E..."),b.prev=1,b.next=4,at();case 4:(0,_$response_127.success)(Ct),b.next=11;break;case 7:b.prev=7,b.t0=b.catch(1),r.default.error("\u540C\u6B65\u8BA2\u9605\u5931\u8D25\uFF0C\u539F\u56E0\uFF1A".concat((l=b.t0.message)!==null&&l!==void 0?l:b.t0)),(0,_$response_127.failed)(Ct,new _$errors_119.InternalServerError("FAILED_TO_SYNC_ARTIFACTS","Failed to sync all artifacts","Reason: ".concat((s=b.t0.message)!==null&&s!==void 0?s:b.t0)));case 11:case"end":return b.stop()}},ft,null,[[1,7]])}))).apply(this,arguments)}function gt(ft,yt){return wt.apply(this,arguments)}function wt(){return(wt=z(q().mark(function ft(yt,Ct){var l,s,b,$,E,rt,_t,xt,St,x,N,V,S;return q().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(l=yt.params.name,l=decodeURIComponent(l),r.default.info("\u5F00\u59CB\u540C\u6B65\u8FDC\u7A0B\u914D\u7F6E ".concat(l,"...")),s=r.default.read(_$constants_86.ARTIFACTS_KEY),b=(0,_$database_133.findByName)(s,l)){C.next=9;break}return r.default.error("\u627E\u4E0D\u5230\u8FDC\u7A0B\u914D\u7F6E ".concat(l)),(0,_$response_127.failed)(Ct,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","\u627E\u4E0D\u5230\u8FDC\u7A0B\u914D\u7F6E ".concat(l)),404),C.abrupt("return");case 9:if(b.source){C.next=13;break}return r.default.error("\u8FDC\u7A0B\u914D\u7F6E ".concat(l," \u672A\u8BBE\u7F6E\u6765\u6E90")),(0,_$response_127.failed)(Ct,new _$errors_119.ResourceNotFoundError("RESOURCE_HAS_NO_SOURCE","\u8FDC\u7A0B\u914D\u7F6E ".concat(l," \u672A\u8BBE\u7F6E\u6765\u6E90")),404),C.abrupt("return");case 13:return C.prev=13,(E=b.platform==="SurgeMac")&&r.default.info("\u624B\u52A8\u6307\u5B9A\u4E86 target \u4E3A SurgeMac, \u5C06\u4F7F\u7528 Mihomo External"),C.next=18,Z({type:b.type,name:b.source,platform:b.platform,produceOpts:{"include-unsupported-proxy":b.includeUnsupportedProxy,useMihomoExternal:E}});case 18:return rt=C.sent,r.default.info("\u6B63\u5728\u4E0A\u4F20\u914D\u7F6E\uFF1A".concat(b.name,`
>>>`).concat(JSON.stringify(b,null,2))),C.next=22,(0,_$artifacts_116.syncToGist)(D({},encodeURIComponent(b.name),{content:rt}));case 22:_t=C.sent,b.updated=new Date().getTime(),xt=JSON.parse(_t.body),St=xt.files,Array.isArray(St)&&(x=!0,St=Object.fromEntries(St.map(function(T){return[T.path,T]}))),N=($=St[encodeURIComponent(b.name)])===null||$===void 0?void 0:$.raw_url,V=x?N:N?.replace(/\/raw\/[^/]*\/(.*)/,"/raw/$1"),r.default.info(`\u4E0A\u4F20\u914D\u7F6E\u5B8C\u6210
\u6587\u4EF6\u5217\u8868: `.concat(Object.keys(St).join(", "),`
\u5F53\u524D\u6587\u4EF6: `).concat(encodeURIComponent(b.name),`
\u54CD\u5E94\u8FD4\u56DE\u7684\u539F\u59CB\u94FE\u63A5: `).concat(N,`
\u5904\u7406\u5B8C\u7684\u65B0\u94FE\u63A5: `).concat(V)),b.url=V,r.default.write(s,_$constants_86.ARTIFACTS_KEY),(0,_$response_127.success)(Ct,b),C.next=39;break;case 35:C.prev=35,C.t0=C.catch(13),r.default.error("\u8FDC\u7A0B\u914D\u7F6E ".concat(b.name," \u53D1\u751F\u9519\u8BEF: ").concat((S=C.t0.message)!==null&&S!==void 0?S:C.t0)),(0,_$response_127.failed)(Ct,new _$errors_119.InternalServerError("FAILED_TO_SYNC_ARTIFACT","Failed to sync artifact ".concat(l),"Reason: ".concat(C.t0)));case 39:case"end":return C.stop()}},ft,null,[[13,35]])}))).apply(this,arguments)}}),_$proxyUtils_88=createModuleFactory(function(t,e){"use strict";function r(s){return(r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(s)}Object.defineProperty(e,"__esModule",{value:!0}),e.ProxyUtils=void 0;var n=_$buffer_3({}),o=z(_$rs_145),f=z(_$yaml_148),d=z(_$download_135),h=function(s,b){if(s&&s.__esModule)return s;if(s===null||r(s)!=="object"&&typeof s!="function")return{default:s};var $=function(St){if(typeof WeakMap!="function")return null;var x=new WeakMap,N=new WeakMap;return function(V){return V?N:x}(St)}(void 0);if($&&$.has(s))return $.get(s);var E={},rt=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var _t in s)if(_t!=="default"&&Object.prototype.hasOwnProperty.call(s,_t)){var xt=rt?Object.getOwnPropertyDescriptor(s,_t):null;xt&&(xt.get||xt.set)?Object.defineProperty(E,_t,xt):E[_t]=s[_t]}return E.default=s,$&&$.set(s,E),E}(_$processors_95({})),y=z(_$preprocessors_94),k=z(_$producers_99),A=z(_$parsers_89),D=z(_$app_87),q=_$sync_131({}),H=z(_$gist_139);function z(s){return s&&s.__esModule?s:{default:s}}function Z(){Z=function(){return s};var s={},b=Object.prototype,$=b.hasOwnProperty,E=typeof Symbol=="function"?Symbol:{},rt=E.iterator||"@@iterator",_t=E.asyncIterator||"@@asyncIterator",xt=E.toStringTag||"@@toStringTag";function St(Dt,Nt,ie){return Object.defineProperty(Dt,Nt,{value:ie,enumerable:!0,configurable:!0,writable:!0}),Dt[Nt]}try{St({},"")}catch{St=function(Nt,ie,ee){return Nt[ie]=ee}}function x(Dt,Nt,ie,ee){var Kt=Nt&&Nt.prototype instanceof S?Nt:S,be=Object.create(Kt.prototype),v=new Gt(ee||[]);return be._invoke=function(Be,ce,Vt){var ze="suspendedStart";return function(We,Je){if(ze==="executing")throw new Error("Generator is already running");if(ze==="completed"){if(We==="throw")throw Je;return{value:void 0,done:!0}}for(Vt.method=We,Vt.arg=Je;;){var nr=Vt.delegate;if(nr){var lr=me(nr,Vt);if(lr){if(lr===V)continue;return lr}}if(Vt.method==="next")Vt.sent=Vt._sent=Vt.arg;else if(Vt.method==="throw"){if(ze==="suspendedStart")throw ze="completed",Vt.arg;Vt.dispatchException(Vt.arg)}else Vt.method==="return"&&Vt.abrupt("return",Vt.arg);ze="executing";var ur=N(Be,ce,Vt);if(ur.type==="normal"){if(ze=Vt.done?"completed":"suspendedYield",ur.arg===V)continue;return{value:ur.arg,done:Vt.done}}ur.type==="throw"&&(ze="completed",Vt.method="throw",Vt.arg=ur.arg)}}}(Dt,ie,v),be}function N(Dt,Nt,ie){try{return{type:"normal",arg:Dt.call(Nt,ie)}}catch(ee){return{type:"throw",arg:ee}}}s.wrap=x;var V={};function S(){}function C(){}function T(){}var M={};St(M,rt,function(){return this});var et=Object.getPrototypeOf,Pt=et&&et(et(pe([])));Pt&&Pt!==b&&$.call(Pt,rt)&&(M=Pt);var Ut=T.prototype=S.prototype=Object.create(M);function Zt(Dt){["next","throw","return"].forEach(function(Nt){St(Dt,Nt,function(ie){return this._invoke(Nt,ie)})})}function _e(Dt,Nt){var ie;this._invoke=function(ee,Kt){function be(){return new Nt(function(v,Be){(function ce(Vt,ze,We,Je){var nr=N(Dt[Vt],Dt,ze);if(nr.type!=="throw"){var lr=nr.arg,ur=lr.value;return ur&&r(ur)=="object"&&$.call(ur,"__await")?Nt.resolve(ur.__await).then(function(Me){ce("next",Me,We,Je)},function(Me){ce("throw",Me,We,Je)}):Nt.resolve(ur).then(function(Me){lr.value=Me,We(lr)},function(Me){return ce("throw",Me,We,Je)})}Je(nr.arg)})(ee,Kt,v,Be)})}return ie=ie?ie.then(be,be):be()}}function me(Dt,Nt){var ie=Dt.iterator[Nt.method];if(ie===void 0){if(Nt.delegate=null,Nt.method==="throw"){if(Dt.iterator.return&&(Nt.method="return",Nt.arg=void 0,me(Dt,Nt),Nt.method==="throw"))return V;Nt.method="throw",Nt.arg=new TypeError("The iterator does not provide a 'throw' method")}return V}var ee=N(ie,Dt.iterator,Nt.arg);if(ee.type==="throw")return Nt.method="throw",Nt.arg=ee.arg,Nt.delegate=null,V;var Kt=ee.arg;return Kt?Kt.done?(Nt[Dt.resultName]=Kt.value,Nt.next=Dt.nextLoc,Nt.method!=="return"&&(Nt.method="next",Nt.arg=void 0),Nt.delegate=null,V):Kt:(Nt.method="throw",Nt.arg=new TypeError("iterator result is not an object"),Nt.delegate=null,V)}function de(Dt){var Nt={tryLoc:Dt[0]};1 in Dt&&(Nt.catchLoc=Dt[1]),2 in Dt&&(Nt.finallyLoc=Dt[2],Nt.afterLoc=Dt[3]),this.tryEntries.push(Nt)}function Xt(Dt){var Nt=Dt.completion||{};Nt.type="normal",delete Nt.arg,Dt.completion=Nt}function Gt(Dt){this.tryEntries=[{tryLoc:"root"}],Dt.forEach(de,this),this.reset(!0)}function pe(Dt){if(Dt){var Nt=Dt[rt];if(Nt)return Nt.call(Dt);if(typeof Dt.next=="function")return Dt;if(!isNaN(Dt.length)){var ie=-1,ee=function Kt(){for(;++ie<Dt.length;)if($.call(Dt,ie))return Kt.value=Dt[ie],Kt.done=!1,Kt;return Kt.value=void 0,Kt.done=!0,Kt};return ee.next=ee}}return{next:ge}}function ge(){return{value:void 0,done:!0}}return C.prototype=T,St(Ut,"constructor",T),St(T,"constructor",C),C.displayName=St(T,xt,"GeneratorFunction"),s.isGeneratorFunction=function(Dt){var Nt=typeof Dt=="function"&&Dt.constructor;return!!Nt&&(Nt===C||(Nt.displayName||Nt.name)==="GeneratorFunction")},s.mark=function(Dt){return Object.setPrototypeOf?Object.setPrototypeOf(Dt,T):(Dt.__proto__=T,St(Dt,xt,"GeneratorFunction")),Dt.prototype=Object.create(Ut),Dt},s.awrap=function(Dt){return{__await:Dt}},Zt(_e.prototype),St(_e.prototype,_t,function(){return this}),s.AsyncIterator=_e,s.async=function(Dt,Nt,ie,ee,Kt){Kt===void 0&&(Kt=Promise);var be=new _e(x(Dt,Nt,ie,ee),Kt);return s.isGeneratorFunction(Nt)?be:be.next().then(function(v){return v.done?v.value:be.next()})},Zt(Ut),St(Ut,xt,"Generator"),St(Ut,rt,function(){return this}),St(Ut,"toString",function(){return"[object Generator]"}),s.keys=function(Dt){var Nt=[];for(var ie in Dt)Nt.push(ie);return Nt.reverse(),function ee(){for(;Nt.length;){var Kt=Nt.pop();if(Kt in Dt)return ee.value=Kt,ee.done=!1,ee}return ee.done=!0,ee}},s.values=pe,Gt.prototype={constructor:Gt,reset:function(Dt){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Xt),!Dt)for(var Nt in this)Nt.charAt(0)==="t"&&$.call(this,Nt)&&!isNaN(+Nt.slice(1))&&(this[Nt]=void 0)},stop:function(){this.done=!0;var Dt=this.tryEntries[0].completion;if(Dt.type==="throw")throw Dt.arg;return this.rval},dispatchException:function(Dt){if(this.done)throw Dt;var Nt=this;function ie(ce,Vt){return be.type="throw",be.arg=Dt,Nt.next=ce,Vt&&(Nt.method="next",Nt.arg=void 0),!!Vt}for(var ee=this.tryEntries.length-1;ee>=0;--ee){var Kt=this.tryEntries[ee],be=Kt.completion;if(Kt.tryLoc==="root")return ie("end");if(Kt.tryLoc<=this.prev){var v=$.call(Kt,"catchLoc"),Be=$.call(Kt,"finallyLoc");if(v&&Be){if(this.prev<Kt.catchLoc)return ie(Kt.catchLoc,!0);if(this.prev<Kt.finallyLoc)return ie(Kt.finallyLoc)}else if(v){if(this.prev<Kt.catchLoc)return ie(Kt.catchLoc,!0)}else{if(!Be)throw new Error("try statement without catch or finally");if(this.prev<Kt.finallyLoc)return ie(Kt.finallyLoc)}}}},abrupt:function(Dt,Nt){for(var ie=this.tryEntries.length-1;ie>=0;--ie){var ee=this.tryEntries[ie];if(ee.tryLoc<=this.prev&&$.call(ee,"finallyLoc")&&this.prev<ee.finallyLoc){var Kt=ee;break}}Kt&&(Dt==="break"||Dt==="continue")&&Kt.tryLoc<=Nt&&Nt<=Kt.finallyLoc&&(Kt=null);var be=Kt?Kt.completion:{};return be.type=Dt,be.arg=Nt,Kt?(this.method="next",this.next=Kt.finallyLoc,V):this.complete(be)},complete:function(Dt,Nt){if(Dt.type==="throw")throw Dt.arg;return Dt.type==="break"||Dt.type==="continue"?this.next=Dt.arg:Dt.type==="return"?(this.rval=this.arg=Dt.arg,this.method="return",this.next="end"):Dt.type==="normal"&&Nt&&(this.next=Nt),V},finish:function(Dt){for(var Nt=this.tryEntries.length-1;Nt>=0;--Nt){var ie=this.tryEntries[Nt];if(ie.finallyLoc===Dt)return this.complete(ie.completion,ie.afterLoc),Xt(ie),V}},catch:function(Dt){for(var Nt=this.tryEntries.length-1;Nt>=0;--Nt){var ie=this.tryEntries[Nt];if(ie.tryLoc===Dt){var ee=ie.completion;if(ee.type==="throw"){var Kt=ee.arg;Xt(ie)}return Kt}}throw new Error("illegal catch attempt")},delegateYield:function(Dt,Nt,ie){return this.delegate={iterator:pe(Dt),resultName:Nt,nextLoc:ie},this.method==="next"&&(this.arg=void 0),V}},s}function j(s,b,$,E,rt,_t,xt){try{var St=s[_t](xt),x=St.value}catch(N){return void $(N)}St.done?b(x):Promise.resolve(x).then(E,rt)}function at(s,b){return function($){if(Array.isArray($))return $}(s)||function($,E){var rt=$==null?null:typeof Symbol<"u"&&$[Symbol.iterator]||$["@@iterator"];if(rt!=null){var _t,xt,St=[],x=!0,N=!1;try{for(rt=rt.call($);!(x=(_t=rt.next()).done)&&(St.push(_t.value),!E||St.length!==E);x=!0);}catch(V){N=!0,xt=V}finally{try{x||rt.return==null||rt.return()}finally{if(N)throw xt}}return St}}(s,b)||ot(s,b)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ct(s,b){var $=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(!$){if(Array.isArray(s)||($=ot(s))||b&&s&&typeof s.length=="number"){$&&(s=$);var E=0,rt=function(){};return{s:rt,n:function(){return E>=s.length?{done:!0}:{done:!1,value:s[E++]}},e:function(x){throw x},f:rt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _t,xt=!0,St=!1;return{s:function(){$=$.call(s)},n:function(){var x=$.next();return xt=x.done,x},e:function(x){St=!0,_t=x},f:function(){try{xt||$.return==null||$.return()}finally{if(St)throw _t}}}}function ot(s,b){if(s){if(typeof s=="string")return tt(s,b);var $=Object.prototype.toString.call(s).slice(8,-1);return $==="Object"&&s.constructor&&($=s.constructor.name),$==="Map"||$==="Set"?Array.from(s):$==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test($)?tt(s,b):void 0}}function tt(s,b){(b==null||b>s.length)&&(b=s.length);for(var $=0,E=new Array(b);$<b;$++)E[$]=s[$];return E}function gt(){var s;return s=Z().mark(function b($){var E,rt,_t,xt,St,x,N,V,S,C,T,M,et,Pt,Ut,Zt,_e,me,de,Xt,Gt,pe,ge,Dt,Nt,ie,ee=arguments;return Z().wrap(function(Kt){for(;;)switch(Kt.prev=Kt.next){case 0:E=ee.length>1&&ee[1]!==void 0?ee[1]:[],rt=ee.length>2?ee[2]:void 0,_t=ee.length>3?ee[3]:void 0,xt=ee.length>4?ee[4]:void 0,St=ct(E),Kt.prev=5,St.s();case 7:if((x=St.n()).done){Kt.next=75;break}if(!(N=x.value).disabled){Kt.next=12;break}return D.default.log('Skipping disabled operator: "'.concat(N.type,`" with arguments:
 >>> `).concat(JSON.stringify(N.args,null,2)||"None")),Kt.abrupt("continue",73);case 12:if(V=void 0,S={},N.type.indexOf("Script")===-1){Kt.next=64;break}if(C=N.args,T=C.mode,M=C.content,T!=="link"){Kt.next=63;break}if(et=void 0,(Pt=M||"").endsWith("#noCache")&&(Pt=Pt.replace(/#noCache$/,""),et=!0),(Ut=Pt.split("#")).length>1)try{S=JSON.parse(decodeURIComponent(Ut[1]))}catch{Zt=ct(Ut[1].split("&"));try{for(Zt.s();!(_e=Zt.n()).done;)me=_e.value,de=me.split("=")[0],Xt=me.split("=")[1],S[de]=Xt==null||Xt===""||decodeURIComponent(Xt)}catch(v){Zt.e(v)}finally{Zt.f()}}if(Pt="".concat(Pt.split("#")[0]).concat(et?"#noCache":""),!(Gt=Pt.match(/^\/api\/(file|module)\/(.+)/))){Kt.next=51;break}if(pe="",Kt.prev=26,pe=Gt?.[1],(ge=Gt?.[2])!=null){Kt.next=31;break}throw new Error("\u672C\u5730 ".concat(pe," URL \u65E0\u6548: ").concat(Pt));case 31:if(ge=decodeURIComponent(ge),Dt=pe==="module"?_$constants_86.MODULES_KEY:_$constants_86.FILES_KEY,Nt=(0,_$database_133.findByName)(D.default.read(Dt),ge)){Kt.next=36;break}throw new Error("\u627E\u4E0D\u5230 ".concat(pe,": ").concat(ge));case 36:if(pe!=="module"){Kt.next=40;break}V=Nt.content,Kt.next=43;break;case 40:return Kt.next=42,(0,q.produceArtifact)({type:"file",name:ge});case 42:V=Kt.sent;case 43:Kt.next=49;break;case 45:throw Kt.prev=45,Kt.t0=Kt.catch(26),D.default.error("Error when loading ".concat(pe,": ").concat(N.args.content,`.
 Reason: `).concat(Kt.t0)),new Error("\u65E0\u6CD5\u52A0\u8F7D ".concat(pe,": ").concat(Pt));case 49:Kt.next=61;break;case 51:return Kt.prev=51,Kt.next=54,(0,d.default)(Pt);case 54:V=Kt.sent,Kt.next=61;break;case 57:throw Kt.prev=57,Kt.t1=Kt.catch(51),D.default.error("Error when downloading remote script: ".concat(N.args.content,`.
 Reason: `).concat(Kt.t1)),new Error("\u65E0\u6CD5\u4E0B\u8F7D\u811A\u672C: ".concat(Pt));case 61:Kt.next=64;break;case 63:V=M;case 64:if(h.default[N.type]){Kt.next=67;break}return D.default.error('Unknown operator: "'.concat(N.type,'"')),Kt.abrupt("continue",73);case 67:return D.default.log('Applying "'.concat(N.type,`" with arguments:
 >>> `).concat(JSON.stringify(N.args,null,2)||"None")),ie=void 0,ie=N.type.indexOf("Script")!==-1?h.default[N.type](V,rt,S,_t,xt):h.default[N.type](N.args||{}),Kt.next=72,(0,h.ApplyProcessor)(ie,$);case 72:$=Kt.sent;case 73:Kt.next=7;break;case 75:Kt.next=80;break;case 77:Kt.prev=77,Kt.t2=Kt.catch(5),St.e(Kt.t2);case 80:return Kt.prev=80,St.f(),Kt.finish(80);case 83:return Kt.abrupt("return",$);case 84:case"end":return Kt.stop()}},b,null,[[5,77,80,83],[26,45],[51,57]])}),(gt=function(){var b=this,$=arguments;return new Promise(function(E,rt){var _t=s.apply(b,$);function xt(x){j(_t,E,rt,xt,St,"next",x)}function St(x){j(_t,E,rt,xt,St,"throw",x)}xt(void 0)})}).apply(this,arguments)}var wt={parse:function(s){s=function(M){var et,Pt=ct(y.default);try{for(Pt.s();!(et=Pt.n()).done;){var Ut=et.value;try{if(Ut.test(M))return D.default.info("Pre-processor [".concat(Ut.name,"] activated")),Ut.parse(M)}catch(Zt){D.default.error("Parser [".concat(Ut.name,`] failed
 Reason: `).concat(Zt))}}}catch(Zt){Pt.e(Zt)}finally{Pt.f()}return M}(s);var b,$,E=[],rt=ct(s.split(`
`));try{for(rt.s();!($=rt.n()).done;){var _t=$.value;if((_t=_t.trim()).length!==0){var xt=!1;if(b){var St=at(ft(b,_t),2),x=St[0];St[1]||(E.push(Ct(x)),xt=!0)}if(!xt){var N,V=ct(A.default);try{for(V.s();!(N=V.n()).done;){var S=N.value,C=at(ft(S,_t),2),T=C[0];if(!C[1]){E.push(Ct(T)),b=S,xt=!0,D.default.info("".concat(S.name," is activated"));break}}}catch(M){V.e(M)}finally{V.f()}}xt||D.default.error("Failed to parse line: ".concat(_t))}}}catch(M){rt.e(M)}finally{rt.f()}return E},process:function(s){return gt.apply(this,arguments)},produce:function(s,b,$){var E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},rt=k.default[b];if(!rt)throw new Error("Target platform: ".concat(b," is not supported!"));var _t=/Surge|SurgeMac|Shadowrocket/i.test(b);if(s=(s=s.filter(function(C){return!(C.supported&&C.supported[b]===!1)})).map(function(C){return C._resolved=C.resolved,(0,_$utils_141.isNotBlank)(C.name)||(C.name="".concat(C.type," ").concat(C.server,":").concat(C.port)),C["disable-sni"]&&(_t?C.sni="off":["tuic"].includes(C.type)||(D.default.error("Target platform ".concat(b," does not support sni off. Proxy's fields (sni, tls-fingerprint and skip-cert-verify) will be modified.")),C.sni="",C["skip-cert-verify"]=!0,delete C["tls-fingerprint"])),C.ports&&(C.ports=String(C.ports),["ClashMeta"].includes(b)||(C.ports=C.ports.replace(/\//g,",")),C.port||(C.port=(0,_$utils_141.getRandomPort)(C.ports))),C}),D.default.log("Producing proxies for target: ".concat(b)),rt.type===void 0||rt.type==="SINGLE"){var xt,St,x,N,V,S=s.map(function(C){try{return rt.produce(C,$,E)}catch(T){return D.default.error("Cannot produce proxy: ".concat(JSON.stringify(C,null,2),`
Reason: `).concat(T)),""}}).filter(function(C){return C.length>0});return S=$==="internal"?S:S.join(`
`),b.startsWith("Surge")&&s.length>0&&s.every(function(C){return C.type==="wireguard"})&&(S="#!name=".concat((xt=s[0])===null||xt===void 0?void 0:xt._subName,`
#!desc=`).concat((St=(x=s[0])===null||x===void 0?void 0:x._desc)!==null&&St!==void 0?St:"",`
#!category=`).concat((N=(V=s[0])===null||V===void 0?void 0:V._category)!==null&&N!==void 0?N:"",`
`).concat(S)),S}if(rt.type==="ALL")return rt.produce(s,$,E)},ipAddress:_$utils_141.ipAddress,getRandomPort:_$utils_141.getRandomPort,isIPv4:_$utils_141.isIPv4,isIPv6:_$utils_141.isIPv6,isIP:l,yaml:f.default,getFlag:_$geo_138.getFlag,removeFlag:_$geo_138.removeFlag,getISO:_$geo_138.getISO,MMDB:_$geo_138.MMDB,Gist:H.default,download:d.default};function ft(s,b){if(!function($,E){try{return $.test(E)}catch{return!1}}(s,b))return[null,new Error("Parser mismatch")];try{return[s.parse(b),null]}catch($){return[null,$]}}function yt(s){if(typeof s=="string"||typeof s=="number"){if((s=String(s).trim())==="")return"/";if(!s.startsWith("/"))return"/"+s}return s}function Ct(s){var b,$,E;typeof s.cipher=="string"&&(s.cipher=s.cipher.toLowerCase()),typeof s.password=="number"&&(s.password=(0,_$utils_141.numberToString)(s.password)),s.interface&&(s["interface-name"]=s.interface,delete s.interface),(0,_$utils_141.isValidPortNumber)(s.port)&&(s.port=parseInt(s.port,10)),s.server&&(s.server="".concat(s.server).trim().replace(/^\[/,"").replace(/\]$/,"")),s.network==="ws"&&(s["ws-opts"]||!s["ws-path"]&&!s["ws-headers"]||(s["ws-opts"]={},s["ws-path"]&&(s["ws-opts"].path=s["ws-path"]),s["ws-headers"]&&(s["ws-opts"].headers=s["ws-headers"])),delete s["ws-path"],delete s["ws-headers"]);var rt,_t,xt,St,x=(b=s["".concat(s.network,"-opts")])===null||b===void 0?void 0:b.path;if(Array.isArray(x)?s["".concat(s.network,"-opts")].path=x.map(function(Kt){return yt(Kt)}):x!=null&&(s["".concat(s.network,"-opts")].path=yt(x)),s.type==="trojan"&&s.network==="tcp"&&delete s.network,["vless"].includes(s.type)&&(s.network||(s.network="tcp")),["trojan","tuic","hysteria","hysteria2","juicity"].includes(s.type)&&(s.tls=!0),s.network){var N,V,S,C,T=(N=s["".concat(s.network,"-opts")])===null||N===void 0||(V=N.headers)===null||V===void 0?void 0:V.Host,M=(S=s["".concat(s.network,"-opts")])===null||S===void 0||(C=S.headers)===null||C===void 0?void 0:C.host;s.network==="h2"?!M&&T&&(s["".concat(s.network,"-opts")].headers.host=T,delete s["".concat(s.network,"-opts")].headers.Host):M&&!T&&(s["".concat(s.network,"-opts")].headers.Host=M,delete s["".concat(s.network,"-opts")].headers.host)}if(s.network==="h2"){var et,Pt,Ut,Zt=(et=s["h2-opts"])===null||et===void 0||(Pt=et.headers)===null||Pt===void 0?void 0:Pt.host,_e=(Ut=s["h2-opts"])===null||Ut===void 0?void 0:Ut.path;Zt&&!Array.isArray(Zt)&&(s["h2-opts"].headers.host=[Zt]),Array.isArray(_e)&&(s["h2-opts"].path=_e[0])}if(s.tls||!["ws","http"].includes(s.network)||($=s["".concat(s.network,"-opts")])!==null&&$!==void 0&&(E=$.headers)!==null&&E!==void 0&&E.Host||l(s.server)||(s["".concat(s.network,"-opts")]=s["".concat(s.network,"-opts")]||{},s["".concat(s.network,"-opts")].headers=s["".concat(s.network,"-opts")].headers||{},s["".concat(s.network,"-opts")].headers.Host=["vmess","vless"].includes(s.type)&&s.network==="http"?[s.server]:s.server),["vmess","vless"].includes(s.type)&&s.network==="http"){var me,de,Xt,Gt=(me=s["".concat(s.network,"-opts")])===null||me===void 0?void 0:me.path,pe=(de=s["".concat(s.network,"-opts")])===null||de===void 0||(Xt=de.headers)===null||Xt===void 0?void 0:Xt.Host;pe&&!Array.isArray(pe)&&(s["".concat(s.network,"-opts")].headers.Host=[pe]),Gt&&!Array.isArray(Gt)&&(s["".concat(s.network,"-opts")].path=[Gt])}if(s.tls&&!s.sni&&(l(s.server)||(s.sni=s.server),!s.sni&&s.network)){var ge,Dt,Nt=(ge=s["".concat(s.network,"-opts")])===null||ge===void 0||(Dt=ge.headers)===null||Dt===void 0?void 0:Dt.Host;(Nt=Array.isArray(Nt)?Nt[0]:Nt)&&(s.sni=Nt)}if(s.ports?s.ports=String(s.ports).replace(/\//g,","):delete s.ports,["hysteria2"].includes(s.type)&&s.obfs&&!["salamander"].includes(s.obfs)&&!s["obfs-password"]&&(s["obfs-password"]=s.obfs,s.obfs="salamander"),["vless"].includes(s.type)&&(s["reality-opts"]&&Object.keys(s["reality-opts"]).length===0&&delete s["reality-opts"],s["grpc-opts"]&&Object.keys(s["grpc-opts"]).length===0&&delete s["grpc-opts"],s["reality-opts"]||s.flow||delete s.flow,["http"].includes(s.network)&&(!((rt=s["".concat(s.network,"-opts")])===null||rt===void 0)&&rt.path||(s["".concat(s.network,"-opts")]||(s["".concat(s.network,"-opts")]={}),s["".concat(s.network,"-opts")].path=["/"]))),typeof s.name!="string")if(/^\d+$/.test(s.name))s.name="".concat(s.name);else try{var ie;(ie=s.name)!==null&&ie!==void 0&&ie.data?s.name=n.Buffer.from(s.name.data).toString("utf8"):s.name=n.Buffer.from(s.name).toString("utf8")}catch(Kt){D.default.error(`proxy.name decode failed
Reason: `.concat(Kt)),s.name="".concat(s.type," ").concat(s.server,":").concat(s.port)}["ws","http","h2"].includes(s.network)&&(!["ws","h2"].includes(s.network)||(_t=s["".concat(s.network,"-opts")])!==null&&_t!==void 0&&_t.path?s.network==="http"&&(!Array.isArray((xt=s["".concat(s.network,"-opts")])===null||xt===void 0?void 0:xt.path)||(St=s["".concat(s.network,"-opts")])!==null&&St!==void 0&&St.path.every(function(Kt){return!Kt}))&&(s["".concat(s.network,"-opts")]=s["".concat(s.network,"-opts")]||{},s["".concat(s.network,"-opts")].path=["/"]):(s["".concat(s.network,"-opts")]=s["".concat(s.network,"-opts")]||{},s["".concat(s.network,"-opts")].path="/")),["","off"].includes(s.sni)&&(s["disable-sni"]=!0);var ee=s.ca_str;s["ca-str"]?ee=s["ca-str"]:ee&&(delete s.ca_str,s["ca-str"]=ee);try{D.default.env.isNode&&!ee&&s._ca&&(ee=D.default.node.fs.readFileSync(s._ca,{encoding:"utf8"}))}catch(Kt){D.default.error(`Read ca file failed
Reason: `.concat(Kt))}return!s["tls-fingerprint"]&&ee&&(s["tls-fingerprint"]=o.default.generateFingerprint(ee)),s}function l(s){return(0,_$utils_141.isIPv4)(s)||(0,_$utils_141.isIPv6)(s)}e.ProxyUtils=wt}),_$processors_95=createModuleFactory(function(module,exports){"use strict";function _typeof(t){return(_typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApplyProcessor=ApplyProcessor,exports.default=void 0;var _resourceCache=_interopRequireDefault(_$resourceCache_144),_scriptResourceCache=_interopRequireDefault(_$scriptResourceCache_146),_lodash=_interopRequireDefault(_$lodash_53),_app=_interopRequireDefault(_$app_87),_2=_$proxyUtils_88({}),_sync=_$sync_131({}),_env=_interopRequireDefault(_$env_136);function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=typeof Symbol=="function"?Symbol:{},o=n.iterator||"@@iterator",f=n.asyncIterator||"@@asyncIterator",d=n.toStringTag||"@@toStringTag";function h(l,s,b){return Object.defineProperty(l,s,{value:b,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,b,$){return s[b]=$}}function y(l,s,b,$){var E=s&&s.prototype instanceof D?s:D,rt=Object.create(E.prototype),_t=new ft($||[]);return rt._invoke=function(xt,St,x){var N="suspendedStart";return function(V,S){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(V==="throw")throw S;return{value:void 0,done:!0}}for(x.method=V,x.arg=S;;){var C=x.delegate;if(C){var T=tt(C,x);if(T){if(T===A)continue;return T}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var M=k(xt,St,x);if(M.type==="normal"){if(N=x.done?"completed":"suspendedYield",M.arg===A)continue;return{value:M.arg,done:x.done}}M.type==="throw"&&(N="completed",x.method="throw",x.arg=M.arg)}}}(l,b,_t),rt}function k(l,s,b){try{return{type:"normal",arg:l.call(s,b)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var A={};function D(){}function q(){}function H(){}var z={};h(z,o,function(){return this});var Z=Object.getPrototypeOf,j=Z&&Z(Z(yt([])));j&&j!==e&&r.call(j,o)&&(z=j);var at=H.prototype=D.prototype=Object.create(z);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(b){return this._invoke(s,b)})})}function ot(l,s){var b;this._invoke=function($,E){function rt(){return new s(function(_t,xt){(function St(x,N,V,S){var C=k(l[x],l,N);if(C.type!=="throw"){var T=C.arg,M=T.value;return M&&_typeof(M)=="object"&&r.call(M,"__await")?s.resolve(M.__await).then(function(et){St("next",et,V,S)},function(et){St("throw",et,V,S)}):s.resolve(M).then(function(et){T.value=et,V(T)},function(et){return St("throw",et,V,S)})}S(C.arg)})($,E,_t,xt)})}return b=b?b.then(rt,rt):rt()}}function tt(l,s){var b=l.iterator[s.method];if(b===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,tt(l,s),s.method==="throw"))return A;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var $=k(b,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,A;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,A):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,A)}function gt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function wt(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function ft(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(gt,this),this.reset(!0)}function yt(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var b=-1,$=function E(){for(;++b<l.length;)if(r.call(l,b))return E.value=l[b],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:Ct}}function Ct(){return{value:void 0,done:!0}}return q.prototype=H,h(at,"constructor",H),h(H,"constructor",q),q.displayName=h(H,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===q||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,H):(l.__proto__=H,h(l,d,"GeneratorFunction")),l.prototype=Object.create(at),l},t.awrap=function(l){return{__await:l}},ct(ot.prototype),h(ot.prototype,f,function(){return this}),t.AsyncIterator=ot,t.async=function(l,s,b,$,E){E===void 0&&(E=Promise);var rt=new ot(y(l,s,b,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(_t){return _t.done?_t.value:rt.next()})},ct(at),h(at,d,"Generator"),h(at,o,function(){return this}),h(at,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var b in l)s.push(b);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=yt,ft.prototype={constructor:ft,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(wt),!l)for(var s in this)s.charAt(0)==="t"&&r.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function b(St,x){return rt.type="throw",rt.arg=l,s.next=St,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return b("end");if(E.tryLoc<=this.prev){var _t=r.call(E,"catchLoc"),xt=r.call(E,"finallyLoc");if(_t&&xt){if(this.prev<E.catchLoc)return b(E.catchLoc,!0);if(this.prev<E.finallyLoc)return b(E.finallyLoc)}else if(_t){if(this.prev<E.catchLoc)return b(E.catchLoc,!0)}else{if(!xt)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return b(E.finallyLoc)}}}},abrupt:function(l,s){for(var b=this.tryEntries.length-1;b>=0;--b){var $=this.tryEntries[b];if($.tryLoc<=this.prev&&r.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,A):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),A},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.finallyLoc===l)return this.complete(b.completion,b.afterLoc),wt(b),A}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.tryLoc===l){var $=b.completion;if($.type==="throw"){var E=$.arg;wt(b)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,b){return this.delegate={iterator:yt(l),resultName:s,nextLoc:b},this.method==="next"&&(this.arg=void 0),A}},t}function asyncGeneratorStep(t,e,r,n,o,f,d){try{var h=t[f](d),y=h.value}catch(k){return void r(k)}h.done?e(y):Promise.resolve(y).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var f=t.apply(e,r);function d(y){asyncGeneratorStep(f,n,o,d,h,"next",y)}function h(y){asyncGeneratorStep(f,n,o,d,h,"throw",y)}d(void 0)})}}function _createForOfIteratorHelper(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){r=r.call(t)},n:function(){var y=r.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||r.return==null||r.return()}finally{if(h)throw f}}}}function _unsupportedIterableToArray(t,e){if(t){if(typeof t=="string")return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(n){_defineProperty(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ConditionalFilter(t){var e=t.rule;return{name:"Conditional Filter",func:function(r){return r.map(function(n){return isMatch(e,n)})}}}function isMatch(t,e){if(!t.operator)switch(t.proposition){case"IN":return t.value.indexOf(e[t.attr])!==-1;case"CONTAINS":return typeof e[t.attr]=="string"&&e[t.attr].indexOf(t.value)!==-1;case"EQUALS":return e[t.attr]===t.value;case"EXISTS":return e[t.attr]!==null||e[t.attr]!==void 0;default:throw new Error("Unknown proposition: ".concat(t.proposition))}switch(t.operator){case"AND":return t.child.every(function(r){return isMatch(r,e)});case"OR":return t.child.some(function(r){return isMatch(r,e)});case"NOT":return!isMatch(t.child,e);default:throw new Error("Unknown operator: ".concat(t.operator))}}function QuickSettingOperator(t){return{name:"Quick Setting Operator",func:function(r){if(e(t.useless)){var n=UselessFilter().func(r);r=r.filter(function(o,f){return n[f]&&o.port>0&&o.port<=65535})}return r.map(function(o){return o.udp=e(t.udp,o.udp),o.tfo=e(t.tfo,o.tfo),o["fast-open"]=e(t.tfo,o["fast-open"]),o["skip-cert-verify"]=e(t.scert,o["skip-cert-verify"]),o.type==="vmess"&&(o.aead=e(t["vmess aead"],o.aead)),o})}};function e(r,n){switch(r){case"ENABLED":return!0;case"DISABLED":return!1;default:return n}}}function FlagOperator(t){var e=t.mode,r=t.tw;return{name:"Flag Operator",func:function(n){return n.map(function(o){if(e==="remove")o.name=(0,_$geo_138.removeFlag)(o.name);else{var f=(0,_$geo_138.getFlag)(o.name);o.name=(0,_$geo_138.removeFlag)(o.name),o.name=f+" "+o.name,r=="ws"?o.name=o.name.replace(/\ud83c\uddf9\ud83c\uddfc/g,"\u{1F1FC}\u{1F1F8}"):r=="tw"||(o.name=o.name.replace(/\ud83c\uddf9\ud83c\uddfc/g,"\u{1F1E8}\u{1F1F3}"))}return o})}}}function HandleDuplicateOperator(t){var e=_objectSpread(_objectSpread({},{action:"rename",template:"0 1 2 3 4 5 6 7 8 9",link:"-",position:"back"}),t),r=e.action,n=e.template,o=e.link,f=e.position;return{name:"Handle Duplicate Operator",func:function(d){if(r==="delete"){var h={};return d.filter(function(q){return!h[q.name]&&(h[q.name]=!0,!0)})}if(r==="rename"){var y=n.split(" "),k={},A=0;d.forEach(function(q){k[q.name]===void 0?k[q.name]=1:k[q.name]++,A=Math.max(k[q.name].toString().length,A)});var D={};return d.map(function(q){if(k[q.name]>1){D[q.name]===void 0&&(D[q.name]=1);for(var H="",z=D[q.name]++,Z=0;z>0;)H=y[z%10]+H,z=parseInt(z/10),Z++;for(;Z++<A;)H=y[0]+H;f==="front"?q.name=H+o+q.name:f==="back"&&(q.name=q.name+o+H)}return q})}}}}function SortOperator(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"asc";return{name:"Sort Operator",func:function(e){switch(t){case"asc":case"desc":return e.sort(function(r,n){return(r.name>n.name?1:-1)*(t==="desc"?-1:1)});case"random":return shuffle(e);default:throw new Error("Unknown sort option: "+t)}}}}function RegexSortOperator(t){return{name:"Regex Sort Operator",func:function(e){return t=t.map(function(r){return buildRegex(r)}),e.sort(function(r,n){var o=getRegexOrder(t,r.name),f=getRegexOrder(t,n.name);return o&&!f?-1:f&&!o?1:o&&f?o<f?-1:1:!o&&!f||o&&f&&o===f?r.name<n.name?-1:1:void 0})}}}function getRegexOrder(t,e){for(var r=null,n=0;n<t.length;n++)if(t[n].test(e)){r=n+1;break}return r}function RegexRenameOperator(t){return{name:"Regex Rename Operator",func:function(e){return e.map(function(r){var n,o=_createForOfIteratorHelper(t);try{for(o.s();!(n=o.n()).done;){var f=n.value,d=f.expr,h=f.now;r.name=r.name.replace(buildRegex(d,"g"),h).trim()}}catch(y){o.e(y)}finally{o.f()}return r})}}}function RegexDeleteOperator(t){return{name:"Regex Delete Operator",func:RegexRenameOperator(t.map(function(e){return{expr:e,now:""}})).func}}function ScriptOperator(t,e,r,n,o){return{name:"Script Operator",func:(d=_asyncToGenerator(_regeneratorRuntime().mark(function h(y){var k;return _regeneratorRuntime().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return k=y,A.next=3,_asyncToGenerator(_regeneratorRuntime().mark(function D(){var q;return _regeneratorRuntime().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:q=createDynamicFunction("operator",t,r,o),k=q(y,e,_objectSpread({source:n},_env.default));case 2:case"end":return H.stop()}},D)}))();case 3:return A.abrupt("return",k);case 4:case"end":return A.stop()}},h)})),function(h){return d.apply(this,arguments)}),nodeFunc:(f=_asyncToGenerator(_regeneratorRuntime().mark(function h(y){var k;return _regeneratorRuntime().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return k=y,A.next=3,_asyncToGenerator(_regeneratorRuntime().mark(function D(){var q;return _regeneratorRuntime().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:q=createDynamicFunction("operator",`async function operator(input = []) {
                        if (input && (input.$files || input.$content)) {
                            let { $content, $files, $options } = input
                            `.concat(t,`
                            return { $content, $files, $options }
                        } else {
                            let proxies = input
                            let list = []
                            for await (let $server of proxies) {
                                `).concat(t,`
                                list.push($server)
                            }
                            return list
                        }
                      }`),r,o),k=q(y,e,_objectSpread({source:n},_env.default));case 2:case"end":return H.stop()}},D)}))();case 3:return A.abrupt("return",k);case 4:case"end":return A.stop()}},h)})),function(h){return f.apply(this,arguments)})};var f,d}function parseIP4P(t){var e,r;try{var n=t.split(":");r=parseInt(n[2],16);var o=parseInt(n[3],16),f=parseInt(n[4],16),d=255&o,h=f>>8,y=255&f;if(e="".concat(o>>8,".").concat(d,".").concat(h,".").concat(y),r<=0||r>65535)throw new Error("Invalid port number: ".concat(r));if(!(0,_$utils_141.isIPv4)(e))throw new Error("Invalid IP address: ".concat(e))}catch(k){_app.default.error("IP4P \u89E3\u6790\u5931\u8D25: ".concat(k))}return{server:e,port:r}}var DOMAIN_RESOLVERS={Custom:(_Custom=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,r,n,o,f,d){var h,y,k,A,D,q;return _regeneratorRuntime().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(h=(0,_$md5_150.hex_md5)("CUSTOM:".concat(d,":").concat(e,":").concat(r)),y=_resourceCache.default.get(h),n||!y){H.next=4;break}return H.abrupt("return",y);case 4:return k=r==="IPv6"?"AAAA":"A",H.next=7,(0,_$dns_134.doh)({url:d,domain:e,type:k,timeout:o,edns:f});case 7:if(A=H.sent,D=A.answers,Array.isArray(D)&&D.length!==0){H.next=11;break}throw new Error("No answers");case 11:if((q=D.filter(function(z){return z?.type===k}).map(function(z){return z?.data}).filter(function(z){return z})).length!==0){H.next=14;break}throw new Error("No answers");case 14:return _resourceCache.default.set(h,q),H.abrupt("return",q);case 16:case"end":return H.stop()}},t)})),function(t,e,r,n,o,f){return _Custom.apply(this,arguments)}),Google:(_Google=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,r,n,o,f){var d,h,y,k,A,D;return _regeneratorRuntime().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(d=(0,_$md5_150.hex_md5)("GOOGLE:".concat(e,":").concat(r)),h=_resourceCache.default.get(d),n||!h){q.next=4;break}return q.abrupt("return",h);case 4:return y=r==="IPv6"?"AAAA":"A",q.next=7,(0,_$dns_134.doh)({url:"https://8.8.4.4/dns-query",domain:e,type:y,timeout:o,edns:f});case 7:if(k=q.sent,A=k.answers,Array.isArray(A)&&A.length!==0){q.next=11;break}throw new Error("No answers");case 11:if((D=A.filter(function(H){return H?.type===y}).map(function(H){return H?.data}).filter(function(H){return H})).length!==0){q.next=14;break}throw new Error("No answers");case 14:return _resourceCache.default.set(d,D),q.abrupt("return",D);case 16:case"end":return q.stop()}},t)})),function(t,e,r,n,o){return _Google.apply(this,arguments)}),"IP-API":(_IPAPI=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,r,n,o){var f,d,h,y,k;return _regeneratorRuntime().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(!["IPv6"].includes(r)){A.next=2;break}throw new Error("\u57DF\u540D\u89E3\u6790\u670D\u52A1\u63D0\u4F9B\u65B9 IP-API \u4E0D\u652F\u6301 ".concat(r));case 2:if(f=(0,_$md5_150.hex_md5)("IP-API:".concat(e)),d=_resourceCache.default.get(f),n||!d){A.next=6;break}return A.abrupt("return",d);case 6:return A.next=8,_app.default.http.get({url:"http://ip-api.com/json/".concat(encodeURIComponent(e),"?lang=zh-CN"),timeout:o});case 8:if(h=A.sent,(y=JSON.parse(h.body)).status==="success"){A.next=12;break}throw new Error("Status is ".concat(y.status));case 12:if(y.query&&y.query!==0){A.next=14;break}throw new Error("No answers");case 14:if((k=[y.query]).length!==0){A.next=17;break}throw new Error("No answers");case 17:return _resourceCache.default.set(f,k),A.abrupt("return",k);case 19:case"end":return A.stop()}},t)})),function(t,e,r,n){return _IPAPI.apply(this,arguments)}),Cloudflare:(_Cloudflare=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,r,n,o,f){var d,h,y,k,A,D;return _regeneratorRuntime().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(d=(0,_$md5_150.hex_md5)("CLOUDFLARE:".concat(e,":").concat(r)),h=_resourceCache.default.get(d),n||!h){q.next=4;break}return q.abrupt("return",h);case 4:return y=r==="IPv6"?"AAAA":"A",q.next=7,(0,_$dns_134.doh)({url:"https://1.0.0.1/dns-query",domain:e,type:y,timeout:o,edns:f});case 7:if(k=q.sent,A=k.answers,Array.isArray(A)&&A.length!==0){q.next=11;break}throw new Error("No answers");case 11:if((D=A.filter(function(H){return H?.type===y}).map(function(H){return H?.data}).filter(function(H){return H})).length!==0){q.next=14;break}throw new Error("No answers");case 14:return _resourceCache.default.set(d,D),q.abrupt("return",D);case 16:case"end":return q.stop()}},t)})),function(t,e,r,n,o){return _Cloudflare.apply(this,arguments)}),Ali:(_Ali=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,r,n,o,f){var d,h,y,k,A;return _regeneratorRuntime().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(d=(0,_$md5_150.hex_md5)("ALI:".concat(e,":").concat(r)),h=_resourceCache.default.get(d),n||!h){D.next=4;break}return D.abrupt("return",h);case 4:return D.next=6,_app.default.http.get({url:"http://223.6.6.6/resolve?edns_client_subnet=".concat(f,"/24&name=").concat(encodeURIComponent(e),"&type=").concat(r==="IPv6"?"AAAA":"A","&short=1"),headers:{accept:"application/dns-json"},timeout:o});case 6:if(y=D.sent,k=JSON.parse(y.body),Array.isArray(k)&&k.length!==0){D.next=10;break}throw new Error("No answers");case 10:if((A=k).length!==0){D.next=13;break}throw new Error("No answers");case 13:return _resourceCache.default.set(d,A),D.abrupt("return",A);case 15:case"end":return D.stop()}},t)})),function(t,e,r,n,o){return _Ali.apply(this,arguments)}),Tencent:(_Tencent=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,r,n,o,f){var d,h,y,k,A;return _regeneratorRuntime().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(d=(0,_$md5_150.hex_md5)("TENCENT:".concat(e,":").concat(r)),h=_resourceCache.default.get(d),n||!h){D.next=4;break}return D.abrupt("return",h);case 4:return D.next=6,_app.default.http.get({url:"http://119.28.28.28/d?ip=".concat(f,"&type=").concat(r==="IPv6"?"AAAA":"A","&dn=").concat(encodeURIComponent(e)),headers:{accept:"application/dns-json"},timeout:o});case 6:if(y=D.sent,(k=y.body.split(";").map(function(q){return q.split(",")[0]})).length!==0&&String(k)!=="0"){D.next=10;break}throw new Error("No answers");case 10:if((A=k).length!==0){D.next=13;break}throw new Error("No answers");case 13:return _resourceCache.default.set(d,A),D.abrupt("return",A);case 15:case"end":return D.stop()}},t)})),function(t,e,r,n,o){return _Tencent.apply(this,arguments)})},_Tencent,_Ali,_Cloudflare,_IPAPI,_Google,_Custom;function ResolveDomainOperator(t){var e=t.provider,r=t.type,n=t.filter,o=t.cache,f=t.url,d=t.timeout,h=t.edns;if(["IPv6","IP4P"].includes(r)&&["IP-API"].includes(e))throw new Error("\u57DF\u540D\u89E3\u6790\u670D\u52A1\u63D0\u4F9B\u65B9 ".concat(e," \u4E0D\u652F\u6301 ").concat(r));var y=_app.default.read(_$constants_86.SETTINGS_KEY).defaultTimeout,k=d||y||8e3,A=["IPv6","IP4P"].includes(r)?"IPv6":"IPv4",D=DOMAIN_RESOLVERS[e];if(!D)throw new Error("\u627E\u4E0D\u5230\u57DF\u540D\u89E3\u6790\u670D\u52A1\u63D0\u4F9B\u65B9: ".concat(e));var q,H=h||"223.6.6.6";if(!isIP(H))throw new Error("\u57DF\u540D\u89E3\u6790 EDNS \u5E94\u4E3A IP");return _app.default.info("Domain Resolver: [".concat(r,"] ").concat(e," ").concat(H||""," ").concat(f||"")),{name:"Resolve Domain Operator",func:(q=_asyncToGenerator(_regeneratorRuntime().mark(function z(Z){var j,at,ct,ot,tt,gt,wt,ft,yt;return _regeneratorRuntime().wrap(function(Ct){for(;;)switch(Ct.prev=Ct.next){case 0:Z.forEach(function(l,s){!l["_no-resolve"]&&l["no-resolve"]&&(Z[s]["_no-resolve"]=l["no-resolve"])}),j={},at=15,ct=_toConsumableArray(new Set(Z.filter(function(l){return!isIP(l.server)&&!l["_no-resolve"]}).map(function(l){return l.server}))),ot=Math.ceil(ct.length/at),tt=0;case 6:if(!(tt<ot)){Ct.next=15;break}gt=[],wt=_createForOfIteratorHelper(ct.splice(0,at));try{for(yt=function(){var l=ft.value;gt.push(D(l,A,o==="disabled",k,H,f).then(function(s){j[l]=s,_app.default.info("Successfully resolved domain: ".concat(l," \u279F ").concat(s))}).catch(function(s){_app.default.error("Failed to resolve domain: ".concat(l," with resolver [").concat(e,"]: ").concat(s))}))},wt.s();!(ft=wt.n()).done;)yt()}catch(l){wt.e(l)}finally{wt.f()}return Ct.next=12,Promise.all(gt);case 12:tt++,Ct.next=6;break;case 15:return Z.forEach(function(l){if(!l["_no-resolve"])if(j[l.server]){l._resolved_ips=j[l.server];var s=Array.isArray(j[l.server])?j[l.server][Math.floor(Math.random()*j[l.server].length)]:j[l.server];if(A==="IPv6"&&(0,_$utils_141.isIPv6)(s)){try{s=new _$utils_141.ipAddress.Address6(s).correctForm()}catch(rt){_app.default.error("Failed to parse IPv6 address: ".concat(s,": ").concat(rt))}if(/^2001::[^:]+:[^:]+:[^:]+$/.test(s)){l._IP4P=s;var b=parseIP4P(s),$=b.server,E=b.port;$&&E?(l._domain=l.server,l.server=$,l.port=E,l.resolved=!0,l._IPv4=l.server,isIP(l._IP)||(l._IP=l.server)):l.resolved||(l.resolved=!1)}else l._domain=l.server,l.server=s,l.resolved=!0,l["_".concat(A)]=l.server,isIP(l._IP)||(l._IP=l.server)}else l._domain=l.server,l.server=s,l.resolved=!0,l["_".concat(A)]=l.server,isIP(l._IP)||(l._IP=l.server)}else l.resolved||(l.resolved=!1)}),Ct.abrupt("return",Z.filter(function(l){return n==="removeFailed"?isIP(l.server)||l["_no-resolve"]||l.resolved:n==="IPOnly"?isIP(l.server):n==="IPv4Only"?(0,_$utils_141.isIPv4)(l.server):n!=="IPv6Only"||(0,_$utils_141.isIPv6)(l.server)}));case 17:case"end":return Ct.stop()}},z)})),function(z){return q.apply(this,arguments)})}}function isIP(t){return(0,_$utils_141.isIPv4)(t)||(0,_$utils_141.isIPv6)(t)}function isAscii(t){return/^[\x00-\x7F]+$/.test(t)}function UselessFilter(){return{name:"Useless Filter",func:function(t){return t.map(function(e){if(e.cipher&&!isAscii(e.cipher)||e.password&&!isAscii(e.password))return!1;if(e.network){var r,n,o,f,d=((r=e["".concat(e.network,"-opts")])===null||r===void 0||(n=r.headers)===null||n===void 0?void 0:n.Host)||((o=e["".concat(e.network,"-opts")])===null||o===void 0||(f=o.headers)===null||f===void 0?void 0:f.host);if((d=Array.isArray(d)?d:[d]).some(function(h){return h&&!isAscii(h)}))return!1}return!/\u7f51\u5740|\u6d41\u91cf|\u65f6\u95f4|\u5e94\u6025|\u8fc7\u671f|Bandwidth|expire/.test(e.name)})}}}function RegionFilter(t){var e={HK:"\u{1F1ED}\u{1F1F0}",TW:"\u{1F1F9}\u{1F1FC}",US:"\u{1F1FA}\u{1F1F8}",SG:"\u{1F1F8}\u{1F1EC}",JP:"\u{1F1EF}\u{1F1F5}",UK:"\u{1F1EC}\u{1F1E7}",DE:"\u{1F1E9}\u{1F1EA}",KR:"\u{1F1F0}\u{1F1F7}"};return{name:"Region Filter",func:function(r){return r.map(function(n){var o=(0,_$geo_138.getFlag)(n.name);return t.some(function(f){return e[f]===o})})}}}function RegexFilter(t){var e=t.regex,r=e===void 0?[]:e,n=t.keep,o=n===void 0||n;return{name:"Regex Filter",func:function(f){return f.map(function(d){var h=r.some(function(y){return buildRegex(y).test(d.name)});return o?h:!h})}}}function buildRegex(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return r=r.join(""),t.startsWith("(?i)")?(t=t.substring(4),new RegExp(t,"i"+r)):new RegExp(t,r)}function TypeFilter(t){return{name:"Type Filter",func:function(e){return e.map(function(r){return t.some(function(n){return r.type===n})})}}}function ScriptFilter(t,e,r,n,o){return{name:"Script Filter",func:(d=_asyncToGenerator(_regeneratorRuntime().mark(function h(y){var k;return _regeneratorRuntime().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return k=(0,_$logical_142.FULL)(y.length,!0),A.next=3,_asyncToGenerator(_regeneratorRuntime().mark(function D(){var q;return _regeneratorRuntime().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:q=createDynamicFunction("filter",t,r,o),k=q(y,e,_objectSpread({source:n},_env.default));case 2:case"end":return H.stop()}},D)}))();case 3:return A.abrupt("return",k);case 4:case"end":return A.stop()}},h)})),function(h){return d.apply(this,arguments)}),nodeFunc:(f=_asyncToGenerator(_regeneratorRuntime().mark(function h(y){var k;return _regeneratorRuntime().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return k=(0,_$logical_142.FULL)(y.length,!0),A.next=3,_asyncToGenerator(_regeneratorRuntime().mark(function D(){var q;return _regeneratorRuntime().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:q=createDynamicFunction("filter",`async function filter(input = []) {
                        let proxies = input
                        let list = []
                        const fn = async ($server) => {
                            `.concat(t,`
                        }
                        for await (let $server of proxies) {
                            list.push(await fn($server))
                        }
                        return list
                      }`),r,o),k=q(y,e,_objectSpread({source:n},_env.default));case 2:case"end":return H.stop()}},D)}))();case 3:return A.abrupt("return",k);case 4:case"end":return A.stop()}},h)})),function(h){return f.apply(this,arguments)})};var f,d}ResolveDomainOperator.resolver=DOMAIN_RESOLVERS;var _default={"Useless Filter":UselessFilter,"Region Filter":RegionFilter,"Regex Filter":RegexFilter,"Type Filter":TypeFilter,"Script Filter":ScriptFilter,"Conditional Filter":ConditionalFilter,"Quick Setting Operator":QuickSettingOperator,"Flag Operator":FlagOperator,"Sort Operator":SortOperator,"Regex Sort Operator":RegexSortOperator,"Regex Rename Operator":RegexRenameOperator,"Regex Delete Operator":RegexDeleteOperator,"Script Operator":ScriptOperator,"Handle Duplicate Operator":HandleDuplicateOperator,"Resolve Domain Operator":ResolveDomainOperator};function ApplyFilter(t,e){return _ApplyFilter.apply(this,arguments)}function _ApplyFilter(){return(_ApplyFilter=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,r){var n,o,f,d,h,y,k;return _regeneratorRuntime().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return n=(0,_$logical_142.FULL)(r.length,!0),A.prev=1,A.next=4,e.func(r);case 4:n=A.sent,A.next=25;break;case 7:return A.prev=7,A.t0=A.catch(1),f="",(d="".concat((o=A.t0.message)!==null&&o!==void 0?o:A.t0)).includes("$server is not defined")?f="":(_app.default.error("Cannot apply filter ".concat(e.name,"(function filter)! Reason: ").concat(A.t0)),f="\u6267\u884C function filter \u5931\u8D25 ".concat(d,"; ")),A.prev=12,A.next=15,e.nodeFunc(r);case 15:n=A.sent,A.next=25;break;case 18:throw A.prev=18,A.t1=A.catch(12),_app.default.error("Cannot apply filter ".concat(e.name,"(shortcut script)! Reason: ").concat(A.t1)),y="",k="".concat((h=A.t1.message)!==null&&h!==void 0?h:A.t1),f&&k===d?(y="",f="\u6267\u884C\u5931\u8D25 ".concat(d)):y="\u6267\u884C\u5FEB\u6377\u8FC7\u6EE4\u811A\u672C \u5931\u8D25 ".concat(k),new Error("\u811A\u672C\u8FC7\u6EE4 ".concat(f).concat(y));case 25:return A.abrupt("return",r.filter(function(D,q){return n[q]}));case 26:case"end":return A.stop()}},t,null,[[1,7],[12,18]])}))).apply(this,arguments)}function ApplyOperator(t,e){return _ApplyOperator.apply(this,arguments)}function _ApplyOperator(){return(_ApplyOperator=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,r){var n,o,f,d,h,y,k,A,D,q,H;return _regeneratorRuntime().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return n=clone(r),z.prev=1,z.next=4,e.func(n);case 4:(o=z.sent)&&(n=o),z.next=27;break;case 8:return z.prev=8,z.t0=z.catch(1),y="",(k="".concat((f=z.t0.message)!==null&&f!==void 0?f:z.t0)).includes("$server is not defined")||k.includes("$content is not defined")||k.includes("$files is not defined")||(d=n)!==null&&d!==void 0&&d.$files||(h=n)!==null&&h!==void 0&&h.$content?y="":(_app.default.error("Cannot apply operator ".concat(e.name,"(function operator)! Reason: ").concat(z.t0)),y="\u6267\u884C function operator \u5931\u8D25 ".concat(k,"; ")),z.prev=13,z.next=16,e.nodeFunc(n);case 16:(A=z.sent)&&(n=A),z.next=27;break;case 20:throw z.prev=20,z.t1=z.catch(13),_app.default.error("Cannot apply operator ".concat(e.name,"(shortcut script)! Reason: ").concat(z.t1)),q="",H="".concat((D=z.t1.message)!==null&&D!==void 0?D:z.t1),y&&H===k?(q="",y="\u6267\u884C\u5931\u8D25 ".concat(k)):q="\u6267\u884C\u5FEB\u6377\u811A\u672C \u5931\u8D25 ".concat(H),new Error("\u811A\u672C\u64CD\u4F5C ".concat(y).concat(q));case 27:return z.abrupt("return",n);case 28:case"end":return z.stop()}},t,null,[[1,8],[13,20]])}))).apply(this,arguments)}function ApplyProcessor(t,e){return _ApplyProcessor.apply(this,arguments)}function _ApplyProcessor(){return(_ApplyProcessor=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,r){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e.name.indexOf("Filter")===-1){n.next=4;break}return n.abrupt("return",ApplyFilter(e,r));case 4:if(e.name.indexOf("Operator")===-1){n.next=6;break}return n.abrupt("return",ApplyOperator(e,r));case 6:case"end":return n.stop()}},t)}))).apply(this,arguments)}function shuffle(t){for(var e,r,n=t.length;n!==0;)r=Math.floor(Math.random()*n),e=t[n-=1],t[n]=t[r],t[r]=e;return t}function clone(t){return JSON.parse(JSON.stringify(t))}function createDynamicFunction(name,script,$arguments,$options){var flowUtils={getFlowField:_$flow_137.getFlowField,getFlowHeaders:_$flow_137.getFlowHeaders,parseFlowHeaders:_$flow_137.parseFlowHeaders,flowTransfer:_$flow_137.flowTransfer,validCheck:_$flow_137.validCheck,getRmainingDays:_$flow_137.getRmainingDays};return _app.default.env.isLoon?new Function("$arguments","$options","$substore","lodash","$persistentStore","$httpClient","$notification","ProxyUtils","scriptResourceCache","flowUtils","produceArtifact","require","".concat(script,`
 return `).concat(name))($arguments,$options,_app.default,_lodash.default,$persistentStore,$httpClient,$notification,_2.ProxyUtils,_scriptResourceCache.default,flowUtils,_sync.produceArtifact,eval('typeof require !== "undefined"')?require:void 0):new Function("$arguments","$options","$substore","lodash","ProxyUtils","scriptResourceCache","flowUtils","produceArtifact","require","".concat(script,`
 return `).concat(name))($arguments,$options,_app.default,_lodash.default,_2.ProxyUtils,_scriptResourceCache.default,flowUtils,_sync.produceArtifact,eval('typeof require !== "undefined"')?require:void 0)}exports.default=_default}),_$buffer_3=createModuleFactory(function(t,e){(function(r){(function(){"use strict";e.Buffer=o,e.SlowBuffer=function(S){return+S!=S&&(S=0),o.alloc(+S)},e.INSPECT_MAX_BYTES=50;function n(S){if(S>2147483647)throw new RangeError('The value "'+S+'" is invalid for option "size"');var C=new Uint8Array(S);return C.__proto__=o.prototype,C}function o(S,C,T){if(typeof S=="number"){if(typeof C=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h(S)}return f(S,C,T)}function f(S,C,T){if(typeof S=="string")return function(Pt,Ut){if(typeof Ut=="string"&&Ut!==""||(Ut="utf8"),!o.isEncoding(Ut))throw new TypeError("Unknown encoding: "+Ut);var Zt=0|A(Pt,Ut),_e=n(Zt),me=_e.write(Pt,Ut);return me!==Zt&&(_e=_e.slice(0,me)),_e}(S,C);if(ArrayBuffer.isView(S))return y(S);if(S==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof S);if(N(S,ArrayBuffer)||S&&N(S.buffer,ArrayBuffer))return function(Pt,Ut,Zt){if(Ut<0||Pt.byteLength<Ut)throw new RangeError('"offset" is outside of buffer bounds');if(Pt.byteLength<Ut+(Zt||0))throw new RangeError('"length" is outside of buffer bounds');var _e;return(_e=Ut===void 0&&Zt===void 0?new Uint8Array(Pt):Zt===void 0?new Uint8Array(Pt,Ut):new Uint8Array(Pt,Ut,Zt)).__proto__=o.prototype,_e}(S,C,T);if(typeof S=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var M=S.valueOf&&S.valueOf();if(M!=null&&M!==S)return o.from(M,C,T);var et=function(Pt){if(o.isBuffer(Pt)){var Ut=0|k(Pt.length),Zt=n(Ut);return Zt.length===0||Pt.copy(Zt,0,0,Ut),Zt}return Pt.length!==void 0?typeof Pt.length!="number"||V(Pt.length)?n(0):y(Pt):Pt.type==="Buffer"&&Array.isArray(Pt.data)?y(Pt.data):void 0}(S);if(et)return et;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof S[Symbol.toPrimitive]=="function")return o.from(S[Symbol.toPrimitive]("string"),C,T);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof S)}function d(S){if(typeof S!="number")throw new TypeError('"size" argument must be of type number');if(S<0)throw new RangeError('The value "'+S+'" is invalid for option "size"')}function h(S){return d(S),n(S<0?0:0|k(S))}function y(S){for(var C=S.length<0?0:0|k(S.length),T=n(C),M=0;M<C;M+=1)T[M]=255&S[M];return T}function k(S){if(S>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|S}function A(S,C){if(o.isBuffer(S))return S.length;if(ArrayBuffer.isView(S)||N(S,ArrayBuffer))return S.byteLength;if(typeof S!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof S);var T=S.length,M=arguments.length>2&&arguments[2]===!0;if(!M&&T===0)return 0;for(var et=!1;;)switch(C){case"ascii":case"latin1":case"binary":return T;case"utf8":case"utf-8":return xt(S).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*T;case"hex":return T>>>1;case"base64":return St(S).length;default:if(et)return M?-1:xt(S).length;C=(""+C).toLowerCase(),et=!0}}function D(S,C,T){var M=S[C];S[C]=S[T],S[T]=M}function q(S,C,T,M,et){if(S.length===0)return-1;if(typeof T=="string"?(M=T,T=0):T>2147483647?T=2147483647:T<-2147483648&&(T=-2147483648),V(T=+T)&&(T=et?0:S.length-1),T<0&&(T=S.length+T),T>=S.length){if(et)return-1;T=S.length-1}else if(T<0){if(!et)return-1;T=0}if(typeof C=="string"&&(C=o.from(C,M)),o.isBuffer(C))return C.length===0?-1:H(S,C,T,M,et);if(typeof C=="number")return C&=255,typeof Uint8Array.prototype.indexOf=="function"?et?Uint8Array.prototype.indexOf.call(S,C,T):Uint8Array.prototype.lastIndexOf.call(S,C,T):H(S,[C],T,M,et);throw new TypeError("val must be string, number or Buffer")}function H(S,C,T,M,et){var Pt,Ut=1,Zt=S.length,_e=C.length;if(M!==void 0&&((M=String(M).toLowerCase())==="ucs2"||M==="ucs-2"||M==="utf16le"||M==="utf-16le")){if(S.length<2||C.length<2)return-1;Ut=2,Zt/=2,_e/=2,T/=2}function me(pe,ge){return Ut===1?pe[ge]:pe.readUInt16BE(ge*Ut)}if(et){var de=-1;for(Pt=T;Pt<Zt;Pt++)if(me(S,Pt)===me(C,de===-1?0:Pt-de)){if(de===-1&&(de=Pt),Pt-de+1===_e)return de*Ut}else de!==-1&&(Pt-=Pt-de),de=-1}else for(T+_e>Zt&&(T=Zt-_e),Pt=T;Pt>=0;Pt--){for(var Xt=!0,Gt=0;Gt<_e;Gt++)if(me(S,Pt+Gt)!==me(C,Gt)){Xt=!1;break}if(Xt)return Pt}return-1}function z(S,C,T,M){T=Number(T)||0;var et=S.length-T;M?(M=Number(M))>et&&(M=et):M=et;var Pt=C.length;M>Pt/2&&(M=Pt/2);for(var Ut=0;Ut<M;++Ut){var Zt=parseInt(C.substr(2*Ut,2),16);if(V(Zt))return Ut;S[T+Ut]=Zt}return Ut}function Z(S,C,T,M){return x(xt(C,S.length-T),S,T,M)}function j(S,C,T,M){return x(function(et){for(var Pt=[],Ut=0;Ut<et.length;++Ut)Pt.push(255&et.charCodeAt(Ut));return Pt}(C),S,T,M)}function at(S,C,T,M){return j(S,C,T,M)}function ct(S,C,T,M){return x(St(C),S,T,M)}function ot(S,C,T,M){return x(function(et,Pt){for(var Ut,Zt,_e,me=[],de=0;de<et.length&&!((Pt-=2)<0);++de)Zt=(Ut=et.charCodeAt(de))>>8,_e=Ut%256,me.push(_e),me.push(Zt);return me}(C,S.length-T),S,T,M)}function tt(S,C,T){return C===0&&T===S.length?_$base64Js_2.fromByteArray(S):_$base64Js_2.fromByteArray(S.slice(C,T))}function gt(S,C,T){T=Math.min(S.length,T);for(var M=[],et=C;et<T;){var Pt,Ut,Zt,_e,me=S[et],de=null,Xt=me>239?4:me>223?3:me>191?2:1;if(et+Xt<=T)switch(Xt){case 1:me<128&&(de=me);break;case 2:(192&(Pt=S[et+1]))==128&&(_e=(31&me)<<6|63&Pt)>127&&(de=_e);break;case 3:Pt=S[et+1],Ut=S[et+2],(192&Pt)==128&&(192&Ut)==128&&(_e=(15&me)<<12|(63&Pt)<<6|63&Ut)>2047&&(_e<55296||_e>57343)&&(de=_e);break;case 4:Pt=S[et+1],Ut=S[et+2],Zt=S[et+3],(192&Pt)==128&&(192&Ut)==128&&(192&Zt)==128&&(_e=(15&me)<<18|(63&Pt)<<12|(63&Ut)<<6|63&Zt)>65535&&_e<1114112&&(de=_e)}de===null?(de=65533,Xt=1):de>65535&&(de-=65536,M.push(de>>>10&1023|55296),de=56320|1023&de),M.push(de),et+=Xt}return function(Gt){var pe=Gt.length;if(pe<=wt)return String.fromCharCode.apply(String,Gt);for(var ge="",Dt=0;Dt<pe;)ge+=String.fromCharCode.apply(String,Gt.slice(Dt,Dt+=wt));return ge}(M)}e.kMaxLength=2147483647,o.TYPED_ARRAY_SUPPORT=function(){try{var S=new Uint8Array(1);return S.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},S.foo()===42}catch{return!1}}(),o.TYPED_ARRAY_SUPPORT||typeof console>"u",Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),o.poolSize=8192,o.from=function(S,C,T){return f(S,C,T)},o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,o.alloc=function(S,C,T){return function(M,et,Pt){return d(M),M<=0?n(M):et!==void 0?typeof Pt=="string"?n(M).fill(et,Pt):n(M).fill(et):n(M)}(S,C,T)},o.allocUnsafe=function(S){return h(S)},o.allocUnsafeSlow=function(S){return h(S)},o.isBuffer=function(S){return S!=null&&S._isBuffer===!0&&S!==o.prototype},o.compare=function(S,C){if(N(S,Uint8Array)&&(S=o.from(S,S.offset,S.byteLength)),N(C,Uint8Array)&&(C=o.from(C,C.offset,C.byteLength)),!o.isBuffer(S)||!o.isBuffer(C))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(S===C)return 0;for(var T=S.length,M=C.length,et=0,Pt=Math.min(T,M);et<Pt;++et)if(S[et]!==C[et]){T=S[et],M=C[et];break}return T<M?-1:M<T?1:0},o.isEncoding=function(S){switch(String(S).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(S,C){if(!Array.isArray(S))throw new TypeError('"list" argument must be an Array of Buffers');if(S.length===0)return o.alloc(0);var T;if(C===void 0)for(C=0,T=0;T<S.length;++T)C+=S[T].length;var M=o.allocUnsafe(C),et=0;for(T=0;T<S.length;++T){var Pt=S[T];if(N(Pt,Uint8Array)&&(Pt=o.from(Pt)),!o.isBuffer(Pt))throw new TypeError('"list" argument must be an Array of Buffers');Pt.copy(M,et),et+=Pt.length}return M},o.byteLength=A,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var S=this.length;if(S%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var C=0;C<S;C+=2)D(this,C,C+1);return this},o.prototype.swap32=function(){var S=this.length;if(S%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var C=0;C<S;C+=4)D(this,C,C+3),D(this,C+1,C+2);return this},o.prototype.swap64=function(){var S=this.length;if(S%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var C=0;C<S;C+=8)D(this,C,C+7),D(this,C+1,C+6),D(this,C+2,C+5),D(this,C+3,C+4);return this},o.prototype.toString=function(){var S=this.length;return S===0?"":arguments.length===0?gt(this,0,S):function(C,T,M){var et=!1;if((T===void 0||T<0)&&(T=0),T>this.length||((M===void 0||M>this.length)&&(M=this.length),M<=0)||(M>>>=0)<=(T>>>=0))return"";for(C||(C="utf8");;)switch(C){case"hex":return Ct(this,T,M);case"utf8":case"utf-8":return gt(this,T,M);case"ascii":return ft(this,T,M);case"latin1":case"binary":return yt(this,T,M);case"base64":return tt(this,T,M);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return l(this,T,M);default:if(et)throw new TypeError("Unknown encoding: "+C);C=(C+"").toLowerCase(),et=!0}}.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(S){if(!o.isBuffer(S))throw new TypeError("Argument must be a Buffer");return this===S||o.compare(this,S)===0},o.prototype.inspect=function(){var S="",C=e.INSPECT_MAX_BYTES;return S=this.toString("hex",0,C).replace(/(.{2})/g,"$1 ").trim(),this.length>C&&(S+=" ... "),"<Buffer "+S+">"},o.prototype.compare=function(S,C,T,M,et){if(N(S,Uint8Array)&&(S=o.from(S,S.offset,S.byteLength)),!o.isBuffer(S))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof S);if(C===void 0&&(C=0),T===void 0&&(T=S?S.length:0),M===void 0&&(M=0),et===void 0&&(et=this.length),C<0||T>S.length||M<0||et>this.length)throw new RangeError("out of range index");if(M>=et&&C>=T)return 0;if(M>=et)return-1;if(C>=T)return 1;if(this===S)return 0;for(var Pt=(et>>>=0)-(M>>>=0),Ut=(T>>>=0)-(C>>>=0),Zt=Math.min(Pt,Ut),_e=this.slice(M,et),me=S.slice(C,T),de=0;de<Zt;++de)if(_e[de]!==me[de]){Pt=_e[de],Ut=me[de];break}return Pt<Ut?-1:Ut<Pt?1:0},o.prototype.includes=function(S,C,T){return this.indexOf(S,C,T)!==-1},o.prototype.indexOf=function(S,C,T){return q(this,S,C,T,!0)},o.prototype.lastIndexOf=function(S,C,T){return q(this,S,C,T,!1)},o.prototype.write=function(S,C,T,M){if(C===void 0)M="utf8",T=this.length,C=0;else if(T===void 0&&typeof C=="string")M=C,T=this.length,C=0;else{if(!isFinite(C))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");C>>>=0,isFinite(T)?(T>>>=0,M===void 0&&(M="utf8")):(M=T,T=void 0)}var et=this.length-C;if((T===void 0||T>et)&&(T=et),S.length>0&&(T<0||C<0)||C>this.length)throw new RangeError("Attempt to write outside buffer bounds");M||(M="utf8");for(var Pt=!1;;)switch(M){case"hex":return z(this,S,C,T);case"utf8":case"utf-8":return Z(this,S,C,T);case"ascii":return j(this,S,C,T);case"latin1":case"binary":return at(this,S,C,T);case"base64":return ct(this,S,C,T);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ot(this,S,C,T);default:if(Pt)throw new TypeError("Unknown encoding: "+M);M=(""+M).toLowerCase(),Pt=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var wt=4096;function ft(S,C,T){var M="";T=Math.min(S.length,T);for(var et=C;et<T;++et)M+=String.fromCharCode(127&S[et]);return M}function yt(S,C,T){var M="";T=Math.min(S.length,T);for(var et=C;et<T;++et)M+=String.fromCharCode(S[et]);return M}function Ct(S,C,T){var M,et=S.length;(!C||C<0)&&(C=0),(!T||T<0||T>et)&&(T=et);for(var Pt="",Ut=C;Ut<T;++Ut)Pt+=(M=S[Ut])<16?"0"+M.toString(16):M.toString(16);return Pt}function l(S,C,T){for(var M=S.slice(C,T),et="",Pt=0;Pt<M.length;Pt+=2)et+=String.fromCharCode(M[Pt]+256*M[Pt+1]);return et}function s(S,C,T){if(S%1!=0||S<0)throw new RangeError("offset is not uint");if(S+C>T)throw new RangeError("Trying to access beyond buffer length")}function b(S,C,T,M,et,Pt){if(!o.isBuffer(S))throw new TypeError('"buffer" argument must be a Buffer instance');if(C>et||C<Pt)throw new RangeError('"value" argument is out of bounds');if(T+M>S.length)throw new RangeError("Index out of range")}function $(S,C,T,M,et,Pt){if(T+M>S.length)throw new RangeError("Index out of range");if(T<0)throw new RangeError("Index out of range")}function E(S,C,T,M,et){return C=+C,T>>>=0,et||$(S,0,T,4),_$ieee754_10.write(S,C,T,M,23,4),T+4}function rt(S,C,T,M,et){return C=+C,T>>>=0,et||$(S,0,T,8),_$ieee754_10.write(S,C,T,M,52,8),T+8}o.prototype.slice=function(S,C){var T=this.length;(S=~~S)<0?(S+=T)<0&&(S=0):S>T&&(S=T),(C=C===void 0?T:~~C)<0?(C+=T)<0&&(C=0):C>T&&(C=T),C<S&&(C=S);var M=this.subarray(S,C);return M.__proto__=o.prototype,M},o.prototype.readUIntLE=function(S,C,T){S>>>=0,C>>>=0,T||s(S,C,this.length);for(var M=this[S],et=1,Pt=0;++Pt<C&&(et*=256);)M+=this[S+Pt]*et;return M},o.prototype.readUIntBE=function(S,C,T){S>>>=0,C>>>=0,T||s(S,C,this.length);for(var M=this[S+--C],et=1;C>0&&(et*=256);)M+=this[S+--C]*et;return M},o.prototype.readUInt8=function(S,C){return S>>>=0,C||s(S,1,this.length),this[S]},o.prototype.readUInt16LE=function(S,C){return S>>>=0,C||s(S,2,this.length),this[S]|this[S+1]<<8},o.prototype.readUInt16BE=function(S,C){return S>>>=0,C||s(S,2,this.length),this[S]<<8|this[S+1]},o.prototype.readUInt32LE=function(S,C){return S>>>=0,C||s(S,4,this.length),(this[S]|this[S+1]<<8|this[S+2]<<16)+16777216*this[S+3]},o.prototype.readUInt32BE=function(S,C){return S>>>=0,C||s(S,4,this.length),16777216*this[S]+(this[S+1]<<16|this[S+2]<<8|this[S+3])},o.prototype.readIntLE=function(S,C,T){S>>>=0,C>>>=0,T||s(S,C,this.length);for(var M=this[S],et=1,Pt=0;++Pt<C&&(et*=256);)M+=this[S+Pt]*et;return M>=(et*=128)&&(M-=Math.pow(2,8*C)),M},o.prototype.readIntBE=function(S,C,T){S>>>=0,C>>>=0,T||s(S,C,this.length);for(var M=C,et=1,Pt=this[S+--M];M>0&&(et*=256);)Pt+=this[S+--M]*et;return Pt>=(et*=128)&&(Pt-=Math.pow(2,8*C)),Pt},o.prototype.readInt8=function(S,C){return S>>>=0,C||s(S,1,this.length),128&this[S]?-1*(255-this[S]+1):this[S]},o.prototype.readInt16LE=function(S,C){S>>>=0,C||s(S,2,this.length);var T=this[S]|this[S+1]<<8;return 32768&T?4294901760|T:T},o.prototype.readInt16BE=function(S,C){S>>>=0,C||s(S,2,this.length);var T=this[S+1]|this[S]<<8;return 32768&T?4294901760|T:T},o.prototype.readInt32LE=function(S,C){return S>>>=0,C||s(S,4,this.length),this[S]|this[S+1]<<8|this[S+2]<<16|this[S+3]<<24},o.prototype.readInt32BE=function(S,C){return S>>>=0,C||s(S,4,this.length),this[S]<<24|this[S+1]<<16|this[S+2]<<8|this[S+3]},o.prototype.readFloatLE=function(S,C){return S>>>=0,C||s(S,4,this.length),_$ieee754_10.read(this,S,!0,23,4)},o.prototype.readFloatBE=function(S,C){return S>>>=0,C||s(S,4,this.length),_$ieee754_10.read(this,S,!1,23,4)},o.prototype.readDoubleLE=function(S,C){return S>>>=0,C||s(S,8,this.length),_$ieee754_10.read(this,S,!0,52,8)},o.prototype.readDoubleBE=function(S,C){return S>>>=0,C||s(S,8,this.length),_$ieee754_10.read(this,S,!1,52,8)},o.prototype.writeUIntLE=function(S,C,T,M){S=+S,C>>>=0,T>>>=0,M||b(this,S,C,T,Math.pow(2,8*T)-1,0);var et=1,Pt=0;for(this[C]=255&S;++Pt<T&&(et*=256);)this[C+Pt]=S/et&255;return C+T},o.prototype.writeUIntBE=function(S,C,T,M){S=+S,C>>>=0,T>>>=0,M||b(this,S,C,T,Math.pow(2,8*T)-1,0);var et=T-1,Pt=1;for(this[C+et]=255&S;--et>=0&&(Pt*=256);)this[C+et]=S/Pt&255;return C+T},o.prototype.writeUInt8=function(S,C,T){return S=+S,C>>>=0,T||b(this,S,C,1,255,0),this[C]=255&S,C+1},o.prototype.writeUInt16LE=function(S,C,T){return S=+S,C>>>=0,T||b(this,S,C,2,65535,0),this[C]=255&S,this[C+1]=S>>>8,C+2},o.prototype.writeUInt16BE=function(S,C,T){return S=+S,C>>>=0,T||b(this,S,C,2,65535,0),this[C]=S>>>8,this[C+1]=255&S,C+2},o.prototype.writeUInt32LE=function(S,C,T){return S=+S,C>>>=0,T||b(this,S,C,4,4294967295,0),this[C+3]=S>>>24,this[C+2]=S>>>16,this[C+1]=S>>>8,this[C]=255&S,C+4},o.prototype.writeUInt32BE=function(S,C,T){return S=+S,C>>>=0,T||b(this,S,C,4,4294967295,0),this[C]=S>>>24,this[C+1]=S>>>16,this[C+2]=S>>>8,this[C+3]=255&S,C+4},o.prototype.writeIntLE=function(S,C,T,M){if(S=+S,C>>>=0,!M){var et=Math.pow(2,8*T-1);b(this,S,C,T,et-1,-et)}var Pt=0,Ut=1,Zt=0;for(this[C]=255&S;++Pt<T&&(Ut*=256);)S<0&&Zt===0&&this[C+Pt-1]!==0&&(Zt=1),this[C+Pt]=(S/Ut>>0)-Zt&255;return C+T},o.prototype.writeIntBE=function(S,C,T,M){if(S=+S,C>>>=0,!M){var et=Math.pow(2,8*T-1);b(this,S,C,T,et-1,-et)}var Pt=T-1,Ut=1,Zt=0;for(this[C+Pt]=255&S;--Pt>=0&&(Ut*=256);)S<0&&Zt===0&&this[C+Pt+1]!==0&&(Zt=1),this[C+Pt]=(S/Ut>>0)-Zt&255;return C+T},o.prototype.writeInt8=function(S,C,T){return S=+S,C>>>=0,T||b(this,S,C,1,127,-128),S<0&&(S=255+S+1),this[C]=255&S,C+1},o.prototype.writeInt16LE=function(S,C,T){return S=+S,C>>>=0,T||b(this,S,C,2,32767,-32768),this[C]=255&S,this[C+1]=S>>>8,C+2},o.prototype.writeInt16BE=function(S,C,T){return S=+S,C>>>=0,T||b(this,S,C,2,32767,-32768),this[C]=S>>>8,this[C+1]=255&S,C+2},o.prototype.writeInt32LE=function(S,C,T){return S=+S,C>>>=0,T||b(this,S,C,4,2147483647,-2147483648),this[C]=255&S,this[C+1]=S>>>8,this[C+2]=S>>>16,this[C+3]=S>>>24,C+4},o.prototype.writeInt32BE=function(S,C,T){return S=+S,C>>>=0,T||b(this,S,C,4,2147483647,-2147483648),S<0&&(S=4294967295+S+1),this[C]=S>>>24,this[C+1]=S>>>16,this[C+2]=S>>>8,this[C+3]=255&S,C+4},o.prototype.writeFloatLE=function(S,C,T){return E(this,S,C,!0,T)},o.prototype.writeFloatBE=function(S,C,T){return E(this,S,C,!1,T)},o.prototype.writeDoubleLE=function(S,C,T){return rt(this,S,C,!0,T)},o.prototype.writeDoubleBE=function(S,C,T){return rt(this,S,C,!1,T)},o.prototype.copy=function(S,C,T,M){if(!o.isBuffer(S))throw new TypeError("argument should be a Buffer");if(T||(T=0),M||M===0||(M=this.length),C>=S.length&&(C=S.length),C||(C=0),M>0&&M<T&&(M=T),M===T||S.length===0||this.length===0)return 0;if(C<0)throw new RangeError("targetStart out of bounds");if(T<0||T>=this.length)throw new RangeError("Index out of range");if(M<0)throw new RangeError("sourceEnd out of bounds");M>this.length&&(M=this.length),S.length-C<M-T&&(M=S.length-C+T);var et=M-T;if(this===S&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(C,T,M);else if(this===S&&T<C&&C<M)for(var Pt=et-1;Pt>=0;--Pt)S[Pt+C]=this[Pt+T];else Uint8Array.prototype.set.call(S,this.subarray(T,M),C);return et},o.prototype.fill=function(S,C,T,M){if(typeof S=="string"){if(typeof C=="string"?(M=C,C=0,T=this.length):typeof T=="string"&&(M=T,T=this.length),M!==void 0&&typeof M!="string")throw new TypeError("encoding must be a string");if(typeof M=="string"&&!o.isEncoding(M))throw new TypeError("Unknown encoding: "+M);if(S.length===1){var et=S.charCodeAt(0);(M==="utf8"&&et<128||M==="latin1")&&(S=et)}}else typeof S=="number"&&(S&=255);if(C<0||this.length<C||this.length<T)throw new RangeError("Out of range index");if(T<=C)return this;var Pt;if(C>>>=0,T=T===void 0?this.length:T>>>0,S||(S=0),typeof S=="number")for(Pt=C;Pt<T;++Pt)this[Pt]=S;else{var Ut=o.isBuffer(S)?S:o.from(S,M),Zt=Ut.length;if(Zt===0)throw new TypeError('The value "'+S+'" is invalid for argument "value"');for(Pt=0;Pt<T-C;++Pt)this[Pt+C]=Ut[Pt%Zt]}return this};var _t=/[^+/0-9A-Za-z-_]/g;function xt(S,C){var T;C=C||1/0;for(var M=S.length,et=null,Pt=[],Ut=0;Ut<M;++Ut){if((T=S.charCodeAt(Ut))>55295&&T<57344){if(!et){if(T>56319){(C-=3)>-1&&Pt.push(239,191,189);continue}if(Ut+1===M){(C-=3)>-1&&Pt.push(239,191,189);continue}et=T;continue}if(T<56320){(C-=3)>-1&&Pt.push(239,191,189),et=T;continue}T=65536+(et-55296<<10|T-56320)}else et&&(C-=3)>-1&&Pt.push(239,191,189);if(et=null,T<128){if((C-=1)<0)break;Pt.push(T)}else if(T<2048){if((C-=2)<0)break;Pt.push(T>>6|192,63&T|128)}else if(T<65536){if((C-=3)<0)break;Pt.push(T>>12|224,T>>6&63|128,63&T|128)}else{if(!(T<1114112))throw new Error("Invalid code point");if((C-=4)<0)break;Pt.push(T>>18|240,T>>12&63|128,T>>6&63|128,63&T|128)}}return Pt}function St(S){return _$base64Js_2.toByteArray(function(C){if((C=(C=C.split("=")[0]).trim().replace(_t,"")).length<2)return"";for(;C.length%4!=0;)C+="=";return C}(S))}function x(S,C,T,M){for(var et=0;et<M&&!(et+T>=C.length||et>=S.length);++et)C[et+T]=S[et];return et}function N(S,C){return S instanceof C||S!=null&&S.constructor!=null&&S.constructor.name!=null&&S.constructor.name===C.name}function V(S){return S!=S}}).call(this)}).call(this,_$buffer_3({}).Buffer)}),_$package_85={name:"sub-store",version:"2.14.446",description:"Advanced Subscription Manager for QX, Loon, Surge, Stash and ShadowRocket.",main:"src/main.js",scripts:{preinstall:"npx only-allow pnpm",test:"gulp peggy && npx cross-env BABEL_ENV=test mocha src/test/**/*.spec.js --require @babel/register --recursive",serve:"node sub-store.min.js",start:"nodemon -w src -w package.json --exec babel-node src/main.js","dev:esbuild":"nodemon -w src -w package.json dev-esbuild.js","dev:run":"nodemon -w sub-store.min.js sub-store.min.js",build:"gulp",bundle:"node bundle.js",changelog:"conventional-changelog -p cli -i CHANGELOG.md -s"},author:"Peng-YM",license:"GPL-3.0",dependencies:{"@maxmind/geoip2-node":"^5.0.0",automerge:"1.0.1-preview.7","body-parser":"^1.19.0",buffer:"^6.0.3","connect-history-api-fallback":"^2.0.0",cron:"^3.1.6","dns-packet":"^5.6.1",express:"^4.17.1","http-proxy-middleware":"^2.0.6","ip-address":"^9.0.5","js-base64":"^3.7.2",jsrsasign:"^11.1.0",lodash:"^4.17.21",ms:"^2.1.3",nanoid:"^3.3.3",request:"^2.88.2","static-js-yaml":"^1.0.0"},devDependencies:{"@babel/core":"^7.18.0","@babel/node":"^7.17.10","@babel/preset-env":"^7.18.0","@babel/register":"^7.17.7","@types/gulp":"^4.0.9",axios:"^0.21.2","babel-plugin-relative-path-import":"^2.0.1",babelify:"^10.0.0","browser-pack-flat":"^3.4.2",browserify:"^17.0.0",chai:"^4.3.6",esbuild:"^0.19.8",eslint:"^8.16.0",gulp:"^4.0.2","gulp-babel":"^8.0.0","gulp-eslint-new":"^1.4.4","gulp-file":"^0.4.0","gulp-header":"^2.0.9","gulp-prettier":"^4.0.0","gulp-tap":"^2.0.0",mocha:"^10.0.0",nodemon:"^2.0.16",peggy:"^2.0.1",prettier:"2.6.2","prettier-plugin-sort-imports":"^1.6.1",tinyify:"^3.0.0"}},_$constants_86={};Object.defineProperty(_$constants_86,"__esModule",{value:!0}),_$constants_86.TOKENS_KEY=_$constants_86.SUBS_KEY=_$constants_86.SETTINGS_KEY=_$constants_86.SCRIPT_RESOURCE_CACHE_KEY=_$constants_86.SCHEMA_VERSION_KEY=_$constants_86.RULES_KEY=_$constants_86.RESOURCE_CACHE_KEY=_$constants_86.MODULES_KEY=_$constants_86.HEADERS_RESOURCE_CACHE_KEY=_$constants_86.GIST_BACKUP_KEY=_$constants_86.GIST_BACKUP_FILE_NAME=_$constants_86.FILES_KEY=_$constants_86.CSR_EXPIRATION_TIME_KEY=_$constants_86.COLLECTIONS_KEY=_$constants_86.CHR_EXPIRATION_TIME_KEY=_$constants_86.CACHE_EXPIRATION_TIME_MS=_$constants_86.ARTIFACT_REPOSITORY_KEY=_$constants_86.ARTIFACTS_KEY=void 0,_$constants_86.SCHEMA_VERSION_KEY="schemaVersion",_$constants_86.SETTINGS_KEY="settings",_$constants_86.SUBS_KEY="subs",_$constants_86.COLLECTIONS_KEY="collections",_$constants_86.FILES_KEY="files",_$constants_86.MODULES_KEY="modules",_$constants_86.ARTIFACTS_KEY="artifacts",_$constants_86.RULES_KEY="rules",_$constants_86.TOKENS_KEY="tokens",_$constants_86.GIST_BACKUP_KEY="Auto Generated Sub-Store Backup",_$constants_86.GIST_BACKUP_FILE_NAME="Sub-Store",_$constants_86.ARTIFACT_REPOSITORY_KEY="Sub-Store Artifacts Repository",_$constants_86.RESOURCE_CACHE_KEY="#sub-store-cached-resource",_$constants_86.HEADERS_RESOURCE_CACHE_KEY="#sub-store-cached-headers-resource",_$constants_86.CHR_EXPIRATION_TIME_KEY="#sub-store-chr-expiration-time",_$constants_86.CACHE_EXPIRATION_TIME_MS=36e5,_$constants_86.SCRIPT_RESOURCE_CACHE_KEY="#sub-store-cached-script-resource",_$constants_86.CSR_EXPIRATION_TIME_KEY="#sub-store-csr-expiration-time";var _$openApi_151={};function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(n){_defineProperty(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=typeof Symbol=="function"?Symbol:{},o=n.iterator||"@@iterator",f=n.asyncIterator||"@@asyncIterator",d=n.toStringTag||"@@toStringTag";function h(l,s,b){return Object.defineProperty(l,s,{value:b,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,b,$){return s[b]=$}}function y(l,s,b,$){var E=s&&s.prototype instanceof D?s:D,rt=Object.create(E.prototype),_t=new ft($||[]);return rt._invoke=function(xt,St,x){var N="suspendedStart";return function(V,S){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(V==="throw")throw S;return{value:void 0,done:!0}}for(x.method=V,x.arg=S;;){var C=x.delegate;if(C){var T=tt(C,x);if(T){if(T===A)continue;return T}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var M=k(xt,St,x);if(M.type==="normal"){if(N=x.done?"completed":"suspendedYield",M.arg===A)continue;return{value:M.arg,done:x.done}}M.type==="throw"&&(N="completed",x.method="throw",x.arg=M.arg)}}}(l,b,_t),rt}function k(l,s,b){try{return{type:"normal",arg:l.call(s,b)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var A={};function D(){}function q(){}function H(){}var z={};h(z,o,function(){return this});var Z=Object.getPrototypeOf,j=Z&&Z(Z(yt([])));j&&j!==e&&r.call(j,o)&&(z=j);var at=H.prototype=D.prototype=Object.create(z);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(b){return this._invoke(s,b)})})}function ot(l,s){var b;this._invoke=function($,E){function rt(){return new s(function(_t,xt){(function St(x,N,V,S){var C=k(l[x],l,N);if(C.type!=="throw"){var T=C.arg,M=T.value;return M&&_typeof(M)=="object"&&r.call(M,"__await")?s.resolve(M.__await).then(function(et){St("next",et,V,S)},function(et){St("throw",et,V,S)}):s.resolve(M).then(function(et){T.value=et,V(T)},function(et){return St("throw",et,V,S)})}S(C.arg)})($,E,_t,xt)})}return b=b?b.then(rt,rt):rt()}}function tt(l,s){var b=l.iterator[s.method];if(b===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,tt(l,s),s.method==="throw"))return A;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var $=k(b,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,A;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,A):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,A)}function gt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function wt(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function ft(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(gt,this),this.reset(!0)}function yt(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var b=-1,$=function E(){for(;++b<l.length;)if(r.call(l,b))return E.value=l[b],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:Ct}}function Ct(){return{value:void 0,done:!0}}return q.prototype=H,h(at,"constructor",H),h(H,"constructor",q),q.displayName=h(H,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===q||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,H):(l.__proto__=H,h(l,d,"GeneratorFunction")),l.prototype=Object.create(at),l},t.awrap=function(l){return{__await:l}},ct(ot.prototype),h(ot.prototype,f,function(){return this}),t.AsyncIterator=ot,t.async=function(l,s,b,$,E){E===void 0&&(E=Promise);var rt=new ot(y(l,s,b,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(_t){return _t.done?_t.value:rt.next()})},ct(at),h(at,d,"Generator"),h(at,o,function(){return this}),h(at,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var b in l)s.push(b);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=yt,ft.prototype={constructor:ft,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(wt),!l)for(var s in this)s.charAt(0)==="t"&&r.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function b(St,x){return rt.type="throw",rt.arg=l,s.next=St,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return b("end");if(E.tryLoc<=this.prev){var _t=r.call(E,"catchLoc"),xt=r.call(E,"finallyLoc");if(_t&&xt){if(this.prev<E.catchLoc)return b(E.catchLoc,!0);if(this.prev<E.finallyLoc)return b(E.finallyLoc)}else if(_t){if(this.prev<E.catchLoc)return b(E.catchLoc,!0)}else{if(!xt)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return b(E.finallyLoc)}}}},abrupt:function(l,s){for(var b=this.tryEntries.length-1;b>=0;--b){var $=this.tryEntries[b];if($.tryLoc<=this.prev&&r.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,A):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),A},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.finallyLoc===l)return this.complete(b.completion,b.afterLoc),wt(b),A}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.tryLoc===l){var $=b.completion;if($.type==="throw"){var E=$.arg;wt(b)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,b){return this.delegate={iterator:yt(l),resultName:s,nextLoc:b},this.method==="next"&&(this.arg=void 0),A}},t}function asyncGeneratorStep(t,e,r,n,o,f,d){try{var h=t[f](d),y=h.value}catch(k){return void r(k)}h.done?e(y):Promise.resolve(y).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var f=t.apply(e,r);function d(y){asyncGeneratorStep(f,n,o,d,h,"next",y)}function h(y){asyncGeneratorStep(f,n,o,d,h,"throw",y)}d(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _typeof(t){return(_typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$openApi_151,"__esModule",{value:!0}),_$openApi_151.ENV=ENV,_$openApi_151.HTTP=HTTP,_$openApi_151.OpenAPI=void 0;var isQX=typeof $task<"u",isLoon=typeof $loon<"u",isSurge=typeof $httpClient<"u"&&!isLoon,isNode=eval('typeof process !== "undefined"'),isStash=typeof $environment<"u"&&$environment["stash-version"],isShadowRocket=typeof $rocket<"u",isEgern=(typeof egern>"u"?"undefined":_typeof(egern))=="object",isLanceX=typeof $native<"u",isGUIforCores=typeof $Plugins<"u",OpenAPI=function(){function OpenAPI(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"untitled",e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];_classCallCheck(this,OpenAPI),this.name=t,this.debug=e,this.http=HTTP(),this.env=ENV(),this.node=function(){if(isNode){var o=require("fs");return{fs:o}}return null}(),this.initCache();var r=function(o,f){return new Promise(function(d){setTimeout(d.bind(null,f),o)})},n;Promise.prototype.delay=(n=_asyncToGenerator(_regeneratorRuntime().mark(function o(f){var d;return _regeneratorRuntime().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this;case 2:return d=h.sent,h.next=5,r(f,d);case 5:return h.abrupt("return",h.sent);case 6:case"end":return h.stop()}},o,this)})),function(o){return n.apply(this,arguments)})}return _createClass(OpenAPI,[{key:"initCache",value:function initCache(){if(isQX&&(this.cache=JSON.parse($prefs.valueForKey(this.name)||"{}")),(isLoon||isSurge)&&(this.cache=JSON.parse($persistentStore.read(this.name)||"{}")),isGUIforCores&&(this.cache=JSON.parse($Plugins.SubStoreCache.get(this.name)||"{}")),isNode){var basePath=eval("process.env.SUB_STORE_DATA_BASE_PATH")||".",rootPath="".concat(basePath,"/root.json");this.log("Root path: ".concat(rootPath)),this.node.fs.existsSync(rootPath)?this.root=JSON.parse(this.node.fs.readFileSync("".concat(rootPath))):(this.node.fs.writeFileSync(rootPath,JSON.stringify({}),{flag:"wx"}),this.root={});var fpath="".concat(basePath,"/").concat(this.name,".json");this.log("Data path: ".concat(fpath)),this.node.fs.existsSync(fpath)?this.cache=JSON.parse(this.node.fs.readFileSync("".concat(fpath))):(this.node.fs.writeFileSync(fpath,JSON.stringify({}),{flag:"wx"}),this.cache={})}}},{key:"persistCache",value:function persistCache(){var data=JSON.stringify(this.cache,null,2);if(isQX&&$prefs.setValueForKey(data,this.name),(isLoon||isSurge)&&$persistentStore.write(data,this.name),isGUIforCores&&$Plugins.SubStoreCache.set(this.name,data),isNode){var basePath=eval("process.env.SUB_STORE_DATA_BASE_PATH")||".";this.node.fs.writeFileSync("".concat(basePath,"/").concat(this.name,".json"),data,{flag:"w"},function(t){}),this.node.fs.writeFileSync("".concat(basePath,"/root.json"),JSON.stringify(this.root,null,2),{flag:"w"},function(t){})}}},{key:"write",value:function(t,e){if(this.log("SET ".concat(e)),e.indexOf("#")!==-1){if(e=e.substr(1),isSurge||isLoon)return $persistentStore.write(t,e);if(isQX)return $prefs.setValueForKey(t,e);if(isNode&&(this.root[e]=t),isGUIforCores)return $Plugins.SubStoreCache.set(e,t)}else this.cache[e]=t;this.persistCache()}},{key:"read",value:function(t){return this.log("READ ".concat(t)),t.indexOf("#")===-1?this.cache[t]:(t=t.substr(1),isSurge||isLoon?$persistentStore.read(t):isQX?$prefs.valueForKey(t):isNode?this.root[t]:isGUIforCores?$Plugins.SubStoreCache.get(t):void 0)}},{key:"delete",value:function(t){if(this.log("DELETE ".concat(t)),t.indexOf("#")!==-1){if(t=t.substr(1),isSurge||isLoon)return $persistentStore.write(null,t);if(isQX)return $prefs.removeValueForKey(t);if(isNode&&delete this.root[t],isGUIforCores)return $Plugins.SubStoreCache.remove(t)}else delete this.cache[t];this.persistCache()}},{key:"notify",value:function notify(title){var subtitle=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",content=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",options=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},openURL=options["open-url"],mediaURL=options["media-url"];if(isQX&&$notify(title,subtitle,content,options),isSurge&&$notification.post(title,subtitle,content+"".concat(mediaURL?`
\u591A\u5A92\u4F53:`+mediaURL:""),{url:openURL}),isLoon){var opts={};openURL&&(opts.openUrl=openURL),mediaURL&&(opts.mediaUrl=mediaURL),JSON.stringify(opts)==="{}"?$notification.post(title,subtitle,content):$notification.post(title,subtitle,content,opts)}if(isNode){var content_=content+(openURL?`
\u70B9\u51FB\u8DF3\u8F6C: `.concat(openURL):"")+(mediaURL?`
\u591A\u5A92\u4F53: `.concat(mediaURL):""),push=eval("process.env.SUB_STORE_PUSH_SERVICE");if(push){var url=push.replace("[\u63A8\u9001\u6807\u9898]",encodeURIComponent(title||"Sub-Store")).replace("[\u63A8\u9001\u5185\u5BB9]",encodeURIComponent([subtitle,content_].map(function(t){return t}).join(`
`))),$http=HTTP();$http.get({url}).then(function(t){}).catch(function(t){})}}isGUIforCores&&$Plugins.Notify(title,subtitle+`
`+content)}},{key:"log",value:function(t){this.debug}},{key:"info",value:function(t){}},{key:"error",value:function(t){}},{key:"wait",value:function(t){return new Promise(function(e){return setTimeout(e,t)})}},{key:"done",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};isQX||isLoon||isSurge||isGUIforCores?$done(t):isNode&&typeof $context<"u"&&($context.headers=t.headers,$context.statusCode=t.statusCode,$context.body=t.body)}}]),OpenAPI}();function ENV(){return{isQX,isLoon,isSurge,isNode,isStash,isShadowRocket,isEgern,isLanceX,isGUIforCores}}function HTTP(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{baseURL:""},e=ENV(),r=e.isQX,n=e.isLoon,o=e.isSurge,f=e.isNode,d=e.isGUIforCores,h=["GET","POST","PUT","DELETE","HEAD","OPTIONS","PATCH"],y=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/;function k(D,q){q=typeof q=="string"?{url:q}:q;var H=t.baseURL;H&&!y.test(q.url||"")&&(q.url=H?H+q.url:q.url),q=_objectSpread(_objectSpread({},t),q);var z=q.timeout,Z=_objectSpread(_objectSpread({},{onRequest:function(){},onResponse:function(gt){return gt},onTimeout:function(){}}),q.events),j,at,ct;if(Z.onRequest(D,q),q.node&&o){var ot=$environment["surge-build"];ot&&parseInt(ot)>=2407&&(q["policy-descriptor"]=q.node,delete q.node)}r?j=$task.fetch({method:D,url:q.url,headers:q.headers,body:q.body,opts:q.opts}):n||o||f?j=new Promise(function(gt,wt){var ft=f?require("request"):$httpClient,yt=q.body,Ct=JSON.parse(JSON.stringify(q));if(Ct.body=yt,!f&&Ct.timeout){Ct.timeout++;var l="ms";(o||isStash||isShadowRocket)&&(Ct.timeout=Math.ceil(Ct.timeout/1e3),l="s")}ft[D.toLowerCase()](Ct,function(s,b,$){s?wt(s):gt({statusCode:b.status||b.statusCode,headers:b.headers,body:$})})}):d&&(j=new Promise((ct=_asyncToGenerator(_regeneratorRuntime().mark(function gt(wt,ft){var yt;return _regeneratorRuntime().wrap(function(Ct){for(;;)switch(Ct.prev=Ct.next){case 0:return Ct.prev=0,Ct.next=3,$Plugins.Requests({method:D,url:q.url,headers:q.headers,body:q.body,options:{Proxy:q.proxy,Timeout:q.timeout?q.timeout/1e3:15}});case 3:yt=Ct.sent,wt({statusCode:yt.status,headers:yt.headers,body:yt.body}),Ct.next=10;break;case 7:Ct.prev=7,Ct.t0=Ct.catch(0),ft(Ct.t0);case 10:case"end":return Ct.stop()}},gt,null,[[0,7]])})),function(gt,wt){return ct.apply(this,arguments)})));var tt=z?new Promise(function(gt,wt){at=setTimeout(function(){return Z.onTimeout(),wt("".concat(D," URL: ").concat(q.url," exceeds the timeout ").concat(z," ms"))},z)}):null;return(tt?Promise.race([tt,j]).then(function(gt){return typeof clearTimeout<"u"&&clearTimeout(at),gt}):j).then(function(gt){return Z.onResponse(gt)})}var A={};return h.forEach(function(D){return A[D.toLowerCase()]=function(q){return k(D,q)}}),A}_$openApi_151.OpenAPI=OpenAPI;var _$app_87={};Object.defineProperty(_$app_87,"__esModule",{value:!0}),_$app_87.default=void 0;var _default=new _$openApi_151.OpenAPI("sub-store");_$app_87.default=_default;var _$migration_143={};Object.defineProperty(_$migration_143,"__esModule",{value:!0}),_$migration_143.default=function(){var t;(t=_app.default.read(_$constants_86.SCHEMA_VERSION_KEY))||function(){_app.default.info("Start migrating...");var e=_app.default.read(_$constants_86.SUBS_KEY)||{},r=Object.values(e).map(function(D){return D.source=D.source||"remote",k(D),A(D),D});_app.default.write(r,_$constants_86.SUBS_KEY);var n=_app.default.read(_$constants_86.COLLECTIONS_KEY)||{},o=Object.values(n).map(function(D){return delete D.ua,k(D),A(D),D});_app.default.write(o,_$constants_86.COLLECTIONS_KEY);var f=_app.default.read(_$constants_86.ARTIFACTS_KEY)||{},d=Object.values(f);_app.default.write(d,_$constants_86.ARTIFACTS_KEY);var h=_app.default.read(_$constants_86.RULES_KEY)||{},y=Object.values(h);function k(D){var q=D["display-name"];q&&(D.displayName=q,delete D["display-name"])}function A(D){var q=D.process;if(q&&q.length!==0){var H,z=[],Z={type:"Quick Setting Operator",args:{udp:"DEFAULT",tfo:"DEFAULT",scert:"DEFAULT","vmess aead":"DEFAULT",useless:"DEFAULT"}},j=function(wt,ft){var yt=typeof Symbol<"u"&&wt[Symbol.iterator]||wt["@@iterator"];if(!yt){if(Array.isArray(wt)||(yt=function(E,rt){if(E){if(typeof E=="string")return _arrayLikeToArray(E,void 0);var _t=Object.prototype.toString.call(E).slice(8,-1);return _t==="Object"&&E.constructor&&(_t=E.constructor.name),_t==="Map"||_t==="Set"?Array.from(E):_t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_t)?_arrayLikeToArray(E,void 0):void 0}}(wt))){yt&&(wt=yt);var Ct=0,l=function(){};return{s:l,n:function(){return Ct>=wt.length?{done:!0}:{done:!1,value:wt[Ct++]}},e:function(E){throw E},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,b=!0,$=!1;return{s:function(){yt=yt.call(wt)},n:function(){var E=yt.next();return b=E.done,E},e:function(E){$=!0,s=E},f:function(){try{b||yt.return==null||yt.return()}finally{if($)throw s}}}}(q);try{for(j.s();!(H=j.n()).done;){var at=H.value;if(at.type){if(at.type==="Useless Filter")Z.args.useless="ENABLED";else if(at.type==="Set Property Operator"){var ct=at.args,ot=ct.key,tt=ct.value;switch(ot){case"udp":Z.args.udp=tt?"ENABLED":"DISABLED";break;case"tfo":Z.args.tfo=tt?"ENABLED":"DISABLED";break;case"skip-cert-verify":Z.args.scert=tt?"ENABLED":"DISABLED";break;case"aead":Z.args["vmess aead"]=tt?"ENABLED":"DISABLED"}}else if(at.type.indexOf("Keyword")===-1)if(at.type==="Flag Operator"){var gt=at.args===void 0||at.args;at.args={mode:gt?"add":"remove"},z.push(at)}else z.push(at)}}}catch(wt){j.e(wt)}finally{j.f()}z.unshift(Z),D.process=z}}_app.default.write(y,_$constants_86.RULES_KEY),delete _app.default.cache.builtin,_app.default.info("Migration complete!")}(),t!=="2.0"&&_app.default.write("2.0",_$constants_86.SCHEMA_VERSION_KEY)};var obj,_app=(obj=_$app_87)&&obj.__esModule?obj:{default:obj};function _arrayLikeToArray(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var _$express_149={};function ___classCallCheck_149(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ___defineProperties_149(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ___createClass_149(t,e,r){return e&&___defineProperties_149(t.prototype,e),r&&___defineProperties_149(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function express(t){var e=t.substore,r=t.port,n=t.host,o=(0,_$openApi_151.ENV)(),f=o.isNode,d={"Content-Type":"text/plain;charset=UTF-8","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST,GET,OPTIONS,PATCH,PUT,DELETE","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept","X-Powered-By":"Sub-Store"};if(f){var h=require("express"),y=require("body-parser"),k=h();return k.use(y.json({verify:z,limit:"1mb"})),k.use(y.urlencoded({verify:z,extended:!0})),k.use(y.raw({verify:z,type:"*/*"})),k.use(function(j,at,ct){at.set(d),ct()}),k.start=function(){var j=k.listen(r,n,function(){var at=j.address(),ct=at.address,ot=at.port;e.info("[BACKEND] ".concat(ct,":").concat(ot))})},k}var A=[],D=["GET","POST","PUT","DELETE","PATCH","OPTIONS","HEAD'","ALL"],q=function j(at){var ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,ot=at.method,tt=at.url,gt=at.headers,wt=at.body;gt=formatHeaders(gt),/json/i.test(gt["content-type"])&&(wt=JSON.parse(wt)),ot=ot.toUpperCase();var ft,yt=extractURL(tt),Ct=yt.path,l=yt.query,s=null,b=0;for(ft=ct;ft<A.length;ft++)if(A[ft].method==="ALL"||ot===A[ft].method){var $=A[ft].pattern;patternMatched($,Ct)&&$.split("/").length>b&&(s=A[ft],b=$.split("/").length)}if(s){var E=function(){j(ot,tt,ft)},rt={method:ot,url:tt,path:Ct,query:l,params:extractPathParams(s.pattern,Ct),headers:gt,body:wt},_t=Z(),xt=s.callback,St=function(x){_t.status(500).json({status:"failed",message:"Internal Server Error: ".concat(x)})};if(xt.constructor.name==="AsyncFunction")xt(rt,_t,E).catch(St);else try{xt(rt,_t,E)}catch(x){St(x)}}else Z().status(404).json({status:"failed",message:"ERROR: 404 not found"})},H={};return D.forEach(function(j){H[j.toLowerCase()]=function(at,ct){A.push({method:j,pattern:at,callback:ct})}}),H.route=function(j){var at={};return D.forEach(function(ct){at[ct.toLowerCase()]=function(ot){return A.push({method:ct,pattern:j,callback:ot}),at}}),at},H.start=function(){q($request)},H;function z(j,at,ct,ot){ct&&ct.length&&(j.rawBody=ct.toString(ot||"utf8"))}function Z(){var j=200,at=(0,_$openApi_151.ENV)(),ct=at.isQX,ot=at.isLoon,tt=at.isSurge,gt=at.isGUIforCores,wt=d,ft={200:"HTTP/1.1 200 OK",201:"HTTP/1.1 201 Created",302:"HTTP/1.1 302 Found",307:"HTTP/1.1 307 Temporary Redirect",308:"HTTP/1.1 308 Permanent Redirect",404:"HTTP/1.1 404 Not Found",500:"HTTP/1.1 500 Internal Server Error"};return new(function(){function yt(){___classCallCheck_149(this,yt)}return ___createClass_149(yt,[{key:"status",value:function(Ct){return j=Ct,this}},{key:"send",value:function(){var Ct=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",l={status:ct?ft[j]:j,body:Ct,headers:wt};ct||gt?$done(l):(ot||tt)&&$done({response:l})}},{key:"end",value:function(){this.send()}},{key:"html",value:function(Ct){this.set("Content-Type","text/html;charset=UTF-8"),this.send(Ct)}},{key:"json",value:function(Ct){this.set("Content-Type","application/json;charset=UTF-8"),this.send(JSON.stringify(Ct))}},{key:"set",value:function(Ct,l){return wt[Ct]=l,this}}]),yt}())}}function formatHeaders(t){for(var e={},r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];e[o.toLowerCase()]=t[o]}return e}function patternMatched(t,e){if(t instanceof RegExp&&t.test(e)||t==="/")return!0;if(t.indexOf(":")===-1){for(var r=e.split("/"),n=t.split("/"),o=0;o<n.length;o++)if(r[o]!==n[o])return!1;return!0}return!!extractPathParams(t,e)}function extractURL(t){var e=(t.match(/https?:\/\/[^/]+(\/[^?]*)/)||[])[1]||"/",r={};if(t.indexOf("?")!==-1)for(var n=t.slice(t.indexOf("?")+1).split("&"),o=0;o<n.length;o++){var f=n[o].split("=");r[f[0]]=f[1]}return{path:e,query:r}}function extractPathParams(t,e){if(t.indexOf(":")===-1)return null;for(var r={},n=0,o=0;n<t.length;n++,o++)if(t[n]===":"){for(var f=[],d=[];t[++n]!=="/"&&n<t.length;)f.push(t[n]);for(;e[o]!=="/"&&o<e.length;)d.push(e[o++]);r[f.join("")]=d.join("")}else if(t[n]!==e[o])return null;return r}Object.defineProperty(_$express_149,"__esModule",{value:!0}),_$express_149.default=express;var _$md5_150={};Object.defineProperty(_$md5_150,"__esModule",{value:!0}),_$md5_150.any_hmac_md5=function(t,e,r){return rstr2any(rstr_hmac_md5(str2rstr_utf8(t),str2rstr_utf8(e)),r)},_$md5_150.any_md5=function(t,e){return rstr2any(rstr_md5(str2rstr_utf8(t)),e)},_$md5_150.b64_hmac_md5=function(t,e){return rstr2b64(rstr_hmac_md5(str2rstr_utf8(t),str2rstr_utf8(e)))},_$md5_150.b64_md5=function(t){return rstr2b64(rstr_md5(str2rstr_utf8(t)))},_$md5_150.hex_hmac_md5=function(t,e){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(t),str2rstr_utf8(e)))},_$md5_150.hex_md5=hex_md5;var hexcase=0,b64pad="";function hex_md5(t){return rstr2hex(rstr_md5(str2rstr_utf8(t)))}function rstr_md5(t){return binl2rstr(binl_md5(rstr2binl(t),8*t.length))}function rstr_hmac_md5(t,e){var r=rstr2binl(t);r.length>16&&(r=binl_md5(r,8*t.length));for(var n=Array(16),o=Array(16),f=0;f<16;f++)n[f]=909522486^r[f],o[f]=1549556828^r[f];var d=binl_md5(n.concat(rstr2binl(e)),512+8*e.length);return binl2rstr(binl_md5(o.concat(d),640))}function rstr2hex(t){for(var e,r=hexcase?"0123456789ABCDEF":"0123456789abcdef",n="",o=0;o<t.length;o++)e=t.charCodeAt(o),n+=r.charAt(e>>>4&15)+r.charAt(15&e);return n}function rstr2b64(t){for(var e="",r=t.length,n=0;n<r;n+=3)for(var o=t.charCodeAt(n)<<16|(n+1<r?t.charCodeAt(n+1)<<8:0)|(n+2<r?t.charCodeAt(n+2):0),f=0;f<4;f++)8*n+6*f>8*t.length?e+=b64pad:e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(o>>>6*(3-f)&63);return e}function rstr2any(t,e){var r,n,o,f,d,h=e.length,y=Array(Math.ceil(t.length/2));for(r=0;r<y.length;r++)y[r]=t.charCodeAt(2*r)<<8|t.charCodeAt(2*r+1);var k=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),A=Array(k);for(n=0;n<k;n++){for(d=Array(),f=0,r=0;r<y.length;r++)f=(f<<16)+y[r],f-=(o=Math.floor(f/h))*h,(d.length>0||o>0)&&(d[d.length]=o);A[n]=f,y=d}var D="";for(r=A.length-1;r>=0;r--)D+=e.charAt(A[r]);return D}function str2rstr_utf8(t){for(var e,r,n="",o=-1;++o<t.length;)e=t.charCodeAt(o),r=o+1<t.length?t.charCodeAt(o+1):0,55296<=e&&e<=56319&&56320<=r&&r<=57343&&(e=65536+((1023&e)<<10)+(1023&r),o++),e<=127?n+=String.fromCharCode(e):e<=2047?n+=String.fromCharCode(192|e>>>6&31,128|63&e):e<=65535?n+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):e<=2097151&&(n+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return n}function rstr2binl(t){for(var e=Array(t.length>>2),r=0;r<e.length;r++)e[r]=0;for(r=0;r<8*t.length;r+=8)e[r>>5]|=(255&t.charCodeAt(r/8))<<r%32;return e}function binl2rstr(t){for(var e="",r=0;r<32*t.length;r+=8)e+=String.fromCharCode(t[r>>5]>>>r%32&255);return e}function binl_md5(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var r=1732584193,n=-271733879,o=-1732584194,f=271733878,d=0;d<t.length;d+=16){var h=r,y=n,k=o,A=f;r=md5_ff(r,n,o,f,t[d+0],7,-680876936),f=md5_ff(f,r,n,o,t[d+1],12,-389564586),o=md5_ff(o,f,r,n,t[d+2],17,606105819),n=md5_ff(n,o,f,r,t[d+3],22,-1044525330),r=md5_ff(r,n,o,f,t[d+4],7,-176418897),f=md5_ff(f,r,n,o,t[d+5],12,1200080426),o=md5_ff(o,f,r,n,t[d+6],17,-1473231341),n=md5_ff(n,o,f,r,t[d+7],22,-45705983),r=md5_ff(r,n,o,f,t[d+8],7,1770035416),f=md5_ff(f,r,n,o,t[d+9],12,-1958414417),o=md5_ff(o,f,r,n,t[d+10],17,-42063),n=md5_ff(n,o,f,r,t[d+11],22,-1990404162),r=md5_ff(r,n,o,f,t[d+12],7,1804603682),f=md5_ff(f,r,n,o,t[d+13],12,-40341101),o=md5_ff(o,f,r,n,t[d+14],17,-1502002290),r=md5_gg(r,n=md5_ff(n,o,f,r,t[d+15],22,1236535329),o,f,t[d+1],5,-165796510),f=md5_gg(f,r,n,o,t[d+6],9,-1069501632),o=md5_gg(o,f,r,n,t[d+11],14,643717713),n=md5_gg(n,o,f,r,t[d+0],20,-373897302),r=md5_gg(r,n,o,f,t[d+5],5,-701558691),f=md5_gg(f,r,n,o,t[d+10],9,38016083),o=md5_gg(o,f,r,n,t[d+15],14,-660478335),n=md5_gg(n,o,f,r,t[d+4],20,-405537848),r=md5_gg(r,n,o,f,t[d+9],5,568446438),f=md5_gg(f,r,n,o,t[d+14],9,-1019803690),o=md5_gg(o,f,r,n,t[d+3],14,-187363961),n=md5_gg(n,o,f,r,t[d+8],20,1163531501),r=md5_gg(r,n,o,f,t[d+13],5,-1444681467),f=md5_gg(f,r,n,o,t[d+2],9,-51403784),o=md5_gg(o,f,r,n,t[d+7],14,1735328473),r=md5_hh(r,n=md5_gg(n,o,f,r,t[d+12],20,-1926607734),o,f,t[d+5],4,-378558),f=md5_hh(f,r,n,o,t[d+8],11,-2022574463),o=md5_hh(o,f,r,n,t[d+11],16,1839030562),n=md5_hh(n,o,f,r,t[d+14],23,-35309556),r=md5_hh(r,n,o,f,t[d+1],4,-1530992060),f=md5_hh(f,r,n,o,t[d+4],11,1272893353),o=md5_hh(o,f,r,n,t[d+7],16,-155497632),n=md5_hh(n,o,f,r,t[d+10],23,-1094730640),r=md5_hh(r,n,o,f,t[d+13],4,681279174),f=md5_hh(f,r,n,o,t[d+0],11,-358537222),o=md5_hh(o,f,r,n,t[d+3],16,-722521979),n=md5_hh(n,o,f,r,t[d+6],23,76029189),r=md5_hh(r,n,o,f,t[d+9],4,-640364487),f=md5_hh(f,r,n,o,t[d+12],11,-421815835),o=md5_hh(o,f,r,n,t[d+15],16,530742520),r=md5_ii(r,n=md5_hh(n,o,f,r,t[d+2],23,-995338651),o,f,t[d+0],6,-198630844),f=md5_ii(f,r,n,o,t[d+7],10,1126891415),o=md5_ii(o,f,r,n,t[d+14],15,-1416354905),n=md5_ii(n,o,f,r,t[d+5],21,-57434055),r=md5_ii(r,n,o,f,t[d+12],6,1700485571),f=md5_ii(f,r,n,o,t[d+3],10,-1894986606),o=md5_ii(o,f,r,n,t[d+10],15,-1051523),n=md5_ii(n,o,f,r,t[d+1],21,-2054922799),r=md5_ii(r,n,o,f,t[d+8],6,1873313359),f=md5_ii(f,r,n,o,t[d+15],10,-30611744),o=md5_ii(o,f,r,n,t[d+6],15,-1560198380),n=md5_ii(n,o,f,r,t[d+13],21,1309151649),r=md5_ii(r,n,o,f,t[d+4],6,-145523070),f=md5_ii(f,r,n,o,t[d+11],10,-1120210379),o=md5_ii(o,f,r,n,t[d+2],15,718787259),n=md5_ii(n,o,f,r,t[d+9],21,-343485551),r=safe_add(r,h),n=safe_add(n,y),o=safe_add(o,k),f=safe_add(f,A)}return Array(r,n,o,f)}function md5_cmn(t,e,r,n,o,f){return safe_add((d=safe_add(safe_add(e,t),safe_add(n,f)))<<(h=o)|d>>>32-h,r);var d,h}function md5_ff(t,e,r,n,o,f,d){return md5_cmn(e&r|~e&n,t,e,o,f,d)}function md5_gg(t,e,r,n,o,f,d){return md5_cmn(e&n|r&~n,t,e,o,f,d)}function md5_hh(t,e,r,n,o,f,d){return md5_cmn(e^r^n,t,e,o,f,d)}function md5_ii(t,e,r,n,o,f,d){return md5_cmn(r^(e|~n),t,e,o,f,d)}function safe_add(t,e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}var _$common_12={};Object.defineProperty(_$common_12,"__esModule",{value:!0}),_$common_12.isCorrect=_$common_12.isInSubnet=void 0,_$common_12.isInSubnet=function(t){return!(this.subnetMask<t.subnetMask)&&this.mask(t.subnetMask)===t.mask()},_$common_12.isCorrect=function(t){return function(){return this.addressMinusSuffix===this.correctForm()&&(this.subnetMask===t&&!this.parsedSubnet||this.parsedSubnet===String(this.subnetMask))}};var _$constants_16={};Object.defineProperty(_$constants_16,"__esModule",{value:!0}),_$constants_16.RE_SUBNET_STRING=_$constants_16.RE_ADDRESS=_$constants_16.GROUPS=_$constants_16.BITS=void 0,_$constants_16.BITS=32,_$constants_16.GROUPS=4,_$constants_16.RE_ADDRESS=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g,_$constants_16.RE_SUBNET_STRING=/\/\d{1,2}$/;var _$addressError_11={};Object.defineProperty(_$addressError_11,"__esModule",{value:!0}),_$addressError_11.AddressError=void 0,_$addressError_11.AddressError=class extends Error{constructor(t,e){super(t),this.name="AddressError",e!==null&&(this.parseMessage=e)}};var _$jsbn_51={};(function(){var t;function e(x,N,V){x!=null&&(typeof x=="number"?this.fromNumber(x,N,V):N==null&&typeof x!="string"?this.fromString(x,256):this.fromString(x,N))}function r(){return new e(null)}var n=typeof navigator<"u";n&&navigator.appName=="Microsoft Internet Explorer"?(e.prototype.am=function(x,N,V,S,C,T){for(var M=32767&N,et=N>>15;--T>=0;){var Pt=32767&this[x],Ut=this[x++]>>15,Zt=et*Pt+Ut*M;C=((Pt=M*Pt+((32767&Zt)<<15)+V[S]+(1073741823&C))>>>30)+(Zt>>>15)+et*Ut+(C>>>30),V[S++]=1073741823&Pt}return C},t=30):n&&navigator.appName!="Netscape"?(e.prototype.am=function(x,N,V,S,C,T){for(;--T>=0;){var M=N*this[x++]+V[S]+C;C=Math.floor(M/67108864),V[S++]=67108863&M}return C},t=26):(e.prototype.am=function(x,N,V,S,C,T){for(var M=16383&N,et=N>>14;--T>=0;){var Pt=16383&this[x],Ut=this[x++]>>14,Zt=et*Pt+Ut*M;C=((Pt=M*Pt+((16383&Zt)<<14)+V[S]+C)>>28)+(Zt>>14)+et*Ut,V[S++]=268435455&Pt}return C},t=28),e.prototype.DB=t,e.prototype.DM=(1<<t)-1,e.prototype.DV=1<<t,e.prototype.FV=Math.pow(2,52),e.prototype.F1=52-t,e.prototype.F2=2*t-52;var o,f,d=new Array;for(o=48,f=0;f<=9;++f)d[o++]=f;for(o=97,f=10;f<36;++f)d[o++]=f;for(o=65,f=10;f<36;++f)d[o++]=f;function h(x){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(x)}function y(x,N){var V=d[x.charCodeAt(N)];return V??-1}function k(x){var N=r();return N.fromInt(x),N}function A(x){var N,V=1;return(N=x>>>16)!=0&&(x=N,V+=16),(N=x>>8)!=0&&(x=N,V+=8),(N=x>>4)!=0&&(x=N,V+=4),(N=x>>2)!=0&&(x=N,V+=2),(N=x>>1)!=0&&(x=N,V+=1),V}function D(x){this.m=x}function q(x){this.m=x,this.mp=x.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<x.DB-15)-1,this.mt2=2*x.t}function H(x,N){return x&N}function z(x,N){return x|N}function Z(x,N){return x^N}function j(x,N){return x&~N}function at(x){if(x==0)return-1;var N=0;return!(65535&x)&&(x>>=16,N+=16),!(255&x)&&(x>>=8,N+=8),!(15&x)&&(x>>=4,N+=4),!(3&x)&&(x>>=2,N+=2),!(1&x)&&++N,N}function ct(x){for(var N=0;x!=0;)x&=x-1,++N;return N}function ot(){}function tt(x){return x}function gt(x){this.r2=r(),this.q3=r(),e.ONE.dlShiftTo(2*x.t,this.r2),this.mu=this.r2.divide(x),this.m=x}D.prototype.convert=function(x){return x.s<0||x.compareTo(this.m)>=0?x.mod(this.m):x},D.prototype.revert=function(x){return x},D.prototype.reduce=function(x){x.divRemTo(this.m,null,x)},D.prototype.mulTo=function(x,N,V){x.multiplyTo(N,V),this.reduce(V)},D.prototype.sqrTo=function(x,N){x.squareTo(N),this.reduce(N)},q.prototype.convert=function(x){var N=r();return x.abs().dlShiftTo(this.m.t,N),N.divRemTo(this.m,null,N),x.s<0&&N.compareTo(e.ZERO)>0&&this.m.subTo(N,N),N},q.prototype.revert=function(x){var N=r();return x.copyTo(N),this.reduce(N),N},q.prototype.reduce=function(x){for(;x.t<=this.mt2;)x[x.t++]=0;for(var N=0;N<this.m.t;++N){var V=32767&x[N],S=V*this.mpl+((V*this.mph+(x[N]>>15)*this.mpl&this.um)<<15)&x.DM;for(x[V=N+this.m.t]+=this.m.am(0,S,x,N,0,this.m.t);x[V]>=x.DV;)x[V]-=x.DV,x[++V]++}x.clamp(),x.drShiftTo(this.m.t,x),x.compareTo(this.m)>=0&&x.subTo(this.m,x)},q.prototype.mulTo=function(x,N,V){x.multiplyTo(N,V),this.reduce(V)},q.prototype.sqrTo=function(x,N){x.squareTo(N),this.reduce(N)},e.prototype.copyTo=function(x){for(var N=this.t-1;N>=0;--N)x[N]=this[N];x.t=this.t,x.s=this.s},e.prototype.fromInt=function(x){this.t=1,this.s=x<0?-1:0,x>0?this[0]=x:x<-1?this[0]=x+this.DV:this.t=0},e.prototype.fromString=function(x,N){var V;if(N==16)V=4;else if(N==8)V=3;else if(N==256)V=8;else if(N==2)V=1;else if(N==32)V=5;else{if(N!=4)return void this.fromRadix(x,N);V=2}this.t=0,this.s=0;for(var S=x.length,C=!1,T=0;--S>=0;){var M=V==8?255&x[S]:y(x,S);M<0?x.charAt(S)=="-"&&(C=!0):(C=!1,T==0?this[this.t++]=M:T+V>this.DB?(this[this.t-1]|=(M&(1<<this.DB-T)-1)<<T,this[this.t++]=M>>this.DB-T):this[this.t-1]|=M<<T,(T+=V)>=this.DB&&(T-=this.DB))}V==8&&128&x[0]&&(this.s=-1,T>0&&(this[this.t-1]|=(1<<this.DB-T)-1<<T)),this.clamp(),C&&e.ZERO.subTo(this,this)},e.prototype.clamp=function(){for(var x=this.s&this.DM;this.t>0&&this[this.t-1]==x;)--this.t},e.prototype.dlShiftTo=function(x,N){var V;for(V=this.t-1;V>=0;--V)N[V+x]=this[V];for(V=x-1;V>=0;--V)N[V]=0;N.t=this.t+x,N.s=this.s},e.prototype.drShiftTo=function(x,N){for(var V=x;V<this.t;++V)N[V-x]=this[V];N.t=Math.max(this.t-x,0),N.s=this.s},e.prototype.lShiftTo=function(x,N){var V,S=x%this.DB,C=this.DB-S,T=(1<<C)-1,M=Math.floor(x/this.DB),et=this.s<<S&this.DM;for(V=this.t-1;V>=0;--V)N[V+M+1]=this[V]>>C|et,et=(this[V]&T)<<S;for(V=M-1;V>=0;--V)N[V]=0;N[M]=et,N.t=this.t+M+1,N.s=this.s,N.clamp()},e.prototype.rShiftTo=function(x,N){N.s=this.s;var V=Math.floor(x/this.DB);if(V>=this.t)N.t=0;else{var S=x%this.DB,C=this.DB-S,T=(1<<S)-1;N[0]=this[V]>>S;for(var M=V+1;M<this.t;++M)N[M-V-1]|=(this[M]&T)<<C,N[M-V]=this[M]>>S;S>0&&(N[this.t-V-1]|=(this.s&T)<<C),N.t=this.t-V,N.clamp()}},e.prototype.subTo=function(x,N){for(var V=0,S=0,C=Math.min(x.t,this.t);V<C;)S+=this[V]-x[V],N[V++]=S&this.DM,S>>=this.DB;if(x.t<this.t){for(S-=x.s;V<this.t;)S+=this[V],N[V++]=S&this.DM,S>>=this.DB;S+=this.s}else{for(S+=this.s;V<x.t;)S-=x[V],N[V++]=S&this.DM,S>>=this.DB;S-=x.s}N.s=S<0?-1:0,S<-1?N[V++]=this.DV+S:S>0&&(N[V++]=S),N.t=V,N.clamp()},e.prototype.multiplyTo=function(x,N){var V=this.abs(),S=x.abs(),C=V.t;for(N.t=C+S.t;--C>=0;)N[C]=0;for(C=0;C<S.t;++C)N[C+V.t]=V.am(0,S[C],N,C,0,V.t);N.s=0,N.clamp(),this.s!=x.s&&e.ZERO.subTo(N,N)},e.prototype.squareTo=function(x){for(var N=this.abs(),V=x.t=2*N.t;--V>=0;)x[V]=0;for(V=0;V<N.t-1;++V){var S=N.am(V,N[V],x,2*V,0,1);(x[V+N.t]+=N.am(V+1,2*N[V],x,2*V+1,S,N.t-V-1))>=N.DV&&(x[V+N.t]-=N.DV,x[V+N.t+1]=1)}x.t>0&&(x[x.t-1]+=N.am(V,N[V],x,2*V,0,1)),x.s=0,x.clamp()},e.prototype.divRemTo=function(x,N,V){var S=x.abs();if(!(S.t<=0)){var C=this.abs();if(C.t<S.t)return N?.fromInt(0),void(V!=null&&this.copyTo(V));V==null&&(V=r());var T=r(),M=this.s,et=x.s,Pt=this.DB-A(S[S.t-1]);Pt>0?(S.lShiftTo(Pt,T),C.lShiftTo(Pt,V)):(S.copyTo(T),C.copyTo(V));var Ut=T.t,Zt=T[Ut-1];if(Zt!=0){var _e=Zt*(1<<this.F1)+(Ut>1?T[Ut-2]>>this.F2:0),me=this.FV/_e,de=(1<<this.F1)/_e,Xt=1<<this.F2,Gt=V.t,pe=Gt-Ut,ge=N??r();for(T.dlShiftTo(pe,ge),V.compareTo(ge)>=0&&(V[V.t++]=1,V.subTo(ge,V)),e.ONE.dlShiftTo(Ut,ge),ge.subTo(T,T);T.t<Ut;)T[T.t++]=0;for(;--pe>=0;){var Dt=V[--Gt]==Zt?this.DM:Math.floor(V[Gt]*me+(V[Gt-1]+Xt)*de);if((V[Gt]+=T.am(0,Dt,V,pe,0,Ut))<Dt)for(T.dlShiftTo(pe,ge),V.subTo(ge,V);V[Gt]<--Dt;)V.subTo(ge,V)}N!=null&&(V.drShiftTo(Ut,N),M!=et&&e.ZERO.subTo(N,N)),V.t=Ut,V.clamp(),Pt>0&&V.rShiftTo(Pt,V),M<0&&e.ZERO.subTo(V,V)}}},e.prototype.invDigit=function(){if(this.t<1)return 0;var x=this[0];if(!(1&x))return 0;var N=3&x;return(N=(N=(N=(N=N*(2-(15&x)*N)&15)*(2-(255&x)*N)&255)*(2-((65535&x)*N&65535))&65535)*(2-x*N%this.DV)%this.DV)>0?this.DV-N:-N},e.prototype.isEven=function(){return(this.t>0?1&this[0]:this.s)==0},e.prototype.exp=function(x,N){if(x>4294967295||x<1)return e.ONE;var V=r(),S=r(),C=N.convert(this),T=A(x)-1;for(C.copyTo(V);--T>=0;)if(N.sqrTo(V,S),(x&1<<T)>0)N.mulTo(S,C,V);else{var M=V;V=S,S=M}return N.revert(V)},e.prototype.toString=function(x){if(this.s<0)return"-"+this.negate().toString(x);var N;if(x==16)N=4;else if(x==8)N=3;else if(x==2)N=1;else if(x==32)N=5;else{if(x!=4)return this.toRadix(x);N=2}var V,S=(1<<N)-1,C=!1,T="",M=this.t,et=this.DB-M*this.DB%N;if(M-- >0)for(et<this.DB&&(V=this[M]>>et)>0&&(C=!0,T=h(V));M>=0;)et<N?(V=(this[M]&(1<<et)-1)<<N-et,V|=this[--M]>>(et+=this.DB-N)):(V=this[M]>>(et-=N)&S,et<=0&&(et+=this.DB,--M)),V>0&&(C=!0),C&&(T+=h(V));return C?T:"0"},e.prototype.negate=function(){var x=r();return e.ZERO.subTo(this,x),x},e.prototype.abs=function(){return this.s<0?this.negate():this},e.prototype.compareTo=function(x){var N=this.s-x.s;if(N!=0)return N;var V=this.t;if((N=V-x.t)!=0)return this.s<0?-N:N;for(;--V>=0;)if((N=this[V]-x[V])!=0)return N;return 0},e.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+A(this[this.t-1]^this.s&this.DM)},e.prototype.mod=function(x){var N=r();return this.abs().divRemTo(x,null,N),this.s<0&&N.compareTo(e.ZERO)>0&&x.subTo(N,N),N},e.prototype.modPowInt=function(x,N){var V;return V=x<256||N.isEven()?new D(N):new q(N),this.exp(x,V)},e.ZERO=k(0),e.ONE=k(1),ot.prototype.convert=tt,ot.prototype.revert=tt,ot.prototype.mulTo=function(x,N,V){x.multiplyTo(N,V)},ot.prototype.sqrTo=function(x,N){x.squareTo(N)},gt.prototype.convert=function(x){if(x.s<0||x.t>2*this.m.t)return x.mod(this.m);if(x.compareTo(this.m)<0)return x;var N=r();return x.copyTo(N),this.reduce(N),N},gt.prototype.revert=function(x){return x},gt.prototype.reduce=function(x){for(x.drShiftTo(this.m.t-1,this.r2),x.t>this.m.t+1&&(x.t=this.m.t+1,x.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);x.compareTo(this.r2)<0;)x.dAddOffset(1,this.m.t+1);for(x.subTo(this.r2,x);x.compareTo(this.m)>=0;)x.subTo(this.m,x)},gt.prototype.mulTo=function(x,N,V){x.multiplyTo(N,V),this.reduce(V)},gt.prototype.sqrTo=function(x,N){x.squareTo(N),this.reduce(N)};var wt,ft,yt,Ct=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],l=(1<<26)/Ct[Ct.length-1];function s(){var x;x=new Date().getTime(),ft[yt++]^=255&x,ft[yt++]^=x>>8&255,ft[yt++]^=x>>16&255,ft[yt++]^=x>>24&255,yt>=St&&(yt-=St)}if(e.prototype.chunkSize=function(x){return Math.floor(Math.LN2*this.DB/Math.log(x))},e.prototype.toRadix=function(x){if(x==null&&(x=10),this.signum()==0||x<2||x>36)return"0";var N=this.chunkSize(x),V=Math.pow(x,N),S=k(V),C=r(),T=r(),M="";for(this.divRemTo(S,C,T);C.signum()>0;)M=(V+T.intValue()).toString(x).substr(1)+M,C.divRemTo(S,C,T);return T.intValue().toString(x)+M},e.prototype.fromRadix=function(x,N){this.fromInt(0),N==null&&(N=10);for(var V=this.chunkSize(N),S=Math.pow(N,V),C=!1,T=0,M=0,et=0;et<x.length;++et){var Pt=y(x,et);Pt<0?x.charAt(et)=="-"&&this.signum()==0&&(C=!0):(M=N*M+Pt,++T>=V&&(this.dMultiply(S),this.dAddOffset(M,0),T=0,M=0))}T>0&&(this.dMultiply(Math.pow(N,T)),this.dAddOffset(M,0)),C&&e.ZERO.subTo(this,this)},e.prototype.fromNumber=function(x,N,V){if(typeof N=="number")if(x<2)this.fromInt(1);else for(this.fromNumber(x,V),this.testBit(x-1)||this.bitwiseTo(e.ONE.shiftLeft(x-1),z,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(N);)this.dAddOffset(2,0),this.bitLength()>x&&this.subTo(e.ONE.shiftLeft(x-1),this);else{var S=new Array,C=7&x;S.length=1+(x>>3),N.nextBytes(S),C>0?S[0]&=(1<<C)-1:S[0]=0,this.fromString(S,256)}},e.prototype.bitwiseTo=function(x,N,V){var S,C,T=Math.min(x.t,this.t);for(S=0;S<T;++S)V[S]=N(this[S],x[S]);if(x.t<this.t){for(C=x.s&this.DM,S=T;S<this.t;++S)V[S]=N(this[S],C);V.t=this.t}else{for(C=this.s&this.DM,S=T;S<x.t;++S)V[S]=N(C,x[S]);V.t=x.t}V.s=N(this.s,x.s),V.clamp()},e.prototype.changeBit=function(x,N){var V=e.ONE.shiftLeft(x);return this.bitwiseTo(V,N,V),V},e.prototype.addTo=function(x,N){for(var V=0,S=0,C=Math.min(x.t,this.t);V<C;)S+=this[V]+x[V],N[V++]=S&this.DM,S>>=this.DB;if(x.t<this.t){for(S+=x.s;V<this.t;)S+=this[V],N[V++]=S&this.DM,S>>=this.DB;S+=this.s}else{for(S+=this.s;V<x.t;)S+=x[V],N[V++]=S&this.DM,S>>=this.DB;S+=x.s}N.s=S<0?-1:0,S>0?N[V++]=S:S<-1&&(N[V++]=this.DV+S),N.t=V,N.clamp()},e.prototype.dMultiply=function(x){this[this.t]=this.am(0,x-1,this,0,0,this.t),++this.t,this.clamp()},e.prototype.dAddOffset=function(x,N){if(x!=0){for(;this.t<=N;)this[this.t++]=0;for(this[N]+=x;this[N]>=this.DV;)this[N]-=this.DV,++N>=this.t&&(this[this.t++]=0),++this[N]}},e.prototype.multiplyLowerTo=function(x,N,V){var S,C=Math.min(this.t+x.t,N);for(V.s=0,V.t=C;C>0;)V[--C]=0;for(S=V.t-this.t;C<S;++C)V[C+this.t]=this.am(0,x[C],V,C,0,this.t);for(S=Math.min(x.t,N);C<S;++C)this.am(0,x[C],V,C,0,N-C);V.clamp()},e.prototype.multiplyUpperTo=function(x,N,V){--N;var S=V.t=this.t+x.t-N;for(V.s=0;--S>=0;)V[S]=0;for(S=Math.max(N-this.t,0);S<x.t;++S)V[this.t+S-N]=this.am(N-S,x[S],V,0,0,this.t+S-N);V.clamp(),V.drShiftTo(1,V)},e.prototype.modInt=function(x){if(x<=0)return 0;var N=this.DV%x,V=this.s<0?x-1:0;if(this.t>0)if(N==0)V=this[0]%x;else for(var S=this.t-1;S>=0;--S)V=(N*V+this[S])%x;return V},e.prototype.millerRabin=function(x){var N=this.subtract(e.ONE),V=N.getLowestSetBit();if(V<=0)return!1;var S=N.shiftRight(V);(x=x+1>>1)>Ct.length&&(x=Ct.length);for(var C=r(),T=0;T<x;++T){C.fromInt(Ct[Math.floor(Math.random()*Ct.length)]);var M=C.modPow(S,this);if(M.compareTo(e.ONE)!=0&&M.compareTo(N)!=0){for(var et=1;et++<V&&M.compareTo(N)!=0;)if((M=M.modPowInt(2,this)).compareTo(e.ONE)==0)return!1;if(M.compareTo(N)!=0)return!1}}return!0},e.prototype.clone=function(){var x=r();return this.copyTo(x),x},e.prototype.intValue=function(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},e.prototype.byteValue=function(){return this.t==0?this.s:this[0]<<24>>24},e.prototype.shortValue=function(){return this.t==0?this.s:this[0]<<16>>16},e.prototype.signum=function(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1},e.prototype.toByteArray=function(){var x=this.t,N=new Array;N[0]=this.s;var V,S=this.DB-x*this.DB%8,C=0;if(x-- >0)for(S<this.DB&&(V=this[x]>>S)!=(this.s&this.DM)>>S&&(N[C++]=V|this.s<<this.DB-S);x>=0;)S<8?(V=(this[x]&(1<<S)-1)<<8-S,V|=this[--x]>>(S+=this.DB-8)):(V=this[x]>>(S-=8)&255,S<=0&&(S+=this.DB,--x)),128&V&&(V|=-256),C==0&&(128&this.s)!=(128&V)&&++C,(C>0||V!=this.s)&&(N[C++]=V);return N},e.prototype.equals=function(x){return this.compareTo(x)==0},e.prototype.min=function(x){return this.compareTo(x)<0?this:x},e.prototype.max=function(x){return this.compareTo(x)>0?this:x},e.prototype.and=function(x){var N=r();return this.bitwiseTo(x,H,N),N},e.prototype.or=function(x){var N=r();return this.bitwiseTo(x,z,N),N},e.prototype.xor=function(x){var N=r();return this.bitwiseTo(x,Z,N),N},e.prototype.andNot=function(x){var N=r();return this.bitwiseTo(x,j,N),N},e.prototype.not=function(){for(var x=r(),N=0;N<this.t;++N)x[N]=this.DM&~this[N];return x.t=this.t,x.s=~this.s,x},e.prototype.shiftLeft=function(x){var N=r();return x<0?this.rShiftTo(-x,N):this.lShiftTo(x,N),N},e.prototype.shiftRight=function(x){var N=r();return x<0?this.lShiftTo(-x,N):this.rShiftTo(x,N),N},e.prototype.getLowestSetBit=function(){for(var x=0;x<this.t;++x)if(this[x]!=0)return x*this.DB+at(this[x]);return this.s<0?this.t*this.DB:-1},e.prototype.bitCount=function(){for(var x=0,N=this.s&this.DM,V=0;V<this.t;++V)x+=ct(this[V]^N);return x},e.prototype.testBit=function(x){var N=Math.floor(x/this.DB);return N>=this.t?this.s!=0:(this[N]&1<<x%this.DB)!=0},e.prototype.setBit=function(x){return this.changeBit(x,z)},e.prototype.clearBit=function(x){return this.changeBit(x,j)},e.prototype.flipBit=function(x){return this.changeBit(x,Z)},e.prototype.add=function(x){var N=r();return this.addTo(x,N),N},e.prototype.subtract=function(x){var N=r();return this.subTo(x,N),N},e.prototype.multiply=function(x){var N=r();return this.multiplyTo(x,N),N},e.prototype.divide=function(x){var N=r();return this.divRemTo(x,N,null),N},e.prototype.remainder=function(x){var N=r();return this.divRemTo(x,null,N),N},e.prototype.divideAndRemainder=function(x){var N=r(),V=r();return this.divRemTo(x,N,V),new Array(N,V)},e.prototype.modPow=function(x,N){var V,S,C=x.bitLength(),T=k(1);if(C<=0)return T;V=C<18?1:C<48?3:C<144?4:C<768?5:6,S=C<8?new D(N):N.isEven()?new gt(N):new q(N);var M=new Array,et=3,Pt=V-1,Ut=(1<<V)-1;if(M[1]=S.convert(this),V>1){var Zt=r();for(S.sqrTo(M[1],Zt);et<=Ut;)M[et]=r(),S.mulTo(Zt,M[et-2],M[et]),et+=2}var _e,me,de=x.t-1,Xt=!0,Gt=r();for(C=A(x[de])-1;de>=0;){for(C>=Pt?_e=x[de]>>C-Pt&Ut:(_e=(x[de]&(1<<C+1)-1)<<Pt-C,de>0&&(_e|=x[de-1]>>this.DB+C-Pt)),et=V;!(1&_e);)_e>>=1,--et;if((C-=et)<0&&(C+=this.DB,--de),Xt)M[_e].copyTo(T),Xt=!1;else{for(;et>1;)S.sqrTo(T,Gt),S.sqrTo(Gt,T),et-=2;et>0?S.sqrTo(T,Gt):(me=T,T=Gt,Gt=me),S.mulTo(Gt,M[_e],T)}for(;de>=0&&!(x[de]&1<<C);)S.sqrTo(T,Gt),me=T,T=Gt,Gt=me,--C<0&&(C=this.DB-1,--de)}return S.revert(T)},e.prototype.modInverse=function(x){var N=x.isEven();if(this.isEven()&&N||x.signum()==0)return e.ZERO;for(var V=x.clone(),S=this.clone(),C=k(1),T=k(0),M=k(0),et=k(1);V.signum()!=0;){for(;V.isEven();)V.rShiftTo(1,V),N?(C.isEven()&&T.isEven()||(C.addTo(this,C),T.subTo(x,T)),C.rShiftTo(1,C)):T.isEven()||T.subTo(x,T),T.rShiftTo(1,T);for(;S.isEven();)S.rShiftTo(1,S),N?(M.isEven()&&et.isEven()||(M.addTo(this,M),et.subTo(x,et)),M.rShiftTo(1,M)):et.isEven()||et.subTo(x,et),et.rShiftTo(1,et);V.compareTo(S)>=0?(V.subTo(S,V),N&&C.subTo(M,C),T.subTo(et,T)):(S.subTo(V,S),N&&M.subTo(C,M),et.subTo(T,et))}return S.compareTo(e.ONE)!=0?e.ZERO:et.compareTo(x)>=0?et.subtract(x):et.signum()<0?(et.addTo(x,et),et.signum()<0?et.add(x):et):et},e.prototype.pow=function(x){return this.exp(x,new ot)},e.prototype.gcd=function(x){var N=this.s<0?this.negate():this.clone(),V=x.s<0?x.negate():x.clone();if(N.compareTo(V)<0){var S=N;N=V,V=S}var C=N.getLowestSetBit(),T=V.getLowestSetBit();if(T<0)return N;for(C<T&&(T=C),T>0&&(N.rShiftTo(T,N),V.rShiftTo(T,V));N.signum()>0;)(C=N.getLowestSetBit())>0&&N.rShiftTo(C,N),(C=V.getLowestSetBit())>0&&V.rShiftTo(C,V),N.compareTo(V)>=0?(N.subTo(V,N),N.rShiftTo(1,N)):(V.subTo(N,V),V.rShiftTo(1,V));return T>0&&V.lShiftTo(T,V),V},e.prototype.isProbablePrime=function(x){var N,V=this.abs();if(V.t==1&&V[0]<=Ct[Ct.length-1]){for(N=0;N<Ct.length;++N)if(V[0]==Ct[N])return!0;return!1}if(V.isEven())return!1;for(N=1;N<Ct.length;){for(var S=Ct[N],C=N+1;C<Ct.length&&S<l;)S*=Ct[C++];for(S=V.modInt(S);N<C;)if(S%Ct[N++]==0)return!1}return V.millerRabin(x)},e.prototype.square=function(){var x=r();return this.squareTo(x),x},e.prototype.Barrett=gt,ft==null){var b;if(ft=new Array,yt=0,typeof window<"u"&&window.crypto){if(window.crypto.getRandomValues){var $=new Uint8Array(32);for(window.crypto.getRandomValues($),b=0;b<32;++b)ft[yt++]=$[b]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var E=window.crypto.random(32);for(b=0;b<E.length;++b)ft[yt++]=255&E.charCodeAt(b)}}for(;yt<St;)b=Math.floor(65536*Math.random()),ft[yt++]=b>>>8,ft[yt++]=255&b;yt=0,s()}function rt(){if(wt==null){for(s(),(wt=new xt).init(ft),yt=0;yt<ft.length;++yt)ft[yt]=0;yt=0}return wt.next()}function _t(){}function xt(){this.i=0,this.j=0,this.S=new Array}_t.prototype.nextBytes=function(x){var N;for(N=0;N<x.length;++N)x[N]=rt()},xt.prototype.init=function(x){var N,V,S;for(N=0;N<256;++N)this.S[N]=N;for(V=0,N=0;N<256;++N)V=V+this.S[N]+x[N%x.length]&255,S=this.S[N],this.S[N]=this.S[V],this.S[V]=S;this.i=0,this.j=0},xt.prototype.next=function(){var x;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,x=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=x,this.S[x+this.S[this.i]&255]};var St=256;_$jsbn_51!==void 0?_$jsbn_51=_$jsbn_51={default:e,BigInteger:e,SecureRandom:_t}:this.jsbn={BigInteger:e,SecureRandom:_t}}).call(this);var _$sprintf_83={};(function(){"use strict";var t={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function e(o){return function(f,d){var h,y,k,A,D,q,H,z,Z,j=1,at=f.length,ct="";for(y=0;y<at;y++)if(typeof f[y]=="string")ct+=f[y];else if(typeof f[y]=="object"){if((A=f[y]).keys)for(h=d[j],k=0;k<A.keys.length;k++){if(h==null)throw new Error(e('[sprintf] Cannot access property "%s" of undefined value "%s"',A.keys[k],A.keys[k-1]));h=h[A.keys[k]]}else h=A.param_no?d[A.param_no]:d[j++];if(t.not_type.test(A.type)&&t.not_primitive.test(A.type)&&h instanceof Function&&(h=h()),t.numeric_arg.test(A.type)&&typeof h!="number"&&isNaN(h))throw new TypeError(e("[sprintf] expecting number but found %T",h));switch(t.number.test(A.type)&&(z=h>=0),A.type){case"b":h=parseInt(h,10).toString(2);break;case"c":h=String.fromCharCode(parseInt(h,10));break;case"d":case"i":h=parseInt(h,10);break;case"j":h=JSON.stringify(h,null,A.width?parseInt(A.width):0);break;case"e":h=A.precision?parseFloat(h).toExponential(A.precision):parseFloat(h).toExponential();break;case"f":h=A.precision?parseFloat(h).toFixed(A.precision):parseFloat(h);break;case"g":h=A.precision?String(Number(h.toPrecision(A.precision))):parseFloat(h);break;case"o":h=(parseInt(h,10)>>>0).toString(8);break;case"s":h=String(h),h=A.precision?h.substring(0,A.precision):h;break;case"t":h=String(!!h),h=A.precision?h.substring(0,A.precision):h;break;case"T":h=Object.prototype.toString.call(h).slice(8,-1).toLowerCase(),h=A.precision?h.substring(0,A.precision):h;break;case"u":h=parseInt(h,10)>>>0;break;case"v":h=h.valueOf(),h=A.precision?h.substring(0,A.precision):h;break;case"x":h=(parseInt(h,10)>>>0).toString(16);break;case"X":h=(parseInt(h,10)>>>0).toString(16).toUpperCase()}t.json.test(A.type)?ct+=h:(!t.number.test(A.type)||z&&!A.sign?Z="":(Z=z?"+":"-",h=h.toString().replace(t.sign,"")),q=A.pad_char?A.pad_char==="0"?"0":A.pad_char.charAt(1):" ",H=A.width-(Z+h).length,D=A.width&&H>0?q.repeat(H):"",ct+=A.align?Z+h+D:q==="0"?Z+D+h:D+Z+h)}return ct}(function(f){if(n[f])return n[f];for(var d,h=f,y=[],k=0;h;){if((d=t.text.exec(h))!==null)y.push(d[0]);else if((d=t.modulo.exec(h))!==null)y.push("%");else{if((d=t.placeholder.exec(h))===null)throw new SyntaxError("[sprintf] unexpected placeholder");if(d[2]){k|=1;var A=[],D=d[2],q=[];if((q=t.key.exec(D))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");for(A.push(q[1]);(D=D.substring(q[0].length))!=="";)if((q=t.key_access.exec(D))!==null)A.push(q[1]);else{if((q=t.index_access.exec(D))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");A.push(q[1])}d[2]=A}else k|=2;if(k===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");y.push({placeholder:d[0],param_no:d[1],keys:d[2],sign:d[3],pad_char:d[4],align:d[5],width:d[6],precision:d[7],type:d[8]})}h=h.substring(d[0].length)}return n[f]=y}(o),arguments)}function r(o,f){return e.apply(null,[o].concat(f||[]))}var n=Object.create(null);_$sprintf_83!==void 0&&(_$sprintf_83.sprintf=e,_$sprintf_83.vsprintf=r),typeof window<"u"&&(window.sprintf=e,window.vsprintf=r,typeof define=="function"&&define.amd&&define(function(){return{sprintf:e,vsprintf:r}}))})();var _$ipv4_14={},__createBinding=this&&this.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);o&&("get"in o?e.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),__importStar=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&__createBinding(e,t,r);return __setModuleDefault(e,t),e};Object.defineProperty(_$ipv4_14,"__esModule",{value:!0}),_$ipv4_14.Address4=void 0;const common=__importStar(_$common_12),constants=__importStar(_$constants_16);class Address4{constructor(e){this.groups=constants.GROUPS,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=common.isCorrect(constants.BITS),this.isInSubnet=common.isInSubnet,this.address=e;const r=constants.RE_SUBNET_STRING.exec(e);if(r){if(this.parsedSubnet=r[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,this.subnetMask<0||this.subnetMask>constants.BITS)throw new _$addressError_11.AddressError("Invalid subnet mask.");e=e.replace(constants.RE_SUBNET_STRING,"")}this.addressMinusSuffix=e,this.parsedAddress=this.parse(e)}static isValid(e){try{return new Address4(e),!0}catch{return!1}}parse(e){const r=e.split(".");if(!e.match(constants.RE_ADDRESS))throw new _$addressError_11.AddressError("Invalid IPv4 address.");return r}correctForm(){return this.parsedAddress.map(e=>parseInt(e,10)).join(".")}static fromHex(e){const r=e.replace(/:/g,"").padStart(8,"0"),n=[];let o;for(o=0;o<8;o+=2){const f=r.slice(o,o+2);n.push(parseInt(f,16))}return new Address4(n.join("."))}static fromInteger(e){return Address4.fromHex(e.toString(16))}static fromArpa(e){const r=e.replace(/(\.in-addr\.arpa)?\.$/,"").split(".").reverse().join(".");return new Address4(r)}toHex(){return this.parsedAddress.map(e=>(0,_$sprintf_83.sprintf)("%02x",parseInt(e,10))).join(":")}toArray(){return this.parsedAddress.map(e=>parseInt(e,10))}toGroup6(){const e=[];let r;for(r=0;r<constants.GROUPS;r+=2){const n=(0,_$sprintf_83.sprintf)("%02x%02x",parseInt(this.parsedAddress[r],10),parseInt(this.parsedAddress[r+1],10));e.push((0,_$sprintf_83.sprintf)("%x",parseInt(n,16)))}return e.join(":")}bigInteger(){return new _$jsbn_51.BigInteger(this.parsedAddress.map(e=>(0,_$sprintf_83.sprintf)("%02x",parseInt(e,10))).join(""),16)}_startAddress(){return new _$jsbn_51.BigInteger(this.mask()+"0".repeat(constants.BITS-this.subnetMask),2)}startAddress(){return Address4.fromBigInteger(this._startAddress())}startAddressExclusive(){const e=new _$jsbn_51.BigInteger("1");return Address4.fromBigInteger(this._startAddress().add(e))}_endAddress(){return new _$jsbn_51.BigInteger(this.mask()+"1".repeat(constants.BITS-this.subnetMask),2)}endAddress(){return Address4.fromBigInteger(this._endAddress())}endAddressExclusive(){const e=new _$jsbn_51.BigInteger("1");return Address4.fromBigInteger(this._endAddress().subtract(e))}static fromBigInteger(e){return Address4.fromInteger(parseInt(e.toString(),10))}mask(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)}getBitsBase2(e,r){return this.binaryZeroPad().slice(e,r)}reverseForm(e){e||(e={});const r=this.correctForm().split(".").reverse().join(".");return e.omitSuffix?r:(0,_$sprintf_83.sprintf)("%s.in-addr.arpa.",r)}isMulticast(){return this.isInSubnet(new Address4("224.0.0.0/4"))}binaryZeroPad(){return this.bigInteger().toString(2).padStart(constants.BITS,"0")}groupForV6(){const e=this.parsedAddress;return this.address.replace(constants.RE_ADDRESS,(0,_$sprintf_83.sprintf)('<span class="hover-group group-v4 group-6">%s</span>.<span class="hover-group group-v4 group-7">%s</span>',e.slice(0,2).join("."),e.slice(2,4).join(".")))}}_$ipv4_14.Address4=Address4;var _$constants_17={};Object.defineProperty(_$constants_17,"__esModule",{value:!0}),_$constants_17.RE_URL_WITH_PORT=_$constants_17.RE_URL=_$constants_17.RE_ZONE_STRING=_$constants_17.RE_SUBNET_STRING=_$constants_17.RE_BAD_ADDRESS=_$constants_17.RE_BAD_CHARACTERS=_$constants_17.TYPES=_$constants_17.SCOPES=_$constants_17.GROUPS=_$constants_17.BITS=void 0,_$constants_17.BITS=128,_$constants_17.GROUPS=8,_$constants_17.SCOPES={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"},_$constants_17.TYPES={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"},_$constants_17.RE_BAD_CHARACTERS=/([^0-9a-f:/%])/gi,_$constants_17.RE_BAD_ADDRESS=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi,_$constants_17.RE_SUBNET_STRING=/\/\d{1,3}(?=%|$)/,_$constants_17.RE_ZONE_STRING=/%.*$/,_$constants_17.RE_URL=new RegExp(/^\[{0,1}([0-9a-f:]+)\]{0,1}/),_$constants_17.RE_URL_WITH_PORT=new RegExp(/\[([0-9a-f:]+)\]:([0-9]{1,5})/);var _$helpers_18={};function spanAllZeroes(t){return t.replace(/(0+)/g,'<span class="zero">$1</span>')}function spanLeadingZeroesSimple(t){return t.replace(/^(0+)/,'<span class="zero">$1</span>')}Object.defineProperty(_$helpers_18,"__esModule",{value:!0}),_$helpers_18.simpleGroup=_$helpers_18.spanLeadingZeroes=_$helpers_18.spanAll=_$helpers_18.spanAllZeroes=void 0,_$helpers_18.spanAllZeroes=spanAllZeroes,_$helpers_18.spanAll=function(t,e=0){return t.split("").map((r,n)=>(0,_$sprintf_83.sprintf)('<span class="digit value-%s position-%d">%s</span>',r,n+e,spanAllZeroes(r))).join("")},_$helpers_18.spanLeadingZeroes=function(t){return t.split(":").map(e=>spanLeadingZeroesSimple(e)).join(":")},_$helpers_18.simpleGroup=function(t,e=0){return t.split(":").map((r,n)=>/group-v4/.test(r)?r:(0,_$sprintf_83.sprintf)('<span class="hover-group group-%d">%s</span>',n+e,spanLeadingZeroesSimple(r)))};var _$regularExpressions_19={},____createBinding_19=this&&this.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);o&&("get"in o?e.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),____setModuleDefault_19=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),____importStar_19=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&____createBinding_19(e,t,r);return ____setModuleDefault_19(e,t),e};Object.defineProperty(_$regularExpressions_19,"__esModule",{value:!0}),_$regularExpressions_19.possibleElisions=_$regularExpressions_19.simpleRegularExpression=_$regularExpressions_19.ADDRESS_BOUNDARY=_$regularExpressions_19.padGroup=_$regularExpressions_19.groupPossibilities=void 0;const v6=____importStar_19(_$constants_17);function groupPossibilities(t){return(0,_$sprintf_83.sprintf)("(%s)",t.join("|"))}function padGroup(t){return t.length<4?(0,_$sprintf_83.sprintf)("0{0,%d}%s",4-t.length,t):t}_$regularExpressions_19.groupPossibilities=groupPossibilities,_$regularExpressions_19.padGroup=padGroup,_$regularExpressions_19.ADDRESS_BOUNDARY="[^A-Fa-f0-9:]",_$regularExpressions_19.simpleRegularExpression=function(t){const e=[];t.forEach((n,o)=>{parseInt(n,16)===0&&e.push(o)});const r=e.map(n=>t.map((o,f)=>{if(f===n){const d=f===0||f===v6.GROUPS-1?":":"";return groupPossibilities([padGroup(o),d])}return padGroup(o)}).join(":"));return r.push(t.map(padGroup).join(":")),groupPossibilities(r)},_$regularExpressions_19.possibleElisions=function(t,e,r){const n=e?"":":",o=r?"":":",f=[];e||r||f.push("::"),e&&r&&f.push(""),(r&&!e||!r&&e)&&f.push(":"),f.push((0,_$sprintf_83.sprintf)("%s(:0{1,4}){1,%d}",n,t-1)),f.push((0,_$sprintf_83.sprintf)("(0{1,4}:){1,%d}%s",t-1,o)),f.push((0,_$sprintf_83.sprintf)("(0{1,4}:){%d}0{1,4}",t-1));for(let d=1;d<t-1;d++)for(let h=1;h<t-d;h++)f.push((0,_$sprintf_83.sprintf)("(0{1,4}:){%d}:(0{1,4}:){%d}0{1,4}",h,t-h-d-1));return groupPossibilities(f)};var _$ipv6_15={},____createBinding_15=this&&this.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);o&&("get"in o?e.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),____setModuleDefault_15=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),____importStar_15=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&____createBinding_15(e,t,r);return ____setModuleDefault_15(e,t),e};Object.defineProperty(_$ipv6_15,"__esModule",{value:!0}),_$ipv6_15.Address6=void 0;const __common_15=____importStar_15(_$common_12),constants4=____importStar_15(_$constants_16),constants6=____importStar_15(_$constants_17),helpers=____importStar_15(_$helpers_18);function spanLeadingZeroes4(t){return(t=t.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2')).replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2')}function paddedHex(t){return(0,_$sprintf_83.sprintf)("%04x",parseInt(t,16))}function unsignByte(t){return 255&t}class Address6{constructor(e,r){this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=__common_15.isInSubnet,this.isCorrect=__common_15.isCorrect(constants6.BITS),this.groups=r===void 0?constants6.GROUPS:r,this.address=e;const n=constants6.RE_SUBNET_STRING.exec(e);if(n){if(this.parsedSubnet=n[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>constants6.BITS)throw new _$addressError_11.AddressError("Invalid subnet mask.");e=e.replace(constants6.RE_SUBNET_STRING,"")}else if(/\//.test(e))throw new _$addressError_11.AddressError("Invalid subnet mask.");const o=constants6.RE_ZONE_STRING.exec(e);o&&(this.zone=o[0],e=e.replace(constants6.RE_ZONE_STRING,"")),this.addressMinusSuffix=e,this.parsedAddress=this.parse(this.addressMinusSuffix)}static isValid(e){try{return new Address6(e),!0}catch{return!1}}static fromBigInteger(e){const r=e.toString(16).padStart(32,"0"),n=[];let o;for(o=0;o<constants6.GROUPS;o++)n.push(r.slice(4*o,4*(o+1)));return new Address6(n.join(":"))}static fromURL(e){let r,n,o=null;if(e.indexOf("[")!==-1&&e.indexOf("]:")!==-1){if((n=constants6.RE_URL_WITH_PORT.exec(e))===null)return{error:"failed to parse address with port",address:null,port:null};r=n[1],o=n[2]}else if(e.indexOf("/")!==-1){if(e=e.replace(/^[a-z0-9]+:\/\//,""),(n=constants6.RE_URL.exec(e))===null)return{error:"failed to parse address from URL",address:null,port:null};r=n[1]}else r=e;return o?((o=parseInt(o,10))<0||o>65536)&&(o=null):o=null,{address:new Address6(r),port:o}}static fromAddress4(e){const r=new _$ipv4_14.Address4(e),n=constants6.BITS-(constants4.BITS-r.subnetMask);return new Address6(`::ffff:${r.correctForm()}/${n}`)}static fromArpa(e){let r=e.replace(/(\.ip6\.arpa)?\.$/,"");if(r.length!==63)throw new _$addressError_11.AddressError("Invalid 'ip6.arpa' form.");const n=r.split(".").reverse();for(let o=7;o>0;o--){const f=4*o;n.splice(f,0,":")}return r=n.join(""),new Address6(r)}microsoftTranscription(){return(0,_$sprintf_83.sprintf)("%s.ipv6-literal.net",this.correctForm().replace(/:/g,"-"))}mask(e=this.subnetMask){return this.getBitsBase2(0,e)}possibleSubnets(e=128){const r=constants6.BITS-this.subnetMask-Math.abs(e-constants6.BITS);return r<0?"0":function(n){const o=/(\d+)(\d{3})/;for(;o.test(n);)n=n.replace(o,"$1,$2");return n}(new _$jsbn_51.BigInteger("2",10).pow(r).toString(10))}_startAddress(){return new _$jsbn_51.BigInteger(this.mask()+"0".repeat(constants6.BITS-this.subnetMask),2)}startAddress(){return Address6.fromBigInteger(this._startAddress())}startAddressExclusive(){const e=new _$jsbn_51.BigInteger("1");return Address6.fromBigInteger(this._startAddress().add(e))}_endAddress(){return new _$jsbn_51.BigInteger(this.mask()+"1".repeat(constants6.BITS-this.subnetMask),2)}endAddress(){return Address6.fromBigInteger(this._endAddress())}endAddressExclusive(){const e=new _$jsbn_51.BigInteger("1");return Address6.fromBigInteger(this._endAddress().subtract(e))}getScope(){let e=constants6.SCOPES[this.getBits(12,16).intValue()];return this.getType()==="Global unicast"&&e!=="Link local"&&(e="Global"),e||"Unknown"}getType(){for(const e of Object.keys(constants6.TYPES))if(this.isInSubnet(new Address6(e)))return constants6.TYPES[e];return"Global unicast"}getBits(e,r){return new _$jsbn_51.BigInteger(this.getBitsBase2(e,r),2)}getBitsBase2(e,r){return this.binaryZeroPad().slice(e,r)}getBitsBase16(e,r){const n=r-e;if(n%4!=0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(e,r).toString(16).padStart(n/4,"0")}getBitsPastSubnet(){return this.getBitsBase2(this.subnetMask,constants6.BITS)}reverseForm(e){e||(e={});const r=Math.floor(this.subnetMask/4),n=this.canonicalForm().replace(/:/g,"").split("").slice(0,r).reverse().join(".");return r>0?e.omitSuffix?n:(0,_$sprintf_83.sprintf)("%s.ip6.arpa.",n):e.omitSuffix?"":"ip6.arpa."}correctForm(){let e,r=[],n=0;const o=[];for(e=0;e<this.parsedAddress.length;e++){const h=parseInt(this.parsedAddress[e],16);h===0&&n++,h!==0&&n>0&&(n>1&&o.push([e-n,e-1]),n=0)}n>1&&o.push([this.parsedAddress.length-n,this.parsedAddress.length-1]);const f=o.map(h=>h[1]-h[0]+1);if(o.length>0){const h=f.indexOf(Math.max(...f));r=function(y,k){const A=[],D=[];let q;for(q=0;q<y.length;q++)q<k[0]?A.push(y[q]):q>k[1]&&D.push(y[q]);return A.concat(["compact"]).concat(D)}(this.parsedAddress,o[h])}else r=this.parsedAddress;for(e=0;e<r.length;e++)r[e]!=="compact"&&(r[e]=parseInt(r[e],16).toString(16));let d=r.join(":");return(d=(d=d.replace(/^compact$/,"::")).replace(/^compact|compact$/,":")).replace(/compact/,"")}binaryZeroPad(){return this.bigInteger().toString(2).padStart(constants6.BITS,"0")}parse4in6(e){const r=e.split(":"),n=r.slice(-1)[0].match(constants4.RE_ADDRESS);if(n){this.parsedAddress4=n[0],this.address4=new _$ipv4_14.Address4(this.parsedAddress4);for(let o=0;o<this.address4.groups;o++)if(/^0[0-9]+/.test(this.address4.parsedAddress[o]))throw new _$addressError_11.AddressError("IPv4 addresses can't have leading zeroes.",e.replace(constants4.RE_ADDRESS,this.address4.parsedAddress.map(spanLeadingZeroes4).join(".")));this.v4=!0,r[r.length-1]=this.address4.toGroup6(),e=r.join(":")}return e}parse(e){const r=(e=this.parse4in6(e)).match(constants6.RE_BAD_CHARACTERS);if(r)throw new _$addressError_11.AddressError((0,_$sprintf_83.sprintf)("Bad character%s detected in address: %s",r.length>1?"s":"",r.join("")),e.replace(constants6.RE_BAD_CHARACTERS,'<span class="parse-error">$1</span>'));const n=e.match(constants6.RE_BAD_ADDRESS);if(n)throw new _$addressError_11.AddressError((0,_$sprintf_83.sprintf)("Address failed regex: %s",n.join("")),e.replace(constants6.RE_BAD_ADDRESS,'<span class="parse-error">$1</span>'));let o=[];const f=e.split("::");if(f.length===2){let d=f[0].split(":"),h=f[1].split(":");d.length===1&&d[0]===""&&(d=[]),h.length===1&&h[0]===""&&(h=[]);const y=this.groups-(d.length+h.length);if(!y)throw new _$addressError_11.AddressError("Error parsing groups");this.elidedGroups=y,this.elisionBegin=d.length,this.elisionEnd=d.length+this.elidedGroups,o=o.concat(d);for(let k=0;k<y;k++)o.push("0");o=o.concat(h)}else{if(f.length!==1)throw new _$addressError_11.AddressError("Too many :: groups found");o=e.split(":"),this.elidedGroups=0}if((o=o.map(d=>(0,_$sprintf_83.sprintf)("%x",parseInt(d,16)))).length!==this.groups)throw new _$addressError_11.AddressError("Incorrect number of groups found");return o}canonicalForm(){return this.parsedAddress.map(paddedHex).join(":")}decimal(){return this.parsedAddress.map(e=>(0,_$sprintf_83.sprintf)("%05d",parseInt(e,16))).join(":")}bigInteger(){return new _$jsbn_51.BigInteger(this.parsedAddress.map(paddedHex).join(""),16)}to4(){const e=this.binaryZeroPad().split("");return _$ipv4_14.Address4.fromHex(new _$jsbn_51.BigInteger(e.slice(96,128).join(""),2).toString(16))}to4in6(){const e=this.to4(),r=new Address6(this.parsedAddress.slice(0,6).join(":"),6).correctForm();let n="";return/:$/.test(r)||(n=":"),r+n+e.address}inspectTeredo(){const e=this.getBitsBase16(0,32),r=this.getBits(80,96).xor(new _$jsbn_51.BigInteger("ffff",16)).toString(),n=_$ipv4_14.Address4.fromHex(this.getBitsBase16(32,64)),o=_$ipv4_14.Address4.fromHex(this.getBits(96,128).xor(new _$jsbn_51.BigInteger("ffffffff",16)).toString(16)),f=this.getBits(64,80),d=this.getBitsBase2(64,80),h=f.testBit(15),y=f.testBit(14),k=f.testBit(8),A=f.testBit(9),D=new _$jsbn_51.BigInteger(d.slice(2,6)+d.slice(8,16),2).toString(10);return{prefix:(0,_$sprintf_83.sprintf)("%s:%s",e.slice(0,4),e.slice(4,8)),server4:n.address,client4:o.address,flags:d,coneNat:h,microsoft:{reserved:y,universalLocal:A,groupIndividual:k,nonce:D},udpPort:r}}inspect6to4(){const e=this.getBitsBase16(0,16),r=_$ipv4_14.Address4.fromHex(this.getBitsBase16(16,48));return{prefix:(0,_$sprintf_83.sprintf)("%s",e.slice(0,4)),gateway:r.address}}to6to4(){if(!this.is4())return null;const e=["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":");return new Address6(e)}toByteArray(){const e=this.bigInteger().toByteArray();return e.length===17&&e[0]===0?e.slice(1):e}toUnsignedByteArray(){return this.toByteArray().map(unsignByte)}static fromByteArray(e){return this.fromUnsignedByteArray(e.map(unsignByte))}static fromUnsignedByteArray(e){const r=new _$jsbn_51.BigInteger("256",10);let n=new _$jsbn_51.BigInteger("0",10),o=new _$jsbn_51.BigInteger("1",10);for(let f=e.length-1;f>=0;f--)n=n.add(o.multiply(new _$jsbn_51.BigInteger(e[f].toString(10),10))),o=o.multiply(r);return Address6.fromBigInteger(n)}isCanonical(){return this.addressMinusSuffix===this.canonicalForm()}isLinkLocal(){return this.getBitsBase2(0,64)==="1111111010000000000000000000000000000000000000000000000000000000"}isMulticast(){return this.getType()==="Multicast"}is4(){return this.v4}isTeredo(){return this.isInSubnet(new Address6("2001::/32"))}is6to4(){return this.isInSubnet(new Address6("2002::/16"))}isLoopback(){return this.getType()==="Loopback"}href(e){return e=e===void 0?"":(0,_$sprintf_83.sprintf)(":%s",e),(0,_$sprintf_83.sprintf)("http://[%s]%s/",this.correctForm(),e)}link(e){e||(e={}),e.className===void 0&&(e.className=""),e.prefix===void 0&&(e.prefix="/#address="),e.v4===void 0&&(e.v4=!1);let r=this.correctForm;return e.v4&&(r=this.to4in6),e.className?(0,_$sprintf_83.sprintf)('<a href="%1$s%2$s" class="%3$s">%2$s</a>',e.prefix,r.call(this),e.className):(0,_$sprintf_83.sprintf)('<a href="%1$s%2$s">%2$s</a>',e.prefix,r.call(this))}group(){if(this.elidedGroups===0)return helpers.simpleGroup(this.address).join(":");const e=[],[r,n]=this.address.split("::");r.length?e.push(...helpers.simpleGroup(r)):e.push("");const o=["hover-group"];for(let f=this.elisionBegin;f<this.elisionBegin+this.elidedGroups;f++)o.push((0,_$sprintf_83.sprintf)("group-%d",f));return e.push((0,_$sprintf_83.sprintf)('<span class="%s"></span>',o.join(" "))),n.length?e.push(...helpers.simpleGroup(n,this.elisionEnd)):e.push(""),this.is4()&&(e.pop(),e.push(this.address4.groupForV6())),e.join(":")}regularExpressionString(e=!1){let r=[];const n=new Address6(this.correctForm());if(n.elidedGroups===0)r.push((0,_$regularExpressions_19.simpleRegularExpression)(n.parsedAddress));else if(n.elidedGroups===constants6.GROUPS)r.push((0,_$regularExpressions_19.possibleElisions)(constants6.GROUPS));else{const o=n.address.split("::");o[0].length&&r.push((0,_$regularExpressions_19.simpleRegularExpression)(o[0].split(":"))),r.push((0,_$regularExpressions_19.possibleElisions)(n.elidedGroups,o[0].length!==0,o[1].length!==0)),o[1].length&&r.push((0,_$regularExpressions_19.simpleRegularExpression)(o[1].split(":"))),r=[r.join(":")]}return e||(r=["(?=^|",_$regularExpressions_19.ADDRESS_BOUNDARY,"|[^\\w\\:])(",...r,")(?=[^\\w\\:]|",_$regularExpressions_19.ADDRESS_BOUNDARY,"|$)"]),r.join("")}regularExpression(e=!1){return new RegExp(this.regularExpressionString(e),"i")}}_$ipv6_15.Address6=Address6;var _$ipAddress_13={},____createBinding_13=this&&this.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);o&&("get"in o?e.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),____setModuleDefault_13=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),____importStar_13=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&____createBinding_13(e,t,r);return ____setModuleDefault_13(e,t),e};Object.defineProperty(_$ipAddress_13,"__esModule",{value:!0}),_$ipAddress_13.v6=_$ipAddress_13.AddressError=_$ipAddress_13.Address6=_$ipAddress_13.Address4=void 0,Object.defineProperty(_$ipAddress_13,"Address4",{enumerable:!0,get:function(){return _$ipv4_14.Address4}}),Object.defineProperty(_$ipAddress_13,"Address6",{enumerable:!0,get:function(){return _$ipv6_15.Address6}}),Object.defineProperty(_$ipAddress_13,"AddressError",{enumerable:!0,get:function(){return _$addressError_11.AddressError}});const __helpers_13=____importStar_13(_$helpers_18);_$ipAddress_13.v6={helpers:__helpers_13};var _$utils_141={};function ___typeof_141(t){return(___typeof_141=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$utils_141,"__esModule",{value:!0}),_$utils_141.getIfNotBlank=function(t,e){return isNotBlank(t)?t:e},_$utils_141.getIfPresent=function(t,e){return isPresent(t)?t:e},_$utils_141.getPolicyDescriptor=function(t){return t?/^.+?\s*?=\s*?.+?\s*?,.+?/.test(t)?{"policy-descriptor":t}:{policy:t}:{}},_$utils_141.getRandomPort=function(t){var e,r=t.split(/,|\//),n=r[Math.floor(Math.random()*r.length)];if(n.includes("-")){var o=function(f){if(Array.isArray(f))return f}(e=n.split("-").map(Number))||function(f,d){var h=f==null?null:typeof Symbol<"u"&&f[Symbol.iterator]||f["@@iterator"];if(h!=null){var y,k,A=[],D=!0,q=!1;try{for(h=h.call(f);!(D=(y=h.next()).done)&&(A.push(y.value),A.length!==2);D=!0);}catch(H){q=!0,k=H}finally{try{D||h.return==null||h.return()}finally{if(q)throw k}}return A}}(e)||function(f,d){if(f){if(typeof f=="string")return ___arrayLikeToArray_141(f,2);var h=Object.prototype.toString.call(f).slice(8,-1);return h==="Object"&&f.constructor&&(h=f.constructor.name),h==="Map"||h==="Set"?Array.from(f):h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h)?___arrayLikeToArray_141(f,2):void 0}}(e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}();return function(f,d){return f=Math.ceil(f),d=Math.floor(d),Math.floor(Math.random()*(d-f+1))+f}(o[0],o[1])}return Number(n)},_$utils_141.ipAddress=void 0,_$utils_141.isIPv4=function(t){return IPV4_REGEX.test(t)},_$utils_141.isIPv6=function(t){return IPV6_REGEX.test(t)},_$utils_141.isNotBlank=isNotBlank,_$utils_141.isPresent=isPresent,_$utils_141.isValidPortNumber=function(t){return/^((6553[0-5])|(655[0-2][0-9])|(65[0-4][0-9]{2})|(6[0-4][0-9]{3})|([1-5][0-9]{4})|([0-5]{0,5})|([0-9]{1,4}))$/.test(t)},_$utils_141.numberToString=function(t){return Number.isSafeInteger(t)?String(t):BigInt(t).toString()};var ipAddress=function(t,e){if(t&&t.__esModule)return t;if(t===null||___typeof_141(t)!=="object"&&typeof t!="function")return{default:t};var r=_getRequireWildcardCache(void 0);if(r&&r.has(t))return r.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var d=o?Object.getOwnPropertyDescriptor(t,f):null;d&&(d.get||d.set)?Object.defineProperty(n,f,d):n[f]=t[f]}return n.default=t,r&&r.set(t,n),n}(_$ipAddress_13);function _getRequireWildcardCache(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(n){return n?r:e})(t)}function ___arrayLikeToArray_141(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}_$utils_141.ipAddress=ipAddress;var IPV4_REGEX=/^((25[0-5]|(2[0-4]|1\d|[1-9]|)\d)(\.(?!$)|$)){4}$/,IPV6_REGEX=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/;function isNotBlank(t){return typeof t=="string"&&t.trim().length>0}function isPresent(t){return t!=null}var _$resourceCache_144={};Object.defineProperty(_$resourceCache_144,"__esModule",{value:!0}),_$resourceCache_144.default=void 0;var __obj_144,___app_144=(__obj_144=_$app_87)&&__obj_144.__esModule?__obj_144:{default:__obj_144};function _slicedToArray(t,e){return function(r){if(Array.isArray(r))return r}(t)||function(r,n){var o=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o!=null){var f,d,h=[],y=!0,k=!1;try{for(o=o.call(r);!(y=(f=o.next()).done)&&(h.push(f.value),!n||h.length!==n);y=!0);}catch(A){k=!0,d=A}finally{try{y||o.return==null||o.return()}finally{if(k)throw d}}return h}}(t,e)||function(r,n){if(r){if(typeof r=="string")return ___arrayLikeToArray_144(r,n);var o=Object.prototype.toString.call(r).slice(8,-1);return o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set"?Array.from(r):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?___arrayLikeToArray_144(r,n):void 0}}(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ___arrayLikeToArray_144(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ___defineProperties_144(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var ___default_144=new(function(){function t(n){(function(f,d){if(!(f instanceof d))throw new TypeError("Cannot call a class as a function")})(this,t),this.expires=n,___app_144.default.read(_$constants_86.RESOURCE_CACHE_KEY)||___app_144.default.write("{}",_$constants_86.RESOURCE_CACHE_KEY);try{this.resourceCache=JSON.parse(___app_144.default.read(_$constants_86.RESOURCE_CACHE_KEY))}catch(f){var o;___app_144.default.error("\u89E3\u6790\u6301\u4E45\u5316\u7F13\u5B58\u4E2D\u7684 ".concat(_$constants_86.RESOURCE_CACHE_KEY," \u5931\u8D25, \u91CD\u7F6E\u4E3A {}, \u9519\u8BEF: ").concat((o=f?.message)!==null&&o!==void 0?o:f)),this.resourceCache={},___app_144.default.write("{}",_$constants_86.RESOURCE_CACHE_KEY)}this._cleanup()}var e,r;return e=t,(r=[{key:"_cleanup",value:function(){var n=this,o=!1;Object.entries(this.resourceCache).forEach(function(f){var d=_slicedToArray(f,2),h=d[0],y=d[1];y.time||(delete n.resourceCache[h],___app_144.default.delete("#".concat(h)),o=!0),new Date().getTime()-y.time>n.expires&&(delete n.resourceCache[h],o=!0)}),o&&this._persist()}},{key:"revokeAll",value:function(){this.resourceCache={},this._persist()}},{key:"_persist",value:function(){___app_144.default.write(JSON.stringify(this.resourceCache),_$constants_86.RESOURCE_CACHE_KEY)}},{key:"get",value:function(n){var o=this.resourceCache[n]&&this.resourceCache[n].time;return o&&new Date().getTime()-o<=this.expires?this.resourceCache[n].data:null}},{key:"set",value:function(n,o){this.resourceCache[n]={time:new Date().getTime(),data:o},this._persist()}}])&&___defineProperties_144(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}())(_$constants_86.CACHE_EXPIRATION_TIME_MS);_$resourceCache_144.default=___default_144;var _$headersResourceCache_140={};Object.defineProperty(_$headersResourceCache_140,"__esModule",{value:!0}),_$headersResourceCache_140.default=void 0;var __obj_140,___app_140=(__obj_140=_$app_87)&&__obj_140.__esModule?__obj_140:{default:__obj_140};function ___slicedToArray_140(t,e){return function(r){if(Array.isArray(r))return r}(t)||function(r,n){var o=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o!=null){var f,d,h=[],y=!0,k=!1;try{for(o=o.call(r);!(y=(f=o.next()).done)&&(h.push(f.value),!n||h.length!==n);y=!0);}catch(A){k=!0,d=A}finally{try{y||o.return==null||o.return()}finally{if(k)throw d}}return h}}(t,e)||function(r,n){if(r){if(typeof r=="string")return ___arrayLikeToArray_140(r,n);var o=Object.prototype.toString.call(r).slice(8,-1);return o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set"?Array.from(r):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?___arrayLikeToArray_140(r,n):void 0}}(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ___arrayLikeToArray_140(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ___defineProperties_140(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var ___default_140=new(function(){function t(){(function(o,f){if(!(o instanceof f))throw new TypeError("Cannot call a class as a function")})(this,t),this.expires=function(){___app_140.default.read(_$constants_86.CHR_EXPIRATION_TIME_KEY)||___app_140.default.write("6e4",_$constants_86.CHR_EXPIRATION_TIME_KEY);var o=6e4;if(___app_140.default.env.isLoon){var f={"1\u5206\u949F":6e4,"5\u5206\u949F":3e5,"10\u5206\u949F":6e5,"30\u5206\u949F":18e5,"1\u5C0F\u65F6":36e5,"2\u5C0F\u65F6":72e5,"3\u5C0F\u65F6":108e5,"6\u5C0F\u65F6":216e5,"12\u5C0F\u65F6":432e5,"24\u5C0F\u65F6":864e5,"48\u5C0F\u65F6":1728e5,"72\u5C0F\u65F6":2592e5,\u53C2\u6570\u4F20\u5165:"readcachets"},d=___app_140.default.read("#\u54CD\u5E94\u5934\u7F13\u5B58\u6709\u6548\u671F");return d in f&&(o=f[d])==="readcachets"&&(o=d),o}return ___app_140.default.read(_$constants_86.CHR_EXPIRATION_TIME_KEY)}(),___app_140.default.read(_$constants_86.HEADERS_RESOURCE_CACHE_KEY)||___app_140.default.write("{}",_$constants_86.HEADERS_RESOURCE_CACHE_KEY);try{this.resourceCache=JSON.parse(___app_140.default.read(_$constants_86.HEADERS_RESOURCE_CACHE_KEY))}catch(o){var n;___app_140.default.error("\u89E3\u6790\u6301\u4E45\u5316\u7F13\u5B58\u4E2D\u7684 ".concat(_$constants_86.HEADERS_RESOURCE_CACHE_KEY," \u5931\u8D25, \u91CD\u7F6E\u4E3A {}, \u9519\u8BEF: ").concat((n=o?.message)!==null&&n!==void 0?n:o)),this.resourceCache={},___app_140.default.write("{}",_$constants_86.HEADERS_RESOURCE_CACHE_KEY)}this._cleanup()}var e,r;return e=t,(r=[{key:"_cleanup",value:function(){var n=this,o=!1;Object.entries(this.resourceCache).forEach(function(f){var d=___slicedToArray_140(f,2),h=d[0],y=d[1];y.time||(delete n.resourceCache[h],___app_140.default.delete("#".concat(h)),o=!0),new Date().getTime()-y.time>n.expires&&(delete n.resourceCache[h],o=!0)}),o&&this._persist()}},{key:"revokeAll",value:function(){this.resourceCache={},this._persist()}},{key:"_persist",value:function(){___app_140.default.write(JSON.stringify(this.resourceCache),_$constants_86.HEADERS_RESOURCE_CACHE_KEY)}},{key:"get",value:function(n){var o=this.resourceCache[n]&&this.resourceCache[n].time;return o&&new Date().getTime()-o<=this.expires?this.resourceCache[n].data:null}},{key:"gettime",value:function(n){var o=this.resourceCache[n]&&this.resourceCache[n].time;return o&&new Date().getTime()-o<=this.expires?this.resourceCache[n].time:null}},{key:"set",value:function(n,o){this.resourceCache[n]={time:new Date().getTime(),data:o},this._persist()}}])&&___defineProperties_140(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}());_$headersResourceCache_140.default=___default_140;var _$flow_137={};Object.defineProperty(_$flow_137,"__esModule",{value:!0}),_$flow_137.flowTransfer=flowTransfer,_$flow_137.getFlowField=getFlowField,_$flow_137.getFlowHeaders=getFlowHeaders,_$flow_137.getRmainingDays=getRmainingDays,_$flow_137.parseFlowHeaders=parseFlowHeaders,_$flow_137.validCheck=validCheck;var ___app_137=_interopRequireDefault(_$app_87),_headersResourceCache=_interopRequireDefault(_$headersResourceCache_140);function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function ___regeneratorRuntime_137(){___regeneratorRuntime_137=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=typeof Symbol=="function"?Symbol:{},o=n.iterator||"@@iterator",f=n.asyncIterator||"@@asyncIterator",d=n.toStringTag||"@@toStringTag";function h(l,s,b){return Object.defineProperty(l,s,{value:b,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,b,$){return s[b]=$}}function y(l,s,b,$){var E=s&&s.prototype instanceof D?s:D,rt=Object.create(E.prototype),_t=new ft($||[]);return rt._invoke=function(xt,St,x){var N="suspendedStart";return function(V,S){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(V==="throw")throw S;return{value:void 0,done:!0}}for(x.method=V,x.arg=S;;){var C=x.delegate;if(C){var T=tt(C,x);if(T){if(T===A)continue;return T}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var M=k(xt,St,x);if(M.type==="normal"){if(N=x.done?"completed":"suspendedYield",M.arg===A)continue;return{value:M.arg,done:x.done}}M.type==="throw"&&(N="completed",x.method="throw",x.arg=M.arg)}}}(l,b,_t),rt}function k(l,s,b){try{return{type:"normal",arg:l.call(s,b)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var A={};function D(){}function q(){}function H(){}var z={};h(z,o,function(){return this});var Z=Object.getPrototypeOf,j=Z&&Z(Z(yt([])));j&&j!==e&&r.call(j,o)&&(z=j);var at=H.prototype=D.prototype=Object.create(z);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(b){return this._invoke(s,b)})})}function ot(l,s){var b;this._invoke=function($,E){function rt(){return new s(function(_t,xt){(function St(x,N,V,S){var C=k(l[x],l,N);if(C.type!=="throw"){var T=C.arg,M=T.value;return M&&___typeof_137(M)=="object"&&r.call(M,"__await")?s.resolve(M.__await).then(function(et){St("next",et,V,S)},function(et){St("throw",et,V,S)}):s.resolve(M).then(function(et){T.value=et,V(T)},function(et){return St("throw",et,V,S)})}S(C.arg)})($,E,_t,xt)})}return b=b?b.then(rt,rt):rt()}}function tt(l,s){var b=l.iterator[s.method];if(b===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,tt(l,s),s.method==="throw"))return A;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var $=k(b,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,A;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,A):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,A)}function gt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function wt(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function ft(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(gt,this),this.reset(!0)}function yt(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var b=-1,$=function E(){for(;++b<l.length;)if(r.call(l,b))return E.value=l[b],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:Ct}}function Ct(){return{value:void 0,done:!0}}return q.prototype=H,h(at,"constructor",H),h(H,"constructor",q),q.displayName=h(H,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===q||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,H):(l.__proto__=H,h(l,d,"GeneratorFunction")),l.prototype=Object.create(at),l},t.awrap=function(l){return{__await:l}},ct(ot.prototype),h(ot.prototype,f,function(){return this}),t.AsyncIterator=ot,t.async=function(l,s,b,$,E){E===void 0&&(E=Promise);var rt=new ot(y(l,s,b,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(_t){return _t.done?_t.value:rt.next()})},ct(at),h(at,d,"Generator"),h(at,o,function(){return this}),h(at,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var b in l)s.push(b);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=yt,ft.prototype={constructor:ft,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(wt),!l)for(var s in this)s.charAt(0)==="t"&&r.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function b(St,x){return rt.type="throw",rt.arg=l,s.next=St,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return b("end");if(E.tryLoc<=this.prev){var _t=r.call(E,"catchLoc"),xt=r.call(E,"finallyLoc");if(_t&&xt){if(this.prev<E.catchLoc)return b(E.catchLoc,!0);if(this.prev<E.finallyLoc)return b(E.finallyLoc)}else if(_t){if(this.prev<E.catchLoc)return b(E.catchLoc,!0)}else{if(!xt)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return b(E.finallyLoc)}}}},abrupt:function(l,s){for(var b=this.tryEntries.length-1;b>=0;--b){var $=this.tryEntries[b];if($.tryLoc<=this.prev&&r.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,A):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),A},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.finallyLoc===l)return this.complete(b.completion,b.afterLoc),wt(b),A}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.tryLoc===l){var $=b.completion;if($.type==="throw"){var E=$.arg;wt(b)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,b){return this.delegate={iterator:yt(l),resultName:s,nextLoc:b},this.method==="next"&&(this.arg=void 0),A}},t}function __ownKeys_137(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function ___objectSpread_137(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_137(Object(r),!0).forEach(function(n){___defineProperty_137(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):__ownKeys_137(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ___defineProperty_137(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _createForOfIteratorHelper(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){r=r.call(t)},n:function(){var y=r.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||r.return==null||r.return()}finally{if(h)throw f}}}}function _unsupportedIterableToArray(t,e){if(t){if(typeof t=="string")return ___arrayLikeToArray_137(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?___arrayLikeToArray_137(t,e):void 0}}function ___arrayLikeToArray_137(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ___typeof_137(t){return(___typeof_137=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function __asyncGeneratorStep_137(t,e,r,n,o,f,d){try{var h=t[f](d),y=h.value}catch(k){return void r(k)}h.done?e(y):Promise.resolve(y).then(n,o)}function ___asyncToGenerator_137(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var f=t.apply(e,r);function d(y){__asyncGeneratorStep_137(f,n,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_137(f,n,o,d,h,"throw",y)}d(void 0)})}}function getFlowField(t){for(var e="",r="",n=0,o=Object.keys(t);n<o.length;n++){var f=o[n],d=f.toLowerCase();d==="subscription-userinfo"?e=t[f]:d==="profile-web-page-url"&&(r=t[f])}return"".concat(e||"").concat(r?"; app_url=".concat(encodeURIComponent(r)):"")}function getFlowHeaders(t,e,r,n,o){return _getFlowHeaders.apply(this,arguments)}function _getFlowHeaders(){return _getFlowHeaders=___asyncToGenerator_137(___regeneratorRuntime_137().mark(function _callee(rawUrl,ua,timeout,customProxy,flowUrl){var _$arguments,_$arguments2,_$arguments3,url,$arguments,rawArgs,_iterator,_step,pair,key,value,_ENV,isStash,isLoon,isShadowRocket,isQX,insecure,_$$read,defaultProxy,defaultFlowUserAgent,defaultTimeout,proxy,userAgent,requestTimeout,id,cached,flowInfo,http,_yield$http$get,body,_yield$http$head,headers,_e$message2,_yield$http$get2,_headers;return ___regeneratorRuntime_137().wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(url=flowUrl||rawUrl||"",$arguments={},rawArgs=url.split("#"),url=url.split("#")[0],rawArgs.length>1)try{$arguments=JSON.parse(decodeURIComponent(rawArgs[1]))}catch{_iterator=_createForOfIteratorHelper(rawArgs[1].split("&"));try{for(_iterator.s();!(_step=_iterator.n()).done;)pair=_step.value,key=pair.split("=")[0],value=pair.split("=")[1],$arguments[key]=value==null||value===""||decodeURIComponent(value)}catch(e){_iterator.e(e)}finally{_iterator.f()}}if((_$arguments=$arguments)===null||_$arguments===void 0||!_$arguments.noFlow){_context.next=7;break}return _context.abrupt("return");case 7:if(_ENV=(0,_$openApi_151.ENV)(),isStash=_ENV.isStash,isLoon=_ENV.isLoon,isShadowRocket=_ENV.isShadowRocket,isQX=_ENV.isQX,insecure=(_$arguments2=$arguments)!==null&&_$arguments2!==void 0&&_$arguments2.insecure?___app_137.default.env.isNode?{strictSSL:!1}:{insecure:!0}:void 0,_$$read=___app_137.default.read(_$constants_86.SETTINGS_KEY),defaultProxy=_$$read.defaultProxy,defaultFlowUserAgent=_$$read.defaultFlowUserAgent,defaultTimeout=_$$read.defaultTimeout,proxy=customProxy||defaultProxy,___app_137.default.env.isNode&&(proxy=proxy||eval("process.env.SUB_STORE_BACKEND_DEFAULT_PROXY")),userAgent=ua||defaultFlowUserAgent||"clash",requestTimeout=timeout||defaultTimeout||8e3,id=(0,_$md5_150.hex_md5)(userAgent+url),cached=_headersResourceCache.default.get(id),(_$arguments3=$arguments)!==null&&_$arguments3!==void 0&&_$arguments3.noCache||!cached){_context.next=21;break}___app_137.default.info("\u4F7F\u7528\u7F13\u5B58\u7684\u6D41\u91CF\u4FE1\u606F: ".concat(url,", ").concat(userAgent)),flowInfo=cached,_context.next=51;break;case 21:if(http=(0,_$openApi_151.HTTP)(),!flowUrl){_context.next=31;break}return ___app_137.default.info("\u4F7F\u7528 GET \u65B9\u6CD5\u4ECE\u54CD\u5E94\u4F53\u83B7\u53D6\u6D41\u91CF\u4FE1\u606F: ".concat(flowUrl,", User-Agent: ").concat(userAgent||"",", Insecure: ").concat(!!insecure,", Proxy: ").concat(proxy)),_context.next=26,http.get(___objectSpread_137(___objectSpread_137(___objectSpread_137(___objectSpread_137(___objectSpread_137({url:flowUrl,headers:{"User-Agent":userAgent},timeout:requestTimeout},proxy?{proxy}:{}),isLoon&&proxy?{node:proxy}:{}),isQX&&proxy?{opts:{policy:proxy}}:{}),proxy?(0,_$utils_141.getPolicyDescriptor)(proxy):{}),insecure||{}));case 26:_yield$http$get=_context.sent,body=_yield$http$get.body,flowInfo=body,_context.next=50;break;case 31:return _context.prev=31,___app_137.default.info("\u4F7F\u7528 HEAD \u65B9\u6CD5\u4ECE\u54CD\u5E94\u5934\u83B7\u53D6\u6D41\u91CF\u4FE1\u606F: ".concat(url,", User-Agent: ").concat(userAgent||"",", Insecure: ").concat(!!insecure,", Proxy: ").concat(proxy)),_context.next=35,http.head(___objectSpread_137(___objectSpread_137(___objectSpread_137(___objectSpread_137(___objectSpread_137({url:url.split(/[\r\n]+/).map(function(t){return t.trim()}).filter(function(t){return t.length})[0],headers:___objectSpread_137(___objectSpread_137({"User-Agent":userAgent},isStash&&proxy?{"X-Stash-Selected-Proxy":encodeURIComponent(proxy)}:{}),isShadowRocket&&proxy?{"X-Surge-Policy":proxy}:{}),timeout:requestTimeout},proxy?{proxy}:{}),isLoon&&proxy?{node:proxy}:{}),isQX&&proxy?{opts:{policy:proxy}}:{}),proxy?(0,_$utils_141.getPolicyDescriptor)(proxy):{}),insecure||{}));case 35:_yield$http$head=_context.sent,headers=_yield$http$head.headers,flowInfo=getFlowField(headers),_context.next=43;break;case 40:_context.prev=40,_context.t0=_context.catch(31),___app_137.default.error("\u4F7F\u7528 HEAD \u65B9\u6CD5\u4ECE\u54CD\u5E94\u5934\u83B7\u53D6\u6D41\u91CF\u4FE1\u606F\u5931\u8D25: ".concat(url,", User-Agent: ").concat(userAgent||"",", Insecure: ").concat(!!insecure,", Proxy: ").concat(proxy,": ").concat((_e$message2=_context.t0.message)!==null&&_e$message2!==void 0?_e$message2:_context.t0));case 43:if(flowInfo){_context.next=50;break}return ___app_137.default.info("\u4F7F\u7528 GET \u65B9\u6CD5\u83B7\u53D6\u6D41\u91CF\u4FE1\u606F: ".concat(url,", User-Agent: ").concat(userAgent||"",", Insecure: ").concat(!!insecure,", Proxy: ").concat(proxy)),_context.next=47,http.get(___objectSpread_137(___objectSpread_137(___objectSpread_137(___objectSpread_137(___objectSpread_137({url:url.split(/[\r\n]+/).map(function(t){return t.trim()}).filter(function(t){return t.length})[0],headers:___objectSpread_137(___objectSpread_137({"User-Agent":userAgent},isStash&&proxy?{"X-Stash-Selected-Proxy":encodeURIComponent(proxy)}:{}),isShadowRocket&&proxy?{"X-Surge-Policy":proxy}:{}),timeout:requestTimeout},proxy?{proxy}:{}),isLoon&&proxy?{node:proxy}:{}),isQX&&proxy?{opts:{policy:proxy}}:{}),proxy?(0,_$utils_141.getPolicyDescriptor)(proxy):{}),insecure||{}));case 47:_yield$http$get2=_context.sent,_headers=_yield$http$get2.headers,flowInfo=getFlowField(_headers);case 50:flowInfo&&_headersResourceCache.default.set(id,flowInfo);case 51:return _context.abrupt("return",flowInfo);case 52:case"end":return _context.stop()}},_callee,null,[[31,40]])})),_getFlowHeaders.apply(this,arguments)}function parseFlowHeaders(t){if(t){var e=t.match(/upload=([-+]?)([0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)/),r=Number(e[1]+e[2]),n=t.match(/download=([-+]?)([0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)/),o=Number(n[1]+n[2]),f=t.match(/total=([-+]?)([0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)/),d=Number(f[1]+f[2]),h=t.match(/expire=([-+]?)([0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)/),y=h?Number(h[1]+h[2]):void 0,k=t.match(/reset_day=([0-9]+)/),A=k?Number(k[1]):void 0,D=t.match(/app_url=(.*?)\s*?(;|$)/),q=D?decodeURIComponent(D[1]):void 0,H=t.match(/plan_name=(.*?)\s*?(;|$)/);return{expires:y,total:d,usage:{upload:r,download:o},remainingDays:A,appUrl:q,planName:H?decodeURIComponent(H[1]):void 0}}}function flowTransfer(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"B",r=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],n=r.indexOf(e);return t<1024||n===r.length-1?{value:t.toFixed(1),unit:e}:flowTransfer(t/1024,r[++n])}function validCheck(t){if(!t)throw new Error("\u6CA1\u6709\u6D41\u91CF\u4FE1\u606F");if(t!=null&&t.expires&&1e3*t.expires<Date.now()){var e=new Date(1e3*t.expires).toLocaleDateString();throw new Error("\u8BA2\u9605\u5DF2\u8FC7\u671F: ".concat(e))}if(t!=null&&t.total){var r,n,o=((r=t.usage)===null||r===void 0?void 0:r.upload)||0,f=((n=t.usage)===null||n===void 0?void 0:n.download)||0;if(t.total-o-f<0){var d=o+f,h=flowTransfer(Math.abs(d));h.value=d<0?"-"+h.value:h.value;var y=flowTransfer(t.total);throw new Error("\u6D41\u91CF\u5DF2\u7528\u5B8C: ".concat(h.value," ").concat(h.unit," / ").concat(y.value," ").concat(y.unit))}}}function getRmainingDays(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};try{var e=t.resetDay,r=t.startDate,n=t.cycleDays;if(["string","number"].includes(___typeof_137(t))&&(e=t),r&&n){if(n=parseInt(n),isNaN(n)||n<=0)throw new Error("\u91CD\u7F6E\u5468\u671F\u5E94\u4E3A\u6B63\u6574\u6570");if(!r||!Date.parse(r))throw new Error("\u5F00\u59CB\u65E5\u671F\u4E0D\u5408\u6CD5");var o=new Date(r),f=new Date;if(o.setHours(0,0,0,0),f.setHours(0,0,0,0),o.getTime()>f.getTime())throw new Error("\u5F00\u59CB\u65E5\u671F\u5E94\u65E9\u4E8E\u73B0\u5728");var d=new Date(r);for(d.setDate(d.getDate()+n);d<f;)d.setDate(d.getDate()+n);d.setHours(0,0,0,0);var h=d.getTime()-f.getTime();return Math.ceil(h/864e5)}if(!e)return;if(e=parseInt(e),isNaN(e)||e<=0||e>31)throw new Error("\u6708\u91CD\u7F6E\u65E5\u5E94\u4E3A 1-31 \u4E4B\u95F4\u7684\u6574\u6570");var y=new Date,k=y.getDate(),A=y.getMonth(),D=y.getFullYear();return(e>k?0:new Date(D,A+1,0).getDate())-k+e}catch(H){var q;___app_137.default.error("getRmainingDays failed: ".concat((q=H.message)!==null&&q!==void 0?q:H))}}var _$download_135={};function ___typeof_135(t){return(___typeof_135=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$download_135,"__esModule",{value:!0}),_$download_135.default=download;var _resourceCache=___interopRequireDefault_135(_$resourceCache_144),___headersResourceCache_135=___interopRequireDefault_135(_$headersResourceCache_140),___app_135=___interopRequireDefault_135(_$app_87);function ___interopRequireDefault_135(t){return t&&t.__esModule?t:{default:t}}function ___regeneratorRuntime_135(){___regeneratorRuntime_135=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=typeof Symbol=="function"?Symbol:{},o=n.iterator||"@@iterator",f=n.asyncIterator||"@@asyncIterator",d=n.toStringTag||"@@toStringTag";function h(l,s,b){return Object.defineProperty(l,s,{value:b,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,b,$){return s[b]=$}}function y(l,s,b,$){var E=s&&s.prototype instanceof D?s:D,rt=Object.create(E.prototype),_t=new ft($||[]);return rt._invoke=function(xt,St,x){var N="suspendedStart";return function(V,S){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(V==="throw")throw S;return{value:void 0,done:!0}}for(x.method=V,x.arg=S;;){var C=x.delegate;if(C){var T=tt(C,x);if(T){if(T===A)continue;return T}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var M=k(xt,St,x);if(M.type==="normal"){if(N=x.done?"completed":"suspendedYield",M.arg===A)continue;return{value:M.arg,done:x.done}}M.type==="throw"&&(N="completed",x.method="throw",x.arg=M.arg)}}}(l,b,_t),rt}function k(l,s,b){try{return{type:"normal",arg:l.call(s,b)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var A={};function D(){}function q(){}function H(){}var z={};h(z,o,function(){return this});var Z=Object.getPrototypeOf,j=Z&&Z(Z(yt([])));j&&j!==e&&r.call(j,o)&&(z=j);var at=H.prototype=D.prototype=Object.create(z);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(b){return this._invoke(s,b)})})}function ot(l,s){var b;this._invoke=function($,E){function rt(){return new s(function(_t,xt){(function St(x,N,V,S){var C=k(l[x],l,N);if(C.type!=="throw"){var T=C.arg,M=T.value;return M&&___typeof_135(M)=="object"&&r.call(M,"__await")?s.resolve(M.__await).then(function(et){St("next",et,V,S)},function(et){St("throw",et,V,S)}):s.resolve(M).then(function(et){T.value=et,V(T)},function(et){return St("throw",et,V,S)})}S(C.arg)})($,E,_t,xt)})}return b=b?b.then(rt,rt):rt()}}function tt(l,s){var b=l.iterator[s.method];if(b===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,tt(l,s),s.method==="throw"))return A;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var $=k(b,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,A;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,A):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,A)}function gt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function wt(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function ft(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(gt,this),this.reset(!0)}function yt(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var b=-1,$=function E(){for(;++b<l.length;)if(r.call(l,b))return E.value=l[b],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:Ct}}function Ct(){return{value:void 0,done:!0}}return q.prototype=H,h(at,"constructor",H),h(H,"constructor",q),q.displayName=h(H,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===q||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,H):(l.__proto__=H,h(l,d,"GeneratorFunction")),l.prototype=Object.create(at),l},t.awrap=function(l){return{__await:l}},ct(ot.prototype),h(ot.prototype,f,function(){return this}),t.AsyncIterator=ot,t.async=function(l,s,b,$,E){E===void 0&&(E=Promise);var rt=new ot(y(l,s,b,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(_t){return _t.done?_t.value:rt.next()})},ct(at),h(at,d,"Generator"),h(at,o,function(){return this}),h(at,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var b in l)s.push(b);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=yt,ft.prototype={constructor:ft,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(wt),!l)for(var s in this)s.charAt(0)==="t"&&r.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function b(St,x){return rt.type="throw",rt.arg=l,s.next=St,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return b("end");if(E.tryLoc<=this.prev){var _t=r.call(E,"catchLoc"),xt=r.call(E,"finallyLoc");if(_t&&xt){if(this.prev<E.catchLoc)return b(E.catchLoc,!0);if(this.prev<E.finallyLoc)return b(E.finallyLoc)}else if(_t){if(this.prev<E.catchLoc)return b(E.catchLoc,!0)}else{if(!xt)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return b(E.finallyLoc)}}}},abrupt:function(l,s){for(var b=this.tryEntries.length-1;b>=0;--b){var $=this.tryEntries[b];if($.tryLoc<=this.prev&&r.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,A):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),A},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.finallyLoc===l)return this.complete(b.completion,b.afterLoc),wt(b),A}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.tryLoc===l){var $=b.completion;if($.type==="throw"){var E=$.arg;wt(b)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,b){return this.delegate={iterator:yt(l),resultName:s,nextLoc:b},this.method==="next"&&(this.arg=void 0),A}},t}function __ownKeys_135(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function ___objectSpread_135(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_135(Object(r),!0).forEach(function(n){___defineProperty_135(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):__ownKeys_135(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ___defineProperty_135(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ___createForOfIteratorHelper_135(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=___unsupportedIterableToArray_135(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){r=r.call(t)},n:function(){var y=r.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||r.return==null||r.return()}finally{if(h)throw f}}}}function ___unsupportedIterableToArray_135(t,e){if(t){if(typeof t=="string")return ___arrayLikeToArray_135(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?___arrayLikeToArray_135(t,e):void 0}}function ___arrayLikeToArray_135(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function __asyncGeneratorStep_135(t,e,r,n,o,f,d){try{var h=t[f](d),y=h.value}catch(k){return void r(k)}h.done?e(y):Promise.resolve(y).then(n,o)}function ___asyncToGenerator_135(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var f=t.apply(e,r);function d(y){__asyncGeneratorStep_135(f,n,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_135(f,n,o,d,h,"throw",y)}d(void 0)})}}var tasks=new Map;function download(){return _download.apply(this,arguments)}function _download(){return _download=___asyncToGenerator_135(___regeneratorRuntime_135().mark(function _callee(){var _$arguments,_$arguments2,_$arguments3,_$arguments6,_$arguments11,rawUrl,ua,timeout,customProxy,skipCustomCache,awaitCustomCache,noCache,$arguments,url,rawArgs,_iterator,_step,pair,key,value,_ENV,isNode,isStash,isLoon,isShadowRocket,isQX,_$$read,defaultProxy,defaultUserAgent,defaultTimeout,defaultCacheThreshold,cacheThreshold,proxy,userAgent,requestTimeout,id,customCacheKey,_$arguments4,customCached,_cached,_e$message,_$arguments5,http,result,cached,_$arguments7,_$arguments8,insecure,_yield$http$get,body,headers,statusCode,flowInfo,shouldCache,size,_$arguments9,_e$message4,_cached2,_e$message3,_$arguments10,_args=arguments;return ___regeneratorRuntime_135().wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(rawUrl=_args.length>0&&_args[0]!==void 0?_args[0]:"",ua=_args.length>1?_args[1]:void 0,timeout=_args.length>2?_args[2]:void 0,customProxy=_args.length>3?_args[3]:void 0,skipCustomCache=_args.length>4?_args[4]:void 0,awaitCustomCache=_args.length>5?_args[5]:void 0,noCache=_args.length>6?_args[6]:void 0,$arguments={},url=rawUrl.replace(/#noFlow$/,""),rawArgs=url.split("#"),url=url.split("#")[0],rawArgs.length>1)try{$arguments=JSON.parse(decodeURIComponent(rawArgs[1]))}catch{_iterator=___createForOfIteratorHelper_135(rawArgs[1].split("&"));try{for(_iterator.s();!(_step=_iterator.n()).done;)pair=_step.value,key=pair.split("=")[0],value=pair.split("=")[1],$arguments[key]=value==null||value===""||decodeURIComponent(value)}catch(e){_iterator.e(e)}finally{_iterator.f()}}if(_ENV=(0,_$openApi_151.ENV)(),isNode=_ENV.isNode,isStash=_ENV.isStash,isLoon=_ENV.isLoon,isShadowRocket=_ENV.isShadowRocket,isQX=_ENV.isQX,_$$read=___app_135.default.read(_$constants_86.SETTINGS_KEY),defaultProxy=_$$read.defaultProxy,defaultUserAgent=_$$read.defaultUserAgent,defaultTimeout=_$$read.defaultTimeout,defaultCacheThreshold=_$$read.cacheThreshold,cacheThreshold=defaultCacheThreshold||1024,proxy=customProxy||defaultProxy,___app_135.default.env.isNode&&(proxy=proxy||eval("process.env.SUB_STORE_BACKEND_DEFAULT_PROXY")),userAgent=ua||defaultUserAgent||"clash.meta",requestTimeout=timeout||defaultTimeout||8e3,id=(0,_$md5_150.hex_md5)(userAgent+url),((_$arguments=$arguments)===null||_$arguments===void 0?void 0:_$arguments.cacheKey)===!0&&(___app_135.default.error("\u4F7F\u7528\u81EA\u5B9A\u4E49\u7F13\u5B58\u65F6 cacheKey \u7684\u503C\u4E0D\u80FD\u4E3A\u7A7A"),$arguments.cacheKey=void 0),customCacheKey=(_$arguments2=$arguments)!==null&&_$arguments2!==void 0&&_$arguments2.cacheKey?"#sub-store-cached-custom-".concat((_$arguments3=$arguments)===null||_$arguments3===void 0?void 0:_$arguments3.cacheKey):void 0,!customCacheKey||skipCustomCache){_context.next=46;break}if(customCached=___app_135.default.read(customCacheKey),_cached=_resourceCache.default.get(id),noCache||(_$arguments4=$arguments)!==null&&_$arguments4!==void 0&&_$arguments4.noCache||!_cached){_context.next=28;break}return ___app_135.default.info("\u4E50\u89C2\u7F13\u5B58: URL ".concat(url,`
\u5B58\u5728\u6709\u6548\u7684\u5E38\u89C4\u7F13\u5B58
\u4F7F\u7528\u5E38\u89C4\u7F13\u5B58\u4EE5\u907F\u514D\u91CD\u590D\u8BF7\u6C42`)),_context.abrupt("return",_cached);case 28:if(!customCached){_context.next=46;break}if(!awaitCustomCache){_context.next=43;break}return ___app_135.default.info("\u4E50\u89C2\u7F13\u5B58: URL ".concat(url,`
\u672C\u6B21\u8FDB\u884C\u8BF7\u6C42 \u5C1D\u8BD5\u66F4\u65B0\u7F13\u5B58`)),_context.prev=31,_context.next=34,download(rawUrl.replace(/(\?|&)cacheKey=.*?(&|$)/,""),ua,timeout,proxy,!0);case 34:_context.next=41;break;case 36:_context.prev=36,_context.t0=_context.catch(31),___app_135.default.error("\u4E50\u89C2\u7F13\u5B58: URL ".concat(url," \u66F4\u65B0\u7F13\u5B58\u53D1\u751F\u9519\u8BEF ").concat((_e$message=_context.t0.message)!==null&&_e$message!==void 0?_e$message:_context.t0)),___app_135.default.info("\u4F7F\u7528\u4E50\u89C2\u7F13\u5B58\u7684\u6570\u636E\u5237\u65B0\u7F13\u5B58, \u9632\u6B62\u540E\u7EED\u8BF7\u6C42"),_resourceCache.default.set(id,customCached);case 41:_context.next=45;break;case 43:___app_135.default.info("\u4E50\u89C2\u7F13\u5B58: URL ".concat(url,`
\u672C\u6B21\u8FD4\u56DE\u81EA\u5B9A\u4E49\u7F13\u5B58 `).concat((_$arguments5=$arguments)===null||_$arguments5===void 0?void 0:_$arguments5.cacheKey,`
\u5E76\u8FDB\u884C\u8BF7\u6C42 \u5C1D\u8BD5\u5F02\u6B65\u66F4\u65B0\u7F13\u5B58`)),download(rawUrl.replace(/(\?|&)cacheKey=.*?(&|$)/,""),ua,timeout,proxy,!0).catch(function(t){var e;___app_135.default.error("\u4E50\u89C2\u7F13\u5B58: URL ".concat(url," \u5F02\u6B65\u66F4\u65B0\u7F13\u5B58\u53D1\u751F\u9519\u8BEF ").concat((e=t.message)!==null&&e!==void 0?e:t))});case 45:return _context.abrupt("return",customCached);case 46:if(isNode||!tasks.has(id)){_context.next=48;break}return _context.abrupt("return",tasks.get(id));case 48:if(http=(0,_$openApi_151.HTTP)({headers:___objectSpread_135(___objectSpread_135({"User-Agent":userAgent},isStash&&proxy?{"X-Stash-Selected-Proxy":encodeURIComponent(proxy)}:{}),isShadowRocket&&proxy?{"X-Surge-Policy":proxy}:{}),timeout:requestTimeout}),cached=_resourceCache.default.get(id),noCache||(_$arguments6=$arguments)!==null&&_$arguments6!==void 0&&_$arguments6.noCache||!cached){_context.next=56;break}___app_135.default.info("\u4F7F\u7528\u7F13\u5B58: ".concat(url,", ").concat(userAgent)),result=cached,customCacheKey&&(___app_135.default.info("URL ".concat(url,`
\u5199\u5165\u81EA\u5B9A\u4E49\u7F13\u5B58 `).concat((_$arguments7=$arguments)===null||_$arguments7===void 0?void 0:_$arguments7.cacheKey)),___app_135.default.write(cached,customCacheKey)),_context.next=85;break;case 56:return insecure=(_$arguments8=$arguments)!==null&&_$arguments8!==void 0&&_$arguments8.insecure?isNode?{strictSSL:!1}:{insecure:!0}:void 0,___app_135.default.info(`Downloading...
User-Agent: `.concat(userAgent,`
Timeout: `).concat(requestTimeout,`
Proxy: `).concat(proxy,`
Insecure: `).concat(!!insecure,`
URL: `).concat(url)),_context.prev=58,_context.next=61,http.get(___objectSpread_135(___objectSpread_135(___objectSpread_135(___objectSpread_135(___objectSpread_135({url},proxy?{proxy}:{}),isLoon&&proxy?{node:proxy}:{}),isQX&&proxy?{opts:{policy:proxy}}:{}),proxy?(0,_$utils_141.getPolicyDescriptor)(proxy):{}),insecure||{}));case 61:if(_yield$http$get=_context.sent,body=_yield$http$get.body,headers=_yield$http$get.headers,statusCode=_yield$http$get.statusCode,___app_135.default.info("statusCode: ".concat(statusCode)),!(statusCode<200||statusCode>=400)){_context.next=68;break}throw new Error("statusCode: ".concat(statusCode));case 68:if(headers&&(flowInfo=(0,_$flow_137.getFlowField)(headers),flowInfo&&___headersResourceCache_135.default.set(id,flowInfo)),body.replace(/\s/g,"").length!==0){_context.next=71;break}throw new Error(new Error("\u8FDC\u7A0B\u8D44\u6E90\u5185\u5BB9\u4E3A\u7A7A"));case 71:shouldCache=!0,cacheThreshold&&(size=body.length/1024,size>cacheThreshold&&(___app_135.default.info("\u8D44\u6E90\u5927\u5C0F ".concat(size.toFixed(2)," KB \u8D85\u8FC7\u4E86 ").concat(cacheThreshold," KB, \u4E0D\u7F13\u5B58")),shouldCache=!1)),shouldCache&&(_resourceCache.default.set(id,body),customCacheKey&&(___app_135.default.info("URL ".concat(url,`
\u5199\u5165\u81EA\u5B9A\u4E49\u7F13\u5B58 `).concat((_$arguments9=$arguments)===null||_$arguments9===void 0?void 0:_$arguments9.cacheKey)),___app_135.default.write(body,customCacheKey))),result=body,_context.next=85;break;case 77:if(_context.prev=77,_context.t1=_context.catch(58),!customCacheKey){_context.next=84;break}if(_cached2=___app_135.default.read(customCacheKey),!_cached2){_context.next=84;break}return ___app_135.default.info("\u65E0\u6CD5\u4E0B\u8F7D URL ".concat(url,": ").concat((_e$message3=_context.t1.message)!==null&&_e$message3!==void 0?_e$message3:_context.t1,`
\u4F7F\u7528\u81EA\u5B9A\u4E49\u7F13\u5B58 `).concat((_$arguments10=$arguments)===null||_$arguments10===void 0?void 0:_$arguments10.cacheKey)),_context.abrupt("return",_cached2);case 84:throw new Error("\u65E0\u6CD5\u4E0B\u8F7D URL ".concat(url,": ").concat((_e$message4=_context.t1.message)!==null&&_e$message4!==void 0?_e$message4:_context.t1));case 85:if((_$arguments11=$arguments)===null||_$arguments11===void 0||!_$arguments11.validCheck){_context.next=94;break}return _context.t2=_$flow_137.validCheck,_context.t3=_$flow_137.parseFlowHeaders,_context.next=90,(0,_$flow_137.getFlowHeaders)(url,$arguments.flowUserAgent,void 0,proxy,$arguments.flowUrl);case 90:return _context.t4=_context.sent,_context.t5=(0,_context.t3)(_context.t4),_context.next=94,(0,_context.t2)(_context.t5);case 94:return isNode||tasks.set(id,result),_context.abrupt("return",result);case 96:case"end":return _context.stop()}},_callee,null,[[31,36],[58,77]])})),_download.apply(this,arguments)}var _$response_127={};Object.defineProperty(_$response_127,"__esModule",{value:!0}),_$response_127.failed=function(t,e,r){t.status(r||500).json({status:"failed",error:{code:e.code,type:e.type,message:e.message,details:e.details}})},_$response_127.success=function(t,e,r){t.status(r||200).json({status:"success",data:e})};var _$errors_119={};function ___typeof_119(t){return(___typeof_119=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function _inherits(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r})(t,e)}function _createSuper(t){var e=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(f,d){if(d&&(___typeof_119(d)==="object"||typeof d=="function"))return d;if(d!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(h){if(h===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h}(f)}(this,r)}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(t)}function ___defineProperties_119(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ___createClass_119(t,e,r){return e&&___defineProperties_119(t.prototype,e),r&&___defineProperties_119(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ___classCallCheck_119(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(_$errors_119,"__esModule",{value:!0}),_$errors_119.ResourceNotFoundError=_$errors_119.RequestInvalidError=_$errors_119.NetworkError=_$errors_119.InternalServerError=void 0;var BaseError=___createClass_119(function t(e,r,n){___classCallCheck_119(this,t),this.code=e,this.message=r,this.details=n}),InternalServerError=function(t){_inherits(r,BaseError);var e=_createSuper(r);function r(n,o,f){var d;return ___classCallCheck_119(this,r),(d=e.call(this,n,o,f)).type="InternalServerError",d}return ___createClass_119(r)}();_$errors_119.InternalServerError=InternalServerError;var RequestInvalidError=function(t){_inherits(r,BaseError);var e=_createSuper(r);function r(n,o,f){var d;return ___classCallCheck_119(this,r),(d=e.call(this,n,o,f)).type="RequestInvalidError",d}return ___createClass_119(r)}();_$errors_119.RequestInvalidError=RequestInvalidError;var ResourceNotFoundError=function(t){_inherits(r,BaseError);var e=_createSuper(r);function r(n,o,f){var d;return ___classCallCheck_119(this,r),(d=e.call(this,n,o,f)).type="ResourceNotFoundError",d}return ___createClass_119(r)}();_$errors_119.ResourceNotFoundError=ResourceNotFoundError;var NetworkError=function(t){_inherits(r,BaseError);var e=_createSuper(r);function r(n,o,f){var d;return ___classCallCheck_119(this,r),(d=e.call(this,n,o,f)).type="NetworkError",d}return ___createClass_119(r)}();_$errors_119.NetworkError=NetworkError;var _$database_133={};function findIndexByName(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"name";return t.findIndex(function(n){return n[r]===e})}Object.defineProperty(_$database_133,"__esModule",{value:!0}),_$database_133.deleteByName=function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"name",n=findIndexByName(t,e,r);t.splice(n,1)},_$database_133.findByName=function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"name";return t.find(function(n){return n[r]===e})},_$database_133.findIndexByName=findIndexByName,_$database_133.updateByName=function(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"name",o=findIndexByName(t,e,n);t[o]=r};for(var _$base64Js_2={byteLength:function(t){var e=getLens(t),r=e[0],n=e[1];return 3*(r+n)/4-n},toByteArray:function(t){var e,r,n=getLens(t),o=n[0],f=n[1],d=new Arr(function(k,A,D){return 3*(A+D)/4-D}(0,o,f)),h=0,y=f>0?o-4:o;for(r=0;r<y;r+=4)e=revLookup[t.charCodeAt(r)]<<18|revLookup[t.charCodeAt(r+1)]<<12|revLookup[t.charCodeAt(r+2)]<<6|revLookup[t.charCodeAt(r+3)],d[h++]=e>>16&255,d[h++]=e>>8&255,d[h++]=255&e;return f===2&&(e=revLookup[t.charCodeAt(r)]<<2|revLookup[t.charCodeAt(r+1)]>>4,d[h++]=255&e),f===1&&(e=revLookup[t.charCodeAt(r)]<<10|revLookup[t.charCodeAt(r+1)]<<4|revLookup[t.charCodeAt(r+2)]>>2,d[h++]=e>>8&255,d[h++]=255&e),d},fromByteArray:function(t){for(var e,r=t.length,n=r%3,o=[],f=0,d=r-n;f<d;f+=16383)o.push(encodeChunk(t,f,f+16383>d?d:f+16383));return n===1?(e=t[r-1],o.push(lookup[e>>2]+lookup[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],o.push(lookup[e>>10]+lookup[e>>4&63]+lookup[e<<2&63]+"=")),o.join("")}},lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;function getLens(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return r===-1&&(r=e),[r,r===e?0:4-r%4]}function encodeChunk(t,e,r){for(var n,o,f=[],d=e;d<r;d+=3)n=(t[d]<<16&16711680)+(t[d+1]<<8&65280)+(255&t[d+2]),f.push(lookup[(o=n)>>18&63]+lookup[o>>12&63]+lookup[o>>6&63]+lookup[63&o]);return f.join("")}revLookup[45]=62,revLookup[95]=63;var _$ieee754_10={read:function(t,e,r,n,o){var f,d,h=8*o-n-1,y=(1<<h)-1,k=y>>1,A=-7,D=r?o-1:0,q=r?-1:1,H=t[e+D];for(D+=q,f=H&(1<<-A)-1,H>>=-A,A+=h;A>0;f=256*f+t[e+D],D+=q,A-=8);for(d=f&(1<<-A)-1,f>>=-A,A+=n;A>0;d=256*d+t[e+D],D+=q,A-=8);if(f===0)f=1-k;else{if(f===y)return d?NaN:1/0*(H?-1:1);d+=Math.pow(2,n),f-=k}return(H?-1:1)*d*Math.pow(2,f-n)},write:function(t,e,r,n,o,f){var d,h,y,k=8*f-o-1,A=(1<<k)-1,D=A>>1,q=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,H=n?0:f-1,z=n?1:-1,Z=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(h=isNaN(e)?1:0,d=A):(d=Math.floor(Math.log(e)/Math.LN2),e*(y=Math.pow(2,-d))<1&&(d--,y*=2),(e+=d+D>=1?q/y:q*Math.pow(2,1-D))*y>=2&&(d++,y/=2),d+D>=A?(h=0,d=A):d+D>=1?(h=(e*y-1)*Math.pow(2,o),d+=D):(h=e*Math.pow(2,D-1)*Math.pow(2,o),d=0));o>=8;t[r+H]=255&h,H+=z,h/=256,o-=8);for(d=d<<o|h,k+=o;k>0;t[r+H]=255&d,H+=z,d/=256,k-=8);t[r+H-z]|=128*Z}},_$jsrsasign_52={};(function(t){(function(){var e,r,n,o,f,d,h,y,k,A,D,q={userAgent:!1},H={},z=z||(e=Math,n=(r={}).lib={},o=n.Base=function(){function a(){}return{extend:function(u){a.prototype=this;var p=new a;return u&&p.mixIn(u),p.hasOwnProperty("init")||(p.init=function(){p.$super.init.apply(this,arguments)}),p.init.prototype=p,p.$super=this,p},create:function(){var u=this.extend();return u.init.apply(u,arguments),u},init:function(){},mixIn:function(u){for(var p in u)u.hasOwnProperty(p)&&(this[p]=u[p]);u.hasOwnProperty("toString")&&(this.toString=u.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=n.WordArray=o.extend({init:function(a,u){a=this.words=a||[],this.sigBytes=u??4*a.length},toString:function(a){return(a||h).stringify(this)},concat:function(a){var u=this.words,p=a.words,g=this.sigBytes,m=a.sigBytes;if(this.clamp(),g%4)for(var w=0;w<m;w++){var F=p[w>>>2]>>>24-w%4*8&255;u[g+w>>>2]|=F<<24-(g+w)%4*8}else for(w=0;w<m;w+=4)u[g+w>>>2]=p[w>>>2];return this.sigBytes+=m,this},clamp:function(){var a=this.words,u=this.sigBytes;a[u>>>2]&=4294967295<<32-u%4*8,a.length=e.ceil(u/4)},clone:function(){var a=o.clone.call(this);return a.words=this.words.slice(0),a},random:function(a){for(var u=[],p=0;p<a;p+=4)u.push(4294967296*e.random()|0);return new f.init(u,a)}}),d=r.enc={},h=d.Hex={stringify:function(a){for(var u=a.words,p=a.sigBytes,g=[],m=0;m<p;m++){var w=u[m>>>2]>>>24-m%4*8&255;g.push((w>>>4).toString(16)),g.push((15&w).toString(16))}return g.join("")},parse:function(a){for(var u=a.length,p=[],g=0;g<u;g+=2)p[g>>>3]|=parseInt(a.substr(g,2),16)<<24-g%8*4;return new f.init(p,u/2)}},y=d.Latin1={stringify:function(a){for(var u=a.words,p=a.sigBytes,g=[],m=0;m<p;m++){var w=u[m>>>2]>>>24-m%4*8&255;g.push(String.fromCharCode(w))}return g.join("")},parse:function(a){for(var u=a.length,p=[],g=0;g<u;g++)p[g>>>2]|=(255&a.charCodeAt(g))<<24-g%4*8;return new f.init(p,u)}},k=d.Utf8={stringify:function(a){try{return decodeURIComponent(escape(y.stringify(a)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(a){return y.parse(unescape(encodeURIComponent(a)))}},A=n.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(a){typeof a=="string"&&(a=k.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(a){var u=this._data,p=u.words,g=u.sigBytes,m=this.blockSize,w=g/(4*m),F=(w=a?e.ceil(w):e.max((0|w)-this._minBufferSize,0))*m,R=e.min(4*F,g);if(F){for(var P=0;P<F;P+=m)this._doProcessBlock(p,P);var B=p.splice(0,F);u.sigBytes-=R}return new f.init(B,R)},clone:function(){var a=o.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0}),n.Hasher=A.extend({cfg:o.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){A.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(u,p){return new a.init(p).finalize(u)}},_createHmacHelper:function(a){return function(u,p){return new D.HMAC.init(a,p).finalize(u)}}}),D=r.algo={},r);(function(a){var u,p=(u=z).lib,g=p.Base,m=p.WordArray;(u=u.x64={}).Word=g.extend({init:function(w,F){this.high=w,this.low=F}}),u.WordArray=g.extend({init:function(w,F){w=this.words=w||[],this.sigBytes=F??8*w.length},toX32:function(){for(var w=this.words,F=w.length,R=[],P=0;P<F;P++){var B=w[P];R.push(B.high),R.push(B.low)}return m.create(R,this.sigBytes)},clone:function(){for(var w=g.clone.call(this),F=w.words=this.words.slice(0),R=F.length,P=0;P<R;P++)F[P]=F[P].clone();return w}})})(),z.lib.Cipher||function(a){var u=(U=z).lib,p=u.Base,g=u.WordArray,m=u.BufferedBlockAlgorithm,w=U.enc.Base64,F=U.algo.EvpKDF,R=u.Cipher=m.extend({cfg:p.extend(),createEncryptor:function(Y,st){return this.create(this._ENC_XFORM_MODE,Y,st)},createDecryptor:function(Y,st){return this.create(this._DEC_XFORM_MODE,Y,st)},init:function(Y,st,vt){this.cfg=this.cfg.extend(vt),this._xformMode=Y,this._key=st,this.reset()},reset:function(){m.reset.call(this),this._doReset()},process:function(Y){return this._append(Y),this._process()},finalize:function(Y){return Y&&this._append(Y),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(Y){return{encrypt:function(st,vt,At){return(typeof vt=="string"?W:O).encrypt(Y,st,vt,At)},decrypt:function(st,vt,At){return(typeof vt=="string"?W:O).decrypt(Y,st,vt,At)}}}});u.StreamCipher=R.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var P=U.mode={},B=function(Y,st,vt){var At=this._iv;At?this._iv=void 0:At=this._prevBlock;for(var Mt=0;Mt<vt;Mt++)Y[st+Mt]^=At[Mt]},K=(u.BlockCipherMode=p.extend({createEncryptor:function(Y,st){return this.Encryptor.create(Y,st)},createDecryptor:function(Y,st){return this.Decryptor.create(Y,st)},init:function(Y,st){this._cipher=Y,this._iv=st}})).extend();K.Encryptor=K.extend({processBlock:function(Y,st){var vt=this._cipher,At=vt.blockSize;B.call(this,Y,st,At),vt.encryptBlock(Y,st),this._prevBlock=Y.slice(st,st+At)}}),K.Decryptor=K.extend({processBlock:function(Y,st){var vt=this._cipher,At=vt.blockSize,Mt=Y.slice(st,st+At);vt.decryptBlock(Y,st),B.call(this,Y,st,At),this._prevBlock=Mt}}),P=P.CBC=K,K=(U.pad={}).Pkcs7={pad:function(Y,st){for(var vt,At=(vt=(vt=4*st)-Y.sigBytes%vt)<<24|vt<<16|vt<<8|vt,Mt=[],Bt=0;Bt<vt;Bt+=4)Mt.push(At);vt=g.create(Mt,vt),Y.concat(vt)},unpad:function(Y){Y.sigBytes-=255&Y.words[Y.sigBytes-1>>>2]}},u.BlockCipher=R.extend({cfg:R.cfg.extend({mode:P,padding:K}),reset:function(){R.reset.call(this);var Y=(st=this.cfg).iv,st=st.mode;if(this._xformMode==this._ENC_XFORM_MODE)var vt=st.createEncryptor;else vt=st.createDecryptor,this._minBufferSize=1;this._mode=vt.call(st,this,Y&&Y.words)},_doProcessBlock:function(Y,st){this._mode.processBlock(Y,st)},_doFinalize:function(){var Y=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){Y.pad(this._data,this.blockSize);var st=this._process(!0)}else st=this._process(!0),Y.unpad(st);return st},blockSize:4});var L=u.CipherParams=p.extend({init:function(Y){this.mixIn(Y)},toString:function(Y){return(Y||this.formatter).stringify(this)}}),O=(P=(U.format={}).OpenSSL={stringify:function(Y){var st=Y.ciphertext;return((Y=Y.salt)?g.create([1398893684,1701076831]).concat(Y).concat(st):st).toString(w)},parse:function(Y){var st=(Y=w.parse(Y)).words;if(st[0]==1398893684&&st[1]==1701076831){var vt=g.create(st.slice(2,4));st.splice(0,4),Y.sigBytes-=16}return L.create({ciphertext:Y,salt:vt})}},u.SerializableCipher=p.extend({cfg:p.extend({format:P}),encrypt:function(Y,st,vt,At){At=this.cfg.extend(At);var Mt=Y.createEncryptor(vt,At);return st=Mt.finalize(st),Mt=Mt.cfg,L.create({ciphertext:st,key:vt,iv:Mt.iv,algorithm:Y,mode:Mt.mode,padding:Mt.padding,blockSize:Y.blockSize,formatter:At.format})},decrypt:function(Y,st,vt,At){return At=this.cfg.extend(At),st=this._parse(st,At.format),Y.createDecryptor(vt,At).finalize(st.ciphertext)},_parse:function(Y,st){return typeof Y=="string"?st.parse(Y,this):Y}})),U=(U.kdf={}).OpenSSL={execute:function(Y,st,vt,At){return At||(At=g.random(8)),Y=F.create({keySize:st+vt}).compute(Y,At),vt=g.create(Y.words.slice(st),4*vt),Y.sigBytes=4*st,L.create({key:Y,iv:vt,salt:At})}},W=u.PasswordBasedCipher=O.extend({cfg:O.cfg.extend({kdf:U}),encrypt:function(Y,st,vt,At){return vt=(At=this.cfg.extend(At)).kdf.execute(vt,Y.keySize,Y.ivSize),At.iv=vt.iv,(Y=O.encrypt.call(this,Y,st,vt.key,At)).mixIn(vt),Y},decrypt:function(Y,st,vt,At){return At=this.cfg.extend(At),st=this._parse(st,At.format),vt=At.kdf.execute(vt,Y.keySize,Y.ivSize,st.salt),At.iv=vt.iv,O.decrypt.call(this,Y,st,vt.key,At)}})}(),function(){for(var a=z,u=a.lib.BlockCipher,p=a.algo,g=[],m=[],w=[],F=[],R=[],P=[],B=[],K=[],L=[],O=[],U=[],W=0;256>W;W++)U[W]=128>W?W<<1:W<<1^283;var Y=0,st=0;for(W=0;256>W;W++){var vt=(vt=st^st<<1^st<<2^st<<3^st<<4)>>>8^255&vt^99;g[Y]=vt,m[vt]=Y;var At=U[Y],Mt=U[At],Bt=U[Mt],Q=257*U[vt]^16843008*vt;w[Y]=Q<<24|Q>>>8,F[Y]=Q<<16|Q>>>16,R[Y]=Q<<8|Q>>>24,P[Y]=Q,Q=16843009*Bt^65537*Mt^257*At^16843008*Y,B[vt]=Q<<24|Q>>>8,K[vt]=Q<<16|Q>>>16,L[vt]=Q<<8|Q>>>24,O[vt]=Q,Y?(Y=At^U[U[U[Bt^At]]],st^=U[U[st]]):Y=st=1}var ut=[0,1,2,4,8,16,32,64,128,27,54];p=p.AES=u.extend({_doReset:function(){for(var pt=(bt=this._key).words,it=bt.sigBytes/4,bt=4*((this._nRounds=it+6)+1),$t=this._keySchedule=[],Wt=0;Wt<bt;Wt++)if(Wt<it)$t[Wt]=pt[Wt];else{var Ht=$t[Wt-1];Wt%it?6<it&&Wt%it==4&&(Ht=g[Ht>>>24]<<24|g[Ht>>>16&255]<<16|g[Ht>>>8&255]<<8|g[255&Ht]):(Ht=g[(Ht=Ht<<8|Ht>>>24)>>>24]<<24|g[Ht>>>16&255]<<16|g[Ht>>>8&255]<<8|g[255&Ht],Ht^=ut[Wt/it|0]<<24),$t[Wt]=$t[Wt-it]^Ht}for(pt=this._invKeySchedule=[],it=0;it<bt;it++)Wt=bt-it,Ht=it%4?$t[Wt]:$t[Wt-4],pt[it]=4>it||4>=Wt?Ht:B[g[Ht>>>24]]^K[g[Ht>>>16&255]]^L[g[Ht>>>8&255]]^O[g[255&Ht]]},encryptBlock:function(pt,it){this._doCryptBlock(pt,it,this._keySchedule,w,F,R,P,g)},decryptBlock:function(pt,it){var bt=pt[it+1];pt[it+1]=pt[it+3],pt[it+3]=bt,this._doCryptBlock(pt,it,this._invKeySchedule,B,K,L,O,m),bt=pt[it+1],pt[it+1]=pt[it+3],pt[it+3]=bt},_doCryptBlock:function(pt,it,bt,$t,Wt,Ht,Se,zt){for(var X=this._nRounds,dt=pt[it]^bt[0],mt=pt[it+1]^bt[1],Rt=pt[it+2]^bt[2],Ft=pt[it+3]^bt[3],jt=4,re=1;re<X;re++){var te=$t[dt>>>24]^Wt[mt>>>16&255]^Ht[Rt>>>8&255]^Se[255&Ft]^bt[jt++],Et=$t[mt>>>24]^Wt[Rt>>>16&255]^Ht[Ft>>>8&255]^Se[255&dt]^bt[jt++],kt=$t[Rt>>>24]^Wt[Ft>>>16&255]^Ht[dt>>>8&255]^Se[255&mt]^bt[jt++];Ft=$t[Ft>>>24]^Wt[dt>>>16&255]^Ht[mt>>>8&255]^Se[255&Rt]^bt[jt++],dt=te,mt=Et,Rt=kt}te=(zt[dt>>>24]<<24|zt[mt>>>16&255]<<16|zt[Rt>>>8&255]<<8|zt[255&Ft])^bt[jt++],Et=(zt[mt>>>24]<<24|zt[Rt>>>16&255]<<16|zt[Ft>>>8&255]<<8|zt[255&dt])^bt[jt++],kt=(zt[Rt>>>24]<<24|zt[Ft>>>16&255]<<16|zt[dt>>>8&255]<<8|zt[255&mt])^bt[jt++],Ft=(zt[Ft>>>24]<<24|zt[dt>>>16&255]<<16|zt[mt>>>8&255]<<8|zt[255&Rt])^bt[jt++],pt[it]=te,pt[it+1]=Et,pt[it+2]=kt,pt[it+3]=Ft},keySize:8}),a.AES=u._createHelper(p)}(),function(){function a(O,U){var W=(this._lBlock>>>O^this._rBlock)&U;this._rBlock^=W,this._lBlock^=W<<O}function u(O,U){var W=(this._rBlock>>>O^this._lBlock)&U;this._lBlock^=W,this._rBlock^=W<<O}var p=z,g=(m=p.lib).WordArray,m=m.BlockCipher,w=p.algo,F=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],R=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],P=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],B=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],K=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],L=w.DES=m.extend({_doReset:function(){for(var O=this._key.words,U=[],W=0;56>W;W++){var Y=F[W]-1;U[W]=O[Y>>>5]>>>31-Y%32&1}for(O=this._subKeys=[],Y=0;16>Y;Y++){var st=O[Y]=[],vt=P[Y];for(W=0;24>W;W++)st[W/6|0]|=U[(R[W]-1+vt)%28]<<31-W%6,st[4+(W/6|0)]|=U[28+(R[W+24]-1+vt)%28]<<31-W%6;for(st[0]=st[0]<<1|st[0]>>>31,W=1;7>W;W++)st[W]>>>=4*(W-1)+3;st[7]=st[7]<<5|st[7]>>>27}for(U=this._invSubKeys=[],W=0;16>W;W++)U[W]=O[15-W]},encryptBlock:function(O,U){this._doCryptBlock(O,U,this._subKeys)},decryptBlock:function(O,U){this._doCryptBlock(O,U,this._invSubKeys)},_doCryptBlock:function(O,U,W){this._lBlock=O[U],this._rBlock=O[U+1],a.call(this,4,252645135),a.call(this,16,65535),u.call(this,2,858993459),u.call(this,8,16711935),a.call(this,1,1431655765);for(var Y=0;16>Y;Y++){for(var st=W[Y],vt=this._lBlock,At=this._rBlock,Mt=0,Bt=0;8>Bt;Bt++)Mt|=B[Bt][((At^st[Bt])&K[Bt])>>>0];this._lBlock=At,this._rBlock=vt^Mt}W=this._lBlock,this._lBlock=this._rBlock,this._rBlock=W,a.call(this,1,1431655765),u.call(this,8,16711935),u.call(this,2,858993459),a.call(this,16,65535),a.call(this,4,252645135),O[U]=this._lBlock,O[U+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});p.DES=m._createHelper(L),w=w.TripleDES=m.extend({_doReset:function(){var O=this._key.words;this._des1=L.createEncryptor(g.create(O.slice(0,2))),this._des2=L.createEncryptor(g.create(O.slice(2,4))),this._des3=L.createEncryptor(g.create(O.slice(4,6)))},encryptBlock:function(O,U){this._des1.encryptBlock(O,U),this._des2.decryptBlock(O,U),this._des3.encryptBlock(O,U)},decryptBlock:function(O,U){this._des3.decryptBlock(O,U),this._des2.encryptBlock(O,U),this._des1.decryptBlock(O,U)},keySize:6,ivSize:2,blockSize:2}),p.TripleDES=m._createHelper(w)}(),function(){var a=z,u=a.lib.WordArray;a.enc.Base64={stringify:function(p){var g=p.words,m=p.sigBytes,w=this._map;p.clamp(),p=[];for(var F=0;F<m;F+=3)for(var R=(g[F>>>2]>>>24-F%4*8&255)<<16|(g[F+1>>>2]>>>24-(F+1)%4*8&255)<<8|g[F+2>>>2]>>>24-(F+2)%4*8&255,P=0;4>P&&F+.75*P<m;P++)p.push(w.charAt(R>>>6*(3-P)&63));if(g=w.charAt(64))for(;p.length%4;)p.push(g);return p.join("")},parse:function(p){var g=p.length,m=this._map;(w=m.charAt(64))&&(w=p.indexOf(w))!=-1&&(g=w);for(var w=[],F=0,R=0;R<g;R++)if(R%4){var P=m.indexOf(p.charAt(R-1))<<R%4*2,B=m.indexOf(p.charAt(R))>>>6-R%4*2;w[F>>>2]|=(P|B)<<24-F%4*8,F++}return u.create(w,F)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(a){function u(L,O,U,W,Y,st,vt){return((L=L+(O&U|~O&W)+Y+vt)<<st|L>>>32-st)+O}function p(L,O,U,W,Y,st,vt){return((L=L+(O&W|U&~W)+Y+vt)<<st|L>>>32-st)+O}function g(L,O,U,W,Y,st,vt){return((L=L+(O^U^W)+Y+vt)<<st|L>>>32-st)+O}function m(L,O,U,W,Y,st,vt){return((L=L+(U^(O|~W))+Y+vt)<<st|L>>>32-st)+O}for(var w=z,F=(P=w.lib).WordArray,R=P.Hasher,P=w.algo,B=[],K=0;64>K;K++)B[K]=4294967296*a.abs(a.sin(K+1))|0;P=P.MD5=R.extend({_doReset:function(){this._hash=new F.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(L,O){for(var U=0;16>U;U++){var W=L[Y=O+U];L[Y]=16711935&(W<<8|W>>>24)|4278255360&(W<<24|W>>>8)}U=this._hash.words;var Y=L[O+0],st=(W=L[O+1],L[O+2]),vt=L[O+3],At=L[O+4],Mt=L[O+5],Bt=L[O+6],Q=L[O+7],ut=L[O+8],pt=L[O+9],it=L[O+10],bt=L[O+11],$t=L[O+12],Wt=L[O+13],Ht=L[O+14],Se=L[O+15],zt=u(zt=U[0],mt=U[1],dt=U[2],X=U[3],Y,7,B[0]),X=u(X,zt,mt,dt,W,12,B[1]),dt=u(dt,X,zt,mt,st,17,B[2]),mt=u(mt,dt,X,zt,vt,22,B[3]);zt=u(zt,mt,dt,X,At,7,B[4]),X=u(X,zt,mt,dt,Mt,12,B[5]),dt=u(dt,X,zt,mt,Bt,17,B[6]),mt=u(mt,dt,X,zt,Q,22,B[7]),zt=u(zt,mt,dt,X,ut,7,B[8]),X=u(X,zt,mt,dt,pt,12,B[9]),dt=u(dt,X,zt,mt,it,17,B[10]),mt=u(mt,dt,X,zt,bt,22,B[11]),zt=u(zt,mt,dt,X,$t,7,B[12]),X=u(X,zt,mt,dt,Wt,12,B[13]),dt=u(dt,X,zt,mt,Ht,17,B[14]),zt=p(zt,mt=u(mt,dt,X,zt,Se,22,B[15]),dt,X,W,5,B[16]),X=p(X,zt,mt,dt,Bt,9,B[17]),dt=p(dt,X,zt,mt,bt,14,B[18]),mt=p(mt,dt,X,zt,Y,20,B[19]),zt=p(zt,mt,dt,X,Mt,5,B[20]),X=p(X,zt,mt,dt,it,9,B[21]),dt=p(dt,X,zt,mt,Se,14,B[22]),mt=p(mt,dt,X,zt,At,20,B[23]),zt=p(zt,mt,dt,X,pt,5,B[24]),X=p(X,zt,mt,dt,Ht,9,B[25]),dt=p(dt,X,zt,mt,vt,14,B[26]),mt=p(mt,dt,X,zt,ut,20,B[27]),zt=p(zt,mt,dt,X,Wt,5,B[28]),X=p(X,zt,mt,dt,st,9,B[29]),dt=p(dt,X,zt,mt,Q,14,B[30]),zt=g(zt,mt=p(mt,dt,X,zt,$t,20,B[31]),dt,X,Mt,4,B[32]),X=g(X,zt,mt,dt,ut,11,B[33]),dt=g(dt,X,zt,mt,bt,16,B[34]),mt=g(mt,dt,X,zt,Ht,23,B[35]),zt=g(zt,mt,dt,X,W,4,B[36]),X=g(X,zt,mt,dt,At,11,B[37]),dt=g(dt,X,zt,mt,Q,16,B[38]),mt=g(mt,dt,X,zt,it,23,B[39]),zt=g(zt,mt,dt,X,Wt,4,B[40]),X=g(X,zt,mt,dt,Y,11,B[41]),dt=g(dt,X,zt,mt,vt,16,B[42]),mt=g(mt,dt,X,zt,Bt,23,B[43]),zt=g(zt,mt,dt,X,pt,4,B[44]),X=g(X,zt,mt,dt,$t,11,B[45]),dt=g(dt,X,zt,mt,Se,16,B[46]),zt=m(zt,mt=g(mt,dt,X,zt,st,23,B[47]),dt,X,Y,6,B[48]),X=m(X,zt,mt,dt,Q,10,B[49]),dt=m(dt,X,zt,mt,Ht,15,B[50]),mt=m(mt,dt,X,zt,Mt,21,B[51]),zt=m(zt,mt,dt,X,$t,6,B[52]),X=m(X,zt,mt,dt,vt,10,B[53]),dt=m(dt,X,zt,mt,it,15,B[54]),mt=m(mt,dt,X,zt,W,21,B[55]),zt=m(zt,mt,dt,X,ut,6,B[56]),X=m(X,zt,mt,dt,Se,10,B[57]),dt=m(dt,X,zt,mt,Bt,15,B[58]),mt=m(mt,dt,X,zt,Wt,21,B[59]),zt=m(zt,mt,dt,X,At,6,B[60]),X=m(X,zt,mt,dt,bt,10,B[61]),dt=m(dt,X,zt,mt,st,15,B[62]),mt=m(mt,dt,X,zt,pt,21,B[63]),U[0]=U[0]+zt|0,U[1]=U[1]+mt|0,U[2]=U[2]+dt|0,U[3]=U[3]+X|0},_doFinalize:function(){var L=this._data,O=L.words,U=8*this._nDataBytes,W=8*L.sigBytes;O[W>>>5]|=128<<24-W%32;var Y=a.floor(U/4294967296);for(O[15+(W+64>>>9<<4)]=16711935&(Y<<8|Y>>>24)|4278255360&(Y<<24|Y>>>8),O[14+(W+64>>>9<<4)]=16711935&(U<<8|U>>>24)|4278255360&(U<<24|U>>>8),L.sigBytes=4*(O.length+1),this._process(),O=(L=this._hash).words,U=0;4>U;U++)W=O[U],O[U]=16711935&(W<<8|W>>>24)|4278255360&(W<<24|W>>>8);return L},clone:function(){var L=R.clone.call(this);return L._hash=this._hash.clone(),L}}),w.MD5=R._createHelper(P),w.HmacMD5=R._createHmacHelper(P)}(Math),function(){var a=z,u=(m=a.lib).WordArray,p=m.Hasher,g=[],m=a.algo.SHA1=p.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(w,F){for(var R=this._hash.words,P=R[0],B=R[1],K=R[2],L=R[3],O=R[4],U=0;80>U;U++){if(16>U)g[U]=0|w[F+U];else{var W=g[U-3]^g[U-8]^g[U-14]^g[U-16];g[U]=W<<1|W>>>31}W=(P<<5|P>>>27)+O+g[U],W=20>U?W+(1518500249+(B&K|~B&L)):40>U?W+(1859775393+(B^K^L)):60>U?W+((B&K|B&L|K&L)-1894007588):W+((B^K^L)-899497514),O=L,L=K,K=B<<30|B>>>2,B=P,P=W}R[0]=R[0]+P|0,R[1]=R[1]+B|0,R[2]=R[2]+K|0,R[3]=R[3]+L|0,R[4]=R[4]+O|0},_doFinalize:function(){var w=this._data,F=w.words,R=8*this._nDataBytes,P=8*w.sigBytes;return F[P>>>5]|=128<<24-P%32,F[14+(P+64>>>9<<4)]=Math.floor(R/4294967296),F[15+(P+64>>>9<<4)]=R,w.sigBytes=4*F.length,this._process(),this._hash},clone:function(){var w=p.clone.call(this);return w._hash=this._hash.clone(),w}});a.SHA1=p._createHelper(m),a.HmacSHA1=p._createHmacHelper(m)}(),function(a){for(var u=z,p=(m=u.lib).WordArray,g=m.Hasher,m=u.algo,w=[],F=[],R=function(W){return 4294967296*(W-(0|W))|0},P=2,B=0;64>B;){var K;t:{K=P;for(var L=a.sqrt(K),O=2;O<=L;O++)if(!(K%O)){K=!1;break t}K=!0}K&&(8>B&&(w[B]=R(a.pow(P,.5))),F[B]=R(a.pow(P,1/3)),B++),P++}var U=[];m=m.SHA256=g.extend({_doReset:function(){this._hash=new p.init(w.slice(0))},_doProcessBlock:function(W,Y){for(var st=this._hash.words,vt=st[0],At=st[1],Mt=st[2],Bt=st[3],Q=st[4],ut=st[5],pt=st[6],it=st[7],bt=0;64>bt;bt++){if(16>bt)U[bt]=0|W[Y+bt];else{var $t=U[bt-15],Wt=U[bt-2];U[bt]=(($t<<25|$t>>>7)^($t<<14|$t>>>18)^$t>>>3)+U[bt-7]+((Wt<<15|Wt>>>17)^(Wt<<13|Wt>>>19)^Wt>>>10)+U[bt-16]}$t=it+((Q<<26|Q>>>6)^(Q<<21|Q>>>11)^(Q<<7|Q>>>25))+(Q&ut^~Q&pt)+F[bt]+U[bt],Wt=((vt<<30|vt>>>2)^(vt<<19|vt>>>13)^(vt<<10|vt>>>22))+(vt&At^vt&Mt^At&Mt),it=pt,pt=ut,ut=Q,Q=Bt+$t|0,Bt=Mt,Mt=At,At=vt,vt=$t+Wt|0}st[0]=st[0]+vt|0,st[1]=st[1]+At|0,st[2]=st[2]+Mt|0,st[3]=st[3]+Bt|0,st[4]=st[4]+Q|0,st[5]=st[5]+ut|0,st[6]=st[6]+pt|0,st[7]=st[7]+it|0},_doFinalize:function(){var W=this._data,Y=W.words,st=8*this._nDataBytes,vt=8*W.sigBytes;return Y[vt>>>5]|=128<<24-vt%32,Y[14+(vt+64>>>9<<4)]=a.floor(st/4294967296),Y[15+(vt+64>>>9<<4)]=st,W.sigBytes=4*Y.length,this._process(),this._hash},clone:function(){var W=g.clone.call(this);return W._hash=this._hash.clone(),W}}),u.SHA256=g._createHelper(m),u.HmacSHA256=g._createHmacHelper(m)}(Math),function(){var a=z,u=a.lib.WordArray,p=(g=a.algo).SHA256,g=g.SHA224=p.extend({_doReset:function(){this._hash=new u.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var m=p._doFinalize.call(this);return m.sigBytes-=4,m}});a.SHA224=p._createHelper(g),a.HmacSHA224=p._createHmacHelper(g)}(),function(){function a(){return g.create.apply(g,arguments)}for(var u=z,p=u.lib.Hasher,g=(w=u.x64).Word,m=w.WordArray,w=u.algo,F=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],R=[],P=0;80>P;P++)R[P]=a();w=w.SHA512=p.extend({_doReset:function(){this._hash=new m.init([new g.init(1779033703,4089235720),new g.init(3144134277,2227873595),new g.init(1013904242,4271175723),new g.init(2773480762,1595750129),new g.init(1359893119,2917565137),new g.init(2600822924,725511199),new g.init(528734635,4215389547),new g.init(1541459225,327033209)])},_doProcessBlock:function(B,K){for(var L=(At=this._hash.words)[0],O=At[1],U=At[2],W=At[3],Y=At[4],st=At[5],vt=At[6],At=At[7],Mt=L.high,Bt=L.low,Q=O.high,ut=O.low,pt=U.high,it=U.low,bt=W.high,$t=W.low,Wt=Y.high,Ht=Y.low,Se=st.high,zt=st.low,X=vt.high,dt=vt.low,mt=At.high,Rt=At.low,Ft=Mt,jt=Bt,re=Q,te=ut,Et=pt,kt=it,Tt=bt,Qt=$t,le=Wt,$e=Ht,pr=Se,Pr=zt,er=X,gn=dt,ro=mt,wr=Rt,Fr=0;80>Fr;Fr++){var yn=R[Fr];if(16>Fr)var Or=yn.high=0|B[K+2*Fr],ir=yn.low=0|B[K+2*Fr+1];else{Or=((ir=(Or=R[Fr-15]).high)>>>1|(Br=Or.low)<<31)^(ir>>>8|Br<<24)^ir>>>7;var Br=(Br>>>1|ir<<31)^(Br>>>8|ir<<24)^(Br>>>7|ir<<25),Ve=((ir=(Ve=R[Fr-2]).high)>>>19|(Er=Ve.low)<<13)^(ir<<3|Er>>>29)^ir>>>6,Er=(Er>>>19|ir<<13)^(Er<<3|ir>>>29)^(Er>>>6|ir<<26),Yn=(ir=R[Fr-7]).high,Qr=(mn=R[Fr-16]).high,mn=mn.low;Or=(Or=(Or=Or+Yn+((ir=Br+ir.low)>>>0<Br>>>0?1:0))+Ve+((ir+=Er)>>>0<Er>>>0?1:0))+Qr+((ir+=mn)>>>0<mn>>>0?1:0),yn.high=Or,yn.low=ir}Yn=le&pr^~le&er,mn=$e&Pr^~$e&gn,yn=Ft&re^Ft&Et^re&Et;var ta=jt&te^jt&kt^te&kt,ea=(Br=(Ft>>>28|jt<<4)^(Ft<<30|jt>>>2)^(Ft<<25|jt>>>7),Ve=(jt>>>28|Ft<<4)^(jt<<30|Ft>>>2)^(jt<<25|Ft>>>7),(Er=F[Fr]).high),Nn=Er.low;Qr=ro+((le>>>14|$e<<18)^(le>>>18|$e<<14)^(le<<23|$e>>>9))+((Er=wr+(($e>>>14|le<<18)^($e>>>18|le<<14)^($e<<23|le>>>9)))>>>0<wr>>>0?1:0),ro=er,wr=gn,er=pr,gn=Pr,pr=le,Pr=$e,le=Tt+(Qr=(Qr=(Qr=Qr+Yn+((Er+=mn)>>>0<mn>>>0?1:0))+ea+((Er+=Nn)>>>0<Nn>>>0?1:0))+Or+((Er+=ir)>>>0<ir>>>0?1:0))+(($e=Qt+Er|0)>>>0<Qt>>>0?1:0)|0,Tt=Et,Qt=kt,Et=re,kt=te,re=Ft,te=jt,Ft=Qr+(yn=Br+yn+((ir=Ve+ta)>>>0<Ve>>>0?1:0))+((jt=Er+ir|0)>>>0<Er>>>0?1:0)|0}Bt=L.low=Bt+jt,L.high=Mt+Ft+(Bt>>>0<jt>>>0?1:0),ut=O.low=ut+te,O.high=Q+re+(ut>>>0<te>>>0?1:0),it=U.low=it+kt,U.high=pt+Et+(it>>>0<kt>>>0?1:0),$t=W.low=$t+Qt,W.high=bt+Tt+($t>>>0<Qt>>>0?1:0),Ht=Y.low=Ht+$e,Y.high=Wt+le+(Ht>>>0<$e>>>0?1:0),zt=st.low=zt+Pr,st.high=Se+pr+(zt>>>0<Pr>>>0?1:0),dt=vt.low=dt+gn,vt.high=X+er+(dt>>>0<gn>>>0?1:0),Rt=At.low=Rt+wr,At.high=mt+ro+(Rt>>>0<wr>>>0?1:0)},_doFinalize:function(){var B=this._data,K=B.words,L=8*this._nDataBytes,O=8*B.sigBytes;return K[O>>>5]|=128<<24-O%32,K[30+(O+128>>>10<<5)]=Math.floor(L/4294967296),K[31+(O+128>>>10<<5)]=L,B.sigBytes=4*K.length,this._process(),this._hash.toX32()},clone:function(){var B=p.clone.call(this);return B._hash=this._hash.clone(),B},blockSize:32}),u.SHA512=p._createHelper(w),u.HmacSHA512=p._createHmacHelper(w)}(),function(){var a=z,u=(m=a.x64).Word,p=m.WordArray,g=(m=a.algo).SHA512,m=m.SHA384=g.extend({_doReset:function(){this._hash=new p.init([new u.init(3418070365,3238371032),new u.init(1654270250,914150663),new u.init(2438529370,812702999),new u.init(355462360,4144912697),new u.init(1731405415,4290775857),new u.init(2394180231,1750603025),new u.init(3675008525,1694076839),new u.init(1203062813,3204075428)])},_doFinalize:function(){var w=g._doFinalize.call(this);return w.sigBytes-=16,w}});a.SHA384=g._createHelper(m),a.HmacSHA384=g._createHmacHelper(m)}(),function(){var a=z,u=(g=a.lib).WordArray,p=g.Hasher,g=a.algo,m=u.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),w=u.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),F=u.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),R=u.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),P=u.create([0,1518500249,1859775393,2400959708,2840853838]),B=u.create([1352829926,1548603684,1836072691,2053994217,0]);g=g.RIPEMD160=p.extend({_doReset:function(){this._hash=u.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(K,L){for(var O=0;16>O;O++){var U=K[bt=L+O];K[bt]=16711935&(U<<8|U>>>24)|4278255360&(U<<24|U>>>8)}var W,Y,st,vt,At,Mt,Bt,Q,ut,pt,it,bt=this._hash.words,$t=(U=P.words,B.words),Wt=m.words,Ht=w.words,Se=F.words,zt=R.words;for(Mt=W=bt[0],Bt=Y=bt[1],Q=st=bt[2],ut=vt=bt[3],pt=At=bt[4],O=0;80>O;O+=1)it=W+K[L+Wt[O]]|0,it=16>O?it+((Y^st^vt)+U[0]):32>O?it+((Y&st|~Y&vt)+U[1]):48>O?it+(((Y|~st)^vt)+U[2]):64>O?it+((Y&vt|st&~vt)+U[3]):it+((Y^(st|~vt))+U[4]),it=(it=(it|=0)<<Se[O]|it>>>32-Se[O])+At|0,W=At,At=vt,vt=st<<10|st>>>22,st=Y,Y=it,it=Mt+K[L+Ht[O]]|0,it=16>O?it+((Bt^(Q|~ut))+$t[0]):32>O?it+((Bt&ut|Q&~ut)+$t[1]):48>O?it+(((Bt|~Q)^ut)+$t[2]):64>O?it+((Bt&Q|~Bt&ut)+$t[3]):it+((Bt^Q^ut)+$t[4]),it=(it=(it|=0)<<zt[O]|it>>>32-zt[O])+pt|0,Mt=pt,pt=ut,ut=Q<<10|Q>>>22,Q=Bt,Bt=it;it=bt[1]+st+ut|0,bt[1]=bt[2]+vt+pt|0,bt[2]=bt[3]+At+Mt|0,bt[3]=bt[4]+W+Bt|0,bt[4]=bt[0]+Y+Q|0,bt[0]=it},_doFinalize:function(){var K=this._data,L=K.words,O=8*this._nDataBytes,U=8*K.sigBytes;for(L[U>>>5]|=128<<24-U%32,L[14+(U+64>>>9<<4)]=16711935&(O<<8|O>>>24)|4278255360&(O<<24|O>>>8),K.sigBytes=4*(L.length+1),this._process(),L=(K=this._hash).words,O=0;5>O;O++)U=L[O],L[O]=16711935&(U<<8|U>>>24)|4278255360&(U<<24|U>>>8);return K},clone:function(){var K=p.clone.call(this);return K._hash=this._hash.clone(),K}}),a.RIPEMD160=p._createHelper(g),a.HmacRIPEMD160=p._createHmacHelper(g)}(Math),function(){var a=z,u=a.enc.Utf8;a.algo.HMAC=a.lib.Base.extend({init:function(p,g){p=this._hasher=new p.init,typeof g=="string"&&(g=u.parse(g));var m=p.blockSize,w=4*m;g.sigBytes>w&&(g=p.finalize(g)),g.clamp();for(var F=this._oKey=g.clone(),R=this._iKey=g.clone(),P=F.words,B=R.words,K=0;K<m;K++)P[K]^=1549556828,B[K]^=909522486;F.sigBytes=R.sigBytes=w,this.reset()},reset:function(){var p=this._hasher;p.reset(),p.update(this._iKey)},update:function(p){return this._hasher.update(p),this},finalize:function(p){var g=this._hasher;return p=g.finalize(p),g.reset(),g.finalize(this._oKey.clone().concat(p))}})}(),function(){var a,u=z,p=(a=u.lib).Base,g=a.WordArray,m=(a=u.algo).HMAC,w=a.PBKDF2=p.extend({cfg:p.extend({keySize:4,hasher:a.SHA1,iterations:1}),init:function(F){this.cfg=this.cfg.extend(F)},compute:function(F,R){var P=this.cfg,B=m.create(P.hasher,F),K=g.create(),L=g.create([1]),O=K.words,U=L.words,W=P.keySize;for(P=P.iterations;O.length<W;){var Y=B.update(R).finalize(L);B.reset();for(var st=Y.words,vt=st.length,At=Y,Mt=1;Mt<P;Mt++){At=B.finalize(At),B.reset();for(var Bt=At.words,Q=0;Q<vt;Q++)st[Q]^=Bt[Q]}K.concat(Y),U[0]++}return K.sigBytes=4*W,K}});u.PBKDF2=function(F,R,P){return w.create(P).compute(F,R)}}();var Z,j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function at(a){var u,p,g="";for(u=0;u+3<=a.length;u+=3)p=parseInt(a.substring(u,u+3),16),g+=j.charAt(p>>6)+j.charAt(63&p);for(u+1==a.length?(p=parseInt(a.substring(u,u+1),16),g+=j.charAt(p<<2)):u+2==a.length&&(p=parseInt(a.substring(u,u+2),16),g+=j.charAt(p>>2)+j.charAt((3&p)<<4)),"=";(3&g.length)>0;)g+="=";return g}function ct(a){var u,p,g,m="",w=0;for(u=0;u<a.length&&a.charAt(u)!="=";++u)(g=j.indexOf(a.charAt(u)))<0||(w==0?(m+=Ct(g>>2),p=3&g,w=1):w==1?(m+=Ct(p<<2|g>>4),p=15&g,w=2):w==2?(m+=Ct(p),m+=Ct(g>>2),p=3&g,w=3):(m+=Ct(p<<2|g>>4),m+=Ct(15&g),w=0));return w==1&&(m+=Ct(p<<2)),m}function ot(a){var u,p=ct(a),g=new Array;for(u=0;2*u<p.length;++u)g[u]=parseInt(p.substring(2*u,2*u+2),16);return g}function tt(a,u,p){a!=null&&(typeof a=="number"?this.fromNumber(a,u,p):u==null&&typeof a!="string"?this.fromString(a,256):this.fromString(a,u))}function gt(){return new tt(null)}q.appName=="Microsoft Internet Explorer"?(tt.prototype.am=function(a,u,p,g,m,w){for(var F=32767&u,R=u>>15;--w>=0;){var P=32767&this[a],B=this[a++]>>15,K=R*P+B*F;m=((P=F*P+((32767&K)<<15)+p[g]+(1073741823&m))>>>30)+(K>>>15)+R*B+(m>>>30),p[g++]=1073741823&P}return m},Z=30):q.appName!="Netscape"?(tt.prototype.am=function(a,u,p,g,m,w){for(;--w>=0;){var F=u*this[a++]+p[g]+m;m=Math.floor(F/67108864),p[g++]=67108863&F}return m},Z=26):(tt.prototype.am=function(a,u,p,g,m,w){for(var F=16383&u,R=u>>14;--w>=0;){var P=16383&this[a],B=this[a++]>>14,K=R*P+B*F;m=((P=F*P+((16383&K)<<14)+p[g]+m)>>28)+(K>>14)+R*B,p[g++]=268435455&P}return m},Z=28),tt.prototype.DB=Z,tt.prototype.DM=(1<<Z)-1,tt.prototype.DV=1<<Z,tt.prototype.FV=Math.pow(2,52),tt.prototype.F1=52-Z,tt.prototype.F2=2*Z-52;var wt,ft,yt=new Array;for(wt=48,ft=0;ft<=9;++ft)yt[wt++]=ft;for(wt=97,ft=10;ft<36;++ft)yt[wt++]=ft;for(wt=65,ft=10;ft<36;++ft)yt[wt++]=ft;function Ct(a){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(a)}function l(a,u){var p=yt[a.charCodeAt(u)];return p??-1}function s(a){var u=gt();return u.fromInt(a),u}function b(a){var u,p=1;return(u=a>>>16)!=0&&(a=u,p+=16),(u=a>>8)!=0&&(a=u,p+=8),(u=a>>4)!=0&&(a=u,p+=4),(u=a>>2)!=0&&(a=u,p+=2),(u=a>>1)!=0&&(a=u,p+=1),p}function $(a){this.m=a}function E(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function rt(a,u){return a&u}function _t(a,u){return a|u}function xt(a,u){return a^u}function St(a,u){return a&~u}function x(a){if(a==0)return-1;var u=0;return!(65535&a)&&(a>>=16,u+=16),!(255&a)&&(a>>=8,u+=8),!(15&a)&&(a>>=4,u+=4),!(3&a)&&(a>>=2,u+=2),!(1&a)&&++u,u}function N(a){for(var u=0;a!=0;)a&=a-1,++u;return u}function V(){}function S(a){return a}function C(a){this.r2=gt(),this.q3=gt(),tt.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a),this.m=a}$.prototype.convert=function(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a},$.prototype.revert=function(a){return a},$.prototype.reduce=function(a){a.divRemTo(this.m,null,a)},$.prototype.mulTo=function(a,u,p){a.multiplyTo(u,p),this.reduce(p)},$.prototype.sqrTo=function(a,u){a.squareTo(u),this.reduce(u)},E.prototype.convert=function(a){var u=gt();return a.abs().dlShiftTo(this.m.t,u),u.divRemTo(this.m,null,u),a.s<0&&u.compareTo(tt.ZERO)>0&&this.m.subTo(u,u),u},E.prototype.revert=function(a){var u=gt();return a.copyTo(u),this.reduce(u),u},E.prototype.reduce=function(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var u=0;u<this.m.t;++u){var p=32767&a[u],g=p*this.mpl+((p*this.mph+(a[u]>>15)*this.mpl&this.um)<<15)&a.DM;for(a[p=u+this.m.t]+=this.m.am(0,g,a,u,0,this.m.t);a[p]>=a.DV;)a[p]-=a.DV,a[++p]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)},E.prototype.mulTo=function(a,u,p){a.multiplyTo(u,p),this.reduce(p)},E.prototype.sqrTo=function(a,u){a.squareTo(u),this.reduce(u)},tt.prototype.copyTo=function(a){for(var u=this.t-1;u>=0;--u)a[u]=this[u];a.t=this.t,a.s=this.s},tt.prototype.fromInt=function(a){this.t=1,this.s=a<0?-1:0,a>0?this[0]=a:a<-1?this[0]=a+this.DV:this.t=0},tt.prototype.fromString=function(a,u){var p;if(u==16)p=4;else if(u==8)p=3;else if(u==256)p=8;else if(u==2)p=1;else if(u==32)p=5;else{if(u!=4)return void this.fromRadix(a,u);p=2}this.t=0,this.s=0;for(var g=a.length,m=!1,w=0;--g>=0;){var F=p==8?255&a[g]:l(a,g);F<0?a.charAt(g)=="-"&&(m=!0):(m=!1,w==0?this[this.t++]=F:w+p>this.DB?(this[this.t-1]|=(F&(1<<this.DB-w)-1)<<w,this[this.t++]=F>>this.DB-w):this[this.t-1]|=F<<w,(w+=p)>=this.DB&&(w-=this.DB))}p==8&&128&a[0]&&(this.s=-1,w>0&&(this[this.t-1]|=(1<<this.DB-w)-1<<w)),this.clamp(),m&&tt.ZERO.subTo(this,this)},tt.prototype.clamp=function(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t},tt.prototype.dlShiftTo=function(a,u){var p;for(p=this.t-1;p>=0;--p)u[p+a]=this[p];for(p=a-1;p>=0;--p)u[p]=0;u.t=this.t+a,u.s=this.s},tt.prototype.drShiftTo=function(a,u){for(var p=a;p<this.t;++p)u[p-a]=this[p];u.t=Math.max(this.t-a,0),u.s=this.s},tt.prototype.lShiftTo=function(a,u){var p,g=a%this.DB,m=this.DB-g,w=(1<<m)-1,F=Math.floor(a/this.DB),R=this.s<<g&this.DM;for(p=this.t-1;p>=0;--p)u[p+F+1]=this[p]>>m|R,R=(this[p]&w)<<g;for(p=F-1;p>=0;--p)u[p]=0;u[F]=R,u.t=this.t+F+1,u.s=this.s,u.clamp()},tt.prototype.rShiftTo=function(a,u){u.s=this.s;var p=Math.floor(a/this.DB);if(p>=this.t)u.t=0;else{var g=a%this.DB,m=this.DB-g,w=(1<<g)-1;u[0]=this[p]>>g;for(var F=p+1;F<this.t;++F)u[F-p-1]|=(this[F]&w)<<m,u[F-p]=this[F]>>g;g>0&&(u[this.t-p-1]|=(this.s&w)<<m),u.t=this.t-p,u.clamp()}},tt.prototype.subTo=function(a,u){for(var p=0,g=0,m=Math.min(a.t,this.t);p<m;)g+=this[p]-a[p],u[p++]=g&this.DM,g>>=this.DB;if(a.t<this.t){for(g-=a.s;p<this.t;)g+=this[p],u[p++]=g&this.DM,g>>=this.DB;g+=this.s}else{for(g+=this.s;p<a.t;)g-=a[p],u[p++]=g&this.DM,g>>=this.DB;g-=a.s}u.s=g<0?-1:0,g<-1?u[p++]=this.DV+g:g>0&&(u[p++]=g),u.t=p,u.clamp()},tt.prototype.multiplyTo=function(a,u){var p=this.abs(),g=a.abs(),m=p.t;for(u.t=m+g.t;--m>=0;)u[m]=0;for(m=0;m<g.t;++m)u[m+p.t]=p.am(0,g[m],u,m,0,p.t);u.s=0,u.clamp(),this.s!=a.s&&tt.ZERO.subTo(u,u)},tt.prototype.squareTo=function(a){for(var u=this.abs(),p=a.t=2*u.t;--p>=0;)a[p]=0;for(p=0;p<u.t-1;++p){var g=u.am(p,u[p],a,2*p,0,1);(a[p+u.t]+=u.am(p+1,2*u[p],a,2*p+1,g,u.t-p-1))>=u.DV&&(a[p+u.t]-=u.DV,a[p+u.t+1]=1)}a.t>0&&(a[a.t-1]+=u.am(p,u[p],a,2*p,0,1)),a.s=0,a.clamp()},tt.prototype.divRemTo=function(a,u,p){var g=a.abs();if(!(g.t<=0)){var m=this.abs();if(m.t<g.t)return u?.fromInt(0),void(p!=null&&this.copyTo(p));p==null&&(p=gt());var w=gt(),F=this.s,R=a.s,P=this.DB-b(g[g.t-1]);P>0?(g.lShiftTo(P,w),m.lShiftTo(P,p)):(g.copyTo(w),m.copyTo(p));var B=w.t,K=w[B-1];if(K!=0){var L=K*(1<<this.F1)+(B>1?w[B-2]>>this.F2:0),O=this.FV/L,U=(1<<this.F1)/L,W=1<<this.F2,Y=p.t,st=Y-B,vt=u??gt();for(w.dlShiftTo(st,vt),p.compareTo(vt)>=0&&(p[p.t++]=1,p.subTo(vt,p)),tt.ONE.dlShiftTo(B,vt),vt.subTo(w,w);w.t<B;)w[w.t++]=0;for(;--st>=0;){var At=p[--Y]==K?this.DM:Math.floor(p[Y]*O+(p[Y-1]+W)*U);if((p[Y]+=w.am(0,At,p,st,0,B))<At)for(w.dlShiftTo(st,vt),p.subTo(vt,p);p[Y]<--At;)p.subTo(vt,p)}u!=null&&(p.drShiftTo(B,u),F!=R&&tt.ZERO.subTo(u,u)),p.t=B,p.clamp(),P>0&&p.rShiftTo(P,p),F<0&&tt.ZERO.subTo(p,p)}}},tt.prototype.invDigit=function(){if(this.t<1)return 0;var a=this[0];if(!(1&a))return 0;var u=3&a;return(u=(u=(u=(u=u*(2-(15&a)*u)&15)*(2-(255&a)*u)&255)*(2-((65535&a)*u&65535))&65535)*(2-a*u%this.DV)%this.DV)>0?this.DV-u:-u},tt.prototype.isEven=function(){return(this.t>0?1&this[0]:this.s)==0},tt.prototype.exp=function(a,u){if(a>4294967295||a<1)return tt.ONE;var p=gt(),g=gt(),m=u.convert(this),w=b(a)-1;for(m.copyTo(p);--w>=0;)if(u.sqrTo(p,g),(a&1<<w)>0)u.mulTo(g,m,p);else{var F=p;p=g,g=F}return u.revert(p)},tt.prototype.toString=function(a){if(this.s<0)return"-"+this.negate().toString(a);var u;if(a==16)u=4;else if(a==8)u=3;else if(a==2)u=1;else if(a==32)u=5;else{if(a!=4)return this.toRadix(a);u=2}var p,g=(1<<u)-1,m=!1,w="",F=this.t,R=this.DB-F*this.DB%u;if(F-- >0)for(R<this.DB&&(p=this[F]>>R)>0&&(m=!0,w=Ct(p));F>=0;)R<u?(p=(this[F]&(1<<R)-1)<<u-R,p|=this[--F]>>(R+=this.DB-u)):(p=this[F]>>(R-=u)&g,R<=0&&(R+=this.DB,--F)),p>0&&(m=!0),m&&(w+=Ct(p));return m?w:"0"},tt.prototype.negate=function(){var a=gt();return tt.ZERO.subTo(this,a),a},tt.prototype.abs=function(){return this.s<0?this.negate():this},tt.prototype.compareTo=function(a){var u=this.s-a.s;if(u!=0)return u;var p=this.t;if((u=p-a.t)!=0)return this.s<0?-u:u;for(;--p>=0;)if((u=this[p]-a[p])!=0)return u;return 0},tt.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+b(this[this.t-1]^this.s&this.DM)},tt.prototype.mod=function(a){var u=gt();return this.abs().divRemTo(a,null,u),this.s<0&&u.compareTo(tt.ZERO)>0&&a.subTo(u,u),u},tt.prototype.modPowInt=function(a,u){var p;return p=a<256||u.isEven()?new $(u):new E(u),this.exp(a,p)},tt.ZERO=s(0),tt.ONE=s(1),V.prototype.convert=S,V.prototype.revert=S,V.prototype.mulTo=function(a,u,p){a.multiplyTo(u,p)},V.prototype.sqrTo=function(a,u){a.squareTo(u)},C.prototype.convert=function(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var u=gt();return a.copyTo(u),this.reduce(u),u},C.prototype.revert=function(a){return a},C.prototype.reduce=function(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)},C.prototype.mulTo=function(a,u,p){a.multiplyTo(u,p),this.reduce(p)},C.prototype.sqrTo=function(a,u){a.squareTo(u),this.reduce(u)};var T=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],M=(1<<26)/T[T.length-1];function et(){this.i=0,this.j=0,this.S=new Array}tt.prototype.chunkSize=function(a){return Math.floor(Math.LN2*this.DB/Math.log(a))},tt.prototype.toRadix=function(a){if(a==null&&(a=10),this.signum()==0||a<2||a>36)return"0";var u=this.chunkSize(a),p=Math.pow(a,u),g=s(p),m=gt(),w=gt(),F="";for(this.divRemTo(g,m,w);m.signum()>0;)F=(p+w.intValue()).toString(a).substr(1)+F,m.divRemTo(g,m,w);return w.intValue().toString(a)+F},tt.prototype.fromRadix=function(a,u){this.fromInt(0),u==null&&(u=10);for(var p=this.chunkSize(u),g=Math.pow(u,p),m=!1,w=0,F=0,R=0;R<a.length;++R){var P=l(a,R);P<0?a.charAt(R)=="-"&&this.signum()==0&&(m=!0):(F=u*F+P,++w>=p&&(this.dMultiply(g),this.dAddOffset(F,0),w=0,F=0))}w>0&&(this.dMultiply(Math.pow(u,w)),this.dAddOffset(F,0)),m&&tt.ZERO.subTo(this,this)},tt.prototype.fromNumber=function(a,u,p){if(typeof u=="number")if(a<2)this.fromInt(1);else for(this.fromNumber(a,p),this.testBit(a-1)||this.bitwiseTo(tt.ONE.shiftLeft(a-1),_t,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(u);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(tt.ONE.shiftLeft(a-1),this);else{var g=new Array,m=7&a;g.length=1+(a>>3),u.nextBytes(g),m>0?g[0]&=(1<<m)-1:g[0]=0,this.fromString(g,256)}},tt.prototype.bitwiseTo=function(a,u,p){var g,m,w=Math.min(a.t,this.t);for(g=0;g<w;++g)p[g]=u(this[g],a[g]);if(a.t<this.t){for(m=a.s&this.DM,g=w;g<this.t;++g)p[g]=u(this[g],m);p.t=this.t}else{for(m=this.s&this.DM,g=w;g<a.t;++g)p[g]=u(m,a[g]);p.t=a.t}p.s=u(this.s,a.s),p.clamp()},tt.prototype.changeBit=function(a,u){var p=tt.ONE.shiftLeft(a);return this.bitwiseTo(p,u,p),p},tt.prototype.addTo=function(a,u){for(var p=0,g=0,m=Math.min(a.t,this.t);p<m;)g+=this[p]+a[p],u[p++]=g&this.DM,g>>=this.DB;if(a.t<this.t){for(g+=a.s;p<this.t;)g+=this[p],u[p++]=g&this.DM,g>>=this.DB;g+=this.s}else{for(g+=this.s;p<a.t;)g+=a[p],u[p++]=g&this.DM,g>>=this.DB;g+=a.s}u.s=g<0?-1:0,g>0?u[p++]=g:g<-1&&(u[p++]=this.DV+g),u.t=p,u.clamp()},tt.prototype.dMultiply=function(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()},tt.prototype.dAddOffset=function(a,u){if(a!=0){for(;this.t<=u;)this[this.t++]=0;for(this[u]+=a;this[u]>=this.DV;)this[u]-=this.DV,++u>=this.t&&(this[this.t++]=0),++this[u]}},tt.prototype.multiplyLowerTo=function(a,u,p){var g,m=Math.min(this.t+a.t,u);for(p.s=0,p.t=m;m>0;)p[--m]=0;for(g=p.t-this.t;m<g;++m)p[m+this.t]=this.am(0,a[m],p,m,0,this.t);for(g=Math.min(a.t,u);m<g;++m)this.am(0,a[m],p,m,0,u-m);p.clamp()},tt.prototype.multiplyUpperTo=function(a,u,p){--u;var g=p.t=this.t+a.t-u;for(p.s=0;--g>=0;)p[g]=0;for(g=Math.max(u-this.t,0);g<a.t;++g)p[this.t+g-u]=this.am(u-g,a[g],p,0,0,this.t+g-u);p.clamp(),p.drShiftTo(1,p)},tt.prototype.modInt=function(a){if(a<=0)return 0;var u=this.DV%a,p=this.s<0?a-1:0;if(this.t>0)if(u==0)p=this[0]%a;else for(var g=this.t-1;g>=0;--g)p=(u*p+this[g])%a;return p},tt.prototype.millerRabin=function(a){var u=this.subtract(tt.ONE),p=u.getLowestSetBit();if(p<=0)return!1;var g=u.shiftRight(p);(a=a+1>>1)>T.length&&(a=T.length);for(var m=gt(),w=0;w<a;++w){m.fromInt(T[Math.floor(Math.random()*T.length)]);var F=m.modPow(g,this);if(F.compareTo(tt.ONE)!=0&&F.compareTo(u)!=0){for(var R=1;R++<p&&F.compareTo(u)!=0;)if((F=F.modPowInt(2,this)).compareTo(tt.ONE)==0)return!1;if(F.compareTo(u)!=0)return!1}}return!0},tt.prototype.clone=function(){var a=gt();return this.copyTo(a),a},tt.prototype.intValue=function(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},tt.prototype.byteValue=function(){return this.t==0?this.s:this[0]<<24>>24},tt.prototype.shortValue=function(){return this.t==0?this.s:this[0]<<16>>16},tt.prototype.signum=function(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1},tt.prototype.toByteArray=function(){var a=this.t,u=new Array;u[0]=this.s;var p,g=this.DB-a*this.DB%8,m=0;if(a-- >0)for(g<this.DB&&(p=this[a]>>g)!=(this.s&this.DM)>>g&&(u[m++]=p|this.s<<this.DB-g);a>=0;)g<8?(p=(this[a]&(1<<g)-1)<<8-g,p|=this[--a]>>(g+=this.DB-8)):(p=this[a]>>(g-=8)&255,g<=0&&(g+=this.DB,--a)),128&p&&(p|=-256),m==0&&(128&this.s)!=(128&p)&&++m,(m>0||p!=this.s)&&(u[m++]=p);return u},tt.prototype.equals=function(a){return this.compareTo(a)==0},tt.prototype.min=function(a){return this.compareTo(a)<0?this:a},tt.prototype.max=function(a){return this.compareTo(a)>0?this:a},tt.prototype.and=function(a){var u=gt();return this.bitwiseTo(a,rt,u),u},tt.prototype.or=function(a){var u=gt();return this.bitwiseTo(a,_t,u),u},tt.prototype.xor=function(a){var u=gt();return this.bitwiseTo(a,xt,u),u},tt.prototype.andNot=function(a){var u=gt();return this.bitwiseTo(a,St,u),u},tt.prototype.not=function(){for(var a=gt(),u=0;u<this.t;++u)a[u]=this.DM&~this[u];return a.t=this.t,a.s=~this.s,a},tt.prototype.shiftLeft=function(a){var u=gt();return a<0?this.rShiftTo(-a,u):this.lShiftTo(a,u),u},tt.prototype.shiftRight=function(a){var u=gt();return a<0?this.lShiftTo(-a,u):this.rShiftTo(a,u),u},tt.prototype.getLowestSetBit=function(){for(var a=0;a<this.t;++a)if(this[a]!=0)return a*this.DB+x(this[a]);return this.s<0?this.t*this.DB:-1},tt.prototype.bitCount=function(){for(var a=0,u=this.s&this.DM,p=0;p<this.t;++p)a+=N(this[p]^u);return a},tt.prototype.testBit=function(a){var u=Math.floor(a/this.DB);return u>=this.t?this.s!=0:(this[u]&1<<a%this.DB)!=0},tt.prototype.setBit=function(a){return this.changeBit(a,_t)},tt.prototype.clearBit=function(a){return this.changeBit(a,St)},tt.prototype.flipBit=function(a){return this.changeBit(a,xt)},tt.prototype.add=function(a){var u=gt();return this.addTo(a,u),u},tt.prototype.subtract=function(a){var u=gt();return this.subTo(a,u),u},tt.prototype.multiply=function(a){var u=gt();return this.multiplyTo(a,u),u},tt.prototype.divide=function(a){var u=gt();return this.divRemTo(a,u,null),u},tt.prototype.remainder=function(a){var u=gt();return this.divRemTo(a,null,u),u},tt.prototype.divideAndRemainder=function(a){var u=gt(),p=gt();return this.divRemTo(a,u,p),new Array(u,p)},tt.prototype.modPow=function(a,u){var p,g,m=a.bitLength(),w=s(1);if(m<=0)return w;p=m<18?1:m<48?3:m<144?4:m<768?5:6,g=m<8?new $(u):u.isEven()?new C(u):new E(u);var F=new Array,R=3,P=p-1,B=(1<<p)-1;if(F[1]=g.convert(this),p>1){var K=gt();for(g.sqrTo(F[1],K);R<=B;)F[R]=gt(),g.mulTo(K,F[R-2],F[R]),R+=2}var L,O,U=a.t-1,W=!0,Y=gt();for(m=b(a[U])-1;U>=0;){for(m>=P?L=a[U]>>m-P&B:(L=(a[U]&(1<<m+1)-1)<<P-m,U>0&&(L|=a[U-1]>>this.DB+m-P)),R=p;!(1&L);)L>>=1,--R;if((m-=R)<0&&(m+=this.DB,--U),W)F[L].copyTo(w),W=!1;else{for(;R>1;)g.sqrTo(w,Y),g.sqrTo(Y,w),R-=2;R>0?g.sqrTo(w,Y):(O=w,w=Y,Y=O),g.mulTo(Y,F[L],w)}for(;U>=0&&!(a[U]&1<<m);)g.sqrTo(w,Y),O=w,w=Y,Y=O,--m<0&&(m=this.DB-1,--U)}return g.revert(w)},tt.prototype.modInverse=function(a){var u=a.isEven();if(this.isEven()&&u||a.signum()==0)return tt.ZERO;for(var p=a.clone(),g=this.clone(),m=s(1),w=s(0),F=s(0),R=s(1);p.signum()!=0;){for(;p.isEven();)p.rShiftTo(1,p),u?(m.isEven()&&w.isEven()||(m.addTo(this,m),w.subTo(a,w)),m.rShiftTo(1,m)):w.isEven()||w.subTo(a,w),w.rShiftTo(1,w);for(;g.isEven();)g.rShiftTo(1,g),u?(F.isEven()&&R.isEven()||(F.addTo(this,F),R.subTo(a,R)),F.rShiftTo(1,F)):R.isEven()||R.subTo(a,R),R.rShiftTo(1,R);p.compareTo(g)>=0?(p.subTo(g,p),u&&m.subTo(F,m),w.subTo(R,w)):(g.subTo(p,g),u&&F.subTo(m,F),R.subTo(w,R))}return g.compareTo(tt.ONE)!=0?tt.ZERO:R.compareTo(a)>=0?R.subtract(a):R.signum()<0?(R.addTo(a,R),R.signum()<0?R.add(a):R):R},tt.prototype.pow=function(a){return this.exp(a,new V)},tt.prototype.gcd=function(a){var u=this.s<0?this.negate():this.clone(),p=a.s<0?a.negate():a.clone();if(u.compareTo(p)<0){var g=u;u=p,p=g}var m=u.getLowestSetBit(),w=p.getLowestSetBit();if(w<0)return u;for(m<w&&(w=m),w>0&&(u.rShiftTo(w,u),p.rShiftTo(w,p));u.signum()>0;)(m=u.getLowestSetBit())>0&&u.rShiftTo(m,u),(m=p.getLowestSetBit())>0&&p.rShiftTo(m,p),u.compareTo(p)>=0?(u.subTo(p,u),u.rShiftTo(1,u)):(p.subTo(u,p),p.rShiftTo(1,p));return w>0&&p.lShiftTo(w,p),p},tt.prototype.isProbablePrime=function(a){var u,p=this.abs();if(p.t==1&&p[0]<=T[T.length-1]){for(u=0;u<T.length;++u)if(p[0]==T[u])return!0;return!1}if(p.isEven())return!1;for(u=1;u<T.length;){for(var g=T[u],m=u+1;m<T.length&&g<M;)g*=T[m++];for(g=p.modInt(g);u<m;)if(g%T[u++]==0)return!1}return p.millerRabin(a)},tt.prototype.square=function(){var a=gt();return this.squareTo(a),a},et.prototype.init=function(a){var u,p,g;for(u=0;u<256;++u)this.S[u]=u;for(p=0,u=0;u<256;++u)p=p+this.S[u]+a[u%a.length]&255,g=this.S[u],this.S[u]=this.S[p],this.S[p]=g;this.i=0,this.j=0},et.prototype.next=function(){var a;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,a=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=a,this.S[a+this.S[this.i]&255]};var Pt,Ut,Zt;function _e(){var a;a=new Date().getTime(),Ut[Zt++]^=255&a,Ut[Zt++]^=a>>8&255,Ut[Zt++]^=a>>16&255,Ut[Zt++]^=a>>24&255,Zt>=256&&(Zt-=256)}if(Ut==null){var me;if(Ut=new Array,Zt=0,H!==void 0&&(H.crypto!==void 0||H.msCrypto!==void 0)){var de=H.crypto||H.msCrypto;if(de.getRandomValues){var Xt=new Uint8Array(32);for(de.getRandomValues(Xt),me=0;me<32;++me)Ut[Zt++]=Xt[me]}else if(q.appName=="Netscape"&&q.appVersion<"5"){var Gt=H.crypto.random(32);for(me=0;me<Gt.length;++me)Ut[Zt++]=255&Gt.charCodeAt(me)}}for(;Zt<256;)me=Math.floor(65536*Math.random()),Ut[Zt++]=me>>>8,Ut[Zt++]=255&me;Zt=0,_e()}function pe(){if(Pt==null){for(_e(),(Pt=new et).init(Ut),Zt=0;Zt<Ut.length;++Zt)Ut[Zt]=0;Zt=0}return Pt.next()}function ge(){}function Dt(a,u){return new tt(a,u)}function Nt(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function ie(a,u){this.x=u,this.q=a}function ee(a,u,p,g){this.curve=a,this.x=u,this.y=p,this.z=g??tt.ONE,this.zinv=null}function Kt(a,u,p){this.q=a,this.a=this.fromBigInteger(u),this.b=this.fromBigInteger(p),this.infinity=new ee(this,null,null)}ge.prototype.nextBytes=function(a){var u;for(u=0;u<a.length;++u)a[u]=pe()},Nt.prototype.doPublic=function(a){return a.modPowInt(this.e,this.n)},Nt.prototype.setPublic=function(a,u){if(this.isPublic=!0,this.isPrivate=!1,typeof a!="string")this.n=a,this.e=u;else{if(!(a!=null&&u!=null&&a.length>0&&u.length>0))throw"Invalid RSA public key";this.n=Dt(a,16),this.e=parseInt(u,16)}},Nt.prototype.type="RSA",Nt.prototype.doPrivate=function(a){if(this.p==null||this.q==null)return a.modPow(this.d,this.n);for(var u=a.mod(this.p).modPow(this.dmp1,this.p),p=a.mod(this.q).modPow(this.dmq1,this.q);u.compareTo(p)<0;)u=u.add(this.p);return u.subtract(p).multiply(this.coeff).mod(this.p).multiply(this.q).add(p)},Nt.prototype.setPrivate=function(a,u,p){if(this.isPrivate=!0,typeof a!="string")this.n=a,this.e=u,this.d=p;else{if(!(a!=null&&u!=null&&a.length>0&&u.length>0))throw"Invalid RSA private key";this.n=Dt(a,16),this.e=parseInt(u,16),this.d=Dt(p,16)}},Nt.prototype.setPrivateEx=function(a,u,p,g,m,w,F,R){if(this.isPrivate=!0,this.isPublic=!1,a==null)throw"RSASetPrivateEx N == null";if(u==null)throw"RSASetPrivateEx E == null";if(a.length==0)throw"RSASetPrivateEx N.length == 0";if(u.length==0)throw"RSASetPrivateEx E.length == 0";if(!(a!=null&&u!=null&&a.length>0&&u.length>0))throw"Invalid RSA private key in RSASetPrivateEx";this.n=Dt(a,16),this.e=parseInt(u,16),this.d=Dt(p,16),this.p=Dt(g,16),this.q=Dt(m,16),this.dmp1=Dt(w,16),this.dmq1=Dt(F,16),this.coeff=Dt(R,16)},Nt.prototype.generate=function(a,u){var p=new ge,g=a>>1;this.e=parseInt(u,16);for(var m=new tt(u,16),w=a/2-100,F=tt.ONE.shiftLeft(w);;){for(;this.p=new tt(a-g,1,p),this.p.subtract(tt.ONE).gcd(m).compareTo(tt.ONE)!=0||!this.p.isProbablePrime(10););for(;this.q=new tt(g,1,p),this.q.subtract(tt.ONE).gcd(m).compareTo(tt.ONE)!=0||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var R=this.p;this.p=this.q,this.q=R}var P=this.q.subtract(this.p).abs();if(!(P.bitLength()<w||P.compareTo(F)<=0)){var B=this.p.subtract(tt.ONE),K=this.q.subtract(tt.ONE),L=B.multiply(K);if(L.gcd(m).compareTo(tt.ONE)==0&&(this.n=this.p.multiply(this.q),this.n.bitLength()==a)){this.d=m.modInverse(L),this.dmp1=this.d.mod(B),this.dmq1=this.d.mod(K),this.coeff=this.q.modInverse(this.p);break}}}this.isPrivate=!0},ie.prototype.equals=function(a){return a==this||this.q.equals(a.q)&&this.x.equals(a.x)},ie.prototype.toBigInteger=function(){return this.x},ie.prototype.negate=function(){return new ie(this.q,this.x.negate().mod(this.q))},ie.prototype.add=function(a){return new ie(this.q,this.x.add(a.toBigInteger()).mod(this.q))},ie.prototype.subtract=function(a){return new ie(this.q,this.x.subtract(a.toBigInteger()).mod(this.q))},ie.prototype.multiply=function(a){return new ie(this.q,this.x.multiply(a.toBigInteger()).mod(this.q))},ie.prototype.square=function(){return new ie(this.q,this.x.square().mod(this.q))},ie.prototype.divide=function(a){return new ie(this.q,this.x.multiply(a.toBigInteger().modInverse(this.q)).mod(this.q))},ie.prototype.sqrt=function(){return new ie(this.q,this.x.sqrt().mod(this.q))},ee.prototype.getX=function(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},ee.prototype.getY=function(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},ee.prototype.equals=function(a){return a==this||(this.isInfinity()?a.isInfinity():a.isInfinity()?this.isInfinity():!!a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q).equals(tt.ZERO)&&a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q).equals(tt.ZERO))},ee.prototype.isInfinity=function(){return this.x==null&&this.y==null||this.z.equals(tt.ZERO)&&!this.y.toBigInteger().equals(tt.ZERO)},ee.prototype.negate=function(){return new ee(this.curve,this.x,this.y.negate(),this.z)},ee.prototype.add=function(a){if(this.isInfinity())return a;if(a.isInfinity())return this;var u=a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q),p=a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q);if(tt.ZERO.equals(p))return tt.ZERO.equals(u)?this.twice():this.curve.getInfinity();var g=new tt("3"),m=this.x.toBigInteger(),w=this.y.toBigInteger(),F=(a.x.toBigInteger(),a.y.toBigInteger(),p.square()),R=F.multiply(p),P=m.multiply(F),B=u.square().multiply(this.z),K=B.subtract(P.shiftLeft(1)).multiply(a.z).subtract(R).multiply(p).mod(this.curve.q),L=P.multiply(g).multiply(u).subtract(w.multiply(R)).subtract(B.multiply(u)).multiply(a.z).add(u.multiply(R)).mod(this.curve.q),O=R.multiply(this.z).multiply(a.z).mod(this.curve.q);return new ee(this.curve,this.curve.fromBigInteger(K),this.curve.fromBigInteger(L),O)},ee.prototype.twice=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var a=new tt("3"),u=this.x.toBigInteger(),p=this.y.toBigInteger(),g=p.multiply(this.z),m=g.multiply(p).mod(this.curve.q),w=this.curve.a.toBigInteger(),F=u.square().multiply(a);tt.ZERO.equals(w)||(F=F.add(this.z.square().multiply(w)));var R=(F=F.mod(this.curve.q)).square().subtract(u.shiftLeft(3).multiply(m)).shiftLeft(1).multiply(g).mod(this.curve.q),P=F.multiply(a).multiply(u).subtract(m.shiftLeft(1)).shiftLeft(2).multiply(m).subtract(F.square().multiply(F)).mod(this.curve.q),B=g.square().multiply(g).shiftLeft(3).mod(this.curve.q);return new ee(this.curve,this.curve.fromBigInteger(R),this.curve.fromBigInteger(P),B)},ee.prototype.multiply=function(a){if(this.isInfinity())return this;if(a.signum()==0)return this.curve.getInfinity();var u,p=a,g=p.multiply(new tt("3")),m=this.negate(),w=this,F=this.curve.q.subtract(a),R=F.multiply(new tt("3")),P=new ee(this.curve,this.x,this.y),B=P.negate();for(u=g.bitLength()-2;u>0;--u){w=w.twice();var K=g.testBit(u);K!=p.testBit(u)&&(w=w.add(K?this:m))}for(u=R.bitLength()-2;u>0;--u){P=P.twice();var L=R.testBit(u);L!=F.testBit(u)&&(P=P.add(L?P:B))}return w},ee.prototype.multiplyTwo=function(a,u,p){var g;g=a.bitLength()>p.bitLength()?a.bitLength()-1:p.bitLength()-1;for(var m=this.curve.getInfinity(),w=this.add(u);g>=0;)m=m.twice(),a.testBit(g)?m=p.testBit(g)?m.add(w):m.add(this):p.testBit(g)&&(m=m.add(u)),--g;return m},Kt.prototype.getQ=function(){return this.q},Kt.prototype.getA=function(){return this.a},Kt.prototype.getB=function(){return this.b},Kt.prototype.equals=function(a){return a==this||this.q.equals(a.q)&&this.a.equals(a.a)&&this.b.equals(a.b)},Kt.prototype.getInfinity=function(){return this.infinity},Kt.prototype.fromBigInteger=function(a){return new ie(this.q,a)},Kt.prototype.decodePointHex=function(a){switch(parseInt(a.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var u=a.substr(0,2),p=(a.substr(2),this.fromBigInteger(new tt(R,16))),g=this.getA(),m=this.getB(),w=p.square().add(g).multiply(p).add(m).sqrt();return u=="03"&&(w=w.negate()),new ee(this,p,w);case 4:case 6:case 7:var F=(a.length-2)/2,R=a.substr(2,F),P=a.substr(F+2,F);return new ee(this,this.fromBigInteger(new tt(R,16)),this.fromBigInteger(new tt(P,16)));default:return null}},ie.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},ee.prototype.getEncoded=function(a){var u=function(w,F){var R=w.toByteArrayUnsigned();if(F<R.length)R=R.slice(R.length-F);else for(;F>R.length;)R.unshift(0);return R},p=this.getX().toBigInteger(),g=this.getY().toBigInteger(),m=u(p,32);return a?g.isEven()?m.unshift(2):m.unshift(3):(m.unshift(4),m=m.concat(u(g,32))),m},ee.decodeFrom=function(a,u){u[0];var p=u.length-1,g=u.slice(1,1+p/2),m=u.slice(1+p/2,1+p);g.unshift(0),m.unshift(0);var w=new tt(g),F=new tt(m);return new ee(a,a.fromBigInteger(w),a.fromBigInteger(F))},ee.decodeFromHex=function(a,u){u.substr(0,2);var p=u.length-2,g=u.substr(2,p/2),m=u.substr(2+p/2,p/2),w=new tt(g,16),F=new tt(m,16);return new ee(a,a.fromBigInteger(w),a.fromBigInteger(F))},ee.prototype.add2D=function(a){if(this.isInfinity())return a;if(a.isInfinity())return this;if(this.x.equals(a.x))return this.y.equals(a.y)?this.twice():this.curve.getInfinity();var u=a.x.subtract(this.x),p=a.y.subtract(this.y).divide(u),g=p.square().subtract(this.x).subtract(a.x),m=p.multiply(this.x.subtract(g)).subtract(this.y);return new ee(this.curve,g,m)},ee.prototype.twice2D=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var a=this.curve.fromBigInteger(tt.valueOf(2)),u=this.curve.fromBigInteger(tt.valueOf(3)),p=this.x.square().multiply(u).add(this.curve.a).divide(this.y.multiply(a)),g=p.square().subtract(this.x.multiply(a)),m=p.multiply(this.x.subtract(g)).subtract(this.y);return new ee(this.curve,g,m)},ee.prototype.multiply2D=function(a){if(this.isInfinity())return this;if(a.signum()==0)return this.curve.getInfinity();var u,p=a,g=p.multiply(new tt("3")),m=this.negate(),w=this;for(u=g.bitLength()-2;u>0;--u){w=w.twice();var F=g.testBit(u);F!=p.testBit(u)&&(w=w.add2D(F?this:m))}return w},ee.prototype.isOnCurve=function(){var a=this.getX().toBigInteger(),u=this.getY().toBigInteger(),p=this.curve.getA().toBigInteger(),g=this.curve.getB().toBigInteger(),m=this.curve.getQ(),w=u.multiply(u).mod(m),F=a.multiply(a).multiply(a).add(p.multiply(a)).add(g).mod(m);return w.equals(F)},ee.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},ee.prototype.validate=function(){var a=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var u=this.getX().toBigInteger(),p=this.getY().toBigInteger();if(u.compareTo(tt.ONE)<0||u.compareTo(a.subtract(tt.ONE))>0)throw new Error("x coordinate out of bounds");if(p.compareTo(tt.ONE)<0||p.compareTo(a.subtract(tt.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(a).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var be=function(){var a=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),u=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),p={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function g(F,R,P){return R?p[R]:String.fromCharCode(parseInt(P,16))}var m=new String(""),w=Object.hasOwnProperty;return function(F,R){var P,B,K=F.match(a),L=K[0],O=!1;L==="{"?P={}:L==="["?P=[]:(P=[],O=!0);for(var U=[P],W=1-O,Y=K.length;W<Y;++W){var st;switch((L=K[W]).charCodeAt(0)){default:(st=U[0])[B||st.length]=+L,B=void 0;break;case 34:if((L=L.substring(1,L.length-1)).indexOf("\\")!==-1&&(L=L.replace(u,g)),st=U[0],!B){if(!(st instanceof Array)){B=L||m;break}B=st.length}st[B]=L,B=void 0;break;case 91:st=U[0],U.unshift(st[B||st.length]=[]),B=void 0;break;case 93:U.shift();break;case 102:(st=U[0])[B||st.length]=!1,B=void 0;break;case 110:(st=U[0])[B||st.length]=null,B=void 0;break;case 116:(st=U[0])[B||st.length]=!0,B=void 0;break;case 123:st=U[0],U.unshift(st[B||st.length]={}),B=void 0;break;case 125:U.shift()}}if(O){if(U.length!==1)throw new Error;P=P[0]}else if(U.length)throw new Error;if(R){var vt=function(At,Mt){var Bt=At[Mt];if(Bt&&typeof Bt=="object"){var Q=null;for(var ut in Bt)if(w.call(Bt,ut)&&Bt!==At){var pt=vt(Bt,ut);pt!==void 0?Bt[ut]=pt:(Q||(Q=[]),Q.push(ut))}if(Q)for(var it=Q.length;--it>=0;)delete Bt[Q[it]]}return R.call(At,Mt,Bt)};P=vt({"":P},"")}return P}}();v!==void 0&&v||(v={}),v.asn1!==void 0&&v.asn1||(v.asn1={}),v.asn1.ASN1Util=new function(){this.integerToByteHex=function(a){var u=a.toString(16);return u.length%2==1&&(u="0"+u),u},this.bigIntToMinTwosComplementsHex=function(a){return Ge(a)},this.getPEMStringFromHex=function(a,u){return Xe(a,u)},this.newObject=function(a){var u=v.asn1,p=u.ASN1Object,g=u.DERBoolean,m=u.DERInteger,w=u.DERBitString,F=u.DEROctetString,R=u.DERNull,P=u.DERObjectIdentifier,B=u.DEREnumerated,K=u.DERUTF8String,L=u.DERNumericString,O=u.DERPrintableString,U=u.DERTeletexString,W=u.DERIA5String,Y=u.DERUTCTime,st=u.DERGeneralizedTime,vt=u.DERVisibleString,At=u.DERBMPString,Mt=u.DERSequence,Bt=u.DERSet,Q=u.DERTaggedObject,ut=u.ASN1Util.newObject;if(a instanceof u.ASN1Object)return a;var pt=Object.keys(a);if(pt.length!=1)throw new Error("key of param shall be only one.");var it=pt[0];if(":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+it+":")==-1)throw new Error("undefined key: "+it);if(it=="bool")return new g(a[it]);if(it=="int")return new m(a[it]);if(it=="bitstr")return new w(a[it]);if(it=="octstr")return new F(a[it]);if(it=="null")return new R(a[it]);if(it=="oid")return new P(a[it]);if(it=="enum")return new B(a[it]);if(it=="utf8str")return new K(a[it]);if(it=="numstr")return new L(a[it]);if(it=="prnstr")return new O(a[it]);if(it=="telstr")return new U(a[it]);if(it=="ia5str")return new W(a[it]);if(it=="utctime")return new Y(a[it]);if(it=="gentime")return new st(a[it]);if(it=="visstr")return new vt(a[it]);if(it=="bmpstr")return new At(a[it]);if(it=="asn1")return new p(a[it]);if(it=="seq"){for(var bt=a[it],$t=[],Wt=0;Wt<bt.length;Wt++){var Ht=ut(bt[Wt]);$t.push(Ht)}return new Mt({array:$t})}if(it=="set"){for(bt=a[it],$t=[],Wt=0;Wt<bt.length;Wt++)Ht=ut(bt[Wt]),$t.push(Ht);return new Bt({array:$t})}if(it=="tag"){var Se=a[it];if(Object.prototype.toString.call(Se)==="[object Array]"&&Se.length==3){var zt=ut(Se[2]);return new Q({tag:Se[0],explicit:Se[1],obj:zt})}return new Q(Se)}},this.jsonToASN1HEX=function(a){return this.newObject(a).tohex()}},v.asn1.ASN1Util.oidHexToInt=function(a){for(var u="",p=parseInt(a.substr(0,2),16),g=(u=Math.floor(p/40)+"."+p%40,""),m=2;m<a.length;m+=2){var w=("00000000"+parseInt(a.substr(m,2),16).toString(2)).slice(-8);g+=w.substr(1,7),w.substr(0,1)=="0"&&(u=u+"."+new tt(g,2).toString(10),g="")}return u},v.asn1.ASN1Util.oidIntToHex=function(a){var u=function(R){var P=R.toString(16);return P.length==1&&(P="0"+P),P},p=function(R){var P="",B=new tt(R,10).toString(2),K=7-B.length%7;K==7&&(K=0);for(var L="",O=0;O<K;O++)L+="0";for(B=L+B,O=0;O<B.length-1;O+=7){var U=B.substr(O,7);O!=B.length-7&&(U="1"+U),P+=u(parseInt(U,2))}return P};if(!a.match(/^[0-9.]+$/))throw"malformed oid string: "+a;var g="",m=a.split("."),w=40*parseInt(m[0])+parseInt(m[1]);g+=u(w),m.splice(0,2);for(var F=0;F<m.length;F++)g+=p(m[F]);return g},v.asn1.ASN1Object=function(a){this.params=null,this.getLengthHexFromValue=function(){if(this.hV===void 0||this.hV==null)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n=0,v="+this.hV);var u=this.hV.length/2,p=u.toString(16);if(p.length%2==1&&(p="0"+p),u<128)return p;var g=p.length/2;if(g>15)throw new Error("ASN.1 length too long to represent by 8x: n = "+u.toString(16));return(128+g).toString(16)+p},this.tohex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.getValueHex=function(){return this.tohex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(u){this.params=u},a!=null&&a.tlv!=null&&(this.hTLV=a.tlv,this.isModified=!1)},v.asn1.DERAbstractString=function(a){v.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(u){this.hTLV=null,this.isModified=!0,this.s=u,this.hV=Ir(this.s).toLowerCase()},this.setStringHex=function(u){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=u},this.getFreshValueHex=function(){return this.hV},a!==void 0&&(typeof a=="string"?this.setString(a):a.str!==void 0?this.setString(a.str):a.hex!==void 0&&this.setStringHex(a.hex))},Yt(v.asn1.DERAbstractString,v.asn1.ASN1Object),v.asn1.DERAbstractTime=function(a){v.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(u){var p=u.getTime()+6e4*u.getTimezoneOffset();return new Date(p)},this.formatDate=function(u,p,g){var m=this.zeroPadding,w=this.localDateToUTC(u),F=String(w.getFullYear());p=="utc"&&(F=F.substr(2,2));var R=F+m(String(w.getMonth()+1),2)+m(String(w.getDate()),2)+m(String(w.getHours()),2)+m(String(w.getMinutes()),2)+m(String(w.getSeconds()),2);if(g===!0){var P=w.getMilliseconds();if(P!=0){var B=m(String(P),3);R=R+"."+(B=B.replace(/[0]+$/,""))}}return R+"Z"},this.zeroPadding=function(u,p){return u.length>=p?u:new Array(p-u.length+1).join("0")+u},this.setByParam=function(u){this.hV=null,this.hTLV=null,this.params=u},this.getString=function(){},this.setString=function(u){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.str=u},this.setByDate=function(u){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.date=u},this.setByDateValue=function(u,p,g,m,w,F){var R=new Date(Date.UTC(u,p-1,g,m,w,F,0));this.setByDate(R)},this.getFreshValueHex=function(){return this.hV}},Yt(v.asn1.DERAbstractTime,v.asn1.ASN1Object),v.asn1.DERAbstractStructured=function(a){v.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(u){this.hTLV=null,this.isModified=!0,this.asn1Array=u},this.appendASN1Object=function(u){this.hTLV=null,this.isModified=!0,this.asn1Array.push(u)},this.asn1Array=new Array,a!==void 0&&a.array!==void 0&&(this.asn1Array=a.array)},Yt(v.asn1.DERAbstractStructured,v.asn1.ASN1Object),v.asn1.DERBoolean=function(a){v.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV=a==0?"010100":"0101ff"},Yt(v.asn1.DERBoolean,v.asn1.ASN1Object),v.asn1.DERInteger=function(a){v.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.params=null;var u=Ge;this.setByBigInteger=function(p){this.isModified=!0,this.params={bigint:p}},this.setByInteger=function(p){this.isModified=!0,this.params=p},this.setValueHex=function(p){this.isModified=!0,this.params={hex:p}},this.getFreshValueHex=function(){var p=this.params,g=null;if(p==null)throw new Error("value not set");if(typeof p=="object"&&p.hex!=null)return this.hV=p.hex,this.hV;if(typeof p=="number")g=new tt(String(p),10);else if(p.int!=null)g=new tt(String(p.int),10);else{if(p.bigint==null)throw new Error("wrong parameter");g=p.bigint}return this.hV=u(g),this.hV},a!=null&&(this.params=a)},Yt(v.asn1.DERInteger,v.asn1.ASN1Object),v.asn1.DERBitString=function(a){if(a!==void 0&&a.obj!==void 0){var u=v.asn1.ASN1Util.newObject(a.obj);a.hex="00"+u.tohex()}v.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(p){this.hTLV=null,this.isModified=!0,this.hV=p},this.setUnusedBitsAndHexValue=function(p,g){if(p<0||7<p)throw"unused bits shall be from 0 to 7: u = "+p;var m="0"+p;this.hTLV=null,this.isModified=!0,this.hV=m+g},this.setByBinaryString=function(p){var g=8-(p=p.replace(/0+$/,"")).length%8;g==8&&(g=0),p+="0000000".substr(0,g);for(var m="",w=0;w<p.length-1;w+=8){var F=p.substr(w,8),R=parseInt(F,2).toString(16);R.length==1&&(R="0"+R),m+=R}this.hTLV=null,this.isModified=!0,this.hV="0"+g+m},this.setByBooleanArray=function(p){for(var g="",m=0;m<p.length;m++)p[m]==1?g+="1":g+="0";this.setByBinaryString(g)},this.newFalseArray=function(p){for(var g=new Array(p),m=0;m<p;m++)g[m]=!1;return g},this.getFreshValueHex=function(){return this.hV},a!==void 0&&(typeof a=="string"&&a.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(a):a.hex!==void 0?this.setHexValueIncludingUnusedBits(a.hex):a.bin!==void 0?this.setByBinaryString(a.bin):a.array!==void 0&&this.setByBooleanArray(a.array))},Yt(v.asn1.DERBitString,v.asn1.ASN1Object),v.asn1.DEROctetString=function(a){if(a!==void 0&&a.obj!==void 0){var u=v.asn1.ASN1Util.newObject(a.obj);a.hex=u.tohex()}v.asn1.DEROctetString.superclass.constructor.call(this,a),this.hT="04"},Yt(v.asn1.DEROctetString,v.asn1.DERAbstractString),v.asn1.DERNull=function(){v.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},Yt(v.asn1.DERNull,v.asn1.ASN1Object),v.asn1.DERObjectIdentifier=function(a){v.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(u){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=u},this.setValueOidString=function(u){var p=xe(u);if(p==null)throw new Error("malformed oid string: "+u);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=p},this.setValueName=function(u){var p=v.asn1.x509.OID.name2oid(u);if(p==="")throw new Error("DERObjectIdentifier oidName undefined: "+u);this.setValueOidString(p)},this.setValueNameOrOid=function(u){u.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(u):this.setValueName(u)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(u){typeof u=="string"?this.setValueNameOrOid(u):u.oid!==void 0?this.setValueNameOrOid(u.oid):u.name!==void 0?this.setValueNameOrOid(u.name):u.hex!==void 0&&this.setValueHex(u.hex)},a!==void 0&&this.setByParam(a)},Yt(v.asn1.DERObjectIdentifier,v.asn1.ASN1Object),v.asn1.DEREnumerated=function(a){v.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(u){this.hTLV=null,this.isModified=!0,this.hV=Ge(u)},this.setByInteger=function(u){var p=new tt(String(u),10);this.setByBigInteger(p)},this.setValueHex=function(u){this.hV=u},this.getFreshValueHex=function(){return this.hV},a!==void 0&&(a.int!==void 0?this.setByInteger(a.int):typeof a=="number"?this.setByInteger(a):a.hex!==void 0&&this.setValueHex(a.hex))},Yt(v.asn1.DEREnumerated,v.asn1.ASN1Object),v.asn1.DERUTF8String=function(a){v.asn1.DERUTF8String.superclass.constructor.call(this,a),this.hT="0c"},Yt(v.asn1.DERUTF8String,v.asn1.DERAbstractString),v.asn1.DERNumericString=function(a){v.asn1.DERNumericString.superclass.constructor.call(this,a),this.hT="12"},Yt(v.asn1.DERNumericString,v.asn1.DERAbstractString),v.asn1.DERPrintableString=function(a){v.asn1.DERPrintableString.superclass.constructor.call(this,a),this.hT="13"},Yt(v.asn1.DERPrintableString,v.asn1.DERAbstractString),v.asn1.DERTeletexString=function(a){v.asn1.DERTeletexString.superclass.constructor.call(this,a),this.hT="14"},Yt(v.asn1.DERTeletexString,v.asn1.DERAbstractString),v.asn1.DERIA5String=function(a){v.asn1.DERIA5String.superclass.constructor.call(this,a),this.hT="16"},Yt(v.asn1.DERIA5String,v.asn1.DERAbstractString),v.asn1.DERVisibleString=function(a){v.asn1.DERIA5String.superclass.constructor.call(this,a),this.hT="1a"},Yt(v.asn1.DERVisibleString,v.asn1.DERAbstractString),v.asn1.DERBMPString=function(a){v.asn1.DERBMPString.superclass.constructor.call(this,a),this.hT="1e"},Yt(v.asn1.DERBMPString,v.asn1.DERAbstractString),v.asn1.DERUTCTime=function(a){v.asn1.DERUTCTime.superclass.constructor.call(this,a),this.hT="17",this.params=void 0,this.getFreshValueHex=function(){var u=this.params;if(this.params==null&&(u={date:new Date}),typeof u=="string"){if(!u.match(/^[0-9]{12}Z$/)&&!u.match(/^[0-9]{12}\.[0-9]+Z$/))throw new Error("malformed string for UTCTime: "+u);this.hV=nr(u)}else if(u.str!=null)this.hV=nr(u.str);else if(u.date==null&&u.millis==1){var p=new Date;this.hV=nr(this.formatDate(p,"utc",!0))}else if(u.date!=null&&u.date instanceof Date){var g=u.millis===!0;this.hV=nr(this.formatDate(u.date,"utc",g))}else u instanceof Date&&(this.hV=nr(this.formatDate(u,"utc")));if(this.hV==null)throw new Error("parameter not specified properly for UTCTime");return this.hV},a!=null&&this.setByParam(a)},Yt(v.asn1.DERUTCTime,v.asn1.DERAbstractTime),v.asn1.DERGeneralizedTime=function(a){v.asn1.DERGeneralizedTime.superclass.constructor.call(this,a),this.hT="18",this.params=a,this.getFreshValueHex=function(){var u=this.params;if(this.params==null&&(u={date:new Date}),typeof u=="string"){if(!u.match(/^[0-9]{14}Z$/)&&!u.match(/^[0-9]{14}\.[0-9]+Z$/))throw new Error("malformed string for GeneralizedTime: "+u);this.hV=nr(u)}else if(u.str!=null)this.hV=nr(u.str);else if(u.date==null&&u.millis==1){var p=new Date;this.hV=nr(this.formatDate(p,"gen",!0))}else if(u.date!=null&&u.date instanceof Date){var g=u.millis===!0;this.hV=nr(this.formatDate(u.date,"gen",g))}else u instanceof Date&&(this.hV=nr(this.formatDate(u,"gen")));if(this.hV==null)throw new Error("parameter not specified properly for GeneralizedTime");return this.hV},a!=null&&this.setByParam(a)},Yt(v.asn1.DERGeneralizedTime,v.asn1.DERAbstractTime),v.asn1.DERSequence=function(a){v.asn1.DERSequence.superclass.constructor.call(this,a),this.hT="30",this.getFreshValueHex=function(){for(var u="",p=0;p<this.asn1Array.length;p++)u+=this.asn1Array[p].tohex();return this.hV=u,this.hV}},Yt(v.asn1.DERSequence,v.asn1.DERAbstractStructured),v.asn1.DERSet=function(a){v.asn1.DERSet.superclass.constructor.call(this,a),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var u=new Array,p=0;p<this.asn1Array.length;p++){var g=this.asn1Array[p];u.push(g.tohex())}return this.sortFlag==1&&u.sort(),this.hV=u.join(""),this.hV},a!==void 0&&a.sortflag!==void 0&&a.sortflag==0&&(this.sortFlag=!1)},Yt(v.asn1.DERSet,v.asn1.DERAbstractStructured),v.asn1.DERTaggedObject=function(a){v.asn1.DERTaggedObject.superclass.constructor.call(this);var u=v.asn1,p=Vt,g=p.getV,m=(p.isASN1HEX,u.ASN1Util.newObject);this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.params={tag:"a0",explicit:!0},this.setASN1Object=function(w,F,R){this.params={tag:F,explicit:w,obj:R}},this.getFreshValueHex=function(){var w=this.params;if(w.explicit==null&&(w.explicit=!0),w.tage!=null&&(w.tag=w.tage,w.explicit=!0),w.tagi!=null&&(w.tag=w.tagi,w.explicit=!1),w.str!=null)this.hV=Ir(w.str);else if(w.hex!=null)this.hV=w.hex;else{if(w.obj==null)throw new Error("str, hex nor obj not specified");var F;w.obj instanceof u.ASN1Object?F=w.obj.tohex():typeof w.obj=="object"&&(F=m(w.obj).tohex()),w.explicit?this.hV=F:this.hV=g(F,0)}return w.tag==null&&(w.tag="a0"),this.hT=w.tag,this.hTLV=null,this.isModified=!0,this.hV},this.setByParam=function(w){this.params=w},a!==void 0&&this.setByParam(a)},Yt(v.asn1.DERTaggedObject,v.asn1.ASN1Object);var v,Be,ce,Vt=new function(){};function ze(a){for(var u=new Array,p=0;p<a.length;p++)u[p]=a.charCodeAt(p);return u}function We(a){for(var u="",p=0;p<a.length;p++)u+=String.fromCharCode(a[p]);return u}function Je(a){for(var u="",p=0;p<a.length;p++){var g=a[p].toString(16);g.length==1&&(g="0"+g),u+=g}return u}function nr(a){return Je(ze(a))}function lr(a){return(a=(a=a.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function ur(a){return a.length%4==2?a+="==":a.length%4==3&&(a+="="),(a=a.replace(/-/g,"+")).replace(/_/g,"/")}function Me(a){return a.length%2==1&&(a="0"+a),lr(at(a))}function Ke(a){return ct(ur(a))}function Ir(a){return Yr(Ar(a)).toLowerCase()}function Le(a){try{return decodeURIComponent(Xr(a))}catch{return null}}function qr(a){return Le(function(u){for(var p=u.match(/.{1,2}/g),g=[],m=0;m<p.length;m++){var w=parseInt(p[m],16);161<=w&&w<=191?(g.push("c2"),g.push(p[m])):192<=w&&w<=255?(g.push("c3"),g.push((w-64).toString(16))):g.push(p[m])}return g.join("")}(a))}function hr(a){for(var u="",p=0;p<a.length-1;p+=2)u+=String.fromCharCode(parseInt(a.substr(p,2),16));return u}function Sr(a){for(var u="",p=0;p<a.length;p++)u+=("0"+a.charCodeAt(p).toString(16)).slice(-2);return u}function Jr(a){return at(a)}function Kr(a,u){return(a=a.replace(new RegExp("(.{"+u+"})","g"),`$1\r
`)).replace(/\s+$/,"")}function tr(a){return ct(a.replace(/[^0-9A-Za-z\/+=]*/g,""))}function Xe(a,u){return"-----BEGIN "+u+`-----\r
`+Kr(Jr(a),64)+`\r
-----END `+u+`-----\r
`}function Qe(a,u){if(a.indexOf("-----BEGIN ")==-1)throw new Error("can't find PEM header");return tr(a=u!==void 0?(a=a.replace(new RegExp("^[^]*-----BEGIN "+u+"-----"),"")).replace(new RegExp("-----END "+u+"-----[^]*$"),""):(a=a.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,""))}function an(a){var u,p,g,m,w,F,R,P,B,K;if(K=(a=Vr(a)).match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return u=parseInt(K[1]),p=parseInt(K[2])-1,g=parseInt(K[3]),m=parseInt(K[4]),w=parseInt(K[5]),F=parseInt(K[6]),R=0,(P=K[7])!==""&&(B=(P.substr(1)+"00").substr(0,3),R=parseInt(B)),Date.UTC(u,p,g,m,w,F,R);throw new Error("unsupported zulu format: "+a)}function Gr(a){return Math.round(an(a)/1e3)}function Vr(a){return a.match(/^[0-9]{12}Z$/)||a.match(/^[0-9]{12}[.][0-9]*Z$/)?a.match(/^[0-4]/)?"20"+a:"19"+a:a}function Yr(a){return a.replace(/%/g,"")}function Xr(a){return a.replace(/(..)/g,"%$1")}function sn(a){var u="malformed IPv6 address";if(!a.match(/^[0-9A-Fa-f:]+$/))throw u;var p=(a=a.toLowerCase()).split(":").length-1;if(p<2)throw u;var g=":".repeat(7-p+2),m=(a=a.replace("::",g)).split(":");if(m.length!=8)throw u;for(var w=0;w<8;w++)m[w]=("0000"+m[w]).slice(-4);return m.join("")}function se(a){if(!a.match(/^[0-9A-Fa-f]{32}$/))throw new Error("malformed IPv6 address: "+a);var u=(a=a.toLowerCase()).match(/.{1,4}/g),p=(a=":"+(u=(u=u.map(function(m){return m.replace(/^0+/,"")})).map(function(m){return m==""?"0":m})).join(":")+":").match(/:(0:){2,}/g);if(p==null)return a.slice(1,-1);var g=p.sort().slice(-1)[0];return(a=a.replace(g.substr(0,g.length-1),":")).substr(0,2)!="::"&&(a=a.substr(1)),a.substr(-2,2)!="::"&&(a=a.substr(0,a.length-1)),a}function ye(a){var u=new Error("malformed hex value");if(!a.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw u;if(a.length==8)try{return parseInt(a.substr(0,2),16)+"."+parseInt(a.substr(2,2),16)+"."+parseInt(a.substr(4,2),16)+"."+parseInt(a.substr(6,2),16)}catch{throw u}else{if(a.length!=16){if(a.length==32)return se(a);if(a.length==64){try{return se(a.substr(0,32))+"/"+Re(a.substr(32))}catch{throw u}return}return a}try{return ye(a.substr(0,8))+"/"+Re(a.substr(8))}catch{throw u}}}function Re(a){var u,p=new Error("malformed mask");try{u=new tt(a,16).toString(2)}catch{throw p}if(!u.match(/^1*0*$/))throw p;return u.replace(/0+$/,"").length}function ar(a){var u=new Error("malformed IP address");if(!(a=a.toLowerCase(a)).match(/^[0-9a-f.:/]+$/))throw u;if(!a.match(/^[0-9.]+$/)){var p;if(a.match(/^[0-9.]+\/[0-9]+$/))return ar((p=a.split("/"))[0])+he(parseInt(p[1]),32);if(a.match(/^[0-9a-f:]+$/)&&a.indexOf(":")!==-1)return sn(a);if(a.match(/^[0-9a-f:]+\/[0-9]+$/)&&a.indexOf(":")!==-1)return sn((p=a.split("/"))[0])+he(parseInt(p[1]),128);throw u}var g=a.split(".");if(g.length!==4)throw u;var m="";try{for(var w=0;w<4;w++)m+=("0"+parseInt(g[w]).toString(16)).slice(-2);return m}catch{throw u}}function he(a,u){return u==32&&a==0?"00000000":u==128&&a==0?"00000000000000000000000000000000":new tt(Array(a+1).join("1")+Array(u-a+1).join("0"),2).toString(16)}function Zr(a){return a.match(/.{4}/g).map(function(u){var p=parseInt(u.substr(0,2),16),g=parseInt(u.substr(2),16);if(p==0&g<128)return String.fromCharCode(g);if(p<8){var m=128|63&g;return Le((192|(7&p)<<3|(192&g)>>6).toString(16)+m.toString(16))}m=128|(15&p)<<2|(192&g)>>6;var w=128|63&g;return Le((224|(240&p)>>4).toString(16)+m.toString(16)+w.toString(16))}).join("")}function Ar(a){for(var u=encodeURIComponent(a),p="",g=0;g<u.length;g++)u[g]=="%"?(p+=u.substr(g,3),g+=2):p=p+"%"+nr(u[g]);return p}function un(a){return!(a.length%2!=0||!a.match(/^[0-9a-f]+$/)&&!a.match(/^[0-9A-F]+$/))}function or(a){return!!a.match(/^[0-9A-Za-z-_.]+$/)}function J(a){return a.length%2==1?"0"+a:a.substr(0,1)>"7"?"00"+a:a}function xe(a){var u=function(R){var P=R.toString(16);return P.length==1&&(P="0"+P),P},p=function(R){var P="",B=parseInt(R,10).toString(2),K=7-B.length%7;K==7&&(K=0);for(var L="",O=0;O<K;O++)L+="0";for(B=L+B,O=0;O<B.length-1;O+=7){var U=B.substr(O,7);O!=B.length-7&&(U="1"+U),P+=u(parseInt(U,2))}return P};try{if(!a.match(/^[0-9.]+$/))return null;var g="",m=a.split("."),w=40*parseInt(m[0],10)+parseInt(m[1],10);g+=u(w),m.splice(0,2);for(var F=0;F<m.length;F++)g+=p(m[F]);return g}catch{return null}}function Tr(a){if(!un(a))return null;try{var u=[],p=a.substr(0,2),g=parseInt(p,16);u[0]=new String(Math.floor(g/40)),u[1]=new String(g%40);for(var m=a.substr(2),w=[],F=0;F<m.length/2;F++)w.push(parseInt(m.substr(2*F,2),16));var R=[],P="";for(F=0;F<w.length;F++)128&w[F]?P+=Lt((127&w[F]).toString(2),7):(P+=Lt((127&w[F]).toString(2),7),R.push(new String(parseInt(P,2))),P="");var B=u.join(".");return R.length>0&&(B=B+"."+R.join(".")),B}catch{return null}}function gr(a){return Ge(new tt(String(a),10))}function Ge(a){var u=a.toString(16);if(u.substr(0,1)!="-")return u.length%2==1?u="0"+u:u.match(/^[0-7]/)||(u="00"+u),u;var p=u.substr(1).length;p%2==1?p+=1:u.match(/^[0-7]/)||(p+=2);for(var g="",m=0;m<p;m++)g+="f";return new tt(g,16).xor(a).add(tt.ONE).toString(16).replace(/^-/,"")}Vt.getLblen=function(a,u){if(a.substr(u+2,1)!="8")return 1;var p=parseInt(a.substr(u+3,1));return p==0?-1:0<p&&p<10?p+1:-2},Vt.getL=function(a,u){var p=Vt.getLblen(a,u);return p<1?"":a.substr(u+2,2*p)},Vt.getVblen=function(a,u){var p;return(p=Vt.getL(a,u))==""?-1:(p.substr(0,1)==="8"?new tt(p.substr(2),16):new tt(p,16)).intValue()},Vt.getVidx=function(a,u){var p=Vt.getLblen(a,u);return p<0?p:u+2*(p+1)},Vt.getV=function(a,u){var p=Vt.getVidx(a,u),g=Vt.getVblen(a,u);return a.substr(p,2*g)},Vt.getTLV=function(a,u){return a.substr(u,2)+Vt.getL(a,u)+Vt.getV(a,u)},Vt.getTLVblen=function(a,u){return 2+2*Vt.getLblen(a,u)+2*Vt.getVblen(a,u)},Vt.getNextSiblingIdx=function(a,u){return Vt.getVidx(a,u)+2*Vt.getVblen(a,u)},Vt.getChildIdx=function(a,u){var p,g,m,w=Vt,F=[];p=w.getVidx(a,u),g=2*w.getVblen(a,u),a.substr(u,2)=="03"&&(p+=2,g-=2),m=0;for(var R=p;m<=g;){var P=w.getTLVblen(a,R);if((m+=P)<=g&&F.push(R),R+=P,m>=g)break}return F},Vt.getNthChildIdx=function(a,u,p){return Vt.getChildIdx(a,u)[p]},Vt.getIdxbyList=function(a,u,p,g){var m,w,F=Vt;return p.length==0?g!==void 0&&a.substr(u,2)!==g?-1:u:(m=p.shift())>=(w=F.getChildIdx(a,u)).length?-1:F.getIdxbyList(a,w[m],p,g)},Vt.getIdxbyListEx=function(a,u,p,g){var m,w,F=Vt;if(p.length==0)return g!==void 0&&a.substr(u,2)!==g?-1:u;m=p.shift(),w=F.getChildIdx(a,u);for(var R=0,P=0;P<w.length;P++){var B=a.substr(w[P],2);if(typeof m=="number"&&!F.isContextTag(B)&&R==m||typeof m=="string"&&F.isContextTag(B,m))return F.getIdxbyListEx(a,w[P],p,g);F.isContextTag(B)||R++}return-1},Vt.getTLVbyList=function(a,u,p,g){var m=Vt,w=m.getIdxbyList(a,u,p,g);return w==-1||w>=a.length?null:m.getTLV(a,w)},Vt.getTLVbyListEx=function(a,u,p,g){var m=Vt,w=m.getIdxbyListEx(a,u,p,g);return w==-1?null:m.getTLV(a,w)},Vt.getVbyList=function(a,u,p,g,m){var w,F,R=Vt;return(w=R.getIdxbyList(a,u,p,g))==-1||w>=a.length?null:(F=R.getV(a,w),m===!0&&(F=F.substr(2)),F)},Vt.getVbyListEx=function(a,u,p,g,m){var w,F,R=Vt;return(w=R.getIdxbyListEx(a,u,p,g))==-1?null:(F=R.getV(a,w),a.substr(w,2)=="03"&&m!==!1&&(F=F.substr(2)),F)},Vt.getInt=function(a,u,p){p==null&&(p=-1);try{var g=a.substr(u,2);if(g!="02"&&g!="03")return p;var m=Vt.getV(a,u);return g=="02"?parseInt(m,16):sr(m)}catch{return p}},Vt.getOID=function(a,u,p){p==null&&(p=null);try{return a.substr(u,2)!="06"?p:Tr(Vt.getV(a,u))}catch{return p}},Vt.getOIDName=function(a,u,p){p==null&&(p=null);try{var g=Vt.getOID(a,u,p);if(g==p)return p;var m=v.asn1.x509.OID.oid2name(g);return m==""?g:m}catch{return p}},Vt.getString=function(a,u,p){p==null&&(p=null);try{return hr(Vt.getV(a,u))}catch{return p}},Vt.hextooidstr=function(a){var u=function(L,O){return L.length>=O?L:new Array(O-L.length+1).join("0")+L},p=[],g=a.substr(0,2),m=parseInt(g,16);p[0]=new String(Math.floor(m/40)),p[1]=new String(m%40);for(var w=a.substr(2),F=[],R=0;R<w.length/2;R++)F.push(parseInt(w.substr(2*R,2),16));var P=[],B="";for(R=0;R<F.length;R++)128&F[R]?B+=u((127&F[R]).toString(2),7):(B+=u((127&F[R]).toString(2),7),P.push(new String(parseInt(B,2))),B="");var K=p.join(".");return P.length>0&&(K=K+"."+P.join(".")),K},Vt.dump=function(a,u,p,g){var m=Vt,w=m.getV,F=m.dump,R=m.getChildIdx,P=a;a instanceof v.asn1.ASN1Object&&(P=a.tohex());var B=function(pt,it){return pt.length<=2*it?pt:pt.substr(0,it)+"..(total "+pt.length/2+"bytes).."+pt.substr(pt.length-it,it)};u===void 0&&(u={ommit_long_octet:32}),p===void 0&&(p=0),g===void 0&&(g="");var K,L=u.ommit_long_octet;if((K=P.substr(p,2))=="01")return(O=w(P,p))=="00"?g+`BOOLEAN FALSE
`:g+`BOOLEAN TRUE
`;if(K=="02")return g+"INTEGER "+B(O=w(P,p),L)+`
`;if(K=="03"){var O=w(P,p);return m.isASN1HEX(O.substr(2))?(Q=g+`BITSTRING, encapsulates
`)+F(O.substr(2),u,0,g+"  "):g+"BITSTRING "+B(O,L)+`
`}if(K=="04")return O=w(P,p),m.isASN1HEX(O)?(Q=g+`OCTETSTRING, encapsulates
`)+F(O,u,0,g+"  "):g+"OCTETSTRING "+B(O,L)+`
`;if(K=="05")return g+`NULL
`;if(K=="06"){var U=w(P,p),W=v.asn1.ASN1Util.oidHexToInt(U),Y=v.asn1.x509.OID.oid2name(W),st=W.replace(/\./g," ");return Y!=""?g+"ObjectIdentifier "+Y+" ("+st+`)
`:g+"ObjectIdentifier ("+st+`)
`}if(K=="0a")return g+"ENUMERATED "+parseInt(w(P,p))+`
`;if(K=="0c")return g+"UTF8String '"+Le(w(P,p))+`'
`;if(K=="13")return g+"PrintableString '"+Le(w(P,p))+`'
`;if(K=="14")return g+"TeletexString '"+Le(w(P,p))+`'
`;if(K=="16")return g+"IA5String '"+Le(w(P,p))+`'
`;if(K=="17")return g+"UTCTime "+Le(w(P,p))+`
`;if(K=="18")return g+"GeneralizedTime "+Le(w(P,p))+`
`;if(K=="1a")return g+"VisualString '"+Le(w(P,p))+`'
`;if(K=="1e")return g+"BMPString '"+Zr(w(P,p))+`'
`;if(K=="30"){if(P.substr(p,4)=="3000")return g+`SEQUENCE {}
`;Q=g+`SEQUENCE
`;var vt=u;if(((Bt=R(P,p)).length==2||Bt.length==3)&&P.substr(Bt[0],2)=="06"&&P.substr(Bt[Bt.length-1],2)=="04"){Y=m.oidname(w(P,Bt[0]));var At=JSON.parse(JSON.stringify(u));At.x509ExtName=Y,vt=At}for(var Mt=0;Mt<Bt.length;Mt++)Q+=F(P,vt,Bt[Mt],g+"  ");return Q}if(K=="31"){Q=g+`SET
`;var Bt=R(P,p);for(Mt=0;Mt<Bt.length;Mt++)Q+=F(P,u,Bt[Mt],g+"  ");return Q}if(128&(K=parseInt(K,16))){var Q,ut=31&K;if(32&K){for(Q=g+"["+ut+`]
`,Bt=R(P,p),Mt=0;Mt<Bt.length;Mt++)Q+=F(P,u,Bt[Mt],g+"  ");return Q}return O=w(P,p),Vt.isASN1HEX(O)?(Q=g+"["+ut+`]
`)+F(O,u,0,g+"  "):((O.substr(0,8)=="68747470"||u.x509ExtName==="subjectAltName"&&ut==2)&&(O=Le(O)),g+"["+ut+"] "+O+`
`)}return g+"UNKNOWN("+K+") "+w(P,p)+`
`},Vt.parse=function(a){var u=Vt,p=u.parse,g=u.isASN1HEX,m=u.getV,w=u.getTLV,F=u.getChildIdx,R=v.asn1,P=R.ASN1Util.oidHexToInt,B=R.x509.OID.oid2name,K=Le,L=Zr,O=qr,U={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"},W=a.substr(0,2),Y={},st=m(a,0);if(W=="01")return a=="0101ff"?{bool:!0}:{bool:!1};if(W=="02")return{int:{hex:st}};if(W=="03")try{if(st.substr(0,2)!="00")throw"not encap";var vt=st.substr(2);if(!g(vt))throw"not encap";return{bitstr:{obj:p(vt)}}}catch{var At=null;return st.length<=10&&(At=Ie(st)),At==null?{bitstr:{hex:st}}:{bitstr:{bin:At}}}else if(W=="04")try{if(!g(st))throw"not encap";return{octstr:{obj:p(st)}}}catch{return{octstr:{hex:st}}}else{if(W=="05")return{null:""};if(W=="06"){var Mt=P(st),Bt=B(Mt);return Bt==""?{oid:Mt}:{oid:Bt}}if(W=="0a")return st.length>4?{enum:{hex:st}}:{enum:parseInt(st,16)};if(W=="30"||W=="31")return Y[U[W]]=function(pt){for(var it=[],bt=F(pt,0),$t=0;$t<bt.length;$t++){var Wt=bt[$t],Ht=w(pt,Wt),Se=p(Ht);it.push(Se)}return it}(a),Y;if(W=="14"){var Q=O(st);return Y[U[W]]={str:Q},Y}if(W=="1e")return Q=L(st),Y[U[W]]={str:Q},Y;if(":0c:12:13:16:17:18:1a:".indexOf(W)!=-1)return Q=K(st),Y[U[W]]={str:Q},Y;if(W.match(/^8[0-9]$/))return(Q=K(st))==null|Q==""||Q.match(/[\x00-\x1F\x7F-\x9F]/)!=null||Q.match(/[\u0000-\u001F\u0080\u2013\u009F]/)!=null?{tag:{tag:W,explicit:!1,hex:st}}:{tag:{tag:W,explicit:!1,str:Q}};if(!W.match(/^a[0-9]$/)){var ut=new v.asn1.ASN1Object;return ut.hV=st,{asn1:{tlv:W+ut.getLengthHexFromValue()+st}}}try{if(!g(st))throw new Error("not encap");return{tag:{tag:W,explicit:!0,obj:p(st)}}}catch{return{tag:{tag:W,explicit:!0,hex:st}}}}},Vt.isContextTag=function(a,u){var p,g;a=a.toLowerCase();try{p=parseInt(a,16)}catch{return-1}if(u===void 0)return(192&p)==128;try{return u.match(/^\[[0-9]+\]$/)!=null&&!((g=parseInt(u.substr(1,u.length-1),10))>31)&&(192&p)==128&&(31&p)==g}catch{return!1}},Vt.isASN1HEX=function(a){var u=Vt;if(a.length%2==1)return!1;var p=u.getVblen(a,0),g=a.substr(0,2),m=u.getL(a,0);return a.length-g.length-m.length==2*p},Vt.checkStrictDER=function(a,u,p,g,m){var w=Vt;if(p===void 0){if(typeof a!="string")throw new Error("not hex string");if(a=a.toLowerCase(),!v.lang.String.isHex(a))throw new Error("not hex string");p=a.length,m=(g=a.length/2)<128?1:Math.ceil(g.toString(16))+1}if(w.getL(a,u).length>2*m)throw new Error("L of TLV too long: idx="+u);var F=w.getVblen(a,u);if(F>g)throw new Error("value of L too long than hex: idx="+u);var R=w.getTLV(a,u),P=R.length-2-w.getL(a,u).length;if(P!==2*F)throw new Error("V string length and L's value not the same:"+P+"/"+2*F);if(u===0&&a.length!=R.length)throw new Error("total length and TLV length unmatch:"+a.length+"!="+R.length);var B=a.substr(u,2);if(B==="02"){var K=w.getVidx(a,u);if(a.substr(K,2)=="00"&&a.charCodeAt(K+2)<56)throw new Error("not least zeros for DER INTEGER")}if(32&parseInt(B,16)){for(var L=w.getVblen(a,u),O=0,U=w.getChildIdx(a,u),W=0;W<U.length;W++)O+=w.getTLV(a,U[W]).length,w.checkStrictDER(a,U[W],p,g,m);if(2*L!=O)throw new Error("sum of children's TLV length and L unmatch: "+2*L+"!="+O)}},Vt.oidname=function(a){var u=v.asn1;v.lang.String.isHex(a)&&(a=u.ASN1Util.oidHexToInt(a));var p=u.x509.OID.oid2name(a);return p===""&&(p=a),p},v!==void 0&&v||(v={}),v.asn1!==void 0&&v.asn1||(v.asn1={}),v.asn1.x509!==void 0&&v.asn1.x509||(v.asn1.x509={}),v.asn1.x509.Certificate=function(a){v.asn1.x509.Certificate.superclass.constructor.call(this);var u=v.asn1,p=u.DERBitString,g=u.DERSequence,m=u.x509,w=m.TBSCertificate,F=m.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(R){this.params=R},this.sign=function(){var R=this.params,P=R.sigalg;R.sigalg.name!=null&&(P=R.sigalg.name);var B=R.tbsobj.tohex(),K=new v.crypto.Signature({alg:P});K.init(R.cakey),K.updateHex(B),R.sighex=K.sign()},this.getPEM=function(){return Xe(this.tohex(),"CERTIFICATE")},this.tohex=function(){var R=this.params;if(R.tbsobj!=null&&R.tbsobj!=null||(R.tbsobj=new w(R)),R.sighex==null&&R.cakey!=null&&this.sign(),R.sighex==null)throw new Error("sighex or cakey parameter not defined");var P=[];return P.push(R.tbsobj),P.push(new F({name:R.sigalg})),P.push(new p({hex:"00"+R.sighex})),new g({array:P}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&(this.params=a)},Yt(v.asn1.x509.Certificate,v.asn1.ASN1Object),v.asn1.x509.TBSCertificate=function(a){v.asn1.x509.TBSCertificate.superclass.constructor.call(this);var u=v.asn1,p=u.x509,g=u.DERTaggedObject,m=u.DERInteger,w=u.DERSequence,F=p.AlgorithmIdentifier,R=p.Time,P=p.X500Name,B=p.Extensions,K=p.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(L){this.params=L},this.tohex=function(){var L=[],O=this.params;if(O.version!=null||O.version!=1){var U=2;O.version!=null&&(U=O.version-1);var W=new g({obj:new m({int:U})});L.push(W)}return L.push(new m(O.serial)),L.push(new F({name:O.sigalg})),L.push(new P(O.issuer)),L.push(new w({array:[new R(O.notbefore),new R(O.notafter)]})),L.push(new P(O.subject)),L.push(new K(Te.getKey(O.sbjpubkey))),O.ext!==void 0&&O.ext.length>0&&L.push(new g({tag:"a3",obj:new B(O.ext)})),new v.asn1.DERSequence({array:L}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(v.asn1.x509.TBSCertificate,v.asn1.ASN1Object),v.asn1.x509.Extensions=function(a){v.asn1.x509.Extensions.superclass.constructor.call(this);var u=v.asn1,p=u.DERSequence,g=u.x509;this.aParam=[],this.setByParam=function(m){this.aParam=m},this.tohex=function(){for(var m=[],w=0;w<this.aParam.length;w++){var F=this.aParam[w],R=F.extname,P=null;if(F.extn!=null)P=new g.PrivateExtension(F);else if(R=="subjectKeyIdentifier")P=new g.SubjectKeyIdentifier(F);else if(R=="keyUsage")P=new g.KeyUsage(F);else if(R=="subjectAltName")P=new g.SubjectAltName(F);else if(R=="issuerAltName")P=new g.IssuerAltName(F);else if(R=="basicConstraints")P=new g.BasicConstraints(F);else if(R=="nameConstraints")P=new g.NameConstraints(F);else if(R=="cRLDistributionPoints")P=new g.CRLDistributionPoints(F);else if(R=="certificatePolicies")P=new g.CertificatePolicies(F);else if(R=="policyMappings")P=new g.PolicyMappings(F);else if(R=="policyConstraints")P=new g.PolicyConstraints(F);else if(R=="inhibitAnyPolicy")P=new g.InhibitAnyPolicy(F);else if(R=="authorityKeyIdentifier")P=new g.AuthorityKeyIdentifier(F);else if(R=="extKeyUsage")P=new g.ExtKeyUsage(F);else if(R=="authorityInfoAccess")P=new g.AuthorityInfoAccess(F);else if(R=="cRLNumber")P=new g.CRLNumber(F);else if(R=="cRLReason")P=new g.CRLReason(F);else if(R=="ocspNonce")P=new g.OCSPNonce(F);else if(R=="ocspNoCheck")P=new g.OCSPNoCheck(F);else if(R=="adobeTimeStamp")P=new g.AdobeTimeStamp(F);else{if(R!="subjectDirectoryAttributes")throw new Error("extension not supported:"+JSON.stringify(F));P=new g.SubjectDirectoryAttributes(F)}P!=null&&m.push(P)}return new p({array:m}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.x509.Extensions,v.asn1.ASN1Object),v.asn1.x509.Extension=function(a){v.asn1.x509.Extension.superclass.constructor.call(this);var u=v.asn1,p=u.DERObjectIdentifier,g=u.DEROctetString,m=(u.DERBitString,u.DERBoolean),w=u.DERSequence;this.tohex=function(){var F=new p({oid:this.oid}),R=new g({hex:this.getExtnValueHex()}),P=new Array;return P.push(F),this.critical&&P.push(new m),P.push(R),new w({array:P}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.critical=!1,a!==void 0&&a.critical!==void 0&&(this.critical=a.critical)},Yt(v.asn1.x509.Extension,v.asn1.ASN1Object),v.asn1.x509.KeyUsage=function(a){v.asn1.x509.KeyUsage.superclass.constructor.call(this,a);var u=Error,p={digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8};this.getExtnValueHex=function(){var g=this.getBinValue();return this.asn1ExtnValue=new v.asn1.DERBitString({bin:g}),this.asn1ExtnValue.tohex()},this.getBinValue=function(){var g=this.params;if(typeof g!="object"||typeof g.names!="object"&&typeof g.bin!="string")throw new u("parameter not yet set");if(g.names!=null)return fr(g.names,p);if(g.bin!=null)return g.bin;throw new u("parameter not set properly")},this.oid="2.5.29.15",a!==void 0&&(this.params=a)},Yt(v.asn1.x509.KeyUsage,v.asn1.x509.Extension),v.asn1.x509.BasicConstraints=function(a){v.asn1.x509.BasicConstraints.superclass.constructor.call(this,a);var u=v.asn1,p=u.DERBoolean,g=u.DERInteger,m=u.DERSequence;this.getExtnValueHex=function(){var w=new Array;this.cA&&w.push(new p),this.pathLen>-1&&w.push(new g({int:this.pathLen}));var F=new m({array:w});return this.asn1ExtnValue=F,this.asn1ExtnValue.tohex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,a!==void 0&&(a.cA!==void 0&&(this.cA=a.cA),a.pathLen!==void 0&&(this.pathLen=a.pathLen))},Yt(v.asn1.x509.BasicConstraints,v.asn1.x509.Extension),v.asn1.x509.CRLDistributionPoints=function(a){v.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,a);var u=v.asn1,p=u.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.setByDPArray=function(g){for(var m=[],w=0;w<g.length;w++)if(g[w]instanceof v.asn1.ASN1Object)m.push(g[w]);else{var F=new p.DistributionPoint(g[w]);m.push(F)}this.asn1ExtnValue=new u.DERSequence({array:m})},this.setByOneURI=function(g){var m=new p.DistributionPoint({fulluri:g});this.setByDPArray([m])},this.oid="2.5.29.31",a!==void 0&&(a.array!==void 0?this.setByDPArray(a.array):a.uri!==void 0&&this.setByOneURI(a.uri))},Yt(v.asn1.x509.CRLDistributionPoints,v.asn1.x509.Extension),v.asn1.x509.DistributionPoint=function(a){v.asn1.x509.DistributionPoint.superclass.constructor.call(this);var u=v.asn1,p=u.x509.DistributionPointName;this.tohex=function(){var g=new u.DERSequence;if(this.asn1DP!=null){var m=new u.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});g.appendASN1Object(m)}return this.hTLV=g.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&(a.dpobj!==void 0?this.asn1DP=a.dpobj:a.dpname!==void 0?this.asn1DP=new p(a.dpname):a.fulluri!==void 0&&(this.asn1DP=new p({full:[{uri:a.fulluri}]})))},Yt(v.asn1.x509.DistributionPoint,v.asn1.ASN1Object),v.asn1.x509.DistributionPointName=function(a){v.asn1.x509.DistributionPointName.superclass.constructor.call(this);var u=v.asn1,p=u.DERTaggedObject;if(this.tohex=function(){if(this.type!="full")throw new Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new p({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0)if(u.x509.GeneralNames.prototype.isPrototypeOf(a))this.type="full",this.tag="a0",this.asn1V=a;else{if(a.full===void 0)throw new Error("This class supports GeneralNames only as argument");this.type="full",this.tag="a0",this.asn1V=new u.x509.GeneralNames(a.full)}},Yt(v.asn1.x509.DistributionPointName,v.asn1.ASN1Object),v.asn1.x509.CertificatePolicies=function(a){v.asn1.x509.CertificatePolicies.superclass.constructor.call(this,a);var u=v.asn1,p=u.x509,g=u.DERSequence,m=p.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var w=[],F=0;F<this.params.array.length;F++)w.push(new m(this.params.array[F]));var R=new g({array:w});return this.asn1ExtnValue=R,this.asn1ExtnValue.tohex()},this.oid="2.5.29.32",a!==void 0&&(this.params=a)},Yt(v.asn1.x509.CertificatePolicies,v.asn1.x509.Extension),v.asn1.x509.PolicyInformation=function(a){v.asn1.x509.PolicyInformation.superclass.constructor.call(this,a);var u=v.asn1,p=u.DERSequence,g=u.DERObjectIdentifier,m=u.x509.PolicyQualifierInfo;this.params=null,this.tohex=function(){if(this.params.policyoid===void 0&&this.params.array===void 0)throw new Error("parameter oid and array missing");var w=[new g(this.params.policyoid)];if(this.params.array!==void 0){for(var F=[],R=0;R<this.params.array.length;R++)F.push(new m(this.params.array[R]));F.length>0&&w.push(new p({array:F}))}return new p({array:w}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&(this.params=a)},Yt(v.asn1.x509.PolicyInformation,v.asn1.ASN1Object),v.asn1.x509.PolicyQualifierInfo=function(a){v.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,a);var u=v.asn1,p=u.DERSequence,g=u.DERIA5String,m=u.DERObjectIdentifier,w=u.x509.UserNotice;this.params=null,this.tohex=function(){return this.params.cps!==void 0?new p({array:[new m({oid:"1.3.6.1.5.5.7.2.1"}),new g({str:this.params.cps})]}).tohex():this.params.unotice!=null?new p({array:[new m({oid:"1.3.6.1.5.5.7.2.2"}),new w(this.params.unotice)]}).tohex():void 0},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&(this.params=a)},Yt(v.asn1.x509.PolicyQualifierInfo,v.asn1.ASN1Object),v.asn1.x509.UserNotice=function(a){v.asn1.x509.UserNotice.superclass.constructor.call(this,a);var u=v.asn1.DERSequence,p=(v.asn1.DERInteger,v.asn1.x509.DisplayText),g=v.asn1.x509.NoticeReference;this.params=null,this.tohex=function(){var m=[];return this.params.noticeref!==void 0&&m.push(new g(this.params.noticeref)),this.params.exptext!==void 0&&m.push(new p(this.params.exptext)),new u({array:m}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&(this.params=a)},Yt(v.asn1.x509.UserNotice,v.asn1.ASN1Object),v.asn1.x509.NoticeReference=function(a){v.asn1.x509.NoticeReference.superclass.constructor.call(this,a);var u=v.asn1.DERSequence,p=v.asn1.DERInteger,g=v.asn1.x509.DisplayText;this.params=null,this.tohex=function(){var m=[];if(this.params.org!==void 0&&m.push(new g(this.params.org)),this.params.noticenum!==void 0){for(var w=[],F=this.params.noticenum,R=0;R<F.length;R++)w.push(new p(F[R]));m.push(new u({array:w}))}if(m.length==0)throw new Error("parameter is empty");return new u({array:m}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&(this.params=a)},Yt(v.asn1.x509.NoticeReference,v.asn1.ASN1Object),v.asn1.x509.DisplayText=function(a){v.asn1.x509.DisplayText.superclass.constructor.call(this,a),this.hT="0c",a!==void 0&&(a.type==="ia5"?this.hT="16":a.type==="vis"?this.hT="1a":a.type==="bmp"&&(this.hT="1e"))},Yt(v.asn1.x509.DisplayText,v.asn1.DERAbstractString),v.asn1.x509.PolicyMappings=function(a){v.asn1.x509.PolicyMappings.superclass.constructor.call(this,a);var u=v.asn1,p=(u.x509,u.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){for(var g=this.params,m=[],w=0;w<g.array.length;w++){var F=g.array[w];m.push({seq:[{oid:F[0]},{oid:F[1]}]})}return this.asn1ExtnValue=p({seq:m}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.33",a!==void 0&&(this.params=a)},Yt(v.asn1.x509.PolicyMappings,v.asn1.x509.Extension),v.asn1.x509.PolicyConstraints=function(a){v.asn1.x509.PolicyConstraints.superclass.constructor.call(this,a);var u=v.asn1,p=(u.x509,u.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){var g=this.params,m=[];return g.reqexp!=null&&m.push({tag:{tagi:"80",obj:{int:g.reqexp}}}),g.inhibit!=null&&m.push({tag:{tagi:"81",obj:{int:g.inhibit}}}),this.asn1ExtnValue=p({seq:m}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.36",a!==void 0&&(this.params=a)},Yt(v.asn1.x509.PolicyConstraints,v.asn1.x509.Extension),v.asn1.x509.InhibitAnyPolicy=function(a){v.asn1.x509.InhibitAnyPolicy.superclass.constructor.call(this,a);var u=v.asn1,p=(u.x509,u.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=p({int:this.params.skip}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.54",a!==void 0&&(this.params=a)},Yt(v.asn1.x509.InhibitAnyPolicy,v.asn1.x509.Extension),v.asn1.x509.NameConstraints=function(a){v.asn1.x509.NameConstraints.superclass.constructor.call(this,a);var u=v.asn1,p=u.x509,g=u.ASN1Util.newObject,m=p.GeneralSubtree;this.params=null,this.getExtnValueHex=function(){var w=this.params,F=[];if(w.permit!=null&&w.permit.length!=null){for(var R=[],P=0;P<w.permit.length;P++)R.push(new m(w.permit[P]));F.push({tag:{tagi:"a0",obj:{seq:R}}})}if(w.exclude!=null&&w.exclude.length!=null){var B=[];for(P=0;P<w.exclude.length;P++)B.push(new m(w.exclude[P]));F.push({tag:{tagi:"a1",obj:{seq:B}}})}return this.asn1ExtnValue=g({seq:F}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.30",a!==void 0&&(this.params=a)},Yt(v.asn1.x509.NameConstraints,v.asn1.x509.Extension),v.asn1.x509.GeneralSubtree=function(a){v.asn1.x509.GeneralSubtree.superclass.constructor.call(this);var u=v.asn1,p=u.x509.GeneralName,g=u.ASN1Util.newObject;this.params=null,this.setByParam=function(m){this.params=m},this.tohex=function(){var m=this.params,w=[new p(m)];return m.min!=null&&w.push({tag:{tagi:"80",obj:{int:m.min}}}),m.max!=null&&w.push({tag:{tagi:"81",obj:{int:m.max}}}),g({seq:w}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(v.asn1.x509.GeneralSubtree,v.asn1.ASN1Object),v.asn1.x509.ExtKeyUsage=function(a){v.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,a);var u=v.asn1;this.setPurposeArray=function(p){this.asn1ExtnValue=new u.DERSequence;for(var g=0;g<p.length;g++){var m=new u.DERObjectIdentifier(p[g]);this.asn1ExtnValue.appendASN1Object(m)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.37",a!==void 0&&a.array!==void 0&&this.setPurposeArray(a.array)},Yt(v.asn1.x509.ExtKeyUsage,v.asn1.x509.Extension),v.asn1.x509.AuthorityKeyIdentifier=function(a){v.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,a);var u=v,p=u.asn1,g=p.DERTaggedObject,m=p.x509.GeneralNames;u.crypto.Util.isKey,this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var w=new Array;this.asn1KID&&w.push(new g({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&w.push(new g({explicit:!1,tag:"a1",obj:new m([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&w.push(new g({explicit:!1,tag:"82",obj:this.asn1CertSN}));var F=new p.DERSequence({array:w});return this.asn1ExtnValue=F,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(w){if(w.str!==void 0||w.hex!==void 0)this.asn1KID=new v.asn1.DEROctetString(w);else if(typeof w=="object"&&v.crypto.Util.isKey(w)||typeof w=="string"&&w.indexOf("BEGIN ")!=-1){var F=w;typeof w=="string"&&(F=Te.getKey(w));var R=Te.getKeyID(F);this.asn1KID=new v.asn1.DEROctetString({hex:R})}},this.setCertIssuerByParam=function(w){w.str!==void 0||w.ldapstr!==void 0||w.hex!==void 0||w.certsubject!==void 0||w.certissuer!==void 0?this.asn1CertIssuer=new v.asn1.x509.X500Name(w):typeof w=="string"&&w.indexOf("BEGIN ")!=-1&&w.indexOf("CERTIFICATE")!=-1&&(this.asn1CertIssuer=new v.asn1.x509.X500Name({certissuer:w}))},this.setCertSNByParam=function(w){if(w.str!==void 0||w.bigint!==void 0||w.hex!==void 0)this.asn1CertSN=new v.asn1.DERInteger(w);else if(typeof w=="string"&&w.indexOf("BEGIN ")!=-1&&w.indexOf("CERTIFICATE")){var F=new Ee;F.readCertPEM(w);var R=F.getSerialNumberHex();this.asn1CertSN=new v.asn1.DERInteger({hex:R})}},this.oid="2.5.29.35",a!==void 0&&(a.kid!==void 0&&this.setKIDByParam(a.kid),a.issuer!==void 0&&this.setCertIssuerByParam(a.issuer),a.sn!==void 0&&this.setCertSNByParam(a.sn),a.issuersn!==void 0&&typeof a.issuersn=="string"&&a.issuersn.indexOf("BEGIN ")!=-1&&a.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(a.issuersn),this.setCertIssuerByParam(a.issuersn)))},Yt(v.asn1.x509.AuthorityKeyIdentifier,v.asn1.x509.Extension),v.asn1.x509.SubjectKeyIdentifier=function(a){v.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,a);var u=v.asn1.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(p){if(p.str!==void 0||p.hex!==void 0)this.asn1KID=new u(p);else if(typeof p=="object"&&v.crypto.Util.isKey(p)||typeof p=="string"&&p.indexOf("BEGIN")!=-1){var g=p;typeof p=="string"&&(g=Te.getKey(p));var m=Te.getKeyID(g);this.asn1KID=new v.asn1.DEROctetString({hex:m})}},this.oid="2.5.29.14",a!==void 0&&a.kid!==void 0&&this.setKIDByParam(a.kid)},Yt(v.asn1.x509.SubjectKeyIdentifier,v.asn1.x509.Extension),v.asn1.x509.AuthorityInfoAccess=function(a){v.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,a),this.setAccessDescriptionArray=function(u){for(var p=new Array,g=v.asn1,m=g.DERSequence,w=g.DERObjectIdentifier,F=g.x509.GeneralName,R=0;R<u.length;R++){var P,B=u[R];if(B.ocsp!==void 0)P=new m({array:[new w({oid:"1.3.6.1.5.5.7.48.1"}),new F({uri:B.ocsp})]});else{if(B.caissuer===void 0)throw new Error("unknown AccessMethod parameter: "+JSON.stringify(B));P=new m({array:[new w({oid:"1.3.6.1.5.5.7.48.2"}),new F({uri:B.caissuer})]})}p.push(P)}this.asn1ExtnValue=new m({array:p})},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.1.1",a!==void 0&&a.array!==void 0&&this.setAccessDescriptionArray(a.array)},Yt(v.asn1.x509.AuthorityInfoAccess,v.asn1.x509.Extension),v.asn1.x509.SubjectAltName=function(a){v.asn1.x509.SubjectAltName.superclass.constructor.call(this,a),this.setNameArray=function(u){this.asn1ExtnValue=new v.asn1.x509.GeneralNames(u)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.17",a!==void 0&&a.array!==void 0&&this.setNameArray(a.array)},Yt(v.asn1.x509.SubjectAltName,v.asn1.x509.Extension),v.asn1.x509.IssuerAltName=function(a){v.asn1.x509.IssuerAltName.superclass.constructor.call(this,a),this.setNameArray=function(u){this.asn1ExtnValue=new v.asn1.x509.GeneralNames(u)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.18",a!==void 0&&a.array!==void 0&&this.setNameArray(a.array)},Yt(v.asn1.x509.IssuerAltName,v.asn1.x509.Extension),v.asn1.x509.SubjectDirectoryAttributes=function(a){v.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,a);var u=v.asn1,p=u.DERSequence,g=u.ASN1Util.newObject,m=u.x509.OID.name2oid;this.params=null,this.getExtnValueHex=function(){for(var w=[],F=0;F<this.params.array.length;F++){var R=this.params.array[F];if(R.attr==null||R.array==null){var P={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if(R.attr=="dateOfBirth")P.seq[0].oid=m(R.attr),P.seq[1].set[0]={gentime:R.str};else if(R.attr=="placeOfBirth")P.seq[0].oid=m(R.attr),P.seq[1].set[0]={utf8str:R.str};else if(R.attr=="gender")P.seq[0].oid=m(R.attr),P.seq[1].set[0]={prnstr:R.str};else if(R.attr=="countryOfCitizenship")P.seq[0].oid=m(R.attr),P.seq[1].set[0]={prnstr:R.str};else{if(R.attr!="countryOfResidence")throw new Error("unsupported attribute: "+R.attr);P.seq[0].oid=m(R.attr),P.seq[1].set[0]={prnstr:R.str}}w.push(new g(P))}else{var B={seq:[{oid:R.attr},{set:R.array}]};w.push(g(B))}}var K=new p({array:w});return this.asn1ExtnValue=K,this.asn1ExtnValue.tohex()},this.oid="2.5.29.9",a!==void 0&&(this.params=a)},Yt(v.asn1.x509.SubjectDirectoryAttributes,v.asn1.x509.Extension),v.asn1.x509.PrivateExtension=function(a){v.asn1.x509.PrivateExtension.superclass.constructor.call(this,a);var u=v,p=u.lang.String.isHex,g=u.asn1,m=g.x509.OID.name2oid,w=g.ASN1Util.newObject;this.params=null,this.setByParam=function(F){this.oid=m(F.extname),this.params=F},this.getExtnValueHex=function(){if(this.params.extname==null||this.params.extn==null)throw new Error("extname or extnhex not specified");var F=this.params.extn;if(typeof F=="string"&&p(F))return F;if(typeof F=="object")try{return w(F).tohex()}catch{}throw new Error("unsupported extn value")},a!=null&&this.setByParam(a)},Yt(v.asn1.x509.PrivateExtension,v.asn1.x509.Extension),v.asn1.x509.CRL=function(a){v.asn1.x509.CRL.superclass.constructor.call(this);var u=v.asn1,p=u.DERSequence,g=u.DERBitString,m=u.x509,w=m.AlgorithmIdentifier,F=m.TBSCertList;this.params=void 0,this.setByParam=function(R){this.params=R},this.sign=function(){var R=new F(this.params).tohex(),P=new v.crypto.Signature({alg:this.params.sigalg});P.init(this.params.cakey),P.updateHex(R);var B=P.sign();this.params.sighex=B},this.getPEM=function(){return Xe(this.tohex(),"X509 CRL")},this.tohex=function(){var R=this.params;if(R.tbsobj==null&&(R.tbsobj=new F(R)),R.sighex==null&&R.cakey!=null&&this.sign(),R.sighex==null)throw new Error("sighex or cakey parameter not defined");var P=[];return P.push(R.tbsobj),P.push(new w({name:R.sigalg})),P.push(new g({hex:"00"+R.sighex})),new p({array:P}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&(this.params=a)},Yt(v.asn1.x509.CRL,v.asn1.ASN1Object),v.asn1.x509.TBSCertList=function(a){v.asn1.x509.TBSCertList.superclass.constructor.call(this);var u=v.asn1,p=u.DERInteger,g=u.DERSequence,m=u.DERTaggedObject,w=(u.DERObjectIdentifier,u.x509),F=w.AlgorithmIdentifier,R=w.Time,P=w.Extensions,B=w.X500Name;this.params=null,this.setByParam=function(K){this.params=K},this.getRevCertSequence=function(){for(var K=[],L=this.params.revcert,O=0;O<L.length;O++){var U=[new p(L[O].sn),new R(L[O].date)];L[O].ext!=null&&U.push(new P(L[O].ext)),K.push(new g({array:U}))}return new g({array:K})},this.tohex=function(){var K=[],L=this.params;if(L.version!=null){var O=L.version-1,U=new p({int:O});K.push(U)}if(K.push(new F({name:L.sigalg})),K.push(new B(L.issuer)),K.push(new R(L.thisupdate)),L.nextupdate!=null&&K.push(new R(L.nextupdate)),L.revcert!=null&&K.push(this.getRevCertSequence()),L.ext!=null){var W=new P(L.ext);K.push(new m({tag:"a0",explicit:!0,obj:W}))}return new g({array:K}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(v.asn1.x509.TBSCertList,v.asn1.ASN1Object),v.asn1.x509.CRLEntry=function(a){v.asn1.x509.CRLEntry.superclass.constructor.call(this);var u=v.asn1;this.setCertSerial=function(p){this.sn=new u.DERInteger(p)},this.setRevocationDate=function(p){this.time=new u.x509.Time(p)},this.tohex=function(){var p=new u.DERSequence({array:[this.sn,this.time]});return this.TLV=p.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&(a.time!==void 0&&this.setRevocationDate(a.time),a.sn!==void 0&&this.setCertSerial(a.sn))},Yt(v.asn1.x509.CRLEntry,v.asn1.ASN1Object),v.asn1.x509.CRLNumber=function(a){v.asn1.x509.CRLNumber.superclass.constructor.call(this,a),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new v.asn1.DERInteger(this.params.num),this.asn1ExtnValue.tohex()},this.oid="2.5.29.20",a!=null&&(this.params=a)},Yt(v.asn1.x509.CRLNumber,v.asn1.x509.Extension),v.asn1.x509.CRLReason=function(a){v.asn1.x509.CRLReason.superclass.constructor.call(this,a),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new v.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.tohex()},this.oid="2.5.29.21",a!=null&&(this.params=a)},Yt(v.asn1.x509.CRLReason,v.asn1.x509.Extension),v.asn1.x509.OCSPNonce=function(a){v.asn1.x509.OCSPNonce.superclass.constructor.call(this,a),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new v.asn1.DEROctetString(this.params),this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.2",a!=null&&(this.params=a)},Yt(v.asn1.x509.OCSPNonce,v.asn1.x509.Extension),v.asn1.x509.OCSPNoCheck=function(a){v.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,a),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new v.asn1.DERNull,this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.5",a!=null&&(this.params=a)},Yt(v.asn1.x509.OCSPNoCheck,v.asn1.x509.Extension),v.asn1.x509.AdobeTimeStamp=function(a){v.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,a);var u=v.asn1,p=u.DERInteger,g=u.DERBoolean,m=u.DERSequence,w=u.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var F=this.params,R=[new p(1)];return R.push(new w({uri:F.uri})),F.reqauth!=null&&R.push(new g(F.reqauth)),this.asn1ExtnValue=new m({array:R}),this.asn1ExtnValue.tohex()},this.oid="1.2.840.113583.1.1.9.1",a!==void 0&&this.setByParam(a)},Yt(v.asn1.x509.AdobeTimeStamp,v.asn1.x509.Extension),v.asn1.x509.X500Name=function(a){v.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var u=v.asn1,p=u.x509,g=p.RDN;this.setByString=function(m,w){w!==void 0&&(this.sRule=w);var F=m.split("/");F.shift();for(var R=[],P=0;P<F.length;P++)if(F[P].match(/^[^=]+=.+$/))R.push(F[P]);else{var B=R.length-1;R[B]=R[B]+"/"+F[P]}for(P=0;P<R.length;P++)this.asn1Array.push(new g({str:R[P],rule:this.sRule}))},this.setByLdapString=function(m,w){w!==void 0&&(this.sRule=w);var F=p.X500Name.ldapToCompat(m);this.setByString(F,w)},this.setByObject=function(m,w){for(var F in w!==void 0&&(this.sRule=w),m)if(m.hasOwnProperty(F)){var R=new g({str:F+"="+m[F],rule:this.sRule});this.asn1Array?this.asn1Array.push(R):this.asn1Array=[R]}},this.setByParam=function(m){var w;m.rule!==void 0&&(this.sRule=m.rule),m.array!==void 0?this.paramArray=m.array:m.str!==void 0?this.setByString(m.str):m.ldapstr!==void 0?this.setByLdapString(m.ldapstr):m.hex!==void 0?this.hTLV=m.hex:m.certissuer!==void 0?((w=new Ee).readCertPEM(m.certissuer),this.hTLV=w.getIssuerHex()):m.certsubject!==void 0?((w=new Ee).readCertPEM(m.certsubject),this.hTLV=w.getSubjectHex()):typeof m=="object"&&m.certsubject===void 0&&m.certissuer===void 0&&this.setByObject(m)},this.tohex=function(){if(typeof this.hTLV=="string")return this.hTLV;if(this.asn1Array.length==0&&this.paramArray.length>0)for(var m=0;m<this.paramArray.length;m++){var w={array:this.paramArray[m]};this.sRule!="utf8"&&(w.rule=this.sRule);var F=new g(w);this.asn1Array.push(F)}var R=new u.DERSequence({array:this.asn1Array});return this.hTLV=R.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(v.asn1.x509.X500Name,v.asn1.ASN1Object),v.asn1.x509.X500Name.compatToLDAP=function(a){if(a.substr(0,1)!=="/")throw"malformed input";var u=(a=a.substr(1)).split("/");return u.reverse(),(u=u.map(function(p){return p.replace(/,/,"\\,")})).join(",")},v.asn1.x509.X500Name.onelineToLDAP=function(a){return v.asn1.x509.X500Name.compatToLDAP(a)},v.asn1.x509.X500Name.ldapToCompat=function(a){for(var u=a.split(","),p=!1,g=[],m=0;u.length>0;m++){var w=u.shift();if(p===!0){var F=(g.pop()+","+w).replace(/\\,/g,",");g.push(F),p=!1}else g.push(w);w.substr(-1,1)==="\\"&&(p=!0)}return(g=g.map(function(R){return R.replace("/","\\/")})).reverse(),"/"+g.join("/")},v.asn1.x509.X500Name.ldapToOneline=function(a){return v.asn1.x509.X500Name.ldapToCompat(a)},v.asn1.x509.RDN=function(a){v.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var u=v.asn1.x509.AttributeTypeAndValue;this.setByParam=function(p){p.rule!==void 0&&(this.sRule=p.rule),p.str!==void 0&&this.addByMultiValuedString(p.str),p.array!==void 0&&(this.paramArray=p.array)},this.addByString=function(p){this.asn1Array.push(new v.asn1.x509.AttributeTypeAndValue({str:p,rule:this.sRule}))},this.addByMultiValuedString=function(p){for(var g=v.asn1.x509.RDN.parseString(p),m=0;m<g.length;m++)this.addByString(g[m])},this.tohex=function(){if(this.asn1Array.length==0&&this.paramArray.length>0)for(var p=0;p<this.paramArray.length;p++){var g=this.paramArray[p];g.rule!==void 0&&this.sRule!="utf8"&&(g.rule=this.sRule);var m=new u(g);this.asn1Array.push(m)}var w=new v.asn1.DERSet({array:this.asn1Array});return this.TLV=w.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(v.asn1.x509.RDN,v.asn1.ASN1Object),v.asn1.x509.RDN.parseString=function(a){for(var u=a.split(/\+/),p=!1,g=[],m=0;u.length>0;m++){var w=u.shift();if(p===!0){var F=(g.pop()+"+"+w).replace(/\\\+/g,"+");g.push(F),p=!1}else g.push(w);w.substr(-1,1)==="\\"&&(p=!0)}var R=!1,P=[];for(m=0;g.length>0;m++){if(w=g.shift(),R===!0){var B=P.pop();w.match(/"$/)?(F=(B+"+"+w).replace(/^([^=]+)="(.*)"$/,"$1=$2"),P.push(F),R=!1):P.push(B+"+"+w)}else P.push(w);w.match(/^[^=]+="/)&&(R=!0)}return P},v.asn1.x509.AttributeTypeAndValue=function(a){v.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var u=v,p=u.asn1,g=p.DERSequence,m=p.DERUTF8String,w=p.DERPrintableString,F=p.DERTeletexString,R=p.DERIA5String,P=p.DERVisibleString,B=p.DERBMPString,K=u.lang.String.isMail,L=u.lang.String.isPrintable;this.setByParam=function(O){if(O.rule!==void 0&&(this.sRule=O.rule),O.ds!==void 0&&(this.dsType=O.ds),O.value===void 0&&O.str!==void 0){var U=O.str.match(/^([^=]+)=(.+)$/);if(!U)throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr);this.sType=U[1],this.sValue=U[2]}else this.sType=O.type,this.sValue=O.value},this.setByString=function(O,U){U!==void 0&&(this.sRule=U);var W=O.match(/^([^=]+)=(.+)$/);if(!W)throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr);this.setByAttrTypeAndValueStr(W[1],W[2])},this._getDsType=function(){var O=this.sType,U=this.sValue,W=this.sRule;return W==="prn"?O=="CN"&&K(U)?"ia5":L(U)?"prn":"utf8":W==="utf8"?O=="CN"&&K(U)?"ia5":O=="C"?"prn":"utf8":"utf8"},this.setByAttrTypeAndValueStr=function(O,U,W){W!==void 0&&(this.sRule=W),this.sType=O,this.sValue=U},this.getValueObj=function(O,U){if(O=="utf8")return new m({str:U});if(O=="prn")return new w({str:U});if(O=="tel")return new F({str:U});if(O=="ia5")return new R({str:U});if(O=="vis")return new P({str:U});if(O=="bmp")return new B({str:U});throw new Error("unsupported directory string type: type="+O+" value="+U)},this.tohex=function(){this.dsType==null&&(this.dsType=this._getDsType());var O=v.asn1.x509.OID.atype2obj(this.sType),U=this.getValueObj(this.dsType,this.sValue),W=new g({array:[O,U]});return this.TLV=W.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(v.asn1.x509.AttributeTypeAndValue,v.asn1.ASN1Object),v.asn1.x509.SubjectPublicKeyInfo=function(a){v.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var u=v,p=u.asn1,g=p.DERInteger,m=p.DERBitString,w=p.DERObjectIdentifier,F=p.DERSequence,R=p.ASN1Util.newObject,P=p.x509.AlgorithmIdentifier,B=u.crypto;B.ECDSA,B.DSA,this.getASN1Object=function(){if(this.asn1AlgId==null||this.asn1SubjPKey==null)throw"algId and/or subjPubKey not set";return new F({array:[this.asn1AlgId,this.asn1SubjPKey]})},this.tohex=function(){var K=this.getASN1Object();return this.hTLV=K.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.setPubKey=function(K){try{if(K instanceof Nt){var L=R({seq:[{int:{bigint:K.n}},{int:{int:K.e}}]}).tohex();this.asn1AlgId=new P({name:"rsaEncryption"}),this.asn1SubjPKey=new m({hex:"00"+L})}}catch{}try{if(K instanceof v.crypto.ECDSA){var O=new w({name:K.curveName});this.asn1AlgId=new P({name:"ecPublicKey",asn1params:O}),this.asn1SubjPKey=new m({hex:"00"+K.pubKeyHex})}}catch{}try{if(K instanceof v.crypto.DSA){O=new R({seq:[{int:{bigint:K.p}},{int:{bigint:K.q}},{int:{bigint:K.g}}]}),this.asn1AlgId=new P({name:"dsa",asn1params:O});var U=new g({bigint:K.y});this.asn1SubjPKey=new m({hex:"00"+U.tohex()})}}catch{}},a!==void 0&&this.setPubKey(a)},Yt(v.asn1.x509.SubjectPublicKeyInfo,v.asn1.ASN1Object),v.asn1.x509.Time=function(a){v.asn1.x509.Time.superclass.constructor.call(this);var u=v.asn1,p=u.DERUTCTime,g=u.DERGeneralizedTime;this.params=null,this.type=null,this.setTimeParams=function(m){this.timeParams=m},this.setByParam=function(m){this.params=m},this.getType=function(m){return m.match(/^[0-9]{12}Z$/)?"utc":m.match(/^[0-9]{14}Z$/)?"gen":m.match(/^[0-9]{12}\.[0-9]+Z$/)?"utc":m.match(/^[0-9]{14}\.[0-9]+Z$/)?"gen":null},this.tohex=function(){var m=this.params,w=null;if(typeof m=="string"&&(m={str:m}),m==null||!m.str||m.type!=null&&m.type!=null||(m.type=this.getType(m.str)),m!=null&&m.str?(m.type=="utc"&&(w=new p(m.str)),m.type=="gen"&&(w=new g(m.str))):w=this.type=="gen"?new g:new p,w==null)throw new Error("wrong setting for Time");return this.TLV=w.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},v.asn1.x509.Time_bak=function(a){v.asn1.x509.Time_bak.superclass.constructor.call(this);var u=v.asn1,p=u.DERUTCTime,g=u.DERGeneralizedTime;this.setTimeParams=function(m){this.timeParams=m},this.tohex=function(){var m=null;return m=this.timeParams!=null?this.type=="utc"?new p(this.timeParams):new g(this.timeParams):this.type=="utc"?new p:new g,this.TLV=m.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},this.type="utc",a!==void 0&&(a.type!==void 0?this.type=a.type:a.str!==void 0&&(a.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),a.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=a)},Yt(v.asn1.x509.Time,v.asn1.ASN1Object),v.asn1.x509.AlgorithmIdentifier=function(a){v.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var u=v.asn1,p=u.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.tohex=function(){if(this.nameAlg===null&&this.asn1Alg===null)throw new Error("algorithm not specified");if(this.nameAlg!==null){var m=null;for(var w in p)w===this.nameAlg&&(m=p[w]);if(m!==null)return this.hTLV=m,this.hTLV}this.nameAlg!==null&&this.asn1Alg===null&&(this.asn1Alg=u.x509.OID.name2obj(this.nameAlg));var F=[this.asn1Alg];this.asn1Params!==null&&F.push(this.asn1Params);var R=new u.DERSequence({array:F});return this.hTLV=R.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&(a.name!==void 0&&(this.nameAlg=a.name),a.asn1params!==void 0&&(this.asn1Params=a.asn1params),a.paramempty!==void 0&&(this.paramEmpty=a.paramempty)),this.asn1Params===null&&this.paramEmpty===!1&&this.nameAlg!==null){this.nameAlg.name!==void 0&&(this.nameAlg=this.nameAlg.name);var g=this.nameAlg.toLowerCase();g.substr(-7,7)!=="withdsa"&&g.substr(-9,9)!=="withecdsa"&&(this.asn1Params=new u.DERNull)}},Yt(v.asn1.x509.AlgorithmIdentifier,v.asn1.ASN1Object),v.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"},v.asn1.x509.GeneralName=function(a){v.asn1.x509.GeneralName.superclass.constructor.call(this);var u=v.asn1,p=u.x509,g=p.X500Name,m=p.OtherName,w=u.DERIA5String,F=(u.DERPrintableString,u.DEROctetString),R=u.DERTaggedObject,P=u.ASN1Object,B=Error;this.params=null,this.setByParam=function(K){this.params=K},this.tohex=function(){var K,L,O=this.params,U=!1;if(O.other!==void 0)K="a0",L=new m(O.other);else if(O.rfc822!==void 0)K="81",L=new w({str:O.rfc822});else if(O.dns!==void 0)K="82",L=new w({str:O.dns});else if(O.dn!==void 0)K="a4",U=!0,L=typeof O.dn=="string"?new g({str:O.dn}):O.dn instanceof v.asn1.x509.X500Name?O.dn:new g(O.dn);else if(O.ldapdn!==void 0)K="a4",U=!0,L=new g({ldapstr:O.ldapdn});else if(O.certissuer!==void 0||O.certsubj!==void 0){var W,Y;K="a4",U=!0;var st=null;if(O.certsubj!==void 0?(W=!1,Y=O.certsubj):(W=!0,Y=O.certissuer),Y.match(/^[0-9A-Fa-f]+$/),Y.indexOf("-----BEGIN ")!=-1&&(st=Qe(Y)),st==null)throw new Error("certsubj/certissuer not cert");var vt,At=new Ee;At.hex=st,vt=W?At.getIssuerHex():At.getSubjectHex(),(L=new P).hTLV=vt}else if(O.uri!==void 0)K="86",L=new w({str:O.uri});else{if(O.ip===void 0)throw new B("improper params");var Mt;K="87";var Bt=O.ip;try{if(Bt.match(/^[0-9a-f]+$/)){var Q=Bt.length;if(Q!=8&&Q!=16&&Q!=32&&Q!=64)throw"err";Mt=Bt}else Mt=ar(Bt)}catch(ut){throw new B("malformed IP address: "+O.ip+":"+ut.message)}L=new F({hex:Mt})}return new R({tag:K,explicit:U,obj:L}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(v.asn1.x509.GeneralName,v.asn1.ASN1Object),v.asn1.x509.GeneralNames=function(a){v.asn1.x509.GeneralNames.superclass.constructor.call(this);var u=v.asn1;this.setByParamArray=function(p){for(var g=0;g<p.length;g++){var m=new u.x509.GeneralName(p[g]);this.asn1Array.push(m)}},this.tohex=function(){return new u.DERSequence({array:this.asn1Array}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.asn1Array=new Array,a!==void 0&&this.setByParamArray(a)},Yt(v.asn1.x509.GeneralNames,v.asn1.ASN1Object),v.asn1.x509.OtherName=function(a){v.asn1.x509.OtherName.superclass.constructor.call(this);var u=v.asn1,p=u.DERObjectIdentifier,g=u.DERSequence,m=u.ASN1Util.newObject;this.params=null,this.setByParam=function(w){this.params=w},this.tohex=function(){var w=this.params;if(w.oid==null||w.value==null)throw new Error("oid or value not specified");var F=new p({oid:w.oid}),R=m({tag:{tag:"a0",explicit:!0,obj:w.value}});return new g({array:[F,R]}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(v.asn1.x509.OtherName,v.asn1.ASN1Object),v.asn1.x509.OID=new function(){var a=v.asn1.DERObjectIdentifier;this.name2oidList={"aes128-CBC":"2.16.840.1.101.3.4.1.2","aes256-CBC":"2.16.840.1.101.3.4.1.42",sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",hmacWithSHA1:"1.2.840.113549.2.7",hmacWithSHA224:"1.2.840.113549.2.8",hmacWithSHA256:"1.2.840.113549.2.9",hmacWithSHA384:"1.2.840.113549.2.10",hmacWithSHA512:"1.2.840.113549.2.11",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",policyMappings:"2.5.29.33",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",inhibitAnyPolicy:"2.5.29.54",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",smtpUTF8Mailbox:"1.3.6.1.5.5.7.8.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",secp521r1:"1.3.132.0.35",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1",smimeMailboxLegacy:"2.23.140.1.5.1.1",smimeMailboxMulti:"2.23.140.1.5.1.2",smimeMailboxStrict:"2.23.140.1.5.1.3",smimeOrganizationLegacy:"2.23.140.1.5.2.1",smimeOrganizationMulti:"2.23.140.1.5.2.2",smimeOrganizationStrict:"2.23.140.1.5.2.3",smimeSponsorLegacy:"2.23.140.1.5.3.1",smimeSponsorMulti:"2.23.140.1.5.3.2",smimeSponsorStrict:"2.23.140.1.5.3.3",smimeIndividualLegacy:"2.23.140.1.5.4.1",smimeIndividualMulti:"2.23.140.1.5.4.2",smimeIndividualStrict:"2.23.140.1.5.4.3"},this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",GN:"2.5.4.42",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.objCache={},this.name2obj=function(u){if(this.objCache[u]!==void 0)return this.objCache[u];if(this.name2oidList[u]===void 0)throw"Name of ObjectIdentifier not defined: "+u;var p=this.name2oidList[u],g=new a({oid:p});return this.objCache[u]=g,g},this.atype2obj=function(u){if(this.objCache[u]!==void 0)return this.objCache[u];var p;if(u.match(/^\d+\.\d+\.[0-9.]+$/))p=u;else if(this.atype2oidList[u]!==void 0)p=this.atype2oidList[u];else{if(this.name2oidList[u]===void 0)throw new Error("AttributeType name undefined: "+u);p=this.name2oidList[u]}var g=new a({oid:p});return this.objCache[u]=g,g},this.registerOIDs=function(u){if(this.checkOIDs(u))for(var p in u)this.name2oidList[p]=u[p]},this.checkOIDs=function(u){try{var p=Object.keys(u);return p.length!=0&&(p.map(function(g,m,w){if(!this[g].match(/^[0-2]\.[0-9.]+$/))throw new Error("value is not OID")},u),!0)}catch{return!1}}},v.asn1.x509.OID.oid2name=function(a){var u=v.asn1.x509.OID.name2oidList;for(var p in u)if(u[p]==a)return p;return""},v.asn1.x509.OID.oid2atype=function(a){var u=v.asn1.x509.OID.atype2oidList;for(var p in u)if(u[p]==a)return p;return a},v.asn1.x509.OID.name2oid=function(a){if(a.match(/^[0-9.]+$/))return a;var u=v.asn1.x509.OID.name2oidList;return u[a]===void 0?"":u[a]},v.asn1.x509.X509Util={},v.asn1.x509.X509Util.newCertPEM=function(a){var u=v.asn1.x509;return u.TBSCertificate,new u.Certificate(a).getPEM()},v!==void 0&&v||(v={}),v.asn1!==void 0&&v.asn1||(v.asn1={}),v.asn1.cms!==void 0&&v.asn1.cms||(v.asn1.cms={}),v.asn1.cms.Attribute=function(a){var u=Error,p=v.asn1,g=p.DERSequence,m=p.DERSet,w=p.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(F){this.params=F},this.getValueArray=function(){throw new u("not yet implemented abstract")},this.tohex=function(){var F=new w({oid:this.typeOid}),R=new m({array:this.getValueArray()});return new g({array:[F,R]}).tohex()},this.getEncodedHex=function(){return this.tohex()}},Yt(v.asn1.cms.Attribute,v.asn1.ASN1Object),v.asn1.cms.ContentType=function(a){var u=v.asn1;u.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){return[new u.DERObjectIdentifier(this.params.type)]},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.ContentType,v.asn1.cms.Attribute),v.asn1.cms.MessageDigest=function(a){var u=v.asn1,p=u.DEROctetString;u.cms.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){return[new p(this.params)]},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.MessageDigest,v.asn1.cms.Attribute),v.asn1.cms.SigningTime=function(a){var u=v.asn1;u.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){return[new u.x509.Time(this.params)]},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.SigningTime,v.asn1.cms.Attribute),v.asn1.cms.SigningCertificate=function(a){var u=Error,p=v,g=p.asn1,m=g.DERSequence,w=g.cms,F=w.ESSCertID;p.crypto,w.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new u("parameter 'array' not specified");for(var R=this.params.array,P=[],B=0;B<R.length;B++){var K=R[B];a.hasis!=0||typeof K!="string"||K.indexOf("-----BEGIN")==-1&&!Vt.isASN1HEX(K)||(K={cert:K}),K.hasis!=0&&a.hasis==0&&(K.hasis=!1),P.push(new F(K))}var L=new m({array:P});return[new m({array:[L]})]},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.SigningCertificate,v.asn1.cms.Attribute),v.asn1.cms.ESSCertID=function(a){v.asn1.cms.ESSCertID.superclass.constructor.call(this);var u=Error,p=v,g=p.asn1,m=g.DEROctetString,w=g.DERSequence,F=g.cms.IssuerSerial;this.params=null,this.getCertHash=function(R,P){if(R.hash!=null)return R.hash;if(typeof R=="string"&&R.indexOf("-----BEGIN")==-1&&!Vt.isASN1HEX(R))return R;var B,K,L;if(typeof R=="string")B=R;else{if(R.cert==null)throw new u("hash nor cert unspecified");B=R.cert}if(K=B.indexOf("-----BEGIN")!=-1?Qe(B):B,typeof R=="string"&&(R.indexOf("-----BEGIN")!=-1?K=Qe(R):Vt.isASN1HEX(R)&&(K=R)),R.alg!=null)L=R.alg;else{if(P==null)throw new u("hash alg unspecified");L=P}return p.crypto.Util.hashHex(K,L)},this.tohex=function(){var R=this.params,P=this.getCertHash(R,"sha1"),B=[];return B.push(new m({hex:P})),(typeof R=="string"&&R.indexOf("-----BEGIN")!=-1||R.cert!=null&&R.hasis!=0||R.issuer!=null&&R.serial!=null)&&B.push(new F(R)),new w({array:B}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.ESSCertID,v.asn1.ASN1Object),v.asn1.cms.SigningCertificateV2=function(a){var u=Error,p=v,g=p.asn1,m=g.DERSequence,w=(g.x509,g.cms),F=w.ESSCertIDv2;p.crypto,w.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new u("parameter 'array' not specified");for(var R=this.params.array,P=[],B=0;B<R.length;B++){var K=R[B];a.alg==null&&a.hasis!=0||typeof K!="string"||K.indexOf("-----BEGIN")==-1&&!Vt.isASN1HEX(K)||(K={cert:K}),K.alg==null&&a.alg!=null&&(K.alg=a.alg),K.hasis!=0&&a.hasis==0&&(K.hasis=!1),P.push(new F(K))}var L=new m({array:P});return[new m({array:[L]})]},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.SigningCertificateV2,v.asn1.cms.Attribute),v.asn1.cms.ESSCertIDv2=function(a){v.asn1.cms.ESSCertIDv2.superclass.constructor.call(this);var u=v.asn1,p=u.DEROctetString,g=u.DERSequence,m=u.cms.IssuerSerial,w=u.x509.AlgorithmIdentifier;this.params=null,this.tohex=function(){var F=this.params,R=this.getCertHash(F,"sha256"),P=[];return F.alg!=null&&F.alg!="sha256"&&P.push(new w({name:F.alg})),P.push(new p({hex:R})),(typeof F=="string"&&F.indexOf("-----BEGIN")!=-1||F.cert!=null&&F.hasis!=0||F.issuer!=null&&F.serial!=null)&&P.push(new m(F)),new g({array:P}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.ESSCertIDv2,v.asn1.cms.ESSCertID),v.asn1.cms.IssuerSerial=function(a){var u=Error,p=v.asn1,g=p.DERInteger,m=p.DERSequence,w=p.cms,F=p.x509.GeneralNames,R=Ee;w.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(P){this.params=P},this.tohex=function(){var P,B,K=this.params;if(typeof K=="string"&&K.indexOf("-----BEGIN")!=-1||K.cert!=null){var L;L=K.cert!=null?K.cert:K;var O=new R;O.readCertPEM(L),P=O.getIssuer(),B={hex:O.getSerialNumberHex()}}else{if(K.issuer==null||!K.serial)throw new u("cert or issuer and serial parameter not specified");P=K.issuer,B=K.serial}var U=new F([{dn:P}]),W=new g(B);return new m({array:[U,W]}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.IssuerSerial,v.asn1.ASN1Object),v.asn1.cms.SignerIdentifier=function(a){var u=v.asn1,p=(u.DERInteger,u.DERSequence,u.cms),g=p.IssuerAndSerialNumber,m=p.SubjectKeyIdentifier;u.x509.X500Name,p.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.tohex=function(){var w=this.params;if(w.type=="isssn")return new g(w).tohex();if(w.type=="skid")return new m(w).tohex();throw new Error("wrong property for isssn or skid")},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.SignerIdentifier,v.asn1.ASN1Object),v.asn1.cms.IssuerAndSerialNumber=function(a){var u=v.asn1,p=u.DERInteger,g=u.DERSequence,m=u.cms,w=u.x509.X500Name,F=Ee,R=Error;m.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.tohex=function(){var P,B,K=this.params;if(typeof K=="string"&&K.indexOf("-----BEGIN")!=-1||K.cert!=null){var L;L=K.cert!=null?K.cert:K;var O=new F;O.readCertPEM(L),P=O.getIssuer(),B={hex:O.getSerialNumberHex()}}else{if(K.issuer==null||!K.serial)throw new R("cert or issuer and serial parameter not specified");P=K.issuer,B=K.serial}var U=new w(P),W=new p(B);return new g({array:[U,W]}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(P){this.params=P},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.IssuerAndSerialNumber,v.asn1.ASN1Object),v.asn1.cms.SubjectKeyIdentifier=function(a){var u=v.asn1,p=(u.DERInteger,u.DERSequence,u.ASN1Util.newObject),g=u.cms,m=(g.IssuerAndSerialName,g.SubjectKeyIdentifier,u.x509.X500Name,Ee),w=Error;g.SubjectKeyIdentifier.superclass.constructor.call(this),this.tohex=function(){var F,R=this.params;if(R.cert==null&&R.skid==null)throw new w("property cert nor skid undefined");return R.cert!=null?F=new m(R.cert).getExtSubjectKeyIdentifier().kid.hex:R.skid!=null&&(F=R.skid),p({tag:{tage:"a0",obj:{octstr:{hex:F}}}}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.SubjectKeyIdentifier,v.asn1.ASN1Object),v.asn1.cms.AttributeList=function(a){var u=Error,p=v.asn1,g=p.DERSet,m=p.cms;m.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(w){this.params=w},this.tohex=function(){var w=this.params;if(this.hTLV!=null)return this.hTLV;var F=!0;w.sortflag!=null&&(F=w.sortflag);for(var R=w.array,P=[],B=0;B<R.length;B++){var K=R[B],L=K.attr;if(L=="contentType")P.push(new m.ContentType(K));else if(L=="messageDigest")P.push(new m.MessageDigest(K));else if(L=="signingTime")P.push(new m.SigningTime(K));else if(L=="signingCertificate")P.push(new m.SigningCertificate(K));else if(L=="signingCertificateV2")P.push(new m.SigningCertificateV2(K));else if(L=="signaturePolicyIdentifier")P.push(new v.asn1.cades.SignaturePolicyIdentifier(K));else{if(L!="signatureTimeStamp"&&L!="timeStampToken")throw new u("unknown attr: "+L);P.push(new v.asn1.cades.SignatureTimeStamp(K))}}var O=new g({array:P,sortflag:F});return this.hTLV=O.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.AttributeList,v.asn1.ASN1Object),v.asn1.cms.SignerInfo=function(a){var u=Error,p=v,g=p.asn1,m=g.DERInteger,w=g.DEROctetString,F=g.DERSequence,R=g.DERTaggedObject,P=g.cms,B=P.SignerIdentifier,K=P.AttributeList,L=(P.ContentType,P.EncapsulatedContentInfo,P.MessageDigest,P.SignedData,g.x509.AlgorithmIdentifier),O=p.crypto,U=Te;P.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var W=this.params,Y=W.sigalg,st=new K(W.sattrs).tohex(),vt=U.getKey(W.signkey),At=new O.Signature({alg:Y});At.init(vt),At.updateHex(st);var Mt=At.sign();W.sighex=Mt},this.tohex=function(){var W=this.params,Y=[];if(Y.push(new m({int:W.version})),Y.push(new B(W.id)),Y.push(new L({name:W.hashalg})),W.sattrs!=null){var st=new K(W.sattrs);try{Y.push(new R({tag:"a0",explicit:!1,obj:st}))}catch(vt){throw new u("si sattr error: "+vt)}}if(W.sigalgfield!=null?Y.push(new L({name:W.sigalgfield})):Y.push(new L({name:W.sigalg})),W.sighex==null&&W.signkey!=null&&this.sign(),Y.push(new w({hex:W.sighex})),W.uattrs!=null){st=new K(W.uattrs);try{Y.push(new R({tag:"a1",explicit:!1,obj:st}))}catch(vt){throw new u("si uattr error: "+vt)}}return new F({array:Y}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.SignerInfo,v.asn1.ASN1Object),v.asn1.cms.EncapsulatedContentInfo=function(a){var u=v.asn1,p=u.DERTaggedObject,g=u.DERSequence,m=u.DERObjectIdentifier,w=u.DEROctetString;u.cms.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var F=this.params,R=[];if(R.push(new m(F.type)),F.content!=null&&(F.content.hex!=null||F.content.str!=null)&&F.isDetached!=1){var P=new w(F.content),B=new p({tag:"a0",explicit:!0,obj:P});R.push(B)}return new g({array:R}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(F){this.params=F},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.EncapsulatedContentInfo,v.asn1.ASN1Object),v.asn1.cms.ContentInfo=function(a){var u=v.asn1,p=u.DERTaggedObject,g=u.DERSequence,m=u.DERObjectIdentifier;u.x509.OID.name2obj,v.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var w=this.params,F=[];F.push(new m(w.type));var R=new p({tag:"a0",explicit:!0,obj:w.obj});return F.push(R),new g({array:F}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(w){this.params=w},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.ContentInfo,v.asn1.ASN1Object),v.asn1.cms.SignedData=function(a){var u=v.asn1,p=(u.ASN1Object,u.DERInteger),g=u.DERSet,m=u.DERSequence,w=(u.DERTaggedObject,u.cms),F=w.EncapsulatedContentInfo,R=w.SignerInfo,P=w.ContentInfo,B=w.CertificateSet,K=w.RevocationInfoChoices,L=u.x509.AlgorithmIdentifier;v.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var O=this.params;this._setDigestAlgs(O),this._setContentTypeByEContent(O),this._setMessageDigestByEContent(O),this._setSignerInfoVersion(O),this._setSignedDataVersion(O)},this._setDigestAlgs=function(O){for(var U={},W=O.sinfos,Y=0;Y<W.length;Y++)U[W[Y].hashalg]=1;O.hashalgs=Object.keys(U).sort()},this._setContentTypeByEContent=function(O){for(var U=O.econtent.type,W=O.sinfos,Y=0;Y<W.length;Y++){var st=W[Y];this._getAttrParamByName(st,"contentType").type=U}},this._setMessageDigestByEContent=function(O){var U=O.econtent,W=(O.econtent.type,U.content.hex);W==null&&U.type=="data"&&U.content.str!=null&&(W=Sr(U.content.str));for(var Y=O.sinfos,st=0;st<Y.length;st++){var vt=Y[st],At=vt.hashalg,Mt=this._getAttrParamByName(vt,"messageDigest"),Bt=v.crypto.Util.hashHex(W,At);Mt.hex=Bt}},this._getAttrParamByName=function(O,U){for(var W=O.sattrs.array,Y=0;Y<W.length;Y++)if(W[Y].attr==U)return W[Y]},this._setSignerInfoVersion=function(O){for(var U=O.sinfos,W=0;W<U.length;W++){var Y=U[W],st=1;Y.id.type=="skid"&&(st=3),Y.version=st}},this._setSignedDataVersion=function(O){var U=this._getSignedDataVersion(O);O.version=U},this._getSignedDataVersion=function(O){if(O.revinfos!=null){for(var U=O.revinfos,W=0;W<U.length;W++)if(U[W].ocsp!=null)return 5}var Y=O.sinfos;for(W=0;W<Y.length;W++)if(O.sinfos[W].version==3)return 3;return O.econtent.type!="data"?3:1},this.tohex=function(){var O=this.params;this.getEncodedHexPrepare!=null&&this.getEncodedHexPrepare(),O.fixed!=1&&this.checkAndFixParam();var U=[];U.push(new p({int:O.version}));for(var W=[],Y=0;Y<O.hashalgs.length;Y++){var st=O.hashalgs[Y];W.push(new L({name:st}))}U.push(new g({array:W})),U.push(new F(O.econtent)),O.certs!=null&&U.push(new B(O.certs)),O.revinfos!=null&&U.push(new K(O.revinfos));var vt=[];for(Y=0;Y<O.sinfos.length;Y++){var At=O.sinfos[Y];vt.push(new R(At))}return U.push(new g({array:vt})),new m({array:U}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.getContentInfo=function(){return new P({type:"signed-data",obj:this})},this.getContentInfoEncodedHex=function(){return this.getContentInfo().tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.SignedData,v.asn1.ASN1Object),v.asn1.cms.CertificateSet=function(a){v.asn1.cms.CertificateSet.superclass.constructor.call(this);var u=Error,p=v.asn1,g=p.DERTaggedObject,m=p.DERSet,w=p.ASN1Object;this.params=null,this.tohex=function(){var F,R=this.params,P=[];if(R instanceof Array)F=R;else{if(R.array==null)throw new u("cert array not specified");F=R.array}for(var B=0;B<F.length;B++){var K=Qe(F[B]),L=new w;L.hTLV=K,P.push(L)}var O={array:P};R.sortflag==0&&(O.sortflag=!1);var U=new m(O);return new g({tag:"a0",explicit:!1,obj:U}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.CertificateSet,v.asn1.ASN1Object),v.asn1.cms.RevocationInfoChoices=function(a){v.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.tohex=function(){var u=this.params;if(!u instanceof Array)throw new Error("params is not array");for(var p=[],g=0;g<u.length;g++)p.push(new v.asn1.cms.RevocationInfoChoice(u[g]));return v.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:p}}}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.RevocationInfoChoices,v.asn1.ASN1Object),v.asn1.cms.RevocationInfoChoice=function(a){v.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.tohex=function(){var u=this.params;if(u.crl!=null&&typeof u.crl=="string"){var p=u.crl;return u.crl.indexOf("-----BEGIN")!=-1&&(p=Qe(u.crl)),p}if(u.ocsp!=null)return v.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new v.asn1.cms.OtherRevocationFormat(u)}}).tohex();throw new Error("property crl or ocsp undefined")},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.RevocationInfoChoice,v.asn1.ASN1Object),v.asn1.cms.OtherRevocationFormat=function(a){v.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var u=Error,p=v,g=p.asn1.ASN1Util.newObject,m=p.lang.String.isHex;this.params=null,this.tohex=function(){var w=this.params;if(w.ocsp==null)throw new u("property ocsp not specified");if(!m(w.ocsp)||!Vt.isASN1HEX(w.ocsp))throw new u("ocsp value not ASN.1 hex string");return g({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:w.ocsp}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.cms.OtherRevocationFormat,v.asn1.ASN1Object),v.asn1.cms.CMSUtil=new function(){},v.asn1.cms.CMSUtil.newSignedData=function(a){return new v.asn1.cms.SignedData(a)},v.asn1.cms.CMSUtil.verifySignedData=function(a){var u=v,p=u.asn1,g=p.cms,m=(g.SignerInfo,g.SignedData,g.SigningTime,g.SigningCertificate,g.SigningCertificateV2,p.cades.SignaturePolicyIdentifier,u.lang.String.isHex),w=Vt,F=w.getVbyList,R=w.getTLVbyList,P=w.getIdxbyList,B=w.getChildIdx,K=w.getTLV,L=w.oidname,O=u.crypto.Util.hashHex;a.cms===void 0&&m(a.cms);var U=a.cms,W=function(At,Mt){var Bt=Mt.idx;Mt.signerid_issuer1=R(At,Bt,[1,0],"30"),Mt.signerid_serial1=F(At,Bt,[1,1],"02"),Mt.hashalg=L(F(At,Bt,[2,0],"06"));var Q=P(At,Bt,[3],"a0");Mt.idxSignedAttrs=Q,Y(At,Mt,Q);var ut=B(At,Bt).length;if(ut<6)throw"malformed SignerInfo";Mt.sigalg=L(F(At,Bt,[ut-2,0],"06")),Mt.sigval=F(At,Bt,[ut-1],"04")},Y=function(At,Mt,Bt){var Q=B(At,Bt);Mt.signedAttrIdxList=Q;for(var ut=0;ut<Q.length;ut++){var pt,it=Q[ut],bt=F(At,it,[0],"06");bt==="2a864886f70d010905"?(pt=Le(F(At,it,[1,0])),Mt.saSigningTime=pt):bt==="2a864886f70d010904"&&(pt=F(At,it,[1,0],"04"),Mt.saMessageDigest=pt)}},st=function(At,Mt,Bt,Q){Bt.verifyDetail={};var ut=Bt.verifyDetail,pt=Mt.parse.econtent,it=Bt.hashalg,bt=Bt.saMessageDigest;ut.validMessageDigest=!1,O(pt,it)===bt&&(ut.validMessageDigest=!0),function(X,dt,mt,Rt){var Ft,jt=dt.parse.certsIdx;if(dt.certs===void 0){Ft=[],dt.certkeys=[];for(var re=B(X,jt),te=0;te<re.length;te++){var Et=K(X,re[te]),kt=new Ee;kt.readCertHex(Et),Ft[te]=kt,dt.certkeys[te]=kt.getPublicKey()}dt.certs=Ft}else Ft=dt.certs;for(dt.cccc=Ft.length,dt.cccci=re.length,te=0;te<Ft.length;te++){var Tt=kt.getIssuerHex(),Qt=kt.getSerialNumberHex();mt.signerid_issuer1===Tt&&mt.signerid_serial1===Qt&&(mt.certkey_idx=te)}}(At,Mt,Bt),ut.validSignatureValue=!1;var $t=Bt.sigalg,Wt="31"+K(At,Bt.idxSignedAttrs).substr(2);Bt.signedattrshex=Wt;var Ht=Mt.certs[Bt.certkey_idx].getPublicKey(),Se=new v.crypto.Signature({alg:$t});Se.init(Ht),Se.updateHex(Wt);var zt=Se.verify(Bt.sigval);ut.validSignatureValue_isValid=zt,zt===!0&&(ut.validSignatureValue=!0),Bt.isValid=!1,ut.validMessageDigest&&ut.validSignatureValue&&(Bt.isValid=!0)},vt={isValid:!1,parse:{}};return function(At,Mt){if(F(At,0,[0],"06")!=="2a864886f70d010702")return Mt;Mt.cmsType="signedData",Mt.econtent=F(At,0,[1,0,2,1,0]),function(Bt,Q){for(var ut,pt=3;pt<6;pt++)if((ut=P(Bt,0,[1,0,pt]))!==void 0){var it=Bt.substr(ut,2);it==="a0"&&(Q.certsIdx=ut),it==="a1"&&(Q.revinfosIdx=ut),it==="31"&&(Q.signerinfosIdx=ut)}}(At,Mt),Mt.signerInfos=[],function(Bt,Q){var ut=Q.signerinfosIdx;if(ut!==void 0){var pt=B(Bt,ut);Q.signerInfoIdxList=pt;for(var it=0;it<pt.length;it++){var bt={idx:pt[it]};W(Bt,bt),Q.signerInfos.push(bt)}}}(At,Mt)}(U,vt.parse),function(At,Mt){for(var Bt=Mt.parse.signerInfos,Q=Bt.length,ut=!0,pt=0;pt<Q;pt++){var it=Bt[pt];st(At,Mt,it),it.isValid||(ut=!1)}Mt.isValid=ut}(U,vt),vt},v.asn1.cms.CMSParser=function(){var a=Error,u=Ee,p=new u,g=Vt,m=g.getV,w=g.getTLV,F=(g.getIdxbyList,g.getTLVbyList),R=g.getTLVbyListEx,P=g.getVbyList,B=g.getVbyListEx,K=g.getChildIdx;this.getCMSSignedData=function(L){var O=F(L,0,[1,0]);return this.getSignedData(O)},this.getSignedData=function(L){var O=K(L,0),U={},W=m(L,O[0]),Y=parseInt(W,16);U.version=Y;var st=w(L,O[1]);U.hashalgs=this.getHashAlgArray(st);var vt=w(L,O[2]);U.econtent=this.getEContent(vt);var At=R(L,0,["[0]"]);At!=null&&(U.certs=this.getCertificateSet(At)),R(L,0,["[1]"]);var Mt=R(L,0,[3]);return U.sinfos=this.getSignerInfos(Mt),U},this.getHashAlgArray=function(L){for(var O=K(L,0),U=new u,W=[],Y=0;Y<O.length;Y++){var st=w(L,O[Y]),vt=U.getAlgorithmIdentifierName(st);W.push(vt)}return W},this.getEContent=function(L){var O={},U=P(L,0,[0]),W=P(L,0,[1,0]);return O.type=v.asn1.x509.OID.oid2name(Vt.hextooidstr(U)),O.content={hex:W},O},this.getSignerInfos=function(L){for(var O=[],U=K(L,0),W=0;W<U.length;W++){var Y=w(L,U[W]),st=this.getSignerInfo(Y);O.push(st)}return O},this.getSignerInfo=function(L){var O={},U=K(L,0),W=g.getInt(L,U[0],-1);W!=-1&&(O.version=W);var Y=w(L,U[1]),st=this.getIssuerAndSerialNumber(Y);O.id=st;var vt=w(L,U[2]),At=p.getAlgorithmIdentifierName(vt);O.hashalg=At;var Mt=R(L,0,["[0]"]);if(Mt!=null){var Bt=this.getAttributeList(Mt);O.sattrs=Bt}var Q=R(L,0,[3]),ut=p.getAlgorithmIdentifierName(Q);O.sigalg=ut;var pt=B(L,0,[4]);O.sighex=pt;var it=R(L,0,["[1]"]);if(it!=null){var bt=this.getAttributeList(it);O.uattrs=bt}return O},this.getSignerIdentifier=function(L){if(L.substr(0,2)=="30")return this.getIssuerAndSerialNumber(L);throw new Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(L){var O={type:"isssn"},U=K(L,0),W=w(L,U[0]);O.issuer=p.getX500Name(W);var Y=m(L,U[1]);return O.serial={hex:Y},O},this.getAttributeList=function(L){for(var O=[],U=K(L,0),W=0;W<U.length;W++){var Y=w(L,U[W]),st=this.getAttribute(Y);O.push(st)}return{array:O}},this.getAttribute=function(L){var O={},U=K(L,0),W=g.getOID(L,U[0]),Y=v.asn1.x509.OID.oid2name(W);O.attr=Y;var st=w(L,U[1]),vt=K(st,0);if(vt.length==1)O.valhex=w(st,vt[0]);else{for(var At=[],Mt=0;Mt<vt.length;Mt++)At.push(w(st,vt[Mt]));O.valhex=At}return Y=="contentType"?this.setContentType(O):Y=="messageDigest"?this.setMessageDigest(O):Y=="signingTime"?this.setSigningTime(O):Y=="signingCertificate"?this.setSigningCertificate(O):Y=="signingCertificateV2"?this.setSigningCertificateV2(O):Y=="signaturePolicyIdentifier"&&this.setSignaturePolicyIdentifier(O),O},this.setContentType=function(L){var O=g.getOIDName(L.valhex,0,null);O!=null&&(L.type=O,delete L.valhex)},this.setSigningTime=function(L){var O=Le(m(L.valhex,0));L.str=O,delete L.valhex},this.setMessageDigest=function(L){var O=m(L.valhex,0);L.hex=O,delete L.valhex},this.setSigningCertificate=function(L){var O=K(L.valhex,0);if(O.length>0){for(var U=w(L.valhex,O[0]),W=K(U,0),Y=[],st=0;st<W.length;st++){var vt=w(U,W[st]),At=this.getESSCertID(vt);Y.push(At)}L.array=Y}if(O.length>1){var Mt=w(L.valhex,O[1]);L.polhex=Mt}delete L.valhex},this.setSignaturePolicyIdentifier=function(L){var O=K(L.valhex,0);if(O.length>0){var U=g.getOID(L.valhex,O[0]);L.oid=U}if(O.length>1){var W=new u,Y=K(L.valhex,O[1]),st=w(L.valhex,Y[0]),vt=W.getAlgorithmIdentifierName(st);L.alg=vt;var At=m(L.valhex,Y[1]);L.hash=At}delete L.valhex},this.setSigningCertificateV2=function(L){var O=K(L.valhex,0);if(O.length>0){for(var U=w(L.valhex,O[0]),W=K(U,0),Y=[],st=0;st<W.length;st++){var vt=w(U,W[st]),At=this.getESSCertIDv2(vt);Y.push(At)}L.array=Y}if(O.length>1){var Mt=w(L.valhex,O[1]);L.polhex=Mt}delete L.valhex},this.getESSCertID=function(L){var O={},U=K(L,0);if(U.length>0){var W=m(L,U[0]);O.hash=W}if(U.length>1){var Y=w(L,U[1]),st=this.getIssuerSerial(Y);st.serial!=null&&(O.serial=st.serial),st.issuer!=null&&(O.issuer=st.issuer)}return O},this.getESSCertIDv2=function(L){var O={},U=K(L,0);if(U.length<1||3<U.length)throw new a("wrong number of elements");var W=0;if(L.substr(U[0],2)=="30"){var Y=w(L,U[0]);O.alg=p.getAlgorithmIdentifierName(Y),W++}else O.alg="sha256";var st=m(L,U[W]);if(O.hash=st,U.length>W+1){var vt=w(L,U[W+1]),At=this.getIssuerSerial(vt);O.issuer=At.issuer,O.serial=At.serial}return O},this.getIssuerSerial=function(L){var O={},U=K(L,0),W=w(L,U[0]),Y=p.getGeneralNames(W)[0].dn;O.issuer=Y;var st=m(L,U[1]);return O.serial={hex:st},O},this.getCertificateSet=function(L){for(var O=K(L,0),U=[],W=0;W<O.length;W++){var Y=w(L,O[W]);if(Y.substr(0,2)=="30"){var st=Xe(Y,"CERTIFICATE");U.push(st)}}return{array:U,sortflag:!1}}},v!==void 0&&v||(v={}),v.asn1!==void 0&&v.asn1||(v.asn1={}),v.asn1.tsp!==void 0&&v.asn1.tsp||(v.asn1.tsp={}),v.asn1.tsp.TimeStampToken=function(a){var u=v.asn1.tsp;u.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var p=new u.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=p.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.tsp.TimeStampToken,v.asn1.cms.SignedData),v.asn1.tsp.TSTInfo=function(a){var u=v.asn1,p=u.DERSequence,g=u.DERInteger,m=u.DERBoolean,w=u.DERGeneralizedTime,F=u.DERObjectIdentifier,R=u.DERTaggedObject,P=u.tsp,B=P.MessageImprint,K=P.Accuracy,L=(u.x509.X500Name,u.x509.GeneralName);if(P.TSTInfo.superclass.constructor.call(this),this.dVersion=new g({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.tohex=function(){var O=[this.dVersion];if(this.dPolicy==null)throw new Error("policy shall be specified.");if(O.push(this.dPolicy),this.dMessageImprint==null)throw new Error("messageImprint shall be specified.");if(O.push(this.dMessageImprint),this.dSerial==null)throw new Error("serialNumber shall be specified.");if(O.push(this.dSerial),this.dGenTime==null)throw new Error("genTime shall be specified.");O.push(this.dGenTime),this.dAccuracy!=null&&O.push(this.dAccuracy),this.dOrdering!=null&&O.push(this.dOrdering),this.dNonce!=null&&O.push(this.dNonce),this.dTsa!=null&&O.push(this.dTsa);var U=new p({array:O});return this.hTLV=U.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0){if(typeof a.policy=="string"){if(!a.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new F({oid:a.policy})}a.messageImprint!==void 0&&(this.dMessageImprint=new B(a.messageImprint)),a.serial!==void 0&&(this.dSerial=new g(a.serial)),a.genTime!==void 0&&(this.dGenTime=new w(a.genTime)),a.accuracy!==void 0&&(this.dAccuracy=new K(a.accuracy)),a.ordering!==void 0&&a.ordering==1&&(this.dOrdering=new m),a.nonce!==void 0&&(this.dNonce=new g(a.nonce)),a.tsa!==void 0&&(this.dTsa=new R({tag:"a0",explicit:!0,obj:new L({dn:a.tsa})}))}},Yt(v.asn1.tsp.TSTInfo,v.asn1.ASN1Object),v.asn1.tsp.Accuracy=function(a){var u=v.asn1,p=u.ASN1Util.newObject;u.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.tohex=function(){var g=this.params,m=[];return g.seconds!=null&&typeof g.seconds=="number"&&m.push({int:g.seconds}),g.millis!=null&&typeof g.millis=="number"&&m.push({tag:{tagi:"80",obj:{int:g.millis}}}),g.micros!=null&&typeof g.micros=="number"&&m.push({tag:{tagi:"81",obj:{int:g.micros}}}),p({seq:m}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.tsp.Accuracy,v.asn1.ASN1Object),v.asn1.tsp.MessageImprint=function(a){var u=v.asn1,p=u.DERSequence,g=u.DEROctetString,m=u.x509.AlgorithmIdentifier;u.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.tohex=function(){var w=this.params,F=new m({name:w.alg}),R=new g({hex:w.hash});return new p({array:[F,R]}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(v.asn1.tsp.MessageImprint,v.asn1.ASN1Object),v.asn1.tsp.TimeStampReq=function(a){var u=v.asn1,p=u.DERSequence,g=u.DERInteger,m=u.DERBoolean,w=(u.ASN1Object,u.DERObjectIdentifier),F=u.tsp,R=F.MessageImprint;F.TimeStampReq.superclass.constructor.call(this),this.params=null,this.tohex=function(){var P=this.params,B=[];return B.push(new g({int:1})),P.messageImprint instanceof v.asn1.ASN1Object?B.push(P.messageImprint):B.push(new R(P.messageImprint)),P.policy!=null&&B.push(new w(P.policy)),P.nonce!=null&&B.push(new g(P.nonce)),P.certreq==1&&B.push(new m),new p({array:B}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.tsp.TimeStampReq,v.asn1.ASN1Object),v.asn1.tsp.TimeStampResp=function(a){var u=v.asn1,p=u.DERSequence,g=(u.ASN1Object,u.tsp),m=g.PKIStatusInfo;g.TimeStampResp.superclass.constructor.call(this),this.params=null,this.tohex=function(){var w=this.params,F=[];if(w.econtent!=null||w.tst!=null)if(w.statusinfo!=null?F.push(new m(w.statusinfo)):F.push(new m("granted")),w.econtent!=null)F.push(new g.TimeStampToken(w).getContentInfo());else{if(!(w.tst instanceof u.ASN1Object))throw new Error("improper member tst value");F.push(w.tst)}else{if(w.statusinfo==null)throw new Error("parameter for token nor statusinfo not specified");F.push(new m(w.statusinfo))}return new p({array:F}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.tsp.TimeStampResp,v.asn1.ASN1Object),v.asn1.tsp.PKIStatusInfo=function(a){var u=Error,p=v.asn1,g=p.DERSequence,m=p.tsp,w=m.PKIStatus,F=m.PKIFreeText,R=m.PKIFailureInfo;m.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var P=this.params,B=[];if(typeof P=="string")B.push(new w(P));else{if(P.status==null)throw new u("property 'status' unspecified");B.push(new w(P.status)),P.statusstr!=null&&B.push(new F(P.statusstr)),P.failinfo!=null&&B.push(new R(P.failinfo))}return new g({array:B}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.tsp.PKIStatusInfo,v.asn1.ASN1Object),v.asn1.tsp.PKIStatus=function(a){var u=Error,p=v.asn1,g=p.DERInteger;p.tsp.PKIStatus.superclass.constructor.call(this);var m={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.tohex=function(){var w,F=this.params;if(typeof F=="string")try{w=m[F]}catch{throw new u("undefined name: "+F)}else{if(typeof F!="number")throw new u("unsupported params");w=F}return new g({int:w}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.tsp.PKIStatus,v.asn1.ASN1Object),v.asn1.tsp.PKIFreeText=function(a){var u=Error,p=v.asn1,g=p.DERSequence,m=p.DERUTF8String;p.tsp.PKIFreeText.superclass.constructor.call(this),this.params=null,this.tohex=function(){var w=this.params;if(!w instanceof Array)throw new u("wrong params: not array");for(var F=[],R=0;R<w.length;R++)F.push(new m({str:w[R]}));return new g({array:F}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.tsp.PKIFreeText,v.asn1.ASN1Object),v.asn1.tsp.PKIFailureInfo=function(a){var u=Error,p=v.asn1,g=p.DERBitString,m=p.tsp.PKIFailureInfo,w={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};m.superclass.constructor.call(this),this.params=null,this.getBinValue=function(){var F=this.params,R=0;if(typeof F=="number"&&0<=F&&F<=25){for(var P=(R|=1<<F).toString(2),B="",K=P.length-1;K>=0;K--)B+=P[K];return B}if(typeof F=="string"&&w[F]!=null)return fr([F],w);if(typeof F=="object"&&F.length!=null)return fr(F,w);throw new u("wrong params")},this.tohex=function(){this.params;var F=this.getBinValue();return new g({bin:F}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.tsp.PKIFailureInfo,v.asn1.ASN1Object),v.asn1.tsp.AbstractTSAAdapter=function(a){this.getTSTHex=function(u,p){throw"not implemented yet"}},v.asn1.tsp.SimpleTSAAdapter=function(a){var u=v,p=u.asn1.tsp,g=u.crypto.Util.hashHex;p.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(m,w){var F=g(m,w);this.params.econtent.content.messageImprint={alg:w,hash:F},this.params.econtent.content.serial={int:this.serial++};var R=Math.floor(1e9*Math.random());return this.params.econtent.content.nonce={int:R},new p.TimeStampToken(this.params).getContentInfoEncodedHex()},a!==void 0&&(this.params=a)},Yt(v.asn1.tsp.SimpleTSAAdapter,v.asn1.tsp.AbstractTSAAdapter),v.asn1.tsp.FixedTSAAdapter=function(a){var u=v,p=u.asn1.tsp,g=u.crypto.Util.hashHex;p.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(m,w){var F=g(m,w);return this.params.econtent.content.messageImprint={alg:w,hash:F},new p.TimeStampToken(this.params).getContentInfoEncodedHex()},a!==void 0&&(this.params=a)},Yt(v.asn1.tsp.FixedTSAAdapter,v.asn1.tsp.AbstractTSAAdapter),v.asn1.tsp.TSPUtil=new function(){},v.asn1.tsp.TSPUtil.newTimeStampToken=function(a){return new v.asn1.tsp.TimeStampToken(a)},v.asn1.tsp.TSPUtil.parseTimeStampReq=function(a){return new v.asn1.tsp.TSPParser().getTimeStampReq(a)},v.asn1.tsp.TSPUtil.parseMessageImprint=function(a){return new v.asn1.tsp.TSPParser().getMessageImprint(a)},v.asn1.tsp.TSPParser=function(){var a=new Ee,u=Vt,p=u.getV,g=u.getTLV,m=u.getIdxbyList,w=(u.getTLVbyListEx,u.getChildIdx),F=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],R={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(P){var B=w(P,0);if(B.length==1)return this.getPKIStatusInfo(g(P,B[0]));if(B.length>1){var K=this.getPKIStatusInfo(g(P,B[0])),L=g(P,B[1]),O=this.getToken(L);return O.statusinfo=K,O}},this.getToken=function(P){var B=new v.asn1.cms.CMSParser().getCMSSignedData(P);return this.setTSTInfo(B),B},this.setTSTInfo=function(P){var B=P.econtent;if(B.type=="tstinfo"){var K=B.content.hex,L=this.getTSTInfo(K);B.content=L}},this.getTSTInfo=function(P){var B={},K=w(P,0),L=p(P,K[1]);B.policy=Tr(L);var O=g(P,K[2]);B.messageImprint=this.getMessageImprint(O);var U=p(P,K[3]);B.serial={hex:U};var W=p(P,K[4]);B.genTime={str:Le(W)};var Y=0;if(K.length>5&&P.substr(K[5],2)=="30"){var st=g(P,K[5]);B.accuracy=this.getAccuracy(st),Y++}if(K.length>5+Y&&P.substr(K[5+Y],2)=="01"&&(p(P,K[5+Y])=="ff"&&(B.ordering=!0),Y++),K.length>5+Y&&P.substr(K[5+Y],2)=="02"){var vt=p(P,K[5+Y]);B.nonce={hex:vt},Y++}if(K.length>5+Y&&P.substr(K[5+Y],2)=="a0"){var At=g(P,K[5+Y]);At="30"+At.substr(2),pGeneralNames=a.getGeneralNames(At);var Mt=pGeneralNames[0].dn;B.tsa=Mt,Y++}if(K.length>5+Y&&P.substr(K[5+Y],2)=="a1"){var Bt=g(P,K[5+Y]);Bt="30"+Bt.substr(2);var Q=a.getExtParamArray(Bt);B.ext=Q,Y++}return B},this.getAccuracy=function(P){for(var B={},K=w(P,0),L=0;L<K.length;L++){var O=P.substr(K[L],2),U=p(P,K[L]),W=parseInt(U,16);O=="02"?B.seconds=W:O=="80"?B.millis=W:O=="81"&&(B.micros=W)}return B},this.getMessageImprint=function(P){if(P.substr(0,2)!="30")throw new Error("head of messageImprint hex shall be x30");var B={},K=(w(P,0),m(P,0,[0,0])),L=p(P,K),O=u.hextooidstr(L),U=v.asn1.x509.OID.oid2name(O);if(U=="")throw new Error("hashAlg name undefined: "+O);var W=U,Y=m(P,0,[1]);return B.alg=W,B.hash=p(P,Y),B},this.getPKIStatusInfo=function(P){var B={},K=w(P,0),L=0;try{var O=p(P,K[0]),U=parseInt(O,16);B.status=F[U]}catch{}if(K.length>1&&P.substr(K[1],2)=="30"){var W=g(P,K[1]);B.statusstr=this.getPKIFreeText(W),L++}if(K.length>L&&P.substr(K[1+L],2)=="03"){var Y=g(P,K[1+L]);B.failinfo=this.getPKIFailureInfo(Y)}return B},this.getPKIFreeText=function(P){for(var B=[],K=w(P,0),L=0;L<K.length;L++)B.push(u.getString(P,K[L]));return B},this.getPKIFailureInfo=function(P){var B=u.getInt(P,0);return R[B]!=null?R[B]:B},this.getTimeStampReq=function(P){var B={certreq:!1},K=w(P,0);if(K.length<2)throw new Error("TimeStampReq must have at least 2 items");var L=g(P,K[1]);B.messageImprint=v.asn1.tsp.TSPUtil.parseMessageImprint(L);for(var O=2;O<K.length;O++){var U=K[O],W=P.substr(U,2);if(W=="06"){var Y=p(P,U);B.policy=u.hextooidstr(Y)}W=="02"&&(B.nonce=p(P,U)),W=="01"&&(B.certreq=!0)}return B}},v!==void 0&&v||(v={}),v.asn1!==void 0&&v.asn1||(v.asn1={}),v.asn1.cades!==void 0&&v.asn1.cades||(v.asn1.cades={}),v.asn1.cades.SignaturePolicyIdentifier=function(a){var u=v.asn1.cades,p=u.SignaturePolicyId;u.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new p(this.params)]},this.setByParam=function(g){this.params=g},a!=null&&this.setByParam(a)},Yt(v.asn1.cades.SignaturePolicyIdentifier,v.asn1.cms.Attribute),v.asn1.cades.SignaturePolicyId=function(a){var u=v.asn1,p=u.DERSequence,g=u.DERObjectIdentifier,m=(u.x509.AlgorithmIdentifier,u.cades),w=m.SignaturePolicyId,F=m.OtherHashAlgAndValue;w.superclass.constructor.call(this),this.params=null,this.tohex=function(){var R=this.params,P=[];return P.push(new g(R.oid)),P.push(new F(R)),new p({array:P}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(R){this.params=R},a!=null&&this.setByParam(a)},Yt(v.asn1.cades.SignaturePolicyId,v.asn1.ASN1Object),v.asn1.cades.OtherHashAlgAndValue=function(a){var u=Error,p=v.asn1,g=p.DERSequence,m=p.DEROctetString,w=p.x509.AlgorithmIdentifier;p.cades.OtherHashAlgAndValue.superclass.constructor.call(this),this.params=null,this.tohex=function(){var F=this.params;if(F.alg==null)throw new u("property 'alg' not specified");if(F.hash==null&&F.cert==null)throw new u("property 'hash' nor 'cert' not specified");var R=null;if(F.hash!=null)R=F.hash;else if(F.cert!=null){if(typeof F.cert!="string")throw new u("cert not string");var P=F.cert;F.cert.indexOf("-----BEGIN")!=-1&&(P=Qe(F.cert)),R=v.crypto.Util.hashHex(P,F.alg)}var B=[];return B.push(new w({name:F.alg})),B.push(new m({hex:R})),new g({array:B}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.cades.OtherHashAlgAndValue,v.asn1.ASN1Object),v.asn1.cades.OtherHashValue=function(a){v.asn1.cades.OtherHashValue.superclass.constructor.call(this);var u=Error,p=v,g=(p.lang.String.isHex,p.asn1.DEROctetString);p.crypto.Util.hashHex,this.params=null,this.tohex=function(){var m=this.params;if(m.hash==null&&m.cert==null)throw new u("hash or cert not specified");var w=null;if(m.hash!=null)w=m.hash;else if(m.cert!=null){if(typeof m.cert!="string")throw new u("cert not string");var F=m.cert;m.cert.indexOf("-----BEGIN")!=-1&&(F=Qe(m.cert)),w=v.crypto.Util.hashHex(F,"sha1")}return new g({hex:w}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.cades.OtherHashValue,v.asn1.ASN1Object),v.asn1.cades.SignatureTimeStamp=function(a){var u=Error,p=v,g=p.lang.String.isHex,m=p.asn1,w=m.ASN1Object;m.x509,m.cades.SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var F=this.params;if(F.tst!=null){if(g(F.tst))return(R=new w).hTLV=F.tst,[R];if(F.tst instanceof w)return[F.tst];throw new u("params.tst has wrong value")}if(F.res!=null){var R,P=F.res;if(P instanceof w&&(P=P.tohex()),typeof P!="string"||!g(P))throw new u("params.res has wrong value");return Vt.getTLVbyList(P,0,[1]),(R=new w).hTLV=F.tst,[R]}},a!=null&&this.setByParam(a)},Yt(v.asn1.cades.SignatureTimeStamp,v.asn1.cms.Attribute),v.asn1.cades.CompleteCertificateRefs=function(a){var u=Error,p=v,g=p.asn1,m=g.DERSequence,w=g.cades,F=w.OtherCertID,R=p.lang.String.isHex;w.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var P=this.params,B=[],K=0;K<P.array.length;K++){var L=P.array[K];if(typeof L=="string")if(L.indexOf("-----BEGIN")!=-1)L={cert:L};else{if(!R(L))throw new u("unsupported value: "+L);L={hash:L}}P.alg!=null&&L.alg==null&&(L.alg=P.alg),P.hasis!=null&&L.hasis==null&&(L.hasis=P.hasis);var O=new F(L);B.push(O)}return[new m({array:B})]},a!=null&&this.setByParam(a)},Yt(v.asn1.cades.CompleteCertificateRefs,v.asn1.cms.Attribute),v.asn1.cades.OtherCertID=function(a){var u=v.asn1,p=u.DERSequence,g=u.cms.IssuerSerial,m=u.cades,w=m.OtherHashValue,F=m.OtherHashAlgAndValue;m.OtherCertID.superclass.constructor.call(this),this.params=a,this.tohex=function(){var R=this.params;typeof R=="string"&&(R.indexOf("-----BEGIN")!=-1?R={cert:R}:_isHex(R)&&(R={hash:R}));var P,B=[];if(P=R.alg!=null?new F(R):new w(R),B.push(P),R.cert!=null&&R.hasis==1||R.issuer!=null&&R.serial!=null){var K=new g(R);B.push(K)}return new p({array:B}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.cades.OtherCertID,v.asn1.ASN1Object),v.asn1.cades.OtherHash=function(a){var u=v,p=u.asn1,g=(p.cms,p.cades),m=g.OtherHashAlgAndValue,w=g.OtherHashValue,F=(u.crypto.Util.hashHex,u.lang.String.isHex);g.OtherHash.superclass.constructor.call(this),this.params=null,this.tohex=function(){var R=this.params;return typeof R=="string"&&(R.indexOf("-----BEGIN")!=-1?R={cert:R}:F(R)&&(R={hash:R})),(R.alg!=null?new m(R):new w(R)).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.cades.OtherHash,v.asn1.ASN1Object),v.asn1.cades.CAdESUtil=new function(){},v.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(a){return new v.asn1.cms.CMSParser().getCMSSignedData(a)},v.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(a,u,p){var g=Vt,m=g.getChildIdx,w=g.getTLV,F=g.getV,R=v.asn1,P=R.ASN1Object,B=R.cms,K=B.AttributeList,L=B.SignerInfo,O={},U=m(a,u);if(U.length!=6)throw"not supported items for SignerInfo (!=6)";var W=U.shift();O.version=w(a,W);var Y=U.shift();O.si=w(a,Y);var st=U.shift();O.digalg=w(a,st);var vt=U.shift();O.sattrs=w(a,vt);var At=U.shift();O.sigalg=w(a,At);var Mt=U.shift();O.sig=w(a,Mt),O.sigval=F(a,Mt);var Bt=null;return O.obj=new L,(Bt=new P).hTLV=O.version,O.obj.dCMSVersion=Bt,(Bt=new P).hTLV=O.si,O.obj.dSignerIdentifier=Bt,(Bt=new P).hTLV=O.digalg,O.obj.dDigestAlgorithm=Bt,(Bt=new P).hTLV=O.sattrs,O.obj.dSignedAttrs=Bt,(Bt=new P).hTLV=O.sigalg,O.obj.dSigAlg=Bt,(Bt=new P).hTLV=O.sig,O.obj.dSig=Bt,O.obj.dUnsignedAttrs=new K,O},v.asn1.csr!==void 0&&v.asn1.csr||(v.asn1.csr={}),v.asn1.csr.CertificationRequest=function(a){var u=v.asn1,p=u.DERBitString,g=u.DERSequence,m=u.csr,w=(u.x509,m.CertificationRequestInfo);m.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(F){this.params=F},this.sign=function(){var F=new w(this.params).tohex(),R=new v.crypto.Signature({alg:this.params.sigalg});R.init(this.params.sbjprvkey),R.updateHex(F);var P=R.sign();this.params.sighex=P},this.getPEM=function(){return Xe(this.tohex(),"CERTIFICATE REQUEST")},this.tohex=function(){var F=this.params,R=new v.asn1.csr.CertificationRequestInfo(this.params),P=new v.asn1.x509.AlgorithmIdentifier({name:F.sigalg});if(F.sighex==null&&F.sbjprvkey!=null&&this.sign(),F.sighex==null)throw new Error("sighex or sbjprvkey parameter not defined");var B=new p({hex:"00"+F.sighex});return new g({array:[R,P,B]}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(v.asn1.csr.CertificationRequest,v.asn1.ASN1Object),v.asn1.csr.CertificationRequestInfo=function(a){var u=v.asn1,p=(u.DERBitString,u.DERSequence),g=u.DERInteger,m=u.DERUTF8String,w=u.DERTaggedObject,F=u.ASN1Util.newObject,R=u.csr,P=u.x509,B=P.X500Name,K=P.Extensions,L=P.SubjectPublicKeyInfo;R.AttributeList,R.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(O){O!=null&&(this.params=O)},this.tohex=function(){var O=this.params,U=[];if(U.push(new g({int:0})),U.push(new B(O.subject)),U.push(new L(Te.getKey(O.sbjpubkey))),O.attrs!=null){var W=function(vt){for(var At=Error,Mt=v.asn1.x509.Extensions,Bt=[],Q=0;Q<vt.length;Q++){var ut=vt[Q],pt=ut.attr;if(pt=="extensionRequest"){var it={seq:[{oid:"1.2.840.113549.1.9.14"},{set:[new Mt(ut.ext)]}]};Bt.push(it)}else if(pt=="unstructuredName")it={seq:[{oid:"1.2.840.113549.1.9.2"},{set:ut.names}]},Bt.push(it);else{if(pt!="challengePassword")throw new At("unknown CSR attribute");it={seq:[{oid:"1.2.840.113549.1.9.7"},{set:[{utf8str:ut.password}]}]},Bt.push(it)}}return{set:Bt}}(O.attrs),Y=F({tag:{tage:"a0",obj:W}});U.push(Y)}else if(O.extreq!=null){var st=new K(O.extreq);Y=F({tag:{tage:"a0",obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[st]}]}}}),U.push(Y)}else U.push(new w({tag:"a0",explicit:!1,obj:new m({str:""})}));return new p({array:U}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!=null&&this.setByParam(a)},Yt(v.asn1.csr.CertificationRequestInfo,v.asn1.ASN1Object),v.asn1.csr.AttributeList=function(a){},Yt(v.asn1.csr.AttributeList,v.asn1.ASN1Object),v.asn1.csr.CSRUtil=new function(){},v.asn1.csr.CSRUtil.newCSRPEM=function(a){return new v.asn1.csr.CertificationRequest(a).getPEM()},v.asn1.csr.CSRUtil.getParam=function(a,u){var p=Vt,g=p.getV,m=p.getIdxbyList,w=p.getTLVbyList,F=p.getTLVbyListEx,R=p.getVbyListEx,P={};if(a.indexOf("-----BEGIN CERTIFICATE REQUEST")==-1)throw new Error("argument is not PEM file");var B=Qe(a,"CERTIFICATE REQUEST");u&&(P.tbs=w(B,0,[0]));try{var K=F(B,0,[0,1]);if(K=="3000")P.subject={};else{var L=new Ee;P.subject=L.getX500Name(K)}}catch{}var O=F(B,0,[0,2]),U=Te.getKey(O,null,"pkcs8pub");P.sbjpubkey=Te.getPEM(U,"PKCS8PUB");var W,Y,st=(Y=m(W=B,0,[0,3,0,0],"06"),g(W,Y)!="2a864886f70d01090e"?null:w(W,0,[0,3,0,1,0],"30"));L=new Ee,st!=null&&(P.extreq=L.getExtParamArray(st));try{var vt=F(B,0,[1],"30");L=new Ee,P.sigalg=L.getAlgorithmIdentifierName(vt)}catch{}try{var At=R(B,0,[2]);P.sighex=At}catch{}return P},v.asn1.csr.CSRUtil.verifySignature=function(a){try{var u=null;if(typeof a=="string"&&a.indexOf("-----BEGIN CERTIFICATE REQUEST")!=-1?u=v.asn1.csr.CSRUtil.getParam(a,!0):typeof a=="object"&&a.sbjpubkey!=null&&a.sigalg!=null&&a.sighex!=null&&a.tbs!=null&&(u=a),u==null)return!1;var p=new v.crypto.Signature({alg:u.sigalg});return p.init(u.sbjpubkey),p.updateHex(u.tbs),p.verify(u.sighex)}catch(g){return alert(g),!1}},v!==void 0&&v||(v={}),v.asn1!==void 0&&v.asn1||(v.asn1={}),v.asn1.ocsp!==void 0&&v.asn1.ocsp||(v.asn1.ocsp={}),v.asn1.ocsp.DEFAULT_HASH="sha1",v.asn1.ocsp.OCSPResponse=function(a){v.asn1.ocsp.OCSPResponse.superclass.constructor.call(this),v.asn1.DEREnumerated;var u=v.asn1.ASN1Util.newObject,p=v.asn1.ocsp.ResponseBytes,g=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var m=this.params.resstatus;return typeof m=="number"?m:typeof m!="string"?-1:g.indexOf(m)},this.setByParam=function(m){this.params=m},this.tohex=function(){var m=this.params,w=this._getStatusCode();if(w==-1)throw new Error("responseStatus not supported: "+m.resstatus);if(w!=0)return u({seq:[{enum:{int:w}}]}).tohex();var F=new p(m);return u({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:F}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(v.asn1.ocsp.OCSPResponse,v.asn1.ASN1Object),v.asn1.ocsp.ResponseBytes=function(a){v.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var u=v.asn1,p=u.DERSequence,g=u.DERObjectIdentifier,m=u.DEROctetString,w=u.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(F){this.params=F},this.tohex=function(){var F=this.params;if(F.restype!="ocspBasic")throw new Error("not supported responseType: "+F.restype);var R=new w(F),P=[];return P.push(new g({name:"ocspBasic"})),P.push(new m({hex:R.tohex()})),new p({array:P}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(v.asn1.ocsp.ResponseBytes,v.asn1.ASN1Object),v.asn1.ocsp.BasicOCSPResponse=function(a){v.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var u=Error,p=v.asn1,g=p.ASN1Object,m=p.DERSequence,w=(p.DERGeneralizedTime,p.DERTaggedObject),F=p.DERBitString,R=(p.x509.Extensions,p.x509.AlgorithmIdentifier),P=p.ocsp;P.ResponderID,_SingleResponseList=P.SingleResponseList,_ResponseData=P.ResponseData,this.params=null,this.setByParam=function(B){this.params=B},this.sign=function(){var B=this.params,K=B.tbsresp.tohex(),L=new v.crypto.Signature({alg:B.sigalg});L.init(B.reskey),L.updateHex(K),B.sighex=L.sign()},this.tohex=function(){var B=this.params;B.tbsresp==null&&(B.tbsresp=new _ResponseData(B)),B.sighex==null&&B.reskey!=null&&this.sign();var K=[];if(K.push(B.tbsresp),K.push(new R({name:B.sigalg})),K.push(new F({hex:"00"+B.sighex})),B.certs!=null&&B.certs.length!=null){for(var L=[],O=0;O<B.certs.length;O++){var U=B.certs[O],W=null;if(Vt.isASN1HEX(U))W=U;else{if(!U.match(/-----BEGIN/))throw new u("certs["+O+"] not hex or PEM");W=Qe(U)}L.push(new g({tlv:W}))}var Y=new m({array:L});K.push(new w({tag:"a0",explicit:!0,obj:Y}))}return new m({array:K}).tohex()},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(v.asn1.ocsp.BasicOCSPResponse,v.asn1.ASN1Object),v.asn1.ocsp.ResponseData=function(a){v.asn1.ocsp.ResponseData.superclass.constructor.call(this);var u=Error,p=v.asn1,g=p.DERSequence,m=p.DERGeneralizedTime,w=p.DERTaggedObject,F=p.x509.Extensions,R=p.ocsp,P=R.ResponderID;_SingleResponseList=R.SingleResponseList,this.params=null,this.tohex=function(){var B=this.params;B.respid!=null&&new u("respid not specified"),B.prodat!=null&&new u("prodat not specified"),B.array!=null&&new u("array not specified");var K=[];if(K.push(new P(B.respid)),K.push(new m(B.prodat)),K.push(new _SingleResponseList(B.array)),B.ext!=null){var L=new F(B.ext);K.push(new w({tag:"a1",explicit:!0,obj:L}))}return new g({array:K}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(B){this.params=B},a!==void 0&&this.setByParam(a)},Yt(v.asn1.ocsp.ResponseData,v.asn1.ASN1Object),v.asn1.ocsp.ResponderID=function(a){v.asn1.ocsp.ResponderID.superclass.constructor.call(this);var u=v,p=u.asn1,g=p.ASN1Util.newObject,m=p.x509.X500Name,w=u.lang.String.isHex,F=Error;this.params=null,this.tohex=function(){var R=this.params;if(R.key!=null){var P,B=null;if(typeof R.key=="string"?(w(R.key)&&(B=R.key),R.key.match(/-----BEGIN CERTIFICATE/)&&(P=new Ee(R.key).getExtSubjectKeyIdentifier())!=null&&(B=P.kid.hex)):R.key instanceof Ee&&(P=R.key.getExtSubjectKeyIdentifier())!=null&&(B=P.kid.hex),B==null)throw new F("wrong key member value");return g({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:B}}}}).tohex()}if(R.name!=null){var K=null;if(typeof R.name=="string"&&R.name.match(/-----BEGIN CERTIFICATE/)?K=new Ee(R.name).getSubject():R.name instanceof Ee?K=R.name.getSubject():typeof R.name!="object"||R.name.array==null&&R.name.str==null||(K=R.name),K==null)throw new F("wrong name member value");return g({tag:{tag:"a1",explicit:!0,obj:new m(K)}}).tohex()}throw new F("key or name not specified")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(R){this.params=R},a!==void 0&&this.setByParam(a)},Yt(v.asn1.ocsp.ResponderID,v.asn1.ASN1Object),v.asn1.ocsp.SingleResponseList=function(a){v.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var u=v.asn1,p=u.DERSequence,g=u.ocsp.SingleResponse;this.params=null,this.tohex=function(){var m=this.params;if(typeof m!="object"||m.length==null)throw new Error("params not specified properly");for(var w=[],F=0;F<m.length;F++)w.push(new g(m[F]));return new p({array:w}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(m){this.params=m},a!==void 0&&this.setByParam(a)},Yt(v.asn1.ocsp.SingleResponseList,v.asn1.ASN1Object),v.asn1.ocsp.SingleResponse=function(a){var u=Error,p=v.asn1,g=p.DERSequence,m=p.DERGeneralizedTime,w=p.DERTaggedObject,F=p.ocsp,R=F.CertID,P=F.CertStatus,B=p.x509.Extensions;F.SingleResponse.superclass.constructor.call(this),this.params=null,this.tohex=function(){var K=this.params,L=[];if(K.certid==null)throw new u("certid unspecified");if(K.status==null)throw new u("status unspecified");if(K.thisupdate==null)throw new u("thisupdate unspecified");if(L.push(new R(K.certid)),L.push(new P(K.status)),L.push(new m(K.thisupdate)),K.nextupdate!=null){var O=new m(K.nextupdate);L.push(new w({tag:"a0",explicit:!0,obj:O}))}if(K.ext!=null){var U=new B(K.ext);L.push(new w({tag:"a1",explicit:!0,obj:U}))}return new g({array:L}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(K){this.params=K},a!==void 0&&this.setByParam(a)},Yt(v.asn1.ocsp.SingleResponse,v.asn1.ASN1Object),v.asn1.ocsp.CertID=function(a){var u=v,p=u.asn1,g=p.DEROctetString,m=p.DERInteger,w=p.DERSequence,F=p.x509.AlgorithmIdentifier,R=p.ocsp,P=(R.DEFAULT_HASH,u.crypto.Util.hashHex),B=Ee,K=Vt.getVbyList;R.CertID.superclass.constructor.call(this),this.DEFAULT_HASH="sha1",this.params=null,this.setByValue=function(L,O,U,W){W==null&&(W=this.DEFAULT_HASH),this.params={alg:W,issname:L,isskey:O,sbjsn:U}},this.setByCert=function(L,O,U){U==null&&(U=this.DEFAULT_HASH),this.params={alg:U,issuerCert:L,subjectCert:O}},this.getParamByCerts=function(L,O,U){U==null&&(U=this.DEFAULT_HASH);var W=new B(L),Y=new B(O),st=P(W.getSubjectHex(),U),vt=W.getPublicKeyHex();return{alg:U,issname:st,isskey:P(K(vt,0,[1],"03",!0),U),sbjsn:Y.getSerialNumberHex()}},this.tohex=function(){if(typeof this.params!="object")throw new Error("params not set");var L,O,U,W,Y=this.params;if(W=Y.alg==null?this.DEFAULT_HASH:Y.alg,Y.issuerCert!=null&&Y.subjectCert!=null){var st=this.getParamByCerts(Y.issuerCert,Y.subjectCert,W);L=st.issname,O=st.isskey,U=st.sbjsn}else{if(Y.issname==null||Y.isskey==null||Y.sbjsn==null)throw new Error("required param members not defined");L=Y.issname,O=Y.isskey,U=Y.sbjsn}var vt=new F({name:W}),At=new g({hex:L}),Mt=new g({hex:O}),Bt=new m({hex:U}),Q=new w({array:[vt,At,Mt,Bt]});return this.hTLV=Q.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&this.setByParam(a)},Yt(v.asn1.ocsp.CertID,v.asn1.ASN1Object),v.asn1.ocsp.CertStatus=function(a){v.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.tohex=function(){var u=this.params;if(u.status=="good")return"8000";if(u.status=="unknown")return"8200";if(u.status=="revoked"){var p=[{gentime:{str:u.time}}];u.reason!=null&&p.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:u.reason}}}});var g={tag:"a1",explicit:!1,obj:{seq:p}};return v.asn1.ASN1Util.newObject({tag:g}).tohex()}throw new Error("bad status")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(u){this.params=u},a!==void 0&&this.setByParam(a)},Yt(v.asn1.ocsp.CertStatus,v.asn1.ASN1Object),v.asn1.ocsp.Request=function(a){var u=v.asn1,p=u.DERSequence,g=u.ocsp;if(g.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.tohex=function(){var w=[];if(this.dReqCert===null)throw"reqCert not set";w.push(this.dReqCert);var F=new p({array:w});return this.hTLV=F.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0){var m=new g.CertID(a);this.dReqCert=m}},Yt(v.asn1.ocsp.Request,v.asn1.ASN1Object),v.asn1.ocsp.TBSRequest=function(a){var u=v.asn1,p=u.DERSequence,g=u.ocsp;g.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(m){for(var w=[],F=0;F<m.length;F++){var R=new g.Request(m[0]);w.push(R)}this.dRequestList=w},this.tohex=function(){var m=[];if(this.version!==0)throw"not supported version: "+this.version;if(this.dRequestorName!==null)throw"requestorName not supported";var w=new p({array:this.dRequestList});if(m.push(w),this.dRequestExt!==null)throw"requestExtensions not supported";var F=new p({array:m});return this.hTLV=F.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&a.reqList!==void 0&&this.setRequestListByParam(a.reqList)},Yt(v.asn1.ocsp.TBSRequest,v.asn1.ASN1Object),v.asn1.ocsp.OCSPRequest=function(a){var u=v.asn1,p=u.DERSequence,g=u.ocsp;if(g.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.tohex=function(){var w=[];if(this.dTbsRequest===null)throw"tbsRequest not set";if(w.push(this.dTbsRequest),this.dOptionalSignature!==null)throw"optionalSignature not supported";var F=new p({array:w});return this.hTLV=F.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},a!==void 0&&a.reqList!==void 0){var m=new g.TBSRequest(a);this.dTbsRequest=m}},Yt(v.asn1.ocsp.OCSPRequest,v.asn1.ASN1Object),v.asn1.ocsp.OCSPUtil={},v.asn1.ocsp.OCSPUtil.getRequestHex=function(a,u,p){var g=v.asn1.ocsp;p===void 0&&(p=g.DEFAULT_HASH);var m={alg:p,issuerCert:a,subjectCert:u};return new g.OCSPRequest({reqList:[m]}).tohex()},v.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(a){var u=Vt,p=u.getVbyList,g=u.getVbyListEx,m=u.getIdxbyList,w=(u.getIdxbyListEx,u.getV),F={};try{var R=g(a,0,[0],"0a");F.responseStatus=parseInt(R,16)}catch{}if(F.responseStatus!==0)return F;try{var P=m(a,0,[1,0,1,0,0,2,0,1]);a.substr(P,2)==="80"?F.certStatus="good":a.substr(P,2)==="a1"?(F.certStatus="revoked",F.revocationTime=Le(p(a,P,[0]))):a.substr(P,2)==="82"&&(F.certStatus="unknown")}catch{}try{var B=m(a,0,[1,0,1,0,0,2,0,2]);F.thisUpdate=Le(w(a,B))}catch{}try{var K=m(a,0,[1,0,1,0,0,2,0,3]);a.substr(K,2)==="a0"&&(F.nextUpdate=Le(p(a,K,[0])))}catch{}return F},v.asn1.ocsp.OCSPParser=function(){var a=Error,u=Ee,p=new u,g=Vt,m=g.getV,w=g.getTLV,F=g.getIdxbyList,R=g.getVbyList,P=g.getTLVbyList,B=g.getVbyListEx,K=g.getTLVbyListEx,L=g.getChildIdx;this.getOCSPRequest=function(O){var U=L(O,0);if(U.length!=1&&U.length!=2)throw new a("wrong number elements: "+U.length);return this.getTBSRequest(w(O,U[0]))},this.getTBSRequest=function(O){var U={},W=K(O,0,[0],"30");U.array=this.getRequestList(W);var Y=K(O,0,["[2]",0],"30");return Y!=null&&(U.ext=p.getExtParamArray(Y)),U},this.getRequestList=function(O){for(var U=[],W=L(O,0),Y=0;Y<W.length;Y++)O=w(O,W[Y]),U.push(this.getRequest(O));return U},this.getRequest=function(O){var U=L(O,0);if(U.length!=1&&U.length!=2)throw new a("wrong number elements: "+U.length);var W=this.getCertID(w(O,U[0]));if(U.length==2){var Y=F(O,0,[1,0]);W.ext=p.getExtParamArray(w(O,Y))}return W},this.getCertID=function(O){var U=L(O,0);if(U.length!=4)throw new a("wrong number elements: "+U.length);var W=new u,Y={};return Y.alg=W.getAlgorithmIdentifierName(w(O,U[0])),Y.issname=m(O,U[1]),Y.isskey=m(O,U[2]),Y.sbjsn=m(O,U[3]),Y},this.getOCSPResponse=function(O){var U,W=L(O,0),Y=m(O,W[0]),st=parseInt(Y);if(W.length==1)return{resstatus:st};var vt=P(O,0,[1,0]);return(U=this.getResponseBytes(vt)).resstatus=st,U},this.getResponseBytes=function(O){var U,W=L(O,0),Y=P(O,0,[1,0]);U=this.getBasicOCSPResponse(Y);var st=m(O,W[0]);return U.restype=v.asn1.x509.OID.oid2name(Tr(st)),U},this.getBasicOCSPResponse=function(O){var U,W=L(O,0);U=this.getResponseData(w(O,W[0]));var Y=new Ee;U.alg=Y.getAlgorithmIdentifierName(w(O,W[1]));var st=m(O,W[2]);U.sighex=st.substr(2);var vt=B(O,0,["[0]"]);if(vt!=null){for(var At=L(vt,0),Mt=[],Bt=0;Bt<At.length;Bt++){var Q=w(vt,At[Bt]);Mt.push(Q)}U.certs=Mt}return U},this.getResponseData=function(O){var U=L(O,0),W=U.length,Y={},st=0;O.substr(U[0],2)=="a0"&&st++,Y.respid=this.getResponderID(w(O,U[st++]));var vt=m(O,U[st++]);if(Y.prodat=Le(vt),Y.array=this.getSingleResponseList(w(O,U[st++])),O.substr(U[W-1],2)=="a1"){var At=P(O,U[W-1],[0]),Mt=new Ee;Y.ext=Mt.getExtParamArray(At)}return Y},this.getResponderID=function(O){var U={};if(O.substr(0,2)=="a2"){var W=R(O,0,[0]);U.key=W}if(O.substr(0,2)=="a1"){var Y=P(O,0,[0]),st=new Ee;U.name=st.getX500Name(Y)}return U},this.getSingleResponseList=function(O){for(var U=L(O,0),W=[],Y=0;Y<U.length;Y++){var st=this.getSingleResponse(w(O,U[Y]));W.push(st)}return W},this.getSingleResponse=function(O){var U=L(O,0),W={},Y=this.getCertID(w(O,U[0]));W.certid=Y;var st=this.getCertStatus(w(O,U[1]));if(W.status=st,O.substr(U[2],2)=="18"){var vt=m(O,U[2]);W.thisupdate=Le(vt)}for(var At=3;At<U.length;At++){if(O.substr(U[At],2)=="a0"){var Mt=R(O,U[At],[0],"18");W.nextupdate=Le(Mt)}if(O.substr(U[At],2)=="a1"){var Bt=new Ee,Q=P(O,0,[At,0]);W.ext=Bt.getExtParamArray(Q)}}return W},this.getCertStatus=function(O){var U={};if(O=="8000")return{status:"good"};if(O=="8200")return{status:"unknown"};if(O.substr(0,2)=="a1"){U.status="revoked";var W=Le(R(O,0,[0]));U.time=W}return U}},v!==void 0&&v||(v={}),v.lang!==void 0&&v.lang||(v.lang={}),v.lang.String=function(){},typeof t=="function"?(Be=function(a){return lr(t.from(a,"utf8").toString("base64"))},ce=function(a){return t.from(ur(a),"base64").toString("utf8")}):(Be=function(a){return Me(Yr(Ar(a)))},ce=function(a){return decodeURIComponent(Xr(Ke(a)))}),v.lang.String.isInteger=function(a){return!!a.match(/^[0-9]+$/)||!!a.match(/^-[0-9]+$/)},v.lang.String.isHex=function(a){return un(a)},v.lang.String.isBase64=function(a){return!(!(a=a.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||a.length%4!=0)},v.lang.String.isBase64URL=function(a){return!a.match(/[+/=]/)&&(a=ur(a),v.lang.String.isBase64(a))},v.lang.String.isIntegerArray=function(a){return!!(a=a.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},v.lang.String.isPrintable=function(a){return a.match(/^[0-9A-Za-z '()+,-./:=?]*$/)!==null},v.lang.String.isIA5=function(a){return a.match(/^[\x20-\x21\x23-\x7f]*$/)!==null},v.lang.String.isMail=function(a){return a.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)!==null};var Lt=function(a,u,p){return p==null&&(p="0"),a.length>=u?a:new Array(u-a.length+1).join(p)+a};function sr(a){if(a.length%2!=0||(a=a.toLowerCase()).match(/^[0-9a-f]+$/)==null)return-1;try{var u=a.substr(0,2);if(u=="00")return parseInt(a.substr(2),16);var p=parseInt(u,16);if(p>7)return-1;var g=a.substr(2),m=parseInt(g,16).toString(2);m=="0"&&(m="00000000"),m=m.slice(0,0-p);var w=parseInt(m,2);return w==NaN?-1:w}catch{return-1}}function _n(a){if(typeof a!="number"||a<0)return null;var u=Number(a).toString(2),p=8-u.length%8;p==8&&(p=0),u+=Lt("",p,"0");var g=parseInt(u,2).toString(16);return g.length%2==1&&(g="0"+g),"0"+p+g}function Ie(a){if(typeof a!="string"||a.length%2!=0||!a.match(/^[0-9a-f]+$/))return null;try{var u=parseInt(a.substr(0,2),16);if(u<0||7<u)return null;for(var p=a.substr(2),g="",m=0;m<p.length;m+=2){var w=p.substr(m,2),F=parseInt(w,16).toString(2);g+=F=("0000000"+F).slice(-8)}return g.substr(0,g.length-u)}catch{return null}}function fr(a,u){for(var p=0,g=0;g<a.length;g++)p|=1<<u[a[g]];var m=p.toString(2),w="";for(g=m.length-1;g>=0;g--)w+=m[g];return w}function Ue(a,u,p){if(typeof a=="object"){u=String(u).split(".");for(var g=0;g<u.length&&a;g++){var m=u[g];m.match(/^[0-9]+$/)&&(m=parseInt(m)),a=a[m]}return a||a===!1?a:p}}function Yt(a,u){var p=function(){};p.prototype=u.prototype,a.prototype=new p,a.prototype.constructor=a,a.superclass=u.prototype,u.prototype.constructor==Object.prototype.constructor&&(u.prototype.constructor=u)}v!==void 0&&v||(v={}),v.crypto!==void 0&&v.crypto||(v.crypto={}),v.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:z.algo.MD5,sha1:z.algo.SHA1,sha224:z.algo.SHA224,sha256:z.algo.SHA256,sha384:z.algo.SHA384,sha512:z.algo.SHA512,ripemd160:z.algo.RIPEMD160},this.getDigestInfoHex=function(a,u){if(this.DIGESTINFOHEAD[u]===void 0)throw"alg not supported in Util.DIGESTINFOHEAD: "+u;return this.DIGESTINFOHEAD[u]+a},this.getPaddedDigestInfoHex=function(a,u,p){var g=this.getDigestInfoHex(a,u),m=p/4;if(g.length+22>m)throw"key is too short for SigAlg: keylen="+p+","+u;for(var w="0001",F="00"+g,R="",P=m-w.length-F.length,B=0;B<P;B+=2)R+="ff";return w+R+F},this.hashString=function(a,u){return new v.crypto.MessageDigest({alg:u}).digestString(a)},this.hashHex=function(a,u){return new v.crypto.MessageDigest({alg:u}).digestHex(a)},this.sha1=function(a){return this.hashString(a,"sha1")},this.sha256=function(a){return this.hashString(a,"sha256")},this.sha256Hex=function(a){return this.hashHex(a,"sha256")},this.sha512=function(a){return this.hashString(a,"sha512")},this.sha512Hex=function(a){return this.hashHex(a,"sha512")},this.isKey=function(a){return a instanceof Nt||a instanceof v.crypto.DSA||a instanceof v.crypto.ECDSA}},v.crypto.Util.md5=function(a){return new v.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(a)},v.crypto.Util.ripemd160=function(a){return new v.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(a)},v.crypto.Util.SECURERANDOMGEN=new ge,v.crypto.Util.getRandomHexOfNbytes=function(a){var u=new Array(a);return v.crypto.Util.SECURERANDOMGEN.nextBytes(u),Je(u)},v.crypto.Util.getRandomBigIntegerOfNbytes=function(a){return new tt(v.crypto.Util.getRandomHexOfNbytes(a),16)},v.crypto.Util.getRandomHexOfNbits=function(a){var u=a%8,p=new Array((a-u)/8+1);return v.crypto.Util.SECURERANDOMGEN.nextBytes(p),p[0]=(255<<u&255^255)&p[0],Je(p)},v.crypto.Util.getRandomBigIntegerOfNbits=function(a){return new tt(v.crypto.Util.getRandomHexOfNbits(a),16)},v.crypto.Util.getRandomBigIntegerZeroToMax=function(a){for(var u=a.bitLength();;){var p=v.crypto.Util.getRandomBigIntegerOfNbits(u);if(a.compareTo(p)!=-1)return p}},v.crypto.Util.getRandomBigIntegerMinToMax=function(a,u){var p=a.compareTo(u);if(p==1)throw"biMin is greater than biMax";if(p==0)return a;var g=u.subtract(a);return v.crypto.Util.getRandomBigIntegerZeroToMax(g).add(a)},v.crypto.MessageDigest=function(a){this.setAlgAndProvider=function(u,p){if((u=v.crypto.MessageDigest.getCanonicalAlgName(u))!==null&&p===void 0&&(p=v.crypto.Util.DEFAULTPROVIDER[u]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(u)!=-1&&p=="cryptojs"){try{this.md=v.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[u].create()}catch(g){throw"setAlgAndProvider hash alg set fail alg="+u+"/"+g}this.updateString=function(g){this.md.update(g)},this.updateHex=function(g){var m=z.enc.Hex.parse(g);this.md.update(m)},this.digest=function(){return this.md.finalize().toString(z.enc.Hex)},this.digestString=function(g){return this.updateString(g),this.digest()},this.digestHex=function(g){return this.updateHex(g),this.digest()}}if(":sha256:".indexOf(u)!=-1&&p=="sjcl"){try{this.md=new sjcl.hash.sha256}catch(g){throw"setAlgAndProvider hash alg set fail alg="+u+"/"+g}this.updateString=function(g){this.md.update(g)},this.updateHex=function(g){var m=sjcl.codec.hex.toBits(g);this.md.update(m)},this.digest=function(){var g=this.md.finalize();return sjcl.codec.hex.fromBits(g)},this.digestString=function(g){return this.updateString(g),this.digest()},this.digestHex=function(g){return this.updateHex(g),this.digest()}}},this.updateString=function(u){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(u){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(u){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(u){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},a!==void 0&&a.alg!==void 0&&(this.algName=a.alg,a.prov===void 0&&(this.provName=v.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},v.crypto.MessageDigest.getCanonicalAlgName=function(a){return typeof a=="string"&&(a=(a=a.toLowerCase()).replace(/-/,"")),a},v.crypto.MessageDigest.getHashLength=function(a){var u=v.crypto.MessageDigest,p=u.getCanonicalAlgName(a);if(u.HASHLENGTH[p]===void 0)throw"not supported algorithm: "+a;return u.HASHLENGTH[p]},v.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},v.crypto.Mac=function(a){this.setAlgAndProvider=function(u,p){if((u=u.toLowerCase())==null&&(u="hmacsha1"),(u=u.toLowerCase()).substr(0,4)!="hmac")throw"setAlgAndProvider unsupported HMAC alg: "+u;p===void 0&&(p=v.crypto.Util.DEFAULTPROVIDER[u]),this.algProv=u+"/"+p;var g=u.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(g)!=-1&&p=="cryptojs"){try{var m=v.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[g];this.mac=z.algo.HMAC.create(m,this.pass)}catch(w){throw"setAlgAndProvider hash alg set fail hashAlg="+g+"/"+w}this.updateString=function(w){this.mac.update(w)},this.updateHex=function(w){var F=z.enc.Hex.parse(w);this.mac.update(F)},this.doFinal=function(){return this.mac.finalize().toString(z.enc.Hex)},this.doFinalString=function(w){return this.updateString(w),this.doFinal()},this.doFinalHex=function(w){return this.updateHex(w),this.doFinal()}}},this.updateString=function(u){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(u){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(u){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(u){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(u){if(typeof u=="string"){var p=u;return u.length%2!=1&&u.match(/^[0-9A-Fa-f]+$/)||(p=Sr(u)),void(this.pass=z.enc.Hex.parse(p))}if(typeof u!="object")throw"KJUR.crypto.Mac unsupported password type: "+u;if(p=null,u.hex!==void 0){if(u.hex.length%2!=0||!u.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+u.hex;p=u.hex}if(u.utf8!==void 0&&(p=Ir(u.utf8)),u.rstr!==void 0&&(p=Sr(u.rstr)),u.b64!==void 0&&(p=ct(u.b64)),u.b64u!==void 0&&(p=Ke(u.b64u)),p==null)throw"KJUR.crypto.Mac unsupported password type: "+u;this.pass=z.enc.Hex.parse(p)},a!==void 0&&(a.pass!==void 0&&this.setPassword(a.pass),a.alg!==void 0&&(this.algName=a.alg,a.prov===void 0&&(this.provName=v.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},v.crypto.Signature=function(a){var u=null;if(this._setAlgNames=function(){var p=this.algName.match(/^(.+)with(.+)$/);p&&(this.mdAlgName=p[1].toLowerCase(),this.pubkeyAlgName=p[2].toLowerCase(),this.pubkeyAlgName=="rsaandmgf1"&&this.mdAlgName=="sha"&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(p,g){for(var m="",w=g/4-p.length,F=0;F<w;F++)m+="0";return m+p},this.setAlgAndProvider=function(p,g){if(this._setAlgNames(),g!="cryptojs/jsrsa")throw new Error("provider not supported: "+g);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new v.crypto.MessageDigest({alg:this.mdAlgName})}catch(m){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+m)}this.init=function(m,w){var F=null;try{F=w===void 0?Te.getKey(m):Te.getKey(m,w)}catch(R){throw"init failed:"+R}if(F.isPrivate===!0)this.prvKey=F,this.state="SIGN";else{if(F.isPublic!==!0)throw"init failed.:"+F;this.pubKey=F,this.state="VERIFY"}},this.updateString=function(m){this.md.updateString(m)},this.updateHex=function(m){this.md.updateHex(m)},this.sign=function(){if(this.sHashHex=this.md.digest(),this.prvKey===void 0&&this.ecprvhex!==void 0&&this.eccurvename!==void 0&&v.crypto.ECDSA!==void 0&&(this.prvKey=new v.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof Nt&&this.pubkeyAlgName==="rsaandmgf1")this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof Nt&&this.pubkeyAlgName==="rsa")this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof v.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof v.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(m){return this.updateString(m),this.sign()},this.signHex=function(m){return this.updateHex(m),this.sign()},this.verify=function(m){if(this.sHashHex=this.md.digest(),this.pubKey===void 0&&this.ecpubhex!==void 0&&this.eccurvename!==void 0&&v.crypto.ECDSA!==void 0&&(this.pubKey=new v.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof Nt&&this.pubkeyAlgName==="rsaandmgf1")return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,m,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof Nt&&this.pubkeyAlgName==="rsa")return this.pubKey.verifyWithMessageHash(this.sHashHex,m);if(v.crypto.ECDSA!==void 0&&this.pubKey instanceof v.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,m);if(v.crypto.DSA!==void 0&&this.pubKey instanceof v.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,m);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(p,g){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(p){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(p){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(p){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(p){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(p){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=a,a!==void 0&&(a.alg!==void 0&&(this.algName=a.alg,a.prov===void 0?this.provName=v.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=a.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),a.psssaltlen!==void 0&&(this.pssSaltLen=a.psssaltlen),a.prvkeypem!==void 0)){if(a.prvkeypas!==void 0)throw"both prvkeypem and prvkeypas parameters not supported";try{u=Te.getKey(a.prvkeypem),this.init(u)}catch(p){throw"fatal error to load pem private key: "+p}}},v.crypto.Cipher=function(a){},v.crypto.Cipher.encrypt=function(a,u,p,g){if(Ue(g,"enclag")!=null&&(p=g.encalg),typeof p=="string"&&p.substr(-4)=="-CBC"){var m=u,w=a;Ue(g,"key")!=null&&(m=g.key),Ue(g,"enc")!=null&&(hEnc=g.enc);var F,R=z.enc.Hex.parse(m),P=z.enc.Hex.parse(w),B=z.enc.Hex.parse(g.iv);if(p=="des-EDE3-CBC")F=z.TripleDES.encrypt(P,R,{iv:B});else{if(p!="aes128-CBC"&&p!="aes256-CBC")throw new Error("unsupported algorithm: "+p);F=z.AES.encrypt(P,R,{iv:B})}return F+""}throw new Error("Cipher.encrypt: unsupported key or algorithm")},v.crypto.Cipher.decrypt=function(a,u,p,g){if(Ue(g,"enclag")!=null&&(p=g.encalg),typeof p=="string"&&p.substr(-4)=="-CBC"){var m=u,w=a;Ue(g,"key")!=null&&(m=g.key),Ue(g,"enc")!=null&&(w=g.enc);var F,R=z.enc.Hex.parse(m),P=z.enc.Hex.parse(w),B=z.enc.Hex.parse(g.iv);if(p=="des-EDE3-CBC")F=z.TripleDES.decrypt({ciphertext:P},R,{iv:B});else{if(p!="aes128-CBC"&&p!="aes256-CBC")throw new Error("unsupported algorithm: "+p);F=z.AES.decrypt({ciphertext:P},R,{iv:B})}return z.enc.Hex.stringify(F)}throw new Error("Cipher.decrypt: unsupported key or algorithm")},v.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040022":"secp384r1","2b81040023":"secp521r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},v!==void 0&&v||(v={}),v.crypto!==void 0&&v.crypto||(v.crypto={}),v.crypto.ECDSA=function(a){var u=Error,p=tt,g=ee,m=v.crypto.ECDSA,w=v.crypto.ECParameterDB,F=m.getName,R=Vt,P=R.getVbyListEx,B=R.isASN1HEX,K=new ge;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(L){return new p(L.bitLength(),K).mod(L.subtract(p.ONE)).add(p.ONE)},this.setNamedCurve=function(L){this.ecparams=w.getByName(L),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=L},this.setPrivateKeyHex=function(L){this.isPrivate=!0,this.prvKeyHex=L},this.setPublicKeyHex=function(L){this.isPublic=!0,this.pubKeyHex=L},this.getPublicKeyXYHex=function(){var L=this.pubKeyHex;if(L.substr(0,2)!=="04")throw"this method supports uncompressed format(04) only";var O=this.ecparams.keycharlen;if(L.length!==2+2*O)throw"malformed public key hex length";var U={};return U.x=L.substr(2,O),U.y=L.substr(2+O),U},this.getShortNISTPCurveName=function(){var L=this.curveName;return L==="secp256r1"||L==="NIST P-256"||L==="P-256"||L==="prime256v1"?"P-256":L==="secp384r1"||L==="NIST P-384"||L==="P-384"?"P-384":L==="secp521r1"||L==="NIST P-521"||L==="P-521"?"P-521":null},this.generateKeyPairHex=function(){var L=this.ecparams.n,O=this.getBigRandom(L),U=this.ecparams.keycharlen,W=("0000000000"+O.toString(16)).slice(-U);return this.setPrivateKeyHex(W),{ecprvhex:W,ecpubhex:this.generatePublicKeyHex()}},this.generatePublicKeyHex=function(){var L=new p(this.prvKeyHex,16),O=this.ecparams.G.multiply(L),U=O.getX().toBigInteger(),W=O.getY().toBigInteger(),Y=this.ecparams.keycharlen,st="04"+("0000000000"+U.toString(16)).slice(-Y)+("0000000000"+W.toString(16)).slice(-Y);return this.setPublicKeyHex(st),st},this.signWithMessageHash=function(L){return this.signHex(L,this.prvKeyHex)},this.signHex=function(L,O){var U=new p(O,16),W=this.ecparams.n,Y=new p(L.substring(0,this.ecparams.keycharlen),16);do var st=this.getBigRandom(W),vt=this.ecparams.G.multiply(st).getX().toBigInteger().mod(W);while(vt.compareTo(p.ZERO)<=0);var At=st.modInverse(W).multiply(Y.add(U.multiply(vt))).mod(W);return m.biRSSigToASN1Sig(vt,At)},this.sign=function(L,O){var U=O,W=this.ecparams.n,Y=p.fromByteArrayUnsigned(L);do var st=this.getBigRandom(W),vt=this.ecparams.G.multiply(st).getX().toBigInteger().mod(W);while(vt.compareTo(tt.ZERO)<=0);var At=st.modInverse(W).multiply(Y.add(U.multiply(vt))).mod(W);return this.serializeSig(vt,At)},this.verifyWithMessageHash=function(L,O){return this.verifyHex(L,O,this.pubKeyHex)},this.verifyHex=function(L,O,U){try{var W,Y,st=m.parseSigHex(O);W=st.r,Y=st.s;var vt=g.decodeFromHex(this.ecparams.curve,U),At=new p(L.substring(0,this.ecparams.keycharlen),16);return this.verifyRaw(At,W,Y,vt)}catch{return!1}},this.verify=function(L,O,U){var W,Y,st;if(Bitcoin.Util.isArray(O)){var vt=this.parseSig(O);W=vt.r,Y=vt.s}else{if(typeof O!="object"||!O.r||!O.s)throw"Invalid value for signature";W=O.r,Y=O.s}if(U instanceof ee)st=U;else{if(!Bitcoin.Util.isArray(U))throw"Invalid format for pubkey value, must be byte array or ECPointFp";st=g.decodeFrom(this.ecparams.curve,U)}var At=p.fromByteArrayUnsigned(L);return this.verifyRaw(At,W,Y,st)},this.verifyRaw=function(L,O,U,W){var Y=this.ecparams.n,st=this.ecparams.G;if(O.compareTo(p.ONE)<0||O.compareTo(Y)>=0||U.compareTo(p.ONE)<0||U.compareTo(Y)>=0)return!1;var vt=U.modInverse(Y),At=L.multiply(vt).mod(Y),Mt=O.multiply(vt).mod(Y);return st.multiply(At).add(W.multiply(Mt)).getX().toBigInteger().mod(Y).equals(O)},this.serializeSig=function(L,O){var U=L.toByteArraySigned(),W=O.toByteArraySigned(),Y=[];return Y.push(2),Y.push(U.length),(Y=Y.concat(U)).push(2),Y.push(W.length),(Y=Y.concat(W)).unshift(Y.length),Y.unshift(48),Y},this.parseSig=function(L){var O;if(L[0]!=48)throw new Error("Signature not a valid DERSequence");if(L[O=2]!=2)throw new Error("First element in signature must be a DERInteger");var U=L.slice(O+2,O+2+L[O+1]);if(L[O+=2+L[O+1]]!=2)throw new Error("Second element in signature must be a DERInteger");var W=L.slice(O+2,O+2+L[O+1]);return O+=2+L[O+1],{r:p.fromByteArrayUnsigned(U),s:p.fromByteArrayUnsigned(W)}},this.parseSigCompact=function(L){if(L.length!==65)throw"Signature has the wrong length";var O=L[0]-27;if(O<0||O>7)throw"Invalid signature type";var U=this.ecparams.n;return{r:p.fromByteArrayUnsigned(L.slice(1,33)).mod(U),s:p.fromByteArrayUnsigned(L.slice(33,65)).mod(U),i:O}},this.readPKCS5PrvKeyHex=function(L){if(B(L)===!1)throw new Error("not ASN.1 hex string");var O,U,W;try{O=P(L,0,["[0]",0],"06"),U=P(L,0,[1],"04");try{W=P(L,0,["[1]",0],"03")}catch{}}catch{throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=F(O),this.curveName===void 0)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(W),this.setPrivateKeyHex(U),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(L){if(B(L)===!1)throw new u("not ASN.1 hex string");var O,U,W;try{P(L,0,[1,0],"06"),O=P(L,0,[1,1],"06"),U=P(L,0,[2,0,1],"04");try{W=P(L,0,[2,0,"[1]",0],"03")}catch{}}catch{throw new u("malformed PKCS#8 plain ECC private key")}if(this.curveName=F(O),this.curveName===void 0)throw new u("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(W),this.setPrivateKeyHex(U),this.isPublic=!1},this.readPKCS8PubKeyHex=function(L){if(B(L)===!1)throw new u("not ASN.1 hex string");var O,U;try{P(L,0,[0,0],"06"),O=P(L,0,[0,1],"06"),U=P(L,0,[1],"03")}catch{throw new u("malformed PKCS#8 ECC public key")}if(this.curveName=F(O),this.curveName===null)throw new u("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(U)},this.readCertPubKeyHex=function(L,O){if(B(L)===!1)throw new u("not ASN.1 hex string");var U,W;try{U=P(L,0,[0,5,0,1],"06"),W=P(L,0,[0,5,1],"03")}catch{throw new u("malformed X.509 certificate ECC public key")}if(this.curveName=F(U),this.curveName===null)throw new u("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(W)},a!==void 0&&a.curve!==void 0&&(this.curveName=a.curve),this.curveName===void 0&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),a!==void 0&&(a.prv!==void 0&&this.setPrivateKeyHex(a.prv),a.pub!==void 0&&this.setPublicKeyHex(a.pub))},v.crypto.ECDSA.parseSigHex=function(a){var u=v.crypto.ECDSA.parseSigHexInHexRS(a);return{r:new tt(u.r,16),s:new tt(u.s,16)}},v.crypto.ECDSA.parseSigHexInHexRS=function(a){var u=Vt,p=u.getChildIdx,g=u.getV;if(u.checkStrictDER(a,0),a.substr(0,2)!="30")throw new Error("signature is not a ASN.1 sequence");var m=p(a,0);if(m.length!=2)throw new Error("signature shall have two elements");var w=m[0],F=m[1];if(a.substr(w,2)!="02")throw new Error("1st item not ASN.1 integer");if(a.substr(F,2)!="02")throw new Error("2nd item not ASN.1 integer");return{r:g(a,w),s:g(a,F)}},v.crypto.ECDSA.asn1SigToConcatSig=function(a){var u=v.crypto.ECDSA.parseSigHexInHexRS(a),p=u.r,g=u.s;if(p.length>=130&&p.length<=134){if(p.length%2!=0)throw Error("unknown ECDSA sig r length error");if(g.length%2!=0)throw Error("unknown ECDSA sig s length error");p.substr(0,2)=="00"&&(p=p.substr(2)),g.substr(0,2)=="00"&&(g=g.substr(2));var m=Math.max(p.length,g.length);return(p=("000000"+p).slice(-m))+("000000"+g).slice(-m)}if(p.substr(0,2)=="00"&&p.length%32==2&&(p=p.substr(2)),g.substr(0,2)=="00"&&g.length%32==2&&(g=g.substr(2)),p.length%32==30&&(p="00"+p),g.length%32==30&&(g="00"+g),p.length%32!=0)throw Error("unknown ECDSA sig r length error");if(g.length%32!=0)throw Error("unknown ECDSA sig s length error");return p+g},v.crypto.ECDSA.concatSigToASN1Sig=function(a){if(a.length%4!=0)throw Error("unknown ECDSA concatinated r-s sig length error");var u=a.substr(0,a.length/2),p=a.substr(a.length/2);return v.crypto.ECDSA.hexRSSigToASN1Sig(u,p)},v.crypto.ECDSA.hexRSSigToASN1Sig=function(a,u){var p=new tt(a,16),g=new tt(u,16);return v.crypto.ECDSA.biRSSigToASN1Sig(p,g)},v.crypto.ECDSA.biRSSigToASN1Sig=function(a,u){var p=v.asn1,g=new p.DERInteger({bigint:a}),m=new p.DERInteger({bigint:u});return new p.DERSequence({array:[g,m]}).tohex()},v.crypto.ECDSA.getName=function(a){return a==="2b8104001f"?"secp192k1":a==="2a8648ce3d030107"?"secp256r1":a==="2b8104000a"?"secp256k1":a==="2b81040021"?"secp224r1":a==="2b81040022"?"secp384r1":a==="2b81040023"?"secp521r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(a)!==-1?"secp256r1":"|secp256k1|".indexOf(a)!==-1?"secp256k1":"|secp224r1|NIST P-224|P-224|".indexOf(a)!==-1?"secp224r1":"|secp384r1|NIST P-384|P-384|".indexOf(a)!==-1?"secp384r1":"|secp521r1|NIST P-521|P-521|".indexOf(a)!==-1?"secp521r1":null},v!==void 0&&v||(v={}),v.crypto!==void 0&&v.crypto||(v.crypto={}),v.crypto.ECParameterDB=new function(){var a={},u={};function p(g){return new tt(g,16)}this.getByName=function(g){var m=g;if(u[m]!==void 0&&(m=u[g]),a[m]!==void 0)return a[m];throw"unregistered EC curve name: "+m},this.regist=function(g,m,w,F,R,P,B,K,L,O,U,W){a[g]={};var Y=p(w),st=p(F),vt=p(R),At=p(P),Mt=p(B),Bt=new Kt(Y,st,vt),Q=Bt.decodePointHex("04"+K+L);a[g].name=g,a[g].keylen=m,a[g].keycharlen=2*Math.ceil(m/8),a[g].curve=Bt,a[g].G=Q,a[g].n=At,a[g].h=Mt,a[g].oid=U,a[g].info=W;for(var ut=0;ut<O.length;ut++)u[O[ut]]=g}},v.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),v.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),v.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),v.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),v.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),v.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),v.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),v.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),v.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),v.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),v!==void 0&&v||(v={}),v.crypto!==void 0&&v.crypto||(v.crypto={}),v.crypto.DSA=function(){var a=Vt,u=(a.getVbyList,a.getVbyListEx),p=a.isASN1HEX,g=tt;this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(m,w,F,R,P){this.isPrivate=!0,this.p=m,this.q=w,this.g=F,this.y=R,this.x=P},this.setPrivateHex=function(m,w,F,R,P){var B,K,L,O,U;B=new tt(m,16),K=new tt(w,16),L=new tt(F,16),O=typeof R=="string"&&R.length>1?new tt(R,16):null,U=new tt(P,16),this.setPrivate(B,K,L,O,U)},this.setPublic=function(m,w,F,R){this.isPublic=!0,this.p=m,this.q=w,this.g=F,this.y=R,this.x=null},this.setPublicHex=function(m,w,F,R){var P,B,K,L;P=new tt(m,16),B=new tt(w,16),K=new tt(F,16),L=new tt(R,16),this.setPublic(P,B,K,L)},this.signWithMessageHash=function(m){var w=this.p,F=this.q,R=this.g,P=(this.y,this.x),B=v.crypto.Util.getRandomBigIntegerMinToMax(tt.ONE.add(tt.ONE),F.subtract(tt.ONE)),K=new tt(m.substr(0,F.bitLength()/4),16),L=R.modPow(B,w).mod(F),O=B.modInverse(F).multiply(K.add(P.multiply(L))).mod(F);return v.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:L}},{int:{bigint:O}}]})},this.verifyWithMessageHash=function(m,w){var F=this.p,R=this.q,P=this.g,B=this.y,K=this.parseASN1Signature(w),L=K[0],O=K[1],U=new tt(m.substr(0,R.bitLength()/4),16);if(tt.ZERO.compareTo(L)>0||L.compareTo(R)>0||tt.ZERO.compareTo(O)>=0||O.compareTo(R)>0)throw"invalid DSA signature";var W=O.modInverse(R),Y=U.multiply(W).mod(R),st=L.multiply(W).mod(R);return P.modPow(Y,F).multiply(B.modPow(st,F)).mod(F).mod(R).compareTo(L)==0},this.parseASN1Signature=function(m){try{return[new g(u(m,0,[0],"02"),16),new g(u(m,0,[1],"02"),16)]}catch{throw new Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(m){var w,F,R,P,B;if(p(m)===!1)throw new Error("not ASN.1 hex string");try{w=u(m,0,[1],"02"),F=u(m,0,[2],"02"),R=u(m,0,[3],"02"),P=u(m,0,[4],"02"),B=u(m,0,[5],"02")}catch{throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(w,F,R,P,B)},this.readPKCS8PrvKeyHex=function(m){var w,F,R,P;if(p(m)===!1)throw new Error("not ASN.1 hex string");try{w=u(m,0,[1,1,0],"02"),F=u(m,0,[1,1,1],"02"),R=u(m,0,[1,1,2],"02"),P=u(m,0,[2,0],"02")}catch{throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(w,F,R,null,P)},this.readPKCS8PubKeyHex=function(m){var w,F,R,P;if(p(m)===!1)throw new Error("not ASN.1 hex string");try{w=u(m,0,[0,1,0],"02"),F=u(m,0,[0,1,1],"02"),R=u(m,0,[0,1,2],"02"),P=u(m,0,[1,0],"02")}catch{throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(w,F,R,P)},this.readCertPubKeyHex=function(m,w){var F,R,P,B;if(p(m)===!1)throw new Error("not ASN.1 hex string");try{F=u(m,0,[0,5,0,1,0],"02"),R=u(m,0,[0,5,0,1,1],"02"),P=u(m,0,[0,5,0,1,2],"02"),B=u(m,0,[0,5,1,0],"02")}catch{throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(F,R,P,B)}};var Te=function(){var a=function(P,B,K){return u(z.AES,P,B,K)},u=function(P,B,K,L){var O=z.enc.Hex.parse(B),U=z.enc.Hex.parse(K),W=z.enc.Hex.parse(L),Y={};Y.key=U,Y.iv=W,Y.ciphertext=O;var st=P.decrypt(Y,U,{iv:W});return z.enc.Hex.stringify(st)},p=function(P,B,K){return g(z.AES,P,B,K)},g=function(P,B,K,L){var O=z.enc.Hex.parse(B),U=z.enc.Hex.parse(K),W=z.enc.Hex.parse(L),Y=P.encrypt(O,U,{iv:W}),st=z.enc.Hex.parse(Y.toString());return z.enc.Base64.stringify(st)},m={"AES-256-CBC":{proc:a,eproc:p,keylen:32,ivlen:16},"AES-192-CBC":{proc:a,eproc:p,keylen:24,ivlen:16},"AES-128-CBC":{proc:a,eproc:p,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(P,B,K){return u(z.TripleDES,P,B,K)},eproc:function(P,B,K){return g(z.TripleDES,P,B,K)},keylen:24,ivlen:8},"DES-CBC":{proc:function(P,B,K){return u(z.DES,P,B,K)},eproc:function(P,B,K){return g(z.DES,P,B,K)},keylen:8,ivlen:8}},w=function(P){var B={},K=P.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));K&&(B.cipher=K[1],B.ivsalt=K[2]);var L=P.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));L&&(B.type=L[1]);var O=-1,U=0;P.indexOf(`\r
\r
`)!=-1&&(O=P.indexOf(`\r
\r
`),U=2),P.indexOf(`

`)!=-1&&(O=P.indexOf(`

`),U=1);var W=P.indexOf("-----END");if(O!=-1&&W!=-1){var Y=P.substring(O+2*U,W-U);Y=Y.replace(/\s+/g,""),B.data=Y}return B},F=function(P,B,K){for(var L=K.substring(0,16),O=z.enc.Hex.parse(L),U=z.enc.Utf8.parse(B),W=m[P].keylen+m[P].ivlen,Y="",st=null;;){var vt=z.algo.MD5.create();if(st!=null&&vt.update(st),vt.update(U),vt.update(O),st=vt.finalize(),(Y+=z.enc.Hex.stringify(st)).length>=2*W)break}var At={};return At.keyhex=Y.substr(0,2*m[P].keylen),At.ivhex=Y.substr(2*m[P].keylen,2*m[P].ivlen),At},R=function(P,B,K,L){var O=z.enc.Base64.parse(P),U=z.enc.Hex.stringify(O);return(0,m[B].proc)(U,K,L)};return{version:"1.0.0",parsePKCS5PEM:function(P){return w(P)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(P,B,K){return F(P,B,K)},decryptKeyB64:function(P,B,K,L){return R(P,B,K,L)},getDecryptedKeyHex:function(P,B){var K=w(P),L=(K.type,K.cipher),O=K.ivsalt,U=K.data,W=F(L,B,O).keyhex;return R(U,L,W,O)},getEncryptedPKCS5PEMFromPrvKeyHex:function(P,B,K,L,O){var U="";if(L!==void 0&&L!=null||(L="AES-256-CBC"),m[L]===void 0)throw new Error("KEYUTIL unsupported algorithm: "+L);O!==void 0&&O!=null||(O=function(Y){var st=z.lib.WordArray.random(Y);return z.enc.Hex.stringify(st)}(m[L].ivlen).toUpperCase());var W=function(Y,st,vt,At){return(0,m[st].eproc)(Y,vt,At)}(B,L,F(L,K,O).keyhex,O);return U="-----BEGIN "+P+` PRIVATE KEY-----\r
`,U+=`Proc-Type: 4,ENCRYPTED\r
`,U+="DEK-Info: "+L+","+O+`\r
`,U+=`\r
`,(U+=W.replace(/(.{64})/g,`$1\r
`))+`\r
-----END `+P+` PRIVATE KEY-----\r
`},getEncryptedPKCS8PEM:function(P,B,K){return Xe(this.getEncryptedPKCS8Hex(P,B,K),"ENCRYPTED PRIVATE KEY")},getEncryptedPKCS8Hex:function(P,B,K){var L;(L=K==null||K==null?{}:JSON.parse(JSON.stringify(K))).plain=P,this.initPBES2Param(L),this.encryptPBES2Param(L,B);var O=this.generatePBES2ASN1Param(L);return v.asn1.ASN1Util.newObject(O).tohex()},initPBES2Param:function(P){var B;Ue(P,"encalg")==null&&(P.encalg="aes256-CBC"),Ue(P,"iter")==null&&(P.iter=2048),Ue(P,"prf")==null&&(P.prf="hmacWithSHA256"),Ue(P,"salt")==null&&(P.salt=z.enc.Hex.stringify(z.lib.WordArray.random(8))),Ue(P,"enciv")==null&&(P.encalg=="des-EDE3-CBC"&&(B=8),P.encalg=="aes128-CBC"&&(B=16),P.encalg=="aes256-CBC"&&(B=16),P.enciv=z.enc.Hex.stringify(z.lib.WordArray.random(B)))},encryptPBES2Param:function(P,B){var K=Te.getDKFromPBES2Param(P,B);try{var L=v.crypto.Cipher.encrypt(P.plain,K,P.encalg,{iv:P.enciv})}catch{throw new Error("encrypt error: "+P.plain+" "+K+" "+P.encalg+" "+P.enciv)}P.enc=L},generatePBES2ASN1Param:function(P){var B={seq:[{seq:[{oid:"pkcs5PBES2"},{seq:[{seq:[{oid:"pkcs5PBKDF2"},{seq:[{octstr:{hex:P.salt}},{int:{hex:gr(P.iter)}}]}]},{seq:[{oid:P.encalg},{octstr:{hex:P.enciv}}]}]}]},{octstr:{hex:P.enc}}]};return P.prf!="hmacWithSHA1"&&B.seq[0].seq[1].seq[0].seq[1].seq.push({seq:[{oid:P.prf},{null:""}]}),B},parseHexOfEncryptedPKCS8:function(P){var B=Vt,K=B.getChildIdx,L=B.getV,O={},U=K(P,0);if(U.length!=2)throw new Error("malformed format: SEQUENCE(0).items != 2: "+U.length);O.ciphertext=L(P,U[1]);var W=K(P,U[0]);if(W.length!=2)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+W.length);if(L(P,W[0])!="2a864886f70d01050d")throw new Error("this only supports pkcs5PBES2");var Y=K(P,W[1]);if(W.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+Y.length);var st=K(P,Y[1]);if(st.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+st.length);if(L(P,st[0])!="2a864886f70d0307")throw"this only supports TripleDES";O.encryptionSchemeAlg="TripleDES",O.encryptionSchemeIV=L(P,st[1]);var vt=K(P,Y[0]);if(vt.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+vt.length);if(L(P,vt[0])!="2a864886f70d01050c")throw new Error("this only supports pkcs5PBKDF2");var At=K(P,vt[1]);if(At.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+At.length);O.pbkdf2Salt=L(P,At[0]);var Mt=L(P,At[1]);try{O.pbkdf2Iter=parseInt(Mt,16)}catch{throw new Error("malformed format pbkdf2Iter: "+Mt)}return O},getPBKDF2KeyHexFromParam:function(P,B){var K=z.enc.Hex.parse(P.pbkdf2Salt),L=P.pbkdf2Iter,O=z.PBKDF2(B,K,{keySize:6,iterations:L});return z.enc.Hex.stringify(O)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(P,B){var K=Qe(P,"ENCRYPTED PRIVATE KEY"),L=this.parseHexOfEncryptedPKCS8(K),O=Te.getPBKDF2KeyHexFromParam(L,B),U={};U.ciphertext=z.enc.Hex.parse(L.ciphertext);var W=z.enc.Hex.parse(O),Y=z.enc.Hex.parse(L.encryptionSchemeIV),st=z.TripleDES.decrypt(U,W,{iv:Y});return z.enc.Hex.stringify(st)},parsePBES2:function(P){var B=Vt.parse(P);if(Ue(B,"seq.0.seq.0.oid")!="pkcs5PBES2"||Ue(B,"seq.0.seq.1.seq.0.seq.0.oid")!="pkcs5PBKDF2")throw new Error("not pkcs5PBES2 and pkcs5PBKDF2 used");var K=Ue(B,"seq.0.seq.1.seq.0.seq.1.seq");if(K==null)throw new Error("PBKDF2 parameter not found");var L=Ue(K,"0.octstr.hex"),O=Ue(K,"1.int.hex"),U=Ue(K,"2.seq.0.oid","hmacWithSHA1"),W=-1;try{W=parseInt(O,16)}catch{throw new Error("iter not proper value")}var Y=Ue(B,"seq.0.seq.1.seq.1.seq.0.oid"),st=Ue(B,"seq.0.seq.1.seq.1.seq.1.octstr.hex"),vt=Ue(B,"seq.1.octstr.hex");if(Y==null||st==null||vt==null)throw new Error("encalg, enciv or enc is undefined");return{salt:L,iter:W,prf:U,encalg:Y,enciv:st,enc:vt}},getDKFromPBES2Param:function(P,B){var K={hmacWithSHA1:z.algo.SHA1,hmacWithSHA224:z.algo.SHA224,hmacWithSHA256:z.algo.SHA256,hmacWithSHA384:z.algo.SHA384,hmacWithSHA512:z.algo.SHA512}[P.prf];if(K==null)throw new Error("unsupported prf");var L={"des-EDE3-CBC":6,"aes128-CBC":4,"aes256-CBC":8}[P.encalg];if(L==null)throw new Error("unsupported encalg");var O=z.enc.Hex.parse(P.salt),U=P.iter;try{var W=z.PBKDF2(B,O,{keySize:L,iterations:U,hasher:K});return z.enc.Hex.stringify(W)}catch(Y){throw new Error("PBKDF2 error: "+Y+" "+JSON.stringify(P)+" "+B)}},getPlainHexFromEncryptedPKCS8PEM:function(P,B){if(P.indexOf("BEGIN ENCRYPTED PRIVATE KEY")==-1)throw new Error("not Encrypted PKCS#8 PEM string");var K,L=Qe(P);try{K=Te.parsePBES2(L)}catch(U){throw new Error("malformed PBES2 format: "+U.message)}var O=Te.getDKFromPBES2Param(K,B);return v.crypto.Cipher.decrypt(K.enc,O,K.encalg,{iv:K.enciv})},getKeyFromEncryptedPKCS8PEM:function(P,B){var K=this.getPlainHexFromEncryptedPKCS8PEM(P,B);return this.getKeyFromPlainPrivatePKCS8Hex(K)},parsePlainPrivatePKCS8Hex:function(P){var B=Vt,K=B.getChildIdx,L=B.getV,O={algparam:null};if(P.substr(0,2)!="30")throw new Error("malformed plain PKCS8 private key(code:001)");var U=K(P,0);if(U.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if(P.substr(U[1],2)!="30")throw new Error("malformed PKCS8 private key(code:003)");var W=K(P,U[1]);if(W.length!=2)throw new Error("malformed PKCS8 private key(code:004)");if(P.substr(W[0],2)!="06")throw new Error("malformed PKCS8 private key(code:005)");if(O.algoid=L(P,W[0]),P.substr(W[1],2)=="06"&&(O.algparam=L(P,W[1])),P.substr(U[2],2)!="04")throw new Error("malformed PKCS8 private key(code:006)");return O.keyidx=B.getVidx(P,U[2]),O},getKeyFromPlainPrivatePKCS8PEM:function(P){var B=Qe(P,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(B)},getKeyFromPlainPrivatePKCS8Hex:function(P){var B,K=this.parsePlainPrivatePKCS8Hex(P);if(K.algoid=="2a864886f70d010101")B=new Nt;else if(K.algoid=="2a8648ce380401")B=new v.crypto.DSA;else{if(K.algoid!="2a8648ce3d0201")throw new Error("unsupported private key algorithm");B=new v.crypto.ECDSA}return B.readPKCS8PrvKeyHex(P),B},_getKeyFromPublicPKCS8Hex:function(P){var B,K=Vt.getVbyList(P,0,[0,0],"06");if(K==="2a864886f70d010101")B=new Nt;else if(K==="2a8648ce380401")B=new v.crypto.DSA;else{if(K!=="2a8648ce3d0201")throw new Error("unsupported PKCS#8 public key hex");B=new v.crypto.ECDSA}return B.readPKCS8PubKeyHex(P),B},parsePublicRawRSAKeyHex:function(P){var B=Vt,K=B.getChildIdx,L=B.getV,O={};if(P.substr(0,2)!="30")throw new Error("malformed RSA key(code:001)");var U=K(P,0);if(U.length!=2)throw new Error("malformed RSA key(code:002)");if(P.substr(U[0],2)!="02")throw new Error("malformed RSA key(code:003)");if(O.n=L(P,U[0]),P.substr(U[1],2)!="02")throw new Error("malformed RSA key(code:004)");return O.e=L(P,U[1]),O},parsePublicPKCS8Hex:function(P){var B=Vt,K=B.getChildIdx,L=B.getV,O={algparam:null},U=K(P,0);if(U.length!=2)throw new Error("outer DERSequence shall have 2 elements: "+U.length);var W=U[0];if(P.substr(W,2)!="30")throw new Error("malformed PKCS8 public key(code:001)");var Y=K(P,W);if(Y.length!=2)throw new Error("malformed PKCS8 public key(code:002)");if(P.substr(Y[0],2)!="06")throw new Error("malformed PKCS8 public key(code:003)");if(O.algoid=L(P,Y[0]),P.substr(Y[1],2)=="06"?O.algparam=L(P,Y[1]):P.substr(Y[1],2)=="30"&&(O.algparam={},O.algparam.p=B.getVbyList(P,Y[1],[0],"02"),O.algparam.q=B.getVbyList(P,Y[1],[1],"02"),O.algparam.g=B.getVbyList(P,Y[1],[2],"02")),P.substr(U[1],2)!="03")throw new Error("malformed PKCS8 public key(code:004)");return O.key=L(P,U[1]).substr(2),O}}}();function Jt(a,u){for(var p="",g=u/4-a.length,m=0;m<g;m++)p+="0";return p+a}function jn(a,u,p){for(var g="",m=0;g.length<u;)g+=hr(p(Sr(a+String.fromCharCode.apply(String,[(4278190080&m)>>24,(16711680&m)>>16,(65280&m)>>8,255&m])))),m+=1;return g}function Pn(a){for(var u in v.crypto.Util.DIGESTINFOHEAD){var p=v.crypto.Util.DIGESTINFOHEAD[u],g=p.length;if(a.substring(0,g)==p)return[u,a.substring(g)]}return[]}function Ee(a){var u,p=Vt,g=p.getChildIdx,m=p.getV,w=(p.dump,p.parse),F=p.getTLV,R=p.getVbyList,P=p.getVbyListEx,B=p.getTLVbyList,K=p.getTLVbyListEx,L=p.getIdxbyList,O=p.getIdxbyListEx,U=p.getVidx,W=p.getInt,Y=p.oidname,st=p.hextooidstr,vt=Qe,At=Error;try{u=v.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch{}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(this.hex===null||this.version!==0)return this.version;var Q=B(this.hex,0,[0,0]);if(Q.substr(0,2)=="a0"){var ut=B(Q,0,[0]),pt=W(ut,0);if(pt<0||2<pt)throw new Error("malformed version field");return this.version=pt+1,this.version}return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return P(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var Q=K(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(Q)},this.getAlgorithmIdentifierName=function(Q){for(var ut in u)if(Q===u[ut])return ut;return Y(P(Q,0,[0],"06"))},this.getIssuer=function(Q,ut){return this.getX500Name(this.getIssuerHex(),Q,ut)},this.getIssuerHex=function(){return B(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return this.getIssuer().str},this.getSubject=function(Q,ut){return this.getX500Name(this.getSubjectHex(),Q,ut)},this.getSubjectHex=function(){return B(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return this.getSubject().str},this.getNotBefore=function(){var Q=R(this.hex,0,[0,4+this.foffset,0]);return Q=Q.replace(/(..)/g,"%$1"),decodeURIComponent(Q)},this.getNotAfter=function(){var Q=R(this.hex,0,[0,4+this.foffset,1]);return Q=Q.replace(/(..)/g,"%$1"),decodeURIComponent(Q)},this.getPublicKeyHex=function(){return this.getSPKI()},this.getSPKI=function(){return B(this.hex,0,[0,6+this.foffset],"30")},this.getSPKIValue=function(){var Q=this.getSPKI();return Q==null?null:R(Q,0,[1],"03",!0)},this.getPublicKeyIdx=function(){return L(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var Q=this.getPublicKeyIdx();return L(this.hex,Q,[1,0],"30")},this.getPublicKey=function(){return Te.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var Q=B(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(Q)},this.getSignatureValueHex=function(){return R(this.hex,0,[2],"03",!0)},this.verifySignature=function(Q){var ut=this.getSignatureAlgorithmField(),pt=this.getSignatureValueHex(),it=B(this.hex,0,[0],"30"),bt=new v.crypto.Signature({alg:ut});return bt.init(Q),bt.updateHex(it),bt.verify(pt)},this.parseExt=function(Q){var ut,pt,it;if(Q===void 0){if(it=this.hex,this.version!==3)return-1;ut=L(it,0,[0,7,0],"30"),pt=g(it,ut)}else{it=Qe(Q);var bt=L(it,0,[0,3,0,0],"06");if(m(it,bt)!="2a864886f70d01090e")return void(this.aExtInfo=new Array);ut=L(it,0,[0,3,0,1,0],"30"),pt=g(it,ut),this.hex=it}this.aExtInfo=new Array;for(var $t=0;$t<pt.length;$t++){var Wt={critical:!1},Ht=0;g(it,pt[$t]).length===3&&(Wt.critical=!0,Ht=1),Wt.oid=p.hextooidstr(R(it,pt[$t],[0],"06"));var Se=L(it,pt[$t],[1+Ht]);Wt.vidx=U(it,Se),this.aExtInfo.push(Wt)}},this.getExtInfo=function(Q){var ut=this.aExtInfo,pt=Q;if(Q.match(/^[0-9.]+$/)||(pt=v.asn1.x509.OID.name2oid(Q)),pt!==""){for(var it=0;it<ut.length;it++)if(ut[it].oid===pt)return ut[it]}},this.getCriticalExtV=function(Q,ut,pt){if(ut!=null)return[ut,pt];var it=this.getExtInfo(Q);return it==null?[null,null]:[F(this.hex,it.vidx),it.critical]},this.getExtBasicConstraints=function(Q,ut){if(Q===void 0&&ut===void 0){var pt=this.getExtInfo("basicConstraints");if(pt===void 0)return;Q=F(this.hex,pt.vidx),ut=pt.critical}var it={extname:"basicConstraints"};if(ut&&(it.critical=!0),Q==="3000")return it;if(Q==="30030101ff")return it.cA=!0,it;if(Q.substr(0,12)==="30060101ff02"){var bt=m(Q,10),$t=parseInt(bt,16);return it.cA=!0,it.pathLen=$t,it}throw new Error("hExtV parse error: "+Q)},this.getExtNameConstraints=function(Q,ut){var pt=this.getCriticalExtV("nameConstraints",Q,ut);if(Q=pt[0],ut=pt[1],Q!=null){var it={extname:"nameConstraints"};ut&&(it.critical=!0);for(var bt=g(Q,0),$t=0;$t<bt.length;$t++){for(var Wt=[],Ht=g(Q,bt[$t]),Se=0;Se<Ht.length;Se++){var zt=F(Q,Ht[Se]),X=this.getGeneralSubtree(zt);Wt.push(X)}var dt=Q.substr(bt[$t],2);dt=="a0"?it.permit=Wt:dt=="a1"&&(it.exclude=Wt)}return it}},this.getGeneralSubtree=function(Q){var ut=g(Q,0),pt=ut.length;if(pt<1||2<pt)throw new Error("wrong num elements");for(var it=this.getGeneralName(F(Q,ut[0])),bt=1;bt<pt;bt++){var $t=Q.substr(ut[bt],2),Wt=m(Q,ut[bt]),Ht=parseInt(Wt,16);$t=="80"&&(it.min=Ht),$t=="81"&&(it.max=Ht)}return it},this.getExtKeyUsage=function(Q,ut){var pt=this.getCriticalExtV("keyUsage",Q,ut);if(Q=pt[0],ut=pt[1],Q!=null){var it={extname:"keyUsage"};return ut&&(it.critical=!0),it.names=this.getExtKeyUsageString(Q).split(","),it}},this.getExtKeyUsageBin=function(Q){if(Q===void 0){var ut=this.getExtInfo("keyUsage");if(ut===void 0)return"";Q=F(this.hex,ut.vidx)}if(Q.length!=8&&Q.length!=10)throw new Error("malformed key usage value: "+Q);var pt="000000000000000"+parseInt(Q.substr(6),16).toString(2);return Q.length==8&&(pt=pt.slice(-8)),Q.length==10&&(pt=pt.slice(-16)),(pt=pt.replace(/0+$/,""))==""&&(pt="0"),pt},this.getExtKeyUsageString=function(Q){for(var ut=this.getExtKeyUsageBin(Q),pt=new Array,it=0;it<ut.length;it++)ut.substr(it,1)=="1"&&pt.push(Ee.KEYUSAGE_NAME[it]);return pt.join(",")},this.getExtSubjectKeyIdentifier=function(Q,ut){if(Q===void 0&&ut===void 0){var pt=this.getExtInfo("subjectKeyIdentifier");if(pt===void 0)return;Q=F(this.hex,pt.vidx),ut=pt.critical}var it={extname:"subjectKeyIdentifier"};ut&&(it.critical=!0);var bt=m(Q,0);return it.kid={hex:bt},it},this.getExtAuthorityKeyIdentifier=function(Q,ut){if(Q===void 0&&ut===void 0){var pt=this.getExtInfo("authorityKeyIdentifier");if(pt===void 0)return;Q=F(this.hex,pt.vidx),ut=pt.critical}var it={extname:"authorityKeyIdentifier"};ut&&(it.critical=!0);for(var bt=g(Q,0),$t=0;$t<bt.length;$t++){var Wt=Q.substr(bt[$t],2);if(Wt==="80"&&(it.kid={hex:m(Q,bt[$t])}),Wt==="a1"){var Ht=F(Q,bt[$t]),Se=this.getGeneralNames(Ht);it.issuer=Se[0].dn}Wt==="82"&&(it.sn={hex:m(Q,bt[$t])})}return it},this.getExtExtKeyUsage=function(Q,ut){if(Q===void 0&&ut===void 0){var pt=this.getExtInfo("extKeyUsage");if(pt===void 0)return;Q=F(this.hex,pt.vidx),ut=pt.critical}var it={extname:"extKeyUsage",array:[]};ut&&(it.critical=!0);for(var bt=g(Q,0),$t=0;$t<bt.length;$t++)it.array.push(Y(m(Q,bt[$t])));return it},this.getExtExtKeyUsageName=function(){var Q=this.getExtInfo("extKeyUsage");if(Q===void 0)return Q;var ut=new Array,pt=F(this.hex,Q.vidx);if(pt==="")return ut;for(var it=g(pt,0),bt=0;bt<it.length;bt++)ut.push(Y(m(pt,it[bt])));return ut},this.getExtSubjectAltName=function(Q,ut){if(Q===void 0&&ut===void 0){var pt=this.getExtInfo("subjectAltName");if(pt===void 0)return;Q=F(this.hex,pt.vidx),ut=pt.critical}var it={extname:"subjectAltName",array:[]};return ut&&(it.critical=!0),it.array=this.getGeneralNames(Q),it},this.getExtIssuerAltName=function(Q,ut){if(Q===void 0&&ut===void 0){var pt=this.getExtInfo("issuerAltName");if(pt===void 0)return;Q=F(this.hex,pt.vidx),ut=pt.critical}var it={extname:"issuerAltName",array:[]};return ut&&(it.critical=!0),it.array=this.getGeneralNames(Q),it},this.getGeneralNames=function(Q){for(var ut=g(Q,0),pt=[],it=0;it<ut.length;it++){var bt=this.getGeneralName(F(Q,ut[it]));bt!==void 0&&pt.push(bt)}return pt},this.getGeneralName=function(Q){var ut=Q.substr(0,2),pt=m(Q,0),it=hr(pt);return ut=="81"?{rfc822:it}:ut=="82"?{dns:it}:ut=="86"?{uri:it}:ut=="87"?{ip:ye(pt)}:ut=="a4"?{dn:this.getX500Name(pt)}:ut=="a0"?{other:this.getOtherName(Q)}:void 0},this.getExtSubjectAltName2=function(){var Q,ut,pt,it=this.getExtInfo("subjectAltName");if(it===void 0)return it;for(var bt=new Array,$t=F(this.hex,it.vidx),Wt=g($t,0),Ht=0;Ht<Wt.length;Ht++)pt=$t.substr(Wt[Ht],2),Q=m($t,Wt[Ht]),pt==="81"&&(ut=Le(Q),bt.push(["MAIL",ut])),pt==="82"&&(ut=Le(Q),bt.push(["DNS",ut])),pt==="84"&&(ut=Ee.hex2dn(Q,0),bt.push(["DN",ut])),pt==="86"&&(ut=Le(Q),bt.push(["URI",ut])),pt==="87"&&(ut=ye(Q),bt.push(["IP",ut]));return bt},this.getExtCRLDistributionPoints=function(Q,ut){if(Q===void 0&&ut===void 0){var pt=this.getExtInfo("cRLDistributionPoints");if(pt===void 0)return;Q=F(this.hex,pt.vidx),ut=pt.critical}var it={extname:"cRLDistributionPoints",array:[]};ut&&(it.critical=!0);for(var bt=g(Q,0),$t=0;$t<bt.length;$t++){var Wt=F(Q,bt[$t]);it.array.push(this.getDistributionPoint(Wt))}return it},this.getDistributionPoint=function(Q){for(var ut={},pt=g(Q,0),it=0;it<pt.length;it++){var bt=Q.substr(pt[it],2),$t=F(Q,pt[it]);bt=="a0"&&(ut.dpname=this.getDistributionPointName($t))}return ut},this.getDistributionPointName=function(Q){for(var ut={},pt=g(Q,0),it=0;it<pt.length;it++){var bt=Q.substr(pt[it],2),$t=F(Q,pt[it]);bt=="a0"&&(ut.full=this.getGeneralNames($t))}return ut},this.getExtCRLDistributionPointsURI=function(){var Q=this.getExtCRLDistributionPoints();if(Q==null)return Q;for(var ut=Q.array,pt=[],it=0;it<ut.length;it++)try{ut[it].dpname.full[0].uri!=null&&pt.push(ut[it].dpname.full[0].uri)}catch{}return pt},this.getExtAIAInfo=function(){var Q=this.getExtInfo("authorityInfoAccess");if(Q===void 0)return Q;for(var ut={ocsp:[],caissuer:[]},pt=g(this.hex,Q.vidx),it=0;it<pt.length;it++){var bt=R(this.hex,pt[it],[0],"06"),$t=R(this.hex,pt[it],[1],"86");bt==="2b06010505073001"&&ut.ocsp.push(Le($t)),bt==="2b06010505073002"&&ut.caissuer.push(Le($t))}return ut},this.getExtAuthorityInfoAccess=function(Q,ut){if(Q===void 0&&ut===void 0){var pt=this.getExtInfo("authorityInfoAccess");if(pt===void 0)return;Q=F(this.hex,pt.vidx),ut=pt.critical}var it={extname:"authorityInfoAccess",array:[]};ut&&(it.critical=!0);for(var bt=g(Q,0),$t=0;$t<bt.length;$t++){var Wt=P(Q,bt[$t],[0],"06"),Ht=Le(R(Q,bt[$t],[1],"86"));if(Wt=="2b06010505073001")it.array.push({ocsp:Ht});else{if(Wt!="2b06010505073002")throw new Error("unknown method: "+Wt);it.array.push({caissuer:Ht})}}return it},this.getExtCertificatePolicies=function(Q,ut){if(Q===void 0&&ut===void 0){var pt=this.getExtInfo("certificatePolicies");if(pt===void 0)return;Q=F(this.hex,pt.vidx),ut=pt.critical}var it={extname:"certificatePolicies",array:[]};ut&&(it.critical=!0);for(var bt=g(Q,0),$t=0;$t<bt.length;$t++){var Wt=F(Q,bt[$t]),Ht=this.getPolicyInformation(Wt);it.array.push(Ht)}return it},this.getPolicyInformation=function(Q){var ut={},pt=R(Q,0,[0],"06");ut.policyoid=Y(pt);var it=O(Q,0,[1],"30");if(it!=-1){ut.array=[];for(var bt=g(Q,it),$t=0;$t<bt.length;$t++){var Wt=F(Q,bt[$t]),Ht=this.getPolicyQualifierInfo(Wt);ut.array.push(Ht)}}return ut},this.getOtherName=function(Q){var ut={},pt=g(Q,0),it=R(Q,pt[0],[],"06"),bt=R(Q,pt[1],[]);return ut.oid=Y(it),ut.value=w(bt),ut},this.getPolicyQualifierInfo=function(Q){var ut={},pt=R(Q,0,[0],"06");if(pt==="2b06010505070201"){var it=P(Q,0,[1],"16");ut.cps=hr(it)}else if(pt==="2b06010505070202"){var bt=B(Q,0,[1],"30");ut.unotice=this.getUserNotice(bt)}return ut},this.getUserNotice=function(Q){var ut=null;try{return ut=p.parse(Q),this._asn1ToUnotice(ut)}catch{return}},this._asn1ToUnotice=function(Q){try{for(var ut={},pt=Ue(Q,"seq"),it=0;it<pt.length;it++){var bt=this._asn1ToNoticeRef(pt[it]);bt!=null&&(ut.noticeref=bt);var $t=this.asn1ToDisplayText(pt[it]);$t!=null&&(ut.exptext=$t)}return Object.keys(ut).length>0?ut:void 0}catch{return}},this._asn1ToNoticeRef=function(Q){try{for(var ut={},pt=Ue(Q,"seq"),it=0;it<pt.length;it++){var bt=this._asn1ToNoticeNum(pt[it]);bt!=null&&(ut.noticenum=bt);var $t=this.asn1ToDisplayText(pt[it]);$t!=null&&(ut.org=$t)}return Object.keys(ut).length>0?ut:void 0}catch{return}},this._asn1ToNoticeNum=function(Q){try{for(var ut=Ue(Q,"seq"),pt=[],it=0;it<ut.length;it++){var bt=ut[it];pt.push(parseInt(Ue(bt,"int.hex"),16))}return pt}catch{return}},this.getDisplayText=function(Q){var ut={};return ut.type={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"}[Q.substr(0,2)],ut.str=hr(m(Q,0)),ut},this.asn1ToDisplayText=function(Q){return Q.utf8str!=null?{type:"utf8",str:Q.utf8str.str}:Q.ia5str!=null?{type:"ia5",str:Q.ia5str.str}:Q.visstr!=null?{type:"vis",str:Q.visstr.str}:Q.bmpstr!=null?{type:"bmp",str:Q.bmpstr.str}:Q.prnstr!=null?{type:"prn",str:Q.prnstr.str}:void 0},this.getExtPolicyMappings=function(Q,ut){var pt=this.getCriticalExtV("policyMappings",Q,ut);if(Q=pt[0],ut=pt[1],Q!=null){var it={extname:"policyMappings"};ut&&(it.critical=!0);try{for(var bt=w(Q).seq,$t=[],Wt=0;Wt<bt.length;Wt++){var Ht=bt[Wt].seq;$t.push([Ht[0].oid,Ht[1].oid])}it.array=$t}catch{throw new At("malformed policyMappings")}return it}},this.getExtPolicyConstraints=function(Q,ut){var pt=this.getCriticalExtV("policyConstraints",Q,ut);if(Q=pt[0],ut=pt[1],Q!=null){var it={extname:"policyConstraints"};ut&&(it.critical=!0);var bt=w(Q);try{for(var $t=bt.seq,Wt=0;Wt<$t.length;Wt++){var Ht=$t[Wt].tag;Ht.explicit==0&&(Ht.tag=="80"&&(it.reqexp=parseInt(Ht.hex,16)),Ht.tag=="81"&&(it.inhibit=parseInt(Ht.hex,16)))}}catch{return new At("malformed policyConstraints value")}return it}},this.getExtInhibitAnyPolicy=function(Q,ut){var pt=this.getCriticalExtV("inhibitAnyPolicy",Q,ut);if(Q=pt[0],ut=pt[1],Q!=null){var it={extname:"inhibitAnyPolicy"};ut&&(it.critical=!0);var bt=W(Q,0);return bt==-1?new At("wrong value"):(it.skip=bt,it)}},this.getExtCRLNumber=function(Q,ut){var pt={extname:"cRLNumber"};if(ut&&(pt.critical=!0),Q.substr(0,2)=="02")return pt.num={hex:m(Q,0)},pt;throw new At("hExtV parse error: "+Q)},this.getExtCRLReason=function(Q,ut){var pt={extname:"cRLReason"};if(ut&&(pt.critical=!0),Q.substr(0,2)=="0a")return pt.code=parseInt(m(Q,0),16),pt;throw new Error("hExtV parse error: "+Q)},this.getExtOcspNonce=function(Q,ut){var pt={extname:"ocspNonce"};ut&&(pt.critical=!0);var it=m(Q,0);return pt.hex=it,pt},this.getExtOcspNoCheck=function(Q,ut){var pt={extname:"ocspNoCheck"};return ut&&(pt.critical=!0),pt},this.getExtAdobeTimeStamp=function(Q,ut){if(Q===void 0&&ut===void 0){var pt=this.getExtInfo("adobeTimeStamp");if(pt===void 0)return;Q=F(this.hex,pt.vidx),ut=pt.critical}var it={extname:"adobeTimeStamp"};ut&&(it.critical=!0);var bt=g(Q,0);if(bt.length>1){var $t=F(Q,bt[1]),Wt=this.getGeneralName($t);Wt.uri!=null&&(it.uri=Wt.uri)}if(bt.length>2){var Ht=F(Q,bt[2]);Ht=="0101ff"&&(it.reqauth=!0),Ht=="010100"&&(it.reqauth=!1)}return it},this.getExtSubjectDirectoryAttributes=function(Q,ut){if(Q===void 0&&ut===void 0){var pt=this.getExtInfo("subjectDirectoryAttributes");if(pt===void 0)return;Q=F(this.hex,pt.vidx),ut=pt.critical}var it={extname:"subjectDirectoryAttributes"};ut&&(it.critical=!0);try{for(var bt=w(Q),$t=[],Wt=0;Wt<bt.seq.length;Wt++){var Ht=bt.seq[Wt],Se=Ue(Ht,"seq.0.oid"),zt=Ue(Ht,"seq.1.set");if(Se==null||zt==null)throw"error";$t.push({attr:Se,array:zt})}return it.array=$t,it}catch{throw new Error("malformed subjectDirectoryAttributes extension value")}};var Mt=function(Q){var ut={};try{var pt=Q.seq[0].oid,it=v.asn1.x509.OID.name2oid(pt);ut.type=v.asn1.x509.OID.oid2atype(it);var bt=Q.seq[1];if(bt.utf8str!=null)ut.ds="utf8",ut.value=bt.utf8str.str;else if(bt.numstr!=null)ut.ds="num",ut.value=bt.numstr.str;else if(bt.telstr!=null)ut.ds="tel",ut.value=bt.telstr.str;else if(bt.prnstr!=null)ut.ds="prn",ut.value=bt.prnstr.str;else if(bt.ia5str!=null)ut.ds="ia5",ut.value=bt.ia5str.str;else if(bt.visstr!=null)ut.ds="vis",ut.value=bt.visstr.str;else{if(bt.bmpstr==null)throw"error";ut.ds="bmp",ut.value=bt.bmpstr.str}return ut}catch{throw new Erorr("improper ASN.1 parsed AttrTypeAndValue")}},Bt=function(Q){try{return Q.set.map(function(ut){return Mt(ut)})}catch(ut){throw new Error("improper ASN.1 parsed RDN: "+ut)}};this.getX500NameRule=function(Q){for(var ut=null,pt=[],it=0;it<Q.length;it++)for(var bt=Q[it],$t=0;$t<bt.length;$t++)pt.push(bt[$t]);for(it=0;it<pt.length;it++){var Wt=pt[it],Ht=Wt.ds,Se=Wt.value,zt=Wt.type;if(Ht!="prn"&&Ht!="utf8"&&Ht!="ia5")return"mixed";if(Ht=="ia5"){if(zt!="CN")return"mixed";if(v.lang.String.isMail(Se))continue;return"mixed"}if(zt=="C"){if(Ht=="prn")continue;return"mixed"}if(ut==null)ut=Ht;else if(ut!==Ht)return"mixed"}return ut??"prn"},this.getAttrTypeAndValue=function(Q){var ut=w(Q);return Mt(ut)},this.getRDN=function(Q){var ut=w(Q);return Bt(ut)},this.getX500NameArray=function(Q){return function(ut){try{return ut.seq.map(function(pt){return Bt(pt)})}catch(pt){throw new Error("improper ASN.1 parsed X500Name: "+pt)}}(w(Q))},this.getX500Name=function(Q,ut,pt){var it=this.getX500NameArray(Q),bt={str:this.dnarraytostr(it)};return bt.array=it,pt==1&&(bt.hex=Q),ut==1&&(bt.canon=this.c14nRDNArray(it)),bt},this.readCertPEM=function(Q){this.readCertHex(vt(Q))},this.readCertHex=function(Q){this.hex=Q,this.getVersion();try{L(this.hex,0,[0,7],"a3"),this.parseExt()}catch{}},this.getParam=function(Q){var ut={};return Q==null&&(Q={}),ut.version=this.getVersion(),ut.serial={hex:this.getSerialNumberHex()},ut.sigalg=this.getSignatureAlgorithmField(),ut.issuer=this.getIssuer(Q.dncanon,Q.dnhex),ut.notbefore=this.getNotBefore(),ut.notafter=this.getNotAfter(),ut.subject=this.getSubject(Q.dncanon,Q.dnhex),ut.sbjpubkey=Xe(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo!=null&&this.aExtInfo.length>0&&(ut.ext=this.getExtParamArray()),ut.sighex=this.getSignatureValueHex(),Q.tbshex==1&&(ut.tbshex=B(this.hex,0,[0])),Q.nodnarray==1&&(delete ut.issuer.array,delete ut.subject.array),ut},this.getExtParamArray=function(Q){Q==null&&O(this.hex,0,[0,"[3]"])!=-1&&(Q=K(this.hex,0,[0,"[3]",0],"30"));for(var ut=[],pt=g(Q,0),it=0;it<pt.length;it++){var bt=F(Q,pt[it]),$t=this.getExtParam(bt);$t!=null&&ut.push($t)}return ut},this.getExtParam=function(Q){var ut=g(Q,0).length;if(ut!=2&&ut!=3)throw new Error("wrong number elements in Extension: "+ut+" "+Q);var pt=st(R(Q,0,[0],"06")),it=!1;ut==3&&B(Q,0,[1])=="0101ff"&&(it=!0);var bt=B(Q,0,[ut-1,0]),$t=void 0;if(pt=="2.5.29.14"?$t=this.getExtSubjectKeyIdentifier(bt,it):pt=="2.5.29.15"?$t=this.getExtKeyUsage(bt,it):pt=="2.5.29.17"?$t=this.getExtSubjectAltName(bt,it):pt=="2.5.29.18"?$t=this.getExtIssuerAltName(bt,it):pt=="2.5.29.19"?$t=this.getExtBasicConstraints(bt,it):pt=="2.5.29.30"?$t=this.getExtNameConstraints(bt,it):pt=="2.5.29.31"?$t=this.getExtCRLDistributionPoints(bt,it):pt=="2.5.29.32"?$t=this.getExtCertificatePolicies(bt,it):pt=="2.5.29.33"?$t=this.getExtPolicyMappings(bt,it):pt=="2.5.29.35"?$t=this.getExtAuthorityKeyIdentifier(bt,it):pt=="2.5.29.36"?$t=this.getExtPolicyConstraints(bt,it):pt=="2.5.29.37"?$t=this.getExtExtKeyUsage(bt,it):pt=="2.5.29.54"?$t=this.getExtInhibitAnyPolicy(bt,it):pt=="1.3.6.1.5.5.7.1.1"?$t=this.getExtAuthorityInfoAccess(bt,it):pt=="2.5.29.20"?$t=this.getExtCRLNumber(bt,it):pt=="2.5.29.21"?$t=this.getExtCRLReason(bt,it):pt=="2.5.29.9"?$t=this.getExtSubjectDirectoryAttributes(bt,it):pt=="1.3.6.1.5.5.7.48.1.2"?$t=this.getExtOcspNonce(bt,it):pt=="1.3.6.1.5.5.7.48.1.5"?$t=this.getExtOcspNoCheck(bt,it):pt=="1.2.840.113583.1.1.9.1"?$t=this.getExtAdobeTimeStamp(bt,it):Ee.EXT_PARSER[pt]!=null&&($t=Ee.EXT_PARSER[pt](pt,it,bt)),$t!=null)return $t;var Wt={extname:pt,extn:bt};try{Wt.extn=w(bt)}catch{}return it&&(Wt.critical=!0),Wt},this.findExt=function(Q,ut){for(var pt=0;pt<Q.length;pt++)if(Q[pt].extname==ut)return Q[pt];return null},this.updateExtCDPFullURI=function(Q,ut){var pt=this.findExt(Q,"cRLDistributionPoints");if(pt!=null&&pt.array!=null){for(var it=pt.array,bt=0;bt<it.length;bt++)if(it[bt].dpname!=null&&it[bt].dpname.full!=null)for(var $t=it[bt].dpname.full,Wt=0;Wt<$t.length;Wt++){var Ht=$t[bt];Ht.uri!=null&&(Ht.uri=ut)}}},this.updateExtAIAOCSP=function(Q,ut){var pt=this.findExt(Q,"authorityInfoAccess");if(pt!=null&&pt.array!=null)for(var it=pt.array,bt=0;bt<it.length;bt++)it[bt].ocsp!=null&&(it[bt].ocsp=ut)},this.updateExtAIACAIssuer=function(Q,ut){var pt=this.findExt(Q,"authorityInfoAccess");if(pt!=null&&pt.array!=null)for(var it=pt.array,bt=0;bt<it.length;bt++)it[bt].caissuer!=null&&(it[bt].caissuer=ut)},this.dnarraytostr=function(Q){return"/"+Q.map(function(ut){return function(pt){return pt.map(function(it){return(bt=it,bt.type+"="+bt.value).replace(/\+/,"\\+");var bt}).join("+")}(ut).replace(/\//,"\\/")}).join("/")},this.setCanonicalizedDN=function(Q){var ut;if(Q.str!=null&&Q.array==null){var pt=new v.asn1.x509.X500Name({str:Q.str}).tohex();ut=this.getX500NameArray(pt)}else ut=Q.array;Q.canon==null&&(Q.canon=this.c14nRDNArray(ut))},this.c14nRDNArray=function(Q){for(var ut=[],pt=0;pt<Q.length;pt++){for(var it=Q[pt],bt=[],$t=0;$t<it.length;$t++){var Wt=it[$t],Ht=Wt.value;Ht=(Ht=(Ht=(Ht=Ht.replace(/^\s*/,"")).replace(/\s*$/,"")).replace(/\s+/g," ")).toLowerCase(),bt.push(Wt.type.toLowerCase()+"="+Ht)}ut.push(bt.join("+"))}return"/"+ut.join("/")},this.getInfo=function(){var Q,ut,pt,it=function(Ft){for(var jt="",re="    ",te=`
`,Et=Ft.array,kt=0;kt<Et.length;kt++){var Tt=Et[kt];Tt.dn!=null&&(jt+=re+"dn: "+Tt.dn.str+te),Tt.ip!=null&&(jt+=re+"ip: "+Tt.ip+te),Tt.rfc822!=null&&(jt+=re+"rfc822: "+Tt.rfc822+te),Tt.dns!=null&&(jt+=re+"dns: "+Tt.dns+te),Tt.uri!=null&&(jt+=re+"uri: "+Tt.uri+te),Tt.other!=null&&(jt+=re+"other: "+Tt.other.oid+"="+JSON.stringify(Tt.other.value).replace(/\"/g,"")+te)}return jt.replace(/\n$/,"")},bt=function(Ft){for(var jt="",re=Ft.array,te=0;te<re.length;te++){var Et=re[te];if(jt+="    policy oid: "+Et.policyoid+`
`,Et.array!==void 0)for(var kt=0;kt<Et.array.length;kt++){var Tt=Et.array[kt];Tt.cps!==void 0&&(jt+="    cps: "+Tt.cps+`
`)}}return jt},$t=function(Ft){for(var jt="",re=Ft.array,te=0;te<re.length;te++){var Et=re[te];try{Et.dpname.full[0].uri!==void 0&&(jt+="    "+Et.dpname.full[0].uri+`
`)}catch{}try{Et.dname.full[0].dn.hex!==void 0&&(jt+="    "+Ee.hex2dn(Et.dpname.full[0].dn.hex)+`
`)}catch{}}return jt},Wt=function(Ft){for(var jt="",re=Ft.array,te=0;te<re.length;te++){var Et=re[te];Et.caissuer!==void 0&&(jt+="    caissuer: "+Et.caissuer+`
`),Et.ocsp!==void 0&&(jt+="    ocsp: "+Et.ocsp+`
`)}return jt};if(Q=`Basic Fields
`,Q+="  serial number: "+this.getSerialNumberHex()+`
`,Q+="  signature algorithm: "+this.getSignatureAlgorithmField()+`
`,Q+="  issuer: "+this.getIssuerString()+`
`,Q+="  notBefore: "+this.getNotBefore()+`
`,Q+="  notAfter: "+this.getNotAfter()+`
`,Q+="  subject: "+this.getSubjectString()+`
`,Q+=`  subject public key info: 
`,Q+="    key algorithm: "+(ut=this.getPublicKey()).type+`
`,ut.type==="RSA"&&(Q+="    n="+J(ut.n.toString(16)).substr(0,16)+`...
`,Q+="    e="+J(ut.e.toString(16))+`
`),(pt=this.aExtInfo)!=null){Q+=`X509v3 Extensions:
`;for(var Ht=0;Ht<pt.length;Ht++){var Se=pt[Ht],zt=v.asn1.x509.OID.oid2name(Se.oid);zt===""&&(zt=Se.oid);var X="";if(Se.critical===!0&&(X="CRITICAL"),Q+="  "+zt+" "+X+`:
`,zt==="basicConstraints"){var dt=this.getExtBasicConstraints();dt.cA===void 0?Q+=`    {}
`:(Q+="    cA=true",dt.pathLen!==void 0&&(Q+=", pathLen="+dt.pathLen),Q+=`
`)}else{var mt;if(zt=="policyMappings")Q+="    "+this.getExtPolicyMappings().array.map(function(Ft){var jt=Ft;return jt[0]+":"+jt[1]}).join(", ")+`
`;else if(zt=="policyConstraints")Q+="    ",(mt=this.getExtPolicyConstraints()).reqexp!=null&&(Q+=" reqexp="+mt.reqexp),mt.inhibit!=null&&(Q+=" inhibit="+mt.inhibit),Q+=`
`;else if(zt=="inhibitAnyPolicy")Q+="    skip="+(mt=this.getExtInhibitAnyPolicy()).skip+`
`;else if(zt=="keyUsage")Q+="    "+this.getExtKeyUsageString()+`
`;else if(zt=="subjectKeyIdentifier")Q+="    "+this.getExtSubjectKeyIdentifier().kid.hex+`
`;else if(zt=="authorityKeyIdentifier"){var Rt=this.getExtAuthorityKeyIdentifier();Rt.kid!==void 0&&(Q+="    kid="+Rt.kid.hex+`
`)}else zt=="extKeyUsage"?Q+="    "+this.getExtExtKeyUsage().array.join(", ")+`
`:zt=="subjectAltName"?Q+=it(this.getExtSubjectAltName())+`
`:zt=="cRLDistributionPoints"?Q+=$t(this.getExtCRLDistributionPoints()):zt=="authorityInfoAccess"?Q+=Wt(this.getExtAuthorityInfoAccess()):zt=="certificatePolicies"&&(Q+=bt(this.getExtCertificatePolicies()))}}}return(Q+="signature algorithm: "+this.getSignatureAlgorithmName()+`
`)+"signature: "+this.getSignatureValueHex().substr(0,16)+`...
`},typeof a=="string"&&(a.indexOf("-----BEGIN")!=-1?this.readCertPEM(a):v.lang.String.isHex(a)&&this.readCertHex(a))}Te.getKey=function(a,u,p){var g,m=(vt=Vt).getChildIdx,w=(vt.getV,vt.getVbyList),F=v.crypto,R=F.ECDSA,P=F.DSA,B=Nt,K=Qe,L=Te;if(B!==void 0&&a instanceof B||R!==void 0&&a instanceof R||P!==void 0&&a instanceof P)return a;if(a.curve!==void 0&&a.xy!==void 0&&a.d===void 0)return new R({pub:a.xy,curve:a.curve});if(a.curve!==void 0&&a.d!==void 0)return new R({prv:a.d,curve:a.curve});if(a.kty===void 0&&a.n!==void 0&&a.e!==void 0&&a.d===void 0)return(Ht=new B).setPublic(a.n,a.e),Ht;if(a.kty===void 0&&a.n!==void 0&&a.e!==void 0&&a.d!==void 0&&a.p!==void 0&&a.q!==void 0&&a.dp!==void 0&&a.dq!==void 0&&a.co!==void 0&&a.qi===void 0)return(Ht=new B).setPrivateEx(a.n,a.e,a.d,a.p,a.q,a.dp,a.dq,a.co),Ht;if(a.kty===void 0&&a.n!==void 0&&a.e!==void 0&&a.d!==void 0&&a.p===void 0)return(Ht=new B).setPrivate(a.n,a.e,a.d),Ht;if(a.p!==void 0&&a.q!==void 0&&a.g!==void 0&&a.y!==void 0&&a.x===void 0)return(Ht=new P).setPublic(a.p,a.q,a.g,a.y),Ht;if(a.p!==void 0&&a.q!==void 0&&a.g!==void 0&&a.y!==void 0&&a.x!==void 0)return(Ht=new P).setPrivate(a.p,a.q,a.g,a.y,a.x),Ht;if(a.kty==="RSA"&&a.n!==void 0&&a.e!==void 0&&a.d===void 0)return(Ht=new B).setPublic(Ke(a.n),Ke(a.e)),Ht;if(a.kty==="RSA"&&a.n!==void 0&&a.e!==void 0&&a.d!==void 0&&a.p!==void 0&&a.q!==void 0&&a.dp!==void 0&&a.dq!==void 0&&a.qi!==void 0)return(Ht=new B).setPrivateEx(Ke(a.n),Ke(a.e),Ke(a.d),Ke(a.p),Ke(a.q),Ke(a.dp),Ke(a.dq),Ke(a.qi)),Ht;if(a.kty==="RSA"&&a.n!==void 0&&a.e!==void 0&&a.d!==void 0)return(Ht=new B).setPrivate(Ke(a.n),Ke(a.e),Ke(a.d)),Ht;if(a.kty==="EC"&&a.crv!==void 0&&a.x!==void 0&&a.y!==void 0&&a.d===void 0){var O=(Wt=new R({curve:a.crv})).ecparams.keycharlen,U="04"+("0000000000"+Ke(a.x)).slice(-O)+("0000000000"+Ke(a.y)).slice(-O);return Wt.setPublicKeyHex(U),Wt}if(a.kty==="EC"&&a.crv!==void 0&&a.x!==void 0&&a.y!==void 0&&a.d!==void 0){O=(Wt=new R({curve:a.crv})).ecparams.keycharlen,U="04"+("0000000000"+Ke(a.x)).slice(-O)+("0000000000"+Ke(a.y)).slice(-O);var W=("0000000000"+Ke(a.d)).slice(-O);return Wt.setPublicKeyHex(U),Wt.setPrivateKeyHex(W),Wt}if(p==="pkcs5prv"){var Y,st=a,vt=Vt;if((Y=m(st,0)).length===9)(Ht=new B).readPKCS5PrvKeyHex(st);else if(Y.length===6)(Ht=new P).readPKCS5PrvKeyHex(st);else{if(!(Y.length>2&&st.substr(Y[1],2)==="04"))throw new Error("unsupported PKCS#1/5 hexadecimal key");(Ht=new R).readPKCS5PrvKeyHex(st)}return Ht}if(p==="pkcs8prv")return L.getKeyFromPlainPrivatePKCS8Hex(a);if(p==="pkcs8pub")return L._getKeyFromPublicPKCS8Hex(a);if(p==="x509pub")return Ee.getPublicKeyFromCertHex(a);if(a.indexOf("-END CERTIFICATE-",0)!=-1||a.indexOf("-END X509 CERTIFICATE-",0)!=-1||a.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return Ee.getPublicKeyFromCertPEM(a);if(a.indexOf("-END PUBLIC KEY-")!=-1){var At=Qe(a,"PUBLIC KEY");return L._getKeyFromPublicPKCS8Hex(At)}if(a.indexOf("-END RSA PRIVATE KEY-")!=-1&&a.indexOf("4,ENCRYPTED")==-1){var Mt=K(a,"RSA PRIVATE KEY");return L.getKey(Mt,null,"pkcs5prv")}if(a.indexOf("-END DSA PRIVATE KEY-")!=-1&&a.indexOf("4,ENCRYPTED")==-1){var Bt=w(g=K(a,"DSA PRIVATE KEY"),0,[1],"02"),Q=w(g,0,[2],"02"),ut=w(g,0,[3],"02"),pt=w(g,0,[4],"02"),it=w(g,0,[5],"02");return(Ht=new P).setPrivate(new tt(Bt,16),new tt(Q,16),new tt(ut,16),new tt(pt,16),new tt(it,16)),Ht}if(a.indexOf("-END EC PRIVATE KEY-")!=-1&&a.indexOf("4,ENCRYPTED")==-1)return Mt=K(a,"EC PRIVATE KEY"),L.getKey(Mt,null,"pkcs5prv");if(a.indexOf("-END PRIVATE KEY-")!=-1)return L.getKeyFromPlainPrivatePKCS8PEM(a);if(a.indexOf("-END RSA PRIVATE KEY-")!=-1&&a.indexOf("4,ENCRYPTED")!=-1){var bt=L.getDecryptedKeyHex(a,u),$t=new Nt;return $t.readPKCS5PrvKeyHex(bt),$t}if(a.indexOf("-END EC PRIVATE KEY-")!=-1&&a.indexOf("4,ENCRYPTED")!=-1){var Wt,Ht=w(g=L.getDecryptedKeyHex(a,u),0,[1],"04"),Se=w(g,0,[2,0],"06"),zt=w(g,0,[3,0],"03").substr(2);if(v.crypto.OID.oidhex2name[Se]===void 0)throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+Se);return(Wt=new R({curve:v.crypto.OID.oidhex2name[Se]})).setPublicKeyHex(zt),Wt.setPrivateKeyHex(Ht),Wt.isPublic=!1,Wt}if(a.indexOf("-END DSA PRIVATE KEY-")!=-1&&a.indexOf("4,ENCRYPTED")!=-1)return Bt=w(g=L.getDecryptedKeyHex(a,u),0,[1],"02"),Q=w(g,0,[2],"02"),ut=w(g,0,[3],"02"),pt=w(g,0,[4],"02"),it=w(g,0,[5],"02"),(Ht=new P).setPrivate(new tt(Bt,16),new tt(Q,16),new tt(ut,16),new tt(pt,16),new tt(it,16)),Ht;if(a.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return L.getKeyFromEncryptedPKCS8PEM(a,u);throw new Error("not supported argument")},Te.generateKeypair=function(a,u){if(a=="RSA"){var p=u;(F=new Nt).generate(p,"10001"),F.isPrivate=!0,F.isPublic=!0;var g=new Nt,m=F.n.toString(16),w=F.e.toString(16);return g.setPublic(m,w),g.isPrivate=!1,g.isPublic=!0,(R={}).prvKeyObj=F,R.pubKeyObj=g,R}if(a=="EC"){var F,R,P=u,B=new v.crypto.ECDSA({curve:P}).generateKeyPairHex();return(F=new v.crypto.ECDSA({curve:P})).setPublicKeyHex(B.ecpubhex),F.setPrivateKeyHex(B.ecprvhex),F.isPrivate=!0,F.isPublic=!1,(g=new v.crypto.ECDSA({curve:P})).setPublicKeyHex(B.ecpubhex),g.isPrivate=!1,g.isPublic=!0,(R={}).prvKeyObj=F,R.pubKeyObj=g,R}throw new Error("unknown algorithm: "+a)},Te.getPEM=function(a,u,p,g,m,w){var F=v,R=F.asn1,P=R.DERObjectIdentifier,B=R.DERInteger,K=R.ASN1Util.newObject,L=R.x509.SubjectPublicKeyInfo,O=F.crypto,U=O.DSA,W=O.ECDSA,Y=Nt;function st($t){return K({seq:[{int:0},{int:{bigint:$t.n}},{int:$t.e},{int:{bigint:$t.d}},{int:{bigint:$t.p}},{int:{bigint:$t.q}},{int:{bigint:$t.dmp1}},{int:{bigint:$t.dmq1}},{int:{bigint:$t.coeff}}]})}function vt($t){return K({seq:[{int:1},{octstr:{hex:$t.prvKeyHex}},{tag:["a0",!0,{oid:{name:$t.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+$t.pubKeyHex}}]}]})}function At($t){return K({seq:[{int:0},{int:{bigint:$t.p}},{int:{bigint:$t.q}},{int:{bigint:$t.g}},{int:{bigint:$t.y}},{int:{bigint:$t.x}}]})}if((Y!==void 0&&a instanceof Y||U!==void 0&&a instanceof U||W!==void 0&&a instanceof W)&&a.isPublic==1&&(u===void 0||u=="PKCS8PUB"))return Xe(ut=new L(a).tohex(),"PUBLIC KEY");if(u=="PKCS1PRV"&&Y!==void 0&&a instanceof Y&&(p===void 0||p==null)&&a.isPrivate==1)return Xe(ut=st(a).tohex(),"RSA PRIVATE KEY");if(u=="PKCS1PRV"&&W!==void 0&&a instanceof W&&(p===void 0||p==null)&&a.isPrivate==1){var Mt=new P({name:a.curveName}).tohex(),Bt=vt(a).tohex(),Q="";return(Q+=Xe(Mt,"EC PARAMETERS"))+Xe(Bt,"EC PRIVATE KEY")}if(u=="PKCS1PRV"&&U!==void 0&&a instanceof U&&(p===void 0||p==null)&&a.isPrivate==1)return Xe(ut=At(a).tohex(),"DSA PRIVATE KEY");if(u=="PKCS5PRV"&&Y!==void 0&&a instanceof Y&&p!==void 0&&p!=null&&a.isPrivate==1){var ut=st(a).tohex();return g===void 0&&(g="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",ut,p,g,w)}if(u=="PKCS5PRV"&&W!==void 0&&a instanceof W&&p!==void 0&&p!=null&&a.isPrivate==1)return ut=vt(a).tohex(),g===void 0&&(g="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",ut,p,g,w);if(u=="PKCS5PRV"&&U!==void 0&&a instanceof U&&p!==void 0&&p!=null&&a.isPrivate==1)return ut=At(a).tohex(),g===void 0&&(g="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",ut,p,g,w);var pt=function($t,Wt){if(typeof Wt=="string")return Te.getEncryptedPKCS8PEM($t,Wt);if(typeof Wt=="object"&&Ue(Wt,"passcode")!=null){var Ht=JSON.parse(JSON.stringify(Wt)),Se=Ht.passcode;return delete Ht.passcode,Te.getEncryptedPKCS8PEM($t,Se,Ht)}};if(u=="PKCS8PRV"&&Y!=null&&a instanceof Y&&a.isPrivate==1){var it=st(a).tohex();return ut=K({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:it}}]}).tohex(),p===void 0||p==null?Xe(ut,"PRIVATE KEY"):pt(ut,p)}if(u=="PKCS8PRV"&&W!==void 0&&a instanceof W&&a.isPrivate==1){var bt={seq:[{int:1},{octstr:{hex:a.prvKeyHex}}]};return typeof a.pubKeyHex=="string"&&bt.seq.push({tag:["a1",!0,{bitstr:{hex:"00"+a.pubKeyHex}}]}),it=new K(bt).tohex(),ut=K({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:a.curveName}}]},{octstr:{hex:it}}]}).tohex(),p===void 0||p==null?Xe(ut,"PRIVATE KEY"):pt(ut,p)}if(u=="PKCS8PRV"&&U!==void 0&&a instanceof U&&a.isPrivate==1)return it=new B({bigint:a.x}).tohex(),ut=K({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:a.p}},{int:{bigint:a.q}},{int:{bigint:a.g}}]}]},{octstr:{hex:it}}]}).tohex(),p===void 0||p==null?Xe(ut,"PRIVATE KEY"):pt(ut,p);throw new Error("unsupported object nor format")},Te.getKeyFromCSRPEM=function(a){var u=Qe(a,"CERTIFICATE REQUEST");return Te.getKeyFromCSRHex(u)},Te.getKeyFromCSRHex=function(a){var u=Te.parseCSRHex(a);return Te.getKey(u.p8pubkeyhex,null,"pkcs8pub")},Te.parseCSRHex=function(a){var u=Vt,p=u.getChildIdx,g=u.getTLV,m={},w=a;if(w.substr(0,2)!="30")throw new Error("malformed CSR(code:001)");var F=p(w,0);if(F.length<1)throw new Error("malformed CSR(code:002)");if(w.substr(F[0],2)!="30")throw new Error("malformed CSR(code:003)");var R=p(w,F[0]);if(R.length<3)throw new Error("malformed CSR(code:004)");return m.p8pubkeyhex=g(w,R[2]),m},Te.getKeyID=function(a){var u=Te,p=Vt;typeof a=="string"&&a.indexOf("BEGIN ")!=-1&&(a=u.getKey(a));var g=Qe(u.getPEM(a)),m=p.getIdxbyList(g,0,[1]),w=p.getV(g,m).substring(2);return v.crypto.Util.hashHex(w,"sha1")},Te.getJWK=function(a,u,p,g,m){var w,F,R={},P=v.crypto.Util.hashHex;if(typeof a=="string")w=Te.getKey(a),a.indexOf("CERTIFICATE")!=-1&&(F=Qe(a));else{if(typeof a!="object")throw new Error("unsupported keyinfo type");a instanceof Ee?(w=a.getPublicKey(),F=a.hex):w=a}if(w instanceof Nt&&w.isPrivate)R.kty="RSA",R.n=Me(w.n.toString(16)),R.e=Me(w.e.toString(16)),R.d=Me(w.d.toString(16)),R.p=Me(w.p.toString(16)),R.q=Me(w.q.toString(16)),R.dp=Me(w.dmp1.toString(16)),R.dq=Me(w.dmq1.toString(16)),R.qi=Me(w.coeff.toString(16));else if(w instanceof Nt&&w.isPublic)R.kty="RSA",R.n=Me(w.n.toString(16)),R.e=Me(w.e.toString(16));else if(w instanceof v.crypto.ECDSA&&w.isPrivate){if((K=w.getShortNISTPCurveName())!=="P-256"&&K!=="P-384"&&K!=="P-521")throw new Error("unsupported curve name for JWT: "+K);var B=w.getPublicKeyXYHex();R.kty="EC",R.crv=K,R.x=Me(B.x),R.y=Me(B.y),R.d=Me(w.prvKeyHex)}else if(w instanceof v.crypto.ECDSA&&w.isPublic){var K;if((K=w.getShortNISTPCurveName())!=="P-256"&&K!=="P-384"&&K!=="P-521")throw new Error("unsupported curve name for JWT: "+K);B=w.getPublicKeyXYHex(),R.kty="EC",R.crv=K,R.x=Me(B.x),R.y=Me(B.y)}if(R.kty==null)throw new Error("unsupported keyinfo");return w.isPrivate||u==1||(R.kid=v.jws.JWS.getJWKthumbprint(R)),F!=null&&p!=1&&(R.x5c=[at(F)]),F!=null&&g!=1&&(R.x5t=lr(at(P(F,"sha1")))),F!=null&&m!=1&&(R["x5t#S256"]=lr(at(P(F,"sha256")))),R},Te.getJWKFromKey=function(a){return Te.getJWK(a,!0,!0,!0,!0)},Nt.getPosArrayOfChildrenFromHex=function(a){return Vt.getChildIdx(a,0)},Nt.getHexValueArrayOfChildrenFromHex=function(a){var u,p=Vt.getV,g=p(a,(u=Nt.getPosArrayOfChildrenFromHex(a))[0]),m=p(a,u[1]),w=p(a,u[2]),F=p(a,u[3]),R=p(a,u[4]),P=p(a,u[5]),B=p(a,u[6]),K=p(a,u[7]),L=p(a,u[8]);return(u=new Array).push(g,m,w,F,R,P,B,K,L),u},Nt.prototype.readPrivateKeyFromPEMString=function(a){var u=Qe(a),p=Nt.getHexValueArrayOfChildrenFromHex(u);this.setPrivateEx(p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8])},Nt.prototype.readPKCS5PrvKeyHex=function(a){var u=Nt.getHexValueArrayOfChildrenFromHex(a);this.setPrivateEx(u[1],u[2],u[3],u[4],u[5],u[6],u[7],u[8])},Nt.prototype.readPKCS8PrvKeyHex=function(a){var u,p,g,m,w,F,R,P,B=Vt,K=B.getVbyListEx;if(B.isASN1HEX(a)===!1)throw new Error("not ASN.1 hex string");try{u=K(a,0,[2,0,1],"02"),p=K(a,0,[2,0,2],"02"),g=K(a,0,[2,0,3],"02"),m=K(a,0,[2,0,4],"02"),w=K(a,0,[2,0,5],"02"),F=K(a,0,[2,0,6],"02"),R=K(a,0,[2,0,7],"02"),P=K(a,0,[2,0,8],"02")}catch{throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(u,p,g,m,w,F,R,P)},Nt.prototype.readPKCS5PubKeyHex=function(a){var u=Vt,p=u.getV;if(u.isASN1HEX(a)===!1)throw new Error("keyHex is not ASN.1 hex string");var g=u.getChildIdx(a,0);if(g.length!==2||a.substr(g[0],2)!=="02"||a.substr(g[1],2)!=="02")throw new Error("wrong hex for PKCS#5 public key");var m=p(a,g[0]),w=p(a,g[1]);this.setPublic(m,w)},Nt.prototype.readPKCS8PubKeyHex=function(a){var u=Vt;if(u.isASN1HEX(a)===!1)throw new Error("not ASN.1 hex string");if(u.getTLVbyListEx(a,0,[0,0])!=="06092a864886f70d010101")throw new Error("not PKCS8 RSA public key");var p=u.getTLVbyListEx(a,0,[1,0]);this.readPKCS5PubKeyHex(p)},Nt.prototype.readCertPubKeyHex=function(a,u){var p,g;(p=new Ee).readCertHex(a),g=p.getPublicKeyHex(),this.readPKCS8PubKeyHex(g)},new RegExp("[^0-9a-f]","gi"),Nt.prototype.sign=function(a,u){var p,g=(p=a,v.crypto.Util.hashString(p,u));return this.signWithMessageHash(g,u)},Nt.prototype.signWithMessageHash=function(a,u){var p=Dt(v.crypto.Util.getPaddedDigestInfoHex(a,u,this.n.bitLength()),16);return Jt(this.doPrivate(p).toString(16),this.n.bitLength())},Nt.prototype.signPSS=function(a,u,p){var g,m=(g=Sr(a),v.crypto.Util.hashHex(g,u));return p===void 0&&(p=-1),this.signWithMessageHashPSS(m,u,p)},Nt.prototype.signWithMessageHashPSS=function(a,u,p){var g,m=hr(a),w=m.length,F=this.n.bitLength()-1,R=Math.ceil(F/8),P=function(st){return v.crypto.Util.hashHex(st,u)};if(p===-1||p===void 0)p=w;else if(p===-2)p=R-w-2;else if(p<-2)throw new Error("invalid salt length");if(R<w+p+2)throw new Error("data too long");var B="";p>0&&(B=new Array(p),new ge().nextBytes(B),B=String.fromCharCode.apply(String,B));var K=hr(P(Sr("\0\0\0\0\0\0\0\0"+m+B))),L=[];for(g=0;g<R-p-w-2;g+=1)L[g]=0;var O=String.fromCharCode.apply(String,L)+""+B,U=jn(K,O.length,P),W=[];for(g=0;g<O.length;g+=1)W[g]=O.charCodeAt(g)^U.charCodeAt(g);var Y=65280>>8*R-F&255;for(W[0]&=~Y,g=0;g<w;g++)W.push(K.charCodeAt(g));return W.push(188),Jt(this.doPrivate(new tt(W)).toString(16),this.n.bitLength())},Nt.prototype.verify=function(a,u){if((u=u.toLowerCase()).match(/^[0-9a-f]+$/)==null)return!1;var p=Dt(u,16),g=this.n.bitLength();if(p.bitLength()>g)return!1;var m=this.doPublic(p).toString(16);if(m.length+3!=g/4)return!1;var w=Pn(m.replace(/^1f+00/,""));if(w.length==0)return!1;var F,R=w[0];return w[1]==(F=a,v.crypto.Util.hashString(F,R))},Nt.prototype.verifyWithMessageHash=function(a,u){if(u.length!=Math.ceil(this.n.bitLength()/4))return!1;var p=Dt(u,16);if(p.bitLength()>this.n.bitLength())return 0;var g=Pn(this.doPublic(p).toString(16).replace(/^1f+00/,""));return g.length!=0&&(g[0],g[1]==a)},Nt.prototype.verifyPSS=function(a,u,p,g){var m,w=(m=Sr(a),v.crypto.Util.hashHex(m,p));return g===void 0&&(g=-1),this.verifyWithMessageHashPSS(w,u,p,g)},Nt.prototype.verifyWithMessageHashPSS=function(a,u,p,g){if(u.length!=Math.ceil(this.n.bitLength()/4))return!1;var m,w=new tt(u,16),F=function(At){return v.crypto.Util.hashHex(At,p)},R=hr(a),P=R.length,B=this.n.bitLength()-1,K=Math.ceil(B/8);if(g===-1||g===void 0)g=P;else if(g===-2)g=K-P-2;else if(g<-2)throw new Error("invalid salt length");if(K<P+g+2)throw new Error("data too long");var L=this.doPublic(w).toByteArray();for(m=0;m<L.length;m+=1)L[m]&=255;for(;L.length<K;)L.unshift(0);if(L[K-1]!==188)throw new Error("encoded message does not end in 0xbc");var O=(L=String.fromCharCode.apply(String,L)).substr(0,K-P-1),U=L.substr(O.length,P),W=65280>>8*K-B&255;if(O.charCodeAt(0)&W)throw new Error("bits beyond keysize not zero");var Y=jn(U,O.length,F),st=[];for(m=0;m<O.length;m+=1)st[m]=O.charCodeAt(m)^Y.charCodeAt(m);st[0]&=~W;var vt=K-P-g-2;for(m=0;m<vt;m+=1)if(st[m]!==0)throw new Error("leftmost octets not zero");if(st[vt]!==1)throw new Error("0x01 marker not found");return U===hr(F(Sr("\0\0\0\0\0\0\0\0"+R+String.fromCharCode.apply(String,st.slice(-g)))))},Nt.SALT_LEN_HLEN=-1,Nt.SALT_LEN_MAX=-2,Nt.SALT_LEN_RECOVER=-2,Ee.EXT_PARSER={},Ee.registExtParser=function(a,u){Ee.EXT_PARSER[a]=u},Ee.hex2dn=function(a,u){u===void 0&&(u=0);var p=new Ee;return Vt.getTLV(a,u),p.getX500Name(a).str},Ee.hex2rdn=function(a,u){if(u===void 0&&(u=0),a.substr(u,2)!=="31")throw new Error("malformed RDN");for(var p=new Array,g=Vt.getChildIdx(a,u),m=0;m<g.length;m++)p.push(Ee.hex2attrTypeValue(a,g[m]));return(p=p.map(function(w){return w.replace("+","\\+")})).join("+")},Ee.hex2attrTypeValue=function(a,u){var p=Vt,g=p.getV;if(u===void 0&&(u=0),a.substr(u,2)!=="30")throw new Error("malformed attribute type and value");var m=p.getChildIdx(a,u);m.length!==2||a.substr(m[0],2);var w=g(a,m[0]),F=v.asn1.ASN1Util.oidHexToInt(w);return v.asn1.x509.OID.oid2atype(F)+"="+hr(g(a,m[1]))},Ee.getPublicKeyFromCertHex=function(a){var u=new Ee;return u.readCertHex(a),u.getPublicKey()},Ee.getPublicKeyFromCertPEM=function(a){var u=new Ee;return u.readCertPEM(a),u.getPublicKey()},Ee.getPublicKeyInfoPropOfCertPEM=function(a){var u,p,g=Vt.getVbyList,m={algparam:null};return(u=new Ee).readCertPEM(a),p=u.getPublicKeyHex(),m.keyhex=g(p,0,[1],"03").substr(2),m.algoid=g(p,0,[0,0],"06"),m.algoid==="2a8648ce3d0201"&&(m.algparam=g(p,0,[0,1],"06")),m},Ee.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],v!==void 0&&v||(v={}),v.jws!==void 0&&v.jws||(v.jws={}),v.jws.JWS=function(){var a=v.jws.JWS.isSafeJSONString;this.parseJWS=function(u,p){if(this.parsedJWS===void 0||!p&&this.parsedJWS.sigvalH===void 0){var g=u.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(g==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var m=g[1],w=g[2],F=g[3],R=m+"."+w;if(this.parsedJWS={},this.parsedJWS.headB64U=m,this.parsedJWS.payloadB64U=w,this.parsedJWS.sigvalB64U=F,this.parsedJWS.si=R,!p){var P=Ke(F),B=Dt(P,16);this.parsedJWS.sigvalH=P,this.parsedJWS.sigvalBI=B}var K=ce(m),L=ce(w);if(this.parsedJWS.headS=K,this.parsedJWS.payloadS=L,!a(K,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+K}}},v.jws.JWS.sign=function(a,u,p,g,m){var w,F,R,P=v,B=P.jws.JWS,K=B.readSafeJSONString,L=B.isSafeJSONString,O=P.crypto,U=(O.ECDSA,O.Mac),W=O.Signature,Y=JSON;if(typeof u!="string"&&typeof u!="object")throw"spHeader must be JSON string or object: "+u;if(typeof u=="object"&&(F=u,w=Y.stringify(F)),typeof u=="string"){if(!L(w=u))throw"JWS Head is not safe JSON string: "+w;F=K(w)}if(R=p,typeof p=="object"&&(R=Y.stringify(p)),a!=""&&a!=null||F.alg===void 0||(a=F.alg),a!=""&&a!=null&&F.alg===void 0&&(F.alg=a,w=Y.stringify(F)),a!==F.alg)throw"alg and sHeader.alg doesn't match: "+a+"!="+F.alg;var st=null;if(B.jwsalg2sigalg[a]===void 0)throw"unsupported alg name: "+a;st=B.jwsalg2sigalg[a];var vt=Be(w)+"."+Be(R),At="";if(st.substr(0,4)=="Hmac"){if(g===void 0)throw"mac key shall be specified for HS* alg";var Mt=new U({alg:st,prov:"cryptojs",pass:g});Mt.updateString(vt),At=Mt.doFinal()}else if(st.indexOf("withECDSA")!=-1){(Q=new W({alg:st})).init(g,m),Q.updateString(vt);var Bt=Q.sign();At=v.crypto.ECDSA.asn1SigToConcatSig(Bt)}else{var Q;st!="none"&&((Q=new W({alg:st})).init(g,m),Q.updateString(vt),At=Q.sign())}return vt+"."+Me(At)},v.jws.JWS.verify=function(a,u,p){var g,m=v,w=m.jws.JWS,F=w.readSafeJSONString,R=m.crypto,P=R.ECDSA,B=R.Mac,K=R.Signature;if(g=Nt,!or(a))return!1;var L=a.split(".");if(L.length!==3)return!1;var O,U=L[0]+"."+L[1],W=Ke(L[2]),Y=F(ce(L[0])),st=null;if(Y.alg===void 0)throw"algorithm not specified in header";if(O=(st=Y.alg).substr(0,2),p!=null&&Object.prototype.toString.call(p)==="[object Array]"&&p.length>0&&(":"+p.join(":")+":").indexOf(":"+st+":")==-1)throw"algorithm '"+st+"' not accepted in the list";if(st!="none"&&u===null)throw"key shall be specified to verify.";if(typeof u=="string"&&u.indexOf("-----BEGIN ")!=-1&&(u=Te.getKey(u)),!(O!="RS"&&O!="PS"||u instanceof g))throw"key shall be a RSAKey obj for RS* and PS* algs";if(O=="ES"&&!(u instanceof P))throw"key shall be a ECDSA obj for ES* algs";var vt=null;if(w.jwsalg2sigalg[Y.alg]===void 0)throw"unsupported alg name: "+st;if((vt=w.jwsalg2sigalg[st])=="none")throw"not supported";if(vt.substr(0,4)=="Hmac"){if(u===void 0)throw"hexadecimal key shall be specified for HMAC";var At=new B({alg:vt,pass:u});return At.updateString(U),W==At.doFinal()}if(vt.indexOf("withECDSA")!=-1){var Mt,Bt=null;try{Bt=P.concatSigToASN1Sig(W)}catch{return!1}return(Mt=new K({alg:vt})).init(u),Mt.updateString(U),Mt.verify(Bt)}return(Mt=new K({alg:vt})).init(u),Mt.updateString(U),Mt.verify(W)},v.jws.JWS.parse=function(a){var u,p,g,m=a.split("."),w={};if(m.length!=2&&m.length!=3)throw"malformed sJWS: wrong number of '.' splitted elements";return u=m[0],p=m[1],m.length==3&&(g=m[2]),w.headerObj=v.jws.JWS.readSafeJSONString(ce(u)),w.payloadObj=v.jws.JWS.readSafeJSONString(ce(p)),w.headerPP=JSON.stringify(w.headerObj,null,"  "),w.payloadObj==null?w.payloadPP=ce(p):w.payloadPP=JSON.stringify(w.payloadObj,null,"  "),g!==void 0&&(w.sigHex=Ke(g)),w},v.jws.JWS.verifyJWT=function(a,u,p){var g=v.jws,m=g.JWS,w=m.readSafeJSONString,F=m.inArray,R=m.includedArray;if(!or(a))return!1;var P=a.split(".");if(P.length!=3)return!1;var B=P[0],K=P[1],L=(Ke(P[2]),w(ce(B))),O=w(ce(K));if(L.alg===void 0)return!1;if(p.alg===void 0)throw"acceptField.alg shall be specified";if(!F(L.alg,p.alg)||O.iss!==void 0&&typeof p.iss=="object"&&!F(O.iss,p.iss)||O.sub!==void 0&&typeof p.sub=="object"&&!F(O.sub,p.sub))return!1;if(O.aud!==void 0&&typeof p.aud=="object"){if(typeof O.aud=="string"){if(!F(O.aud,p.aud))return!1}else if(typeof O.aud=="object"&&!R(O.aud,p.aud))return!1}var U=g.IntDate.getNow();return p.verifyAt!==void 0&&typeof p.verifyAt=="number"&&(U=p.verifyAt),p.gracePeriod!==void 0&&typeof p.gracePeriod=="number"||(p.gracePeriod=0),!(O.exp!==void 0&&typeof O.exp=="number"&&O.exp+p.gracePeriod<U||O.nbf!==void 0&&typeof O.nbf=="number"&&U<O.nbf-p.gracePeriod||O.iat!==void 0&&typeof O.iat=="number"&&U<O.iat-p.gracePeriod||O.jti!==void 0&&p.jti!==void 0&&O.jti!==p.jti||!m.verify(a,u,p.alg))},v.jws.JWS.includedArray=function(a,u){var p=v.jws.JWS.inArray;if(a===null||typeof a!="object"||typeof a.length!="number")return!1;for(var g=0;g<a.length;g++)if(!p(a[g],u))return!1;return!0},v.jws.JWS.inArray=function(a,u){if(u===null||typeof u!="object"||typeof u.length!="number")return!1;for(var p=0;p<u.length;p++)if(u[p]==a)return!0;return!1},v.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",ES512:"SHA512withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},v.jws.JWS.isSafeJSONString=function(a,u,p){var g=null;try{return typeof(g=be(a))!="object"||g.constructor===Array?0:(u&&(u[p]=g),1)}catch{return 0}},v.jws.JWS.readSafeJSONString=function(a){var u=null;try{return typeof(u=be(a))!="object"||u.constructor===Array?null:u}catch{return null}},v.jws.JWS.getEncodedSignatureValueFromJWS=function(a){var u=a.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(u==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return u[1]},v.jws.JWS.getJWKthumbprint=function(a){if(a.kty!=="RSA"&&a.kty!=="EC"&&a.kty!=="oct")throw"unsupported algorithm for JWK Thumprint";var u="{";if(a.kty==="RSA"){if(typeof a.n!="string"||typeof a.e!="string")throw"wrong n and e value for RSA key";u+='"e":"'+a.e+'",',u+='"kty":"'+a.kty+'",',u+='"n":"'+a.n+'"}'}else if(a.kty==="EC"){if(typeof a.crv!="string"||typeof a.x!="string"||typeof a.y!="string")throw"wrong crv, x and y value for EC key";u+='"crv":"'+a.crv+'",',u+='"kty":"'+a.kty+'",',u+='"x":"'+a.x+'",',u+='"y":"'+a.y+'"}'}else if(a.kty==="oct"){if(typeof a.k!="string")throw"wrong k value for oct(symmetric) key";u+='"kty":"'+a.kty+'",',u+='"k":"'+a.k+'"}'}var p=Sr(u);return Me(v.crypto.Util.hashHex(p,"sha256"))},v.jws.IntDate={},v.jws.IntDate.get=function(a){var u=v.jws.IntDate,p=u.getNow,g=u.getZulu;if(a=="now")return p();if(a=="now + 1hour")return p()+3600;if(a=="now + 1day")return p()+86400;if(a=="now + 1month")return p()+2592e3;if(a=="now + 1year")return p()+31536e3;if(a.match(/Z$/))return g(a);if(a.match(/^[0-9]+$/))return parseInt(a);throw"unsupported format: "+a},v.jws.IntDate.getZulu=function(a){return Gr(a)},v.jws.IntDate.getNow=function(){return~~(new Date/1e3)},v.jws.IntDate.intDate2UTCString=function(a){return new Date(1e3*a).toUTCString()},v.jws.IntDate.intDate2Zulu=function(a){var u=new Date(1e3*a);return("0000"+u.getUTCFullYear()).slice(-4)+("00"+(u.getUTCMonth()+1)).slice(-2)+("00"+u.getUTCDate()).slice(-2)+("00"+u.getUTCHours()).slice(-2)+("00"+u.getUTCMinutes()).slice(-2)+("00"+u.getUTCSeconds()).slice(-2)+"Z"},v!==void 0&&v||(v={}),v.jws!==void 0&&v.jws||(v.jws={}),v.jws.JWSJS=function(){var a=v.jws.JWS,u=a.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(p){this.init();var g=p.split(".");if(g.length!=3)throw"malformed input JWS";this.aHeader.push(g[0]),this.sPayload=g[1],this.aSignature.push(g[2])},this.addSignature=function(p,g,m,w){if(this.sPayload===void 0||this.sPayload===null)throw"there's no JSON-JS signature to add.";var F=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var R=v.jws.JWS.sign(p,g,this.sPayload,m,w).split(".");R[0],R[2],this.aHeader.push(R[0]),this.aSignature.push(R[2])}catch(P){throw this.aHeader.length>F&&this.aHeader.pop(),this.aSignature.length>F&&this.aSignature.pop(),"addSignature failed: "+P}},this.verifyAll=function(p){if(this.aHeader.length!==p.length||this.aSignature.length!==p.length)return!1;for(var g=0;g<p.length;g++){var m=p[g];if(m.length!==2||this.verifyNth(g,m[0],m[1])===!1)return!1}return!0},this.verifyNth=function(p,g,m){if(this.aHeader.length<=p||this.aSignature.length<=p)return!1;var w=this.aHeader[p],F=this.aSignature[p],R=w+"."+this.sPayload+"."+F,P=!1;try{P=a.verify(R,g,m)}catch{return!1}return P},this.readJWSJS=function(p){if(typeof p=="string"){var g=u(p);if(g==null)throw"argument is not safe JSON object string";this.aHeader=g.headers,this.sPayload=g.payload,this.aSignature=g.signatures}else try{if(!(p.headers.length>0))throw"malformed header";if(this.aHeader=p.headers,typeof p.payload!="string"||(this.sPayload=p.payload,!(p.signatures.length>0)))throw"malformed signatures";this.aSignature=p.signatures}catch(m){throw"malformed JWS-JS JSON object: "+m}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return this.aHeader.length==0?1:0}},_$jsrsasign_52.SecureRandom=ge,_$jsrsasign_52.rng_seed_time=_e,_$jsrsasign_52.BigInteger=tt,_$jsrsasign_52.RSAKey=Nt,_$jsrsasign_52.ECDSA=v.crypto.ECDSA,_$jsrsasign_52.DSA=v.crypto.DSA,_$jsrsasign_52.Signature=v.crypto.Signature,_$jsrsasign_52.MessageDigest=v.crypto.MessageDigest,_$jsrsasign_52.Mac=v.crypto.Mac,_$jsrsasign_52.KEYUTIL=Te,_$jsrsasign_52.ASN1HEX=Vt,_$jsrsasign_52.X509=Ee,_$jsrsasign_52.X509CRL=function(a){var u=v.lang.String.isHex,p=Vt,g=p.getV,m=p.getTLV,w=p.getVbyList,F=p.getTLVbyList,R=p.getTLVbyListEx,P=p.getIdxbyList,B=p.getIdxbyListEx,K=p.getChildIdx,L=new Ee;this.hex=null,this.posSigAlg=null,this.posRevCert=null,this.parsed=null,this._setPos=function(){var O=P(this.hex,0,[0,0]),U=this.hex.substr(O,2);if(U=="02")this.posSigAlg=1;else{if(U!="30")throw new Error("malformed 1st item of TBSCertList: "+U);this.posSigAlg=0}var W,Y=P(this.hex,0,[0,this.posSigAlg+3]),st=this.hex.substr(Y,2);if(st=="17"||st=="18")W=P(this.hex,0,[0,this.posSigAlg+4]),this.posRevCert=null,W!=-1&&this.hex.substr(W,2)=="30"&&(this.posRevCert=this.posSigAlg+4);else if(st=="30")this.posRevCert=this.posSigAlg+3;else{if(st!="a0")throw new Error("malformed nextUpdate or revCert tag: "+st);this.posRevCert=null}},this.getVersion=function(){return this.posSigAlg==0?null:parseInt(w(this.hex,0,[0,0],"02"),16)+1},this.getSignatureAlgorithmField=function(){var O=F(this.hex,0,[0,this.posSigAlg],"30");return L.getAlgorithmIdentifierName(O)},this.getIssuer=function(){return L.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return F(this.hex,0,[0,this.posSigAlg+1],"30")},this.getThisUpdate=function(){var O=w(this.hex,0,[0,this.posSigAlg+2]);return result=hr(O)},this.getNextUpdate=function(){var O=P(this.hex,0,[0,this.posSigAlg+3]),U=this.hex.substr(O,2);return U!="17"&&U!="18"?null:hr(g(this.hex,O))},this.getRevCertArray=function(){if(this.posRevCert==null)return null;for(var O=[],U=P(this.hex,0,[0,this.posRevCert]),W=K(this.hex,U),Y=0;Y<W.length;Y++){var st=m(this.hex,W[Y]);O.push(this.getRevCert(st))}return O},this.getRevCert=function(O){var U={},W=K(O,0);return U.sn={hex:w(O,0,[0],"02")},U.date=hr(w(O,0,[1])),W.length==3&&(U.ext=L.getExtParamArray(F(O,0,[2]))),U},this.findRevCert=function(O){var U=new Ee(O).getSerialNumberHex();return this.findRevCertBySN(U)},this.findRevCertBySN=function(O){if(this.parsed==null&&this.getParam(),this.parsed.revcert==null)return null;for(var U=this.parsed.revcert,W=0;W<U.length;W++)if(O==U[W].sn.hex)return U[W];return null},this.getSignatureValueHex=function(){return w(this.hex,0,[2],"03",!0)},this.verifySignature=function(O){var U=this.getSignatureAlgorithmField(),W=this.getSignatureValueHex(),Y=F(this.hex,0,[0],"30"),st=new v.crypto.Signature({alg:U});return st.init(O),st.updateHex(Y),st.verify(W)},this.getParam=function(O){var U={},W=this.getVersion();W!=null&&(U.version=W),U.sigalg=this.getSignatureAlgorithmField(),U.issuer=this.getIssuer(),U.thisupdate=this.getThisUpdate();var Y=this.getNextUpdate();Y!=null&&(U.nextupdate=Y);var st=this.getRevCertArray();if(st!=null&&(U.revcert=st),B(this.hex,0,[0,"[0]"])!=-1){var vt=R(this.hex,0,[0,"[0]",0]);U.ext=L.getExtParamArray(vt)}return U.sighex=this.getSignatureValueHex(),this.parsed=U,typeof O=="object"&&(O.tbshex==1&&(U.tbshex=F(this.hex,0,[0])),O.nodnarray==1&&delete U.issuer.array),U},typeof a=="string"&&(u(a)?this.hex=a:a.match(/-----BEGIN X509 CRL/)&&(this.hex=Qe(a)),this._setPos())},_$jsrsasign_52.CryptoJS=z,_$jsrsasign_52.b64tohex=ct,_$jsrsasign_52.b64toBA=ot,_$jsrsasign_52.ECFieldElementFp=ie,_$jsrsasign_52.ECPointFp=ee,_$jsrsasign_52.ECCurveFp=Kt,_$jsrsasign_52.stoBA=ze,_$jsrsasign_52.BAtos=We,_$jsrsasign_52.BAtohex=Je,_$jsrsasign_52.stohex=nr,_$jsrsasign_52.stob64=function(a){return at(nr(a))},_$jsrsasign_52.stob64u=function(a){return lr(at(nr(a)))},_$jsrsasign_52.b64utos=function(a){return We(ot(ur(a)))},_$jsrsasign_52.b64tob64u=lr,_$jsrsasign_52.b64utob64=ur,_$jsrsasign_52.hex2b64=at,_$jsrsasign_52.hextob64u=Me,_$jsrsasign_52.b64utohex=Ke,_$jsrsasign_52.utf8tob64u=Be,_$jsrsasign_52.b64utoutf8=ce,_$jsrsasign_52.utf8tob64=function(a){return at(Yr(Ar(a)))},_$jsrsasign_52.b64toutf8=function(a){return decodeURIComponent(Xr(ct(a)))},_$jsrsasign_52.utf8tohex=Ir,_$jsrsasign_52.hextoutf8=Le,_$jsrsasign_52.hextorstr=hr,_$jsrsasign_52.rstrtohex=Sr,_$jsrsasign_52.hextob64=Jr,_$jsrsasign_52.hextob64nl=function(a){return Kr(Jr(a),64)},_$jsrsasign_52.b64nltohex=tr,_$jsrsasign_52.hextopem=Xe,_$jsrsasign_52.pemtohex=Qe,_$jsrsasign_52.hextoArrayBuffer=function(a){if(a.length%2!=0)throw"input is not even length";if(a.match(/^[0-9A-Fa-f]+$/)==null)throw"input is not hexadecimal";for(var u=new ArrayBuffer(a.length/2),p=new DataView(u),g=0;g<a.length/2;g++)p.setUint8(g,parseInt(a.substr(2*g,2),16));return u},_$jsrsasign_52.ArrayBuffertohex=function(a){for(var u="",p=new DataView(a),g=0;g<a.byteLength;g++)u+=("00"+p.getUint8(g).toString(16)).slice(-2);return u},_$jsrsasign_52.zulutomsec=an,_$jsrsasign_52.msectozulu=function(a){var u=new Date(a),p=("0000"+u.getUTCFullYear()).slice(-4),g=("00"+(u.getUTCMonth()+1)).slice(-2),m=("00"+u.getUTCDate()).slice(-2),w=("00"+u.getUTCHours()).slice(-2),F=("00"+u.getUTCMinutes()).slice(-2),R=("00"+u.getUTCSeconds()).slice(-2),P=("000"+u.getUTCMilliseconds()).slice(-3);return p+g+m+w+F+R+(P=(P=P.replace(/0+$/,""))!=""?"."+P:P)+"Z"},_$jsrsasign_52.zulutosec=Gr,_$jsrsasign_52.zulutodate=function(a){return new Date(an(a))},_$jsrsasign_52.datetozulu=function(a,u,p){var g,m=a.getUTCFullYear();if(u){if(m<1950||2049<m)throw"not proper year for UTCTime: "+m;g=(""+m).slice(-2)}else g=("000"+m).slice(-4);if(g+=("0"+(a.getUTCMonth()+1)).slice(-2),g+=("0"+a.getUTCDate()).slice(-2),g+=("0"+a.getUTCHours()).slice(-2),g+=("0"+a.getUTCMinutes()).slice(-2),g+=("0"+a.getUTCSeconds()).slice(-2),p){var w=a.getUTCMilliseconds();w!==0&&(g+="."+(w=(w=("00"+w).slice(-3)).replace(/0+$/g,"")))}return g+"Z"},_$jsrsasign_52.uricmptohex=Yr,_$jsrsasign_52.hextouricmp=Xr,_$jsrsasign_52.ipv6tohex=sn,_$jsrsasign_52.hextoipv6=se,_$jsrsasign_52.hextoip=ye,_$jsrsasign_52.iptohex=ar,_$jsrsasign_52.ucs2hextoutf8=Zr,_$jsrsasign_52.encodeURIComponentAll=Ar,_$jsrsasign_52.newline_toUnix=function(a){return a.replace(/\r\n/gm,`
`)},_$jsrsasign_52.newline_toDos=function(a){return(a=a.replace(/\r\n/gm,`
`)).replace(/\n/gm,`\r
`)},_$jsrsasign_52.hextoposhex=J,_$jsrsasign_52.intarystrtohex=function(a){a=(a=(a=a.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{return a.split(/,/).map(function(u,p,g){var m=parseInt(u);if(m<0||255<m)throw"integer not in range 0-255";return("00"+m.toString(16)).slice(-2)}).join("")}catch(u){throw"malformed integer array string: "+u}},_$jsrsasign_52.strdiffidx=function(a,u){var p=a.length;a.length>u.length&&(p=u.length);for(var g=0;g<p;g++)if(a.charCodeAt(g)!=u.charCodeAt(g))return g;return a.length!=u.length?p:-1},_$jsrsasign_52.oidtohex=xe,_$jsrsasign_52.hextooid=Tr,_$jsrsasign_52.strpad=Lt,_$jsrsasign_52.bitstrtoint=sr,_$jsrsasign_52.inttobitstr=_n,_$jsrsasign_52.bitstrtobinstr=Ie,_$jsrsasign_52.binstrtobitstr=function(a){if(typeof a!="string"||a.match(/^[01]+$/)==null)return null;try{return _n(parseInt(a,2))}catch{return null}},_$jsrsasign_52.isBase64URLDot=or,_$jsrsasign_52.namearraytobinstr=fr,_$jsrsasign_52.extendClass=Yt,_$jsrsasign_52.foldnl=Kr,_$jsrsasign_52.b64topem=function(a,u){return"-----BEGIN "+u+`-----\r
`+Kr(a,64)+`\r
-----END `+u+`-----\r
`},_$jsrsasign_52.pemtob64=function(a){return a.indexOf("-----BEGIN ")==-1||a.indexOf("-----END ")==-1?null:(a=(a=(a=a.replace(/^[\s\S]*?-----BEGIN [^-]+-----/m,"")).replace(/-----END [\s\S]+$/m,"")).replace(/\s+/g,"")).match(/^[0-9a-zA-Z+/=]+$/)?a:null},_$jsrsasign_52.timeogen=Vr,_$jsrsasign_52.aryval=Ue,_$jsrsasign_52.inttohex=gr,_$jsrsasign_52.twoscompl=Ge,_$jsrsasign_52.KJUR=v,_$jsrsasign_52.crypto=v.crypto,_$jsrsasign_52.asn1=v.asn1,_$jsrsasign_52.jws=v.jws,_$jsrsasign_52.lang=v.lang,_$jsrsasign_52.VERSION="11.1.0",_$jsrsasign_52.VERSION_FULL="jsrsasign(all) 11.1.0 (2024-02-01) (c) 2010-2023 Kenji Urushima | kjur.github.io/jsrsasign/license"}).call(this)}).call(this,_$buffer_3({}).Buffer);var _$rs_145={};Object.defineProperty(_$rs_145,"__esModule",{value:!0}),_$rs_145.default=void 0,_$rs_145.generateFingerprint=generateFingerprint;var __obj_145,_jsrsasign=(__obj_145=_$jsrsasign_52)&&__obj_145.__esModule?__obj_145:{default:__obj_145};function generateFingerprint(t){var e=_jsrsasign.default.pemtohex(t);return _jsrsasign.default.KJUR.crypto.Util.hashHex(e,"sha256").match(/.{2}/g).join(":").toUpperCase()}var ___default_145={generateFingerprint};_$rs_145.default=___default_145;var _$common_23={};function isNothing(t){return t==null}_$common_23.isNothing=isNothing,_$common_23.isObject=function(t){return typeof t=="object"&&t!==null},_$common_23.toArray=function(t){return Array.isArray(t)?t:isNothing(t)?[]:[t]},_$common_23.repeat=function(t,e){var r,n="";for(r=0;r<e;r+=1)n+=t;return n},_$common_23.isNegativeZero=function(t){return t===0&&Number.NEGATIVE_INFINITY===1/t},_$common_23.extend=function(t,e){var r,n,o,f;if(e)for(r=0,n=(f=Object.keys(e)).length;r<n;r+=1)t[o=f[r]]=e[o];return t};var _$exception_25={};function YAMLException(t,e){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=e,this.message=(this.reason||"(unknown reason)")+(this.mark?" "+this.mark.toString():""),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}YAMLException.prototype=Object.create(Error.prototype),YAMLException.prototype.constructor=YAMLException,YAMLException.prototype.toString=function(t){var e=this.name+": ";return e+=this.reason||"(unknown reason)",!t&&this.mark&&(e+=" "+this.mark.toString()),e},_$exception_25=YAMLException;var _$mark_27={};function Mark(t,e,r,n,o){this.name=t,this.buffer=e,this.position=r,this.line=n,this.column=o}Mark.prototype.getSnippet=function(t,e){var r,n,o,f,d;if(!this.buffer)return null;for(t=t||4,e=e||75,r="",n=this.position;n>0&&`\0\r
\x85\u2028\u2029`.indexOf(this.buffer.charAt(n-1))===-1;)if(n-=1,this.position-n>e/2-1){r=" ... ",n+=5;break}for(o="",f=this.position;f<this.buffer.length&&`\0\r
\x85\u2028\u2029`.indexOf(this.buffer.charAt(f))===-1;)if((f+=1)-this.position>e/2-1){o=" ... ",f-=5;break}return d=this.buffer.slice(n,f),_$common_23.repeat(" ",t)+r+d+o+`
`+_$common_23.repeat(" ",t+this.position-n+r.length)+"^"},Mark.prototype.toString=function(t){var e,r="";return this.name&&(r+='in "'+this.name+'" '),r+="at line "+(this.line+1)+", column "+(this.column+1),t||(e=this.getSnippet())&&(r+=`:
`+e),r},_$mark_27=Mark;var TYPE_CONSTRUCTOR_OPTIONS=["kind","resolve","construct","instanceOf","predicate","represent","defaultStyle","styleAliases"],YAML_NODE_KINDS=["scalar","sequence","mapping"],_$type_34=function(t,e){var r,n;if(e=e||{},Object.keys(e).forEach(function(o){if(TYPE_CONSTRUCTOR_OPTIONS.indexOf(o)===-1)throw new _$exception_25('Unknown option "'+o+'" is met in definition of "'+t+'" YAML type.')}),this.tag=t,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(o){return o},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.defaultStyle=e.defaultStyle||null,this.styleAliases=(r=e.styleAliases||null,n={},r!==null&&Object.keys(r).forEach(function(o){r[o].forEach(function(f){n[String(f)]=o})}),n),YAML_NODE_KINDS.indexOf(this.kind)===-1)throw new _$exception_25('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')},_$schema_28={};function compileList(t,e,r){var n=[];return t.include.forEach(function(o){r=compileList(o,e,r)}),t[e].forEach(function(o){r.forEach(function(f,d){f.tag===o.tag&&f.kind===o.kind&&n.push(d)}),r.push(o)}),r.filter(function(o,f){return n.indexOf(f)===-1})}function Schema(t){this.include=t.include||[],this.implicit=t.implicit||[],this.explicit=t.explicit||[],this.implicit.forEach(function(e){if(e.loadKind&&e.loadKind!=="scalar")throw new _$exception_25("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.")}),this.compiledImplicit=compileList(this,"implicit",[]),this.compiledExplicit=compileList(this,"explicit",[]),this.compiledTypeMap=function(){var e,r,n={scalar:{},sequence:{},mapping:{},fallback:{}};function o(f){n[f.kind][f.tag]=n.fallback[f.tag]=f}for(e=0,r=arguments.length;e<r;e+=1)arguments[e].forEach(o);return n}(this.compiledImplicit,this.compiledExplicit)}Schema.DEFAULT=null,Schema.create=function(){var t,e;switch(arguments.length){case 1:t=Schema.DEFAULT,e=arguments[0];break;case 2:t=arguments[0],e=arguments[1];break;default:throw new _$exception_25("Wrong number of arguments for Schema.create function")}if(t=_$common_23.toArray(t),e=_$common_23.toArray(e),!t.every(function(r){return r instanceof Schema}))throw new _$exception_25("Specified list of super schemas (or a single Schema object) contains a non-Schema object.");if(!e.every(function(r){return r instanceof _$type_34}))throw new _$exception_25("Specified list of YAML types (or a single Type object) contains a non-Type object.");return new Schema({include:t,explicit:e})},_$schema_28=Schema;var _$str_49=new _$type_34("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return t!==null?t:""}}),_$seq_47=new _$type_34("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return t!==null?t:[]}}),_$map_42=new _$type_34("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return t!==null?t:{}}}),_$failsafe_32=new _$schema_28({explicit:[_$str_49,_$seq_47,_$map_42]}),_$null_44=new _$type_34("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(t){if(t===null)return!0;var e=t.length;return e===1&&t==="~"||e===4&&(t==="null"||t==="Null"||t==="NULL")},construct:function(){return null},predicate:function(t){return t===null},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"}},defaultStyle:"lowercase"}),_$bool_36=new _$type_34("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(t){if(t===null)return!1;var e=t.length;return e===4&&(t==="true"||t==="True"||t==="TRUE")||e===5&&(t==="false"||t==="False"||t==="FALSE")},construct:function(t){return t==="true"||t==="True"||t==="TRUE"},predicate:function(t){return Object.prototype.toString.call(t)==="[object Boolean]"},represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function isOctCode(t){return 48<=t&&t<=55}function isDecCode(t){return 48<=t&&t<=57}var _$int_38=new _$type_34("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(t){if(t===null)return!1;var e,r,n=t.length,o=0,f=!1;if(!n)return!1;if((e=t[o])!=="-"&&e!=="+"||(e=t[++o]),e==="0"){if(o+1===n)return!0;if((e=t[++o])==="b"){for(o++;o<n;o++)if((e=t[o])!=="_"){if(e!=="0"&&e!=="1")return!1;f=!0}return f&&e!=="_"}if(e==="x"){for(o++;o<n;o++)if((e=t[o])!=="_"){if(!(48<=(r=t.charCodeAt(o))&&r<=57||65<=r&&r<=70||97<=r&&r<=102))return!1;f=!0}return f&&e!=="_"}for(;o<n;o++)if((e=t[o])!=="_"){if(!isOctCode(t.charCodeAt(o)))return!1;f=!0}return f&&e!=="_"}if(e==="_")return!1;for(;o<n;o++)if((e=t[o])!=="_"){if(e===":")break;if(!isDecCode(t.charCodeAt(o)))return!1;f=!0}return!(!f||e==="_")&&(e!==":"||/^(:[0-5]?[0-9])+$/.test(t.slice(o)))},construct:function(t){var e,r,n=t,o=1,f=[];return n.indexOf("_")!==-1&&(n=n.replace(/_/g,"")),(e=n[0])!=="-"&&e!=="+"||(e==="-"&&(o=-1),e=(n=n.slice(1))[0]),n==="0"?0:e==="0"?n[1]==="b"?o*parseInt(n.slice(2),2):n[1]==="x"?o*parseInt(n,16):o*parseInt(n,8):n.indexOf(":")!==-1?(n.split(":").forEach(function(d){f.unshift(parseInt(d,10))}),n=0,r=1,f.forEach(function(d){n+=d*r,r*=60}),o*n):o*parseInt(n,10)},predicate:function(t){return Object.prototype.toString.call(t)==="[object Number]"&&t%1==0&&!_$common_23.isNegativeZero(t)},represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0"+t.toString(8):"-0"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),YAML_FLOAT_PATTERN=new RegExp("^(?:[-+]?(?:0|[1-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\.[0-9_]*|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),SCIENTIFIC_WITHOUT_DOT=/^[-+]?[0-9]+e/,_$float_37=new _$type_34("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(t){return t!==null&&!(!YAML_FLOAT_PATTERN.test(t)||t[t.length-1]==="_")},construct:function(t){var e,r,n,o;return r=(e=t.replace(/_/g,"").toLowerCase())[0]==="-"?-1:1,o=[],"+-".indexOf(e[0])>=0&&(e=e.slice(1)),e===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:e===".nan"?NaN:e.indexOf(":")>=0?(e.split(":").forEach(function(f){o.unshift(parseFloat(f,10))}),e=0,n=1,o.forEach(function(f){e+=f*n,n*=60}),r*e):r*parseFloat(e,10)},predicate:function(t){return Object.prototype.toString.call(t)==="[object Number]"&&(t%1!=0||_$common_23.isNegativeZero(t))},represent:function(t,e){var r;if(isNaN(t))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(_$common_23.isNegativeZero(t))return"-0.0";return r=t.toString(10),SCIENTIFIC_WITHOUT_DOT.test(r)?r.replace("e",".e"):r},defaultStyle:"lowercase"}),_$json_33=new _$schema_28({include:[_$failsafe_32],implicit:[_$null_44,_$bool_36,_$int_38,_$float_37]}),_$core_29=new _$schema_28({include:[_$json_33]}),YAML_DATE_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),YAML_TIMESTAMP_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),_$timestamp_50=new _$type_34("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(t){return t!==null&&(YAML_DATE_REGEXP.exec(t)!==null||YAML_TIMESTAMP_REGEXP.exec(t)!==null)},construct:function(t){var e,r,n,o,f,d,h,y,k=0,A=null;if((e=YAML_DATE_REGEXP.exec(t))===null&&(e=YAML_TIMESTAMP_REGEXP.exec(t)),e===null)throw new Error("Date resolve error");if(r=+e[1],n=+e[2]-1,o=+e[3],!e[4])return new Date(Date.UTC(r,n,o));if(f=+e[4],d=+e[5],h=+e[6],e[7]){for(k=e[7].slice(0,3);k.length<3;)k+="0";k=+k}return e[9]&&(A=6e4*(60*+e[10]+ +(e[11]||0)),e[9]==="-"&&(A=-A)),y=new Date(Date.UTC(r,n,o,f,d,h,k)),A&&y.setTime(y.getTime()-A),y},instanceOf:Date,represent:function(t){return t.toISOString()}}),_$merge_43=new _$type_34("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(t){return t==="<<"||t===null}}),NodeBuffer;try{var _require=require;NodeBuffer=_require("buffer").Buffer}catch(t){}var BASE64_MAP=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`,_$binary_35=new _$type_34("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(t){if(t===null)return!1;var e,r,n=0,o=t.length,f=BASE64_MAP;for(r=0;r<o;r++)if(!((e=f.indexOf(t.charAt(r)))>64)){if(e<0)return!1;n+=6}return n%8==0},construct:function(t){var e,r,n=t.replace(/[\r\n=]/g,""),o=n.length,f=BASE64_MAP,d=0,h=[];for(e=0;e<o;e++)e%4==0&&e&&(h.push(d>>16&255),h.push(d>>8&255),h.push(255&d)),d=d<<6|f.indexOf(n.charAt(e));return(r=o%4*6)==0?(h.push(d>>16&255),h.push(d>>8&255),h.push(255&d)):r===18?(h.push(d>>10&255),h.push(d>>2&255)):r===12&&h.push(d>>4&255),NodeBuffer?NodeBuffer.from?NodeBuffer.from(h):new NodeBuffer(h):h},predicate:function(t){return NodeBuffer&&NodeBuffer.isBuffer(t)},represent:function(t){var e,r,n="",o=0,f=t.length,d=BASE64_MAP;for(e=0;e<f;e++)e%3==0&&e&&(n+=d[o>>18&63],n+=d[o>>12&63],n+=d[o>>6&63],n+=d[63&o]),o=(o<<8)+t[e];return(r=f%3)==0?(n+=d[o>>18&63],n+=d[o>>12&63],n+=d[o>>6&63],n+=d[63&o]):r===2?(n+=d[o>>10&63],n+=d[o>>4&63],n+=d[o<<2&63],n+=d[64]):r===1&&(n+=d[o>>2&63],n+=d[o<<4&63],n+=d[64],n+=d[64]),n}}),_hasOwnProperty=Object.prototype.hasOwnProperty,_toString=Object.prototype.toString,_$omap_45=new _$type_34("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(t){if(t===null)return!0;var e,r,n,o,f,d=[],h=t;for(e=0,r=h.length;e<r;e+=1){if(n=h[e],f=!1,_toString.call(n)!=="[object Object]")return!1;for(o in n)if(_hasOwnProperty.call(n,o)){if(f)return!1;f=!0}if(!f||d.indexOf(o)!==-1)return!1;d.push(o)}return!0},construct:function(t){return t!==null?t:[]}}),___toString_46=Object.prototype.toString,_$pairs_46=new _$type_34("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(t){if(t===null)return!0;var e,r,n,o,f,d=t;for(f=new Array(d.length),e=0,r=d.length;e<r;e+=1){if(n=d[e],___toString_46.call(n)!=="[object Object]"||(o=Object.keys(n)).length!==1)return!1;f[e]=[o[0],n[o[0]]]}return!0},construct:function(t){if(t===null)return[];var e,r,n,o,f,d=t;for(f=new Array(d.length),e=0,r=d.length;e<r;e+=1)n=d[e],o=Object.keys(n),f[e]=[o[0],n[o[0]]];return f}}),___hasOwnProperty_48=Object.prototype.hasOwnProperty,_$set_48=new _$type_34("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(t){if(t===null)return!0;var e,r=t;for(e in r)if(___hasOwnProperty_48.call(r,e)&&r[e]!==null)return!1;return!0},construct:function(t){return t!==null?t:{}}}),_$default_safe_31=new _$schema_28({include:[_$core_29],implicit:[_$timestamp_50,_$merge_43],explicit:[_$binary_35,_$omap_45,_$pairs_46,_$set_48]}),_$undefined_41=new _$type_34("tag:yaml.org,2002:js/undefined",{kind:"scalar",resolve:function(){return!0},construct:function(){},predicate:function(t){return t===void 0},represent:function(){return""}}),_$regexp_40=new _$type_34("tag:yaml.org,2002:js/regexp",{kind:"scalar",resolve:function(t){if(t===null||t.length===0)return!1;var e=t,r=/\/([gim]*)$/.exec(t),n="";return!(e[0]==="/"&&(r&&(n=r[1]),n.length>3||e[e.length-n.length-1]!=="/"))},construct:function(t){var e=t,r=/\/([gim]*)$/.exec(t),n="";return e[0]==="/"&&(r&&(n=r[1]),e=e.slice(1,e.length-n.length-1)),new RegExp(e,n)},predicate:function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},represent:function(t){var e="/"+t.source+"/";return t.global&&(e+="g"),t.multiline&&(e+="m"),t.ignoreCase&&(e+="i"),e}}),esprima;try{var ___require_39=require;esprima=___require_39("esprima")}catch(t){typeof window<"u"&&(esprima=window.esprima)}var _$function_39=new _$type_34("tag:yaml.org,2002:js/function",{kind:"scalar",resolve:function(t){if(t===null)return!1;try{var e="("+t+")",r=esprima.parse(e,{range:!0});return r.type==="Program"&&r.body.length===1&&r.body[0].type==="ExpressionStatement"&&(r.body[0].expression.type==="ArrowFunctionExpression"||r.body[0].expression.type==="FunctionExpression")}catch{return!1}},construct:function(t){var e,r="("+t+")",n=esprima.parse(r,{range:!0}),o=[];if(n.type!=="Program"||n.body.length!==1||n.body[0].type!=="ExpressionStatement"||n.body[0].expression.type!=="ArrowFunctionExpression"&&n.body[0].expression.type!=="FunctionExpression")throw new Error("Failed to resolve function");return n.body[0].expression.params.forEach(function(f){o.push(f.name)}),e=n.body[0].expression.body.range,n.body[0].expression.body.type==="BlockStatement"?new Function(o,r.slice(e[0]+1,e[1]-1)):new Function(o,"return "+r.slice(e[0],e[1]))},predicate:function(t){return Object.prototype.toString.call(t)==="[object Function]"},represent:function(t){return t.toString()}}),_$default_full_30=_$schema_28.DEFAULT=new _$schema_28({include:[_$default_safe_31],explicit:[_$undefined_41,_$regexp_40,_$function_39]}),_$loader_26={},___hasOwnProperty_26=Object.prototype.hasOwnProperty,CONTEXT_FLOW_IN=1,CONTEXT_FLOW_OUT=2,CONTEXT_BLOCK_IN=3,CONTEXT_BLOCK_OUT=4,CHOMPING_CLIP=1,CHOMPING_STRIP=2,CHOMPING_KEEP=3,PATTERN_NON_PRINTABLE=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,PATTERN_NON_ASCII_LINE_BREAKS=/[\x85\u2028\u2029]/,PATTERN_FLOW_INDICATORS=/[,\[\]\{\}]/,PATTERN_TAG_HANDLE=/^(?:!|!!|![a-z\-]+!)$/i,PATTERN_TAG_URI=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function _class(t){return Object.prototype.toString.call(t)}function is_EOL(t){return t===10||t===13}function is_WHITE_SPACE(t){return t===9||t===32}function is_WS_OR_EOL(t){return t===9||t===32||t===10||t===13}function is_FLOW_INDICATOR(t){return t===44||t===91||t===93||t===123||t===125}function fromHexCode(t){var e;return 48<=t&&t<=57?t-48:97<=(e=32|t)&&e<=102?e-97+10:-1}function simpleEscapeSequence(t){return t===48?"\0":t===97?"\x07":t===98?"\b":t===116||t===9?"	":t===110?`
`:t===118?"\v":t===102?"\f":t===114?"\r":t===101?"\x1B":t===32?" ":t===34?'"':t===47?"/":t===92?"\\":t===78?"\x85":t===95?"\xA0":t===76?"\u2028":t===80?"\u2029":""}function charFromCodepoint(t){return t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}for(var simpleEscapeCheck=new Array(256),simpleEscapeMap=new Array(256),__i_26=0;__i_26<256;__i_26++)simpleEscapeCheck[__i_26]=simpleEscapeSequence(__i_26)?1:0,simpleEscapeMap[__i_26]=simpleEscapeSequence(__i_26);function State(t,e){this.input=t,this.filename=e.filename||null,this.schema=e.schema||_$default_full_30,this.onWarning=e.onWarning||null,this.legacy=e.legacy||!1,this.json=e.json||!1,this.listener=e.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.documents=[]}function generateError(t,e){return new _$exception_25(e,new _$mark_27(t.filename,t.input,t.position,t.line,t.position-t.lineStart))}function throwError(t,e){throw generateError(t,e)}function throwWarning(t,e){t.onWarning&&t.onWarning.call(null,generateError(t,e))}var directiveHandlers={YAML:function(t,e,r){var n,o,f;t.version!==null&&throwError(t,"duplication of %YAML directive"),r.length!==1&&throwError(t,"YAML directive accepts exactly one argument"),(n=/^([0-9]+)\.([0-9]+)$/.exec(r[0]))===null&&throwError(t,"ill-formed argument of the YAML directive"),o=parseInt(n[1],10),f=parseInt(n[2],10),o!==1&&throwError(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=f<2,f!==1&&f!==2&&throwWarning(t,"unsupported YAML version of the document")},TAG:function(t,e,r){var n,o;r.length!==2&&throwError(t,"TAG directive accepts exactly two arguments"),n=r[0],o=r[1],PATTERN_TAG_HANDLE.test(n)||throwError(t,"ill-formed tag handle (first argument) of the TAG directive"),___hasOwnProperty_26.call(t.tagMap,n)&&throwError(t,'there is a previously declared suffix for "'+n+'" tag handle'),PATTERN_TAG_URI.test(o)||throwError(t,"ill-formed tag prefix (second argument) of the TAG directive"),t.tagMap[n]=o}};function captureSegment(t,e,r,n){var o,f,d,h;if(e<r){if(h=t.input.slice(e,r),n)for(o=0,f=h.length;o<f;o+=1)(d=h.charCodeAt(o))===9||32<=d&&d<=1114111||throwError(t,"expected valid JSON character");else PATTERN_NON_PRINTABLE.test(h)&&throwError(t,"the stream contains non-printable characters");t.result+=h}}function mergeMappings(t,e,r,n){var o,f,d,h;for(_$common_23.isObject(r)||throwError(t,"cannot merge mappings; the provided source object is unacceptable"),d=0,h=(o=Object.keys(r)).length;d<h;d+=1)f=o[d],___hasOwnProperty_26.call(e,f)||(e[f]=r[f],n[f]=!0)}function storeMappingPair(t,e,r,n,o,f,d,h){var y,k;if(Array.isArray(o))for(y=0,k=(o=Array.prototype.slice.call(o)).length;y<k;y+=1)Array.isArray(o[y])&&throwError(t,"nested arrays are not supported inside keys"),typeof o=="object"&&_class(o[y])==="[object Object]"&&(o[y]="[object Object]");if(typeof o=="object"&&_class(o)==="[object Object]"&&(o="[object Object]"),o=String(o),e===null&&(e={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(f))for(y=0,k=f.length;y<k;y+=1)mergeMappings(t,e,f[y],r);else mergeMappings(t,e,f,r);else t.json||___hasOwnProperty_26.call(r,o)||!___hasOwnProperty_26.call(e,o)||(t.line=d||t.line,t.position=h||t.position,throwError(t,"duplicated mapping key")),e[o]=f,delete r[o];return e}function readLineBreak(t){var e;(e=t.input.charCodeAt(t.position))===10?t.position++:e===13?(t.position++,t.input.charCodeAt(t.position)===10&&t.position++):throwError(t,"a line break is expected"),t.line+=1,t.lineStart=t.position}function skipSeparationSpace(t,e,r){for(var n=0,o=t.input.charCodeAt(t.position);o!==0;){for(;is_WHITE_SPACE(o);)o=t.input.charCodeAt(++t.position);if(e&&o===35)do o=t.input.charCodeAt(++t.position);while(o!==10&&o!==13&&o!==0);if(!is_EOL(o))break;for(readLineBreak(t),o=t.input.charCodeAt(t.position),n++,t.lineIndent=0;o===32;)t.lineIndent++,o=t.input.charCodeAt(++t.position)}return r!==-1&&n!==0&&t.lineIndent<r&&throwWarning(t,"deficient indentation"),n}function testDocumentSeparator(t){var e,r=t.position;return!((e=t.input.charCodeAt(r))!==45&&e!==46||e!==t.input.charCodeAt(r+1)||e!==t.input.charCodeAt(r+2)||(r+=3,(e=t.input.charCodeAt(r))!==0&&!is_WS_OR_EOL(e)))}function writeFoldedLines(t,e){e===1?t.result+=" ":e>1&&(t.result+=_$common_23.repeat(`
`,e-1))}function readBlockSequence(t,e){var r,n,o=t.tag,f=t.anchor,d=[],h=!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=d),n=t.input.charCodeAt(t.position);n!==0&&n===45&&is_WS_OR_EOL(t.input.charCodeAt(t.position+1));)if(h=!0,t.position++,skipSeparationSpace(t,!0,-1)&&t.lineIndent<=e)d.push(null),n=t.input.charCodeAt(t.position);else if(r=t.line,composeNode(t,e,CONTEXT_BLOCK_IN,!1,!0),d.push(t.result),skipSeparationSpace(t,!0,-1),n=t.input.charCodeAt(t.position),(t.line===r||t.lineIndent>e)&&n!==0)throwError(t,"bad indentation of a sequence entry");else if(t.lineIndent<e)break;return!!h&&(t.tag=o,t.anchor=f,t.kind="sequence",t.result=d,!0)}function readTagProperty(t){var e,r,n,o,f=!1,d=!1;if((o=t.input.charCodeAt(t.position))!==33)return!1;if(t.tag!==null&&throwError(t,"duplication of a tag property"),(o=t.input.charCodeAt(++t.position))===60?(f=!0,o=t.input.charCodeAt(++t.position)):o===33?(d=!0,r="!!",o=t.input.charCodeAt(++t.position)):r="!",e=t.position,f){do o=t.input.charCodeAt(++t.position);while(o!==0&&o!==62);t.position<t.length?(n=t.input.slice(e,t.position),o=t.input.charCodeAt(++t.position)):throwError(t,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!is_WS_OR_EOL(o);)o===33&&(d?throwError(t,"tag suffix cannot contain exclamation marks"):(r=t.input.slice(e-1,t.position+1),PATTERN_TAG_HANDLE.test(r)||throwError(t,"named tag handle cannot contain such characters"),d=!0,e=t.position+1)),o=t.input.charCodeAt(++t.position);n=t.input.slice(e,t.position),PATTERN_FLOW_INDICATORS.test(n)&&throwError(t,"tag suffix cannot contain flow indicator characters")}return n&&!PATTERN_TAG_URI.test(n)&&throwError(t,"tag name cannot contain such characters: "+n),f?t.tag=n:___hasOwnProperty_26.call(t.tagMap,r)?t.tag=t.tagMap[r]+n:r==="!"?t.tag="!"+n:r==="!!"?t.tag="tag:yaml.org,2002:"+n:throwError(t,'undeclared tag handle "'+r+'"'),!0}function readAnchorProperty(t){var e,r;if((r=t.input.charCodeAt(t.position))!==38)return!1;for(t.anchor!==null&&throwError(t,"duplication of an anchor property"),r=t.input.charCodeAt(++t.position),e=t.position;r!==0&&!is_WS_OR_EOL(r)&&!is_FLOW_INDICATOR(r);)r=t.input.charCodeAt(++t.position);return t.position===e&&throwError(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(e,t.position),!0}function composeNode(t,e,r,n,o){var f,d,h,y,k,A,D,q,H=1,z=!1,Z=!1;if(t.listener!==null&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,f=d=h=CONTEXT_BLOCK_OUT===r||CONTEXT_BLOCK_IN===r,n&&skipSeparationSpace(t,!0,-1)&&(z=!0,t.lineIndent>e?H=1:t.lineIndent===e?H=0:t.lineIndent<e&&(H=-1)),H===1)for(;readTagProperty(t)||readAnchorProperty(t);)skipSeparationSpace(t,!0,-1)?(z=!0,h=f,t.lineIndent>e?H=1:t.lineIndent===e?H=0:t.lineIndent<e&&(H=-1)):h=!1;if(h&&(h=z||o),H!==1&&CONTEXT_BLOCK_OUT!==r||(D=CONTEXT_FLOW_IN===r||CONTEXT_FLOW_OUT===r?e:e+1,q=t.position-t.lineStart,H===1?h&&(readBlockSequence(t,q)||function(j,at,ct){var ot,tt,gt,wt,ft,yt=j.tag,Ct=j.anchor,l={},s={},b=null,$=null,E=null,rt=!1,_t=!1;for(j.anchor!==null&&(j.anchorMap[j.anchor]=l),ft=j.input.charCodeAt(j.position);ft!==0;){if(ot=j.input.charCodeAt(j.position+1),gt=j.line,wt=j.position,ft!==63&&ft!==58||!is_WS_OR_EOL(ot)){if(!composeNode(j,ct,CONTEXT_FLOW_OUT,!1,!0))break;if(j.line===gt){for(ft=j.input.charCodeAt(j.position);is_WHITE_SPACE(ft);)ft=j.input.charCodeAt(++j.position);if(ft===58)is_WS_OR_EOL(ft=j.input.charCodeAt(++j.position))||throwError(j,"a whitespace character is expected after the key-value separator within a block mapping"),rt&&(storeMappingPair(j,l,s,b,$,null),b=$=E=null),_t=!0,rt=!1,tt=!1,b=j.tag,$=j.result;else{if(!_t)return j.tag=yt,j.anchor=Ct,!0;throwError(j,"can not read an implicit mapping pair; a colon is missed")}}else{if(!_t)return j.tag=yt,j.anchor=Ct,!0;throwError(j,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else ft===63?(rt&&(storeMappingPair(j,l,s,b,$,null),b=$=E=null),_t=!0,rt=!0,tt=!0):rt?(rt=!1,tt=!0):throwError(j,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),j.position+=1,ft=ot;if((j.line===gt||j.lineIndent>at)&&(composeNode(j,at,CONTEXT_BLOCK_OUT,!0,tt)&&(rt?$=j.result:E=j.result),rt||(storeMappingPair(j,l,s,b,$,E,gt,wt),b=$=E=null),skipSeparationSpace(j,!0,-1),ft=j.input.charCodeAt(j.position)),j.lineIndent>at&&ft!==0)throwError(j,"bad indentation of a mapping entry");else if(j.lineIndent<at)break}return rt&&storeMappingPair(j,l,s,b,$,null),_t&&(j.tag=yt,j.anchor=Ct,j.kind="mapping",j.result=l),_t}(t,q,D))||function(j,at){var ct,ot,tt,gt,wt,ft,yt,Ct,l,s,b=!0,$=j.tag,E=j.anchor,rt={};if((s=j.input.charCodeAt(j.position))===91)tt=93,ft=!1,ot=[];else{if(s!==123)return!1;tt=125,ft=!0,ot={}}for(j.anchor!==null&&(j.anchorMap[j.anchor]=ot),s=j.input.charCodeAt(++j.position);s!==0;){if(skipSeparationSpace(j,!0,at),(s=j.input.charCodeAt(j.position))===tt)return j.position++,j.tag=$,j.anchor=E,j.kind=ft?"mapping":"sequence",j.result=ot,!0;b||throwError(j,"missed comma between flow collection entries"),l=null,gt=wt=!1,s===63&&is_WS_OR_EOL(j.input.charCodeAt(j.position+1))&&(gt=wt=!0,j.position++,skipSeparationSpace(j,!0,at)),ct=j.line,composeNode(j,at,CONTEXT_FLOW_IN,!1,!0),Ct=j.tag,yt=j.result,skipSeparationSpace(j,!0,at),s=j.input.charCodeAt(j.position),!wt&&j.line!==ct||s!==58||(gt=!0,s=j.input.charCodeAt(++j.position),skipSeparationSpace(j,!0,at),composeNode(j,at,CONTEXT_FLOW_IN,!1,!0),l=j.result),ft?storeMappingPair(j,ot,rt,Ct,yt,l):gt?ot.push(storeMappingPair(j,null,rt,Ct,yt,l)):ot.push(yt),skipSeparationSpace(j,!0,at),(s=j.input.charCodeAt(j.position))===44?(b=!0,s=j.input.charCodeAt(++j.position)):b=!1}throwError(j,"unexpected end of the stream within a flow collection")}(t,D)?Z=!0:(d&&function(j,at){var ct,ot,tt,gt,wt,ft=CHOMPING_CLIP,yt=!1,Ct=!1,l=at,s=0,b=!1;if((gt=j.input.charCodeAt(j.position))===124)ot=!1;else{if(gt!==62)return!1;ot=!0}for(j.kind="scalar",j.result="";gt!==0;)if((gt=j.input.charCodeAt(++j.position))===43||gt===45)CHOMPING_CLIP===ft?ft=gt===43?CHOMPING_KEEP:CHOMPING_STRIP:throwError(j,"repeat of a chomping mode identifier");else{if(!((tt=48<=(wt=gt)&&wt<=57?wt-48:-1)>=0))break;tt===0?throwError(j,"bad explicit indentation width of a block scalar; it cannot be less than one"):Ct?throwError(j,"repeat of an indentation width identifier"):(l=at+tt-1,Ct=!0)}if(is_WHITE_SPACE(gt)){do gt=j.input.charCodeAt(++j.position);while(is_WHITE_SPACE(gt));if(gt===35)do gt=j.input.charCodeAt(++j.position);while(!is_EOL(gt)&&gt!==0)}for(;gt!==0;){for(readLineBreak(j),j.lineIndent=0,gt=j.input.charCodeAt(j.position);(!Ct||j.lineIndent<l)&&gt===32;)j.lineIndent++,gt=j.input.charCodeAt(++j.position);if(!Ct&&j.lineIndent>l&&(l=j.lineIndent),is_EOL(gt))s++;else{if(j.lineIndent<l){ft===CHOMPING_KEEP?j.result+=_$common_23.repeat(`
`,yt?1+s:s):ft===CHOMPING_CLIP&&yt&&(j.result+=`
`);break}for(ot?is_WHITE_SPACE(gt)?(b=!0,j.result+=_$common_23.repeat(`
`,yt?1+s:s)):b?(b=!1,j.result+=_$common_23.repeat(`
`,s+1)):s===0?yt&&(j.result+=" "):j.result+=_$common_23.repeat(`
`,s):j.result+=_$common_23.repeat(`
`,yt?1+s:s),yt=!0,Ct=!0,s=0,ct=j.position;!is_EOL(gt)&&gt!==0;)gt=j.input.charCodeAt(++j.position);captureSegment(j,ct,j.position,!1)}}return!0}(t,D)||function(j,at){var ct,ot,tt;if((ct=j.input.charCodeAt(j.position))!==39)return!1;for(j.kind="scalar",j.result="",j.position++,ot=tt=j.position;(ct=j.input.charCodeAt(j.position))!==0;)if(ct===39){if(captureSegment(j,ot,j.position,!0),(ct=j.input.charCodeAt(++j.position))!==39)return!0;ot=j.position,j.position++,tt=j.position}else is_EOL(ct)?(captureSegment(j,ot,tt,!0),writeFoldedLines(j,skipSeparationSpace(j,!1,at)),ot=tt=j.position):j.position===j.lineStart&&testDocumentSeparator(j)?throwError(j,"unexpected end of the document within a single quoted scalar"):(j.position++,tt=j.position);throwError(j,"unexpected end of the stream within a single quoted scalar")}(t,D)||function(j,at){var ct,ot,tt,gt,wt,ft,yt;if((ft=j.input.charCodeAt(j.position))!==34)return!1;for(j.kind="scalar",j.result="",j.position++,ct=ot=j.position;(ft=j.input.charCodeAt(j.position))!==0;){if(ft===34)return captureSegment(j,ct,j.position,!0),j.position++,!0;if(ft===92){if(captureSegment(j,ct,j.position,!0),is_EOL(ft=j.input.charCodeAt(++j.position)))skipSeparationSpace(j,!1,at);else if(ft<256&&simpleEscapeCheck[ft])j.result+=simpleEscapeMap[ft],j.position++;else if((wt=(yt=ft)===120?2:yt===117?4:yt===85?8:0)>0){for(tt=wt,gt=0;tt>0;tt--)(wt=fromHexCode(ft=j.input.charCodeAt(++j.position)))>=0?gt=(gt<<4)+wt:throwError(j,"expected hexadecimal character");j.result+=charFromCodepoint(gt),j.position++}else throwError(j,"unknown escape sequence");ct=ot=j.position}else is_EOL(ft)?(captureSegment(j,ct,ot,!0),writeFoldedLines(j,skipSeparationSpace(j,!1,at)),ct=ot=j.position):j.position===j.lineStart&&testDocumentSeparator(j)?throwError(j,"unexpected end of the document within a double quoted scalar"):(j.position++,ot=j.position)}throwError(j,"unexpected end of the stream within a double quoted scalar")}(t,D)?Z=!0:function(j){var at,ct,ot;if((ot=j.input.charCodeAt(j.position))!==42)return!1;for(ot=j.input.charCodeAt(++j.position),at=j.position;ot!==0&&!is_WS_OR_EOL(ot)&&!is_FLOW_INDICATOR(ot);)ot=j.input.charCodeAt(++j.position);return j.position===at&&throwError(j,"name of an alias node must contain at least one character"),ct=j.input.slice(at,j.position),___hasOwnProperty_26.call(j.anchorMap,ct)||throwError(j,'unidentified alias "'+ct+'"'),j.result=j.anchorMap[ct],skipSeparationSpace(j,!0,-1),!0}(t)?(Z=!0,t.tag===null&&t.anchor===null||throwError(t,"alias node should not have any properties")):function(j,at,ct){var ot,tt,gt,wt,ft,yt,Ct,l,s=j.kind,b=j.result;if(is_WS_OR_EOL(l=j.input.charCodeAt(j.position))||is_FLOW_INDICATOR(l)||l===35||l===38||l===42||l===33||l===124||l===62||l===39||l===34||l===37||l===64||l===96||(l===63||l===45)&&(is_WS_OR_EOL(ot=j.input.charCodeAt(j.position+1))||ct&&is_FLOW_INDICATOR(ot)))return!1;for(j.kind="scalar",j.result="",tt=gt=j.position,wt=!1;l!==0;){if(l===58){if(is_WS_OR_EOL(ot=j.input.charCodeAt(j.position+1))||ct&&is_FLOW_INDICATOR(ot))break}else if(l===35){if(is_WS_OR_EOL(j.input.charCodeAt(j.position-1)))break}else{if(j.position===j.lineStart&&testDocumentSeparator(j)||ct&&is_FLOW_INDICATOR(l))break;if(is_EOL(l)){if(ft=j.line,yt=j.lineStart,Ct=j.lineIndent,skipSeparationSpace(j,!1,-1),j.lineIndent>=at){wt=!0,l=j.input.charCodeAt(j.position);continue}j.position=gt,j.line=ft,j.lineStart=yt,j.lineIndent=Ct;break}}wt&&(captureSegment(j,tt,gt,!1),writeFoldedLines(j,j.line-ft),tt=gt=j.position,wt=!1),is_WHITE_SPACE(l)||(gt=j.position+1),l=j.input.charCodeAt(++j.position)}return captureSegment(j,tt,gt,!1),!!j.result||(j.kind=s,j.result=b,!1)}(t,D,CONTEXT_FLOW_IN===r)&&(Z=!0,t.tag===null&&(t.tag="?")),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):H===0&&(Z=h&&readBlockSequence(t,q))),t.tag!==null&&t.tag!=="!")if(t.tag==="?"){for(t.result!==null&&t.kind!=="scalar"&&throwError(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),y=0,k=t.implicitTypes.length;y<k;y+=1)if((A=t.implicitTypes[y]).resolve(t.result)){t.result=A.construct(t.result),t.tag=A.tag,t.anchor!==null&&(t.anchorMap[t.anchor]=t.result);break}}else ___hasOwnProperty_26.call(t.typeMap[t.kind||"fallback"],t.tag)?(A=t.typeMap[t.kind||"fallback"][t.tag],t.result!==null&&A.kind!==t.kind&&throwError(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+A.kind+'", not "'+t.kind+'"'),A.resolve(t.result)?(t.result=A.construct(t.result),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):throwError(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")):throwError(t,"unknown tag !<"+t.tag+">");return t.listener!==null&&t.listener("close",t),t.tag!==null||t.anchor!==null||Z}function readDocument(t){var e,r,n,o,f=t.position,d=!1;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap={},t.anchorMap={};(o=t.input.charCodeAt(t.position))!==0&&(skipSeparationSpace(t,!0,-1),o=t.input.charCodeAt(t.position),!(t.lineIndent>0||o!==37));){for(d=!0,o=t.input.charCodeAt(++t.position),e=t.position;o!==0&&!is_WS_OR_EOL(o);)o=t.input.charCodeAt(++t.position);for(n=[],(r=t.input.slice(e,t.position)).length<1&&throwError(t,"directive name must not be less than one character in length");o!==0;){for(;is_WHITE_SPACE(o);)o=t.input.charCodeAt(++t.position);if(o===35){do o=t.input.charCodeAt(++t.position);while(o!==0&&!is_EOL(o));break}if(is_EOL(o))break;for(e=t.position;o!==0&&!is_WS_OR_EOL(o);)o=t.input.charCodeAt(++t.position);n.push(t.input.slice(e,t.position))}o!==0&&readLineBreak(t),___hasOwnProperty_26.call(directiveHandlers,r)?directiveHandlers[r](t,r,n):throwWarning(t,'unknown document directive "'+r+'"')}skipSeparationSpace(t,!0,-1),t.lineIndent===0&&t.input.charCodeAt(t.position)===45&&t.input.charCodeAt(t.position+1)===45&&t.input.charCodeAt(t.position+2)===45?(t.position+=3,skipSeparationSpace(t,!0,-1)):d&&throwError(t,"directives end mark is expected"),composeNode(t,t.lineIndent-1,CONTEXT_BLOCK_OUT,!1,!0),skipSeparationSpace(t,!0,-1),t.checkLineBreaks&&PATTERN_NON_ASCII_LINE_BREAKS.test(t.input.slice(f,t.position))&&throwWarning(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&testDocumentSeparator(t)?t.input.charCodeAt(t.position)===46&&(t.position+=3,skipSeparationSpace(t,!0,-1)):t.position<t.length-1&&throwError(t,"end of the stream or a document separator is expected")}function loadDocuments(t,e){e=e||{},(t=String(t)).length!==0&&(t.charCodeAt(t.length-1)!==10&&t.charCodeAt(t.length-1)!==13&&(t+=`
`),t.charCodeAt(0)===65279&&(t=t.slice(1)));var r=new State(t,e),n=t.indexOf("\0");for(n!==-1&&(r.position=n,throwError(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)readDocument(r);return r.documents}function loadAll(t,e,r){e!==null&&typeof e=="object"&&r===void 0&&(r=e,e=null);var n=loadDocuments(t,r);if(typeof e!="function")return n;for(var o=0,f=n.length;o<f;o+=1)e(n[o])}function load(t,e){var r=loadDocuments(t,e);if(r.length!==0){if(r.length===1)return r[0];throw new _$exception_25("expected a single document in the stream, but found more")}}_$loader_26.loadAll=loadAll,_$loader_26.load=load,_$loader_26.safeLoadAll=function(t,e,r){return typeof e=="object"&&e!==null&&r===void 0&&(r=e,e=null),loadAll(t,e,_$common_23.extend({schema:_$default_safe_31},r))},_$loader_26.safeLoad=function(t,e){return load(t,_$common_23.extend({schema:_$default_safe_31},e))};var _$dumper_24={},___toString_24=Object.prototype.toString,___hasOwnProperty_24=Object.prototype.hasOwnProperty,CHAR_TAB=9,CHAR_LINE_FEED=10,CHAR_CARRIAGE_RETURN=13,CHAR_SPACE=32,CHAR_EXCLAMATION=33,CHAR_DOUBLE_QUOTE=34,CHAR_SHARP=35,CHAR_PERCENT=37,CHAR_AMPERSAND=38,CHAR_SINGLE_QUOTE=39,CHAR_ASTERISK=42,CHAR_COMMA=44,CHAR_MINUS=45,CHAR_COLON=58,CHAR_EQUALS=61,CHAR_GREATER_THAN=62,CHAR_QUESTION=63,CHAR_COMMERCIAL_AT=64,CHAR_LEFT_SQUARE_BRACKET=91,CHAR_RIGHT_SQUARE_BRACKET=93,CHAR_GRAVE_ACCENT=96,CHAR_LEFT_CURLY_BRACKET=123,CHAR_VERTICAL_LINE=124,CHAR_RIGHT_CURLY_BRACKET=125,ESCAPE_SEQUENCES={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},DEPRECATED_BOOLEANS_SYNTAX=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"];function encodeHex(t){var e,r,n;if(e=t.toString(16).toUpperCase(),t<=255)r="x",n=2;else if(t<=65535)r="u",n=4;else{if(!(t<=4294967295))throw new _$exception_25("code point within a string may not be greater than 0xFFFFFFFF");r="U",n=8}return"\\"+r+_$common_23.repeat("0",n-e.length)+e}function __State_24(t){this.schema=t.schema||_$default_full_30,this.indent=Math.max(1,t.indent||2),this.noArrayIndent=t.noArrayIndent||!1,this.skipInvalid=t.skipInvalid||!1,this.flowLevel=_$common_23.isNothing(t.flowLevel)?-1:t.flowLevel,this.styleMap=function(e,r){var n,o,f,d,h,y,k;if(r===null)return{};for(n={},f=0,d=(o=Object.keys(r)).length;f<d;f+=1)h=o[f],y=String(r[h]),h.slice(0,2)==="!!"&&(h="tag:yaml.org,2002:"+h.slice(2)),(k=e.compiledTypeMap.fallback[h])&&___hasOwnProperty_24.call(k.styleAliases,y)&&(y=k.styleAliases[y]),n[h]=y;return n}(this.schema,t.styles||null),this.sortKeys=t.sortKeys||!1,this.lineWidth=t.lineWidth||80,this.noRefs=t.noRefs||!1,this.noCompatMode=t.noCompatMode||!1,this.condenseFlow=t.condenseFlow||!1,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function indentString(t,e){for(var r,n=_$common_23.repeat(" ",e),o=0,f=-1,d="",h=t.length;o<h;)(f=t.indexOf(`
`,o))===-1?(r=t.slice(o),o=h):(r=t.slice(o,f+1),o=f+1),r.length&&r!==`
`&&(d+=n),d+=r;return d}function generateNextLine(t,e){return`
`+_$common_23.repeat(" ",t.indent*e)}function isWhitespace(t){return t===CHAR_SPACE||t===CHAR_TAB}function isPrintable(t){return 32<=t&&t<=126||161<=t&&t<=55295&&t!==8232&&t!==8233||57344<=t&&t<=65533&&t!==65279||65536<=t&&t<=1114111}function isPlainSafe(t,e){return isPrintable(t)&&t!==65279&&t!==CHAR_COMMA&&t!==CHAR_LEFT_SQUARE_BRACKET&&t!==CHAR_RIGHT_SQUARE_BRACKET&&t!==CHAR_LEFT_CURLY_BRACKET&&t!==CHAR_RIGHT_CURLY_BRACKET&&t!==CHAR_COLON&&(t!==CHAR_SHARP||e&&function(r){return isPrintable(r)&&!isWhitespace(r)&&r!==65279&&r!==CHAR_CARRIAGE_RETURN&&r!==CHAR_LINE_FEED}(e))}function needIndentIndicator(t){return/^\n* /.test(t)}var STYLE_PLAIN=1,STYLE_SINGLE=2,STYLE_LITERAL=3,STYLE_FOLDED=4,STYLE_DOUBLE=5;function chooseScalarStyle(t,e,r,n,o){var f,d,h,y,k=!1,A=!1,D=n!==-1,q=-1,H=isPrintable(y=t.charCodeAt(0))&&y!==65279&&!isWhitespace(y)&&y!==CHAR_MINUS&&y!==CHAR_QUESTION&&y!==CHAR_COLON&&y!==CHAR_COMMA&&y!==CHAR_LEFT_SQUARE_BRACKET&&y!==CHAR_RIGHT_SQUARE_BRACKET&&y!==CHAR_LEFT_CURLY_BRACKET&&y!==CHAR_RIGHT_CURLY_BRACKET&&y!==CHAR_SHARP&&y!==CHAR_AMPERSAND&&y!==CHAR_ASTERISK&&y!==CHAR_EXCLAMATION&&y!==CHAR_VERTICAL_LINE&&y!==CHAR_EQUALS&&y!==CHAR_GREATER_THAN&&y!==CHAR_SINGLE_QUOTE&&y!==CHAR_DOUBLE_QUOTE&&y!==CHAR_PERCENT&&y!==CHAR_COMMERCIAL_AT&&y!==CHAR_GRAVE_ACCENT&&!isWhitespace(t.charCodeAt(t.length-1));if(e)for(f=0;f<t.length;f++){if(!isPrintable(d=t.charCodeAt(f)))return STYLE_DOUBLE;h=f>0?t.charCodeAt(f-1):null,H=H&&isPlainSafe(d,h)}else{for(f=0;f<t.length;f++){if((d=t.charCodeAt(f))===CHAR_LINE_FEED)k=!0,D&&(A=A||f-q-1>n&&t[q+1]!==" ",q=f);else if(!isPrintable(d))return STYLE_DOUBLE;h=f>0?t.charCodeAt(f-1):null,H=H&&isPlainSafe(d,h)}A=A||D&&f-q-1>n&&t[q+1]!==" "}return k||A?r>9&&needIndentIndicator(t)?STYLE_DOUBLE:A?STYLE_FOLDED:STYLE_LITERAL:H&&!o(t)?STYLE_PLAIN:STYLE_SINGLE}function writeScalar(t,e,r,n){t.dump=function(){if(e.length===0)return"''";if(!t.noCompatMode&&DEPRECATED_BOOLEANS_SYNTAX.indexOf(e)!==-1)return"'"+e+"'";var o=t.indent*Math.max(1,r),f=t.lineWidth===-1?-1:Math.max(Math.min(t.lineWidth,40),t.lineWidth-o),d=n||t.flowLevel>-1&&r>=t.flowLevel;switch(chooseScalarStyle(e,d,t.indent,f,function(h){return function(y,k){var A,D;for(A=0,D=y.implicitTypes.length;A<D;A+=1)if(y.implicitTypes[A].resolve(k))return!0;return!1}(t,h)})){case STYLE_PLAIN:return e;case STYLE_SINGLE:return"'"+e.replace(/'/g,"''")+"'";case STYLE_LITERAL:return"|"+blockHeader(e,t.indent)+dropEndingNewline(indentString(e,o));case STYLE_FOLDED:return">"+blockHeader(e,t.indent)+dropEndingNewline(indentString(function(h,y){for(var k,A,D,q=/(\n+)([^\n]*)/g,H=(D=(D=h.indexOf(`
`))!==-1?D:h.length,q.lastIndex=D,foldLine(h.slice(0,D),y)),z=h[0]===`
`||h[0]===" ";A=q.exec(h);){var Z=A[1],j=A[2];k=j[0]===" ",H+=Z+(z||k||j===""?"":`
`)+foldLine(j,y),z=k}return H}(e,f),o));case STYLE_DOUBLE:return'"'+function(h){for(var y,k,A,D="",q=0;q<h.length;q++)(y=h.charCodeAt(q))>=55296&&y<=56319&&(k=h.charCodeAt(q+1))>=56320&&k<=57343?(D+=encodeHex(1024*(y-55296)+k-56320+65536),q++):D+=!(A=ESCAPE_SEQUENCES[y])&&isPrintable(y)?h[q]:A||encodeHex(y);return D}(e)+'"';default:throw new _$exception_25("impossible error: invalid scalar style")}}()}function blockHeader(t,e){var r=needIndentIndicator(t)?String(e):"",n=t[t.length-1]===`
`;return r+(!n||t[t.length-2]!==`
`&&t!==`
`?n?"":"-":"+")+`
`}function dropEndingNewline(t){return t[t.length-1]===`
`?t.slice(0,-1):t}function foldLine(t,e){if(t===""||t[0]===" ")return t;for(var r,n,o=/ [^ ]/g,f=0,d=0,h=0,y="";r=o.exec(t);)(h=r.index)-f>e&&(n=d>f?d:h,y+=`
`+t.slice(f,n),f=n+1),d=h;return y+=`
`,t.length-f>e&&d>f?y+=t.slice(f,d)+`
`+t.slice(d+1):y+=t.slice(f),y.slice(1)}function detectType(t,e,r){var n,o,f,d,h,y;for(f=0,d=(o=r?t.explicitTypes:t.implicitTypes).length;f<d;f+=1)if(((h=o[f]).instanceOf||h.predicate)&&(!h.instanceOf||typeof e=="object"&&e instanceof h.instanceOf)&&(!h.predicate||h.predicate(e))){if(t.tag=r?h.tag:"?",h.represent){if(y=t.styleMap[h.tag]||h.defaultStyle,___toString_24.call(h.represent)==="[object Function]")n=h.represent(e,y);else{if(!___hasOwnProperty_24.call(h.represent,y))throw new _$exception_25("!<"+h.tag+'> tag resolver accepts not "'+y+'" style');n=h.represent[y](e,y)}t.dump=n}return!0}return!1}function writeNode(t,e,r,n,o,f){t.tag=null,t.dump=r,detectType(t,r,!1)||detectType(t,r,!0);var d=___toString_24.call(t.dump);n&&(n=t.flowLevel<0||t.flowLevel>e);var h,y,k=d==="[object Object]"||d==="[object Array]";if(k&&(y=(h=t.duplicates.indexOf(r))!==-1),(t.tag!==null&&t.tag!=="?"||y||t.indent!==2&&e>0)&&(o=!1),y&&t.usedDuplicates[h])t.dump="*ref_"+h;else{if(k&&y&&!t.usedDuplicates[h]&&(t.usedDuplicates[h]=!0),d==="[object Object]")n&&Object.keys(t.dump).length!==0?(function(D,q,H,z){var Z,j,at,ct,ot,tt,gt="",wt=D.tag,ft=Object.keys(H);if(D.sortKeys===!0)ft.sort();else if(typeof D.sortKeys=="function")ft.sort(D.sortKeys);else if(D.sortKeys)throw new _$exception_25("sortKeys must be a boolean or a function");for(Z=0,j=ft.length;Z<j;Z+=1)tt="",z&&Z===0||(tt+=generateNextLine(D,q)),ct=H[at=ft[Z]],writeNode(D,q+1,at,!0,!0,!0)&&((ot=D.tag!==null&&D.tag!=="?"||D.dump&&D.dump.length>1024)&&(D.dump&&CHAR_LINE_FEED===D.dump.charCodeAt(0)?tt+="?":tt+="? "),tt+=D.dump,ot&&(tt+=generateNextLine(D,q)),writeNode(D,q+1,ct,!0,ot)&&(D.dump&&CHAR_LINE_FEED===D.dump.charCodeAt(0)?tt+=":":tt+=": ",gt+=tt+=D.dump));D.tag=wt,D.dump=gt||"{}"}(t,e,t.dump,o),y&&(t.dump="&ref_"+h+t.dump)):(function(D,q,H){var z,Z,j,at,ct,ot="",tt=D.tag,gt=Object.keys(H);for(z=0,Z=gt.length;z<Z;z+=1)ct="",z!==0&&(ct+=", "),D.condenseFlow&&(ct+='"'),at=H[j=gt[z]],writeNode(D,q,j,!1,!1)&&(D.dump.length>1024&&(ct+="? "),ct+=D.dump+(D.condenseFlow?'"':"")+":"+(D.condenseFlow?"":" "),writeNode(D,q,at,!1,!1)&&(ot+=ct+=D.dump));D.tag=tt,D.dump="{"+ot+"}"}(t,e,t.dump),y&&(t.dump="&ref_"+h+" "+t.dump));else if(d==="[object Array]"){var A=t.noArrayIndent&&e>0?e-1:e;n&&t.dump.length!==0?(function(D,q,H,z){var Z,j,at="",ct=D.tag;for(Z=0,j=H.length;Z<j;Z+=1)writeNode(D,q+1,H[Z],!0,!0)&&(z&&Z===0||(at+=generateNextLine(D,q)),D.dump&&CHAR_LINE_FEED===D.dump.charCodeAt(0)?at+="-":at+="- ",at+=D.dump);D.tag=ct,D.dump=at||"[]"}(t,A,t.dump,o),y&&(t.dump="&ref_"+h+t.dump)):(function(D,q,H){var z,Z,j="",at=D.tag;for(z=0,Z=H.length;z<Z;z+=1)writeNode(D,q,H[z],!1,!1)&&(z!==0&&(j+=","+(D.condenseFlow?"":" ")),j+=D.dump);D.tag=at,D.dump="["+j+"]"}(t,A,t.dump),y&&(t.dump="&ref_"+h+" "+t.dump))}else{if(d!=="[object String]"){if(t.skipInvalid)return!1;throw new _$exception_25("unacceptable kind of an object to dump "+d)}t.tag!=="?"&&writeScalar(t,t.dump,e,f)}t.tag!==null&&t.tag!=="?"&&(t.dump="!<"+t.tag+"> "+t.dump)}return!0}function getDuplicateReferences(t,e){var r,n,o=[],f=[];for(function d(h,y,k){var A,D,q;if(h!==null&&typeof h=="object")if((D=y.indexOf(h))!==-1)k.indexOf(D)===-1&&k.push(D);else if(y.push(h),Array.isArray(h))for(D=0,q=h.length;D<q;D+=1)d(h[D],y,k);else for(D=0,q=(A=Object.keys(h)).length;D<q;D+=1)d(h[A[D]],y,k)}(t,o,f),r=0,n=f.length;r<n;r+=1)e.duplicates.push(o[f[r]]);e.usedDuplicates=new Array(n)}function dump(t,e){var r=new __State_24(e=e||{});return r.noRefs||getDuplicateReferences(t,r),writeNode(r,0,t,!0,!0)?r.dump+`
`:""}_$dumper_24.dump=dump,_$dumper_24.safeDump=function(t,e){return dump(t,_$common_23.extend({schema:_$default_safe_31},e))};var _$jsYaml_22={};function deprecated(t){return function(){throw new Error("Function "+t+" is deprecated and cannot be used.")}}_$jsYaml_22.Type=_$type_34,_$jsYaml_22.Schema=_$schema_28,_$jsYaml_22.FAILSAFE_SCHEMA=_$failsafe_32,_$jsYaml_22.JSON_SCHEMA=_$json_33,_$jsYaml_22.CORE_SCHEMA=_$core_29,_$jsYaml_22.DEFAULT_SAFE_SCHEMA=_$default_safe_31,_$jsYaml_22.DEFAULT_FULL_SCHEMA=_$default_full_30,_$jsYaml_22.load=_$loader_26.load,_$jsYaml_22.loadAll=_$loader_26.loadAll,_$jsYaml_22.safeLoad=_$loader_26.safeLoad,_$jsYaml_22.safeLoadAll=_$loader_26.safeLoadAll,_$jsYaml_22.dump=_$dumper_24.dump,_$jsYaml_22.safeDump=_$dumper_24.safeDump,_$jsYaml_22.YAMLException=_$exception_25,_$jsYaml_22.MINIMAL_SCHEMA=_$failsafe_32,_$jsYaml_22.SAFE_SCHEMA=_$default_safe_31,_$jsYaml_22.DEFAULT_SCHEMA=_$default_full_30,_$jsYaml_22.scan=deprecated("scan"),_$jsYaml_22.parse=deprecated("parse"),_$jsYaml_22.compose=deprecated("compose"),_$jsYaml_22.addConstructor=deprecated("addConstructor");var _$yaml_21=_$jsYaml_22,_$staticJsYaml_84={safeLoad:_$yaml_21.safeLoad,load:_$yaml_21.load,safeDump:_$yaml_21.safeDump,dump:_$yaml_21.dump},_$yaml_148={};Object.defineProperty(_$yaml_148,"__esModule",{value:!0}),_$yaml_148.default=void 0,_$yaml_148.dump=__dump_148,_$yaml_148.load=__load_148,_$yaml_148.safeDump=safeDump,_$yaml_148.safeLoad=safeLoad;var __obj_148,_staticJsYaml=(__obj_148=_$staticJsYaml_84)&&__obj_148.__esModule?__obj_148:{default:__obj_148};function retry(t,e){for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];try{return t.apply(void 0,[e].concat(n))}catch{return t.apply(void 0,[__dump_148(t.apply(void 0,[e.replace(/!<str>\s*/g,"__SubStoreJSYAMLString__")].concat(n))).replace(/__SubStoreJSYAMLString__/g,"")].concat(n))}}function safeLoad(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return retry.apply(void 0,[_staticJsYaml.default.safeLoad,JSON.parse(JSON.stringify(t))].concat(r))}function __load_148(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return retry.apply(void 0,[_staticJsYaml.default.load,JSON.parse(JSON.stringify(t))].concat(r))}function safeDump(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return _staticJsYaml.default.safeDump.apply(_staticJsYaml.default,[JSON.parse(JSON.stringify(t))].concat(r))}function __dump_148(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return _staticJsYaml.default.dump.apply(_staticJsYaml.default,[JSON.parse(JSON.stringify(t))].concat(r))}var ___default_148={safeLoad,load:__load_148,safeDump,dump:__dump_148};_$yaml_148.default=___default_148;var _$scriptResourceCache_146={};Object.defineProperty(_$scriptResourceCache_146,"__esModule",{value:!0}),_$scriptResourceCache_146.default=void 0;var __obj_146,___app_146=(__obj_146=_$app_87)&&__obj_146.__esModule?__obj_146:{default:__obj_146};function ___slicedToArray_146(t,e){return function(r){if(Array.isArray(r))return r}(t)||function(r,n){var o=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o!=null){var f,d,h=[],y=!0,k=!1;try{for(o=o.call(r);!(y=(f=o.next()).done)&&(h.push(f.value),!n||h.length!==n);y=!0);}catch(A){k=!0,d=A}finally{try{y||o.return==null||o.return()}finally{if(k)throw d}}return h}}(t,e)||function(r,n){if(r){if(typeof r=="string")return ___arrayLikeToArray_146(r,n);var o=Object.prototype.toString.call(r).slice(8,-1);return o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set"?Array.from(r):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?___arrayLikeToArray_146(r,n):void 0}}(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ___arrayLikeToArray_146(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ___defineProperties_146(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var ___default_146=new(function(){function t(){(function(o,f){if(!(o instanceof f))throw new TypeError("Cannot call a class as a function")})(this,t),this.expires=function(){___app_146.default.read(_$constants_86.CSR_EXPIRATION_TIME_KEY)||___app_146.default.write("1728e5",_$constants_86.CSR_EXPIRATION_TIME_KEY);var o=1728e5;if(___app_146.default.env.isLoon){var f={"1\u5206\u949F":6e4,"5\u5206\u949F":3e5,"10\u5206\u949F":6e5,"30\u5206\u949F":18e5,"1\u5C0F\u65F6":36e5,"2\u5C0F\u65F6":72e5,"3\u5C0F\u65F6":108e5,"6\u5C0F\u65F6":216e5,"12\u5C0F\u65F6":432e5,"24\u5C0F\u65F6":864e5,"48\u5C0F\u65F6":1728e5,"72\u5C0F\u65F6":2592e5,\u53C2\u6570\u4F20\u5165:"readcachets"},d=___app_146.default.read("#\u8282\u70B9\u7F13\u5B58\u6709\u6548\u671F");return d in f&&(o=f[d])==="readcachets"&&(o=d),o}return ___app_146.default.read(_$constants_86.CSR_EXPIRATION_TIME_KEY)}(),___app_146.default.read(_$constants_86.SCRIPT_RESOURCE_CACHE_KEY)||___app_146.default.write("{}",_$constants_86.SCRIPT_RESOURCE_CACHE_KEY);try{this.resourceCache=JSON.parse(___app_146.default.read(_$constants_86.SCRIPT_RESOURCE_CACHE_KEY))}catch(o){var n;___app_146.default.error("\u89E3\u6790\u6301\u4E45\u5316\u7F13\u5B58\u4E2D\u7684 ".concat(_$constants_86.SCRIPT_RESOURCE_CACHE_KEY," \u5931\u8D25, \u91CD\u7F6E\u4E3A {}, \u9519\u8BEF: ").concat((n=o?.message)!==null&&n!==void 0?n:o)),this.resourceCache={},___app_146.default.write("{}",_$constants_86.SCRIPT_RESOURCE_CACHE_KEY)}this._cleanup()}var e,r;return e=t,(r=[{key:"_cleanup",value:function(){var n=this,o=!1;Object.entries(this.resourceCache).forEach(function(f){var d=___slicedToArray_146(f,2),h=d[0],y=d[1];y.time||(delete n.resourceCache[h],___app_146.default.delete("#".concat(h)),o=!0),new Date().getTime()-y.time>n.expires&&(delete n.resourceCache[h],o=!0)}),o&&this._persist()}},{key:"revokeAll",value:function(){this.resourceCache={},this._persist()}},{key:"_persist",value:function(){___app_146.default.write(JSON.stringify(this.resourceCache),_$constants_86.SCRIPT_RESOURCE_CACHE_KEY)}},{key:"get",value:function(n){var o=this.resourceCache[n]&&this.resourceCache[n].time;return o&&new Date().getTime()-o<=this.expires?this.resourceCache[n].data:null}},{key:"gettime",value:function(n){var o=this.resourceCache[n]&&this.resourceCache[n].time;return o&&new Date().getTime()-o<=this.expires?this.resourceCache[n].time:null}},{key:"set",value:function(n,o){this.resourceCache[n]={time:new Date().getTime(),data:o},this._persist()}}])&&___defineProperties_146(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}());_$scriptResourceCache_146.default=___default_146;var _$logical_142={};function ___arrayLikeToArray_142(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}Object.defineProperty(_$logical_142,"__esModule",{value:!0}),_$logical_142.AND=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.reduce(function(n,o){return n.map(function(f,d){return o[d]&&f})})},_$logical_142.FULL=function(t,e){return(r=Array(t).keys(),function(n){if(Array.isArray(n))return ___arrayLikeToArray_142(n)}(r)||function(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}(r)||function(n,o){if(n){if(typeof n=="string")return ___arrayLikeToArray_142(n,void 0);var f=Object.prototype.toString.call(n).slice(8,-1);return f==="Object"&&n.constructor&&(f=n.constructor.name),f==="Map"||f==="Set"?Array.from(n):f==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(f)?___arrayLikeToArray_142(n,void 0):void 0}}(r)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()).map(function(){return e});var r},_$logical_142.NOT=function(t){return t.map(function(e){return!e})},_$logical_142.OR=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.reduce(function(n,o){return n.map(function(f,d){return o[d]||f})})};var _$geo_138={};Object.defineProperty(_$geo_138,"__esModule",{value:!0}),_$geo_138.MMDB=void 0,_$geo_138.getFlag=getFlag,_$geo_138.getISO=getISO,_$geo_138.removeFlag=removeFlag;var ___app_138=___interopRequireDefault_138(_$app_87);function ___interopRequireDefault_138(t){return t&&t.__esModule?t:{default:t}}function ___classCallCheck_138(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ___defineProperties_138(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ___createClass_138(t,e,r){return e&&___defineProperties_138(t.prototype,e),r&&___defineProperties_138(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var ISOFlags={"\u{1F3F3}\uFE0F\u200D\u{1F308}":["EXP","BAND"],"\u{1F1F8}\u{1F1F1}":["TEST","SOS"],"\u{1F1E6}\u{1F1E9}":["AD","AND"],"\u{1F1E6}\u{1F1EA}":["AE","ARE"],"\u{1F1E6}\u{1F1EB}":["AF","AFG"],"\u{1F1E6}\u{1F1F1}":["AL","ALB"],"\u{1F1E6}\u{1F1F2}":["AM","ARM"],"\u{1F1E6}\u{1F1F7}":["AR","ARG"],"\u{1F1E6}\u{1F1F9}":["AT","AUT"],"\u{1F1E6}\u{1F1FA}":["AU","AUS"],"\u{1F1E6}\u{1F1FF}":["AZ","AZE"],"\u{1F1E7}\u{1F1E6}":["BA","BIH"],"\u{1F1E7}\u{1F1E9}":["BD","BGD"],"\u{1F1E7}\u{1F1EA}":["BE","BEL"],"\u{1F1E7}\u{1F1EC}":["BG","BGR"],"\u{1F1E7}\u{1F1ED}":["BH","BHR"],"\u{1F1E7}\u{1F1F7}":["BR","BRA"],"\u{1F1E7}\u{1F1FE}":["BY","BLR"],"\u{1F1E8}\u{1F1E6}":["CA","CAN"],"\u{1F1E8}\u{1F1ED}":["CH","CHE"],"\u{1F1E8}\u{1F1F1}":["CL","CHL"],"\u{1F1E8}\u{1F1F4}":["CO","COL"],"\u{1F1E8}\u{1F1F7}":["CR","CRI"],"\u{1F1E8}\u{1F1FE}":["CY","CYP"],"\u{1F1E8}\u{1F1FF}":["CZ","CZE"],"\u{1F1E9}\u{1F1EA}":["DE","DEU"],"\u{1F1E9}\u{1F1F0}":["DK","DNK"],"\u{1F1EA}\u{1F1E8}":["EC","ECU"],"\u{1F1EA}\u{1F1EA}":["EE","EST"],"\u{1F1EA}\u{1F1EC}":["EG","EGY"],"\u{1F1EA}\u{1F1F8}":["ES","ESP"],"\u{1F1EA}\u{1F1FA}":["EU"],"\u{1F1EB}\u{1F1EE}":["FI","FIN"],"\u{1F1EB}\u{1F1F7}":["FR","FRA"],"\u{1F1EC}\u{1F1E7}":["GB","GBR","UK"],"\u{1F1EC}\u{1F1EA}":["GE","GEO"],"\u{1F1EC}\u{1F1F7}":["GR","GRC"],"\u{1F1ED}\u{1F1F0}":["HK","HKG","HKT","HKBN","HGC","WTT","CMI"],"\u{1F1ED}\u{1F1F7}":["HR","HRV"],"\u{1F1ED}\u{1F1FA}":["HU","HUN"],"\u{1F1EF}\u{1F1F4}":["JO","JOR"],"\u{1F1EF}\u{1F1F5}":["JP","JPN","TYO"],"\u{1F1F0}\u{1F1EA}":["KE","KEN"],"\u{1F1F0}\u{1F1EC}":["KG","KGZ"],"\u{1F1F0}\u{1F1ED}":["KH","KGZ"],"\u{1F1F0}\u{1F1F5}":["KP","PRK"],"\u{1F1F0}\u{1F1F7}":["KR","KOR","SEL"],"\u{1F1F0}\u{1F1FF}":["KZ","KAZ"],"\u{1F1EE}\u{1F1E9}":["ID","IDN"],"\u{1F1EE}\u{1F1EA}":["IE","IRL"],"\u{1F1EE}\u{1F1F1}":["IL","ISR"],"\u{1F1EE}\u{1F1F2}":["IM","IMN"],"\u{1F1EE}\u{1F1F3}":["IN","IND"],"\u{1F1EE}\u{1F1F7}":["IR","IRN"],"\u{1F1EE}\u{1F1F8}":["IS","ISL"],"\u{1F1EE}\u{1F1F9}":["IT","ITA"],"\u{1F1F1}\u{1F1F9}":["LT","LTU"],"\u{1F1F1}\u{1F1FA}":["LU","LUX"],"\u{1F1F1}\u{1F1FB}":["LV","LVA"],"\u{1F1F2}\u{1F1E6}":["MA","MAR"],"\u{1F1F2}\u{1F1E9}":["MD","MDA"],"\u{1F1F3}\u{1F1EC}":["NG","NGA"],"\u{1F1F2}\u{1F1F0}":["MK","MKD"],"\u{1F1F2}\u{1F1F3}":["MN","MNG"],"\u{1F1F2}\u{1F1F4}":["MO","MAC","CTM"],"\u{1F1F2}\u{1F1F9}":["MT","MLT"],"\u{1F1F2}\u{1F1FD}":["MX","MEX"],"\u{1F1F2}\u{1F1FE}":["MY","MYS"],"\u{1F1F3}\u{1F1F1}":["NL","NLD","AMS"],"\u{1F1F3}\u{1F1F4}":["NO","NOR"],"\u{1F1F3}\u{1F1F5}":["NP","NPL"],"\u{1F1F3}\u{1F1FF}":["NZ","NZL"],"\u{1F1F5}\u{1F1E6}":["PA","PAN"],"\u{1F1F5}\u{1F1EA}":["PE","PER"],"\u{1F1F5}\u{1F1ED}":["PH","PHL"],"\u{1F1F5}\u{1F1F0}":["PK","PAK"],"\u{1F1F5}\u{1F1F1}":["PL","POL"],"\u{1F1F5}\u{1F1F7}":["PR","PRI"],"\u{1F1F5}\u{1F1F9}":["PT","PRT"],"\u{1F1F5}\u{1F1FE}":["PY","PRY"],"\u{1F1F7}\u{1F1F4}":["RO","ROU"],"\u{1F1F7}\u{1F1F8}":["RS","SRB"],"\u{1F1F7}\u{1F1EA}":["RE","REU"],"\u{1F1F7}\u{1F1FA}":["RU","RUS"],"\u{1F1F8}\u{1F1E6}":["SA","SAU"],"\u{1F1F8}\u{1F1EA}":["SE","SWE"],"\u{1F1F8}\u{1F1EC}":["SG","SGP"],"\u{1F1F8}\u{1F1EE}":["SI","SVN"],"\u{1F1F8}\u{1F1F0}":["SK","SVK"],"\u{1F1F9}\u{1F1ED}":["TH","THA"],"\u{1F1F9}\u{1F1F3}":["TN","TUN"],"\u{1F1F9}\u{1F1F7}":["TR","TUR"],"\u{1F1F9}\u{1F1FC}":["TW","TWN","CHT","HINET","ROC"],"\u{1F1FA}\u{1F1E6}":["UA","UKR"],"\u{1F1FA}\u{1F1F8}":["US","USA","LAX","SFO","SJC"],"\u{1F1FA}\u{1F1FE}":["UY","URY"],"\u{1F1FB}\u{1F1EA}":["VE","VEN"],"\u{1F1FB}\u{1F1F3}":["VN","VNM"],"\u{1F1FF}\u{1F1E6}":["ZA","ZAF","JNB"],"\u{1F1E8}\u{1F1F3}":["CN","CHN","BACK"]};function getFlag(t){for(var e,r={"\u{1F3F3}\uFE0F\u200D\u{1F308}":["\u6D41\u91CF","\u65F6\u95F4","\u8FC7\u671F","Bandwidth","Expire"],"\u{1F1F8}\u{1F1F1}":["\u5E94\u6025","\u6D4B\u8BD5\u8282\u70B9"],"\u{1F1E6}\u{1F1E9}":["Andorra","\u5B89\u9053\u5C14"],"\u{1F1E6}\u{1F1EA}":["United Arab Emirates","\u963F\u8054\u914B","\u8FEA\u62DC"],"\u{1F1E6}\u{1F1EB}":["Afghanistan","\u963F\u5BCC\u6C57"],"\u{1F1E6}\u{1F1F1}":["Albania","\u963F\u5C14\u5DF4\u5C3C\u4E9A","\u963F\u723E\u5DF4\u5C3C\u4E9E"],"\u{1F1E6}\u{1F1F2}":["Armenia","\u4E9A\u7F8E\u5C3C\u4E9A"],"\u{1F1E6}\u{1F1F7}":["Argentina","\u963F\u6839\u5EF7"],"\u{1F1E6}\u{1F1F9}":["Austria","\u5965\u5730\u5229","\u5967\u5730\u5229","\u7EF4\u4E5F\u7EB3"],"\u{1F1E6}\u{1F1FA}":["Australia","\u6FB3\u5927\u5229\u4E9A","\u6FB3\u6D32","\u58A8\u5C14\u672C","\u6089\u5C3C","\u571F\u6FB3","\u4EAC\u6FB3","\u5EE3\u6FB3","\u6EEC\u6FB3","\u6CAA\u6FB3","\u5E7F\u6FB3","Sydney"],"\u{1F1E6}\u{1F1FF}":["Azerbaijan","\u963F\u585E\u62DC\u7586"],"\u{1F1E7}\u{1F1E6}":["Bosnia and Herzegovina","\u6CE2\u9ED1\u5171\u548C\u56FD","\u6CE2\u9ED1"],"\u{1F1E7}\u{1F1E9}":["Bangladesh","\u5B5F\u52A0\u62C9\u56FD","\u5B5F\u52A0\u62C9"],"\u{1F1E7}\u{1F1EA}":["Belgium","\u6BD4\u5229\u65F6","\u6BD4\u5229\u6642"],"\u{1F1E7}\u{1F1EC}":["Bulgaria","\u4FDD\u52A0\u5229\u4E9A","\u4FDD\u52A0\u5229\u4E9E"],"\u{1F1E7}\u{1F1ED}":["Bahrain","\u5DF4\u6797"],"\u{1F1E7}\u{1F1F7}":["Brazil","\u5DF4\u897F","\u5723\u4FDD\u7F57"],"\u{1F1E7}\u{1F1FE}":["Belarus","\u767D\u4FC4\u7F57\u65AF","\u767D\u4FC4"],"\u{1F1E8}\u{1F1E6}":["Canada","\u52A0\u62FF\u5927","\u8499\u7279\u5229\u5C14","\u6E29\u54E5\u534E","\u6953\u8449","\u67AB\u53F6","\u6ED1\u94C1\u5362","\u591A\u4F26\u591A","Waterloo","Toronto"],"\u{1F1E8}\u{1F1ED}":["Switzerland","\u745E\u58EB","\u82CF\u9ECE\u4E16","Zurich"],"\u{1F1E8}\u{1F1F1}":["Chile","\u667A\u5229"],"\u{1F1E8}\u{1F1F4}":["Colombia","\u54E5\u4F26\u6BD4\u4E9A"],"\u{1F1E8}\u{1F1F7}":["Costa Rica","\u54E5\u65AF\u8FBE\u9ECE\u52A0"],"\u{1F1E8}\u{1F1FE}":["Cyprus","\u585E\u6D66\u8DEF\u65AF"],"\u{1F1E8}\u{1F1FF}":["Czechia","\u6377\u514B"],"\u{1F1E9}\u{1F1EA}":["German","\u5FB7\u56FD","\u5FB7\u570B","\u4EAC\u5FB7","\u6EEC\u5FB7","\u5EE3\u5FB7","\u6CAA\u5FB7","\u5E7F\u5FB7","\u6CD5\u5170\u514B\u798F","Frankfurt","\u5FB7\u610F\u5FD7"],"\u{1F1E9}\u{1F1F0}":["Denmark","\u4E39\u9EA6","\u4E39\u9EA5"],"\u{1F1EA}\u{1F1E8}":["Ecuador","\u5384\u74DC\u591A\u5C14"],"\u{1F1EA}\u{1F1EA}":["Estonia","\u7231\u6C99\u5C3C\u4E9A"],"\u{1F1EA}\u{1F1EC}":["Egypt","\u57C3\u53CA"],"\u{1F1EA}\u{1F1F8}":["Spain","\u897F\u73ED\u7259"],"\u{1F1EA}\u{1F1FA}":["European Union","\u6B27\u76DF","\u6B27\u7F57\u5DF4"],"\u{1F1EB}\u{1F1EE}":["Finland","\u82AC\u5170","\u82AC\u862D","\u8D6B\u5C14\u8F9B\u57FA"],"\u{1F1EB}\u{1F1F7}":["France","\u6CD5\u56FD","\u6CD5\u570B","\u5DF4\u9ECE"],"\u{1F1EC}\u{1F1E7}":["Great Britain","\u82F1\u56FD","England","United Kingdom","\u4F26\u6566","\u82F1","London"],"\u{1F1EC}\u{1F1EA}":["Georgia","\u683C\u9C81\u5409\u4E9A","\u683C\u9B6F\u5409\u4E9E"],"\u{1F1EC}\u{1F1F7}":["Greece","\u5E0C\u814A","\u5E0C\u81D8"],"\u{1F1ED}\u{1F1F0}":["Hongkong","\u9999\u6E2F","Hong Kong","HongKong","HONG KONG","\u6DF1\u6E2F","\u6CAA\u6E2F","\u547C\u6E2F","\u7A57\u6E2F","\u4EAC\u6E2F","\u6E2F"],"\u{1F1ED}\u{1F1F7}":["Croatia","\u514B\u7F57\u5730\u4E9A","\u514B\u7F85\u5730\u4E9E"],"\u{1F1ED}\u{1F1FA}":["Hungary","\u5308\u7259\u5229"],"\u{1F1EF}\u{1F1F4}":["Jordan","\u7EA6\u65E6"],"\u{1F1EF}\u{1F1F5}":["Japan","\u65E5\u672C","\u4E1C\u4EAC","\u5927\u962A","\u57FC\u7389","\u6CAA\u65E5","\u7A57\u65E5","\u5DDD\u65E5","\u4E2D\u65E5","\u6CC9\u65E5","\u676D\u65E5","\u6DF1\u65E5","\u8FBD\u65E5","\u5E7F\u65E5","\u5927\u5742","Osaka","Tokyo"],"\u{1F1F0}\u{1F1EA}":["Kenya","\u80AF\u5C3C\u4E9A"],"\u{1F1F0}\u{1F1EC}":["Kyrgyzstan","\u5409\u5C14\u5409\u65AF\u65AF\u5766"],"\u{1F1F0}\u{1F1ED}":["Cambodia","\u67EC\u57D4\u5BE8"],"\u{1F1F0}\u{1F1F5}":["North Korea","\u671D\u9C9C"],"\u{1F1F0}\u{1F1F7}":["Korea","\u97E9\u56FD","\u97D3\u570B","\u97E9","\u97D3","\u9996\u5C14","\u6625\u5DDD","Chuncheon","Seoul"],"\u{1F1F0}\u{1F1FF}":["Kazakhstan","\u54C8\u8428\u514B\u65AF\u5766","\u54C8\u8428\u514B"],"\u{1F1EE}\u{1F1E9}":["Indonesia","\u5370\u5C3C","\u5370\u5EA6\u5C3C\u897F\u4E9A","\u96C5\u52A0\u8FBE"],"\u{1F1EE}\u{1F1EA}":["Ireland","\u7231\u5C14\u5170","\u611B\u723E\u862D","\u90FD\u67CF\u6797"],"\u{1F1EE}\u{1F1F1}":["Israel","\u4EE5\u8272\u5217"],"\u{1F1EE}\u{1F1F2}":["Isle of Man","\u9A6C\u6069\u5C9B","\u99AC\u6069\u5CF6"],"\u{1F1EE}\u{1F1F3}":["India","\u5370\u5EA6","\u5B5F\u4E70","MFumbai","Mumbai"],"\u{1F1EE}\u{1F1F7}":["Iran","\u4F0A\u6717"],"\u{1F1EE}\u{1F1F8}":["Iceland","\u51B0\u5C9B","\u51B0\u5CF6"],"\u{1F1EE}\u{1F1F9}":["Italy","\u610F\u5927\u5229","\u7FA9\u5927\u5229","\u7C73\u5170","Nachash"],"\u{1F1F1}\u{1F1F9}":["Lithuania","\u7ACB\u9676\u5B9B"],"\u{1F1F1}\u{1F1FA}":["Luxembourg","\u5362\u68EE\u5821"],"\u{1F1F1}\u{1F1FB}":["Latvia","\u62C9\u8131\u7EF4\u4E9A","Latvija"],"\u{1F1F2}\u{1F1E6}":["Morocco","\u6469\u6D1B\u54E5"],"\u{1F1F2}\u{1F1E9}":["Moldova","\u6469\u5C14\u591A\u74E6","\u6469\u723E\u591A\u74E6"],"\u{1F1F3}\u{1F1EC}":["Nigeria","\u5C3C\u65E5\u5229\u4E9A","\u5C3C\u65E5\u5229\u4E9E"],"\u{1F1F2}\u{1F1F0}":["Macedonia","\u9A6C\u5176\u987F","\u99AC\u5176\u9813"],"\u{1F1F2}\u{1F1F3}":["Mongolia","\u8499\u53E4"],"\u{1F1F2}\u{1F1F4}":["Macao","\u6FB3\u95E8","\u6FB3\u9580","CTM"],"\u{1F1F2}\u{1F1F9}":["Malta","\u9A6C\u8033\u4ED6"],"\u{1F1F2}\u{1F1FD}":["Mexico","\u58A8\u897F\u54E5"],"\u{1F1F2}\u{1F1FE}":["Malaysia","\u9A6C\u6765","\u99AC\u4F86","\u5409\u9686\u5761","\u5927\u99AC"],"\u{1F1F3}\u{1F1F1}":["Netherlands","\u8377\u5170","\u8377\u862D","\u5C3C\u5FB7\u862D","\u963F\u59C6\u65AF\u7279\u4E39","Amsterdam"],"\u{1F1F3}\u{1F1F4}":["Norway","\u632A\u5A01"],"\u{1F1F3}\u{1F1F5}":["Nepal","\u5C3C\u6CCA\u5C14"],"\u{1F1F3}\u{1F1FF}":["New Zealand","\u65B0\u897F\u5170","\u65B0\u897F\u862D"],"\u{1F1F5}\u{1F1E6}":["Panama","\u5DF4\u62FF\u9A6C"],"\u{1F1F5}\u{1F1EA}":["Peru","\u79D8\u9C81","\u7955\u9B6F"],"\u{1F1F5}\u{1F1ED}":["Philippines","\u83F2\u5F8B\u5BBE","\u83F2\u5F8B\u8CD3"],"\u{1F1F5}\u{1F1F0}":["Pakistan","\u5DF4\u57FA\u65AF\u5766"],"\u{1F1F5}\u{1F1F1}":["Poland","\u6CE2\u5170","\u6CE2\u862D","\u534E\u6C99","Warsaw"],"\u{1F1F5}\u{1F1F7}":["Puerto Rico","\u6CE2\u591A\u9ECE\u5404"],"\u{1F1F5}\u{1F1F9}":["Portugal","\u8461\u8404\u7259"],"\u{1F1F5}\u{1F1FE}":["Paraguay","\u5DF4\u62C9\u572D"],"\u{1F1F7}\u{1F1F4}":["Romania","\u7F57\u9A6C\u5C3C\u4E9A"],"\u{1F1F7}\u{1F1F8}":["Serbia","\u585E\u5C14\u7EF4\u4E9A"],"\u{1F1F7}\u{1F1EA}":["R\xE9union","\u7559\u5C3C\u6C6A","\u6CD5\u5C5E\u7559\u5C3C\u6C6A"],"\u{1F1F7}\u{1F1FA}":["Russia","\u4FC4\u7F57\u65AF","\u4FC4\u56FD","\u4FC4\u7F85\u65AF","\u4F2F\u529B","\u83AB\u65AF\u79D1","\u5723\u5F7C\u5F97\u5821","\u897F\u4F2F\u5229\u4E9A","\u4EAC\u4FC4","\u676D\u4FC4","\u5EE3\u4FC4","\u6EEC\u4FC4","\u5E7F\u4FC4","\u6CAA\u4FC4","Moscow"],"\u{1F1F8}\u{1F1E6}":["Saudi","\u6C99\u7279\u963F\u62C9\u4F2F","\u6C99\u7279","Riyadh","\u5229\u96C5\u5F97"],"\u{1F1F8}\u{1F1EA}":["Sweden","\u745E\u5178","\u65AF\u5FB7\u54E5\u5C14\u6469","Stockholm"],"\u{1F1F8}\u{1F1EC}":["Singapore","\u65B0\u52A0\u5761","\u72EE\u57CE","\u6CAA\u65B0","\u4EAC\u65B0","\u4E2D\u65B0","\u6CC9\u65B0","\u7A57\u65B0","\u6DF1\u65B0","\u676D\u65B0","\u5E7F\u65B0","\u5EE3\u65B0","\u6EEC\u65B0"],"\u{1F1F8}\u{1F1EE}":["Slovenia","\u65AF\u6D1B\u6587\u5C3C\u4E9A"],"\u{1F1F8}\u{1F1F0}":["Slovakia","\u65AF\u6D1B\u4F10\u514B"],"\u{1F1F9}\u{1F1ED}":["Thailand","\u6CF0\u56FD","\u6CF0\u570B","\u66FC\u8C37"],"\u{1F1F9}\u{1F1F3}":["Tunisia","\u7A81\u5C3C\u65AF"],"\u{1F1F9}\u{1F1F7}":["Turkey","\u571F\u8033\u5176","\u4F0A\u65AF\u5766\u5E03\u5C14","Istanbul"],"\u{1F1F9}\u{1F1FC}":["Taiwan","\u53F0\u6E7E","\u81FA\u7063","\u53F0\u7063","\u4E2D\u83EF\u6C11\u570B","\u4E2D\u534E\u6C11\u56FD","\u53F0\u5317","\u53F0\u4E2D","\u65B0\u5317","\u5F70\u5316","\u53F0","\u81FA","Taipei","Tai Wan"],"\u{1F1FA}\u{1F1E6}":["Ukraine","\u4E4C\u514B\u5170","\u70CF\u514B\u862D"],"\u{1F1FA}\u{1F1F8}":["United States","\u7F8E\u56FD","America","\u7F8E","\u4EAC\u7F8E","\u6CE2\u7279\u5170","\u8FBE\u62C9\u65AF","\u4FC4\u52D2\u5188","Oregon","\u51E4\u51F0\u57CE","\u8D39\u5229\u8499","\u7845\u8C37","\u77FD\u8C37","\u62C9\u65AF\u7EF4\u52A0\u65AF","\u6D1B\u6749\u77F6","\u5723\u4F55\u585E","\u5723\u514B\u62C9\u62C9","\u897F\u96C5\u56FE","\u829D\u52A0\u54E5","\u6CAA\u7F8E","\u54E5\u4F26\u5E03","\u7EBD\u7EA6","New York","Los Angeles","San Jose","Sillicon Valley","Michigan","\u4FC4\u4EA5\u4FC4","Ohio","\u9A6C\u7EB3\u8428\u65AF","Manassas","\u5F17\u5409\u5C3C\u4E9A","Virginia"],"\u{1F1FA}\u{1F1FE}":["Uruguay","\u4E4C\u62C9\u572D"],"\u{1F1FB}\u{1F1EA}":["Venezuela","\u59D4\u5185\u745E\u62C9"],"\u{1F1FB}\u{1F1F3}":["Vietnam","\u8D8A\u5357","\u80E1\u5FD7\u660E"],"\u{1F1FF}\u{1F1E6}":["South Africa","\u5357\u975E"],"\u{1F1E8}\u{1F1F3}":["China","\u4E2D\u56FD","\u4E2D\u570B","\u56DE\u56FD","\u56DE\u570B","\u56FD\u5185","\u570B\u5167","\u534E\u4E1C","\u534E\u897F","\u534E\u5357","\u534E\u5317","\u534E\u4E2D","\u6C5F\u82CF","\u5317\u4EAC","\u4E0A\u6D77","\u5E7F\u5DDE","\u6DF1\u5733","\u676D\u5DDE","\u5F90\u5DDE","\u9752\u5C9B","\u5B81\u6CE2","\u9547\u6C5F"]},n=((e=t.match(/[\uD83C][\uDDE6-\uDDFF][\uD83C][\uDDE6-\uDDFF]/))===null||e===void 0?void 0:e[0])||"\u{1F3F4}\u200D\u2620\uFE0F",o=0,f=Object.keys(r);o<f.length;o++){var d=f[o];if(r[d].some(function(A){return RegExp("".concat(A),"i").test(t)}))return/\u5185\u8499\u53e4/.test(t)&&["\u{1F1F2}\u{1F1F3}"].includes(d)?"\u{1F1E8}\u{1F1F3}":d}for(var h=0,y=Object.keys(ISOFlags);h<y.length;h++){var k=y[h];if(ISOFlags[k].some(function(A){return RegExp("(^|[^a-zA-Z])".concat(A,"([^a-zA-Z]|$)")).test(t)})&&(k!="\u{1F1E8}\u{1F1F3}"||!RegExp("(^|[^a-zA-Z])CN2([^a-zA-Z]|$)").test(t)))return k}return n}function getISO(t){var e;return(e=ISOFlags[getFlag(t)])===null||e===void 0?void 0:e[0]}function removeFlag(t){return t.replace(/[\uD83C][\uDDE6-\uDDFF][\uD83C][\uDDE6-\uDDFF]|\ud83c\udff4\u200d\u2620\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08/g,"").trim()}var MMDB=function(){function MMDB(){var _ref=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},country=_ref.country,asn=_ref.asn;if(___classCallCheck_138(this,MMDB),___app_138.default.env.isNode){var Reader=require("@maxmind/geoip2-node").Reader,fs=require("fs"),countryFile=country||eval("process.env.SUB_STORE_MMDB_COUNTRY_PATH"),asnFile=asn||eval("process.env.SUB_STORE_MMDB_ASN_PATH");if(countryFile&&(this.countryReader=Reader.openBuffer(fs.readFileSync(countryFile))),asnFile){if(!fs.existsSync(asnFile))throw new Error("GeoLite2 ASN MMDB does not exist");this.asnReader=Reader.openBuffer(fs.readFileSync(asnFile))}}}return ___createClass_138(MMDB,[{key:"geoip",value:function(t){var e,r,n;return(e=this.countryReader)===null||e===void 0||(r=e.country(t))===null||r===void 0||(n=r.country)===null||n===void 0?void 0:n.isoCode}},{key:"ipaso",value:function(t){var e,r;return(e=this.asnReader)===null||e===void 0||(r=e.asn(t))===null||r===void 0?void 0:r.autonomousSystemOrganization}},{key:"ipasn",value:function(t){var e,r;return(e=this.asnReader)===null||e===void 0||(r=e.asn(t))===null||r===void 0?void 0:r.autonomousSystemNumber}}]),MMDB}();_$geo_138.MMDB=MMDB;var _$types_9={toString:function(t){switch(t){case 1:return"A";case 10:return"NULL";case 28:return"AAAA";case 18:return"AFSDB";case 42:return"APL";case 257:return"CAA";case 60:return"CDNSKEY";case 59:return"CDS";case 37:return"CERT";case 5:return"CNAME";case 49:return"DHCID";case 32769:return"DLV";case 39:return"DNAME";case 48:return"DNSKEY";case 43:return"DS";case 55:return"HIP";case 13:return"HINFO";case 45:return"IPSECKEY";case 25:return"KEY";case 36:return"KX";case 29:return"LOC";case 15:return"MX";case 35:return"NAPTR";case 2:return"NS";case 47:return"NSEC";case 50:return"NSEC3";case 51:return"NSEC3PARAM";case 12:return"PTR";case 46:return"RRSIG";case 17:return"RP";case 24:return"SIG";case 6:return"SOA";case 99:return"SPF";case 33:return"SRV";case 44:return"SSHFP";case 32768:return"TA";case 249:return"TKEY";case 52:return"TLSA";case 250:return"TSIG";case 16:return"TXT";case 252:return"AXFR";case 251:return"IXFR";case 41:return"OPT";case 255:return"ANY"}return"UNKNOWN_"+t},toType:function(t){switch(t.toUpperCase()){case"A":return 1;case"NULL":return 10;case"AAAA":return 28;case"AFSDB":return 18;case"APL":return 42;case"CAA":return 257;case"CDNSKEY":return 60;case"CDS":return 59;case"CERT":return 37;case"CNAME":return 5;case"DHCID":return 49;case"DLV":return 32769;case"DNAME":return 39;case"DNSKEY":return 48;case"DS":return 43;case"HIP":return 55;case"HINFO":return 13;case"IPSECKEY":return 45;case"KEY":return 25;case"KX":return 36;case"LOC":return 29;case"MX":return 15;case"NAPTR":return 35;case"NS":return 2;case"NSEC":return 47;case"NSEC3":return 50;case"NSEC3PARAM":return 51;case"PTR":return 12;case"RRSIG":return 46;case"RP":return 17;case"SIG":return 24;case"SOA":return 6;case"SPF":return 99;case"SRV":return 33;case"SSHFP":return 44;case"TA":return 32768;case"TKEY":return 249;case"TLSA":return 52;case"TSIG":return 250;case"TXT":return 16;case"AXFR":return 252;case"IXFR":return 251;case"OPT":return 41;case"ANY":case"*":return 255}return t.toUpperCase().startsWith("UNKNOWN_")?parseInt(t.slice(8)):0}},_$rcodes_8={toString:function(t){switch(t){case 0:return"NOERROR";case 1:return"FORMERR";case 2:return"SERVFAIL";case 3:return"NXDOMAIN";case 4:return"NOTIMP";case 5:return"REFUSED";case 6:return"YXDOMAIN";case 7:return"YXRRSET";case 8:return"NXRRSET";case 9:return"NOTAUTH";case 10:return"NOTZONE";case 11:return"RCODE_11";case 12:return"RCODE_12";case 13:return"RCODE_13";case 14:return"RCODE_14";case 15:return"RCODE_15"}return"RCODE_"+t},toRcode:function(t){switch(t.toUpperCase()){case"NOERROR":return 0;case"FORMERR":return 1;case"SERVFAIL":return 2;case"NXDOMAIN":return 3;case"NOTIMP":return 4;case"REFUSED":return 5;case"YXDOMAIN":return 6;case"YXRRSET":return 7;case"NXRRSET":return 8;case"NOTAUTH":return 9;case"NOTZONE":return 10;case"RCODE_11":return 11;case"RCODE_12":return 12;case"RCODE_13":return 13;case"RCODE_14":return 14;case"RCODE_15":return 15}return 0}},_$opcodes_6={toString:function(t){switch(t){case 0:return"QUERY";case 1:return"IQUERY";case 2:return"STATUS";case 3:return"OPCODE_3";case 4:return"NOTIFY";case 5:return"UPDATE";case 6:return"OPCODE_6";case 7:return"OPCODE_7";case 8:return"OPCODE_8";case 9:return"OPCODE_9";case 10:return"OPCODE_10";case 11:return"OPCODE_11";case 12:return"OPCODE_12";case 13:return"OPCODE_13";case 14:return"OPCODE_14";case 15:return"OPCODE_15"}return"OPCODE_"+t},toOpcode:function(t){switch(t.toUpperCase()){case"QUERY":return 0;case"IQUERY":return 1;case"STATUS":return 2;case"OPCODE_3":return 3;case"NOTIFY":return 4;case"UPDATE":return 5;case"OPCODE_6":return 6;case"OPCODE_7":return 7;case"OPCODE_8":return 8;case"OPCODE_9":return 9;case"OPCODE_10":return 10;case"OPCODE_11":return 11;case"OPCODE_12":return 12;case"OPCODE_13":return 13;case"OPCODE_14":return 14;case"OPCODE_15":return 15}return 0}},_$classes_4={toString:function(t){switch(t){case 1:return"IN";case 2:return"CS";case 3:return"CH";case 4:return"HS";case 255:return"ANY"}return"UNKNOWN_"+t},toClass:function(t){switch(t.toUpperCase()){case"IN":return 1;case"CS":return 2;case"CH":return 3;case"HS":return 4;case"ANY":return 255}return 0}},_$optioncodes_7={toString:function(t){switch(t){case 1:return"LLQ";case 2:return"UL";case 3:return"NSID";case 5:return"DAU";case 6:return"DHU";case 7:return"N3U";case 8:return"CLIENT_SUBNET";case 9:return"EXPIRE";case 10:return"COOKIE";case 11:return"TCP_KEEPALIVE";case 12:return"PADDING";case 13:return"CHAIN";case 14:return"KEY_TAG";case 26946:return"DEVICEID"}return t<0?null:"OPTION_"+t},toCode:function(t){if(typeof t=="number")return t;if(!t)return-1;switch(t.toUpperCase()){case"OPTION_0":return 0;case"LLQ":return 1;case"UL":return 2;case"NSID":return 3;case"OPTION_4":return 4;case"DAU":return 5;case"DHU":return 6;case"N3U":return 7;case"CLIENT_SUBNET":return 8;case"EXPIRE":return 9;case"COOKIE":return 10;case"TCP_KEEPALIVE":return 11;case"PADDING":return 12;case"CHAIN":return 13;case"KEY_TAG":return 14;case"DEVICEID":return 26946;case"OPTION_65535":return 65535}const e=t.match(/_(\d+)$/);return e?parseInt(e[1],10):-1}},_$index_1={exports:{}},ipCodec=function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decode=function(d,h,y){if(h=~~h,(y=y||d.length-h)===n.size)return n.decode(d,h,y);if(y===o.size)return o.decode(d,h,y);throw Error(`Invalid buffer size needs to be ${n.size} for v4 or ${o.size} for v6.`)},t.encode=function(d,h,y){y=~~y;const k=f(d);return typeof h=="function"&&(h=h(y+k)),k===n.size?n.encode(d,h,y):o.encode(d,h,y)},t.familyOf=function(d){return f(d)===n.size?1:2},t.name=void 0,t.sizeOf=f,t.v6=t.v4=void 0;const e=/^(\d{1,3}\.){3,3}\d{1,3}$/,r=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i,n={name:"v4",size:4,isFormat:d=>e.test(d),encode(d,h,y){y=~~y,h=h||new Uint8Array(y+4);const k=d.length;let A=0;for(let D=0;D<k;){const q=d.charCodeAt(D++);q===46?(h[y++]=A,A=0):A=10*A+(q-48)}return h[y]=A,h},decode:(d,h)=>(h=~~h,`${d[h++]}.${d[h++]}.${d[h++]}.${d[h]}`)};t.v4=n;const o={name:"v6",size:16,isFormat:d=>d.length>0&&r.test(d),encode(d,h,y){let k=16+(y=~~y),A=-1,D=0,q=0,H=!0,z=!1;h=h||new Uint8Array(y+16);for(let Z=0;Z<d.length;Z++){let j=d.charCodeAt(Z);j===58?(H?A!==-1?(y<k&&(h[y]=0),y<k-1&&(h[y+1]=0),y+=2):y<k&&(A=y):(z===!0?(y<k&&(h[y]=q),y++):(y<k&&(h[y]=D>>8),y<k-1&&(h[y+1]=255&D),y+=2),D=0,q=0),H=!0,z=!1):j===46?(y<k&&(h[y]=q),y++,q=0,D=0,H=!1,z=!0):(H=!1,j>=97?j-=87:j>=65?j-=55:q=10*q+(j-=48),D=(D<<4)+j)}if(H===!1)z===!0?(y<k&&(h[y]=q),y++):(y<k&&(h[y]=D>>8),y<k-1&&(h[y+1]=255&D),y+=2);else if(A===0)y<k&&(h[y]=0),y<k-1&&(h[y+1]=0),y+=2;else if(A!==-1){y+=2;for(let Z=Math.min(y-1,k-1);Z>=A+2;Z--)h[Z]=h[Z-2];h[A]=0,h[A+1]=0,A=y}if(A!==y&&A!==-1)for(y>k-2&&(y=k-2);k>A;)h[--k]=y<k&&y>A?h[--y]:0;else for(;y<k;)h[y++]=0;return h},decode(d,h){h=~~h;let y="";for(let k=0;k<16;k+=2)k!==0&&(y+=":"),y+=(d[h+k]<<8|d[h+k+1]).toString(16);return y.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}};function f(d){if(n.isFormat(d))return n.size;if(o.isFormat(d))return o.size;throw Error("Invalid ip address: "+d)}return t.v6=o,t.name="ip","default"in t?t.default:t}({});typeof define=="function"&&define.amd?define([],function(){return ipCodec}):typeof _$index_1.exports=="object"&&(_$index_1.exports=ipCodec),_$index_1=_$index_1.exports;var _$dnsPacket_5={};const Buffer=_$buffer_3({}).Buffer,name=_$dnsPacket_5.name={};name.encode=function(t,e,r,{mail:n=!1}={}){e||(e=Buffer.alloc(name.encodingLength(t))),r||(r=0);const o=r,f=t.replace(/^\.|\.$/gm,"");if(f.length){let d=[];if(n){let h="";f.split(".").forEach(y=>{y.endsWith("\\")?h+=(h.length?".":"")+y.slice(0,-1):d.length===0&&h.length?d.push(h+"."+y):d.push(y)})}else d=f.split(".");for(let h=0;h<d.length;h++){const y=e.write(d[h],r+1);e[r]=y,r+=y+1}}return e[r++]=0,name.encode.bytes=r-o,e},name.encode.bytes=0,name.decode=function(t,e,{mail:r=!1}={}){e||(e=0);const n=[];let o=e,f=0,d=0,h=!1;for(;;){if(e>=t.length)throw new Error("Cannot decode name (buffer overflow)");const y=t[e++];if(d+=h?0:1,y===0)break;if(192&y){if((192&y)!=192)throw new Error("Cannot decode name (bad label)");{if(e+1>t.length)throw new Error("Cannot decode name (buffer overflow)");const k=t.readUInt16BE(e-1)-49152;if(k>=o)throw new Error("Cannot decode name (bad pointer)");e=k,o=k,d+=h?0:1,h=!0}}else{if(e+y>t.length)throw new Error("Cannot decode name (buffer overflow)");if((f+=y+1)>254)throw new Error("Cannot decode name (name too long)");let k=t.toString("utf-8",e,e+y);r&&(k=k.replace(/\./g,"\\.")),n.push(k),e+=y,d+=h?0:y}}return name.decode.bytes=d,n.length===0?".":n.join(".")},name.decode.bytes=0,name.encodingLength=function(t){return t==="."||t===".."?1:Buffer.byteLength(t.replace(/^\.|\.$/gm,""))+2};const string={encode:function(t,e,r){e||(e=Buffer.alloc(string.encodingLength(t))),r||(r=0);const n=e.write(t,r+1);return e[r]=n,string.encode.bytes=n+1,e}};string.encode.bytes=0,string.decode=function(t,e){e||(e=0);const r=t[e],n=t.toString("utf-8",e+1,e+1+r);return string.decode.bytes=r+1,n},string.decode.bytes=0,string.encodingLength=function(t){return Buffer.byteLength(t)+1};const header={encode:function(t,e,r){e||(e=header.encodingLength(t)),r||(r=0);const n=32767&(t.flags||0),o=t.type==="response"?32768:0;return e.writeUInt16BE(t.id||0,r),e.writeUInt16BE(n|o,r+2),e.writeUInt16BE(t.questions.length,r+4),e.writeUInt16BE(t.answers.length,r+6),e.writeUInt16BE(t.authorities.length,r+8),e.writeUInt16BE(t.additionals.length,r+10),e}};header.encode.bytes=12,header.decode=function(t,e){if(e||(e=0),t.length<12)throw new Error("Header must be 12 bytes");const r=t.readUInt16BE(e+2);return{id:t.readUInt16BE(e),type:32768&r?"response":"query",flags:32767&r,flag_qr:(r>>15&1)==1,opcode:_$opcodes_6.toString(r>>11&15),flag_aa:(r>>10&1)==1,flag_tc:(r>>9&1)==1,flag_rd:(r>>8&1)==1,flag_ra:(r>>7&1)==1,flag_z:(r>>6&1)==1,flag_ad:(r>>5&1)==1,flag_cd:(r>>4&1)==1,rcode:_$rcodes_8.toString(15&r),questions:new Array(t.readUInt16BE(e+4)),answers:new Array(t.readUInt16BE(e+6)),authorities:new Array(t.readUInt16BE(e+8)),additionals:new Array(t.readUInt16BE(e+10))}},header.decode.bytes=12,header.encodingLength=function(){return 12};const runknown=_$dnsPacket_5.unknown={};runknown.encode=function(t,e,r){return e||(e=Buffer.alloc(runknown.encodingLength(t))),r||(r=0),e.writeUInt16BE(t.length,r),t.copy(e,r+2),runknown.encode.bytes=t.length+2,e},runknown.encode.bytes=0,runknown.decode=function(t,e){e||(e=0);const r=t.readUInt16BE(e),n=t.slice(e+2,e+2+r);return runknown.decode.bytes=r+2,n},runknown.decode.bytes=0,runknown.encodingLength=function(t){return t.length+2};const rns=_$dnsPacket_5.ns={};rns.encode=function(t,e,r){return e||(e=Buffer.alloc(rns.encodingLength(t))),r||(r=0),name.encode(t,e,r+2),e.writeUInt16BE(name.encode.bytes,r),rns.encode.bytes=name.encode.bytes+2,e},rns.encode.bytes=0,rns.decode=function(t,e){e||(e=0);const r=t.readUInt16BE(e),n=name.decode(t,e+2);return rns.decode.bytes=r+2,n},rns.decode.bytes=0,rns.encodingLength=function(t){return name.encodingLength(t)+2};const rsoa=_$dnsPacket_5.soa={};rsoa.encode=function(t,e,r){e||(e=Buffer.alloc(rsoa.encodingLength(t))),r||(r=0);const n=r;return r+=2,name.encode(t.mname,e,r),r+=name.encode.bytes,name.encode(t.rname,e,r,{mail:!0}),r+=name.encode.bytes,e.writeUInt32BE(t.serial||0,r),r+=4,e.writeUInt32BE(t.refresh||0,r),r+=4,e.writeUInt32BE(t.retry||0,r),r+=4,e.writeUInt32BE(t.expire||0,r),r+=4,e.writeUInt32BE(t.minimum||0,r),r+=4,e.writeUInt16BE(r-n-2,n),rsoa.encode.bytes=r-n,e},rsoa.encode.bytes=0,rsoa.decode=function(t,e){e||(e=0);const r=e,n={};return e+=2,n.mname=name.decode(t,e),e+=name.decode.bytes,n.rname=name.decode(t,e,{mail:!0}),e+=name.decode.bytes,n.serial=t.readUInt32BE(e),e+=4,n.refresh=t.readUInt32BE(e),e+=4,n.retry=t.readUInt32BE(e),e+=4,n.expire=t.readUInt32BE(e),e+=4,n.minimum=t.readUInt32BE(e),e+=4,rsoa.decode.bytes=e-r,n},rsoa.decode.bytes=0,rsoa.encodingLength=function(t){return 22+name.encodingLength(t.mname)+name.encodingLength(t.rname)};const rtxt=_$dnsPacket_5.txt={};rtxt.encode=function(t,e,r){Array.isArray(t)||(t=[t]);for(let o=0;o<t.length;o++)if(typeof t[o]=="string"&&(t[o]=Buffer.from(t[o])),!Buffer.isBuffer(t[o]))throw new Error("Must be a Buffer");e||(e=Buffer.alloc(rtxt.encodingLength(t))),r||(r=0);const n=r;return r+=2,t.forEach(function(o){e[r++]=o.length,o.copy(e,r,0,o.length),r+=o.length}),e.writeUInt16BE(r-n-2,n),rtxt.encode.bytes=r-n,e},rtxt.encode.bytes=0,rtxt.decode=function(t,e){e||(e=0);const r=e;let n=t.readUInt16BE(e);e+=2;let o=[];for(;n>0;){const f=t[e++];if(--n<f)throw new Error("Buffer overflow");o.push(t.slice(e,e+f)),e+=f,n-=f}return rtxt.decode.bytes=e-r,o},rtxt.decode.bytes=0,rtxt.encodingLength=function(t){Array.isArray(t)||(t=[t]);let e=2;return t.forEach(function(r){e+=typeof r=="string"?Buffer.byteLength(r)+1:r.length+1}),e};const rnull=_$dnsPacket_5.null={};rnull.encode=function(t,e,r){e||(e=Buffer.alloc(rnull.encodingLength(t))),r||(r=0),typeof t=="string"&&(t=Buffer.from(t)),t||(t=Buffer.alloc(0));const n=r;r+=2;const o=t.length;return t.copy(e,r,0,o),r+=o,e.writeUInt16BE(r-n-2,n),rnull.encode.bytes=r-n,e},rnull.encode.bytes=0,rnull.decode=function(t,e){e||(e=0);const r=e,n=t.readUInt16BE(e);e+=2;const o=t.slice(e,e+n);return e+=n,rnull.decode.bytes=e-r,o},rnull.decode.bytes=0,rnull.encodingLength=function(t){return t?(Buffer.isBuffer(t)?t.length:Buffer.byteLength(t))+2:2};const rhinfo=_$dnsPacket_5.hinfo={};rhinfo.encode=function(t,e,r){e||(e=Buffer.alloc(rhinfo.encodingLength(t))),r||(r=0);const n=r;return r+=2,string.encode(t.cpu,e,r),r+=string.encode.bytes,string.encode(t.os,e,r),r+=string.encode.bytes,e.writeUInt16BE(r-n-2,n),rhinfo.encode.bytes=r-n,e},rhinfo.encode.bytes=0,rhinfo.decode=function(t,e){e||(e=0);const r=e,n={};return e+=2,n.cpu=string.decode(t,e),e+=string.decode.bytes,n.os=string.decode(t,e),e+=string.decode.bytes,rhinfo.decode.bytes=e-r,n},rhinfo.decode.bytes=0,rhinfo.encodingLength=function(t){return string.encodingLength(t.cpu)+string.encodingLength(t.os)+2};const rptr=_$dnsPacket_5.ptr={},rcname=_$dnsPacket_5.cname=rptr,rdname=_$dnsPacket_5.dname=rptr;rptr.encode=function(t,e,r){return e||(e=Buffer.alloc(rptr.encodingLength(t))),r||(r=0),name.encode(t,e,r+2),e.writeUInt16BE(name.encode.bytes,r),rptr.encode.bytes=name.encode.bytes+2,e},rptr.encode.bytes=0,rptr.decode=function(t,e){e||(e=0);const r=name.decode(t,e+2);return rptr.decode.bytes=name.decode.bytes+2,r},rptr.decode.bytes=0,rptr.encodingLength=function(t){return name.encodingLength(t)+2};const rsrv=_$dnsPacket_5.srv={};rsrv.encode=function(t,e,r){e||(e=Buffer.alloc(rsrv.encodingLength(t))),r||(r=0),e.writeUInt16BE(t.priority||0,r+2),e.writeUInt16BE(t.weight||0,r+4),e.writeUInt16BE(t.port||0,r+6),name.encode(t.target,e,r+8);const n=name.encode.bytes+6;return e.writeUInt16BE(n,r),rsrv.encode.bytes=n+2,e},rsrv.encode.bytes=0,rsrv.decode=function(t,e){e||(e=0);const r=t.readUInt16BE(e),n={};return n.priority=t.readUInt16BE(e+2),n.weight=t.readUInt16BE(e+4),n.port=t.readUInt16BE(e+6),n.target=name.decode(t,e+8),rsrv.decode.bytes=r+2,n},rsrv.decode.bytes=0,rsrv.encodingLength=function(t){return 8+name.encodingLength(t.target)};const rcaa=_$dnsPacket_5.caa={};rcaa.ISSUER_CRITICAL=128,rcaa.encode=function(t,e,r){const n=rcaa.encodingLength(t);return e||(e=Buffer.alloc(rcaa.encodingLength(t))),r||(r=0),t.issuerCritical&&(t.flags=rcaa.ISSUER_CRITICAL),e.writeUInt16BE(n-2,r),r+=2,e.writeUInt8(t.flags||0,r),r+=1,string.encode(t.tag,e,r),r+=string.encode.bytes,e.write(t.value,r),r+=Buffer.byteLength(t.value),rcaa.encode.bytes=n,e},rcaa.encode.bytes=0,rcaa.decode=function(t,e){e||(e=0);const r=t.readUInt16BE(e),n=e+=2,o={};return o.flags=t.readUInt8(e),e+=1,o.tag=string.decode(t,e),e+=string.decode.bytes,o.value=t.toString("utf-8",e,n+r),o.issuerCritical=!!(o.flags&rcaa.ISSUER_CRITICAL),rcaa.decode.bytes=r+2,o},rcaa.decode.bytes=0,rcaa.encodingLength=function(t){return string.encodingLength(t.tag)+string.encodingLength(t.value)+2};const rmx=_$dnsPacket_5.mx={};rmx.encode=function(t,e,r){e||(e=Buffer.alloc(rmx.encodingLength(t))),r||(r=0);const n=r;return r+=2,e.writeUInt16BE(t.preference||0,r),r+=2,name.encode(t.exchange,e,r),r+=name.encode.bytes,e.writeUInt16BE(r-n-2,n),rmx.encode.bytes=r-n,e},rmx.encode.bytes=0,rmx.decode=function(t,e){e||(e=0);const r=e,n={};return e+=2,n.preference=t.readUInt16BE(e),e+=2,n.exchange=name.decode(t,e),e+=name.decode.bytes,rmx.decode.bytes=e-r,n},rmx.encodingLength=function(t){return 4+name.encodingLength(t.exchange)};const ra=_$dnsPacket_5.a={};ra.encode=function(t,e,r){return e||(e=Buffer.alloc(ra.encodingLength(t))),r||(r=0),e.writeUInt16BE(4,r),r+=2,_$index_1.v4.encode(t,e,r),ra.encode.bytes=6,e},ra.encode.bytes=0,ra.decode=function(t,e){e||(e=0),e+=2;const r=_$index_1.v4.decode(t,e);return ra.decode.bytes=6,r},ra.decode.bytes=0,ra.encodingLength=function(){return 6};const raaaa=_$dnsPacket_5.aaaa={};raaaa.encode=function(t,e,r){return e||(e=Buffer.alloc(raaaa.encodingLength(t))),r||(r=0),e.writeUInt16BE(16,r),r+=2,_$index_1.v6.encode(t,e,r),raaaa.encode.bytes=18,e},raaaa.encode.bytes=0,raaaa.decode=function(t,e){e||(e=0),e+=2;const r=_$index_1.v6.decode(t,e);return raaaa.decode.bytes=18,r},raaaa.decode.bytes=0,raaaa.encodingLength=function(){return 18};const roption=_$dnsPacket_5.option={};roption.encode=function(t,e,r){e||(e=Buffer.alloc(roption.encodingLength(t))),r||(r=0);const n=r,o=_$optioncodes_7.toCode(t.code);if(e.writeUInt16BE(o,r),r+=2,t.data)e.writeUInt16BE(t.data.length,r),r+=2,t.data.copy(e,r),r+=t.data.length;else switch(o){case 8:const f=t.sourcePrefixLength||0,d=t.family||_$index_1.familyOf(t.ip),h=_$index_1.encode(t.ip,Buffer.alloc),y=Math.ceil(f/8);e.writeUInt16BE(y+4,r),r+=2,e.writeUInt16BE(d,r),r+=2,e.writeUInt8(f,r++),e.writeUInt8(t.scopePrefixLength||0,r++),h.copy(e,r,0,y),r+=y;break;case 11:t.timeout?(e.writeUInt16BE(2,r),r+=2,e.writeUInt16BE(t.timeout,r),r+=2):(e.writeUInt16BE(0,r),r+=2);break;case 12:const k=t.length||0;e.writeUInt16BE(k,r),r+=2,e.fill(0,r,r+k),r+=k;break;case 14:const A=2*t.tags.length;e.writeUInt16BE(A,r),r+=2;for(const D of t.tags)e.writeUInt16BE(D,r),r+=2;break;default:throw new Error("Unknown roption code: "+t.code)}return roption.encode.bytes=r-n,e},roption.encode.bytes=0,roption.decode=function(t,e){e||(e=0);const r={};r.code=t.readUInt16BE(e),r.type=_$optioncodes_7.toString(r.code),e+=2;const n=t.readUInt16BE(e);switch(e+=2,r.data=t.slice(e,e+n),r.code){case 8:r.family=t.readUInt16BE(e),e+=2,r.sourcePrefixLength=t.readUInt8(e++),r.scopePrefixLength=t.readUInt8(e++);const o=Buffer.alloc(r.family===1?4:16);t.copy(o,0,e,e+n-4),r.ip=_$index_1.decode(o);break;case 11:n>0&&(r.timeout=t.readUInt16BE(e),e+=2);break;case 14:r.tags=[];for(let f=0;f<n;f+=2)r.tags.push(t.readUInt16BE(e)),e+=2}return roption.decode.bytes=n+4,r},roption.decode.bytes=0,roption.encodingLength=function(t){if(t.data)return t.data.length+4;switch(_$optioncodes_7.toCode(t.code)){case 8:const e=t.sourcePrefixLength||0;return Math.ceil(e/8)+8;case 11:return typeof t.timeout=="number"?6:4;case 12:return t.length+4;case 14:return 4+2*t.tags.length}throw new Error("Unknown roption code: "+t.code)};const ropt=_$dnsPacket_5.opt={};ropt.encode=function(t,e,r){e||(e=Buffer.alloc(ropt.encodingLength(t))),r||(r=0);const n=r,o=encodingLengthList(t,roption);return e.writeUInt16BE(o,r),r=encodeList(t,roption,e,r+2),ropt.encode.bytes=r-n,e},ropt.encode.bytes=0,ropt.decode=function(t,e){e||(e=0);const r=e,n=[];let o=t.readUInt16BE(e);e+=2;let f=0;for(;o>0;)n[f++]=roption.decode(t,e),e+=roption.decode.bytes,o-=roption.decode.bytes;return ropt.decode.bytes=e-r,n},ropt.decode.bytes=0,ropt.encodingLength=function(t){return 2+encodingLengthList(t||[],roption)};const rdnskey=_$dnsPacket_5.dnskey={};rdnskey.PROTOCOL_DNSSEC=3,rdnskey.ZONE_KEY=128,rdnskey.SECURE_ENTRYPOINT=32768,rdnskey.encode=function(t,e,r){e||(e=Buffer.alloc(rdnskey.encodingLength(t))),r||(r=0);const n=r,o=t.key;if(!Buffer.isBuffer(o))throw new Error("Key must be a Buffer");return r+=2,e.writeUInt16BE(t.flags,r),r+=2,e.writeUInt8(rdnskey.PROTOCOL_DNSSEC,r),r+=1,e.writeUInt8(t.algorithm,r),r+=1,o.copy(e,r,0,o.length),r+=o.length,rdnskey.encode.bytes=r-n,e.writeUInt16BE(rdnskey.encode.bytes-2,n),e},rdnskey.encode.bytes=0,rdnskey.decode=function(t,e){e||(e=0);const r=e;var n={},o=t.readUInt16BE(e);if(e+=2,n.flags=t.readUInt16BE(e),e+=2,t.readUInt8(e)!==rdnskey.PROTOCOL_DNSSEC)throw new Error("Protocol must be 3");return e+=1,n.algorithm=t.readUInt8(e),e+=1,n.key=t.slice(e,r+o+2),e+=n.key.length,rdnskey.decode.bytes=e-r,n},rdnskey.decode.bytes=0,rdnskey.encodingLength=function(t){return 6+Buffer.byteLength(t.key)};const rrrsig=_$dnsPacket_5.rrsig={};rrrsig.encode=function(t,e,r){e||(e=Buffer.alloc(rrrsig.encodingLength(t))),r||(r=0);const n=r,o=t.signature;if(!Buffer.isBuffer(o))throw new Error("Signature must be a Buffer");return r+=2,e.writeUInt16BE(_$types_9.toType(t.typeCovered),r),r+=2,e.writeUInt8(t.algorithm,r),r+=1,e.writeUInt8(t.labels,r),r+=1,e.writeUInt32BE(t.originalTTL,r),r+=4,e.writeUInt32BE(t.expiration,r),r+=4,e.writeUInt32BE(t.inception,r),r+=4,e.writeUInt16BE(t.keyTag,r),r+=2,name.encode(t.signersName,e,r),r+=name.encode.bytes,o.copy(e,r,0,o.length),r+=o.length,rrrsig.encode.bytes=r-n,e.writeUInt16BE(rrrsig.encode.bytes-2,n),e},rrrsig.encode.bytes=0,rrrsig.decode=function(t,e){e||(e=0);const r=e;var n={},o=t.readUInt16BE(e);return e+=2,n.typeCovered=_$types_9.toString(t.readUInt16BE(e)),e+=2,n.algorithm=t.readUInt8(e),e+=1,n.labels=t.readUInt8(e),e+=1,n.originalTTL=t.readUInt32BE(e),e+=4,n.expiration=t.readUInt32BE(e),e+=4,n.inception=t.readUInt32BE(e),e+=4,n.keyTag=t.readUInt16BE(e),e+=2,n.signersName=name.decode(t,e),e+=name.decode.bytes,n.signature=t.slice(e,r+o+2),e+=n.signature.length,rrrsig.decode.bytes=e-r,n},rrrsig.decode.bytes=0,rrrsig.encodingLength=function(t){return 20+name.encodingLength(t.signersName)+Buffer.byteLength(t.signature)};const rrp=_$dnsPacket_5.rp={};rrp.encode=function(t,e,r){e||(e=Buffer.alloc(rrp.encodingLength(t))),r||(r=0);const n=r;return r+=2,name.encode(t.mbox||".",e,r,{mail:!0}),r+=name.encode.bytes,name.encode(t.txt||".",e,r),r+=name.encode.bytes,rrp.encode.bytes=r-n,e.writeUInt16BE(rrp.encode.bytes-2,n),e},rrp.encode.bytes=0,rrp.decode=function(t,e){e||(e=0);const r=e,n={};return e+=2,n.mbox=name.decode(t,e,{mail:!0})||".",e+=name.decode.bytes,n.txt=name.decode(t,e)||".",e+=name.decode.bytes,rrp.decode.bytes=e-r,n},rrp.decode.bytes=0,rrp.encodingLength=function(t){return 2+name.encodingLength(t.mbox||".")+name.encodingLength(t.txt||".")};const typebitmap={encode:function(t,e,r){e||(e=Buffer.alloc(typebitmap.encodingLength(t))),r||(r=0);const n=r;for(var o=[],f=0;f<t.length;f++){var d=_$types_9.toType(t[f]);o[d>>8]===void 0&&(o[d>>8]=[]),o[d>>8][d>>3&31]|=1<<7-(7&d)}for(f=0;f<o.length;f++)if(o[f]!==void 0){var h=Buffer.from(o[f]);e.writeUInt8(f,r),r+=1,e.writeUInt8(h.length,r),r+=1,h.copy(e,r),r+=h.length}return typebitmap.encode.bytes=r-n,e}};typebitmap.encode.bytes=0,typebitmap.decode=function(t,e,r){e||(e=0);const n=e;for(var o=[];e-n<r;){var f=t.readUInt8(e);e+=1;var d=t.readUInt8(e);e+=1;for(var h=0;h<d;h++)for(var y=t.readUInt8(e+h),k=0;k<8;k++)if(y&1<<7-k){var A=_$types_9.toString(f<<8|h<<3|k);o.push(A)}e+=d}return typebitmap.decode.bytes=e-n,o},typebitmap.decode.bytes=0,typebitmap.encodingLength=function(t){for(var e=[],r=0;r<t.length;r++){var n=_$types_9.toType(t[r]);e[n>>8]=Math.max(e[n>>8]||0,255&n)}var o=0;for(r=0;r<e.length;r++)e[r]!==void 0&&(o+=2+Math.ceil((e[r]+1)/8));return o};const rnsec=_$dnsPacket_5.nsec={};rnsec.encode=function(t,e,r){e||(e=Buffer.alloc(rnsec.encodingLength(t))),r||(r=0);const n=r;return r+=2,name.encode(t.nextDomain,e,r),r+=name.encode.bytes,typebitmap.encode(t.rrtypes,e,r),r+=typebitmap.encode.bytes,rnsec.encode.bytes=r-n,e.writeUInt16BE(rnsec.encode.bytes-2,n),e},rnsec.encode.bytes=0,rnsec.decode=function(t,e){e||(e=0);const r=e;var n={},o=t.readUInt16BE(e);return e+=2,n.nextDomain=name.decode(t,e),e+=name.decode.bytes,n.rrtypes=typebitmap.decode(t,e,o-(e-r)),e+=typebitmap.decode.bytes,rnsec.decode.bytes=e-r,n},rnsec.decode.bytes=0,rnsec.encodingLength=function(t){return 2+name.encodingLength(t.nextDomain)+typebitmap.encodingLength(t.rrtypes)};const rnsec3=_$dnsPacket_5.nsec3={};rnsec3.encode=function(t,e,r){e||(e=Buffer.alloc(rnsec3.encodingLength(t))),r||(r=0);const n=r,o=t.salt;if(!Buffer.isBuffer(o))throw new Error("salt must be a Buffer");const f=t.nextDomain;if(!Buffer.isBuffer(f))throw new Error("nextDomain must be a Buffer");return r+=2,e.writeUInt8(t.algorithm,r),r+=1,e.writeUInt8(t.flags,r),r+=1,e.writeUInt16BE(t.iterations,r),r+=2,e.writeUInt8(o.length,r),r+=1,o.copy(e,r,0,o.length),r+=o.length,e.writeUInt8(f.length,r),r+=1,f.copy(e,r,0,f.length),r+=f.length,typebitmap.encode(t.rrtypes,e,r),r+=typebitmap.encode.bytes,rnsec3.encode.bytes=r-n,e.writeUInt16BE(rnsec3.encode.bytes-2,n),e},rnsec3.encode.bytes=0,rnsec3.decode=function(t,e){e||(e=0);const r=e;var n={},o=t.readUInt16BE(e);e+=2,n.algorithm=t.readUInt8(e),e+=1,n.flags=t.readUInt8(e),e+=1,n.iterations=t.readUInt16BE(e),e+=2;const f=t.readUInt8(e);e+=1,n.salt=t.slice(e,e+f),e+=f;const d=t.readUInt8(e);return e+=1,n.nextDomain=t.slice(e,e+d),e+=d,n.rrtypes=typebitmap.decode(t,e,o-(e-r)),e+=typebitmap.decode.bytes,rnsec3.decode.bytes=e-r,n},rnsec3.decode.bytes=0,rnsec3.encodingLength=function(t){return 8+t.salt.length+t.nextDomain.length+typebitmap.encodingLength(t.rrtypes)};const rds=_$dnsPacket_5.ds={};rds.encode=function(t,e,r){e||(e=Buffer.alloc(rds.encodingLength(t))),r||(r=0);const n=r,o=t.digest;if(!Buffer.isBuffer(o))throw new Error("Digest must be a Buffer");return r+=2,e.writeUInt16BE(t.keyTag,r),r+=2,e.writeUInt8(t.algorithm,r),r+=1,e.writeUInt8(t.digestType,r),r+=1,o.copy(e,r,0,o.length),r+=o.length,rds.encode.bytes=r-n,e.writeUInt16BE(rds.encode.bytes-2,n),e},rds.encode.bytes=0,rds.decode=function(t,e){e||(e=0);const r=e;var n={},o=t.readUInt16BE(e);return e+=2,n.keyTag=t.readUInt16BE(e),e+=2,n.algorithm=t.readUInt8(e),e+=1,n.digestType=t.readUInt8(e),e+=1,n.digest=t.slice(e,r+o+2),e+=n.digest.length,rds.decode.bytes=e-r,n},rds.decode.bytes=0,rds.encodingLength=function(t){return 6+Buffer.byteLength(t.digest)};const rsshfp=_$dnsPacket_5.sshfp={};rsshfp.getFingerprintLengthForHashType=function(t){switch(t){case 1:return 20;case 2:return 32}},rsshfp.encode=function(t,e,r){e||(e=Buffer.alloc(rsshfp.encodingLength(t))),r||(r=0);const n=r;e[r+=2]=t.algorithm,e[r+=1]=t.hash,r+=1;const o=Buffer.from(t.fingerprint.toUpperCase(),"hex");if(o.length!==rsshfp.getFingerprintLengthForHashType(t.hash))throw new Error("Invalid fingerprint length");return o.copy(e,r),r+=o.byteLength,rsshfp.encode.bytes=r-n,e.writeUInt16BE(rsshfp.encode.bytes-2,n),e},rsshfp.encode.bytes=0,rsshfp.decode=function(t,e){e||(e=0);const r=e,n={};e+=2,n.algorithm=t[e],e+=1,n.hash=t[e],e+=1;const o=rsshfp.getFingerprintLengthForHashType(n.hash);return n.fingerprint=t.slice(e,e+o).toString("hex").toUpperCase(),e+=o,rsshfp.decode.bytes=e-r,n},rsshfp.decode.bytes=0,rsshfp.encodingLength=function(t){return 4+Buffer.from(t.fingerprint,"hex").byteLength};const rnaptr=_$dnsPacket_5.naptr={};rnaptr.encode=function(t,e,r){e||(e=Buffer.alloc(rnaptr.encodingLength(t))),r||(r=0);const n=r;return r+=2,e.writeUInt16BE(t.order||0,r),r+=2,e.writeUInt16BE(t.preference||0,r),r+=2,string.encode(t.flags,e,r),r+=string.encode.bytes,string.encode(t.services,e,r),r+=string.encode.bytes,string.encode(t.regexp,e,r),r+=string.encode.bytes,name.encode(t.replacement,e,r),r+=name.encode.bytes,rnaptr.encode.bytes=r-n,e.writeUInt16BE(rnaptr.encode.bytes-2,n),e},rnaptr.encode.bytes=0,rnaptr.decode=function(t,e){e||(e=0);const r=e,n={};return e+=2,n.order=t.readUInt16BE(e),e+=2,n.preference=t.readUInt16BE(e),e+=2,n.flags=string.decode(t,e),e+=string.decode.bytes,n.services=string.decode(t,e),e+=string.decode.bytes,n.regexp=string.decode(t,e),e+=string.decode.bytes,n.replacement=name.decode(t,e),e+=name.decode.bytes,rnaptr.decode.bytes=e-r,n},rnaptr.decode.bytes=0,rnaptr.encodingLength=function(t){return string.encodingLength(t.flags)+string.encodingLength(t.services)+string.encodingLength(t.regexp)+name.encodingLength(t.replacement)+6};const rtlsa=_$dnsPacket_5.tlsa={};rtlsa.encode=function(t,e,r){e||(e=Buffer.alloc(rtlsa.encodingLength(t))),r||(r=0);const n=r,o=t.certificate;if(!Buffer.isBuffer(o))throw new Error("Certificate must be a Buffer");return r+=2,e.writeUInt8(t.usage,r),r+=1,e.writeUInt8(t.selector,r),r+=1,e.writeUInt8(t.matchingType,r),r+=1,o.copy(e,r,0,o.length),r+=o.length,rtlsa.encode.bytes=r-n,e.writeUInt16BE(rtlsa.encode.bytes-2,n),e},rtlsa.encode.bytes=0,rtlsa.decode=function(t,e){e||(e=0);const r=e,n={},o=t.readUInt16BE(e);return e+=2,n.usage=t.readUInt8(e),e+=1,n.selector=t.readUInt8(e),e+=1,n.matchingType=t.readUInt8(e),e+=1,n.certificate=t.slice(e,r+o+2),e+=n.certificate.length,rtlsa.decode.bytes=e-r,n},rtlsa.decode.bytes=0,rtlsa.encodingLength=function(t){return 5+Buffer.byteLength(t.certificate)};const renc=_$dnsPacket_5.record=function(t){switch(t.toUpperCase()){case"A":return ra;case"PTR":return rptr;case"CNAME":return rcname;case"DNAME":return rdname;case"TXT":return rtxt;case"NULL":return rnull;case"AAAA":return raaaa;case"SRV":return rsrv;case"HINFO":return rhinfo;case"CAA":return rcaa;case"NS":return rns;case"SOA":return rsoa;case"MX":return rmx;case"OPT":return ropt;case"DNSKEY":return rdnskey;case"RRSIG":return rrrsig;case"RP":return rrp;case"NSEC":return rnsec;case"NSEC3":return rnsec3;case"SSHFP":return rsshfp;case"DS":return rds;case"NAPTR":return rnaptr;case"TLSA":return rtlsa}return runknown},answer=_$dnsPacket_5.answer={};answer.encode=function(t,e,r){e||(e=Buffer.alloc(answer.encodingLength(t))),r||(r=0);const n=r;if(name.encode(t.name,e,r),r+=name.encode.bytes,e.writeUInt16BE(_$types_9.toType(t.type),r),t.type.toUpperCase()==="OPT"){if(t.name!==".")throw new Error("OPT name must be root.");e.writeUInt16BE(t.udpPayloadSize||4096,r+2),e.writeUInt8(t.extendedRcode||0,r+4),e.writeUInt8(t.ednsVersion||0,r+5),e.writeUInt16BE(t.flags||0,r+6),r+=8,ropt.encode(t.options||[],e,r),r+=ropt.encode.bytes}else{let o=_$classes_4.toClass(t.class===void 0?"IN":t.class);t.flush&&(o|=32768),e.writeUInt16BE(o,r+2),e.writeUInt32BE(t.ttl||0,r+4),r+=8;const f=renc(t.type);f.encode(t.data,e,r),r+=f.encode.bytes}return answer.encode.bytes=r-n,e},answer.encode.bytes=0,answer.decode=function(t,e){e||(e=0);const r={},n=e;if(r.name=name.decode(t,e),e+=name.decode.bytes,r.type=_$types_9.toString(t.readUInt16BE(e)),r.type==="OPT")r.udpPayloadSize=t.readUInt16BE(e+2),r.extendedRcode=t.readUInt8(e+4),r.ednsVersion=t.readUInt8(e+5),r.flags=t.readUInt16BE(e+6),r.flag_do=(r.flags>>15&1)==1,r.options=ropt.decode(t,e+8),e+=8+ropt.decode.bytes;else{const o=t.readUInt16BE(e+2);r.ttl=t.readUInt32BE(e+4),r.class=_$classes_4.toString(-32769&o),r.flush=!!(32768&o);const f=renc(r.type);r.data=f.decode(t,e+8),e+=8+f.decode.bytes}return answer.decode.bytes=e-n,r},answer.decode.bytes=0,answer.encodingLength=function(t){const e=t.data!==null&&t.data!==void 0?t.data:t.options;return name.encodingLength(t.name)+8+renc(t.type).encodingLength(e)};const question=_$dnsPacket_5.question={};function encodingLengthList(t,e){let r=0;for(let n=0;n<t.length;n++)r+=e.encodingLength(t[n]);return r}function encodeList(t,e,r,n){for(let o=0;o<t.length;o++)e.encode(t[o],r,n),n+=e.encode.bytes;return n}function decodeList(t,e,r,n){for(let o=0;o<t.length;o++)t[o]=e.decode(r,n),n+=e.decode.bytes;return n}question.encode=function(t,e,r){e||(e=Buffer.alloc(question.encodingLength(t))),r||(r=0);const n=r;return name.encode(t.name,e,r),r+=name.encode.bytes,e.writeUInt16BE(_$types_9.toType(t.type),r),r+=2,e.writeUInt16BE(_$classes_4.toClass(t.class===void 0?"IN":t.class),r),r+=2,question.encode.bytes=r-n,t},question.encode.bytes=0,question.decode=function(t,e){e||(e=0);const r=e,n={};return n.name=name.decode(t,e),e+=name.decode.bytes,n.type=_$types_9.toString(t.readUInt16BE(e)),e+=2,n.class=_$classes_4.toString(t.readUInt16BE(e)),e+=2,32768&n.class&&(n.class&=-32769),question.decode.bytes=e-r,n},question.decode.bytes=0,question.encodingLength=function(t){return name.encodingLength(t.name)+4},_$dnsPacket_5.AUTHORITATIVE_ANSWER=1024,_$dnsPacket_5.TRUNCATED_RESPONSE=512,_$dnsPacket_5.RECURSION_DESIRED=256,_$dnsPacket_5.RECURSION_AVAILABLE=128,_$dnsPacket_5.AUTHENTIC_DATA=32,_$dnsPacket_5.CHECKING_DISABLED=16,_$dnsPacket_5.DNSSEC_OK=32768,_$dnsPacket_5.encode=function(t,e,r){const n=!e;n&&(e=Buffer.alloc(_$dnsPacket_5.encodingLength(t))),r||(r=0);const o=r;return t.questions||(t.questions=[]),t.answers||(t.answers=[]),t.authorities||(t.authorities=[]),t.additionals||(t.additionals=[]),header.encode(t,e,r),r+=header.encode.bytes,r=encodeList(t.questions,question,e,r),r=encodeList(t.answers,answer,e,r),r=encodeList(t.authorities,answer,e,r),r=encodeList(t.additionals,answer,e,r),_$dnsPacket_5.encode.bytes=r-o,n&&_$dnsPacket_5.encode.bytes!==e.length?e.slice(0,_$dnsPacket_5.encode.bytes):e},_$dnsPacket_5.encode.bytes=0,_$dnsPacket_5.decode=function(t,e){e||(e=0);const r=e,n=header.decode(t,e);return e+=header.decode.bytes,e=decodeList(n.questions,question,t,e),e=decodeList(n.answers,answer,t,e),e=decodeList(n.authorities,answer,t,e),e=decodeList(n.additionals,answer,t,e),_$dnsPacket_5.decode.bytes=e-r,n},_$dnsPacket_5.decode.bytes=0,_$dnsPacket_5.encodingLength=function(t){return header.encodingLength(t)+encodingLengthList(t.questions||[],question)+encodingLengthList(t.answers||[],answer)+encodingLengthList(t.authorities||[],answer)+encodingLengthList(t.additionals||[],answer)},_$dnsPacket_5.streamEncode=function(t){const e=_$dnsPacket_5.encode(t),r=Buffer.alloc(2);r.writeUInt16BE(e.byteLength);const n=Buffer.concat([r,e]);return _$dnsPacket_5.streamEncode.bytes=n.byteLength,n},_$dnsPacket_5.streamEncode.bytes=0,_$dnsPacket_5.streamDecode=function(t){const e=t.readUInt16BE(0);if(t.byteLength<e+2)return null;const r=_$dnsPacket_5.decode(t.slice(2));return _$dnsPacket_5.streamDecode.bytes=_$dnsPacket_5.decode.bytes,r},_$dnsPacket_5.streamDecode.bytes=0;var _$dns_134={};Object.defineProperty(_$dns_134,"__esModule",{value:!0}),_$dns_134.doh=function(t){return _doh.apply(this,arguments)};var ___app_134=___interopRequireDefault_134(_$app_87),_dnsPacket=___interopRequireDefault_134(_$dnsPacket_5),_buffer=_$buffer_3({});function ___interopRequireDefault_134(t){return t&&t.__esModule?t:{default:t}}function ___typeof_134(t){return(___typeof_134=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function ___regeneratorRuntime_134(){___regeneratorRuntime_134=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=typeof Symbol=="function"?Symbol:{},o=n.iterator||"@@iterator",f=n.asyncIterator||"@@asyncIterator",d=n.toStringTag||"@@toStringTag";function h(l,s,b){return Object.defineProperty(l,s,{value:b,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,b,$){return s[b]=$}}function y(l,s,b,$){var E=s&&s.prototype instanceof D?s:D,rt=Object.create(E.prototype),_t=new ft($||[]);return rt._invoke=function(xt,St,x){var N="suspendedStart";return function(V,S){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(V==="throw")throw S;return{value:void 0,done:!0}}for(x.method=V,x.arg=S;;){var C=x.delegate;if(C){var T=tt(C,x);if(T){if(T===A)continue;return T}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var M=k(xt,St,x);if(M.type==="normal"){if(N=x.done?"completed":"suspendedYield",M.arg===A)continue;return{value:M.arg,done:x.done}}M.type==="throw"&&(N="completed",x.method="throw",x.arg=M.arg)}}}(l,b,_t),rt}function k(l,s,b){try{return{type:"normal",arg:l.call(s,b)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var A={};function D(){}function q(){}function H(){}var z={};h(z,o,function(){return this});var Z=Object.getPrototypeOf,j=Z&&Z(Z(yt([])));j&&j!==e&&r.call(j,o)&&(z=j);var at=H.prototype=D.prototype=Object.create(z);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(b){return this._invoke(s,b)})})}function ot(l,s){var b;this._invoke=function($,E){function rt(){return new s(function(_t,xt){(function St(x,N,V,S){var C=k(l[x],l,N);if(C.type!=="throw"){var T=C.arg,M=T.value;return M&&___typeof_134(M)=="object"&&r.call(M,"__await")?s.resolve(M.__await).then(function(et){St("next",et,V,S)},function(et){St("throw",et,V,S)}):s.resolve(M).then(function(et){T.value=et,V(T)},function(et){return St("throw",et,V,S)})}S(C.arg)})($,E,_t,xt)})}return b=b?b.then(rt,rt):rt()}}function tt(l,s){var b=l.iterator[s.method];if(b===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,tt(l,s),s.method==="throw"))return A;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var $=k(b,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,A;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,A):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,A)}function gt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function wt(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function ft(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(gt,this),this.reset(!0)}function yt(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var b=-1,$=function E(){for(;++b<l.length;)if(r.call(l,b))return E.value=l[b],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:Ct}}function Ct(){return{value:void 0,done:!0}}return q.prototype=H,h(at,"constructor",H),h(H,"constructor",q),q.displayName=h(H,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===q||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,H):(l.__proto__=H,h(l,d,"GeneratorFunction")),l.prototype=Object.create(at),l},t.awrap=function(l){return{__await:l}},ct(ot.prototype),h(ot.prototype,f,function(){return this}),t.AsyncIterator=ot,t.async=function(l,s,b,$,E){E===void 0&&(E=Promise);var rt=new ot(y(l,s,b,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(_t){return _t.done?_t.value:rt.next()})},ct(at),h(at,d,"Generator"),h(at,o,function(){return this}),h(at,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var b in l)s.push(b);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=yt,ft.prototype={constructor:ft,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(wt),!l)for(var s in this)s.charAt(0)==="t"&&r.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function b(St,x){return rt.type="throw",rt.arg=l,s.next=St,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return b("end");if(E.tryLoc<=this.prev){var _t=r.call(E,"catchLoc"),xt=r.call(E,"finallyLoc");if(_t&&xt){if(this.prev<E.catchLoc)return b(E.catchLoc,!0);if(this.prev<E.finallyLoc)return b(E.finallyLoc)}else if(_t){if(this.prev<E.catchLoc)return b(E.catchLoc,!0)}else{if(!xt)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return b(E.finallyLoc)}}}},abrupt:function(l,s){for(var b=this.tryEntries.length-1;b>=0;--b){var $=this.tryEntries[b];if($.tryLoc<=this.prev&&r.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,A):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),A},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.finallyLoc===l)return this.complete(b.completion,b.afterLoc),wt(b),A}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.tryLoc===l){var $=b.completion;if($.type==="throw"){var E=$.arg;wt(b)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,b){return this.delegate={iterator:yt(l),resultName:s,nextLoc:b},this.method==="next"&&(this.arg=void 0),A}},t}function __asyncGeneratorStep_134(t,e,r,n,o,f,d){try{var h=t[f](d),y=h.value}catch(k){return void r(k)}h.done?e(y):Promise.resolve(y).then(n,o)}function _doh(){var t;return t=___regeneratorRuntime_134().mark(function e(r){var n,o,f,d,h,y,k,A;return ___regeneratorRuntime_134().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return n=r.url,o=r.domain,f=r.type,d=f===void 0?"A":f,h=r.timeout,y=r.edns,k=_dnsPacket.default.encode({type:"query",id:0,flags:_dnsPacket.default.RECURSION_DESIRED,questions:[{type:d,name:o}],additionals:[{type:"OPT",name:".",udpPayloadSize:4096,flags:0,options:[{code:"CLIENT_SUBNET",ip:y,sourcePrefixLength:(0,_$utils_141.isIPv4)(y)?24:56,scopePrefixLength:0}]}]}),D.next=4,___app_134.default.http.get({url:"".concat(n,"?dns=").concat(k.toString("base64").toString("utf-8").replace(/=/g,"")),headers:{Accept:"application/dns-message"},"binary-mode":!0,encoding:null,timeout:h});case 4:return A=D.sent,D.abrupt("return",_dnsPacket.default.decode(_buffer.Buffer.from(___app_134.default.env.isQX?A.bodyBytes:A.body)));case 6:case"end":return D.stop()}},e)}),(_doh=function(){var e=this,r=arguments;return new Promise(function(n,o){var f=t.apply(e,r);function d(y){__asyncGeneratorStep_134(f,n,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_134(f,n,o,d,h,"throw",y)}d(void 0)})}).apply(this,arguments)}var _$lodash_53={exports:{}};(function(t){(function(){(function(){var e="Expected a function",r="__lodash_placeholder__",n=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],o="[object Arguments]",f="[object Array]",d="[object Boolean]",h="[object Date]",y="[object Error]",k="[object Function]",A="[object GeneratorFunction]",D="[object Map]",q="[object Number]",H="[object Object]",z="[object RegExp]",Z="[object Set]",j="[object String]",at="[object Symbol]",ct="[object WeakMap]",ot="[object ArrayBuffer]",tt="[object DataView]",gt="[object Float32Array]",wt="[object Float64Array]",ft="[object Int8Array]",yt="[object Int16Array]",Ct="[object Int32Array]",l="[object Uint8Array]",s="[object Uint16Array]",b="[object Uint32Array]",$=/\b__p \+= '';/g,E=/\b(__p \+=) '' \+/g,rt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,_t=/&(?:amp|lt|gt|quot|#39);/g,xt=/[&<>"']/g,St=RegExp(_t.source),x=RegExp(xt.source),N=/<%-([\s\S]+?)%>/g,V=/<%([\s\S]+?)%>/g,S=/<%=([\s\S]+?)%>/g,C=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,T=/^\w*$/,M=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,et=/[\\^$.*+?()[\]{}|]/g,Pt=RegExp(et.source),Ut=/^\s+/,Zt=/\s/,_e=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,me=/\{\n\/\* \[wrapped with (.+)\] \*/,de=/,? & /,Xt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Gt=/[()=,{}\[\]\/\s]/,pe=/\\(\\)?/g,ge=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Dt=/\w*$/,Nt=/^[-+]0x[0-9a-f]+$/i,ie=/^0b[01]+$/i,ee=/^\[object .+?Constructor\]$/,Kt=/^0o[0-7]+$/i,be=/^(?:0|[1-9]\d*)$/,v=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Be=/($^)/,ce=/['\n\r\u2028\u2029\\]/g,Vt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ze="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",We="["+ze+"]",Je="["+Vt+"]",nr="\\d+",lr="[a-z\\xdf-\\xf6\\xf8-\\xff]",ur="[^\\ud800-\\udfff"+ze+nr+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",Me="\\ud83c[\\udffb-\\udfff]",Ke="[^\\ud800-\\udfff]",Ir="(?:\\ud83c[\\udde6-\\uddff]){2}",Le="[\\ud800-\\udbff][\\udc00-\\udfff]",qr="[A-Z\\xc0-\\xd6\\xd8-\\xde]",hr="(?:"+lr+"|"+ur+")",Sr="(?:"+qr+"|"+ur+")",Jr="(?:"+Je+"|"+Me+")?",Kr="[\\ufe0e\\ufe0f]?"+Jr+"(?:\\u200d(?:"+[Ke,Ir,Le].join("|")+")[\\ufe0e\\ufe0f]?"+Jr+")*",tr="(?:"+["[\\u2700-\\u27bf]",Ir,Le].join("|")+")"+Kr,Xe="(?:"+[Ke+Je+"?",Je,Ir,Le,"[\\ud800-\\udfff]"].join("|")+")",Qe=RegExp("['\u2019]","g"),an=RegExp(Je,"g"),Gr=RegExp(Me+"(?="+Me+")|"+Xe+Kr,"g"),Vr=RegExp([qr+"?"+lr+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?="+[We,qr,"$"].join("|")+")",Sr+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?="+[We,qr+hr,"$"].join("|")+")",qr+"?"+hr+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?",qr+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",nr,tr].join("|"),"g"),Yr=RegExp("[\\u200d\\ud800-\\udfff"+Vt+"\\ufe0e\\ufe0f]"),Xr=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,sn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],se=-1,ye={};ye[gt]=ye[wt]=ye[ft]=ye[yt]=ye[Ct]=ye[l]=ye["[object Uint8ClampedArray]"]=ye[s]=ye[b]=!0,ye[o]=ye[f]=ye[ot]=ye[d]=ye[tt]=ye[h]=ye[y]=ye[k]=ye[D]=ye[q]=ye[H]=ye[z]=ye[Z]=ye[j]=ye[ct]=!1;var Re={};Re[o]=Re[f]=Re[ot]=Re[tt]=Re[d]=Re[h]=Re[gt]=Re[wt]=Re[ft]=Re[yt]=Re[Ct]=Re[D]=Re[q]=Re[H]=Re[z]=Re[Z]=Re[j]=Re[at]=Re[l]=Re["[object Uint8ClampedArray]"]=Re[s]=Re[b]=!0,Re[y]=Re[k]=Re[ct]=!1;var ar={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},he=parseFloat,Zr=parseInt,Ar=typeof t=="object"&&t&&t.Object===Object&&t,un=typeof self=="object"&&self&&self.Object===Object&&self,or=Ar||un||Function("return this")(),J=typeof _$lodash_53.exports=="object"&&_$lodash_53.exports&&!_$lodash_53.exports.nodeType&&_$lodash_53.exports,xe=J&&_$lodash_53&&!_$lodash_53.nodeType&&_$lodash_53,Tr=xe&&xe.exports===J,gr=Tr&&Ar.process,Ge=function(){try{return xe&&xe.require&&xe.require("util").types||gr&&gr.binding&&gr.binding("util")}catch{}}(),Lt=Ge&&Ge.isArrayBuffer,sr=Ge&&Ge.isDate,_n=Ge&&Ge.isMap,Ie=Ge&&Ge.isRegExp,fr=Ge&&Ge.isSet,Ue=Ge&&Ge.isTypedArray;function Yt(Et,kt,Tt){switch(Tt.length){case 0:return Et.call(kt);case 1:return Et.call(kt,Tt[0]);case 2:return Et.call(kt,Tt[0],Tt[1]);case 3:return Et.call(kt,Tt[0],Tt[1],Tt[2])}return Et.apply(kt,Tt)}function Te(Et,kt,Tt,Qt){for(var le=-1,$e=Et==null?0:Et.length;++le<$e;){var pr=Et[le];kt(Qt,pr,Tt(pr),Et)}return Qt}function Jt(Et,kt){for(var Tt=-1,Qt=Et==null?0:Et.length;++Tt<Qt&&kt(Et[Tt],Tt,Et)!==!1;);return Et}function jn(Et,kt){for(var Tt=Et==null?0:Et.length;Tt--&&kt(Et[Tt],Tt,Et)!==!1;);return Et}function Pn(Et,kt){for(var Tt=-1,Qt=Et==null?0:Et.length;++Tt<Qt;)if(!kt(Et[Tt],Tt,Et))return!1;return!0}function Ee(Et,kt){for(var Tt=-1,Qt=Et==null?0:Et.length,le=0,$e=[];++Tt<Qt;){var pr=Et[Tt];kt(pr,Tt,Et)&&($e[le++]=pr)}return $e}function a(Et,kt){return!(Et==null||!Et.length)&&K(Et,kt,0)>-1}function u(Et,kt,Tt){for(var Qt=-1,le=Et==null?0:Et.length;++Qt<le;)if(Tt(kt,Et[Qt]))return!0;return!1}function p(Et,kt){for(var Tt=-1,Qt=Et==null?0:Et.length,le=Array(Qt);++Tt<Qt;)le[Tt]=kt(Et[Tt],Tt,Et);return le}function g(Et,kt){for(var Tt=-1,Qt=kt.length,le=Et.length;++Tt<Qt;)Et[le+Tt]=kt[Tt];return Et}function m(Et,kt,Tt,Qt){var le=-1,$e=Et==null?0:Et.length;for(Qt&&$e&&(Tt=Et[++le]);++le<$e;)Tt=kt(Tt,Et[le],le,Et);return Tt}function w(Et,kt,Tt,Qt){var le=Et==null?0:Et.length;for(Qt&&le&&(Tt=Et[--le]);le--;)Tt=kt(Tt,Et[le],le,Et);return Tt}function F(Et,kt){for(var Tt=-1,Qt=Et==null?0:Et.length;++Tt<Qt;)if(kt(Et[Tt],Tt,Et))return!0;return!1}var R=W("length");function P(Et,kt,Tt){var Qt;return Tt(Et,function(le,$e,pr){if(kt(le,$e,pr))return Qt=$e,!1}),Qt}function B(Et,kt,Tt,Qt){for(var le=Et.length,$e=Tt+(Qt?1:-1);Qt?$e--:++$e<le;)if(kt(Et[$e],$e,Et))return $e;return-1}function K(Et,kt,Tt){return kt==kt?function(Qt,le,$e){for(var pr=$e-1,Pr=Qt.length;++pr<Pr;)if(Qt[pr]===le)return pr;return-1}(Et,kt,Tt):B(Et,O,Tt)}function L(Et,kt,Tt,Qt){for(var le=Tt-1,$e=Et.length;++le<$e;)if(Qt(Et[le],kt))return le;return-1}function O(Et){return Et!=Et}function U(Et,kt){var Tt=Et==null?0:Et.length;return Tt?vt(Et,kt)/Tt:NaN}function W(Et){return function(kt){return kt?.[Et]}}function Y(Et){return function(kt){return Et?.[kt]}}function st(Et,kt,Tt,Qt,le){return le(Et,function($e,pr,Pr){Tt=Qt?(Qt=!1,$e):kt(Tt,$e,pr,Pr)}),Tt}function vt(Et,kt){for(var Tt,Qt=-1,le=Et.length;++Qt<le;){var $e=kt(Et[Qt]);$e!==void 0&&(Tt=Tt===void 0?$e:Tt+$e)}return Tt}function At(Et,kt){for(var Tt=-1,Qt=Array(Et);++Tt<Et;)Qt[Tt]=kt(Tt);return Qt}function Mt(Et){return Et&&Et.slice(0,jt(Et)+1).replace(Ut,"")}function Bt(Et){return function(kt){return Et(kt)}}function Q(Et,kt){return p(kt,function(Tt){return Et[Tt]})}function ut(Et,kt){return Et.has(kt)}function pt(Et,kt){for(var Tt=-1,Qt=Et.length;++Tt<Qt&&K(kt,Et[Tt],0)>-1;);return Tt}function it(Et,kt){for(var Tt=Et.length;Tt--&&K(kt,Et[Tt],0)>-1;);return Tt}var bt=Y({\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"}),$t=Y({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Wt(Et){return"\\"+ar[Et]}function Ht(Et){return Yr.test(Et)}function Se(Et){var kt=-1,Tt=Array(Et.size);return Et.forEach(function(Qt,le){Tt[++kt]=[le,Qt]}),Tt}function zt(Et,kt){return function(Tt){return Et(kt(Tt))}}function X(Et,kt){for(var Tt=-1,Qt=Et.length,le=0,$e=[];++Tt<Qt;){var pr=Et[Tt];pr!==kt&&pr!==r||(Et[Tt]=r,$e[le++]=Tt)}return $e}function dt(Et){var kt=-1,Tt=Array(Et.size);return Et.forEach(function(Qt){Tt[++kt]=Qt}),Tt}function mt(Et){var kt=-1,Tt=Array(Et.size);return Et.forEach(function(Qt){Tt[++kt]=[Qt,Qt]}),Tt}function Rt(Et){return Ht(Et)?function(kt){for(var Tt=Gr.lastIndex=0;Gr.test(kt);)++Tt;return Tt}(Et):R(Et)}function Ft(Et){return Ht(Et)?function(kt){return kt.match(Gr)||[]}(Et):function(kt){return kt.split("")}(Et)}function jt(Et){for(var kt=Et.length;kt--&&Zt.test(Et.charAt(kt)););return kt}var re=Y({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),te=function Et(kt){var Tt,Qt=(kt=kt==null?or:te.defaults(or.Object(),kt,te.pick(or,sn))).Array,le=kt.Date,$e=kt.Error,pr=kt.Function,Pr=kt.Math,er=kt.Object,gn=kt.RegExp,ro=kt.String,wr=kt.TypeError,Fr=Qt.prototype,yn=pr.prototype,Or=er.prototype,ir=kt["__core-js_shared__"],Br=yn.toString,Ve=Or.hasOwnProperty,Er=0,Yn=(Tt=/[^.]+$/.exec(ir&&ir.keys&&ir.keys.IE_PROTO||""))?"Symbol(src)_1."+Tt:"",Qr=Or.toString,mn=Br.call(er),ta=or._,ea=gn("^"+Br.call(Ve).replace(et,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Nn=Tr?kt.Buffer:void 0,Fn=kt.Symbol,mo=kt.Uint8Array,Qa=Nn?Nn.allocUnsafe:void 0,vo=zt(er.getPrototypeOf,er),ts=er.create,es=Or.propertyIsEnumerable,bo=Fr.splice,rs=Fn?Fn.isConcatSpreadable:void 0,no=Fn?Fn.iterator:void 0,Bn=Fn?Fn.toStringTag:void 0,wo=function(){try{var c=qn(er,"defineProperty");return c({},"",{}),c}catch{}}(),Mi=kt.clearTimeout!==or.clearTimeout&&kt.clearTimeout,qi=le&&le.now!==or.Date.now&&le.now,Ki=kt.setTimeout!==or.setTimeout&&kt.setTimeout,Eo=Pr.ceil,xo=Pr.floor,na=er.getOwnPropertySymbols,Gi=Nn?Nn.isBuffer:void 0,ns=kt.isFinite,Vi=Fr.join,Yi=zt(er.keys,er),br=Pr.max,kr=Pr.min,zi=le.now,Wi=kt.parseInt,os=Pr.random,Ji=Fr.reverse,oa=qn(kt,"DataView"),oo=qn(kt,"Map"),aa=qn(kt,"Promise"),zn=qn(kt,"Set"),ao=qn(kt,"WeakMap"),so=qn(er,"create"),So=ao&&new ao,Wn={},Xi=Kn(oa),Zi=Kn(oo),Qi=Kn(aa),tu=Kn(zn),eu=Kn(ao),Ao=Fn?Fn.prototype:void 0,io=Ao?Ao.valueOf:void 0,as=Ao?Ao.toString:void 0;function lt(c){if(_r(c)&&!je(c)&&!(c instanceof Ye)){if(c instanceof tn)return c;if(Ve.call(c,"__wrapped__"))return ii(c)}return new tn(c)}var Jn=function(){function c(){}return function(_){if(!dr(_))return{};if(ts)return ts(_);c.prototype=_;var I=new c;return c.prototype=void 0,I}}();function Co(){}function tn(c,_){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!_,this.__index__=0,this.__values__=void 0}function Ye(c){this.__wrapped__=c,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Ln(c){var _=-1,I=c==null?0:c.length;for(this.clear();++_<I;){var G=c[_];this.set(G[0],G[1])}}function vn(c){var _=-1,I=c==null?0:c.length;for(this.clear();++_<I;){var G=c[_];this.set(G[0],G[1])}}function bn(c){var _=-1,I=c==null?0:c.length;for(this.clear();++_<I;){var G=c[_];this.set(G[0],G[1])}}function Un(c){var _=-1,I=c==null?0:c.length;for(this.__data__=new bn;++_<I;)this.add(c[_])}function cn(c){var _=this.__data__=new vn(c);this.size=_.size}function ss(c,_){var I=je(c),G=!I&&Gn(c),nt=!I&&!G&&Tn(c),ht=!I&&!G&&!nt&&to(c),It=I||G||nt||ht,Ot=It?At(c.length,ro):[],qt=Ot.length;for(var oe in c)!_&&!Ve.call(c,oe)||It&&(oe=="length"||nt&&(oe=="offset"||oe=="parent")||ht&&(oe=="buffer"||oe=="byteLength"||oe=="byteOffset")||Sn(oe,qt))||Ot.push(oe);return Ot}function is(c){var _=c.length;return _?c[ya(0,_-1)]:void 0}function ru(c,_){return Uo(Lr(c),Hn(_,0,c.length))}function nu(c){return Uo(Lr(c))}function sa(c,_,I){(I===void 0||ln(c[_],I))&&(I!==void 0||_ in c)||wn(c,_,I)}function uo(c,_,I){var G=c[_];Ve.call(c,_)&&ln(G,I)&&(I!==void 0||_ in c)||wn(c,_,I)}function Io(c,_){for(var I=c.length;I--;)if(ln(c[I][0],_))return I;return-1}function ou(c,_,I,G){return On(c,function(nt,ht,It){_(G,nt,I(nt),It)}),G}function us(c,_){return c&&fn(_,xr(_),c)}function wn(c,_,I){_=="__proto__"&&wo?wo(c,_,{configurable:!0,enumerable:!0,value:I,writable:!0}):c[_]=I}function ia(c,_){for(var I=-1,G=_.length,nt=Qt(G),ht=c==null;++I<G;)nt[I]=ht?void 0:Ma(c,_[I]);return nt}function Hn(c,_,I){return c==c&&(I!==void 0&&(c=c<=I?c:I),_!==void 0&&(c=c>=_?c:_)),c}function en(c,_,I,G,nt,ht){var It,Ot=1&_,qt=2&_,oe=4&_;if(I&&(It=nt?I(c,G,nt,ht):I(c)),It!==void 0)return It;if(!dr(c))return c;var ne=je(c);if(ne){if(It=function(ae){var fe=ae.length,Pe=new ae.constructor(fe);return fe&&typeof ae[0]=="string"&&Ve.call(ae,"index")&&(Pe.index=ae.index,Pe.input=ae.input),Pe}(c),!Ot)return Lr(c,It)}else{var ue=$r(c),we=ue==k||ue==A;if(Tn(c))return Rs(c,Ot);if(ue==H||ue==o||we&&!nt){if(It=qt||we?{}:Zs(c),!Ot)return qt?function(ae,fe){return fn(ae,Js(ae),fe)}(c,function(ae,fe){return ae&&fn(fe,Hr(fe),ae)}(It,c)):function(ae,fe){return fn(ae,ka(ae),fe)}(c,us(It,c))}else{if(!Re[ue])return nt?c:{};It=function(ae,fe,Pe){var ve,De,qe,Ze=ae.constructor;switch(fe){case ot:return Sa(ae);case d:case h:return new Ze(+ae);case tt:return function(Ce,Oe){var mr=Oe?Sa(Ce.buffer):Ce.buffer;return new Ce.constructor(mr,Ce.byteOffset,Ce.byteLength)}(ae,Pe);case gt:case wt:case ft:case yt:case Ct:case l:case"[object Uint8ClampedArray]":case s:case b:return Ts(ae,Pe);case D:return new Ze;case q:case j:return new Ze(ae);case z:return(qe=new(De=ae).constructor(De.source,Dt.exec(De))).lastIndex=De.lastIndex,qe;case Z:return new Ze;case at:return ve=ae,io?er(io.call(ve)):{}}}(c,ue,Ot)}}ht||(ht=new cn);var Ae=ht.get(c);if(Ae)return Ae;ht.set(c,It),Ai(c)?c.forEach(function(ae){It.add(en(ae,_,I,ae,c,ht))}):xi(c)&&c.forEach(function(ae,fe){It.set(fe,en(ae,_,I,fe,c,ht))});var Fe=ne?void 0:(oe?qt?Pa:Ia:qt?Hr:xr)(c);return Jt(Fe||c,function(ae,fe){Fe&&(ae=c[fe=ae]),uo(It,fe,en(ae,_,I,fe,c,ht))}),It}function cs(c,_,I){var G=I.length;if(c==null)return!G;for(c=er(c);G--;){var nt=I[G],ht=_[nt],It=c[nt];if(It===void 0&&!(nt in c)||!ht(It))return!1}return!0}function ls(c,_,I){if(typeof c!="function")throw new wr(e);return go(function(){c.apply(void 0,I)},_)}function co(c,_,I,G){var nt=-1,ht=a,It=!0,Ot=c.length,qt=[],oe=_.length;if(!Ot)return qt;I&&(_=p(_,Bt(I))),G?(ht=u,It=!1):_.length>=200&&(ht=ut,It=!1,_=new Un(_));t:for(;++nt<Ot;){var ne=c[nt],ue=I==null?ne:I(ne);if(ne=G||ne!==0?ne:0,It&&ue==ue){for(var we=oe;we--;)if(_[we]===ue)continue t;qt.push(ne)}else ht(_,ue,G)||qt.push(ne)}return qt}lt.templateSettings={escape:N,evaluate:V,interpolate:S,variable:"",imports:{_:lt}},lt.prototype=Co.prototype,lt.prototype.constructor=lt,tn.prototype=Jn(Co.prototype),tn.prototype.constructor=tn,Ye.prototype=Jn(Co.prototype),Ye.prototype.constructor=Ye,Ln.prototype.clear=function(){this.__data__=so?so(null):{},this.size=0},Ln.prototype.delete=function(c){var _=this.has(c)&&delete this.__data__[c];return this.size-=_?1:0,_},Ln.prototype.get=function(c){var _=this.__data__;if(so){var I=_[c];return I==="__lodash_hash_undefined__"?void 0:I}return Ve.call(_,c)?_[c]:void 0},Ln.prototype.has=function(c){var _=this.__data__;return so?_[c]!==void 0:Ve.call(_,c)},Ln.prototype.set=function(c,_){var I=this.__data__;return this.size+=this.has(c)?0:1,I[c]=so&&_===void 0?"__lodash_hash_undefined__":_,this},vn.prototype.clear=function(){this.__data__=[],this.size=0},vn.prototype.delete=function(c){var _=this.__data__,I=Io(_,c);return!(I<0||(I==_.length-1?_.pop():bo.call(_,I,1),--this.size,0))},vn.prototype.get=function(c){var _=this.__data__,I=Io(_,c);return I<0?void 0:_[I][1]},vn.prototype.has=function(c){return Io(this.__data__,c)>-1},vn.prototype.set=function(c,_){var I=this.__data__,G=Io(I,c);return G<0?(++this.size,I.push([c,_])):I[G][1]=_,this},bn.prototype.clear=function(){this.size=0,this.__data__={hash:new Ln,map:new(oo||vn),string:new Ln}},bn.prototype.delete=function(c){var _=Lo(this,c).delete(c);return this.size-=_?1:0,_},bn.prototype.get=function(c){return Lo(this,c).get(c)},bn.prototype.has=function(c){return Lo(this,c).has(c)},bn.prototype.set=function(c,_){var I=Lo(this,c),G=I.size;return I.set(c,_),this.size+=I.size==G?0:1,this},Un.prototype.add=Un.prototype.push=function(c){return this.__data__.set(c,"__lodash_hash_undefined__"),this},Un.prototype.has=function(c){return this.__data__.has(c)},cn.prototype.clear=function(){this.__data__=new vn,this.size=0},cn.prototype.delete=function(c){var _=this.__data__,I=_.delete(c);return this.size=_.size,I},cn.prototype.get=function(c){return this.__data__.get(c)},cn.prototype.has=function(c){return this.__data__.has(c)},cn.prototype.set=function(c,_){var I=this.__data__;if(I instanceof vn){var G=I.__data__;if(!oo||G.length<199)return G.push([c,_]),this.size=++I.size,this;I=this.__data__=new bn(G)}return I.set(c,_),this.size=I.size,this};var On=Bs(pn),ps=Bs(la,!0);function au(c,_){var I=!0;return On(c,function(G,nt,ht){return I=!!_(G,nt,ht)}),I}function Po(c,_,I){for(var G=-1,nt=c.length;++G<nt;){var ht=c[G],It=_(ht);if(It!=null&&(Ot===void 0?It==It&&!Wr(It):I(It,Ot)))var Ot=It,qt=ht}return qt}function ds(c,_){var I=[];return On(c,function(G,nt,ht){_(G,nt,ht)&&I.push(G)}),I}function Cr(c,_,I,G,nt){var ht=-1,It=c.length;for(I||(I=gu),nt||(nt=[]);++ht<It;){var Ot=c[ht];_>0&&I(Ot)?_>1?Cr(Ot,_-1,I,G,nt):g(nt,Ot):G||(nt[nt.length]=Ot)}return nt}var ca=Ls(),hs=Ls(!0);function pn(c,_){return c&&ca(c,_,xr)}function la(c,_){return c&&hs(c,_,xr)}function Fo(c,_){return Ee(_,function(I){return An(c[I])})}function Mn(c,_){for(var I=0,G=(_=$n(_,c)).length;c!=null&&I<G;)c=c[dn(_[I++])];return I&&I==G?c:void 0}function _s(c,_,I){var G=_(c);return je(c)?G:g(G,I(c))}function Dr(c){return c==null?c===void 0?"[object Undefined]":"[object Null]":Bn&&Bn in er(c)?function(_){var I=Ve.call(_,Bn),G=_[Bn];try{_[Bn]=void 0;var nt=!0}catch{}var ht=Qr.call(_);return nt&&(I?_[Bn]=G:delete _[Bn]),ht}(c):function(_){return Qr.call(_)}(c)}function pa(c,_){return c>_}function su(c,_){return c!=null&&Ve.call(c,_)}function iu(c,_){return c!=null&&_ in er(c)}function fa(c,_,I){for(var G=I?u:a,nt=c[0].length,ht=c.length,It=ht,Ot=Qt(ht),qt=1/0,oe=[];It--;){var ne=c[It];It&&_&&(ne=p(ne,Bt(_))),qt=kr(ne.length,qt),Ot[It]=!I&&(_||nt>=120&&ne.length>=120)?new Un(It&&ne):void 0}ne=c[0];var ue=-1,we=Ot[0];t:for(;++ue<nt&&oe.length<qt;){var Ae=ne[ue],Fe=_?_(Ae):Ae;if(Ae=I||Ae!==0?Ae:0,!(we?ut(we,Fe):G(oe,Fe,I))){for(It=ht;--It;){var ae=Ot[It];if(!(ae?ut(ae,Fe):G(c[It],Fe,I)))continue t}we&&we.push(Fe),oe.push(Ae)}}return oe}function lo(c,_,I){var G=(c=ri(c,_=$n(_,c)))==null?c:c[dn(nn(_))];return G==null?void 0:Yt(G,c,I)}function gs(c){return _r(c)&&Dr(c)==o}function po(c,_,I,G,nt){return c===_||(c==null||_==null||!_r(c)&&!_r(_)?c!=c&&_!=_:function(ht,It,Ot,qt,oe,ne){var ue=je(ht),we=je(It),Ae=ue?f:$r(ht),Fe=we?f:$r(It),ae=(Ae=Ae==o?H:Ae)==H,fe=(Fe=Fe==o?H:Fe)==H,Pe=Ae==Fe;if(Pe&&Tn(ht)){if(!Tn(It))return!1;ue=!0,ae=!1}if(Pe&&!ae)return ne||(ne=new cn),ue||to(ht)?Ws(ht,It,Ot,qt,oe,ne):function(Ce,Oe,mr,vr,Nr,cr,Rr){switch(mr){case tt:if(Ce.byteLength!=Oe.byteLength||Ce.byteOffset!=Oe.byteOffset)return!1;Ce=Ce.buffer,Oe=Oe.buffer;case ot:return!(Ce.byteLength!=Oe.byteLength||!cr(new mo(Ce),new mo(Oe)));case d:case h:case q:return ln(+Ce,+Oe);case y:return Ce.name==Oe.name&&Ce.message==Oe.message;case z:case j:return Ce==Oe+"";case D:var hn=Se;case Z:var Dn=1&vr;if(hn||(hn=dt),Ce.size!=Oe.size&&!Dn)return!1;var Vn=Rr.get(Ce);if(Vn)return Vn==Oe;vr|=2,Rr.set(Ce,Oe);var In=Ws(hn(Ce),hn(Oe),vr,Nr,cr,Rr);return Rr.delete(Ce),In;case at:if(io)return io.call(Ce)==io.call(Oe)}return!1}(ht,It,Ae,Ot,qt,oe,ne);if(!(1&Ot)){var ve=ae&&Ve.call(ht,"__wrapped__"),De=fe&&Ve.call(It,"__wrapped__");if(ve||De){var qe=ve?ht.value():ht,Ze=De?It.value():It;return ne||(ne=new cn),oe(qe,Ze,Ot,qt,ne)}}return!!Pe&&(ne||(ne=new cn),function(Ce,Oe,mr,vr,Nr,cr){var Rr=1&mr,hn=Ia(Ce),Dn=hn.length;if(Dn!=Ia(Oe).length&&!Rr)return!1;for(var Vn=Dn;Vn--;){var In=hn[Vn];if(!(Rr?In in Oe:Ve.call(Oe,In)))return!1}var Li=cr.get(Ce),Ui=cr.get(Oe);if(Li&&Ui)return Li==Oe&&Ui==Ce;var Wo=!0;cr.set(Ce,Oe),cr.set(Oe,Ce);for(var Za=Rr;++Vn<Dn;){var Jo=Ce[In=hn[Vn]],Xo=Oe[In];if(vr)var Hi=Rr?vr(Xo,Jo,In,Oe,Ce,cr):vr(Jo,Xo,In,Ce,Oe,cr);if(!(Hi===void 0?Jo===Xo||Nr(Jo,Xo,mr,vr,cr):Hi)){Wo=!1;break}Za||(Za=In=="constructor")}if(Wo&&!Za){var Zo=Ce.constructor,Qo=Oe.constructor;Zo!=Qo&&"constructor"in Ce&&"constructor"in Oe&&!(typeof Zo=="function"&&Zo instanceof Zo&&typeof Qo=="function"&&Qo instanceof Qo)&&(Wo=!1)}return cr.delete(Ce),cr.delete(Oe),Wo}(ht,It,Ot,qt,oe,ne))}(c,_,I,G,po,nt))}function da(c,_,I,G){var nt=I.length,ht=nt,It=!G;if(c==null)return!ht;for(c=er(c);nt--;){var Ot=I[nt];if(It&&Ot[2]?Ot[1]!==c[Ot[0]]:!(Ot[0]in c))return!1}for(;++nt<ht;){var qt=(Ot=I[nt])[0],oe=c[qt],ne=Ot[1];if(It&&Ot[2]){if(oe===void 0&&!(qt in c))return!1}else{var ue=new cn;if(G)var we=G(oe,ne,qt,c,_,ue);if(!(we===void 0?po(ne,oe,3,G,ue):we))return!1}}return!0}function ys(c){return!(!dr(c)||(_=c,Yn&&Yn in _))&&(An(c)?ea:ee).test(Kn(c));var _}function ms(c){return typeof c=="function"?c:c==null?Mr:typeof c=="object"?je(c)?ws(c[0],c[1]):bs(c):Bi(c)}function ha(c){if(!_o(c))return Yi(c);var _=[];for(var I in er(c))Ve.call(c,I)&&I!="constructor"&&_.push(I);return _}function _a(c,_){return c<_}function vs(c,_){var I=-1,G=Ur(c)?Qt(c.length):[];return On(c,function(nt,ht,It){G[++I]=_(nt,ht,It)}),G}function bs(c){var _=Oa(c);return _.length==1&&_[0][2]?ti(_[0][0],_[0][1]):function(I){return I===c||da(I,c,_)}}function ws(c,_){return $a(c)&&Qs(_)?ti(dn(c),_):function(I){var G=Ma(I,c);return G===void 0&&G===_?qa(I,c):po(_,G,3)}}function Oo(c,_,I,G,nt){c!==_&&ca(_,function(ht,It){if(nt||(nt=new cn),dr(ht))(function(qt,oe,ne,ue,we,Ae,Fe){var ae=Ta(qt,ne),fe=Ta(oe,ne),Pe=Fe.get(fe);if(Pe)sa(qt,ne,Pe);else{var ve=Ae?Ae(ae,fe,ne+"",qt,oe,Fe):void 0,De=ve===void 0;if(De){var qe=je(fe),Ze=!qe&&Tn(fe),Ce=!qe&&!Ze&&to(fe);ve=fe,qe||Ze||Ce?je(ae)?ve=ae:yr(ae)?ve=Lr(ae):Ze?(De=!1,ve=Rs(fe,!0)):Ce?(De=!1,ve=Ts(fe,!0)):ve=[]:yo(fe)||Gn(fe)?(ve=ae,Gn(ae)?ve=Pi(ae):dr(ae)&&!An(ae)||(ve=Zs(fe))):De=!1}De&&(Fe.set(fe,ve),we(ve,fe,ue,Ae,Fe),Fe.delete(fe)),sa(qt,ne,ve)}})(c,_,It,I,Oo,G,nt);else{var Ot=G?G(Ta(c,It),ht,It+"",c,_,nt):void 0;Ot===void 0&&(Ot=ht),sa(c,It,Ot)}},Hr)}function Es(c,_){var I=c.length;if(I)return Sn(_+=_<0?I:0,I)?c[_]:void 0}function xs(c,_,I){_=_.length?p(_,function(nt){return je(nt)?function(ht){return Mn(ht,nt.length===1?nt[0]:nt)}:nt}):[Mr];var G=-1;return _=p(_,Bt(ke())),function(nt,ht){var It=nt.length;for(nt.sort(function(Ot,qt){return function(oe,ne,ue){for(var we=-1,Ae=oe.criteria,Fe=ne.criteria,ae=Ae.length,fe=ue.length;++we<ae;){var Pe=Ds(Ae[we],Fe[we]);if(Pe)return we>=fe?Pe:Pe*(ue[we]=="desc"?-1:1)}return oe.index-ne.index}(Ot,qt,I)});It--;)nt[It]=nt[It].value;return nt}(vs(c,function(nt,ht,It){return{criteria:p(_,function(Ot){return Ot(nt)}),index:++G,value:nt}}))}function Ss(c,_,I){for(var G=-1,nt=_.length,ht={};++G<nt;){var It=_[G],Ot=Mn(c,It);I(Ot,It)&&fo(ht,$n(It,c),Ot)}return ht}function ga(c,_,I,G){var nt=G?L:K,ht=-1,It=_.length,Ot=c;for(c===_&&(_=Lr(_)),I&&(Ot=p(c,Bt(I)));++ht<It;)for(var qt=0,oe=_[ht],ne=I?I(oe):oe;(qt=nt(Ot,ne,qt,G))>-1;)Ot!==c&&bo.call(Ot,qt,1),bo.call(c,qt,1);return c}function As(c,_){for(var I=c?_.length:0,G=I-1;I--;){var nt=_[I];if(I==G||nt!==ht){var ht=nt;Sn(nt)?bo.call(c,nt,1):ba(c,nt)}}return c}function ya(c,_){return c+xo(os()*(_-c+1))}function ma(c,_){var I="";if(!c||_<1||_>9007199254740991)return I;do _%2&&(I+=c),(_=xo(_/2))&&(c+=c);while(_);return I}function He(c,_){return Da(ei(c,_,Mr),c+"")}function uu(c){return is(eo(c))}function cu(c,_){var I=eo(c);return Uo(I,Hn(_,0,I.length))}function fo(c,_,I,G){if(!dr(c))return c;for(var nt=-1,ht=(_=$n(_,c)).length,It=ht-1,Ot=c;Ot!=null&&++nt<ht;){var qt=dn(_[nt]),oe=I;if(qt==="__proto__"||qt==="constructor"||qt==="prototype")return c;if(nt!=It){var ne=Ot[qt];(oe=G?G(ne,qt,Ot):void 0)===void 0&&(oe=dr(ne)?ne:Sn(_[nt+1])?[]:{})}uo(Ot,qt,oe),Ot=Ot[qt]}return c}var Cs=So?function(c,_){return So.set(c,_),c}:Mr,lu=wo?function(c,_){return wo(c,"toString",{configurable:!0,enumerable:!1,value:Ga(_),writable:!0})}:Mr;function pu(c){return Uo(eo(c))}function rn(c,_,I){var G=-1,nt=c.length;_<0&&(_=-_>nt?0:nt+_),(I=I>nt?nt:I)<0&&(I+=nt),nt=_>I?0:I-_>>>0,_>>>=0;for(var ht=Qt(nt);++G<nt;)ht[G]=c[G+_];return ht}function fu(c,_){var I;return On(c,function(G,nt,ht){return!(I=_(G,nt,ht))}),!!I}function ko(c,_,I){var G=0,nt=c==null?G:c.length;if(typeof _=="number"&&_==_&&nt<=2147483647){for(;G<nt;){var ht=G+nt>>>1,It=c[ht];It!==null&&!Wr(It)&&(I?It<=_:It<_)?G=ht+1:nt=ht}return nt}return va(c,_,Mr,I)}function va(c,_,I,G){var nt=0,ht=c==null?0:c.length;if(ht===0)return 0;for(var It=(_=I(_))!=_,Ot=_===null,qt=Wr(_),oe=_===void 0;nt<ht;){var ne=xo((nt+ht)/2),ue=I(c[ne]),we=ue!==void 0,Ae=ue===null,Fe=ue==ue,ae=Wr(ue);if(It)var fe=G||Fe;else fe=oe?Fe&&(G||we):Ot?Fe&&we&&(G||!Ae):qt?Fe&&we&&!Ae&&(G||!ae):!Ae&&!ae&&(G?ue<=_:ue<_);fe?nt=ne+1:ht=ne}return kr(ht,4294967294)}function Is(c,_){for(var I=-1,G=c.length,nt=0,ht=[];++I<G;){var It=c[I],Ot=_?_(It):It;if(!I||!ln(Ot,qt)){var qt=Ot;ht[nt++]=It===0?0:It}}return ht}function Ps(c){return typeof c=="number"?c:Wr(c)?NaN:+c}function zr(c){if(typeof c=="string")return c;if(je(c))return p(c,zr)+"";if(Wr(c))return as?as.call(c):"";var _=c+"";return _=="0"&&1/c==-1/0?"-0":_}function kn(c,_,I){var G=-1,nt=a,ht=c.length,It=!0,Ot=[],qt=Ot;if(I)It=!1,nt=u;else if(ht>=200){var oe=_?null:hu(c);if(oe)return dt(oe);It=!1,nt=ut,qt=new Un}else qt=_?[]:Ot;t:for(;++G<ht;){var ne=c[G],ue=_?_(ne):ne;if(ne=I||ne!==0?ne:0,It&&ue==ue){for(var we=qt.length;we--;)if(qt[we]===ue)continue t;_&&qt.push(ue),Ot.push(ne)}else nt(qt,ue,I)||(qt!==Ot&&qt.push(ue),Ot.push(ne))}return Ot}function ba(c,_){return(c=ri(c,_=$n(_,c)))==null||delete c[dn(nn(_))]}function Fs(c,_,I,G){return fo(c,_,I(Mn(c,_)),G)}function $o(c,_,I,G){for(var nt=c.length,ht=G?nt:-1;(G?ht--:++ht<nt)&&_(c[ht],ht,c););return I?rn(c,G?0:ht,G?ht+1:nt):rn(c,G?ht+1:0,G?nt:ht)}function Os(c,_){var I=c;return I instanceof Ye&&(I=I.value()),m(_,function(G,nt){return nt.func.apply(nt.thisArg,g([G],nt.args))},I)}function wa(c,_,I){var G=c.length;if(G<2)return G?kn(c[0]):[];for(var nt=-1,ht=Qt(G);++nt<G;)for(var It=c[nt],Ot=-1;++Ot<G;)Ot!=nt&&(ht[nt]=co(ht[nt]||It,c[Ot],_,I));return kn(Cr(ht,1),_,I)}function ks(c,_,I){for(var G=-1,nt=c.length,ht=_.length,It={};++G<nt;){var Ot=G<ht?_[G]:void 0;I(It,c[G],Ot)}return It}function Ea(c){return yr(c)?c:[]}function xa(c){return typeof c=="function"?c:Mr}function $n(c,_){return je(c)?c:$a(c,_)?[c]:si(rr(c))}var du=He;function Rn(c,_,I){var G=c.length;return I=I===void 0?G:I,!_&&I>=G?c:rn(c,_,I)}var $s=Mi||function(c){return or.clearTimeout(c)};function Rs(c,_){if(_)return c.slice();var I=c.length,G=Qa?Qa(I):new c.constructor(I);return c.copy(G),G}function Sa(c){var _=new c.constructor(c.byteLength);return new mo(_).set(new mo(c)),_}function Ts(c,_){var I=_?Sa(c.buffer):c.buffer;return new c.constructor(I,c.byteOffset,c.length)}function Ds(c,_){if(c!==_){var I=c!==void 0,G=c===null,nt=c==c,ht=Wr(c),It=_!==void 0,Ot=_===null,qt=_==_,oe=Wr(_);if(!Ot&&!oe&&!ht&&c>_||ht&&It&&qt&&!Ot&&!oe||G&&It&&qt||!I&&qt||!nt)return 1;if(!G&&!ht&&!oe&&c<_||oe&&I&&nt&&!G&&!ht||Ot&&I&&nt||!It&&nt||!qt)return-1}return 0}function js(c,_,I,G){for(var nt=-1,ht=c.length,It=I.length,Ot=-1,qt=_.length,oe=br(ht-It,0),ne=Qt(qt+oe),ue=!G;++Ot<qt;)ne[Ot]=_[Ot];for(;++nt<It;)(ue||nt<ht)&&(ne[I[nt]]=c[nt]);for(;oe--;)ne[Ot++]=c[nt++];return ne}function Ns(c,_,I,G){for(var nt=-1,ht=c.length,It=-1,Ot=I.length,qt=-1,oe=_.length,ne=br(ht-Ot,0),ue=Qt(ne+oe),we=!G;++nt<ne;)ue[nt]=c[nt];for(var Ae=nt;++qt<oe;)ue[Ae+qt]=_[qt];for(;++It<Ot;)(we||nt<ht)&&(ue[Ae+I[It]]=c[nt++]);return ue}function Lr(c,_){var I=-1,G=c.length;for(_||(_=Qt(G));++I<G;)_[I]=c[I];return _}function fn(c,_,I,G){var nt=!I;I||(I={});for(var ht=-1,It=_.length;++ht<It;){var Ot=_[ht],qt=G?G(I[Ot],c[Ot],Ot,I,c):void 0;qt===void 0&&(qt=c[Ot]),nt?wn(I,Ot,qt):uo(I,Ot,qt)}return I}function Ro(c,_){return function(I,G){var nt=je(I)?Te:ou,ht=_?_():{};return nt(I,c,ke(G,2),ht)}}function Xn(c){return He(function(_,I){var G=-1,nt=I.length,ht=nt>1?I[nt-1]:void 0,It=nt>2?I[2]:void 0;for(ht=c.length>3&&typeof ht=="function"?(nt--,ht):void 0,It&&jr(I[0],I[1],It)&&(ht=nt<3?void 0:ht,nt=1),_=er(_);++G<nt;){var Ot=I[G];Ot&&c(_,Ot,G,ht)}return _})}function Bs(c,_){return function(I,G){if(I==null)return I;if(!Ur(I))return c(I,G);for(var nt=I.length,ht=_?nt:-1,It=er(I);(_?ht--:++ht<nt)&&G(It[ht],ht,It)!==!1;);return I}}function Ls(c){return function(_,I,G){for(var nt=-1,ht=er(_),It=G(_),Ot=It.length;Ot--;){var qt=It[c?Ot:++nt];if(I(ht[qt],qt,ht)===!1)break}return _}}function Us(c){return function(_){var I=Ht(_=rr(_))?Ft(_):void 0,G=I?I[0]:_.charAt(0),nt=I?Rn(I,1).join(""):_.slice(1);return G[c]()+nt}}function Zn(c){return function(_){return m(ji(Di(_).replace(Qe,"")),c,"")}}function ho(c){return function(){var _=arguments;switch(_.length){case 0:return new c;case 1:return new c(_[0]);case 2:return new c(_[0],_[1]);case 3:return new c(_[0],_[1],_[2]);case 4:return new c(_[0],_[1],_[2],_[3]);case 5:return new c(_[0],_[1],_[2],_[3],_[4]);case 6:return new c(_[0],_[1],_[2],_[3],_[4],_[5]);case 7:return new c(_[0],_[1],_[2],_[3],_[4],_[5],_[6])}var I=Jn(c.prototype),G=c.apply(I,_);return dr(G)?G:I}}function Hs(c){return function(_,I,G){var nt=er(_);if(!Ur(_)){var ht=ke(I,3);_=xr(_),I=function(Ot){return ht(nt[Ot],Ot,nt)}}var It=c(_,I,G);return It>-1?nt[ht?_[It]:It]:void 0}}function Ms(c){return xn(function(_){var I=_.length,G=I,nt=tn.prototype.thru;for(c&&_.reverse();G--;){var ht=_[G];if(typeof ht!="function")throw new wr(e);if(nt&&!It&&Bo(ht)=="wrapper")var It=new tn([],!0)}for(G=It?G:I;++G<I;){var Ot=Bo(ht=_[G]),qt=Ot=="wrapper"?Fa(ht):void 0;It=qt&&Ra(qt[0])&&qt[1]==424&&!qt[4].length&&qt[9]==1?It[Bo(qt[0])].apply(It,qt[3]):ht.length==1&&Ra(ht)?It[Ot]():It.thru(ht)}return function(){var oe=arguments,ne=oe[0];if(It&&oe.length==1&&je(ne))return It.plant(ne).value();for(var ue=0,we=I?_[ue].apply(this,oe):ne;++ue<I;)we=_[ue].call(this,we);return we}})}function To(c,_,I,G,nt,ht,It,Ot,qt,oe){var ne=128&_,ue=1&_,we=2&_,Ae=24&_,Fe=512&_,ae=we?void 0:ho(c);return function fe(){for(var Pe=arguments.length,ve=Qt(Pe),De=Pe;De--;)ve[De]=arguments[De];if(Ae)var qe=Qn(fe),Ze=function(vr,Nr){for(var cr=vr.length,Rr=0;cr--;)vr[cr]===Nr&&++Rr;return Rr}(ve,qe);if(G&&(ve=js(ve,G,nt,Ae)),ht&&(ve=Ns(ve,ht,It,Ae)),Pe-=Ze,Ae&&Pe<oe){var Ce=X(ve,qe);return Gs(c,_,To,fe.placeholder,I,ve,Ce,Ot,qt,oe-Pe)}var Oe=ue?I:this,mr=we?Oe[c]:c;return Pe=ve.length,Ot?ve=function(vr,Nr){for(var cr=vr.length,Rr=kr(Nr.length,cr),hn=Lr(vr);Rr--;){var Dn=Nr[Rr];vr[Rr]=Sn(Dn,cr)?hn[Dn]:void 0}return vr}(ve,Ot):Fe&&Pe>1&&ve.reverse(),ne&&qt<Pe&&(ve.length=qt),this&&this!==or&&this instanceof fe&&(mr=ae||ho(mr)),mr.apply(Oe,ve)}}function qs(c,_){return function(I,G){return function(nt,ht,It,Ot){return pn(nt,function(qt,oe,ne){ht(Ot,It(qt),oe,ne)}),Ot}(I,c,_(G),{})}}function Do(c,_){return function(I,G){var nt;if(I===void 0&&G===void 0)return _;if(I!==void 0&&(nt=I),G!==void 0){if(nt===void 0)return G;typeof I=="string"||typeof G=="string"?(I=zr(I),G=zr(G)):(I=Ps(I),G=Ps(G)),nt=c(I,G)}return nt}}function Aa(c){return xn(function(_){return _=p(_,Bt(ke())),He(function(I){var G=this;return c(_,function(nt){return Yt(nt,G,I)})})})}function jo(c,_){var I=(_=_===void 0?" ":zr(_)).length;if(I<2)return I?ma(_,c):_;var G=ma(_,Eo(c/Rt(_)));return Ht(_)?Rn(Ft(G),0,c).join(""):G.slice(0,c)}function Ks(c){return function(_,I,G){return G&&typeof G!="number"&&jr(_,I,G)&&(I=G=void 0),_=Cn(_),I===void 0?(I=_,_=0):I=Cn(I),function(nt,ht,It,Ot){for(var qt=-1,oe=br(Eo((ht-nt)/(It||1)),0),ne=Qt(oe);oe--;)ne[Ot?oe:++qt]=nt,nt+=It;return ne}(_,I,G=G===void 0?_<I?1:-1:Cn(G),c)}}function No(c){return function(_,I){return typeof _=="string"&&typeof I=="string"||(_=on(_),I=on(I)),c(_,I)}}function Gs(c,_,I,G,nt,ht,It,Ot,qt,oe){var ne=8&_;_|=ne?32:64,4&(_&=~(ne?64:32))||(_&=-4);var ue=[c,_,nt,ne?ht:void 0,ne?It:void 0,ne?void 0:ht,ne?void 0:It,Ot,qt,oe],we=I.apply(void 0,ue);return Ra(c)&&ni(we,ue),we.placeholder=G,oi(we,c,_)}function Ca(c){var _=Pr[c];return function(I,G){if(I=on(I),(G=G==null?0:kr(Ne(G),292))&&ns(I)){var nt=(rr(I)+"e").split("e");return+((nt=(rr(_(nt[0]+"e"+(+nt[1]+G)))+"e").split("e"))[0]+"e"+(+nt[1]-G))}return _(I)}}var hu=zn&&1/dt(new zn([,-0]))[1]==1/0?function(c){return new zn(c)}:za;function Vs(c){return function(_){var I=$r(_);return I==D?Se(_):I==Z?mt(_):function(G,nt){return p(nt,function(ht){return[ht,G[ht]]})}(_,c(_))}}function En(c,_,I,G,nt,ht,It,Ot){var qt=2&_;if(!qt&&typeof c!="function")throw new wr(e);var oe=G?G.length:0;if(oe||(_&=-97,G=nt=void 0),It=It===void 0?It:br(Ne(It),0),Ot=Ot===void 0?Ot:Ne(Ot),oe-=nt?nt.length:0,64&_){var ne=G,ue=nt;G=nt=void 0}var we=qt?void 0:Fa(c),Ae=[c,_,I,G,nt,ne,ue,ht,It,Ot];if(we&&function(ae,fe){var Pe=ae[1],ve=fe[1],De=Pe|ve,qe=De<131,Ze=ve==128&&Pe==8||ve==128&&Pe==256&&ae[7].length<=fe[8]||ve==384&&fe[7].length<=fe[8]&&Pe==8;if(!qe&&!Ze)return ae;1&ve&&(ae[2]=fe[2],De|=1&Pe?0:4);var Ce=fe[3];if(Ce){var Oe=ae[3];ae[3]=Oe?js(Oe,Ce,fe[4]):Ce,ae[4]=Oe?X(ae[3],r):fe[4]}(Ce=fe[5])&&(Oe=ae[5],ae[5]=Oe?Ns(Oe,Ce,fe[6]):Ce,ae[6]=Oe?X(ae[5],r):fe[6]),(Ce=fe[7])&&(ae[7]=Ce),128&ve&&(ae[8]=ae[8]==null?fe[8]:kr(ae[8],fe[8])),ae[9]==null&&(ae[9]=fe[9]),ae[0]=fe[0],ae[1]=De}(Ae,we),c=Ae[0],_=Ae[1],I=Ae[2],G=Ae[3],nt=Ae[4],!(Ot=Ae[9]=Ae[9]===void 0?qt?0:c.length:br(Ae[9]-oe,0))&&24&_&&(_&=-25),_&&_!=1)Fe=_==8||_==16?function(ae,fe,Pe){var ve=ho(ae);return function De(){for(var qe=arguments.length,Ze=Qt(qe),Ce=qe,Oe=Qn(De);Ce--;)Ze[Ce]=arguments[Ce];var mr=qe<3&&Ze[0]!==Oe&&Ze[qe-1]!==Oe?[]:X(Ze,Oe);return(qe-=mr.length)<Pe?Gs(ae,fe,To,De.placeholder,void 0,Ze,mr,void 0,void 0,Pe-qe):Yt(this&&this!==or&&this instanceof De?ve:ae,this,Ze)}}(c,_,Ot):_!=32&&_!=33||nt.length?To.apply(void 0,Ae):function(ae,fe,Pe,ve){var De=1&fe,qe=ho(ae);return function Ze(){for(var Ce=-1,Oe=arguments.length,mr=-1,vr=ve.length,Nr=Qt(vr+Oe),cr=this&&this!==or&&this instanceof Ze?qe:ae;++mr<vr;)Nr[mr]=ve[mr];for(;Oe--;)Nr[mr++]=arguments[++Ce];return Yt(cr,De?Pe:this,Nr)}}(c,_,I,G);else var Fe=function(ae,fe,Pe){var ve=1&fe,De=ho(ae);return function qe(){return(this&&this!==or&&this instanceof qe?De:ae).apply(ve?Pe:this,arguments)}}(c,_,I);return oi((we?Cs:ni)(Fe,Ae),c,_)}function Ys(c,_,I,G){return c===void 0||ln(c,Or[I])&&!Ve.call(G,I)?_:c}function zs(c,_,I,G,nt,ht){return dr(c)&&dr(_)&&(ht.set(_,c),Oo(c,_,void 0,zs,ht),ht.delete(_)),c}function _u(c){return yo(c)?void 0:c}function Ws(c,_,I,G,nt,ht){var It=1&I,Ot=c.length,qt=_.length;if(Ot!=qt&&!(It&&qt>Ot))return!1;var oe=ht.get(c),ne=ht.get(_);if(oe&&ne)return oe==_&&ne==c;var ue=-1,we=!0,Ae=2&I?new Un:void 0;for(ht.set(c,_),ht.set(_,c);++ue<Ot;){var Fe=c[ue],ae=_[ue];if(G)var fe=It?G(ae,Fe,ue,_,c,ht):G(Fe,ae,ue,c,_,ht);if(fe!==void 0){if(fe)continue;we=!1;break}if(Ae){if(!F(_,function(Pe,ve){if(!ut(Ae,ve)&&(Fe===Pe||nt(Fe,Pe,I,G,ht)))return Ae.push(ve)})){we=!1;break}}else if(Fe!==ae&&!nt(Fe,ae,I,G,ht)){we=!1;break}}return ht.delete(c),ht.delete(_),we}function xn(c){return Da(ei(c,void 0,li),c+"")}function Ia(c){return _s(c,xr,ka)}function Pa(c){return _s(c,Hr,Js)}var Fa=So?function(c){return So.get(c)}:za;function Bo(c){for(var _=c.name+"",I=Wn[_],G=Ve.call(Wn,_)?I.length:0;G--;){var nt=I[G],ht=nt.func;if(ht==null||ht==c)return nt.name}return _}function Qn(c){return(Ve.call(lt,"placeholder")?lt:c).placeholder}function ke(){var c=lt.iteratee||Va;return c=c===Va?ms:c,arguments.length?c(arguments[0],arguments[1]):c}function Lo(c,_){var I,G,nt=c.__data__;return((G=typeof(I=_))=="string"||G=="number"||G=="symbol"||G=="boolean"?I!=="__proto__":I===null)?nt[typeof _=="string"?"string":"hash"]:nt.map}function Oa(c){for(var _=xr(c),I=_.length;I--;){var G=_[I],nt=c[G];_[I]=[G,nt,Qs(nt)]}return _}function qn(c,_){var I=function(G,nt){return G?.[nt]}(c,_);return ys(I)?I:void 0}var ka=na?function(c){return c==null?[]:(c=er(c),Ee(na(c),function(_){return es.call(c,_)}))}:Wa,Js=na?function(c){for(var _=[];c;)g(_,ka(c)),c=vo(c);return _}:Wa,$r=Dr;function Xs(c,_,I){for(var G=-1,nt=(_=$n(_,c)).length,ht=!1;++G<nt;){var It=dn(_[G]);if(!(ht=c!=null&&I(c,It)))break;c=c[It]}return ht||++G!=nt?ht:!!(nt=c==null?0:c.length)&&Vo(nt)&&Sn(It,nt)&&(je(c)||Gn(c))}function Zs(c){return typeof c.constructor!="function"||_o(c)?{}:Jn(vo(c))}function gu(c){return je(c)||Gn(c)||!!(rs&&c&&c[rs])}function Sn(c,_){var I=typeof c;return!!(_=_??9007199254740991)&&(I=="number"||I!="symbol"&&be.test(c))&&c>-1&&c%1==0&&c<_}function jr(c,_,I){if(!dr(I))return!1;var G=typeof _;return!!(G=="number"?Ur(I)&&Sn(_,I.length):G=="string"&&_ in I)&&ln(I[_],c)}function $a(c,_){if(je(c))return!1;var I=typeof c;return!(I!="number"&&I!="symbol"&&I!="boolean"&&c!=null&&!Wr(c))||T.test(c)||!C.test(c)||_!=null&&c in er(_)}function Ra(c){var _=Bo(c),I=lt[_];if(typeof I!="function"||!(_ in Ye.prototype))return!1;if(c===I)return!0;var G=Fa(I);return!!G&&c===G[0]}(oa&&$r(new oa(new ArrayBuffer(1)))!=tt||oo&&$r(new oo)!=D||aa&&$r(aa.resolve())!="[object Promise]"||zn&&$r(new zn)!=Z||ao&&$r(new ao)!=ct)&&($r=function(c){var _=Dr(c),I=_==H?c.constructor:void 0,G=I?Kn(I):"";if(G)switch(G){case Xi:return tt;case Zi:return D;case Qi:return"[object Promise]";case tu:return Z;case eu:return ct}return _});var yu=ir?An:Ja;function _o(c){var _=c&&c.constructor;return c===(typeof _=="function"&&_.prototype||Or)}function Qs(c){return c==c&&!dr(c)}function ti(c,_){return function(I){return I!=null&&I[c]===_&&(_!==void 0||c in er(I))}}function ei(c,_,I){return _=br(_===void 0?c.length-1:_,0),function(){for(var G=arguments,nt=-1,ht=br(G.length-_,0),It=Qt(ht);++nt<ht;)It[nt]=G[_+nt];nt=-1;for(var Ot=Qt(_+1);++nt<_;)Ot[nt]=G[nt];return Ot[_]=I(It),Yt(c,this,Ot)}}function ri(c,_){return _.length<2?c:Mn(c,rn(_,0,-1))}function Ta(c,_){if((_!=="constructor"||typeof c[_]!="function")&&_!="__proto__")return c[_]}var ni=ai(Cs),go=Ki||function(c,_){return or.setTimeout(c,_)},Da=ai(lu);function oi(c,_,I){var G=_+"";return Da(c,function(nt,ht){var It=ht.length;if(!It)return nt;var Ot=It-1;return ht[Ot]=(It>1?"& ":"")+ht[Ot],ht=ht.join(It>2?", ":" "),nt.replace(_e,`{
/* [wrapped with `+ht+`] */
`)}(G,function(nt,ht){return Jt(n,function(It){var Ot="_."+It[0];ht&It[1]&&!a(nt,Ot)&&nt.push(Ot)}),nt.sort()}(function(nt){var ht=nt.match(me);return ht?ht[1].split(de):[]}(G),I)))}function ai(c){var _=0,I=0;return function(){var G=zi(),nt=16-(G-I);if(I=G,nt>0){if(++_>=800)return arguments[0]}else _=0;return c.apply(void 0,arguments)}}function Uo(c,_){var I=-1,G=c.length,nt=G-1;for(_=_===void 0?G:_;++I<_;){var ht=ya(I,nt),It=c[ht];c[ht]=c[I],c[I]=It}return c.length=_,c}var si=function(c){var _=Ko(function(G){var nt=[];return G.charCodeAt(0)===46&&nt.push(""),G.replace(M,function(ht,It,Ot,qt){nt.push(Ot?qt.replace(pe,"$1"):It||ht)}),nt},function(G){return I.size===500&&I.clear(),G}),I=_.cache;return _}();function dn(c){if(typeof c=="string"||Wr(c))return c;var _=c+"";return _=="0"&&1/c==-1/0?"-0":_}function Kn(c){if(c!=null){try{return Br.call(c)}catch{}try{return c+""}catch{}}return""}function ii(c){if(c instanceof Ye)return c.clone();var _=new tn(c.__wrapped__,c.__chain__);return _.__actions__=Lr(c.__actions__),_.__index__=c.__index__,_.__values__=c.__values__,_}var mu=He(function(c,_){return yr(c)?co(c,Cr(_,1,yr,!0)):[]}),vu=He(function(c,_){var I=nn(_);return yr(I)&&(I=void 0),yr(c)?co(c,Cr(_,1,yr,!0),ke(I,2)):[]}),bu=He(function(c,_){var I=nn(_);return yr(I)&&(I=void 0),yr(c)?co(c,Cr(_,1,yr,!0),void 0,I):[]});function ui(c,_,I){var G=c==null?0:c.length;if(!G)return-1;var nt=I==null?0:Ne(I);return nt<0&&(nt=br(G+nt,0)),B(c,ke(_,3),nt)}function ci(c,_,I){var G=c==null?0:c.length;if(!G)return-1;var nt=G-1;return I!==void 0&&(nt=Ne(I),nt=I<0?br(G+nt,0):kr(nt,G-1)),B(c,ke(_,3),nt,!0)}function li(c){return c!=null&&c.length?Cr(c,1):[]}function pi(c){return c&&c.length?c[0]:void 0}var wu=He(function(c){var _=p(c,Ea);return _.length&&_[0]===c[0]?fa(_):[]}),Eu=He(function(c){var _=nn(c),I=p(c,Ea);return _===nn(I)?_=void 0:I.pop(),I.length&&I[0]===c[0]?fa(I,ke(_,2)):[]}),xu=He(function(c){var _=nn(c),I=p(c,Ea);return(_=typeof _=="function"?_:void 0)&&I.pop(),I.length&&I[0]===c[0]?fa(I,void 0,_):[]});function nn(c){var _=c==null?0:c.length;return _?c[_-1]:void 0}var Su=He(fi);function fi(c,_){return c&&c.length&&_&&_.length?ga(c,_):c}var Au=xn(function(c,_){var I=c==null?0:c.length,G=ia(c,_);return As(c,p(_,function(nt){return Sn(nt,I)?+nt:nt}).sort(Ds)),G});function ja(c){return c==null?c:Ji.call(c)}var Cu=He(function(c){return kn(Cr(c,1,yr,!0))}),Iu=He(function(c){var _=nn(c);return yr(_)&&(_=void 0),kn(Cr(c,1,yr,!0),ke(_,2))}),Pu=He(function(c){var _=nn(c);return _=typeof _=="function"?_:void 0,kn(Cr(c,1,yr,!0),void 0,_)});function Na(c){if(!c||!c.length)return[];var _=0;return c=Ee(c,function(I){if(yr(I))return _=br(I.length,_),!0}),At(_,function(I){return p(c,W(I))})}function di(c,_){if(!c||!c.length)return[];var I=Na(c);return _==null?I:p(I,function(G){return Yt(_,void 0,G)})}var Fu=He(function(c,_){return yr(c)?co(c,_):[]}),Ou=He(function(c){return wa(Ee(c,yr))}),ku=He(function(c){var _=nn(c);return yr(_)&&(_=void 0),wa(Ee(c,yr),ke(_,2))}),$u=He(function(c){var _=nn(c);return _=typeof _=="function"?_:void 0,wa(Ee(c,yr),void 0,_)}),Ru=He(Na),Tu=He(function(c){var _=c.length,I=_>1?c[_-1]:void 0;return I=typeof I=="function"?(c.pop(),I):void 0,di(c,I)});function hi(c){var _=lt(c);return _.__chain__=!0,_}function Ho(c,_){return _(c)}var Du=xn(function(c){var _=c.length,I=_?c[0]:0,G=this.__wrapped__,nt=function(ht){return ia(ht,c)};return!(_>1||this.__actions__.length)&&G instanceof Ye&&Sn(I)?((G=G.slice(I,+I+(_?1:0))).__actions__.push({func:Ho,args:[nt],thisArg:void 0}),new tn(G,this.__chain__).thru(function(ht){return _&&!ht.length&&ht.push(void 0),ht})):this.thru(nt)}),ju=Ro(function(c,_,I){Ve.call(c,I)?++c[I]:wn(c,I,1)}),Nu=Hs(ui),Bu=Hs(ci);function _i(c,_){return(je(c)?Jt:On)(c,ke(_,3))}function gi(c,_){return(je(c)?jn:ps)(c,ke(_,3))}var Lu=Ro(function(c,_,I){Ve.call(c,I)?c[I].push(_):wn(c,I,[_])}),Uu=He(function(c,_,I){var G=-1,nt=typeof _=="function",ht=Ur(c)?Qt(c.length):[];return On(c,function(It){ht[++G]=nt?Yt(_,It,I):lo(It,_,I)}),ht}),Hu=Ro(function(c,_,I){wn(c,I,_)});function Mo(c,_){return(je(c)?p:vs)(c,ke(_,3))}var Mu=Ro(function(c,_,I){c[I?0:1].push(_)},function(){return[[],[]]}),qu=He(function(c,_){if(c==null)return[];var I=_.length;return I>1&&jr(c,_[0],_[1])?_=[]:I>2&&jr(_[0],_[1],_[2])&&(_=[_[0]]),xs(c,Cr(_,1),[])}),qo=qi||function(){return or.Date.now()};function yi(c,_,I){return _=I?void 0:_,En(c,128,void 0,void 0,void 0,void 0,_=c&&_==null?c.length:_)}function mi(c,_){var I;if(typeof _!="function")throw new wr(e);return c=Ne(c),function(){return--c>0&&(I=_.apply(this,arguments)),c<=1&&(_=void 0),I}}var Ba=He(function(c,_,I){var G=1;if(I.length){var nt=X(I,Qn(Ba));G|=32}return En(c,G,_,I,nt)}),vi=He(function(c,_,I){var G=3;if(I.length){var nt=X(I,Qn(vi));G|=32}return En(_,G,c,I,nt)});function bi(c,_,I){var G,nt,ht,It,Ot,qt,oe=0,ne=!1,ue=!1,we=!0;if(typeof c!="function")throw new wr(e);function Ae(ve){var De=G,qe=nt;return G=nt=void 0,oe=ve,It=c.apply(qe,De)}function Fe(ve){var De=ve-qt;return qt===void 0||De>=_||De<0||ue&&ve-oe>=ht}function ae(){var ve=qo();if(Fe(ve))return fe(ve);Ot=go(ae,function(De){var qe=_-(De-qt);return ue?kr(qe,ht-(De-oe)):qe}(ve))}function fe(ve){return Ot=void 0,we&&G?Ae(ve):(G=nt=void 0,It)}function Pe(){var ve=qo(),De=Fe(ve);if(G=arguments,nt=this,qt=ve,De){if(Ot===void 0)return function(qe){return oe=qe,Ot=go(ae,_),ne?Ae(qe):It}(qt);if(ue)return $s(Ot),Ot=go(ae,_),Ae(qt)}return Ot===void 0&&(Ot=go(ae,_)),It}return _=on(_)||0,dr(I)&&(ne=!!I.leading,ht=(ue="maxWait"in I)?br(on(I.maxWait)||0,_):ht,we="trailing"in I?!!I.trailing:we),Pe.cancel=function(){Ot!==void 0&&$s(Ot),oe=0,G=qt=nt=Ot=void 0},Pe.flush=function(){return Ot===void 0?It:fe(qo())},Pe}var Ku=He(function(c,_){return ls(c,1,_)}),Gu=He(function(c,_,I){return ls(c,on(_)||0,I)});function Ko(c,_){if(typeof c!="function"||_!=null&&typeof _!="function")throw new wr(e);var I=function(){var G=arguments,nt=_?_.apply(this,G):G[0],ht=I.cache;if(ht.has(nt))return ht.get(nt);var It=c.apply(this,G);return I.cache=ht.set(nt,It)||ht,It};return I.cache=new(Ko.Cache||bn),I}function Go(c){if(typeof c!="function")throw new wr(e);return function(){var _=arguments;switch(_.length){case 0:return!c.call(this);case 1:return!c.call(this,_[0]);case 2:return!c.call(this,_[0],_[1]);case 3:return!c.call(this,_[0],_[1],_[2])}return!c.apply(this,_)}}Ko.Cache=bn;var Vu=du(function(c,_){var I=(_=_.length==1&&je(_[0])?p(_[0],Bt(ke())):p(Cr(_,1),Bt(ke()))).length;return He(function(G){for(var nt=-1,ht=kr(G.length,I);++nt<ht;)G[nt]=_[nt].call(this,G[nt]);return Yt(c,this,G)})}),La=He(function(c,_){return En(c,32,void 0,_,X(_,Qn(La)))}),wi=He(function(c,_){return En(c,64,void 0,_,X(_,Qn(wi)))}),Yu=xn(function(c,_){return En(c,256,void 0,void 0,void 0,_)});function ln(c,_){return c===_||c!=c&&_!=_}var zu=No(pa),Wu=No(function(c,_){return c>=_}),Gn=gs(function(){return arguments}())?gs:function(c){return _r(c)&&Ve.call(c,"callee")&&!es.call(c,"callee")},je=Qt.isArray,Ju=Lt?Bt(Lt):function(c){return _r(c)&&Dr(c)==ot};function Ur(c){return c!=null&&Vo(c.length)&&!An(c)}function yr(c){return _r(c)&&Ur(c)}var Tn=Gi||Ja,Xu=sr?Bt(sr):function(c){return _r(c)&&Dr(c)==h};function Ua(c){if(!_r(c))return!1;var _=Dr(c);return _==y||_=="[object DOMException]"||typeof c.message=="string"&&typeof c.name=="string"&&!yo(c)}function An(c){if(!dr(c))return!1;var _=Dr(c);return _==k||_==A||_=="[object AsyncFunction]"||_=="[object Proxy]"}function Ei(c){return typeof c=="number"&&c==Ne(c)}function Vo(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=9007199254740991}function dr(c){var _=typeof c;return c!=null&&(_=="object"||_=="function")}function _r(c){return c!=null&&typeof c=="object"}var xi=_n?Bt(_n):function(c){return _r(c)&&$r(c)==D};function Si(c){return typeof c=="number"||_r(c)&&Dr(c)==q}function yo(c){if(!_r(c)||Dr(c)!=H)return!1;var _=vo(c);if(_===null)return!0;var I=Ve.call(_,"constructor")&&_.constructor;return typeof I=="function"&&I instanceof I&&Br.call(I)==mn}var Ha=Ie?Bt(Ie):function(c){return _r(c)&&Dr(c)==z},Ai=fr?Bt(fr):function(c){return _r(c)&&$r(c)==Z};function Yo(c){return typeof c=="string"||!je(c)&&_r(c)&&Dr(c)==j}function Wr(c){return typeof c=="symbol"||_r(c)&&Dr(c)==at}var to=Ue?Bt(Ue):function(c){return _r(c)&&Vo(c.length)&&!!ye[Dr(c)]},Zu=No(_a),Qu=No(function(c,_){return c<=_});function Ci(c){if(!c)return[];if(Ur(c))return Yo(c)?Ft(c):Lr(c);if(no&&c[no])return function(I){for(var G,nt=[];!(G=I.next()).done;)nt.push(G.value);return nt}(c[no]());var _=$r(c);return(_==D?Se:_==Z?dt:eo)(c)}function Cn(c){return c?(c=on(c))===1/0||c===-1/0?17976931348623157e292*(c<0?-1:1):c==c?c:0:c===0?c:0}function Ne(c){var _=Cn(c),I=_%1;return _==_?I?_-I:_:0}function Ii(c){return c?Hn(Ne(c),0,4294967295):0}function on(c){if(typeof c=="number")return c;if(Wr(c))return NaN;if(dr(c)){var _=typeof c.valueOf=="function"?c.valueOf():c;c=dr(_)?_+"":_}if(typeof c!="string")return c===0?c:+c;c=Mt(c);var I=ie.test(c);return I||Kt.test(c)?Zr(c.slice(2),I?2:8):Nt.test(c)?NaN:+c}function Pi(c){return fn(c,Hr(c))}function rr(c){return c==null?"":zr(c)}var tc=Xn(function(c,_){if(_o(_)||Ur(_))fn(_,xr(_),c);else for(var I in _)Ve.call(_,I)&&uo(c,I,_[I])}),Fi=Xn(function(c,_){fn(_,Hr(_),c)}),zo=Xn(function(c,_,I,G){fn(_,Hr(_),c,G)}),ec=Xn(function(c,_,I,G){fn(_,xr(_),c,G)}),rc=xn(ia),nc=He(function(c,_){c=er(c);var I=-1,G=_.length,nt=G>2?_[2]:void 0;for(nt&&jr(_[0],_[1],nt)&&(G=1);++I<G;)for(var ht=_[I],It=Hr(ht),Ot=-1,qt=It.length;++Ot<qt;){var oe=It[Ot],ne=c[oe];(ne===void 0||ln(ne,Or[oe])&&!Ve.call(c,oe))&&(c[oe]=ht[oe])}return c}),oc=He(function(c){return c.push(void 0,zs),Yt(Oi,void 0,c)});function Ma(c,_,I){var G=c==null?void 0:Mn(c,_);return G===void 0?I:G}function qa(c,_){return c!=null&&Xs(c,_,iu)}var ac=qs(function(c,_,I){_!=null&&typeof _.toString!="function"&&(_=Qr.call(_)),c[_]=I},Ga(Mr)),sc=qs(function(c,_,I){_!=null&&typeof _.toString!="function"&&(_=Qr.call(_)),Ve.call(c,_)?c[_].push(I):c[_]=[I]},ke),ic=He(lo);function xr(c){return Ur(c)?ss(c):ha(c)}function Hr(c){return Ur(c)?ss(c,!0):function(_){if(!dr(_))return function(ht){var It=[];if(ht!=null)for(var Ot in er(ht))It.push(Ot);return It}(_);var I=_o(_),G=[];for(var nt in _)(nt!="constructor"||!I&&Ve.call(_,nt))&&G.push(nt);return G}(c)}var uc=Xn(function(c,_,I){Oo(c,_,I)}),Oi=Xn(function(c,_,I,G){Oo(c,_,I,G)}),cc=xn(function(c,_){var I={};if(c==null)return I;var G=!1;_=p(_,function(ht){return ht=$n(ht,c),G||(G=ht.length>1),ht}),fn(c,Pa(c),I),G&&(I=en(I,7,_u));for(var nt=_.length;nt--;)ba(I,_[nt]);return I}),lc=xn(function(c,_){return c==null?{}:function(I,G){return Ss(I,G,function(nt,ht){return qa(I,ht)})}(c,_)});function ki(c,_){if(c==null)return{};var I=p(Pa(c),function(G){return[G]});return _=ke(_),Ss(c,I,function(G,nt){return _(G,nt[0])})}var $i=Vs(xr),Ri=Vs(Hr);function eo(c){return c==null?[]:Q(c,xr(c))}var pc=Zn(function(c,_,I){return _=_.toLowerCase(),c+(I?Ti(_):_)});function Ti(c){return Ka(rr(c).toLowerCase())}function Di(c){return(c=rr(c))&&c.replace(v,bt).replace(an,"")}var fc=Zn(function(c,_,I){return c+(I?"-":"")+_.toLowerCase()}),dc=Zn(function(c,_,I){return c+(I?" ":"")+_.toLowerCase()}),hc=Us("toLowerCase"),_c=Zn(function(c,_,I){return c+(I?"_":"")+_.toLowerCase()}),gc=Zn(function(c,_,I){return c+(I?" ":"")+Ka(_)}),yc=Zn(function(c,_,I){return c+(I?" ":"")+_.toUpperCase()}),Ka=Us("toUpperCase");function ji(c,_,I){return c=rr(c),(_=I?void 0:_)===void 0?function(G){return Xr.test(G)}(c)?function(G){return G.match(Vr)||[]}(c):function(G){return G.match(Xt)||[]}(c):c.match(_)||[]}var Ni=He(function(c,_){try{return Yt(c,void 0,_)}catch(I){return Ua(I)?I:new $e(I)}}),mc=xn(function(c,_){return Jt(_,function(I){I=dn(I),wn(c,I,Ba(c[I],c))}),c});function Ga(c){return function(){return c}}var vc=Ms(),bc=Ms(!0);function Mr(c){return c}function Va(c){return ms(typeof c=="function"?c:en(c,1))}var wc=He(function(c,_){return function(I){return lo(I,c,_)}}),Ec=He(function(c,_){return function(I){return lo(c,I,_)}});function Ya(c,_,I){var G=xr(_),nt=Fo(_,G);I!=null||dr(_)&&(nt.length||!G.length)||(I=_,_=c,c=this,nt=Fo(_,xr(_)));var ht=!(dr(I)&&"chain"in I&&!I.chain),It=An(c);return Jt(nt,function(Ot){var qt=_[Ot];c[Ot]=qt,It&&(c.prototype[Ot]=function(){var oe=this.__chain__;if(ht||oe){var ne=c(this.__wrapped__);return(ne.__actions__=Lr(this.__actions__)).push({func:qt,args:arguments,thisArg:c}),ne.__chain__=oe,ne}return qt.apply(c,g([this.value()],arguments))})}),c}function za(){}var xc=Aa(p),Sc=Aa(Pn),Ac=Aa(F);function Bi(c){return $a(c)?W(dn(c)):function(_){return function(I){return Mn(I,_)}}(c)}var Cc=Ks(),Ic=Ks(!0);function Wa(){return[]}function Ja(){return!1}var Xa,Pc=Do(function(c,_){return c+_},0),Fc=Ca("ceil"),Oc=Do(function(c,_){return c/_},1),kc=Ca("floor"),$c=Do(function(c,_){return c*_},1),Rc=Ca("round"),Tc=Do(function(c,_){return c-_},0);return lt.after=function(c,_){if(typeof _!="function")throw new wr(e);return c=Ne(c),function(){if(--c<1)return _.apply(this,arguments)}},lt.ary=yi,lt.assign=tc,lt.assignIn=Fi,lt.assignInWith=zo,lt.assignWith=ec,lt.at=rc,lt.before=mi,lt.bind=Ba,lt.bindAll=mc,lt.bindKey=vi,lt.castArray=function(){if(!arguments.length)return[];var c=arguments[0];return je(c)?c:[c]},lt.chain=hi,lt.chunk=function(c,_,I){_=(I?jr(c,_,I):_===void 0)?1:br(Ne(_),0);var G=c==null?0:c.length;if(!G||_<1)return[];for(var nt=0,ht=0,It=Qt(Eo(G/_));nt<G;)It[ht++]=rn(c,nt,nt+=_);return It},lt.compact=function(c){for(var _=-1,I=c==null?0:c.length,G=0,nt=[];++_<I;){var ht=c[_];ht&&(nt[G++]=ht)}return nt},lt.concat=function(){var c=arguments.length;if(!c)return[];for(var _=Qt(c-1),I=arguments[0],G=c;G--;)_[G-1]=arguments[G];return g(je(I)?Lr(I):[I],Cr(_,1))},lt.cond=function(c){var _=c==null?0:c.length,I=ke();return c=_?p(c,function(G){if(typeof G[1]!="function")throw new wr(e);return[I(G[0]),G[1]]}):[],He(function(G){for(var nt=-1;++nt<_;){var ht=c[nt];if(Yt(ht[0],this,G))return Yt(ht[1],this,G)}})},lt.conforms=function(c){return function(_){var I=xr(_);return function(G){return cs(G,_,I)}}(en(c,1))},lt.constant=Ga,lt.countBy=ju,lt.create=function(c,_){var I=Jn(c);return _==null?I:us(I,_)},lt.curry=function c(_,I,G){var nt=En(_,8,void 0,void 0,void 0,void 0,void 0,I=G?void 0:I);return nt.placeholder=c.placeholder,nt},lt.curryRight=function c(_,I,G){var nt=En(_,16,void 0,void 0,void 0,void 0,void 0,I=G?void 0:I);return nt.placeholder=c.placeholder,nt},lt.debounce=bi,lt.defaults=nc,lt.defaultsDeep=oc,lt.defer=Ku,lt.delay=Gu,lt.difference=mu,lt.differenceBy=vu,lt.differenceWith=bu,lt.drop=function(c,_,I){var G=c==null?0:c.length;return G?rn(c,(_=I||_===void 0?1:Ne(_))<0?0:_,G):[]},lt.dropRight=function(c,_,I){var G=c==null?0:c.length;return G?rn(c,0,(_=G-(_=I||_===void 0?1:Ne(_)))<0?0:_):[]},lt.dropRightWhile=function(c,_){return c&&c.length?$o(c,ke(_,3),!0,!0):[]},lt.dropWhile=function(c,_){return c&&c.length?$o(c,ke(_,3),!0):[]},lt.fill=function(c,_,I,G){var nt=c==null?0:c.length;return nt?(I&&typeof I!="number"&&jr(c,_,I)&&(I=0,G=nt),function(ht,It,Ot,qt){var oe=ht.length;for((Ot=Ne(Ot))<0&&(Ot=-Ot>oe?0:oe+Ot),(qt=qt===void 0||qt>oe?oe:Ne(qt))<0&&(qt+=oe),qt=Ot>qt?0:Ii(qt);Ot<qt;)ht[Ot++]=It;return ht}(c,_,I,G)):[]},lt.filter=function(c,_){return(je(c)?Ee:ds)(c,ke(_,3))},lt.flatMap=function(c,_){return Cr(Mo(c,_),1)},lt.flatMapDeep=function(c,_){return Cr(Mo(c,_),1/0)},lt.flatMapDepth=function(c,_,I){return I=I===void 0?1:Ne(I),Cr(Mo(c,_),I)},lt.flatten=li,lt.flattenDeep=function(c){return c!=null&&c.length?Cr(c,1/0):[]},lt.flattenDepth=function(c,_){return c!=null&&c.length?Cr(c,_=_===void 0?1:Ne(_)):[]},lt.flip=function(c){return En(c,512)},lt.flow=vc,lt.flowRight=bc,lt.fromPairs=function(c){for(var _=-1,I=c==null?0:c.length,G={};++_<I;){var nt=c[_];G[nt[0]]=nt[1]}return G},lt.functions=function(c){return c==null?[]:Fo(c,xr(c))},lt.functionsIn=function(c){return c==null?[]:Fo(c,Hr(c))},lt.groupBy=Lu,lt.initial=function(c){return c!=null&&c.length?rn(c,0,-1):[]},lt.intersection=wu,lt.intersectionBy=Eu,lt.intersectionWith=xu,lt.invert=ac,lt.invertBy=sc,lt.invokeMap=Uu,lt.iteratee=Va,lt.keyBy=Hu,lt.keys=xr,lt.keysIn=Hr,lt.map=Mo,lt.mapKeys=function(c,_){var I={};return _=ke(_,3),pn(c,function(G,nt,ht){wn(I,_(G,nt,ht),G)}),I},lt.mapValues=function(c,_){var I={};return _=ke(_,3),pn(c,function(G,nt,ht){wn(I,nt,_(G,nt,ht))}),I},lt.matches=function(c){return bs(en(c,1))},lt.matchesProperty=function(c,_){return ws(c,en(_,1))},lt.memoize=Ko,lt.merge=uc,lt.mergeWith=Oi,lt.method=wc,lt.methodOf=Ec,lt.mixin=Ya,lt.negate=Go,lt.nthArg=function(c){return c=Ne(c),He(function(_){return Es(_,c)})},lt.omit=cc,lt.omitBy=function(c,_){return ki(c,Go(ke(_)))},lt.once=function(c){return mi(2,c)},lt.orderBy=function(c,_,I,G){return c==null?[]:(je(_)||(_=_==null?[]:[_]),je(I=G?void 0:I)||(I=I==null?[]:[I]),xs(c,_,I))},lt.over=xc,lt.overArgs=Vu,lt.overEvery=Sc,lt.overSome=Ac,lt.partial=La,lt.partialRight=wi,lt.partition=Mu,lt.pick=lc,lt.pickBy=ki,lt.property=Bi,lt.propertyOf=function(c){return function(_){return c==null?void 0:Mn(c,_)}},lt.pull=Su,lt.pullAll=fi,lt.pullAllBy=function(c,_,I){return c&&c.length&&_&&_.length?ga(c,_,ke(I,2)):c},lt.pullAllWith=function(c,_,I){return c&&c.length&&_&&_.length?ga(c,_,void 0,I):c},lt.pullAt=Au,lt.range=Cc,lt.rangeRight=Ic,lt.rearg=Yu,lt.reject=function(c,_){return(je(c)?Ee:ds)(c,Go(ke(_,3)))},lt.remove=function(c,_){var I=[];if(!c||!c.length)return I;var G=-1,nt=[],ht=c.length;for(_=ke(_,3);++G<ht;){var It=c[G];_(It,G,c)&&(I.push(It),nt.push(G))}return As(c,nt),I},lt.rest=function(c,_){if(typeof c!="function")throw new wr(e);return He(c,_=_===void 0?_:Ne(_))},lt.reverse=ja,lt.sampleSize=function(c,_,I){return _=(I?jr(c,_,I):_===void 0)?1:Ne(_),(je(c)?ru:cu)(c,_)},lt.set=function(c,_,I){return c==null?c:fo(c,_,I)},lt.setWith=function(c,_,I,G){return G=typeof G=="function"?G:void 0,c==null?c:fo(c,_,I,G)},lt.shuffle=function(c){return(je(c)?nu:pu)(c)},lt.slice=function(c,_,I){var G=c==null?0:c.length;return G?(I&&typeof I!="number"&&jr(c,_,I)?(_=0,I=G):(_=_==null?0:Ne(_),I=I===void 0?G:Ne(I)),rn(c,_,I)):[]},lt.sortBy=qu,lt.sortedUniq=function(c){return c&&c.length?Is(c):[]},lt.sortedUniqBy=function(c,_){return c&&c.length?Is(c,ke(_,2)):[]},lt.split=function(c,_,I){return I&&typeof I!="number"&&jr(c,_,I)&&(_=I=void 0),(I=I===void 0?4294967295:I>>>0)?(c=rr(c))&&(typeof _=="string"||_!=null&&!Ha(_))&&!(_=zr(_))&&Ht(c)?Rn(Ft(c),0,I):c.split(_,I):[]},lt.spread=function(c,_){if(typeof c!="function")throw new wr(e);return _=_==null?0:br(Ne(_),0),He(function(I){var G=I[_],nt=Rn(I,0,_);return G&&g(nt,G),Yt(c,this,nt)})},lt.tail=function(c){var _=c==null?0:c.length;return _?rn(c,1,_):[]},lt.take=function(c,_,I){return c&&c.length?rn(c,0,(_=I||_===void 0?1:Ne(_))<0?0:_):[]},lt.takeRight=function(c,_,I){var G=c==null?0:c.length;return G?rn(c,(_=G-(_=I||_===void 0?1:Ne(_)))<0?0:_,G):[]},lt.takeRightWhile=function(c,_){return c&&c.length?$o(c,ke(_,3),!1,!0):[]},lt.takeWhile=function(c,_){return c&&c.length?$o(c,ke(_,3)):[]},lt.tap=function(c,_){return _(c),c},lt.throttle=function(c,_,I){var G=!0,nt=!0;if(typeof c!="function")throw new wr(e);return dr(I)&&(G="leading"in I?!!I.leading:G,nt="trailing"in I?!!I.trailing:nt),bi(c,_,{leading:G,maxWait:_,trailing:nt})},lt.thru=Ho,lt.toArray=Ci,lt.toPairs=$i,lt.toPairsIn=Ri,lt.toPath=function(c){return je(c)?p(c,dn):Wr(c)?[c]:Lr(si(rr(c)))},lt.toPlainObject=Pi,lt.transform=function(c,_,I){var G=je(c),nt=G||Tn(c)||to(c);if(_=ke(_,4),I==null){var ht=c&&c.constructor;I=nt?G?new ht:[]:dr(c)&&An(ht)?Jn(vo(c)):{}}return(nt?Jt:pn)(c,function(It,Ot,qt){return _(I,It,Ot,qt)}),I},lt.unary=function(c){return yi(c,1)},lt.union=Cu,lt.unionBy=Iu,lt.unionWith=Pu,lt.uniq=function(c){return c&&c.length?kn(c):[]},lt.uniqBy=function(c,_){return c&&c.length?kn(c,ke(_,2)):[]},lt.uniqWith=function(c,_){return _=typeof _=="function"?_:void 0,c&&c.length?kn(c,void 0,_):[]},lt.unset=function(c,_){return c==null||ba(c,_)},lt.unzip=Na,lt.unzipWith=di,lt.update=function(c,_,I){return c==null?c:Fs(c,_,xa(I))},lt.updateWith=function(c,_,I,G){return G=typeof G=="function"?G:void 0,c==null?c:Fs(c,_,xa(I),G)},lt.values=eo,lt.valuesIn=function(c){return c==null?[]:Q(c,Hr(c))},lt.without=Fu,lt.words=ji,lt.wrap=function(c,_){return La(xa(_),c)},lt.xor=Ou,lt.xorBy=ku,lt.xorWith=$u,lt.zip=Ru,lt.zipObject=function(c,_){return ks(c||[],_||[],uo)},lt.zipObjectDeep=function(c,_){return ks(c||[],_||[],fo)},lt.zipWith=Tu,lt.entries=$i,lt.entriesIn=Ri,lt.extend=Fi,lt.extendWith=zo,Ya(lt,lt),lt.add=Pc,lt.attempt=Ni,lt.camelCase=pc,lt.capitalize=Ti,lt.ceil=Fc,lt.clamp=function(c,_,I){return I===void 0&&(I=_,_=void 0),I!==void 0&&(I=(I=on(I))==I?I:0),_!==void 0&&(_=(_=on(_))==_?_:0),Hn(on(c),_,I)},lt.clone=function(c){return en(c,4)},lt.cloneDeep=function(c){return en(c,5)},lt.cloneDeepWith=function(c,_){return en(c,5,_=typeof _=="function"?_:void 0)},lt.cloneWith=function(c,_){return en(c,4,_=typeof _=="function"?_:void 0)},lt.conformsTo=function(c,_){return _==null||cs(c,_,xr(_))},lt.deburr=Di,lt.defaultTo=function(c,_){return c==null||c!=c?_:c},lt.divide=Oc,lt.endsWith=function(c,_,I){c=rr(c),_=zr(_);var G=c.length,nt=I=I===void 0?G:Hn(Ne(I),0,G);return(I-=_.length)>=0&&c.slice(I,nt)==_},lt.eq=ln,lt.escape=function(c){return(c=rr(c))&&x.test(c)?c.replace(xt,$t):c},lt.escapeRegExp=function(c){return(c=rr(c))&&Pt.test(c)?c.replace(et,"\\$&"):c},lt.every=function(c,_,I){var G=je(c)?Pn:au;return I&&jr(c,_,I)&&(_=void 0),G(c,ke(_,3))},lt.find=Nu,lt.findIndex=ui,lt.findKey=function(c,_){return P(c,ke(_,3),pn)},lt.findLast=Bu,lt.findLastIndex=ci,lt.findLastKey=function(c,_){return P(c,ke(_,3),la)},lt.floor=kc,lt.forEach=_i,lt.forEachRight=gi,lt.forIn=function(c,_){return c==null?c:ca(c,ke(_,3),Hr)},lt.forInRight=function(c,_){return c==null?c:hs(c,ke(_,3),Hr)},lt.forOwn=function(c,_){return c&&pn(c,ke(_,3))},lt.forOwnRight=function(c,_){return c&&la(c,ke(_,3))},lt.get=Ma,lt.gt=zu,lt.gte=Wu,lt.has=function(c,_){return c!=null&&Xs(c,_,su)},lt.hasIn=qa,lt.head=pi,lt.identity=Mr,lt.includes=function(c,_,I,G){c=Ur(c)?c:eo(c),I=I&&!G?Ne(I):0;var nt=c.length;return I<0&&(I=br(nt+I,0)),Yo(c)?I<=nt&&c.indexOf(_,I)>-1:!!nt&&K(c,_,I)>-1},lt.indexOf=function(c,_,I){var G=c==null?0:c.length;if(!G)return-1;var nt=I==null?0:Ne(I);return nt<0&&(nt=br(G+nt,0)),K(c,_,nt)},lt.inRange=function(c,_,I){return _=Cn(_),I===void 0?(I=_,_=0):I=Cn(I),function(G,nt,ht){return G>=kr(nt,ht)&&G<br(nt,ht)}(c=on(c),_,I)},lt.invoke=ic,lt.isArguments=Gn,lt.isArray=je,lt.isArrayBuffer=Ju,lt.isArrayLike=Ur,lt.isArrayLikeObject=yr,lt.isBoolean=function(c){return c===!0||c===!1||_r(c)&&Dr(c)==d},lt.isBuffer=Tn,lt.isDate=Xu,lt.isElement=function(c){return _r(c)&&c.nodeType===1&&!yo(c)},lt.isEmpty=function(c){if(c==null)return!0;if(Ur(c)&&(je(c)||typeof c=="string"||typeof c.splice=="function"||Tn(c)||to(c)||Gn(c)))return!c.length;var _=$r(c);if(_==D||_==Z)return!c.size;if(_o(c))return!ha(c).length;for(var I in c)if(Ve.call(c,I))return!1;return!0},lt.isEqual=function(c,_){return po(c,_)},lt.isEqualWith=function(c,_,I){var G=(I=typeof I=="function"?I:void 0)?I(c,_):void 0;return G===void 0?po(c,_,void 0,I):!!G},lt.isError=Ua,lt.isFinite=function(c){return typeof c=="number"&&ns(c)},lt.isFunction=An,lt.isInteger=Ei,lt.isLength=Vo,lt.isMap=xi,lt.isMatch=function(c,_){return c===_||da(c,_,Oa(_))},lt.isMatchWith=function(c,_,I){return I=typeof I=="function"?I:void 0,da(c,_,Oa(_),I)},lt.isNaN=function(c){return Si(c)&&c!=+c},lt.isNative=function(c){if(yu(c))throw new $e("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return ys(c)},lt.isNil=function(c){return c==null},lt.isNull=function(c){return c===null},lt.isNumber=Si,lt.isObject=dr,lt.isObjectLike=_r,lt.isPlainObject=yo,lt.isRegExp=Ha,lt.isSafeInteger=function(c){return Ei(c)&&c>=-9007199254740991&&c<=9007199254740991},lt.isSet=Ai,lt.isString=Yo,lt.isSymbol=Wr,lt.isTypedArray=to,lt.isUndefined=function(c){return c===void 0},lt.isWeakMap=function(c){return _r(c)&&$r(c)==ct},lt.isWeakSet=function(c){return _r(c)&&Dr(c)=="[object WeakSet]"},lt.join=function(c,_){return c==null?"":Vi.call(c,_)},lt.kebabCase=fc,lt.last=nn,lt.lastIndexOf=function(c,_,I){var G=c==null?0:c.length;if(!G)return-1;var nt=G;return I!==void 0&&(nt=(nt=Ne(I))<0?br(G+nt,0):kr(nt,G-1)),_==_?function(ht,It,Ot){for(var qt=Ot+1;qt--;)if(ht[qt]===It)return qt;return qt}(c,_,nt):B(c,O,nt,!0)},lt.lowerCase=dc,lt.lowerFirst=hc,lt.lt=Zu,lt.lte=Qu,lt.max=function(c){return c&&c.length?Po(c,Mr,pa):void 0},lt.maxBy=function(c,_){return c&&c.length?Po(c,ke(_,2),pa):void 0},lt.mean=function(c){return U(c,Mr)},lt.meanBy=function(c,_){return U(c,ke(_,2))},lt.min=function(c){return c&&c.length?Po(c,Mr,_a):void 0},lt.minBy=function(c,_){return c&&c.length?Po(c,ke(_,2),_a):void 0},lt.stubArray=Wa,lt.stubFalse=Ja,lt.stubObject=function(){return{}},lt.stubString=function(){return""},lt.stubTrue=function(){return!0},lt.multiply=$c,lt.nth=function(c,_){return c&&c.length?Es(c,Ne(_)):void 0},lt.noConflict=function(){return or._===this&&(or._=ta),this},lt.noop=za,lt.now=qo,lt.pad=function(c,_,I){c=rr(c);var G=(_=Ne(_))?Rt(c):0;if(!_||G>=_)return c;var nt=(_-G)/2;return jo(xo(nt),I)+c+jo(Eo(nt),I)},lt.padEnd=function(c,_,I){c=rr(c);var G=(_=Ne(_))?Rt(c):0;return _&&G<_?c+jo(_-G,I):c},lt.padStart=function(c,_,I){c=rr(c);var G=(_=Ne(_))?Rt(c):0;return _&&G<_?jo(_-G,I)+c:c},lt.parseInt=function(c,_,I){return I||_==null?_=0:_&&(_=+_),Wi(rr(c).replace(Ut,""),_||0)},lt.random=function(c,_,I){if(I&&typeof I!="boolean"&&jr(c,_,I)&&(_=I=void 0),I===void 0&&(typeof _=="boolean"?(I=_,_=void 0):typeof c=="boolean"&&(I=c,c=void 0)),c===void 0&&_===void 0?(c=0,_=1):(c=Cn(c),_===void 0?(_=c,c=0):_=Cn(_)),c>_){var G=c;c=_,_=G}if(I||c%1||_%1){var nt=os();return kr(c+nt*(_-c+he("1e-"+((nt+"").length-1))),_)}return ya(c,_)},lt.reduce=function(c,_,I){var G=je(c)?m:st,nt=arguments.length<3;return G(c,ke(_,4),I,nt,On)},lt.reduceRight=function(c,_,I){var G=je(c)?w:st,nt=arguments.length<3;return G(c,ke(_,4),I,nt,ps)},lt.repeat=function(c,_,I){return _=(I?jr(c,_,I):_===void 0)?1:Ne(_),ma(rr(c),_)},lt.replace=function(){var c=arguments,_=rr(c[0]);return c.length<3?_:_.replace(c[1],c[2])},lt.result=function(c,_,I){var G=-1,nt=(_=$n(_,c)).length;for(nt||(nt=1,c=void 0);++G<nt;){var ht=c?.[dn(_[G])];ht===void 0&&(G=nt,ht=I),c=An(ht)?ht.call(c):ht}return c},lt.round=Rc,lt.runInContext=Et,lt.sample=function(c){return(je(c)?is:uu)(c)},lt.size=function(c){if(c==null)return 0;if(Ur(c))return Yo(c)?Rt(c):c.length;var _=$r(c);return _==D||_==Z?c.size:ha(c).length},lt.snakeCase=_c,lt.some=function(c,_,I){var G=je(c)?F:fu;return I&&jr(c,_,I)&&(_=void 0),G(c,ke(_,3))},lt.sortedIndex=function(c,_){return ko(c,_)},lt.sortedIndexBy=function(c,_,I){return va(c,_,ke(I,2))},lt.sortedIndexOf=function(c,_){var I=c==null?0:c.length;if(I){var G=ko(c,_);if(G<I&&ln(c[G],_))return G}return-1},lt.sortedLastIndex=function(c,_){return ko(c,_,!0)},lt.sortedLastIndexBy=function(c,_,I){return va(c,_,ke(I,2),!0)},lt.sortedLastIndexOf=function(c,_){if(c!=null&&c.length){var I=ko(c,_,!0)-1;if(ln(c[I],_))return I}return-1},lt.startCase=gc,lt.startsWith=function(c,_,I){return c=rr(c),I=I==null?0:Hn(Ne(I),0,c.length),_=zr(_),c.slice(I,I+_.length)==_},lt.subtract=Tc,lt.sum=function(c){return c&&c.length?vt(c,Mr):0},lt.sumBy=function(c,_){return c&&c.length?vt(c,ke(_,2)):0},lt.template=function(c,_,I){var G=lt.templateSettings;I&&jr(c,_,I)&&(_=void 0),c=rr(c),_=zo({},_,G,Ys);var nt,ht,It=zo({},_.imports,G.imports,Ys),Ot=xr(It),qt=Q(It,Ot),oe=0,ne=_.interpolate||Be,ue="__p += '",we=gn((_.escape||Be).source+"|"+ne.source+"|"+(ne===S?ge:Be).source+"|"+(_.evaluate||Be).source+"|$","g"),Ae="//# sourceURL="+(Ve.call(_,"sourceURL")?(_.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++se+"]")+`
`;c.replace(we,function(fe,Pe,ve,De,qe,Ze){return ve||(ve=De),ue+=c.slice(oe,Ze).replace(ce,Wt),Pe&&(nt=!0,ue+=`' +
__e(`+Pe+`) +
'`),qe&&(ht=!0,ue+=`';
`+qe+`;
__p += '`),ve&&(ue+=`' +
((__t = (`+ve+`)) == null ? '' : __t) +
'`),oe=Ze+fe.length,fe}),ue+=`';
`;var Fe=Ve.call(_,"variable")&&_.variable;if(Fe){if(Gt.test(Fe))throw new $e("Invalid `variable` option passed into `_.template`")}else ue=`with (obj) {
`+ue+`
}
`;ue=(ht?ue.replace($,""):ue).replace(E,"$1").replace(rt,"$1;"),ue="function("+(Fe||"obj")+`) {
`+(Fe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(nt?", __e = _.escape":"")+(ht?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ue+`return __p
}`;var ae=Ni(function(){return pr(Ot,Ae+"return "+ue).apply(void 0,qt)});if(ae.source=ue,Ua(ae))throw ae;return ae},lt.times=function(c,_){if((c=Ne(c))<1||c>9007199254740991)return[];var I=4294967295,G=kr(c,4294967295);c-=4294967295;for(var nt=At(G,_=ke(_));++I<c;)_(I);return nt},lt.toFinite=Cn,lt.toInteger=Ne,lt.toLength=Ii,lt.toLower=function(c){return rr(c).toLowerCase()},lt.toNumber=on,lt.toSafeInteger=function(c){return c?Hn(Ne(c),-9007199254740991,9007199254740991):c===0?c:0},lt.toString=rr,lt.toUpper=function(c){return rr(c).toUpperCase()},lt.trim=function(c,_,I){if((c=rr(c))&&(I||_===void 0))return Mt(c);if(!c||!(_=zr(_)))return c;var G=Ft(c),nt=Ft(_);return Rn(G,pt(G,nt),it(G,nt)+1).join("")},lt.trimEnd=function(c,_,I){if((c=rr(c))&&(I||_===void 0))return c.slice(0,jt(c)+1);if(!c||!(_=zr(_)))return c;var G=Ft(c);return Rn(G,0,it(G,Ft(_))+1).join("")},lt.trimStart=function(c,_,I){if((c=rr(c))&&(I||_===void 0))return c.replace(Ut,"");if(!c||!(_=zr(_)))return c;var G=Ft(c);return Rn(G,pt(G,Ft(_))).join("")},lt.truncate=function(c,_){var I=30,G="...";if(dr(_)){var nt="separator"in _?_.separator:nt;I="length"in _?Ne(_.length):I,G="omission"in _?zr(_.omission):G}var ht=(c=rr(c)).length;if(Ht(c)){var It=Ft(c);ht=It.length}if(I>=ht)return c;var Ot=I-Rt(G);if(Ot<1)return G;var qt=It?Rn(It,0,Ot).join(""):c.slice(0,Ot);if(nt===void 0)return qt+G;if(It&&(Ot+=qt.length-Ot),Ha(nt)){if(c.slice(Ot).search(nt)){var oe,ne=qt;for(nt.global||(nt=gn(nt.source,rr(Dt.exec(nt))+"g")),nt.lastIndex=0;oe=nt.exec(ne);)var ue=oe.index;qt=qt.slice(0,ue===void 0?Ot:ue)}}else if(c.indexOf(zr(nt),Ot)!=Ot){var we=qt.lastIndexOf(nt);we>-1&&(qt=qt.slice(0,we))}return qt+G},lt.unescape=function(c){return(c=rr(c))&&St.test(c)?c.replace(_t,re):c},lt.uniqueId=function(c){var _=++Er;return rr(c)+_},lt.upperCase=yc,lt.upperFirst=Ka,lt.each=_i,lt.eachRight=gi,lt.first=pi,Ya(lt,(Xa={},pn(lt,function(c,_){Ve.call(lt.prototype,_)||(Xa[_]=c)}),Xa),{chain:!1}),lt.VERSION="4.17.21",Jt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(c){lt[c].placeholder=lt}),Jt(["drop","take"],function(c,_){Ye.prototype[c]=function(I){I=I===void 0?1:br(Ne(I),0);var G=this.__filtered__&&!_?new Ye(this):this.clone();return G.__filtered__?G.__takeCount__=kr(I,G.__takeCount__):G.__views__.push({size:kr(I,4294967295),type:c+(G.__dir__<0?"Right":"")}),G},Ye.prototype[c+"Right"]=function(I){return this.reverse()[c](I).reverse()}}),Jt(["filter","map","takeWhile"],function(c,_){var I=_+1,G=I==1||I==3;Ye.prototype[c]=function(nt){var ht=this.clone();return ht.__iteratees__.push({iteratee:ke(nt,3),type:I}),ht.__filtered__=ht.__filtered__||G,ht}}),Jt(["head","last"],function(c,_){var I="take"+(_?"Right":"");Ye.prototype[c]=function(){return this[I](1).value()[0]}}),Jt(["initial","tail"],function(c,_){var I="drop"+(_?"":"Right");Ye.prototype[c]=function(){return this.__filtered__?new Ye(this):this[I](1)}}),Ye.prototype.compact=function(){return this.filter(Mr)},Ye.prototype.find=function(c){return this.filter(c).head()},Ye.prototype.findLast=function(c){return this.reverse().find(c)},Ye.prototype.invokeMap=He(function(c,_){return typeof c=="function"?new Ye(this):this.map(function(I){return lo(I,c,_)})}),Ye.prototype.reject=function(c){return this.filter(Go(ke(c)))},Ye.prototype.slice=function(c,_){c=Ne(c);var I=this;return I.__filtered__&&(c>0||_<0)?new Ye(I):(c<0?I=I.takeRight(-c):c&&(I=I.drop(c)),_!==void 0&&(I=(_=Ne(_))<0?I.dropRight(-_):I.take(_-c)),I)},Ye.prototype.takeRightWhile=function(c){return this.reverse().takeWhile(c).reverse()},Ye.prototype.toArray=function(){return this.take(4294967295)},pn(Ye.prototype,function(c,_){var I=/^(?:filter|find|map|reject)|While$/.test(_),G=/^(?:head|last)$/.test(_),nt=lt[G?"take"+(_=="last"?"Right":""):_],ht=G||/^find/.test(_);nt&&(lt.prototype[_]=function(){var It=this.__wrapped__,Ot=G?[1]:arguments,qt=It instanceof Ye,oe=Ot[0],ne=qt||je(It),ue=function(Pe){var ve=nt.apply(lt,g([Pe],Ot));return G&&we?ve[0]:ve};ne&&I&&typeof oe=="function"&&oe.length!=1&&(qt=ne=!1);var we=this.__chain__,Ae=!!this.__actions__.length,Fe=ht&&!we,ae=qt&&!Ae;if(!ht&&ne){It=ae?It:new Ye(this);var fe=c.apply(It,Ot);return fe.__actions__.push({func:Ho,args:[ue],thisArg:void 0}),new tn(fe,we)}return Fe&&ae?c.apply(this,Ot):(fe=this.thru(ue),Fe?G?fe.value()[0]:fe.value():fe)})}),Jt(["pop","push","shift","sort","splice","unshift"],function(c){var _=Fr[c],I=/^(?:push|sort|unshift)$/.test(c)?"tap":"thru",G=/^(?:pop|shift)$/.test(c);lt.prototype[c]=function(){var nt=arguments;if(G&&!this.__chain__){var ht=this.value();return _.apply(je(ht)?ht:[],nt)}return this[I](function(It){return _.apply(je(It)?It:[],nt)})}}),pn(Ye.prototype,function(c,_){var I=lt[_];if(I){var G=I.name+"";Ve.call(Wn,G)||(Wn[G]=[]),Wn[G].push({name:_,func:I})}}),Wn[To(void 0,2).name]=[{name:"wrapper",func:void 0}],Ye.prototype.clone=function(){var c=new Ye(this.__wrapped__);return c.__actions__=Lr(this.__actions__),c.__dir__=this.__dir__,c.__filtered__=this.__filtered__,c.__iteratees__=Lr(this.__iteratees__),c.__takeCount__=this.__takeCount__,c.__views__=Lr(this.__views__),c},Ye.prototype.reverse=function(){if(this.__filtered__){var c=new Ye(this);c.__dir__=-1,c.__filtered__=!0}else(c=this.clone()).__dir__*=-1;return c},Ye.prototype.value=function(){var c=this.__wrapped__.value(),_=this.__dir__,I=je(c),G=_<0,nt=I?c.length:0,ht=function(Ze,Ce,Oe){for(var mr=-1,vr=Oe.length;++mr<vr;){var Nr=Oe[mr],cr=Nr.size;switch(Nr.type){case"drop":Ze+=cr;break;case"dropRight":Ce-=cr;break;case"take":Ce=kr(Ce,Ze+cr);break;case"takeRight":Ze=br(Ze,Ce-cr)}}return{start:Ze,end:Ce}}(0,nt,this.__views__),It=ht.start,Ot=ht.end,qt=Ot-It,oe=G?Ot:It-1,ne=this.__iteratees__,ue=ne.length,we=0,Ae=kr(qt,this.__takeCount__);if(!I||!G&&nt==qt&&Ae==qt)return Os(c,this.__actions__);var Fe=[];t:for(;qt--&&we<Ae;){for(var ae=-1,fe=c[oe+=_];++ae<ue;){var Pe=ne[ae],ve=Pe.iteratee,De=Pe.type,qe=ve(fe);if(De==2)fe=qe;else if(!qe){if(De==1)continue t;break t}}Fe[we++]=fe}return Fe},lt.prototype.at=Du,lt.prototype.chain=function(){return hi(this)},lt.prototype.commit=function(){return new tn(this.value(),this.__chain__)},lt.prototype.next=function(){this.__values__===void 0&&(this.__values__=Ci(this.value()));var c=this.__index__>=this.__values__.length;return{done:c,value:c?void 0:this.__values__[this.__index__++]}},lt.prototype.plant=function(c){for(var _,I=this;I instanceof Co;){var G=ii(I);G.__index__=0,G.__values__=void 0,_?nt.__wrapped__=G:_=G;var nt=G;I=I.__wrapped__}return nt.__wrapped__=c,_},lt.prototype.reverse=function(){var c=this.__wrapped__;if(c instanceof Ye){var _=c;return this.__actions__.length&&(_=new Ye(this)),(_=_.reverse()).__actions__.push({func:Ho,args:[ja],thisArg:void 0}),new tn(_,this.__chain__)}return this.thru(ja)},lt.prototype.toJSON=lt.prototype.valueOf=lt.prototype.value=function(){return Os(this.__wrapped__,this.__actions__)},lt.prototype.first=lt.prototype.head,no&&(lt.prototype[no]=function(){return this}),lt}();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(or._=te,define(function(){return te})):xe?((xe.exports=te)._=te,J._=te):or._=te}).call(this)}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{}),_$lodash_53=_$lodash_53.exports;var _$env_136={};Object.defineProperty(_$env_136,"__esModule",{value:!0}),_$env_136.default=void 0;var _ENV=(0,_$openApi_151.ENV)(),__isNode_136=_ENV.isNode,__isQX_136=_ENV.isQX,__isLoon_136=_ENV.isLoon,__isSurge_136=_ENV.isSurge,__isStash_136=_ENV.isStash,__isShadowRocket_136=_ENV.isShadowRocket,__isLanceX_136=_ENV.isLanceX,__isEgern_136=_ENV.isEgern,__isGUIforCores_136=_ENV.isGUIforCores,backend="Node";__isNode_136&&(backend="Node"),__isQX_136&&(backend="QX"),__isLoon_136&&(backend="Loon"),__isSurge_136&&(backend="Surge"),__isStash_136&&(backend="Stash"),__isShadowRocket_136&&(backend="ShadowRocket"),__isEgern_136&&(backend="Egern"),__isLanceX_136&&(backend="LanceX"),__isGUIforCores_136&&(backend="GUI.for.Cores");var meta={},feature={};try{if(typeof $environment<"u"&&(meta.env=$environment),typeof $loon<"u"&&(meta.loon=$loon),typeof $script<"u"&&(meta.script=$script),typeof $Plugin<"u"&&(meta.plugin=$Plugin),__isNode_136){meta.node={version:eval("process.version"),argv:eval("process.argv"),filename:eval("__filename"),dirname:eval("__dirname"),env:{}};var env=eval("process.env");for(var key in env)/^SUB_STORE_/.test(key)&&(meta.node.env[key]=env[key])}}catch(t){}var ___default_136={backend,version:_$package_85.version,feature,meta};_$env_136.default=___default_136;var _$base64_20={exports:{}};(function(t,e){(function(){(function(r,n){var o,f;typeof _$base64_20.exports=="object"?_$base64_20.exports=n():typeof define=="function"&&define.amd?define(n):(o=r.Base64,(f=n()).noConflict=function(){return r.Base64=o,f},r.Meteor&&(Base64=f),r.Base64=f)})(typeof self<"u"?self:typeof window<"u"?window:t!==void 0?t:this,function(){"use strict";var r,n=typeof atob=="function",o=typeof btoa=="function",f=typeof e=="function",d=typeof TextDecoder=="function"?new TextDecoder:void 0,h=typeof TextEncoder=="function"?new TextEncoder:void 0,y=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),k=(r={},y.forEach(function(C,T){return r[C]=T}),r),A=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,D=String.fromCharCode.bind(String),q=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):function(C,T){return T===void 0&&(T=function(M){return M}),new Uint8Array(Array.prototype.slice.call(C,0).map(T))},H=function(C){return C.replace(/=/g,"").replace(/[+\/]/g,function(T){return T=="+"?"-":"_"})},z=function(C){return C.replace(/[^A-Za-z0-9\+\/]/g,"")},Z=function(C){for(var T,M,et,Pt,Ut="",Zt=C.length%3,_e=0;_e<C.length;){if((M=C.charCodeAt(_e++))>255||(et=C.charCodeAt(_e++))>255||(Pt=C.charCodeAt(_e++))>255)throw new TypeError("invalid character found");Ut+=y[(T=M<<16|et<<8|Pt)>>18&63]+y[T>>12&63]+y[T>>6&63]+y[63&T]}return Zt?Ut.slice(0,Zt-3)+"===".substring(Zt):Ut},j=o?function(C){return btoa(C)}:f?function(C){return e.from(C,"binary").toString("base64")}:Z,at=f?function(C){return e.from(C).toString("base64")}:function(C){for(var T=[],M=0,et=C.length;M<et;M+=4096)T.push(D.apply(null,C.subarray(M,M+4096)));return j(T.join(""))},ct=function(C,T){return T===void 0&&(T=!1),T?H(at(C)):at(C)},ot=function(C){if(C.length<2)return(T=C.charCodeAt(0))<128?C:T<2048?D(192|T>>>6)+D(128|63&T):D(224|T>>>12&15)+D(128|T>>>6&63)+D(128|63&T);var T=65536+1024*(C.charCodeAt(0)-55296)+(C.charCodeAt(1)-56320);return D(240|T>>>18&7)+D(128|T>>>12&63)+D(128|T>>>6&63)+D(128|63&T)},tt=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,gt=function(C){return C.replace(tt,ot)},wt=f?function(C){return e.from(C,"utf8").toString("base64")}:h?function(C){return at(h.encode(C))}:function(C){return j(gt(C))},ft=function(C,T){return T===void 0&&(T=!1),T?H(wt(C)):wt(C)},yt=function(C){return ft(C,!0)},Ct=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,l=function(C){switch(C.length){case 4:var T=((7&C.charCodeAt(0))<<18|(63&C.charCodeAt(1))<<12|(63&C.charCodeAt(2))<<6|63&C.charCodeAt(3))-65536;return D(55296+(T>>>10))+D(56320+(1023&T));case 3:return D((15&C.charCodeAt(0))<<12|(63&C.charCodeAt(1))<<6|63&C.charCodeAt(2));default:return D((31&C.charCodeAt(0))<<6|63&C.charCodeAt(1))}},s=function(C){return C.replace(Ct,l)},b=function(C){if(C=C.replace(/\s+/g,""),!A.test(C))throw new TypeError("malformed base64.");C+="==".slice(2-(3&C.length));for(var T,M,et,Pt="",Ut=0;Ut<C.length;)T=k[C.charAt(Ut++)]<<18|k[C.charAt(Ut++)]<<12|(M=k[C.charAt(Ut++)])<<6|(et=k[C.charAt(Ut++)]),Pt+=M===64?D(T>>16&255):et===64?D(T>>16&255,T>>8&255):D(T>>16&255,T>>8&255,255&T);return Pt},$=n?function(C){return atob(z(C))}:f?function(C){return e.from(C,"base64").toString("binary")}:b,E=f?function(C){return q(e.from(C,"base64"))}:function(C){return q($(C),function(T){return T.charCodeAt(0)})},rt=function(C){return E(xt(C))},_t=f?function(C){return e.from(C,"base64").toString("utf8")}:d?function(C){return d.decode(E(C))}:function(C){return s($(C))},xt=function(C){return z(C.replace(/[-_]/g,function(T){return T=="-"?"+":"/"}))},St=function(C){return _t(xt(C))},x=function(C){return{value:C,enumerable:!1,writable:!0,configurable:!0}},N=function(){var C=function(T,M){return Object.defineProperty(String.prototype,T,x(M))};C("fromBase64",function(){return St(this)}),C("toBase64",function(T){return ft(this,T)}),C("toBase64URI",function(){return ft(this,!0)}),C("toBase64URL",function(){return ft(this,!0)}),C("toUint8Array",function(){return rt(this)})},V=function(){var C=function(T,M){return Object.defineProperty(Uint8Array.prototype,T,x(M))};C("toBase64",function(T){return ct(this,T)}),C("toBase64URI",function(){return ct(this,!0)}),C("toBase64URL",function(){return ct(this,!0)})},S={version:"3.7.2",VERSION:"3.7.2",atob:$,atobPolyfill:b,btoa:j,btoaPolyfill:Z,fromBase64:St,toBase64:ft,encode:ft,encodeURI:yt,encodeURL:yt,utob:gt,btou:s,decode:St,isValid:function(C){if(typeof C!="string")return!1;var T=C.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(T)||!/[^\s0-9a-zA-Z\-_]/.test(T)},fromUint8Array:ct,toUint8Array:rt,extendString:N,extendUint8Array:V,extendBuiltins:function(){N(),V()},Base64:{}};return Object.keys(S).forEach(function(C){return S.Base64[C]=S[C]}),S})}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},_$buffer_3({}).Buffer),_$base64_20=_$base64_20.exports;var _$preprocessors_94={};Object.defineProperty(_$preprocessors_94,"__esModule",{value:!0}),_$preprocessors_94.default=void 0;var keys,___default_94=[{name:"HTML",test:function(t){return/^<!DOCTYPE html>/.test(t)},parse:function(){return""}},{name:"Clash Pre-processor",test:function(t){if(!/proxies/.test(t))return!1;var e=(0,_$yaml_148.safeLoad)(t);return e.proxies&&Array.isArray(e.proxies)},parse:function(t){var e=t.replace(/short-id:([ ]*[^,\n}]*)/g,function(f,d){var h=d.trim();return h&&h!==""?/^(['"]).*\1$/.test(h)?"short-id: ".concat(h):'short-id: "'.concat(h,'"'):'short-id: ""'}),r=(0,_$yaml_148.safeLoad)(e),n=r.proxies,o=r["global-client-fingerprint"];return n.map(function(f){return o&&!f["client-fingerprint"]&&(f["client-fingerprint"]=o),JSON.stringify(f)}).join(`
`)}},(keys=["dm1lc3M","c3NyOi8v","dHJvamFu","c3M6Ly","c3NkOi8v","c2hhZG93","aHR0c","dmxlc3M=","aHlzdGVyaWEy","aHkyOi8v","d2lyZWd1YXJkOi8v","d2c6Ly8=","dHVpYzovLw=="],{name:"Base64 Pre-processor",test:function(t){return!/^\w+:\/\/\w+/im.test(t)&&keys.some(function(e){return t.indexOf(e)!==-1})},parse:function(t){return _$base64_20.Base64.decode(t)}}),{name:"SSD Pre-processor",test:function(t){return t.indexOf("ssd://")===0},parse:function(t){for(var e=[],r=JSON.parse(_$base64_20.Base64.decode(t.split("ssd://")[1])),n=r.port,o=r.encryption,f=r.password,d=r.servers,h=0;h<d.length;h++){var y=d[h];o=y.encryption?y.encryption:o,f=y.password?y.password:f;var k=_$base64_20.Base64.encode(o+":"+f),A=y.server;n=y.port?y.port:n;var D=y.remarks?y.remarks:h,q=y.plugin_options?"/?plugin="+encodeURIComponent(y.plugin+";"+y.plugin_options):"";e[h]="ss://"+k+"@"+A+":"+n+q+"#"+D}return e.join(`
`)}},{name:"Full Config Preprocessor",test:function(t){return/^(\[server_local\]|\[Proxy\])/gm.test(t)},parse:function(t){var e;return((e=t.match(/^\[server_local|Proxy\]([\s\S]+?)^\[.+?\](\r?\n|$)/im))===null||e===void 0?void 0:e[1])||t}}];_$preprocessors_94.default=___default_94;var _$utils_109={};Object.defineProperty(_$utils_109,"__esModule",{value:!0}),_$utils_109.Result=void 0,_$utils_109.isPresent=__isPresent_109;var __obj_109,___lodash_109=(__obj_109=_$lodash_53)&&__obj_109.__esModule?__obj_109:{default:__obj_109};function ___defineProperties_109(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Result=function(){function t(n){(function(o,f){if(!(o instanceof f))throw new TypeError("Cannot call a class as a function")})(this,t),this.proxy=n,this.output=[]}var e,r;return e=t,(r=[{key:"append",value:function(n){if(n===void 0)throw new Error("required field is missing");this.output.push(n)}},{key:"appendIfPresent",value:function(n,o){__isPresent_109(this.proxy,o)&&this.append(n)}},{key:"toString",value:function(){return this.output.join("")}}])&&___defineProperties_109(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function __isPresent_109(t,e){return ___lodash_109.default.get(t,e)!=null}_$utils_109.Result=Result;var _$surge_106={};Object.defineProperty(_$surge_106,"__esModule",{value:!0}),_$surge_106.default=function(){return{produce:function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};switch(t.name=t.name.replace(/=|,/g,""),t.ports&&(t.ports=String(t.ports)),t.type){case"ss":return function(n,o){var f,d=new _$utils_109.Result(n);if(d.append("".concat(n.name,"=").concat(n.type,",").concat(n.server,",").concat(n.port)),n.cipher||(n.cipher="none"),!["aes-128-gcm","aes-192-gcm","aes-256-gcm","chacha20-ietf-poly1305","xchacha20-ietf-poly1305","rc4","rc4-md5","aes-128-cfb","aes-192-cfb","aes-256-cfb","aes-128-ctr","aes-192-ctr","aes-256-ctr","bf-cfb","camellia-128-cfb","camellia-192-cfb","camellia-256-cfb","cast5-cfb","des-cfb","idea-cfb","rc2-cfb","seed-cfb","salsa20","chacha20","chacha20-ietf","none"].concat((f=o?["2022-blake3-aes-128-gcm","2022-blake3-aes-256-gcm"]:[],function(D){if(Array.isArray(D))return ___arrayLikeToArray_106(D)}(f)||function(D){if(typeof Symbol<"u"&&D[Symbol.iterator]!=null||D["@@iterator"]!=null)return Array.from(D)}(f)||function(D,q){if(D){if(typeof D=="string")return ___arrayLikeToArray_106(D,void 0);var H=Object.prototype.toString.call(D).slice(8,-1);return H==="Object"&&D.constructor&&(H=D.constructor.name),H==="Map"||H==="Set"?Array.from(D):H==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(H)?___arrayLikeToArray_106(D,void 0):void 0}}(f)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}())).includes(n.cipher))throw new Error("cipher ".concat(n.cipher," is not supported"));d.append(",encrypt-method=".concat(n.cipher)),d.appendIfPresent(',password="'.concat(n.password,'"'),"password");var h=ipVersions[n["ip-version"]]||n["ip-version"];if(d.appendIfPresent(",ip-version=".concat(h),"ip-version"),d.appendIfPresent(",no-error-alert=".concat(n["no-error-alert"]),"no-error-alert"),(0,_$utils_109.isPresent)(n,"plugin")){if(n.plugin==="obfs")d.append(",obfs=".concat(n["plugin-opts"].mode)),d.appendIfPresent(",obfs-host=".concat(n["plugin-opts"].host),"plugin-opts.host"),d.appendIfPresent(",obfs-uri=".concat(n["plugin-opts"].path),"plugin-opts.path");else if(!["shadow-tls"].includes(n.plugin))throw new Error("plugin ".concat(n.plugin," is not supported"))}if(d.appendIfPresent(",tfo=".concat(n.tfo),"tfo"),d.appendIfPresent(",udp-relay=".concat(n.udp),"udp"),d.appendIfPresent(",udp-port=".concat(n["udp-port"]),"udp-port"),d.appendIfPresent(",test-url=".concat(n["test-url"]),"test-url"),d.appendIfPresent(",test-timeout=".concat(n["test-timeout"]),"test-timeout"),d.appendIfPresent(",test-udp=".concat(n["test-udp"]),"test-udp"),d.appendIfPresent(",hybrid=".concat(n.hybrid),"hybrid"),d.appendIfPresent(",tos=".concat(n.tos),"tos"),d.appendIfPresent(",allow-other-interface=".concat(n["allow-other-interface"]),"allow-other-interface"),d.appendIfPresent(",interface=".concat(n["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(n,"shadow-tls-password"))d.append(",shadow-tls-password=".concat(n["shadow-tls-password"])),d.appendIfPresent(",shadow-tls-version=".concat(n["shadow-tls-version"]),"shadow-tls-version"),d.appendIfPresent(",shadow-tls-sni=".concat(n["shadow-tls-sni"]),"shadow-tls-sni");else if(["shadow-tls"].includes(n.plugin)&&n["plugin-opts"]){var y=n["plugin-opts"].password,k=n["plugin-opts"].host,A=n["plugin-opts"].version;if(y&&(d.append(",shadow-tls-password=".concat(y)),k&&d.append(",shadow-tls-sni=".concat(k)),A)){if(A<2)throw new Error("shadow-tls version ".concat(A," is not supported"));d.append(",shadow-tls-version=".concat(A))}}return d.appendIfPresent(",block-quic=".concat(n["block-quic"]),"block-quic"),d.appendIfPresent(",underlying-proxy=".concat(n["underlying-proxy"]),"underlying-proxy"),d.toString()}(t,r["include-unsupported-proxy"]);case"trojan":return function(n){var o=new _$utils_109.Result(n);o.append("".concat(n.name,"=").concat(n.type,",").concat(n.server,",").concat(n.port)),o.appendIfPresent(',password="'.concat(n.password,'"'),"password");var f=ipVersions[n["ip-version"]]||n["ip-version"];return o.appendIfPresent(",ip-version=".concat(f),"ip-version"),o.appendIfPresent(",no-error-alert=".concat(n["no-error-alert"]),"no-error-alert"),handleTransport(o,n),o.appendIfPresent(",tls=".concat(n.tls),"tls"),o.appendIfPresent(",server-cert-fingerprint-sha256=".concat(n["tls-fingerprint"]),"tls-fingerprint"),o.appendIfPresent(",sni=".concat(n.sni),"sni"),o.appendIfPresent(",skip-cert-verify=".concat(n["skip-cert-verify"]),"skip-cert-verify"),o.appendIfPresent(",tfo=".concat(n.tfo),"tfo"),o.appendIfPresent(",udp-relay=".concat(n.udp),"udp"),o.appendIfPresent(",test-url=".concat(n["test-url"]),"test-url"),o.appendIfPresent(",test-timeout=".concat(n["test-timeout"]),"test-timeout"),o.appendIfPresent(",test-udp=".concat(n["test-udp"]),"test-udp"),o.appendIfPresent(",hybrid=".concat(n.hybrid),"hybrid"),o.appendIfPresent(",tos=".concat(n.tos),"tos"),o.appendIfPresent(",allow-other-interface=".concat(n["allow-other-interface"]),"allow-other-interface"),o.appendIfPresent(",interface=".concat(n["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(n,"shadow-tls-password")&&(o.append(",shadow-tls-password=".concat(n["shadow-tls-password"])),o.appendIfPresent(",shadow-tls-version=".concat(n["shadow-tls-version"]),"shadow-tls-version"),o.appendIfPresent(",shadow-tls-sni=".concat(n["shadow-tls-sni"]),"shadow-tls-sni")),o.appendIfPresent(",block-quic=".concat(n["block-quic"]),"block-quic"),o.appendIfPresent(",underlying-proxy=".concat(n["underlying-proxy"]),"underlying-proxy"),o.toString()}(t);case"vmess":return function(n,o){var f=new _$utils_109.Result(n);f.append("".concat(n.name,"=").concat(n.type,",").concat(n.server,",").concat(n.port)),f.appendIfPresent(",username=".concat(n.uuid),"uuid");var d=ipVersions[n["ip-version"]]||n["ip-version"];return f.appendIfPresent(",ip-version=".concat(d),"ip-version"),f.appendIfPresent(",no-error-alert=".concat(n["no-error-alert"]),"no-error-alert"),handleTransport(f,n,o),(0,_$utils_109.isPresent)(n,"aead")?f.append(",vmess-aead=".concat(n.aead)):f.append(",vmess-aead=".concat(n.alterId===0)),f.appendIfPresent(",server-cert-fingerprint-sha256=".concat(n["tls-fingerprint"]),"tls-fingerprint"),f.appendIfPresent(",tls=".concat(n.tls),"tls"),f.appendIfPresent(",sni=".concat(n.sni),"sni"),f.appendIfPresent(",skip-cert-verify=".concat(n["skip-cert-verify"]),"skip-cert-verify"),f.appendIfPresent(",tfo=".concat(n.tfo),"tfo"),f.appendIfPresent(",udp-relay=".concat(n.udp),"udp"),f.appendIfPresent(",test-url=".concat(n["test-url"]),"test-url"),f.appendIfPresent(",test-timeout=".concat(n["test-timeout"]),"test-timeout"),f.appendIfPresent(",test-udp=".concat(n["test-udp"]),"test-udp"),f.appendIfPresent(",hybrid=".concat(n.hybrid),"hybrid"),f.appendIfPresent(",tos=".concat(n.tos),"tos"),f.appendIfPresent(",allow-other-interface=".concat(n["allow-other-interface"]),"allow-other-interface"),f.appendIfPresent(",interface=".concat(n["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(n,"shadow-tls-password")&&(f.append(",shadow-tls-password=".concat(n["shadow-tls-password"])),f.appendIfPresent(",shadow-tls-version=".concat(n["shadow-tls-version"]),"shadow-tls-version"),f.appendIfPresent(",shadow-tls-sni=".concat(n["shadow-tls-sni"]),"shadow-tls-sni")),f.appendIfPresent(",block-quic=".concat(n["block-quic"]),"block-quic"),f.appendIfPresent(",underlying-proxy=".concat(n["underlying-proxy"]),"underlying-proxy"),f.toString()}(t,r["include-unsupported-proxy"]);case"http":return function(n){var o=new _$utils_109.Result(n),f=n.tls?"https":"http";o.append("".concat(n.name,"=").concat(f,",").concat(n.server,",").concat(n.port)),o.appendIfPresent(",".concat(n.username),"username"),o.appendIfPresent(',"'.concat(n.password,'"'),"password");var d=ipVersions[n["ip-version"]]||n["ip-version"];return o.appendIfPresent(",ip-version=".concat(d),"ip-version"),o.appendIfPresent(",no-error-alert=".concat(n["no-error-alert"]),"no-error-alert"),o.appendIfPresent(",server-cert-fingerprint-sha256=".concat(n["tls-fingerprint"]),"tls-fingerprint"),o.appendIfPresent(",sni=".concat(n.sni),"sni"),o.appendIfPresent(",skip-cert-verify=".concat(n["skip-cert-verify"]),"skip-cert-verify"),o.appendIfPresent(",tfo=".concat(n.tfo),"tfo"),o.appendIfPresent(",udp-relay=".concat(n.udp),"udp"),o.appendIfPresent(",test-url=".concat(n["test-url"]),"test-url"),o.appendIfPresent(",test-timeout=".concat(n["test-timeout"]),"test-timeout"),o.appendIfPresent(",test-udp=".concat(n["test-udp"]),"test-udp"),o.appendIfPresent(",hybrid=".concat(n.hybrid),"hybrid"),o.appendIfPresent(",tos=".concat(n.tos),"tos"),o.appendIfPresent(",allow-other-interface=".concat(n["allow-other-interface"]),"allow-other-interface"),o.appendIfPresent(",interface=".concat(n["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(n,"shadow-tls-password")&&(o.append(",shadow-tls-password=".concat(n["shadow-tls-password"])),o.appendIfPresent(",shadow-tls-version=".concat(n["shadow-tls-version"]),"shadow-tls-version"),o.appendIfPresent(",shadow-tls-sni=".concat(n["shadow-tls-sni"]),"shadow-tls-sni")),o.appendIfPresent(",block-quic=".concat(n["block-quic"]),"block-quic"),o.appendIfPresent(",underlying-proxy=".concat(n["underlying-proxy"]),"underlying-proxy"),o.toString()}(t);case"direct":return function(n){var o=new _$utils_109.Result(n);o.append("".concat(n.name,"=").concat("direct"));var f=ipVersions[n["ip-version"]]||n["ip-version"];return o.appendIfPresent(",ip-version=".concat(f),"ip-version"),o.appendIfPresent(",no-error-alert=".concat(n["no-error-alert"]),"no-error-alert"),o.appendIfPresent(",tfo=".concat(n.tfo),"tfo"),o.appendIfPresent(",udp-relay=".concat(n.udp),"udp"),o.appendIfPresent(",test-url=".concat(n["test-url"]),"test-url"),o.appendIfPresent(",test-timeout=".concat(n["test-timeout"]),"test-timeout"),o.appendIfPresent(",test-udp=".concat(n["test-udp"]),"test-udp"),o.appendIfPresent(",hybrid=".concat(n.hybrid),"hybrid"),o.appendIfPresent(",tos=".concat(n.tos),"tos"),o.appendIfPresent(",allow-other-interface=".concat(n["allow-other-interface"]),"allow-other-interface"),o.appendIfPresent(",interface=".concat(n["interface-name"]),"interface-name"),o.appendIfPresent(",block-quic=".concat(n["block-quic"]),"block-quic"),o.appendIfPresent(",underlying-proxy=".concat(n["underlying-proxy"]),"underlying-proxy"),o.toString()}(t);case"socks5":return function(n){var o=new _$utils_109.Result(n),f=n.tls?"socks5-tls":"socks5";o.append("".concat(n.name,"=").concat(f,",").concat(n.server,",").concat(n.port)),o.appendIfPresent(",".concat(n.username),"username"),o.appendIfPresent(',"'.concat(n.password,'"'),"password");var d=ipVersions[n["ip-version"]]||n["ip-version"];return o.appendIfPresent(",ip-version=".concat(d),"ip-version"),o.appendIfPresent(",no-error-alert=".concat(n["no-error-alert"]),"no-error-alert"),o.appendIfPresent(",server-cert-fingerprint-sha256=".concat(n["tls-fingerprint"]),"tls-fingerprint"),o.appendIfPresent(",sni=".concat(n.sni),"sni"),o.appendIfPresent(",skip-cert-verify=".concat(n["skip-cert-verify"]),"skip-cert-verify"),n.tfo&&___app_106.default.info("Option tfo is not supported by Surge, thus omitted"),o.appendIfPresent(",udp-relay=".concat(n.udp),"udp"),o.appendIfPresent(",test-url=".concat(n["test-url"]),"test-url"),o.appendIfPresent(",test-timeout=".concat(n["test-timeout"]),"test-timeout"),o.appendIfPresent(",test-udp=".concat(n["test-udp"]),"test-udp"),o.appendIfPresent(",hybrid=".concat(n.hybrid),"hybrid"),o.appendIfPresent(",tos=".concat(n.tos),"tos"),o.appendIfPresent(",allow-other-interface=".concat(n["allow-other-interface"]),"allow-other-interface"),o.appendIfPresent(",interface=".concat(n["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(n,"shadow-tls-password")&&(o.append(",shadow-tls-password=".concat(n["shadow-tls-password"])),o.appendIfPresent(",shadow-tls-version=".concat(n["shadow-tls-version"]),"shadow-tls-version"),o.appendIfPresent(",shadow-tls-sni=".concat(n["shadow-tls-sni"]),"shadow-tls-sni")),o.appendIfPresent(",block-quic=".concat(n["block-quic"]),"block-quic"),o.appendIfPresent(",underlying-proxy=".concat(n["underlying-proxy"]),"underlying-proxy"),o.toString()}(t);case"snell":return function(n){var o,f,d,h=new _$utils_109.Result(n);h.append("".concat(n.name,"=").concat(n.type,",").concat(n.server,",").concat(n.port)),h.appendIfPresent(",version=".concat(n.version),"version"),h.appendIfPresent(",psk=".concat(n.psk),"psk");var y=ipVersions[n["ip-version"]]||n["ip-version"];return h.appendIfPresent(",ip-version=".concat(y),"ip-version"),h.appendIfPresent(",no-error-alert=".concat(n["no-error-alert"]),"no-error-alert"),h.appendIfPresent(",obfs=".concat((o=n["obfs-opts"])===null||o===void 0?void 0:o.mode),"obfs-opts.mode"),h.appendIfPresent(",obfs-host=".concat((f=n["obfs-opts"])===null||f===void 0?void 0:f.host),"obfs-opts.host"),h.appendIfPresent(",obfs-uri=".concat((d=n["obfs-opts"])===null||d===void 0?void 0:d.path),"obfs-opts.path"),h.appendIfPresent(",tfo=".concat(n.tfo),"tfo"),h.appendIfPresent(",udp-relay=".concat(n.udp),"udp"),h.appendIfPresent(",test-url=".concat(n["test-url"]),"test-url"),h.appendIfPresent(",test-timeout=".concat(n["test-timeout"]),"test-timeout"),h.appendIfPresent(",test-udp=".concat(n["test-udp"]),"test-udp"),h.appendIfPresent(",hybrid=".concat(n.hybrid),"hybrid"),h.appendIfPresent(",tos=".concat(n.tos),"tos"),h.appendIfPresent(",allow-other-interface=".concat(n["allow-other-interface"]),"allow-other-interface"),h.appendIfPresent(",interface=".concat(n["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(n,"shadow-tls-password")&&(h.append(",shadow-tls-password=".concat(n["shadow-tls-password"])),h.appendIfPresent(",shadow-tls-version=".concat(n["shadow-tls-version"]),"shadow-tls-version"),h.appendIfPresent(",shadow-tls-sni=".concat(n["shadow-tls-sni"]),"shadow-tls-sni")),h.appendIfPresent(",block-quic=".concat(n["block-quic"]),"block-quic"),h.appendIfPresent(",underlying-proxy=".concat(n["underlying-proxy"]),"underlying-proxy"),h.appendIfPresent(",reuse=".concat(n.reuse),"reuse"),h.toString()}(t);case"tuic":return function(n){var o=new _$utils_109.Result(n),f=n.type;n.token&&n.token.length!==0||(f="tuic-v5"),o.append("".concat(n.name,"=").concat(f,",").concat(n.server,",").concat(n.port)),o.appendIfPresent(",uuid=".concat(n.uuid),"uuid"),o.appendIfPresent(',password="'.concat(n.password,'"'),"password"),o.appendIfPresent(",token=".concat(n.token),"token"),o.appendIfPresent(",alpn=".concat(Array.isArray(n.alpn)?n.alpn[0]:n.alpn),"alpn"),(0,_$utils_109.isPresent)(n,"ports")&&o.append(',port-hopping="'.concat(n.ports.replace(/,/g,";"),'"')),o.appendIfPresent(",port-hopping-interval=".concat(n["hop-interval"]),"hop-interval");var d=ipVersions[n["ip-version"]]||n["ip-version"];return o.appendIfPresent(",ip-version=".concat(d),"ip-version"),o.appendIfPresent(",no-error-alert=".concat(n["no-error-alert"]),"no-error-alert"),o.appendIfPresent(",sni=".concat(n.sni),"sni"),o.appendIfPresent(",skip-cert-verify=".concat(n["skip-cert-verify"]),"skip-cert-verify"),o.appendIfPresent(",server-cert-fingerprint-sha256=".concat(n["tls-fingerprint"]),"tls-fingerprint"),(0,_$utils_109.isPresent)(n,"tfo")?o.append(",tfo=".concat(n.tfo)):(0,_$utils_109.isPresent)(n,"fast-open")&&o.append(",tfo=".concat(n["fast-open"])),o.appendIfPresent(",test-url=".concat(n["test-url"]),"test-url"),o.appendIfPresent(",test-timeout=".concat(n["test-timeout"]),"test-timeout"),o.appendIfPresent(",test-udp=".concat(n["test-udp"]),"test-udp"),o.appendIfPresent(",hybrid=".concat(n.hybrid),"hybrid"),o.appendIfPresent(",tos=".concat(n.tos),"tos"),o.appendIfPresent(",allow-other-interface=".concat(n["allow-other-interface"]),"allow-other-interface"),o.appendIfPresent(",interface=".concat(n["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(n,"shadow-tls-password")&&(o.append(",shadow-tls-password=".concat(n["shadow-tls-password"])),o.appendIfPresent(",shadow-tls-version=".concat(n["shadow-tls-version"]),"shadow-tls-version"),o.appendIfPresent(",shadow-tls-sni=".concat(n["shadow-tls-sni"]),"shadow-tls-sni")),o.appendIfPresent(",block-quic=".concat(n["block-quic"]),"block-quic"),o.appendIfPresent(",underlying-proxy=".concat(n["underlying-proxy"]),"underlying-proxy"),o.appendIfPresent(",ecn=".concat(n.ecn),"ecn"),o.toString()}(t);case"wireguard-surge":return function(n){var o=new _$utils_109.Result(n);o.append("".concat(n.name,"=wireguard")),o.appendIfPresent(",section-name=".concat(n["section-name"]),"section-name"),o.appendIfPresent(",no-error-alert=".concat(n["no-error-alert"]),"no-error-alert");var f=ipVersions[n["ip-version"]]||n["ip-version"];return o.appendIfPresent(",ip-version=".concat(f),"ip-version"),o.appendIfPresent(",test-url=".concat(n["test-url"]),"test-url"),o.appendIfPresent(",test-timeout=".concat(n["test-timeout"]),"test-timeout"),o.appendIfPresent(",test-udp=".concat(n["test-udp"]),"test-udp"),o.appendIfPresent(",hybrid=".concat(n.hybrid),"hybrid"),o.appendIfPresent(",tos=".concat(n.tos),"tos"),o.appendIfPresent(",allow-other-interface=".concat(n["allow-other-interface"]),"allow-other-interface"),o.appendIfPresent(",interface=".concat(n["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(n,"shadow-tls-password")&&(o.append(",shadow-tls-password=".concat(n["shadow-tls-password"])),o.appendIfPresent(",shadow-tls-version=".concat(n["shadow-tls-version"]),"shadow-tls-version"),o.appendIfPresent(",shadow-tls-sni=".concat(n["shadow-tls-sni"]),"shadow-tls-sni")),o.appendIfPresent(",block-quic=".concat(n["block-quic"]),"block-quic"),o.appendIfPresent(",underlying-proxy=".concat(n["underlying-proxy"]),"underlying-proxy"),o.toString()}(t);case"hysteria2":return function(n){var o;if(n.obfs||n["obfs-password"])throw new Error("obfs is unsupported");var f=new _$utils_109.Result(n);f.append("".concat(n.name,"=hysteria2,").concat(n.server,",").concat(n.port)),f.appendIfPresent(',password="'.concat(n.password,'"'),"password"),(0,_$utils_109.isPresent)(n,"ports")&&f.append(',port-hopping="'.concat(n.ports.replace(/,/g,";"),'"')),f.appendIfPresent(",port-hopping-interval=".concat(n["hop-interval"]),"hop-interval");var d=ipVersions[n["ip-version"]]||n["ip-version"];return f.appendIfPresent(",ip-version=".concat(d),"ip-version"),f.appendIfPresent(",no-error-alert=".concat(n["no-error-alert"]),"no-error-alert"),f.appendIfPresent(",sni=".concat(n.sni),"sni"),f.appendIfPresent(",skip-cert-verify=".concat(n["skip-cert-verify"]),"skip-cert-verify"),f.appendIfPresent(",server-cert-fingerprint-sha256=".concat(n["tls-fingerprint"]),"tls-fingerprint"),(0,_$utils_109.isPresent)(n,"tfo")?f.append(",tfo=".concat(n.tfo)):(0,_$utils_109.isPresent)(n,"fast-open")&&f.append(",tfo=".concat(n["fast-open"])),f.appendIfPresent(",test-url=".concat(n["test-url"]),"test-url"),f.appendIfPresent(",test-timeout=".concat(n["test-timeout"]),"test-timeout"),f.appendIfPresent(",test-udp=".concat(n["test-udp"]),"test-udp"),f.appendIfPresent(",hybrid=".concat(n.hybrid),"hybrid"),f.appendIfPresent(",tos=".concat(n.tos),"tos"),f.appendIfPresent(",allow-other-interface=".concat(n["allow-other-interface"]),"allow-other-interface"),f.appendIfPresent(",interface=".concat(n["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(n,"shadow-tls-password")&&(f.append(",shadow-tls-password=".concat(n["shadow-tls-password"])),f.appendIfPresent(",shadow-tls-version=".concat(n["shadow-tls-version"]),"shadow-tls-version"),f.appendIfPresent(",shadow-tls-sni=".concat(n["shadow-tls-sni"]),"shadow-tls-sni")),f.appendIfPresent(",block-quic=".concat(n["block-quic"]),"block-quic"),f.appendIfPresent(",underlying-proxy=".concat(n["underlying-proxy"]),"underlying-proxy"),f.appendIfPresent(",download-bandwidth=".concat(((o="".concat(n.down).match(/\d+/))===null||o===void 0?void 0:o[0])||0),"down"),f.appendIfPresent(",ecn=".concat(n.ecn),"ecn"),f.toString()}(t);case"ssh":return function(n){var o=new _$utils_109.Result(n);o.append("".concat(n.name,"=ssh,").concat(n.server,",").concat(n.port)),o.appendIfPresent(",".concat(n.username),"username"),o.appendIfPresent(',"'.concat(n.password,'"'),"password"),o.appendIfPresent(",private-key=".concat(n["keystore-private-key"]),"keystore-private-key"),o.appendIfPresent(",idle-timeout=".concat(n["idle-timeout"]),"idle-timeout"),o.appendIfPresent(',server-fingerprint="'.concat(n["server-fingerprint"],'"'),"server-fingerprint");var f=ipVersions[n["ip-version"]]||n["ip-version"];return o.appendIfPresent(",ip-version=".concat(f),"ip-version"),o.appendIfPresent(",no-error-alert=".concat(n["no-error-alert"]),"no-error-alert"),o.appendIfPresent(",tfo=".concat(n.tfo),"tfo"),o.appendIfPresent(",udp-relay=".concat(n.udp),"udp"),o.appendIfPresent(",test-url=".concat(n["test-url"]),"test-url"),o.appendIfPresent(",test-timeout=".concat(n["test-timeout"]),"test-timeout"),o.appendIfPresent(",test-udp=".concat(n["test-udp"]),"test-udp"),o.appendIfPresent(",hybrid=".concat(n.hybrid),"hybrid"),o.appendIfPresent(",tos=".concat(n.tos),"tos"),o.appendIfPresent(",allow-other-interface=".concat(n["allow-other-interface"]),"allow-other-interface"),o.appendIfPresent(",interface=".concat(n["interface-name"]),"interface-name"),o.appendIfPresent(",block-quic=".concat(n["block-quic"]),"block-quic"),o.appendIfPresent(",underlying-proxy=".concat(n["underlying-proxy"]),"underlying-proxy"),o.toString()}(t)}if(r["include-unsupported-proxy"]&&t.type==="wireguard")return function(n){var o;Array.isArray(n.peers)&&n.peers.length>0&&(n.server=n.peers[0].server,n.port=n.peers[0].port,n.ip=n.peers[0].ip,n.ipv6=n.peers[0].ipv6,n["public-key"]=n.peers[0]["public-key"],n["preshared-key"]=n.peers[0]["pre-shared-key"],n["allowed-ips"]=n.peers[0]["allowed-ips"],n.reserved=n.peers[0].reserved);var f=new _$utils_109.Result(n);f.append("# > WireGuard Proxy ".concat(n.name,`
# `).concat(n.name,"=wireguard")),n["section-name"]=(0,_$utils_141.getIfNotBlank)(n["section-name"],n.name),f.appendIfPresent(",section-name=".concat(n["section-name"]),"section-name"),f.appendIfPresent(",no-error-alert=".concat(n["no-error-alert"]),"no-error-alert");var d=ipVersions[n["ip-version"]]||n["ip-version"];f.appendIfPresent(",ip-version=".concat(d),"ip-version"),f.appendIfPresent(",test-url=".concat(n["test-url"]),"test-url"),f.appendIfPresent(",test-timeout=".concat(n["test-timeout"]),"test-timeout"),f.appendIfPresent(",test-udp=".concat(n["test-udp"]),"test-udp"),f.appendIfPresent(",hybrid=".concat(n.hybrid),"hybrid"),f.appendIfPresent(",tos=".concat(n.tos),"tos"),f.appendIfPresent(",allow-other-interface=".concat(n["allow-other-interface"]),"allow-other-interface"),f.appendIfPresent(",interface=".concat(n["interface-name"]),"interface-name"),(0,_$utils_109.isPresent)(n,"shadow-tls-password")&&(f.append(",shadow-tls-password=".concat(n["shadow-tls-password"])),f.appendIfPresent(",shadow-tls-version=".concat(n["shadow-tls-version"]),"shadow-tls-version"),f.appendIfPresent(",shadow-tls-sni=".concat(n["shadow-tls-sni"]),"shadow-tls-sni")),f.appendIfPresent(",block-quic=".concat(n["block-quic"]),"block-quic"),f.appendIfPresent(",underlying-proxy=".concat(n["underlying-proxy"]),"underlying-proxy"),f.append(`
# > WireGuard Section `.concat(n.name,`
[WireGuard `).concat(n["section-name"],`]
private-key = `).concat(n["private-key"])),f.appendIfPresent(`
self-ip = `.concat(n.ip),"ip"),f.appendIfPresent(`
self-ip-v6 = `.concat(n.ipv6),"ipv6"),n.dns&&(Array.isArray(n.dns)&&(n.dns=n.dns.join(", ")),f.append(`
dns-server = `.concat(n.dns))),f.appendIfPresent(`
mtu = `.concat(n.mtu),"mtu"),d==="prefer-v6"&&f.append(`
prefer-ipv6 = true`);var h=Array.isArray(n["allowed-ips"])?n["allowed-ips"].join(","):n["allowed-ips"],y=Array.isArray(n.reserved)?n.reserved.join("/"):n.reserved,k=(o=n["preshared-key"])!==null&&o!==void 0?o:n["pre-shared-key"];k&&(k=',preshared-key="'.concat(k,'"'));var A={"public-key":n["public-key"],"allowed-ips":h?'"'.concat(h,'"'):void 0,endpoint:"".concat(n.server,":").concat(n.port),keepalive:n["persistent-keepalive"]||n.keepalive,"client-id":y,"preshared-key":k};return f.append(`
peer = (`.concat(Object.keys(A).filter(function(D){return A[D]!=null}).map(function(D){return"".concat(D," = ").concat(A[D])}).join(", "),")")),f.toString()}(t);throw new Error("Platform ".concat(targetPlatform," does not support proxy type: ").concat(t.type))}}};var __obj_106,___app_106=(__obj_106=_$app_87)&&__obj_106.__esModule?__obj_106:{default:__obj_106};function ___arrayLikeToArray_106(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var targetPlatform="Surge",ipVersions={dual:"dual",ipv4:"v4-only",ipv6:"v6-only","ipv4-prefer":"prefer-v4","ipv6-prefer":"prefer-v6"};function handleTransport(t,e,r){if((0,_$utils_109.isPresent)(e,"network"))if(e.network==="ws"){if(t.append(",ws=true"),(0,_$utils_109.isPresent)(e,"ws-opts")&&(t.appendIfPresent(",ws-path=".concat(e["ws-opts"].path),"ws-opts.path"),(0,_$utils_109.isPresent)(e,"ws-opts.headers"))){var n=e["ws-opts"].headers,o=Object.keys(n).map(function(f){var d=n[f];return["Host"].includes(f)&&(d='"'.concat(d,'"')),"".concat(f,":").concat(d)}).join("|");(0,_$utils_141.isNotBlank)(o)&&t.append(",ws-headers=".concat(o))}}else{if(!r||!["http"].includes(e.network))throw new Error("network ".concat(e.network," is unsupported"));___app_106.default.info("Include Unsupported Proxy: nework ".concat(e.network," -> tcp"))}}var _$clashmeta_97={};Object.defineProperty(_$clashmeta_97,"__esModule",{value:!0}),_$clashmeta_97.default=function(){return{type:"ALL",produce:function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=t.filter(function(o){return!!r["include-unsupported-proxy"]||o.type!=="snell"||String(o.version)!=="4"}).map(function(o){var f;if(o.type==="vmess")(0,_$utils_109.isPresent)(o,"aead")&&(o.aead&&(o.alterId=0),delete o.aead),(0,_$utils_109.isPresent)(o,"sni")&&(o.servername=o.sni,delete o.sni),(0,_$utils_109.isPresent)(o,"cipher")&&!["auto","aes-128-gcm","chacha20-poly1305","none"].includes(o.cipher)&&(o.cipher="auto");else if(o.type==="tuic")(0,_$utils_109.isPresent)(o,"alpn")?o.alpn=Array.isArray(o.alpn)?o.alpn:[o.alpn]:o.alpn=["h3"],(0,_$utils_109.isPresent)(o,"tfo")&&!(0,_$utils_109.isPresent)(o,"fast-open")&&(o["fast-open"]=o.tfo),o.token&&o.token.length!==0||(0,_$utils_109.isPresent)(o,"version")||(o.version=5);else if(o.type==="hysteria")(0,_$utils_109.isPresent)(o,"auth_str")&&!(0,_$utils_109.isPresent)(o,"auth-str")&&(o["auth-str"]=o.auth_str),(0,_$utils_109.isPresent)(o,"alpn")&&(o.alpn=Array.isArray(o.alpn)?o.alpn:[o.alpn]),(0,_$utils_109.isPresent)(o,"tfo")&&!(0,_$utils_109.isPresent)(o,"fast-open")&&(o["fast-open"]=o.tfo);else if(o.type==="wireguard"){var d,h;o.keepalive=(d=o.keepalive)!==null&&d!==void 0?d:o["persistent-keepalive"],o["persistent-keepalive"]=o.keepalive,o["preshared-key"]=(h=o["preshared-key"])!==null&&h!==void 0?h:o["pre-shared-key"],o["pre-shared-key"]=o["preshared-key"]}else o.type==="vless"?(0,_$utils_109.isPresent)(o,"sni")&&(o.servername=o.sni,delete o.sni):o.type==="ss"&&(0,_$utils_109.isPresent)(o,"shadow-tls-password")&&!(0,_$utils_109.isPresent)(o,"plugin")&&(o.plugin="shadow-tls",o["plugin-opts"]={host:o["shadow-tls-sni"],password:o["shadow-tls-password"],version:o["shadow-tls-version"]});if(["vmess","vless"].includes(o.type)&&o.network==="http"){var y,k,A,D=(y=o["http-opts"])===null||y===void 0?void 0:y.path;(0,_$utils_109.isPresent)(o,"http-opts.path")&&!Array.isArray(D)&&(o["http-opts"].path=[D]);var q=(k=o["http-opts"])===null||k===void 0||(A=k.headers)===null||A===void 0?void 0:A.Host;(0,_$utils_109.isPresent)(o,"http-opts.headers.Host")&&!Array.isArray(q)&&(o["http-opts"].headers.Host=[q])}if(["vmess","vless"].includes(o.type)&&o.network==="h2"){var H,z,Z,j=(H=o["h2-opts"])===null||H===void 0?void 0:H.path;(0,_$utils_109.isPresent)(o,"h2-opts.path")&&Array.isArray(j)&&(o["h2-opts"].path=j[0]);var at=(z=o["h2-opts"])===null||z===void 0||(Z=z.headers)===null||Z===void 0?void 0:Z.host;(0,_$utils_109.isPresent)(o,"h2-opts.headers.Host")&&!Array.isArray(at)&&(o["h2-opts"].headers.host=[at])}if((f=o["plugin-opts"])!==null&&f!==void 0&&f.tls&&(0,_$utils_109.isPresent)(o,"skip-cert-verify")&&(o["plugin-opts"]["skip-cert-verify"]=o["skip-cert-verify"]),["trojan","tuic","hysteria","hysteria2","juicity"].includes(o.type)&&delete o.tls,o["tls-fingerprint"]&&(o.fingerprint=o["tls-fingerprint"]),delete o["tls-fingerprint"],o["underlying-proxy"]&&(o["dialer-proxy"]=o["underlying-proxy"]),delete o["underlying-proxy"],(0,_$utils_109.isPresent)(o,"tls")&&typeof o.tls!="boolean"&&delete o.tls,delete o.subName,delete o.collectionName,delete o.id,delete o.resolved,delete o["no-resolve"],e!=="internal")for(var ct in o)(o[ct]==null||/^_/i.test(ct))&&delete o[ct];return["grpc"].includes(o.network)&&o["".concat(o.network,"-opts")]&&(delete o["".concat(o.network,"-opts")]["_grpc-type"],delete o["".concat(o.network,"-opts")]["_grpc-authority"]),o});return e==="internal"?n:`proxies:
`+n.map(function(o){return"  - "+JSON.stringify(o)+`
`}).join("")}}};var _$surgemac_107={};Object.defineProperty(_$surgemac_107,"__esModule",{value:!0}),_$surgemac_107.default=function(){return{produce:function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};switch(t.type){case"external":return external(t);default:try{return surge_Producer.produce(t,e,r)}catch{if(r.useMihomoExternal)return ___app_107.default.log("".concat(t.name," is not supported on ").concat(__targetPlatform_107,", try to use Mihomo(SurgeMac - External Proxy Program) instead")),function(o,f,d){var h,y=(h=(0,_clashmeta.default)().produce([o],"internal"))===null||h===void 0?void 0:h[0];if(y){var k=d?.localPort||o._localPort||65535,A=!["ipv4","v4-only"].includes(o["ip-version"]),D={name:o.name,type:"external",exec:o._exec||"/usr/local/bin/mihomo","local-port":k,args:["-config",_$base64_20.Base64.encode(JSON.stringify({"mixed-port":k,ipv6:A,mode:"global",dns:{enable:!0,ipv6:A,nameserver:["https://223.6.6.6/dns-query","https://120.53.53.53/dns-query"]},proxies:[___objectSpread_107(___objectSpread_107({},y),{},{name:"proxy"})],"proxy-groups":[{name:"GLOBAL",type:"select",proxies:["proxy"]}]}))],addresses:[]};return __isIP_107(o.server)?D.addresses.push(o.server):___app_107.default.log("Platform ".concat(__targetPlatform_107,", proxy type ").concat(o.type,": addresses should be an IP address, but got ").concat(o.server)),d.localPort=k-1,external(D)}}(t,0,r);throw new Error("Surge for macOS \u53EF\u624B\u52A8\u6307\u5B9A\u94FE\u63A5\u53C2\u6570 target=SurgeMac \u6216\u5728 \u540C\u6B65\u914D\u7F6E \u4E2D\u6307\u5B9A SurgeMac \u6765\u542F\u7528 mihomo \u652F\u63F4 Surge \u672C\u8EAB\u4E0D\u652F\u6301\u7684\u534F\u8BAE")}}}}};var _surge=___interopRequireDefault_107(_$surge_106),_clashmeta=___interopRequireDefault_107(_$clashmeta_97),___app_107=___interopRequireDefault_107(_$app_87);function ___interopRequireDefault_107(t){return t&&t.__esModule?t:{default:t}}function __ownKeys_107(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function ___objectSpread_107(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_107(Object(r),!0).forEach(function(n){___defineProperty_107(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):__ownKeys_107(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ___defineProperty_107(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var __targetPlatform_107="SurgeMac",surge_Producer=(0,_surge.default)();function external(t){var e=new _$utils_109.Result(t);if(!t.exec||!t["local-port"])throw new Error("".concat(t.type,": exec and local-port are required"));return e.append("".concat(t.name,'=external,exec="').concat(t.exec,'",local-port=').concat(t["local-port"])),Array.isArray(t.args)&&t.args.map(function(r){e.append(',args="'.concat(r,'"'))}),Array.isArray(t.addresses)&&t.addresses.map(function(r){e.append(",addresses=".concat(r))}),e.appendIfPresent(",no-error-alert=".concat(t["no-error-alert"]),"no-error-alert"),(0,_$utils_109.isPresent)(t,"tfo")?e.append(",tfo=".concat(t.tfo)):(0,_$utils_109.isPresent)(t,"fast-open")&&e.append(",tfo=".concat(t["fast-open"])),e.appendIfPresent(",test-url=".concat(t["test-url"]),"test-url"),e.appendIfPresent(",block-quic=".concat(t["block-quic"]),"block-quic"),e.toString()}function __isIP_107(t){return(0,_$utils_141.isIPv4)(t)||(0,_$utils_141.isIPv6)(t)}var _$clash_96={};Object.defineProperty(_$clash_96,"__esModule",{value:!0}),_$clash_96.default=function(){return{type:"ALL",produce:function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=t.filter(function(o){return!!r["include-unsupported-proxy"]||!(!["ss","ssr","vmess","vless","socks5","http","snell","trojan","wireguard"].includes(o.type)||o.type==="ss"&&!["aes-128-gcm","aes-192-gcm","aes-256-gcm","aes-128-cfb","aes-192-cfb","aes-256-cfb","aes-128-ctr","aes-192-ctr","aes-256-ctr","rc4-md5","chacha20-ietf","xchacha20","chacha20-ietf-poly1305","xchacha20-ietf-poly1305"].includes(o.cipher)||o.type==="snell"&&String(o.version)==="4"||o.type==="vless"&&(o.flow!==void 0||o["reality-opts"]))}).map(function(o){var f;if(o.type==="vmess")(0,_$utils_109.isPresent)(o,"aead")&&(o.aead&&(o.alterId=0),delete o.aead),(0,_$utils_109.isPresent)(o,"sni")&&(o.servername=o.sni,delete o.sni),(0,_$utils_109.isPresent)(o,"cipher")&&!["auto","aes-128-gcm","chacha20-poly1305","none"].includes(o.cipher)&&(o.cipher="auto");else if(o.type==="wireguard"){var d,h;o.keepalive=(d=o.keepalive)!==null&&d!==void 0?d:o["persistent-keepalive"],o["persistent-keepalive"]=o.keepalive,o["preshared-key"]=(h=o["preshared-key"])!==null&&h!==void 0?h:o["pre-shared-key"],o["pre-shared-key"]=o["preshared-key"]}else o.type==="vless"&&(0,_$utils_109.isPresent)(o,"sni")&&(o.servername=o.sni,delete o.sni);if(["vmess","vless"].includes(o.type)&&o.network==="http"){var y,k,A,D=(y=o["http-opts"])===null||y===void 0?void 0:y.path;(0,_$utils_109.isPresent)(o,"http-opts.path")&&!Array.isArray(D)&&(o["http-opts"].path=[D]);var q=(k=o["http-opts"])===null||k===void 0||(A=k.headers)===null||A===void 0?void 0:A.Host;(0,_$utils_109.isPresent)(o,"http-opts.headers.Host")&&!Array.isArray(q)&&(o["http-opts"].headers.Host=[q])}if(["vmess","vless"].includes(o.type)&&o.network==="h2"){var H,z,Z,j=(H=o["h2-opts"])===null||H===void 0?void 0:H.path;(0,_$utils_109.isPresent)(o,"h2-opts.path")&&Array.isArray(j)&&(o["h2-opts"].path=j[0]);var at=(z=o["h2-opts"])===null||z===void 0||(Z=z.headers)===null||Z===void 0?void 0:Z.host;(0,_$utils_109.isPresent)(o,"h2-opts.headers.Host")&&!Array.isArray(at)&&(o["h2-opts"].headers.host=[at])}if((f=o["plugin-opts"])!==null&&f!==void 0&&f.tls&&(0,_$utils_109.isPresent)(o,"skip-cert-verify")&&(o["plugin-opts"]["skip-cert-verify"]=o["skip-cert-verify"]),["trojan","tuic","hysteria","hysteria2","juicity"].includes(o.type)&&delete o.tls,o["tls-fingerprint"]&&(o.fingerprint=o["tls-fingerprint"]),delete o["tls-fingerprint"],o["underlying-proxy"]&&(o["dialer-proxy"]=o["underlying-proxy"]),delete o["underlying-proxy"],(0,_$utils_109.isPresent)(o,"tls")&&typeof o.tls!="boolean"&&delete o.tls,delete o.subName,delete o.collectionName,delete o.id,delete o.resolved,delete o["no-resolve"],e!=="internal")for(var ct in o)(o[ct]==null||/^_/i.test(ct))&&delete o[ct];return["grpc"].includes(o.network)&&o["".concat(o.network,"-opts")]&&(delete o["".concat(o.network,"-opts")]["_grpc-type"],delete o["".concat(o.network,"-opts")]["_grpc-authority"]),o});return e==="internal"?n:`proxies:
`+n.map(function(o){return"  - "+JSON.stringify(o)+`
`}).join("")}}};var _$stash_104={};function ___arrayLikeToArray_104(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}Object.defineProperty(_$stash_104,"__esModule",{value:!0}),_$stash_104.default=function(){return{type:"ALL",produce:function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=t.filter(function(o){return!(!["ss","ssr","vmess","socks5","http","snell","trojan","tuic","vless","wireguard","hysteria","hysteria2","ssh","juicity"].includes(o.type)||o.type==="ss"&&!["aes-128-gcm","aes-192-gcm","aes-256-gcm","aes-128-cfb","aes-192-cfb","aes-256-cfb","aes-128-ctr","aes-192-ctr","aes-256-ctr","rc4-md5","chacha20-ietf","xchacha20","chacha20-ietf-poly1305","xchacha20-ietf-poly1305"].concat((f=r["include-unsupported-proxy"]?["2022-blake3-aes-128-gcm","2022-blake3-aes-256-gcm"]:[],function(d){if(Array.isArray(d))return ___arrayLikeToArray_104(d)}(f)||function(d){if(typeof Symbol<"u"&&d[Symbol.iterator]!=null||d["@@iterator"]!=null)return Array.from(d)}(f)||function(d,h){if(d){if(typeof d=="string")return ___arrayLikeToArray_104(d,void 0);var y=Object.prototype.toString.call(d).slice(8,-1);return y==="Object"&&d.constructor&&(y=d.constructor.name),y==="Map"||y==="Set"?Array.from(d):y==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(y)?___arrayLikeToArray_104(d,void 0):void 0}}(f)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}())).includes(o.cipher)||o.type==="snell"&&String(o.version)==="4"||o.type==="vless"&&o["reality-opts"]);var f}).map(function(o){var f;if(o.type==="vmess")(0,_$utils_109.isPresent)(o,"aead")&&(o.aead&&(o.alterId=0),delete o.aead),(0,_$utils_109.isPresent)(o,"sni")&&(o.servername=o.sni,delete o.sni),(0,_$utils_109.isPresent)(o,"cipher")&&!["auto","aes-128-gcm","chacha20-poly1305","none"].includes(o.cipher)&&(o.cipher="auto");else if(o.type==="tuic")(0,_$utils_109.isPresent)(o,"alpn")?o.alpn=Array.isArray(o.alpn)?o.alpn:[o.alpn]:o.alpn=["h3"],(0,_$utils_109.isPresent)(o,"tfo")&&!(0,_$utils_109.isPresent)(o,"fast-open")&&(o["fast-open"]=o.tfo,delete o.tfo),o.token&&o.token.length!==0||(0,_$utils_109.isPresent)(o,"version")||(o.version=5);else if(o.type==="hysteria"){var d,h;(0,_$utils_109.isPresent)(o,"auth_str")&&!(0,_$utils_109.isPresent)(o,"auth-str")&&(o["auth-str"]=o.auth_str),(0,_$utils_109.isPresent)(o,"alpn")&&(o.alpn=Array.isArray(o.alpn)?o.alpn:[o.alpn]),(0,_$utils_109.isPresent)(o,"tfo")&&!(0,_$utils_109.isPresent)(o,"fast-open")&&(o["fast-open"]=o.tfo,delete o.tfo),(0,_$utils_109.isPresent)(o,"down")&&!(0,_$utils_109.isPresent)(o,"down-speed")&&(o["down-speed"]=o.down,delete o.down),(0,_$utils_109.isPresent)(o,"up")&&!(0,_$utils_109.isPresent)(o,"up-speed")&&(o["up-speed"]=o.up,delete o.up),(0,_$utils_109.isPresent)(o,"down-speed")&&(o["down-speed"]=((d="".concat(o["down-speed"]).match(/\d+/))===null||d===void 0?void 0:d[0])||0),(0,_$utils_109.isPresent)(o,"up-speed")&&(o["up-speed"]=((h="".concat(o["up-speed"]).match(/\d+/))===null||h===void 0?void 0:h[0])||0)}else if(o.type==="hysteria2"){var y,k;(0,_$utils_109.isPresent)(o,"password")&&!(0,_$utils_109.isPresent)(o,"auth")&&(o.auth=o.password,delete o.password),(0,_$utils_109.isPresent)(o,"tfo")&&!(0,_$utils_109.isPresent)(o,"fast-open")&&(o["fast-open"]=o.tfo,delete o.tfo),(0,_$utils_109.isPresent)(o,"down")&&!(0,_$utils_109.isPresent)(o,"down-speed")&&(o["down-speed"]=o.down,delete o.down),(0,_$utils_109.isPresent)(o,"up")&&!(0,_$utils_109.isPresent)(o,"up-speed")&&(o["up-speed"]=o.up,delete o.up),(0,_$utils_109.isPresent)(o,"down-speed")&&(o["down-speed"]=((y="".concat(o["down-speed"]).match(/\d+/))===null||y===void 0?void 0:y[0])||0),(0,_$utils_109.isPresent)(o,"up-speed")&&(o["up-speed"]=((k="".concat(o["up-speed"]).match(/\d+/))===null||k===void 0?void 0:k[0])||0)}else if(o.type==="wireguard"){var A,D;o.keepalive=(A=o.keepalive)!==null&&A!==void 0?A:o["persistent-keepalive"],o["persistent-keepalive"]=o.keepalive,o["preshared-key"]=(D=o["preshared-key"])!==null&&D!==void 0?D:o["pre-shared-key"],o["pre-shared-key"]=o["preshared-key"]}else o.type==="vless"&&(0,_$utils_109.isPresent)(o,"sni")&&(o.servername=o.sni,delete o.sni);if(["vmess","vless"].includes(o.type)&&o.network==="http"){var q,H,z,Z=(q=o["http-opts"])===null||q===void 0?void 0:q.path;(0,_$utils_109.isPresent)(o,"http-opts.path")&&!Array.isArray(Z)&&(o["http-opts"].path=[Z]);var j=(H=o["http-opts"])===null||H===void 0||(z=H.headers)===null||z===void 0?void 0:z.Host;(0,_$utils_109.isPresent)(o,"http-opts.headers.Host")&&!Array.isArray(j)&&(o["http-opts"].headers.Host=[j])}if(["vmess","vless"].includes(o.type)&&o.network==="h2"){var at,ct,ot,tt=(at=o["h2-opts"])===null||at===void 0?void 0:at.path;(0,_$utils_109.isPresent)(o,"h2-opts.path")&&Array.isArray(tt)&&(o["h2-opts"].path=tt[0]);var gt=(ct=o["h2-opts"])===null||ct===void 0||(ot=ct.headers)===null||ot===void 0?void 0:ot.host;(0,_$utils_109.isPresent)(o,"h2-opts.headers.Host")&&!Array.isArray(gt)&&(o["h2-opts"].headers.host=[gt])}if((f=o["plugin-opts"])!==null&&f!==void 0&&f.tls&&(0,_$utils_109.isPresent)(o,"skip-cert-verify")&&(o["plugin-opts"]["skip-cert-verify"]=o["skip-cert-verify"]),["trojan","tuic","hysteria","hysteria2","juicity"].includes(o.type)&&delete o.tls,o["tls-fingerprint"]&&(o["server-cert-fingerprint"]=o["tls-fingerprint"]),delete o["tls-fingerprint"],o["underlying-proxy"]&&(o["dialer-proxy"]=o["underlying-proxy"]),delete o["underlying-proxy"],(0,_$utils_109.isPresent)(o,"tls")&&typeof o.tls!="boolean"&&delete o.tls,o["test-url"]&&(o["benchmark-url"]=o["test-url"],delete o["test-url"]),o["test-timeout"]&&(o["benchmark-timeout"]=o["test-timeout"],delete o["test-timeout"]),delete o.subName,delete o.collectionName,delete o.id,delete o.resolved,delete o["no-resolve"],e!=="internal")for(var wt in o)(o[wt]==null||/^_/i.test(wt))&&delete o[wt];return["grpc"].includes(o.network)&&o["".concat(o.network,"-opts")]&&(delete o["".concat(o.network,"-opts")]["_grpc-type"],delete o["".concat(o.network,"-opts")]["_grpc-authority"]),o});return e==="internal"?n:`proxies:
`+n.map(function(o){return"  - "+JSON.stringify(o)+`
`}).join("")}}};var _$loon_100={};function ___arrayLikeToArray_100(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}Object.defineProperty(_$loon_100,"__esModule",{value:!0}),_$loon_100.default=function(){return{produce:function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};switch(t.type){case"ss":return function(n,o){var f,d=new _$utils_109.Result(n);if(!["rc4","rc4-md5","aes-128-cfb","aes-192-cfb","aes-256-cfb","aes-128-ctr","aes-192-ctr","aes-256-ctr","bf-cfb","camellia-128-cfb","camellia-192-cfb","camellia-256-cfb","salsa20","chacha20","chacha20-ietf","aes-128-gcm","aes-192-gcm","aes-256-gcm","chacha20-ietf-poly1305","xchacha20-ietf-poly1305"].concat((f=o?["2022-blake3-aes-128-gcm","2022-blake3-aes-256-gcm"]:[],function(h){if(Array.isArray(h))return ___arrayLikeToArray_100(h)}(f)||function(h){if(typeof Symbol<"u"&&h[Symbol.iterator]!=null||h["@@iterator"]!=null)return Array.from(h)}(f)||function(h,y){if(h){if(typeof h=="string")return ___arrayLikeToArray_100(h,void 0);var k=Object.prototype.toString.call(h).slice(8,-1);return k==="Object"&&h.constructor&&(k=h.constructor.name),k==="Map"||k==="Set"?Array.from(h):k==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(k)?___arrayLikeToArray_100(h,void 0):void 0}}(f)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}())).includes(n.cipher))throw new Error("cipher ".concat(n.cipher," is not supported"));if(d.append("".concat(n.name,"=shadowsocks,").concat(n.server,",").concat(n.port,",").concat(n.cipher,',"').concat(n.password,'"')),(0,_$utils_109.isPresent)(n,"plugin")){if(n.plugin!=="obfs")throw new Error("plugin ".concat(n.plugin," is not supported"));d.append(",obfs-name=".concat(n["plugin-opts"].mode)),d.appendIfPresent(",obfs-host=".concat(n["plugin-opts"].host),"plugin-opts.host"),d.appendIfPresent(",obfs-uri=".concat(n["plugin-opts"].path),"plugin-opts.path")}return d.appendIfPresent(",fast-open=".concat(n.tfo),"tfo"),n.udp&&d.append(",udp=true"),d.toString()}(t,r["include-unsupported-proxy"]);case"ssr":return function(n){var o=new _$utils_109.Result(n);return o.append("".concat(n.name,"=shadowsocksr,").concat(n.server,",").concat(n.port,",").concat(n.cipher,',"').concat(n.password,'"')),o.append(",protocol=".concat(n.protocol)),o.appendIfPresent(",protocol-param=".concat(n["protocol-param"]),"protocol-param"),o.appendIfPresent(",obfs=".concat(n.obfs),"obfs"),o.appendIfPresent(",obfs-param=".concat(n["obfs-param"]),"obfs-param"),o.appendIfPresent(",fast-open=".concat(n.tfo),"tfo"),n.udp&&o.append(",udp=true"),o.toString()}(t);case"trojan":return function(n){var o=new _$utils_109.Result(n);if(o.append("".concat(n.name,"=trojan,").concat(n.server,",").concat(n.port,',"').concat(n.password,'"')),n.network==="tcp"&&delete n.network,(0,_$utils_109.isPresent)(n,"network")){if(n.network!=="ws")throw new Error("network ".concat(n.network," is unsupported"));var f,d,h;o.append(",transport=ws"),o.appendIfPresent(",path=".concat((f=n["ws-opts"])===null||f===void 0?void 0:f.path),"ws-opts.path"),o.appendIfPresent(",host=".concat((d=n["ws-opts"])===null||d===void 0||(h=d.headers)===null||h===void 0?void 0:h.Host),"ws-opts.headers.Host")}return o.appendIfPresent(",skip-cert-verify=".concat(n["skip-cert-verify"]),"skip-cert-verify"),o.appendIfPresent(",tls-name=".concat(n.sni),"sni"),o.appendIfPresent(",tls-cert-sha256=".concat(n["tls-fingerprint"]),"tls-fingerprint"),o.appendIfPresent(",tls-pubkey-sha256=".concat(n["tls-pubkey-sha256"]),"tls-pubkey-sha256"),o.appendIfPresent(",fast-open=".concat(n.tfo),"tfo"),n.udp&&o.append(",udp=true"),o.toString()}(t);case"vmess":return function(n){var o=new _$utils_109.Result(n);if(o.append("".concat(n.name,"=vmess,").concat(n.server,",").concat(n.port,",").concat(n.cipher,',"').concat(n.uuid,'"')),n.network==="tcp"&&delete n.network,(0,_$utils_109.isPresent)(n,"network"))if(n.network==="ws"){var f,d,h;o.append(",transport=ws"),o.appendIfPresent(",path=".concat((f=n["ws-opts"])===null||f===void 0?void 0:f.path),"ws-opts.path"),o.appendIfPresent(",host=".concat((d=n["ws-opts"])===null||d===void 0||(h=d.headers)===null||h===void 0?void 0:h.Host),"ws-opts.headers.Host")}else{if(n.network!=="http")throw new Error("network ".concat(n.network," is unsupported"));var y,k,A;o.append(",transport=http");var D=(y=n["http-opts"])===null||y===void 0?void 0:y.path,q=(k=n["http-opts"])===null||k===void 0||(A=k.headers)===null||A===void 0?void 0:A.Host;o.appendIfPresent(",path=".concat(Array.isArray(D)?D[0]:D),"http-opts.path"),o.appendIfPresent(",host=".concat(Array.isArray(q)?q[0]:q),"http-opts.headers.Host")}else o.append(",transport=tcp");return o.appendIfPresent(",over-tls=".concat(n.tls),"tls"),o.appendIfPresent(",skip-cert-verify=".concat(n["skip-cert-verify"]),"skip-cert-verify"),o.appendIfPresent(",tls-name=".concat(n.sni),"sni"),o.appendIfPresent(",tls-cert-sha256=".concat(n["tls-fingerprint"]),"tls-fingerprint"),o.appendIfPresent(",tls-pubkey-sha256=".concat(n["tls-pubkey-sha256"]),"tls-pubkey-sha256"),(0,_$utils_109.isPresent)(n,"aead")?o.append(",alterId=0"):o.append(",alterId=".concat(n.alterId)),o.appendIfPresent(",fast-open=".concat(n.tfo),"tfo"),n.udp&&o.append(",udp=true"),o.toString()}(t);case"vless":return function(n){if(n["reality-opts"])throw new Error("VLESS REALITY is unsupported");var o=new _$utils_109.Result(n);if(o.append("".concat(n.name,"=vless,").concat(n.server,",").concat(n.port,',"').concat(n.uuid,'"')),n.network==="tcp"&&delete n.network,(0,_$utils_109.isPresent)(n,"network"))if(n.network==="ws"){var f,d,h;o.append(",transport=ws"),o.appendIfPresent(",path=".concat((f=n["ws-opts"])===null||f===void 0?void 0:f.path),"ws-opts.path"),o.appendIfPresent(",host=".concat((d=n["ws-opts"])===null||d===void 0||(h=d.headers)===null||h===void 0?void 0:h.Host),"ws-opts.headers.Host")}else{if(n.network!=="http")throw new Error("network ".concat(n.network," is unsupported"));var y,k,A;o.append(",transport=http");var D=(y=n["http-opts"])===null||y===void 0?void 0:y.path,q=(k=n["http-opts"])===null||k===void 0||(A=k.headers)===null||A===void 0?void 0:A.Host;o.appendIfPresent(",path=".concat(Array.isArray(D)?D[0]:D),"http-opts.path"),o.appendIfPresent(",host=".concat(Array.isArray(q)?q[0]:q),"http-opts.headers.Host")}else o.append(",transport=tcp");return o.appendIfPresent(",over-tls=".concat(n.tls),"tls"),o.appendIfPresent(",skip-cert-verify=".concat(n["skip-cert-verify"]),"skip-cert-verify"),o.appendIfPresent(",tls-name=".concat(n.sni),"sni"),o.appendIfPresent(",tls-cert-sha256=".concat(n["tls-fingerprint"]),"tls-fingerprint"),o.appendIfPresent(",tls-pubkey-sha256=".concat(n["tls-pubkey-sha256"]),"tls-pubkey-sha256"),o.appendIfPresent(",fast-open=".concat(n.tfo),"tfo"),n.udp&&o.append(",udp=true"),o.toString()}(t);case"http":return function(n){var o=new _$utils_109.Result(n),f=n.tls?"https":"http";return o.append("".concat(n.name,"=").concat(f,",").concat(n.server,",").concat(n.port)),o.appendIfPresent(",".concat(n.username),"username"),o.appendIfPresent(',"'.concat(n.password,'"'),"password"),o.appendIfPresent(",sni=".concat(n.sni),"sni"),o.appendIfPresent(",skip-cert-verify=".concat(n["skip-cert-verify"]),"skip-cert-verify"),o.appendIfPresent(",tfo=".concat(n.tfo),"tfo"),o.toString()}(t);case"socks5":return function(n){var o=new _$utils_109.Result(n);return o.append("".concat(n.name,"=socks5,").concat(n.server,",").concat(n.port)),o.appendIfPresent(",".concat(n.username),"username"),o.appendIfPresent(',"'.concat(n.password,'"'),"password"),o.appendIfPresent(",over-tls=".concat(n.tls),"tls"),o.appendIfPresent(",sni=".concat(n.sni),"sni"),o.appendIfPresent(",skip-cert-verify=".concat(n["skip-cert-verify"]),"skip-cert-verify"),o.appendIfPresent(",tfo=".concat(n.tfo),"tfo"),n.udp&&o.append(",udp=true"),o.toString()}(t);case"wireguard":return function(n){var o,f,d;Array.isArray(n.peers)&&n.peers.length>0&&(n.server=n.peers[0].server,n.port=n.peers[0].port,n.ip=n.peers[0].ip,n.ipv6=n.peers[0].ipv6,n["public-key"]=n.peers[0]["public-key"],n["preshared-key"]=n.peers[0]["pre-shared-key"],n["allowed-ips"]=n.peers[0]["allowed-ips"],n.reserved=n.peers[0].reserved);var h=new _$utils_109.Result(n);if(h.append("".concat(n.name,"=wireguard")),h.appendIfPresent(",interface-ip=".concat(n.ip),"ip"),h.appendIfPresent(",interface-ipv6=".concat(n.ipv6),"ipv6"),h.appendIfPresent(',private-key="'.concat(n["private-key"],'"'),"private-key"),h.appendIfPresent(",mtu=".concat(n.mtu),"mtu"),n.dns&&Array.isArray(n.dns)){n.dnsv6=n.dns.find(function(q){return(0,_$utils_141.isIPv6)(q)});var y=n.dns.find(function(q){return(0,_$utils_141.isIPv4)(q)});y||(y=n.dns.find(function(q){return!(0,_$utils_141.isIPv4)(q)&&!(0,_$utils_141.isIPv6)(q)})),n.dns=y}h.appendIfPresent(",dns=".concat(n.dns),"dns"),h.appendIfPresent(",dnsv6=".concat(n.dnsv6),"dnsv6"),h.appendIfPresent(",keepalive=".concat(n["persistent-keepalive"]),"persistent-keepalive"),h.appendIfPresent(",keepalive=".concat(n.keepalive),"keepalive");var k=Array.isArray(n["allowed-ips"])?n["allowed-ips"].join(","):n["allowed-ips"],A=Array.isArray(n.reserved)?n.reserved.join(","):n.reserved;A&&(A=",reserved=[".concat(A,"]"));var D=(o=n["preshared-key"])!==null&&o!==void 0?o:n["pre-shared-key"];return D&&(D=',preshared-key="'.concat(D,'"')),h.append(',peers=[{public-key="'.concat(n["public-key"],'",allowed-ips="').concat(k??"0.0.0.0/0,::/0",'",endpoint=').concat(n.server,":").concat(n.port).concat((f=A)!==null&&f!==void 0?f:"").concat((d=D)!==null&&d!==void 0?d:"","}]")),h.toString()}(t);case"hysteria2":return function(n){var o;if(n["obfs-password"]&&n.obfs!="salamander")throw new Error("only salamander obfs is supported");var f=new _$utils_109.Result(n);return f.append("".concat(n.name,"=Hysteria2,").concat(n.server,",").concat(n.port)),f.appendIfPresent(',"'.concat(n.password,'"'),"password"),f.appendIfPresent(",tls-name=".concat(n.sni),"sni"),f.appendIfPresent(",tls-cert-sha256=".concat(n["tls-fingerprint"]),"tls-fingerprint"),f.appendIfPresent(",tls-pubkey-sha256=".concat(n["tls-pubkey-sha256"]),"tls-pubkey-sha256"),f.appendIfPresent(",skip-cert-verify=".concat(n["skip-cert-verify"]),"skip-cert-verify"),n["obfs-password"]&&n.obfs=="salamander"&&f.append(",salamander-password=".concat(n["obfs-password"])),f.appendIfPresent(",fast-open=".concat(n.tfo),"tfo"),n.udp&&f.append(",udp=true"),f.appendIfPresent(",download-bandwidth=".concat(((o="".concat(n.down).match(/\d+/))===null||o===void 0?void 0:o[0])||0),"down"),f.appendIfPresent(",ecn=".concat(n.ecn),"ecn"),f.toString()}(t)}throw new Error("Platform ".concat(__targetPlatform_100," does not support proxy type: ").concat(t.type))}}};var __targetPlatform_100="Loon",_$uri_108={};Object.defineProperty(_$uri_108,"__esModule",{value:!0}),_$uri_108.default=function(){return{type:"SINGLE",produce:function(t){var e,r,n,o,f,d,h,y="";for(var k in delete t.subName,delete t.collectionName,delete t.id,delete t.resolved,delete t["no-resolve"],t)(t[k]==null||/^_/i.test(k))&&delete t[k];switch(["trojan","tuic","hysteria","hysteria2","juicity"].includes(t.type)&&delete t.tls,t.server&&(0,_$utils_141.isIPv6)(t.server)&&(t.server="[".concat(t.server,"]")),t.type){case"ss":var A="".concat(t.cipher,":").concat(t.password);if(y="ss://".concat((e=t.cipher)!==null&&e!==void 0&&e.startsWith("2022-blake3-")?"".concat(encodeURIComponent(t.cipher),":").concat(encodeURIComponent(t.password)):_$base64_20.Base64.encode(A),"@").concat(t.server,":").concat(t.port).concat(t.plugin?"/":""),t.plugin){y+="?plugin=";var D=t["plugin-opts"];switch(t.plugin){case"obfs":y+=encodeURIComponent("simple-obfs;obfs=".concat(D.mode).concat(D.host?";obfs-host="+D.host:""));break;case"v2ray-plugin":y+=encodeURIComponent("v2ray-plugin;obfs=".concat(D.mode).concat(D.host?";obfs-host"+D.host:"").concat(D.tls?";tls":""));break;default:throw new Error("Unsupported plugin option: ".concat(t.plugin))}}t["udp-over-tcp"]&&(y="".concat(y).concat(t.plugin?"&":"?","uot=1")),t.tfo&&(y="".concat(y).concat(t.plugin||t["udp-over-tcp"]?"&":"?","tfo=1")),y+="#".concat(encodeURIComponent(t.name));break;case"ssr":y="".concat(t.server,":").concat(t.port,":").concat(t.protocol,":").concat(t.cipher,":").concat(t.obfs,":").concat(_$base64_20.Base64.encode(t.password),"/"),y+="?remarks=".concat(_$base64_20.Base64.encode(t.name)).concat(t["obfs-param"]?"&obfsparam="+_$base64_20.Base64.encode(t["obfs-param"]):"").concat(t["protocol-param"]?"&protocolparam="+_$base64_20.Base64.encode(t["protocol-param"]):""),y="ssr://"+_$base64_20.Base64.encode(y);break;case"vmess":var q="",H=t.network||"tcp";if(t.network==="http"?(H="tcp",q="http"):t.network==="ws"&&(r=t["ws-opts"])!==null&&r!==void 0&&r["v2ray-http-upgrade"]&&(H="httpupgrade"),y={v:"2",ps:t.name,add:t.server,port:t.port,id:t.uuid,type:q,aid:t.alterId||0,net:H,tls:t.tls?"tls":""},t.tls&&t.sni&&(y.sni=t.sni),t.network){var z,Z,j,at,ct,ot,tt=(z=t["".concat(t.network,"-opts")])===null||z===void 0?void 0:z.path,gt=(Z=t["".concat(t.network,"-opts")])===null||Z===void 0||(j=Z.headers)===null||j===void 0?void 0:j.Host;tt&&(y.path=Array.isArray(tt)?tt[0]:tt),gt&&(y.host=Array.isArray(gt)?gt[0]:gt),["grpc"].includes(t.network)&&(y.path=(at=t["".concat(t.network,"-opts")])===null||at===void 0?void 0:at["grpc-service-name"],y.type=((ct=t["".concat(t.network,"-opts")])===null||ct===void 0?void 0:ct["_grpc-type"])||"gun",y.host=(ot=t["".concat(t.network,"-opts")])===null||ot===void 0?void 0:ot["_grpc-authority"])}y="vmess://"+_$base64_20.Base64.encode(JSON.stringify(y));break;case"vless":var wt="none",ft="",yt="";if(t["reality-opts"]){var Ct,l;wt="reality";var s=(Ct=t["reality-opts"])===null||Ct===void 0?void 0:Ct["public-key"];s&&(yt="&pbk=".concat(encodeURIComponent(s)));var b=(l=t["reality-opts"])===null||l===void 0?void 0:l["short-id"];b&&(ft="&sid=".concat(encodeURIComponent(b)))}else t.tls&&(wt="tls");var $="";t.alpn&&($="&alpn=".concat(encodeURIComponent(Array.isArray(t.alpn)?t.alpn:t.alpn.join(","))));var E="";t["skip-cert-verify"]&&(E="&allowInsecure=1");var rt="";t.sni&&(rt="&sni=".concat(encodeURIComponent(t.sni)));var _t="";t["client-fingerprint"]&&(_t="&fp=".concat(encodeURIComponent(t["client-fingerprint"])));var xt="";t.flow&&(xt="&flow=".concat(encodeURIComponent(t.flow)));var St=t.network;t.network==="ws"&&(n=t["ws-opts"])!==null&&n!==void 0&&n["v2ray-http-upgrade"]&&(St="httpupgrade");var x="&type=".concat(encodeURIComponent(St));if(["grpc"].includes(t.network)){var N,V;x+="&mode=".concat(encodeURIComponent(((N=t["".concat(t.network,"-opts")])===null||N===void 0?void 0:N["_grpc-type"])||"gun"));var S=(V=t["".concat(t.network,"-opts")])===null||V===void 0?void 0:V["_grpc-authority"];S&&(x+="&authority=".concat(encodeURIComponent(S)))}var C=(o=t["".concat(t.network,"-opts")])===null||o===void 0?void 0:o["".concat(t.network,"-service-name")],T=(f=t["".concat(t.network,"-opts")])===null||f===void 0?void 0:f.path,M=(d=t["".concat(t.network,"-opts")])===null||d===void 0||(h=d.headers)===null||h===void 0?void 0:h.Host;T&&(x+="&path=".concat(encodeURIComponent(Array.isArray(T)?T[0]:T))),M&&(x+="&host=".concat(encodeURIComponent(Array.isArray(M)?M[0]:M))),C&&(x+="&serviceName=".concat(encodeURIComponent(C))),t.network==="kcp"&&(t.seed&&(x+="&seed=".concat(encodeURIComponent(t.seed))),t.headerType&&(x+="&headerType=".concat(encodeURIComponent(t.headerType)))),y="vless://".concat(t.uuid,"@").concat(t.server,":").concat(t.port,"?security=").concat(encodeURIComponent(wt)).concat(x).concat($).concat(E).concat(rt).concat(_t).concat(xt).concat(ft).concat(yt,"#").concat(encodeURIComponent(t.name));break;case"trojan":var et="";if(t.network){var Pt,Ut,Zt,_e,me=t.network;if(t.network==="ws"&&(Pt=t["ws-opts"])!==null&&Pt!==void 0&&Pt["v2ray-http-upgrade"]&&(me="httpupgrade"),et="&type=".concat(encodeURIComponent(me)),["grpc"].includes(t.network)){var de,Xt,Gt,pe=(de=t["".concat(t.network,"-opts")])===null||de===void 0?void 0:de["".concat(t.network,"-service-name")],ge=(Xt=t["".concat(t.network,"-opts")])===null||Xt===void 0?void 0:Xt["_grpc-authority"];pe&&(et+="&serviceName=".concat(encodeURIComponent(pe))),ge&&(et+="&authority=".concat(encodeURIComponent(ge))),et+="&mode=".concat(encodeURIComponent(((Gt=t["".concat(t.network,"-opts")])===null||Gt===void 0?void 0:Gt["_grpc-type"])||"gun"))}var Dt=(Ut=t["".concat(t.network,"-opts")])===null||Ut===void 0?void 0:Ut.path,Nt=(Zt=t["".concat(t.network,"-opts")])===null||Zt===void 0||(_e=Zt.headers)===null||_e===void 0?void 0:_e.Host;Dt&&(et+="&path=".concat(encodeURIComponent(Array.isArray(Dt)?Dt[0]:Dt))),Nt&&(et+="&host=".concat(encodeURIComponent(Array.isArray(Nt)?Nt[0]:Nt)))}var ie="";t["client-fingerprint"]&&(ie="&fp=".concat(encodeURIComponent(t["client-fingerprint"])));var ee="";t.alpn&&(ee="&alpn=".concat(encodeURIComponent(Array.isArray(t.alpn)?t.alpn:t.alpn.join(",")))),y="trojan://".concat(t.password,"@").concat(t.server,":").concat(t.port,"?sni=").concat(encodeURIComponent(t.sni||t.server)).concat(t["skip-cert-verify"]?"&allowInsecure=1":"").concat(et).concat(ee).concat(ie,"#").concat(encodeURIComponent(t.name));break;case"hysteria2":var Kt=[];t["skip-cert-verify"]&&Kt.push("insecure=1"),t.obfs&&(Kt.push("obfs=".concat(encodeURIComponent(t.obfs))),t["obfs-password"]&&Kt.push("obfs-password=".concat(encodeURIComponent(t["obfs-password"])))),t.sni&&Kt.push("sni=".concat(encodeURIComponent(t.sni))),t.ports&&Kt.push("mport=".concat(t.ports)),t["tls-fingerprint"]&&Kt.push("pinSHA256=".concat(encodeURIComponent(t["tls-fingerprint"]))),t.tfo&&Kt.push("fastopen=1"),y="hysteria2://".concat(encodeURIComponent(t.password),"@").concat(t.server,":").concat(t.port,"?").concat(Kt.join("&"),"#").concat(encodeURIComponent(t.name));break;case"hysteria":var be=[];Object.keys(t).forEach(function(ce){if(!["name","type","server","port"].includes(ce)){var Vt=ce.replace(/-/,"_");["alpn"].includes(ce)?t[ce]&&be.push("".concat(Vt,"=").concat(encodeURIComponent(Array.isArray(t[ce])?t[ce][0]:t[ce]))):["skip-cert-verify"].includes(ce)?t[ce]&&be.push("insecure=1"):["tfo","fast-open"].includes(ce)?t[ce]&&!be.includes("fastopen=1")&&be.push("fastopen=1"):["ports"].includes(ce)?be.push("mport=".concat(t[ce])):["auth-str"].includes(ce)?be.push("auth=".concat(t[ce])):["up"].includes(ce)?be.push("upmbps=".concat(t[ce])):["down"].includes(ce)?be.push("downmbps=".concat(t[ce])):["_obfs"].includes(ce)?be.push("obfs=".concat(t[ce])):["obfs"].includes(ce)?be.push("obfsParam=".concat(t[ce])):["sni"].includes(ce)?be.push("peer=".concat(t[ce])):t[ce]&&be.push("".concat(Vt,"=").concat(encodeURIComponent(t[ce])))}}),y="hysteria://".concat(t.server,":").concat(t.port,"?").concat(be.join("&"),"#").concat(encodeURIComponent(t.name));break;case"tuic":if(!t.token||t.token.length===0){var v=[];Object.keys(t).forEach(function(ce){if(!["name","type","uuid","password","server","port"].includes(ce)){var Vt=ce.replace(/-/,"_");["alpn"].includes(ce)?t[ce]&&v.push("".concat(Vt,"=").concat(encodeURIComponent(Array.isArray(t[ce])?t[ce][0]:t[ce]))):["skip-cert-verify"].includes(ce)?t[ce]&&v.push("allow_insecure=1"):["tfo","fast-open"].includes(ce)?t[ce]&&!v.includes("fast_open=1")&&v.push("fast_open=1"):["disable-sni","reduce-rtt"].includes(ce)&&t[ce]?v.push("".concat(Vt,"=1")):t[ce]&&v.push("".concat(Vt,"=").concat(encodeURIComponent(t[ce])))}}),y="tuic://".concat(encodeURIComponent(t.uuid),":").concat(encodeURIComponent(t.password),"@").concat(t.server,":").concat(t.port,"?").concat(v.join("&"),"#").concat(encodeURIComponent(t.name))}break;case"wireguard":var Be=[];Object.keys(t).forEach(function(ce){["name","type","server","port","ip","ipv6","private-key"].includes(ce)||(["public-key"].includes(ce)?Be.push("publickey=".concat(t[ce])):["udp"].includes(ce)?t[ce]&&Be.push("".concat(ce,"=1")):t[ce]&&Be.push("".concat(ce,"=").concat(encodeURIComponent(t[ce]))))}),t.ip&&t.ipv6?Be.push("address=".concat(t.ip,"/32,").concat(t.ipv6,"/128")):t.ip?Be.push("address=".concat(t.ip,"/32")):t.ipv6&&Be.push("address=".concat(t.ipv6,"/128")),y="wireguard://".concat(encodeURIComponent(t["private-key"]),"@").concat(t.server,":").concat(t.port,"/?").concat(Be.join("&"),"#").concat(encodeURIComponent(t.name))}return y}}};var _$v2ray_110={};Object.defineProperty(_$v2ray_110,"__esModule",{value:!0}),_$v2ray_110.default=function(){return{type:"ALL",produce:function(t){var e=[];return t.map(function(r){try{e.push(URI.produce(r))}catch(n){___app_110.default.error("Cannot produce proxy: ".concat(JSON.stringify(r,null,2),`
Reason: `).concat(n))}}),_$base64_20.Base64.encode(e.join(`
`))}}};var _uri=___interopRequireDefault_110(_$uri_108),___app_110=___interopRequireDefault_110(_$app_87);function ___interopRequireDefault_110(t){return t&&t.__esModule?t:{default:t}}var URI=(0,_uri.default)(),_$qx_101={};Object.defineProperty(_$qx_101,"__esModule",{value:!0}),_$qx_101.default=function(){return{produce:function(t,e){switch(t.type){case"ss":return function(r){var n=new _$utils_109.Result(r),o=n.append.bind(n),f=n.appendIfPresent.bind(n);if(r.cipher||(r.cipher="none"),!["none","rc4-md5","rc4-md5-6","aes-128-cfb","aes-192-cfb","aes-256-cfb","aes-128-ctr","aes-192-ctr","aes-256-ctr","bf-cfb","cast5-cfb","des-cfb","rc2-cfb","salsa20","chacha20","chacha20-ietf","aes-128-gcm","aes-192-gcm","aes-256-gcm","chacha20-ietf-poly1305","xchacha20-ietf-poly1305"].includes(r.cipher))throw new Error("cipher ".concat(r.cipher," is not supported"));if(o("shadowsocks=".concat(r.server,":").concat(r.port)),o(",method=".concat(r.cipher)),o(",password=".concat(r.password)),needTls(r)&&(r.tls=!0),(0,_$utils_109.isPresent)(r,"plugin")){if(r.plugin==="obfs"){var d=r["plugin-opts"];o(",obfs=".concat(d.mode))}else{if(r.plugin!=="v2ray-plugin"||r["plugin-opts"].mode!=="websocket")throw new Error("plugin is not supported");r["plugin-opts"].tls?o(",obfs=wss"):o(",obfs=ws")}f(",obfs-host=".concat(r["plugin-opts"].host),"plugin-opts.host"),f(",obfs-uri=".concat(r["plugin-opts"].path),"plugin-opts.path")}return needTls(r)&&(f(",tls-pubkey-sha256=".concat(r["tls-pubkey-sha256"]),"tls-pubkey-sha256"),f(",tls-alpn=".concat(r["tls-alpn"]),"tls-alpn"),f(",tls-no-session-ticket=".concat(r["tls-no-session-ticket"]),"tls-no-session-ticket"),f(",tls-no-session-reuse=".concat(r["tls-no-session-reuse"]),"tls-no-session-reuse"),f(",tls-cert-sha256=".concat(r["tls-fingerprint"]),"tls-fingerprint"),f(",tls-verification=".concat(!r["skip-cert-verify"]),"skip-cert-verify"),f(",tls-host=".concat(r.sni),"sni")),f(",fast-open=".concat(r.tfo),"tfo"),f(",udp-relay=".concat(r.udp),"udp"),n.appendIfPresent(",server_check_url=".concat(r["test-url"]),"test-url"),o(",tag=".concat(r.name)),n.toString()}(t);case"ssr":return function(r){var n=new _$utils_109.Result(r),o=n.append.bind(n),f=n.appendIfPresent.bind(n);return o("shadowsocks=".concat(r.server,":").concat(r.port)),o(",method=".concat(r.cipher)),o(",password=".concat(r.password)),o(",ssr-protocol=".concat(r.protocol)),f(",ssr-protocol-param=".concat(r["protocol-param"]),"protocol-param"),f(",obfs=".concat(r.obfs),"obfs"),f(",obfs-host=".concat(r["obfs-param"]),"obfs-param"),f(",fast-open=".concat(r.tfo),"tfo"),f(",udp-relay=".concat(r.udp),"udp"),n.appendIfPresent(",server_check_url=".concat(r["test-url"]),"test-url"),o(",tag=".concat(r.name)),n.toString()}(t);case"trojan":return function(r){var n=new _$utils_109.Result(r),o=n.append.bind(n),f=n.appendIfPresent.bind(n);if(o("trojan=".concat(r.server,":").concat(r.port)),o(",password=".concat(r.password)),(0,_$utils_109.isPresent)(r,"network")){if(r.network!=="ws")throw new Error("network ".concat(r.network," is unsupported"));var d,h,y;needTls(r)?o(",obfs=wss"):o(",obfs=ws"),f(",obfs-uri=".concat((d=r["ws-opts"])===null||d===void 0?void 0:d.path),"ws-opts.path"),f(",obfs-host=".concat((h=r["ws-opts"])===null||h===void 0||(y=h.headers)===null||y===void 0?void 0:y.Host),"ws-opts.headers.Host")}return r.network!=="ws"&&needTls(r)&&o(",over-tls=true"),needTls(r)&&(f(",tls-pubkey-sha256=".concat(r["tls-pubkey-sha256"]),"tls-pubkey-sha256"),f(",tls-alpn=".concat(r["tls-alpn"]),"tls-alpn"),f(",tls-no-session-ticket=".concat(r["tls-no-session-ticket"]),"tls-no-session-ticket"),f(",tls-no-session-reuse=".concat(r["tls-no-session-reuse"]),"tls-no-session-reuse"),f(",tls-cert-sha256=".concat(r["tls-fingerprint"]),"tls-fingerprint"),f(",tls-verification=".concat(!r["skip-cert-verify"]),"skip-cert-verify"),f(",tls-host=".concat(r.sni),"sni")),f(",fast-open=".concat(r.tfo),"tfo"),f(",udp-relay=".concat(r.udp),"udp"),n.appendIfPresent(",server_check_url=".concat(r["test-url"]),"test-url"),o(",tag=".concat(r.name)),n.toString()}(t);case"vmess":return function(r){var n,o=new _$utils_109.Result(r),f=o.append.bind(o),d=o.appendIfPresent.bind(o);if(f("vmess=".concat(r.server,":").concat(r.port)),n=r.cipher==="auto"?"chacha20-ietf-poly1305":r.cipher,f(",method=".concat(n)),f(",password=".concat(r.uuid)),needTls(r)&&(r.tls=!0),(0,_$utils_109.isPresent)(r,"network")){var h,y,k;if(r.network==="ws")r.tls?f(",obfs=wss"):f(",obfs=ws");else{if(r.network!=="http")throw new Error("network ".concat(r.network," is unsupported"));f(",obfs=http")}var A=(h=r["".concat(r.network,"-opts")])===null||h===void 0?void 0:h.path,D=(y=r["".concat(r.network,"-opts")])===null||y===void 0||(k=y.headers)===null||k===void 0?void 0:k.Host;d(",obfs-uri=".concat(Array.isArray(A)?A[0]:A),"".concat(r.network,"-opts.path")),d(",obfs-host=".concat(Array.isArray(D)?D[0]:D),"".concat(r.network,"-opts.headers.Host"))}else r.tls&&f(",obfs=over-tls");return needTls(r)&&(d(",tls-pubkey-sha256=".concat(r["tls-pubkey-sha256"]),"tls-pubkey-sha256"),d(",tls-alpn=".concat(r["tls-alpn"]),"tls-alpn"),d(",tls-no-session-ticket=".concat(r["tls-no-session-ticket"]),"tls-no-session-ticket"),d(",tls-no-session-reuse=".concat(r["tls-no-session-reuse"]),"tls-no-session-reuse"),d(",tls-cert-sha256=".concat(r["tls-fingerprint"]),"tls-fingerprint"),d(",tls-verification=".concat(!r["skip-cert-verify"]),"skip-cert-verify"),d(",tls-host=".concat(r.sni),"sni")),(0,_$utils_109.isPresent)(r,"aead")?f(",aead=".concat(r.aead)):f(",aead=".concat(r.alterId===0)),d(",fast-open=".concat(r.tfo),"tfo"),d(",udp-relay=".concat(r.udp),"udp"),o.appendIfPresent(",server_check_url=".concat(r["test-url"]),"test-url"),f(",tag=".concat(r.name)),o.toString()}(t);case"http":return function(r){var n=new _$utils_109.Result(r),o=n.append.bind(n),f=n.appendIfPresent.bind(n);return o("http=".concat(r.server,":").concat(r.port)),f(",username=".concat(r.username),"username"),f(",password=".concat(r.password),"password"),needTls(r)&&(r.tls=!0),f(",over-tls=".concat(r.tls),"tls"),needTls(r)&&(f(",tls-pubkey-sha256=".concat(r["tls-pubkey-sha256"]),"tls-pubkey-sha256"),f(",tls-alpn=".concat(r["tls-alpn"]),"tls-alpn"),f(",tls-no-session-ticket=".concat(r["tls-no-session-ticket"]),"tls-no-session-ticket"),f(",tls-no-session-reuse=".concat(r["tls-no-session-reuse"]),"tls-no-session-reuse"),f(",tls-cert-sha256=".concat(r["tls-fingerprint"]),"tls-fingerprint"),f(",tls-verification=".concat(!r["skip-cert-verify"]),"skip-cert-verify"),f(",tls-host=".concat(r.sni),"sni")),f(",fast-open=".concat(r.tfo),"tfo"),f(",udp-relay=".concat(r.udp),"udp"),n.appendIfPresent(",server_check_url=".concat(r["test-url"]),"test-url"),o(",tag=".concat(r.name)),n.toString()}(t);case"socks5":return function(r){var n=new _$utils_109.Result(r),o=n.append.bind(n),f=n.appendIfPresent.bind(n);return o("socks5=".concat(r.server,":").concat(r.port)),f(",username=".concat(r.username),"username"),f(",password=".concat(r.password),"password"),needTls(r)&&(r.tls=!0),f(",over-tls=".concat(r.tls),"tls"),needTls(r)&&(f(",tls-pubkey-sha256=".concat(r["tls-pubkey-sha256"]),"tls-pubkey-sha256"),f(",tls-alpn=".concat(r["tls-alpn"]),"tls-alpn"),f(",tls-no-session-ticket=".concat(r["tls-no-session-ticket"]),"tls-no-session-ticket"),f(",tls-no-session-reuse=".concat(r["tls-no-session-reuse"]),"tls-no-session-reuse"),f(",tls-cert-sha256=".concat(r["tls-fingerprint"]),"tls-fingerprint"),f(",tls-verification=".concat(!r["skip-cert-verify"]),"skip-cert-verify"),f(",tls-host=".concat(r.sni),"sni")),f(",fast-open=".concat(r.tfo),"tfo"),f(",udp-relay=".concat(r.udp),"udp"),n.appendIfPresent(",server_check_url=".concat(r["test-url"]),"test-url"),o(",tag=".concat(r.name)),n.toString()}(t);case"vless":return function(r){if(r.flow!==void 0||r["reality-opts"])throw new Error("VLESS XTLS/REALITY is not supported");var n=new _$utils_109.Result(r),o=n.append.bind(n),f=n.appendIfPresent.bind(n);if(o("vless=".concat(r.server,":").concat(r.port)),o(",method=".concat("none")),o(",password=".concat(r.uuid)),needTls(r)&&(r.tls=!0),(0,_$utils_109.isPresent)(r,"network")){var d,h,y;if(r.network==="ws")r.tls?o(",obfs=wss"):o(",obfs=ws");else if(r.network==="http")o(",obfs=http");else if(!["tcp"].includes(r.network))throw new Error("network ".concat(r.network," is unsupported"));var k=(d=r["".concat(r.network,"-opts")])===null||d===void 0?void 0:d.path,A=(h=r["".concat(r.network,"-opts")])===null||h===void 0||(y=h.headers)===null||y===void 0?void 0:y.Host;f(",obfs-uri=".concat(Array.isArray(k)?k[0]:k),"".concat(r.network,"-opts.path")),f(",obfs-host=".concat(Array.isArray(A)?A[0]:A),"".concat(r.network,"-opts.headers.Host"))}else r.tls&&o(",obfs=over-tls");return needTls(r)&&(f(",tls-pubkey-sha256=".concat(r["tls-pubkey-sha256"]),"tls-pubkey-sha256"),f(",tls-alpn=".concat(r["tls-alpn"]),"tls-alpn"),f(",tls-no-session-ticket=".concat(r["tls-no-session-ticket"]),"tls-no-session-ticket"),f(",tls-no-session-reuse=".concat(r["tls-no-session-reuse"]),"tls-no-session-reuse"),f(",tls-cert-sha256=".concat(r["tls-fingerprint"]),"tls-fingerprint"),f(",tls-verification=".concat(!r["skip-cert-verify"]),"skip-cert-verify"),f(",tls-host=".concat(r.sni),"sni")),f(",fast-open=".concat(r.tfo),"tfo"),f(",udp-relay=".concat(r.udp),"udp"),n.appendIfPresent(",server_check_url=".concat(r["test-url"]),"test-url"),o(",tag=".concat(r.name)),n.toString()}(t)}throw new Error("Platform ".concat(__targetPlatform_101," does not support proxy type: ").concat(t.type))}}};var __targetPlatform_101="QX";function needTls(t){return t.tls}var _$shadowrocket_102={};Object.defineProperty(_$shadowrocket_102,"__esModule",{value:!0}),_$shadowrocket_102.default=function(){return{type:"ALL",produce:function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=t.filter(function(o){return!!r["include-unsupported-proxy"]||o.type!=="snell"||String(o.version)!=="4"}).map(function(o){var f;if(o.type==="vmess")(0,_$utils_109.isPresent)(o,"aead")&&(o.aead&&(o.alterId=0),delete o.aead),(0,_$utils_109.isPresent)(o,"sni")&&(o.servername=o.sni,delete o.sni),(0,_$utils_109.isPresent)(o,"cipher")&&!["auto","aes-128-gcm","chacha20-poly1305","none"].includes(o.cipher)&&(o.cipher="auto");else if(o.type==="tuic")(0,_$utils_109.isPresent)(o,"alpn")?o.alpn=Array.isArray(o.alpn)?o.alpn:[o.alpn]:o.alpn=["h3"],(0,_$utils_109.isPresent)(o,"tfo")&&!(0,_$utils_109.isPresent)(o,"fast-open")&&(o["fast-open"]=o.tfo),o.token&&o.token.length!==0||(0,_$utils_109.isPresent)(o,"version")||(o.version=5);else if(o.type==="hysteria")(0,_$utils_109.isPresent)(o,"auth_str")&&!(0,_$utils_109.isPresent)(o,"auth-str")&&(o["auth-str"]=o.auth_str),(0,_$utils_109.isPresent)(o,"alpn")&&(o.alpn=Array.isArray(o.alpn)?o.alpn:[o.alpn]),(0,_$utils_109.isPresent)(o,"tfo")&&!(0,_$utils_109.isPresent)(o,"fast-open")&&(o["fast-open"]=o.tfo);else if(o.type==="hysteria2")o["obfs-password"]&&o.obfs=="salamander"&&(o.obfs=o["obfs-password"],delete o["obfs-password"]),(0,_$utils_109.isPresent)(o,"alpn")&&(o.alpn=Array.isArray(o.alpn)?o.alpn:[o.alpn]),(0,_$utils_109.isPresent)(o,"tfo")&&!(0,_$utils_109.isPresent)(o,"fast-open")&&(o["fast-open"]=o.tfo);else if(o.type==="wireguard"){var d,h;o.keepalive=(d=o.keepalive)!==null&&d!==void 0?d:o["persistent-keepalive"],o["persistent-keepalive"]=o.keepalive,o["preshared-key"]=(h=o["preshared-key"])!==null&&h!==void 0?h:o["pre-shared-key"],o["pre-shared-key"]=o["preshared-key"]}else o.type==="vless"&&(0,_$utils_109.isPresent)(o,"sni")&&(o.servername=o.sni,delete o.sni);if(["vmess","vless"].includes(o.type)&&o.network==="http"){var y,k,A,D=(y=o["http-opts"])===null||y===void 0?void 0:y.path;(0,_$utils_109.isPresent)(o,"http-opts.path")&&!Array.isArray(D)&&(o["http-opts"].path=[D]);var q=(k=o["http-opts"])===null||k===void 0||(A=k.headers)===null||A===void 0?void 0:A.Host;(0,_$utils_109.isPresent)(o,"http-opts.headers.Host")&&!Array.isArray(q)&&(o["http-opts"].headers.Host=[q])}if(["vmess","vless"].includes(o.type)&&o.network==="h2"){var H,z,Z,j=(H=o["h2-opts"])===null||H===void 0?void 0:H.path;(0,_$utils_109.isPresent)(o,"h2-opts.path")&&Array.isArray(j)&&(o["h2-opts"].path=j[0]);var at=(z=o["h2-opts"])===null||z===void 0||(Z=z.headers)===null||Z===void 0?void 0:Z.host;(0,_$utils_109.isPresent)(o,"h2-opts.headers.Host")&&!Array.isArray(at)&&(o["h2-opts"].headers.host=[at])}if((f=o["plugin-opts"])!==null&&f!==void 0&&f.tls&&(0,_$utils_109.isPresent)(o,"skip-cert-verify")&&(o["plugin-opts"]["skip-cert-verify"]=o["skip-cert-verify"]),["trojan","tuic","hysteria","hysteria2","juicity"].includes(o.type)&&delete o.tls,o["tls-fingerprint"]&&(o.fingerprint=o["tls-fingerprint"]),delete o["tls-fingerprint"],o["underlying-proxy"]&&(o["dialer-proxy"]=o["underlying-proxy"]),delete o["underlying-proxy"],(0,_$utils_109.isPresent)(o,"tls")&&typeof o.tls!="boolean"&&delete o.tls,delete o.subName,delete o.collectionName,delete o.id,delete o.resolved,delete o["no-resolve"],e!=="internal")for(var ct in o)(o[ct]==null||/^_/i.test(ct))&&delete o[ct];return["grpc"].includes(o.network)&&o["".concat(o.network,"-opts")]&&(delete o["".concat(o.network,"-opts")]["_grpc-type"],delete o["".concat(o.network,"-opts")]["_grpc-authority"]),o});return e==="internal"?n:`proxies:
`+n.map(function(o){return"  - "+JSON.stringify(o)+`
`}).join("")}}};var _$surfboard_105={};Object.defineProperty(_$surfboard_105,"__esModule",{value:!0}),_$surfboard_105.default=function(){return{produce:function(t){switch(t.name=t.name.replace(/=|,/g,""),t.type){case"ss":return function(e){var r=new _$utils_109.Result(e);if(r.append("".concat(e.name,"=").concat(e.type,",").concat(e.server,",").concat(e.port)),!["aes-128-gcm","aes-192-gcm","aes-256-gcm","chacha20-ietf-poly1305","xchacha20-ietf-poly1305","rc4","rc4-md5","aes-128-cfb","aes-192-cfb","aes-256-cfb","aes-128-ctr","aes-192-ctr","aes-256-ctr","bf-cfb","camellia-128-cfb","camellia-192-cfb","camellia-256-cfb","salsa20","chacha20","chacha20-ietf"].includes(e.cipher))throw new Error("cipher ".concat(e.cipher," is not supported"));if(r.append(",encrypt-method=".concat(e.cipher)),r.appendIfPresent(",password=".concat(e.password),"password"),(0,_$utils_109.isPresent)(e,"plugin")){if(e.plugin!=="obfs")throw new Error("plugin ".concat(e.plugin," is not supported"));r.append(",obfs=".concat(e["plugin-opts"].mode)),r.appendIfPresent(",obfs-host=".concat(e["plugin-opts"].host),"plugin-opts.host"),r.appendIfPresent(",obfs-uri=".concat(e["plugin-opts"].path),"plugin-opts.path")}return r.appendIfPresent(",udp-relay=".concat(e.udp),"udp"),r.toString()}(t);case"trojan":return function(e){var r=new _$utils_109.Result(e);return r.append("".concat(e.name,"=").concat(e.type,",").concat(e.server,",").concat(e.port)),r.appendIfPresent(",password=".concat(e.password),"password"),__handleTransport_105(r,e),r.appendIfPresent(",tls=".concat(e.tls),"tls"),r.appendIfPresent(",sni=".concat(e.sni),"sni"),r.appendIfPresent(",skip-cert-verify=".concat(e["skip-cert-verify"]),"skip-cert-verify"),r.appendIfPresent(",tfo=".concat(e.tfo),"tfo"),r.appendIfPresent(",udp-relay=".concat(e.udp),"udp"),r.toString()}(t);case"vmess":return function(e){var r=new _$utils_109.Result(e);return r.append("".concat(e.name,"=").concat(e.type,",").concat(e.server,",").concat(e.port)),r.appendIfPresent(",username=".concat(e.uuid),"uuid"),__handleTransport_105(r,e),(0,_$utils_109.isPresent)(e,"aead")?r.append(",vmess-aead=".concat(e.aead)):r.append(",vmess-aead=".concat(e.alterId===0)),r.appendIfPresent(",tls=".concat(e.tls),"tls"),r.appendIfPresent(",sni=".concat(e.sni),"sni"),r.appendIfPresent(",skip-cert-verify=".concat(e["skip-cert-verify"]),"skip-cert-verify"),r.appendIfPresent(",udp-relay=".concat(e.udp),"udp"),r.toString()}(t);case"http":return function(e){var r=new _$utils_109.Result(e),n=e.tls?"https":"http";return r.append("".concat(e.name,"=").concat(n,",").concat(e.server,",").concat(e.port)),r.appendIfPresent(",".concat(e.username),"username"),r.appendIfPresent(",".concat(e.password),"password"),r.appendIfPresent(",sni=".concat(e.sni),"sni"),r.appendIfPresent(",skip-cert-verify=".concat(e["skip-cert-verify"]),"skip-cert-verify"),r.appendIfPresent(",udp-relay=".concat(e.udp),"udp"),r.toString()}(t);case"socks5":return function(e){var r=new _$utils_109.Result(e),n=e.tls?"socks5-tls":"socks5";return r.append("".concat(e.name,"=").concat(n,",").concat(e.server,",").concat(e.port)),r.appendIfPresent(",".concat(e.username),"username"),r.appendIfPresent(",".concat(e.password),"password"),r.appendIfPresent(",sni=".concat(e.sni),"sni"),r.appendIfPresent(",skip-cert-verify=".concat(e["skip-cert-verify"]),"skip-cert-verify"),r.appendIfPresent(",udp-relay=".concat(e.udp),"udp"),r.toString()}(t);case"wireguard-surge":return function(e){var r=new _$utils_109.Result(e);return r.append("".concat(e.name,"=wireguard")),r.appendIfPresent(",section-name=".concat(e["section-name"]),"section-name"),r.toString()}(t)}throw new Error("Platform ".concat(__targetPlatform_105," does not support proxy type: ").concat(t.type))}}};var __targetPlatform_105="Surfboard";function __handleTransport_105(t,e){if((0,_$utils_109.isPresent)(e,"network")){if(e.network!=="ws")throw new Error("network ".concat(e.network," is unsupported"));if(t.append(",ws=true"),(0,_$utils_109.isPresent)(e,"ws-opts")&&(t.appendIfPresent(",ws-path=".concat(e["ws-opts"].path),"ws-opts.path"),(0,_$utils_109.isPresent)(e,"ws-opts.headers"))){var r=e["ws-opts"].headers,n=Object.keys(r).map(function(o){var f=r[o];return["Host"].includes(o)&&(f='"'.concat(f,'"')),"".concat(o,":").concat(f)}).join("|");(0,_$utils_141.isNotBlank)(n)&&t.append(",ws-headers=".concat(n))}}}var _$singBox_103={};Object.defineProperty(_$singBox_103,"__esModule",{value:!0}),_$singBox_103.default=function(){return{type:"ALL",produce:function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[];return(0,___clashmeta_103.default)().produce(t,"internal",{"include-unsupported-proxy":!0}).map(function(o){try{switch(o.type){case"ssh":n.push(sshParser(o));break;case"http":n.push(httpParser(o));break;case"socks5":if(o.tls)throw new Error("Platform sing-box does not support proxy type: ".concat(o.type," with tls"));n.push(socks5Parser(o));break;case"ss":if(o.plugin==="shadow-tls"){var f=shadowTLSParser(o),d=f.ssPart,h=f.stPart;n.push(d),n.push(h)}else n.push(ssParser(o));break;case"ssr":if(!r["include-unsupported-proxy"])throw new Error("Platform sing-box does not support proxy type: ".concat(o.type));n.push(ssrParser(o));break;case"vmess":if(o.network&&!["ws","grpc","h2","http"].includes(o.network))throw new Error("Platform sing-box does not support proxy type: ".concat(o.type," with network ").concat(o.network));n.push(vmessParser(o));break;case"vless":if(o.flow&&!["xtls-rprx-vision"].includes(o.flow))throw new Error("Platform sing-box does not support proxy type: ".concat(o.type," with flow ").concat(o.flow));n.push(vlessParser(o));break;case"trojan":if(o.flow)throw new Error("Platform sing-box does not support proxy type: ".concat(o.type," with flow ").concat(o.flow));n.push(trojanParser(o));break;case"hysteria":n.push(hysteriaParser(o));break;case"hysteria2":n.push(hysteria2Parser(o));break;case"tuic":if(o.token&&o.token.length!==0)throw new Error("Platform sing-box does not support proxy type: TUIC v4");n.push(tuic5Parser(o));break;case"wireguard":n.push(wireguardParser(o));break;default:throw new Error("Platform sing-box does not support proxy type: ".concat(o.type))}}catch(k){var y;___app_103.default.error((y=k.message)!==null&&y!==void 0?y:k)}}),e==="internal"?n:JSON.stringify({outbounds:n},null,2)}}};var ___clashmeta_103=___interopRequireDefault_103(_$clashmeta_97),___app_103=___interopRequireDefault_103(_$app_87);function ___interopRequireDefault_103(t){return t&&t.__esModule?t:{default:t}}function ___slicedToArray_103(t,e){return function(r){if(Array.isArray(r))return r}(t)||function(r,n){var o=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o!=null){var f,d,h=[],y=!0,k=!1;try{for(o=o.call(r);!(y=(f=o.next()).done)&&(h.push(f.value),!n||h.length!==n);y=!0);}catch(A){k=!0,d=A}finally{try{y||o.return==null||o.return()}finally{if(k)throw d}}return h}}(t,e)||___unsupportedIterableToArray_103(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ___createForOfIteratorHelper_103(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=___unsupportedIterableToArray_103(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){r=r.call(t)},n:function(){var y=r.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||r.return==null||r.return()}finally{if(h)throw f}}}}function ___unsupportedIterableToArray_103(t,e){if(t){if(typeof t=="string")return ___arrayLikeToArray_103(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?___arrayLikeToArray_103(t,e):void 0}}function ___arrayLikeToArray_103(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var detourParser=function(t,e){e.detour=t["dialer-proxy"]||t.detour},tfoParser=function(t,e){e.tcp_fast_open=!1,t.tfo&&(e.tcp_fast_open=!0),t.tcp_fast_open&&(e.tcp_fast_open=!0),t["tcp-fast-open"]&&(e.tcp_fast_open=!0),e.tcp_fast_open||delete e.tcp_fast_open},smuxParser=function(t,e){t&&t.enabled&&(e.multiplex={enabled:!0},e.multiplex.protocol=t.protocol,t["max-connections"]&&(e.multiplex.max_connections=parseInt("".concat(t["max-connections"]),10)),t["max-streams"]&&(e.multiplex.max_streams=parseInt("".concat(t["max-streams"]),10)),t["min-streams"]&&(e.multiplex.min_streams=parseInt("".concat(t["min-streams"]),10)),t.padding&&(e.multiplex.padding=!0))},wsParser=function(t,e){var r={type:"ws",headers:{}};if(t["ws-opts"]){var n=t["ws-opts"],o=n.path,f=o===void 0?"":o,d=n.headers,h=d===void 0?{}:d;if(f!==""&&(r.path="".concat(f)),Object.keys(h).length>0){for(var y={},k=0,A=Object.keys(h);k<A.length;k++){var D=A[k],q=h[D];q!==""&&(Array.isArray(q)||(q=["".concat(q)]),q.length>0&&(y[D]=q))}var H=y.Host;if(H.length===1){var z,Z=___createForOfIteratorHelper_103("Host:".concat(H[0]).split(`
`));try{for(Z.s();!(z=Z.n()).done;){var j=___slicedToArray_103(z.value.split(":"),2),at=j[0],ct=j[1];ct.trim()!==""&&(y[at.trim()]=ct.trim().split(","))}}catch(et){Z.e(et)}finally{Z.f()}}r.headers=y}}if(t["ws-headers"]){for(var ot={},tt=0,gt=Object.keys(t["ws-headers"]);tt<gt.length;tt++){var wt=gt[tt],ft=t["ws-headers"][wt];ft!==""&&(Array.isArray(ft)||(ft=["".concat(ft)]),ft.length>0&&(ot[wt]=ft))}var yt=ot.Host;if(yt.length===1){var Ct,l=___createForOfIteratorHelper_103("Host:".concat(yt[0]).split(`
`));try{for(l.s();!(Ct=l.n()).done;){var s=___slicedToArray_103(Ct.value.split(":"),2),b=s[0],$=s[1];$.trim()!==""&&(ot[b.trim()]=$.trim().split(","))}}catch(et){l.e(et)}finally{l.f()}}for(var E=0,rt=Object.keys(ot);E<rt.length;E++){var _t=rt[E];r.headers[_t]=ot[_t]}}if(t["ws-path"]&&t["ws-path"]!==""&&(r.path="".concat(t["ws-path"])),r.path){var xt=___slicedToArray_103(/^(.*?)(?:\?ed=(\d+))?$/.exec(r.path),3),St=(xt[0],xt[1]),x=St===void 0?"":St,N=xt[2],V=N===void 0?"":N;r.path=x,V!==""&&(r.early_data_header_name="Sec-WebSocket-Protocol",r.max_early_data=parseInt(V,10))}e.tls.insecure&&(e.tls.server_name=r.headers.Host[0]),t["ws-opts"]&&t["ws-opts"]["v2ray-http-upgrade"]&&(r.type="httpupgrade",r.headers.Host&&(r.host=r.headers.Host[0],delete r.headers.Host),r.max_early_data&&delete r.max_early_data,r.early_data_header_name&&delete r.early_data_header_name);for(var S=0,C=Object.keys(r.headers);S<C.length;S++){var T=C[S],M=r.headers[T];M.length===1&&(r.headers[T]=M[0])}e.transport=r},grpcParser=function(t,e){var r={type:"grpc"};if(t["grpc-opts"]){var n=t["grpc-opts"]["grpc-service-name"];n!=null&&n!==""&&(r.service_name="".concat(n))}e.transport=r},tlsParser=function(t,e){t.tls&&(e.tls.enabled=!0),t.servername&&t.servername!==""&&(e.tls.server_name=t.servername),t.peer&&t.peer!==""&&(e.tls.server_name=t.peer),t.sni&&t.sni!==""&&(e.tls.server_name=t.sni),t["skip-cert-verify"]&&(e.tls.insecure=!0),t.insecure&&(e.tls.insecure=!0),t["disable-sni"]&&(e.tls.disable_sni=!0),typeof t.alpn=="string"?e.tls.alpn=[t.alpn]:Array.isArray(t.alpn)&&(e.tls.alpn=t.alpn),t.ca&&(e.tls.certificate_path="".concat(t.ca)),t.ca_str&&(e.tls.certificate=[t.ca_str]),t["ca-str"]&&(e.tls.certificate=[t["ca-str"]]),t["reality-opts"]&&(e.tls.reality={enabled:!0},t["reality-opts"]["public-key"]&&(e.tls.reality.public_key=t["reality-opts"]["public-key"]),t["reality-opts"]["short-id"]&&(e.tls.reality.short_id=t["reality-opts"]["short-id"]),e.tls.utls={enabled:!0}),t["client-fingerprint"]&&t["client-fingerprint"]!==""&&(e.tls.utls={enabled:!0,fingerprint:t["client-fingerprint"]}),e.tls.enabled||delete e.tls},sshParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"ssh",server:t.server,server_port:parseInt("".concat(t.port),10)};if(e.server_port<0||e.server_port>65535)throw"invalid port";return t.username&&(e.user=t.username),t.password&&(e.password=t.password),t.privateKey&&(e.private_key_path=t.privateKey),t["private-key"]&&(e.private_key_path=t["private-key"]),t["private-key-passphrase"]&&(e.private_key_passphrase=t["private-key-passphrase"]),t["server-fingerprint"]&&(e.host_key=[t["server-fingerprint"]],e.host_key_algorithms=[t["server-fingerprint"].split(" ")[0]]),t["host-key"]&&(e.host_key=t["host-key"]),t["host-key-algorithms"]&&(e.host_key_algorithms=t["host-key-algorithms"]),t["fast-open"]&&(e.udp_fragment=!0),tfoParser(t,e),detourParser(t,e),e},httpParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"http",server:t.server,server_port:parseInt("".concat(t.port),10),tls:{enabled:!1,server_name:t.server,insecure:!1}};if(e.server_port<0||e.server_port>65535)throw"invalid port";if(t.username&&(e.username=t.username),t.password&&(e.password=t.password),t.headers){e.headers={};for(var r=0,n=Object.keys(t.headers);r<n.length;r++){var o=n[r];e.headers[o]="".concat(t.headers[o])}Object.keys(e.headers).length===0&&delete e.headers}return t["fast-open"]&&(e.udp_fragment=!0),tfoParser(t,e),detourParser(t,e),tlsParser(t,e),e},socks5Parser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"socks",server:t.server,server_port:parseInt("".concat(t.port),10),password:t.password,version:"5"};if(e.server_port<0||e.server_port>65535)throw"invalid port";return t.username&&(e.username=t.username),t.password&&(e.password=t.password),t.uot&&(e.udp_over_tcp=!0),t["udp-over-tcp"]&&(e.udp_over_tcp=!0),t["fast-open"]&&(e.udp_fragment=!0),tfoParser(t,e),detourParser(t,e),e},shadowTLSParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"shadowsocks",method:t.cipher,password:t.password,detour:"".concat(t.name,"_shadowtls")},r={tag:"".concat(t.name,"_shadowtls"),type:"shadowtls",server:t.server,server_port:parseInt("".concat(t.port),10),version:t["plugin-opts"].version,password:t["plugin-opts"].password,tls:{enabled:!0,server_name:t["plugin-opts"].host,utls:{enabled:!0,fingerprint:t["client-fingerprint"]}}};if(r.server_port<0||r.server_port>65535)throw"\u7AEF\u53E3\u503C\u975E\u6CD5";return t["fast-open"]===!0&&(r.udp_fragment=!0),tfoParser(t,r),detourParser(t,r),smuxParser(t.smux,e),{type:"ss-with-st",ssPart:e,stPart:r}},ssParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"shadowsocks",server:t.server,server_port:parseInt("".concat(t.port),10),method:t.cipher,password:t.password};if(e.server_port<0||e.server_port>65535)throw"invalid port";if(t.uot&&(e.udp_over_tcp=!0),t["udp-over-tcp"]&&(e.udp_over_tcp=!0),t["fast-open"]&&(e.udp_fragment=!0),tfoParser(t,e),detourParser(t,e),smuxParser(t.smux,e),t.plugin){var r=[];t.plugin==="obfs"&&(e.plugin="obfs-local",e.plugin_opts="",t["obfs-host"]&&(t["plugin-opts"].host=t["obfs-host"]),Object.keys(t["plugin-opts"]).forEach(function(n){switch(n){case"mode":r.push("obfs=".concat(t["plugin-opts"].mode));break;case"host":r.push("obfs-host=".concat(t["plugin-opts"].host));break;default:r.push("".concat(n,"=").concat(t["plugin-opts"][n]))}})),t.plugin==="v2ray-plugin"&&(e.plugin="v2ray-plugin",t["ws-host"]&&(t["plugin-opts"].host=t["ws-host"]),t["ws-path"]&&(t["plugin-opts"].path=t["ws-path"]),Object.keys(t["plugin-opts"]).forEach(function(n){switch(n){case"tls":t["plugin-opts"].tls&&r.push("tls");break;case"host":r.push("host=".concat(t["plugin-opts"].host));break;case"path":r.push("path=".concat(t["plugin-opts"].path));break;case"headers":r.push("headers=".concat(JSON.stringify(t["plugin-opts"].headers)));break;case"mux":t["plugin-opts"].mux&&(e.multiplex={enabled:!0});break;default:r.push("".concat(n,"=").concat(t["plugin-opts"][n]))}})),e.plugin_opts=r.join(";")}return e},ssrParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"shadowsocksr",server:t.server,server_port:parseInt("".concat(t.port),10),method:t.cipher,password:t.password,obfs:t.obfs,protocol:t.protocol};if(e.server_port<0||e.server_port>65535)throw"invalid port";return t["obfs-param"]&&(e.obfs_param=t["obfs-param"]),t["protocol-param"]&&t["protocol-param"]!==""&&(e.protocol_param=t["protocol-param"]),t["fast-open"]&&(e.udp_fragment=!0),tfoParser(t,e),detourParser(t,e),smuxParser(t.smux,e),e},vmessParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"vmess",server:t.server,server_port:parseInt("".concat(t.port),10),uuid:t.uuid,security:t.cipher,alter_id:parseInt("".concat(t.alterId),10),tls:{enabled:!1,server_name:t.server,insecure:!1}};if(["auto","none","zero","aes-128-gcm","chacha20-poly1305","aes-128-ctr"].indexOf(e.security)===-1&&(e.security="auto"),e.server_port<0||e.server_port>65535)throw"invalid port";return t.xudp&&(e.packet_encoding="xudp"),t["fast-open"]&&(e.udp_fragment=!0),t.network==="ws"&&wsParser(t,e),t.network==="h2"&&function(r,n){var o={type:"http"};if(r["h2-opts"]){var f=r["h2-opts"],d=f.host,h=d===void 0?"":d,y=f.path,k=y===void 0?"":y;k!==""&&(o.path="".concat(k)),h!==""&&(Array.isArray(h)||(h="".concat(h).split(",").map(function(D){return D.trim()})),h.length>0&&(o.host=h))}if(r["h2-host"]&&r["h2-host"]!==""){var A=r["h2-host"];Array.isArray(A)||(A="".concat(A).split(",").map(function(D){return D.trim()})),A.length>0&&(o.host=A)}r["h2-path"]&&r["h2-path"]!==""&&(o.path="".concat(r["h2-path"])),n.tls.enabled=!0,n.tls.insecure&&(n.tls.server_name=o.host[0]),o.host.length===1&&(o.host=o.host[0]),n.transport=o}(t,e),t.network==="http"&&function(r,n){var o={type:"http",headers:{}};if(r["http-opts"]){var f=r["http-opts"],d=f.method,h=d===void 0?"":d,y=f.path,k=y===void 0?"":y,A=f.headers,D=A===void 0?{}:A;h!==""&&(o.method=h),Array.isArray(k)?o.path="".concat(k[0]):k!==""&&(o.path="".concat(k));for(var q=0,H=Object.keys(D);q<H.length;q++){var z=H[q],Z=D[z];if(Z!=="")if(z.toLowerCase()!=="host")Array.isArray(Z)||(Z="".concat(Z).split(",").map(function(ft){return ft.trim()})),Z.length>0&&(o.headers[z]=Z);else{var j=Z;Array.isArray(j)||(j="".concat(j).split(",").map(function(ft){return ft.trim()})),j.length>0&&(o.host=j)}}}if(r["http-host"]&&r["http-host"]!==""){var at=r["http-host"];Array.isArray(at)||(at="".concat(at).split(",").map(function(ft){return ft.trim()})),at.length>0&&(o.host=at)}if(o.host){if(r["http-path"]&&r["http-path"]!==""){var ct=r["http-path"];Array.isArray(ct)?o.path="".concat(ct[0]):ct!==""&&(o.path="".concat(ct))}n.tls.insecure&&(n.tls.server_name=o.host[0]),o.host.length===1&&(o.host=o.host[0]);for(var ot=0,tt=Object.keys(o.headers);ot<tt.length;ot++){var gt=tt[ot],wt=o.headers[gt];wt.length===1&&(o.headers[gt]=wt[0])}n.transport=o}}(t,e),t.network==="grpc"&&grpcParser(t,e),tfoParser(t,e),detourParser(t,e),tlsParser(t,e),smuxParser(t.smux,e),e},vlessParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"vless",server:t.server,server_port:parseInt("".concat(t.port),10),uuid:t.uuid,tls:{enabled:!1,server_name:t.server,insecure:!1}};if(e.server_port<0||e.server_port>65535)throw"invalid port";return t["fast-open"]&&(e.udp_fragment=!0),t.flow==="xtls-rprx-vision"&&(e.flow=t.flow),t.network==="ws"&&wsParser(t,e),t.network==="grpc"&&grpcParser(t,e),tfoParser(t,e),detourParser(t,e),smuxParser(t.smux,e),tlsParser(t,e),e},trojanParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"trojan",server:t.server,server_port:parseInt("".concat(t.port),10),password:t.password,tls:{enabled:!0,server_name:t.server,insecure:!1}};if(e.server_port<0||e.server_port>65535)throw"invalid port";return t["fast-open"]&&(e.udp_fragment=!0),t.network==="grpc"&&grpcParser(t,e),t.network==="ws"&&wsParser(t,e),tfoParser(t,e),detourParser(t,e),tlsParser(t,e),smuxParser(t.smux,e),e},hysteriaParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"hysteria",server:t.server,server_port:parseInt("".concat(t.port),10),disable_mtu_discovery:!1,tls:{enabled:!0,server_name:t.server,insecure:!1}};if(e.server_port<0||e.server_port>65535)throw"invalid port";t.auth_str&&(e.auth_str="".concat(t.auth_str)),t["auth-str"]&&(e.auth_str="".concat(t["auth-str"])),t["fast-open"]&&(e.udp_fragment=!0);var r=new RegExp("^[0-9]+[ 	]*[KMGT]*[Bb]ps$");return r.test("".concat(t.up))?e.up="".concat(t.up):e.up_mbps=parseInt("".concat(t.up),10),r.test("".concat(t.down))?e.down="".concat(t.down):e.down_mbps=parseInt("".concat(t.down),10),t.obfs&&(e.obfs=t.obfs),t.recv_window_conn&&(e.recv_window_conn=t.recv_window_conn),t["recv-window-conn"]&&(e.recv_window_conn=t["recv-window-conn"]),t.recv_window&&(e.recv_window=t.recv_window),t["recv-window"]&&(e.recv_window=t["recv-window"]),t.disable_mtu_discovery&&(typeof t.disable_mtu_discovery=="boolean"?e.disable_mtu_discovery=t.disable_mtu_discovery:t.disable_mtu_discovery===1&&(e.disable_mtu_discovery=!0)),tlsParser(t,e),detourParser(t,e),tfoParser(t,e),smuxParser(t.smux,e),e},hysteria2Parser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"hysteria2",server:t.server,server_port:parseInt("".concat(t.port),10),password:t.password,obfs:{},tls:{enabled:!0,server_name:t.server,insecure:!1}};if(e.server_port<0||e.server_port>65535)throw"invalid port";return t.up&&(e.up_mbps=parseInt("".concat(t.up),10)),t.down&&(e.down_mbps=parseInt("".concat(t.down),10)),t.obfs==="salamander"&&(e.obfs.type="salamander"),t["obfs-password"]&&(e.obfs.password=t["obfs-password"]),e.obfs.type||delete e.obfs,tlsParser(t,e),tfoParser(t,e),detourParser(t,e),smuxParser(t.smux,e),e},tuic5Parser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={tag:t.name,type:"tuic",server:t.server,server_port:parseInt("".concat(t.port),10),uuid:t.uuid,password:t.password,tls:{enabled:!0,server_name:t.server,insecure:!1}};if(e.server_port<0||e.server_port>65535)throw"invalid port";return t["fast-open"]&&(e.udp_fragment=!0),t["congestion-controller"]&&t["congestion-controller"]!=="cubic"&&(e.congestion_control=t["congestion-controller"]),t["udp-relay-mode"]&&t["udp-relay-mode"]!=="native"&&(e.udp_relay_mode=t["udp-relay-mode"]),t["reduce-rtt"]&&(e.zero_rtt_handshake=!0),t["udp-over-stream"]&&(e.udp_over_stream=!0),t["heartbeat-interval"]&&(e.heartbeat="".concat(t["heartbeat-interval"],"ms")),tfoParser(t,e),detourParser(t,e),tlsParser(t,e),smuxParser(t.smux,e),e},wireguardParser=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=["ip","ipv6"].map(function(H){return t[H]}).map(function(H){return(0,_$utils_141.isIPv4)(H)?"".concat(H,"/32"):(0,_$utils_141.isIPv6)(H)?"".concat(H,"/128"):void 0}).filter(function(H){return H}),r={tag:t.name,type:"wireguard",server:t.server,server_port:parseInt("".concat(t.port),10),local_address:e,private_key:t["private-key"],peer_public_key:t["public-key"],pre_shared_key:t["pre-shared-key"],reserved:[]};if(r.server_port<0||r.server_port>65535)throw"invalid port";if(t["fast-open"]&&(r.udp_fragment=!0),typeof t.reserved=="string")r.reserved=t.reserved;else if(Array.isArray(t.reserved)){var n,o=___createForOfIteratorHelper_103(t.reserved);try{for(o.s();!(n=o.n()).done;){var f=n.value;r.reserved.push(f)}}catch(H){o.e(H)}finally{o.f()}}else delete r.reserved;if(t.peers&&t.peers.length>0){r.peers=[];var d,h=___createForOfIteratorHelper_103(t.peers);try{for(h.s();!(d=h.n()).done;){var y=d.value,k={server:y.server,server_port:parseInt("".concat(y.port),10),public_key:y["public-key"],allowed_ips:y["allowed-ips"]||y.allowed_ips,reserved:[]};if(typeof y.reserved=="string")k.reserved.push(y.reserved);else if(Array.isArray(y.reserved)){var A,D=___createForOfIteratorHelper_103(y.reserved);try{for(D.s();!(A=D.n()).done;){var q=A.value;k.reserved.push(q)}}catch(H){D.e(H)}finally{D.f()}}else delete k.reserved;y["pre-shared-key"]&&(k.pre_shared_key=y["pre-shared-key"]),r.peers.push(k)}}catch(H){h.e(H)}finally{h.f()}}return tfoParser(t,r),detourParser(t,r),smuxParser(t.smux,r),r},_$egern_98={};function __ownKeys_98(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function ___objectSpread_98(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_98(Object(r),!0).forEach(function(n){___defineProperty_98(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):__ownKeys_98(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ___defineProperty_98(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Object.defineProperty(_$egern_98,"__esModule",{value:!0}),_$egern_98.default=function(){return{type:"ALL",produce:function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=t.filter(function(o){var f;return!!r["include-unsupported-proxy"]||!(!["http","socks5","ss","trojan","hysteria2","vless","vmess"].includes(o.type)||o.type==="ss"&&(o.plugin==="obfs"&&!["http","tls"].includes((f=o["plugin-opts"])===null||f===void 0?void 0:f.mode)||!["chacha20-ietf-poly1305","chacha20-poly1305","aes-256-gcm","aes-128-gcm","none","tbale","rc4","rc4-md5","aes-128-cfb","aes-192-cfb","aes-256-cfb","aes-128-ctr","aes-192-ctr","aes-256-ctr","bf-cfb","camellia-128-cfb","camellia-192-cfb","camellia-256-cfb","cast5-cfb","des-cfb","idea-cfb","rc2-cfb","seed-cfb","salsa20","chacha20","chacha20-ietf"].includes(o.cipher))||o.type==="vmess"&&(!["auto","aes-128-gcm","chacha20-poly1305","none","zero"].includes(o.cipher)||!["http","ws","tcp"].includes(o.network)&&o.network)||o.type==="trojan"&&!["http","ws","tcp"].includes(o.network)&&o.network||o.type==="vless"&&(o.flow!==void 0||o["reality-opts"]||!["http","ws","tcp"].includes(o.network)&&o.network))}).map(function(o){if(o.type==="http")o={type:"http",name:o.name,server:o.server,port:o.port,username:o.username,password:o.password,tfo:o.tfo||o["fast-open"],next_hop:o.next_hop};else if(o.type==="socks5")o={type:"socks5",name:o.name,server:o.server,port:o.port,username:o.username,password:o.password,tfo:o.tfo||o["fast-open"],udp_relay:o.udp||o.udp_relay||o.udp_relay,next_hop:o.next_hop};else if(o.type==="ss")(o={type:"shadowsocks",name:o.name,method:o.cipher==="chacha20-ietf-poly1305"?"chacha20-poly1305":o.cipher,server:o.server,port:o.port,password:o.password,tfo:o.tfo||o["fast-open"],udp_relay:o.udp||o.udp_relay||o.udp_relay,next_hop:o.next_hop}).plugin==="obfs"&&(o.obfs=o["plugin-opts"].mode,o.obfs_host=o["plugin-opts"].host,o.obfs_uri=o["plugin-opts"].path);else if(o.type==="hysteria2")(o={type:"hysteria2",name:o.name,server:o.server,port:o.port,auth:o.password,tfo:o.tfo||o["fast-open"],udp_relay:o.udp||o.udp_relay||o.udp_relay,next_hop:o.next_hop,sni:o.sni,skip_tls_verify:o["skip-cert-verify"]})["obfs-password"]&&o.obfs=="salamander"&&(o.obfs="salamander",o.obfs_password=o["obfs-password"]);else if(o.type==="trojan"){var f,d,h;o.network==="ws"&&(o.websocket={path:(f=o["ws-opts"])===null||f===void 0?void 0:f.path,host:(d=o["ws-opts"])===null||d===void 0||(h=d.headers)===null||h===void 0?void 0:h.Host}),o={type:"trojan",name:o.name,server:o.server,port:o.port,password:o.password,tfo:o.tfo||o["fast-open"],udp_relay:o.udp||o.udp_relay||o.udp_relay,next_hop:o.next_hop,sni:o.sni,skip_tls_verify:o["skip-cert-verify"],websocket:o.websocket}}else if(o.type==="vmess"){var y,k,A;if(o.network==="ws")o.transport=___defineProperty_98({},o.tls?"wss":"ws",{path:(y=o["ws-opts"])===null||y===void 0?void 0:y.path,headers:{Host:(k=o["ws-opts"])===null||k===void 0||(A=k.headers)===null||A===void 0?void 0:A.Host},sni:o.tls?o.sni:void 0,skip_tls_verify:o.tls?o["skip-cert-verify"]:void 0});else if(o.network==="http"){var D,q,H,z,Z,j,at,ct;o.transport={http:{method:(D=o["http-opts"])===null||D===void 0?void 0:D.method,path:(q=o["http-opts"])===null||q===void 0?void 0:q.path,headers:{Host:Array.isArray((H=o["http-opts"])===null||H===void 0||(z=H.headers)===null||z===void 0?void 0:z.Host)?(Z=o["http-opts"])===null||Z===void 0||(j=Z.headers)===null||j===void 0?void 0:j.Host[0]:(at=o["http-opts"])===null||at===void 0||(ct=at.headers)===null||ct===void 0?void 0:ct.Host},skip_tls_verify:o["skip-cert-verify"]}}}else o.network!=="tcp"&&o.network||(o.transport=___defineProperty_98({},o.tls?"tls":"tcp",{sni:o.tls?o.sni:void 0,skip_tls_verify:o.tls?o["skip-cert-verify"]:void 0}));o={type:"vmess",name:o.name,server:o.server,port:o.port,user_id:o.uuid,security:o.cipher,tfo:o.tfo||o["fast-open"],legacy:o.legacy,udp_relay:o.udp||o.udp_relay||o.udp_relay,next_hop:o.next_hop,transport:o.transport}}else if(o.type==="vless"){var ot,tt,gt;if(o.network==="ws")o.transport=___defineProperty_98({},o.tls?"wss":"ws",{path:(ot=o["ws-opts"])===null||ot===void 0?void 0:ot.path,headers:{Host:(tt=o["ws-opts"])===null||tt===void 0||(gt=tt.headers)===null||gt===void 0?void 0:gt.Host},sni:o.tls?o.sni:void 0,skip_tls_verify:o.tls?o["skip-cert-verify"]:void 0});else if(o.network==="http"){var wt,ft,yt,Ct,l,s,b,$;o.transport={http:{method:(wt=o["http-opts"])===null||wt===void 0?void 0:wt.method,path:(ft=o["http-opts"])===null||ft===void 0?void 0:ft.path,headers:{Host:Array.isArray((yt=o["http-opts"])===null||yt===void 0||(Ct=yt.headers)===null||Ct===void 0?void 0:Ct.Host)?(l=o["http-opts"])===null||l===void 0||(s=l.headers)===null||s===void 0?void 0:s.Host[0]:(b=o["http-opts"])===null||b===void 0||($=b.headers)===null||$===void 0?void 0:$.Host},skip_tls_verify:o["skip-cert-verify"]}}}else o.network!=="tcp"&&o.network||(o.transport=___defineProperty_98({},o.tls?"tls":"tcp",{sni:o.tls?o.sni:void 0,skip_tls_verify:o.tls?o["skip-cert-verify"]:void 0}));o={type:"vless",name:o.name,server:o.server,port:o.port,user_id:o.uuid,security:o.cipher,tfo:o.tfo||o["fast-open"],legacy:o.legacy,udp_relay:o.udp||o.udp_relay||o.udp_relay,next_hop:o.next_hop,transport:o.transport}}if(delete o.subName,delete o.collectionName,delete o.id,delete o.resolved,delete o["no-resolve"],e!=="internal")for(var E in o)(o[E]==null||/^_/i.test(E))&&delete o[E];return ___defineProperty_98({},o.type,___objectSpread_98(___objectSpread_98({},o),{},{type:void 0}))});return e==="internal"?n:`proxies:
`+n.map(function(o){return"  - "+JSON.stringify(o)+`
`}).join("")}}};var _$producers_99={};Object.defineProperty(_$producers_99,"__esModule",{value:!0}),_$producers_99.default=void 0;var ___surge_99=___interopRequireDefault_99(_$surge_106),_surgemac=___interopRequireDefault_99(_$surgemac_107),_clash=___interopRequireDefault_99(_$clash_96),___clashmeta_99=___interopRequireDefault_99(_$clashmeta_97),_stash=___interopRequireDefault_99(_$stash_104),_loon=___interopRequireDefault_99(_$loon_100),___uri_99=___interopRequireDefault_99(_$uri_108),_v2ray=___interopRequireDefault_99(_$v2ray_110),_qx=___interopRequireDefault_99(_$qx_101),_shadowrocket=___interopRequireDefault_99(_$shadowrocket_102),_surfboard=___interopRequireDefault_99(_$surfboard_105),_singBox=___interopRequireDefault_99(_$singBox_103),_egern=___interopRequireDefault_99(_$egern_98);function ___interopRequireDefault_99(t){return t&&t.__esModule?t:{default:t}}var ___default_99={QX:(0,_qx.default)(),QuantumultX:(0,_qx.default)(),Surge:(0,___surge_99.default)(),SurgeMac:(0,_surgemac.default)(),Loon:(0,_loon.default)(),Clash:(0,_clash.default)(),ClashMeta:(0,___clashmeta_99.default)(),URI:(0,___uri_99.default)(),V2Ray:(0,_v2ray.default)(),JSON:{type:"ALL",produce:function(t,e){return e==="internal"?t:JSON.stringify(t,null,2)}},Stash:(0,_stash.default)(),Shadowrocket:(0,_shadowrocket.default)(),ShadowRocket:(0,_shadowrocket.default)(),Surfboard:(0,_surfboard.default)(),"sing-box":(0,_singBox.default)(),Egern:(0,_egern.default)()};_$producers_99.default=___default_99;const setProtoOf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])};class GrammarError extends Error{constructor(e,r,n){super(e),setProtoOf(this,GrammarError.prototype),this.name="GrammarError",this.location=r,n===void 0&&(n=[]),this.diagnostics=n,this.stage=null,this.problems=[["error",e,r,n]]}toString(){let e=super.toString();this.location&&(e+=`
 at `,this.location.source!==void 0&&this.location.source!==null&&(e+=this.location.source+":"),e+=`${this.location.start.line}:${this.location.start.column}`);for(const r of this.diagnostics)e+=`
 from `,r.location.source!==void 0&&r.location.source!==null&&(e+=r.location.source+":"),e+=`${r.location.start.line}:${r.location.start.column}: ${r.message}`;return e}format(e){const r=e.map(({source:o,text:f})=>({source:o,text:f.split(/\r\n|\n|\r/g)}));function n(o,f,d=""){let h="";const y=r.find(({source:A})=>A===o.source),k=o.start;if(y){const A=o.end,D=y.text[k.line-1],q=(k.line===A.line?A.column:D.length+1)-k.column||1;d&&(h+=`
note: `+d),h+=`
 --> ${o.source}:${k.line}:${k.column}
${"".padEnd(f)} |
${k.line.toString().padStart(f)} | ${D}
${"".padEnd(f)} | ${"".padEnd(k.column-1)}${"".padEnd(q,"^")}`}else h+=`
 at ${o.source}:${k.line}:${k.column}`,d&&(h+=": "+d);return h}return this.problems.filter(o=>o[0]!=="info").map(o=>function(f,d,h,y=[]){let k;k=(k=h?y.reduce((D,{location:q})=>Math.max(D,q.start.line),h.start.line):Math.max.apply(null,y.map(D=>D.location.start.line))).toString().length;let A=`${f}: ${d}`;h&&(A+=n(h,k));for(const D of y)A+=n(D.location,k,D.message);return A}(...o)).join(`

`)}}var _$GrammarError_71=GrammarError;const visitor={build(t){function e(d,...h){return t[d.type](d,...h)}function r(){}function n(d,...h){return e(d.expression,...h)}function o(d){return function(h,...y){h[d].forEach(k=>e(k,...y))}}const f={grammar(d,...h){d.topLevelInitializer&&e(d.topLevelInitializer,...h),d.initializer&&e(d.initializer,...h),d.rules.forEach(y=>e(y,...h))},top_level_initializer:r,initializer:r,rule:n,named:n,choice:o("alternatives"),action:n,sequence:o("elements"),labeled:n,text:n,simple_and:n,simple_not:n,optional:n,zero_or_more:n,one_or_more:n,group:n,semantic_and:r,semantic_not:r,rule_ref:r,literal:r,class:r,any:r};return Object.keys(f).forEach(d=>{Object.prototype.hasOwnProperty.call(t,d)||(t[d]=f[d])}),e}};var _$visitor_70=visitor;const asts={findRule(t,e){for(let r=0;r<t.rules.length;r++)if(t.rules[r].name===e)return t.rules[r]},indexOfRule(t,e){for(let r=0;r<t.rules.length;r++)if(t.rules[r].name===e)return r;return-1},alwaysConsumesOnSuccess(t,e){function r(){return!0}function n(){return!1}const o=_$visitor_70.build({choice:f=>f.alternatives.every(o),sequence:f=>f.elements.some(o),simple_and:n,simple_not:n,optional:n,zero_or_more:n,semantic_and:n,semantic_not:n,rule_ref(f){const d=asts.findRule(t,f.name);return d?o(d):void 0},literal:f=>f.value!=="",class:r,any:r});return o(e)}};var _$asts_54=asts,_$opcodes_56={PUSH:0,PUSH_EMPTY_STRING:35,PUSH_UNDEFINED:1,PUSH_NULL:2,PUSH_FAILED:3,PUSH_EMPTY_ARRAY:4,PUSH_CURR_POS:5,POP:6,POP_CURR_POS:7,POP_N:8,NIP:9,APPEND:10,WRAP:11,TEXT:12,PLUCK:36,IF:13,IF_ERROR:14,IF_NOT_ERROR:15,WHILE_NOT_ERROR:16,MATCH_ANY:17,MATCH_STRING:18,MATCH_STRING_IC:19,MATCH_CHAR_CLASS:20,MATCH_REGEXP:20,ACCEPT_N:21,ACCEPT_STRING:22,FAIL:23,LOAD_SAVED_POS:24,UPDATE_SAVED_POS:25,CALL:26,RULE:27,SILENT_FAILS_ON:28,SILENT_FAILS_OFF:29},_$inferenceMatchResult_59={};const ALWAYS_MATCH=1,SOMETIMES_MATCH=0,NEVER_MATCH=-1;function inferenceMatchResult(t){function e(d){return d.match=SOMETIMES_MATCH}function r(d){return f(d.expression),d.match=ALWAYS_MATCH}function n(d){return d.match=f(d.expression)}function o(d,h){const y=d.length;let k=0,A=0;for(let D=0;D<y;++D){const q=f(d[D]);q===ALWAYS_MATCH&&++k,q===NEVER_MATCH&&++A}return k===y?ALWAYS_MATCH:h?A===y?NEVER_MATCH:SOMETIMES_MATCH:A>0?NEVER_MATCH:SOMETIMES_MATCH}const f=_$visitor_70.build({rule(d){let h,y=0;if(d.match===void 0){d.match=SOMETIMES_MATCH;do if(h=d.match,d.match=f(d.expression),++y>6)throw new _$GrammarError_71("Infinity cycle detected when trying to evaluate node match result",d.location);while(h!==d.match)}return d.match},named:n,choice:d=>d.match=o(d.alternatives,!0),action:n,sequence:d=>d.match=o(d.elements,!1),labeled:n,text:n,simple_and:n,simple_not:d=>d.match=-f(d.expression),optional:r,zero_or_more:r,one_or_more:n,group:n,semantic_and:e,semantic_not:e,rule_ref(d){const h=_$asts_54.findRule(t,d.name);return d.match=f(h)},literal(d){const h=d.value.length===0?ALWAYS_MATCH:SOMETIMES_MATCH;return d.match=h},class(d){const h=d.parts.length===0?NEVER_MATCH:SOMETIMES_MATCH;return d.match=h},any:e});f(t)}inferenceMatchResult.ALWAYS_MATCH=ALWAYS_MATCH,inferenceMatchResult.SOMETIMES_MATCH=SOMETIMES_MATCH,inferenceMatchResult.NEVER_MATCH=NEVER_MATCH,_$inferenceMatchResult_59=inferenceMatchResult;const{ALWAYS_MATCH:__ALWAYS_MATCH_57,SOMETIMES_MATCH:__SOMETIMES_MATCH_57,NEVER_MATCH:__NEVER_MATCH_57}=_$inferenceMatchResult_59;var _$generateBytecode_57=function(t){const e=[],r=[],n=[],o=[];function f(Z){const j=JSON.stringify(Z),at=n.findIndex(ct=>JSON.stringify(ct)===j);return at===-1?n.push(Z)-1:at}function d(Z,j,at){const ct={predicate:Z,params:j,body:at.code,location:at.codeLocation},ot=JSON.stringify(ct),tt=o.findIndex(gt=>JSON.stringify(gt)===ot);return tt===-1?o.push(ct)-1:tt}function h(Z){const j={};return Object.keys(Z).forEach(at=>{j[at]=Z[at]}),j}function y(Z,...j){return Z.concat(...j)}function k(Z,j,at,ct){return Z===__ALWAYS_MATCH_57?at:Z===__NEVER_MATCH_57?ct:j.concat([at.length,ct.length],at,ct)}function A(Z,j,at,ct){const ot=Object.keys(at).map(tt=>ct-at[tt]);return[_$opcodes_56.CALL,Z,j,ot.length].concat(ot)}function D(Z,j,at){const ct=0|Z.match;return y([_$opcodes_56.PUSH_CURR_POS],[_$opcodes_56.SILENT_FAILS_ON],z(Z,{sp:at.sp+1,env:h(at.env),action:null}),[_$opcodes_56.SILENT_FAILS_OFF],k(j?-ct:ct,[j?_$opcodes_56.IF_ERROR:_$opcodes_56.IF_NOT_ERROR],y([_$opcodes_56.POP],[j?_$opcodes_56.POP:_$opcodes_56.POP_CURR_POS],[_$opcodes_56.PUSH_UNDEFINED]),y([_$opcodes_56.POP],[j?_$opcodes_56.POP_CURR_POS:_$opcodes_56.POP],[_$opcodes_56.PUSH_FAILED])))}function q(Z,j,at){const ct=d(!0,Object.keys(at.env),Z);return y([_$opcodes_56.UPDATE_SAVED_POS],A(ct,0,at.env,at.sp),k(0|Z.match,[_$opcodes_56.IF],y([_$opcodes_56.POP],j?[_$opcodes_56.PUSH_FAILED]:[_$opcodes_56.PUSH_UNDEFINED]),y([_$opcodes_56.POP],j?[_$opcodes_56.PUSH_UNDEFINED]:[_$opcodes_56.PUSH_FAILED])))}function H(Z){return j=[_$opcodes_56.WHILE_NOT_ERROR],at=y([_$opcodes_56.APPEND],Z),j.concat([at.length],at);var j,at}const z=_$visitor_70.build({grammar(Z){Z.rules.forEach(z),Z.literals=e,Z.classes=r,Z.expectations=n,Z.functions=o},rule(Z){Z.bytecode=z(Z.expression,{sp:-1,env:{},pluck:[],action:null})},named(Z,j){const at=0|Z.match,ct=at===__NEVER_MATCH_57?null:f({type:"rule",value:Z.name});return y([_$opcodes_56.SILENT_FAILS_ON],z(Z.expression,j),[_$opcodes_56.SILENT_FAILS_OFF],k(at,[_$opcodes_56.IF_ERROR],[_$opcodes_56.FAIL,ct],[]))},choice:(Z,j)=>function at(ct,ot){const tt=0|ct[0].match,gt=z(ct[0],{sp:ot.sp,env:h(ot.env),action:null});return tt===__ALWAYS_MATCH_57?gt:y(gt,ct.length>1?k(__SOMETIMES_MATCH_57,[_$opcodes_56.IF_ERROR],y([_$opcodes_56.POP],at(ct.slice(1),ot)),[]):[])}(Z.alternatives,j),action(Z,j){const at=h(j.env),ct=Z.expression.type!=="sequence"||Z.expression.elements.length===0,ot=z(Z.expression,{sp:j.sp+(ct?1:0),env:at,action:Z}),tt=0|Z.expression.match,gt=ct&&tt!==__NEVER_MATCH_57?d(!1,Object.keys(at),Z):null;return ct?y([_$opcodes_56.PUSH_CURR_POS],ot,k(tt,[_$opcodes_56.IF_NOT_ERROR],y([_$opcodes_56.LOAD_SAVED_POS,1],A(gt,1,at,j.sp+2)),[]),[_$opcodes_56.NIP]):ot},sequence:(Z,j)=>y([_$opcodes_56.PUSH_CURR_POS],function at(ct,ot){if(ct.length>0){const tt=Z.elements.length-ct.length+1;return y(z(ct[0],{sp:ot.sp,env:ot.env,pluck:ot.pluck,action:null}),k(0|ct[0].match,[_$opcodes_56.IF_NOT_ERROR],at(ct.slice(1),{sp:ot.sp+1,env:ot.env,pluck:ot.pluck,action:ot.action}),y(tt>1?[_$opcodes_56.POP_N,tt]:[_$opcodes_56.POP],[_$opcodes_56.POP_CURR_POS],[_$opcodes_56.PUSH_FAILED])))}if(ot.pluck.length>0)return y([_$opcodes_56.PLUCK,Z.elements.length+1,ot.pluck.length],ot.pluck.map(tt=>ot.sp-tt));if(ot.action){const tt=d(!1,Object.keys(ot.env),ot.action);return y([_$opcodes_56.LOAD_SAVED_POS,Z.elements.length],A(tt,Z.elements.length+1,ot.env,ot.sp))}return y([_$opcodes_56.WRAP,Z.elements.length],[_$opcodes_56.NIP])}(Z.elements,{sp:j.sp+1,env:j.env,pluck:[],action:j.action})),labeled(Z,j){let at=j.env;const ct=Z.label,ot=j.sp+1;return ct&&(at=h(j.env),j.env[Z.label]=ot),Z.pick&&j.pluck.push(ot),z(Z.expression,{sp:j.sp,env:at,action:null})},text:(Z,j)=>y([_$opcodes_56.PUSH_CURR_POS],z(Z.expression,{sp:j.sp+1,env:h(j.env),action:null}),k(0|Z.match,[_$opcodes_56.IF_NOT_ERROR],y([_$opcodes_56.POP],[_$opcodes_56.TEXT]),[_$opcodes_56.NIP])),simple_and:(Z,j)=>D(Z.expression,!1,j),simple_not:(Z,j)=>D(Z.expression,!0,j),optional:(Z,j)=>y(z(Z.expression,{sp:j.sp,env:h(j.env),action:null}),k(-(0|Z.expression.match),[_$opcodes_56.IF_ERROR],y([_$opcodes_56.POP],[_$opcodes_56.PUSH_NULL]),[])),zero_or_more(Z,j){const at=z(Z.expression,{sp:j.sp+1,env:h(j.env),action:null});return y([_$opcodes_56.PUSH_EMPTY_ARRAY],at,H(at),[_$opcodes_56.POP])},one_or_more(Z,j){const at=z(Z.expression,{sp:j.sp+1,env:h(j.env),action:null});return y([_$opcodes_56.PUSH_EMPTY_ARRAY],at,k(0|Z.expression.match,[_$opcodes_56.IF_NOT_ERROR],y(H(at),[_$opcodes_56.POP]),y([_$opcodes_56.POP],[_$opcodes_56.POP],[_$opcodes_56.PUSH_FAILED])))},group:(Z,j)=>z(Z.expression,{sp:j.sp,env:h(j.env),action:null}),semantic_and:(Z,j)=>q(Z,!1,j),semantic_not:(Z,j)=>q(Z,!0,j),rule_ref:Z=>[_$opcodes_56.RULE,_$asts_54.indexOfRule(t,Z.name)],literal(Z){if(Z.value.length>0){const j=0|Z.match,at=j===__SOMETIMES_MATCH_57||j===__ALWAYS_MATCH_57&&!Z.ignoreCase?function(ot){const tt=e.indexOf(ot);return tt===-1?e.push(ot)-1:tt}(Z.ignoreCase?Z.value.toLowerCase():Z.value):null,ct=j!==__ALWAYS_MATCH_57?f({type:"literal",value:Z.value,ignoreCase:Z.ignoreCase}):null;return k(j,Z.ignoreCase?[_$opcodes_56.MATCH_STRING_IC,at]:[_$opcodes_56.MATCH_STRING,at],Z.ignoreCase?[_$opcodes_56.ACCEPT_N,Z.value.length]:[_$opcodes_56.ACCEPT_STRING,at],[_$opcodes_56.FAIL,ct])}return[_$opcodes_56.PUSH_EMPTY_STRING]},class(Z){const j=0|Z.match,at=j===__SOMETIMES_MATCH_57?function(ot){const tt={value:ot.parts,inverted:ot.inverted,ignoreCase:ot.ignoreCase},gt=JSON.stringify(tt),wt=r.findIndex(ft=>JSON.stringify(ft)===gt);return wt===-1?r.push(tt)-1:wt}(Z):null,ct=j!==__ALWAYS_MATCH_57?f({type:"class",value:Z.parts,inverted:Z.inverted,ignoreCase:Z.ignoreCase}):null;return k(j,[_$opcodes_56.MATCH_CHAR_CLASS,at],[_$opcodes_56.ACCEPT_N,1],[_$opcodes_56.FAIL,ct])},any(Z){const j=0|Z.match,at=j!==__ALWAYS_MATCH_57?f({type:"any"}):null;return k(j,[_$opcodes_56.MATCH_ANY],[_$opcodes_56.ACCEPT_N,1],[_$opcodes_56.FAIL,at])}});z(t)},_$stack_68=class{constructor(t,e,r){this.sp=-1,this.maxSp=-1,this.varName=e,this.ruleName=t,this.type=r}name(t){if(t<0)throw new RangeError(`Rule '${this.ruleName}': The variable stack underflow: attempt to use a variable '${this.varName}<x>' at an index ${t}`);return this.varName+t}push(t){const e=this.name(++this.sp)+" = "+t+";";return this.sp>this.maxSp&&(this.maxSp=this.sp),e}pop(t){return t!==void 0?(this.sp-=t,Array.from({length:t},(e,r)=>this.name(this.sp+1+r))):this.name(this.sp--)}top(){return this.name(this.sp)}index(t){if(t<0)throw new RangeError(`Rule '${this.ruleName}': The variable stack overflow: attempt to get a variable at a negative index ${t}`);return this.name(this.sp-t)}result(){if(this.maxSp<0)throw new RangeError(`Rule '${this.ruleName}': The variable stack is empty, can't get the result'`);return this.name(0)}defines(){return this.maxSp<0?"":this.type+" "+Array.from({length:this.maxSp+1},(t,e)=>this.name(e)).join(", ")+";"}checkedIf(t,e,r){const n=this.sp;if(e(),r){const o=this.sp;if(this.sp=n,r(),o!==this.sp)throw new Error("Rule '"+this.ruleName+"', position "+t+": Branches of a condition can't move the stack pointer differently (before: "+n+", after then: "+o+", after else: "+this.sp+").")}}checkedLoop(t,e){const r=this.sp;if(e(),r!==this.sp)throw new Error("Rule '"+this.ruleName+"', position "+t+": Body of a loop can't move the stack pointer (before: "+r+", after: "+this.sp+").")}},_$version_74="2.0.1",_$utils_69={};function hex(t){return t.charCodeAt(0).toString(16).toUpperCase()}_$utils_69.hex=hex,_$utils_69.stringEscape=function(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\v/g,"\\v").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,e=>"\\x0"+hex(e)).replace(/[\x10-\x1F\x7F-\xFF]/g,e=>"\\x"+hex(e)).replace(/[\u0100-\u0FFF]/g,e=>"\\u0"+hex(e)).replace(/[\u1000-\uFFFF]/g,e=>"\\u"+hex(e))},_$utils_69.regexpClassEscape=function(t){return t.replace(/\\/g,"\\\\").replace(/\//g,"\\/").replace(/]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\v/g,"\\v").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,e=>"\\x0"+hex(e)).replace(/[\x10-\x1F\x7F-\xFF]/g,e=>"\\x"+hex(e)).replace(/[\u0100-\u0FFF]/g,e=>"\\u0"+hex(e)).replace(/[\u1000-\uFFFF]/g,e=>"\\u"+hex(e))};var _$base64_77={};const intToCharMap="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");_$base64_77.encode=function(t){if(0<=t&&t<intToCharMap.length)return intToCharMap[t];throw new TypeError("Must be between 0 and 63: "+t)};var _$base64Vlq_76={encode:function(t){let e,r="",n=function(o){return o<0?1+(-o<<1):0+(o<<1)}(t);do e=31&n,(n>>>=5)>0&&(e|=32),r+=_$base64_77.encode(e);while(n>0);return r}},_$util_81={getArg:function(t,e,r){if(e in t)return t[e];if(arguments.length===3)return r;throw new Error('"'+e+'" is a required argument.')}};const supportsNullProto=!("__proto__"in Object.create(null));function identity(t){return t}function isProtoString(t){if(!t)return!1;const e=t.length;if(e<9||t.charCodeAt(e-1)!==95||t.charCodeAt(e-2)!==95||t.charCodeAt(e-3)!==111||t.charCodeAt(e-4)!==116||t.charCodeAt(e-5)!==111||t.charCodeAt(e-6)!==114||t.charCodeAt(e-7)!==112||t.charCodeAt(e-8)!==95||t.charCodeAt(e-9)!==95)return!1;for(let r=e-10;r>=0;r--)if(t.charCodeAt(r)!==36)return!1;return!0}function strcmp(t,e){return t===e?0:t===null?1:e===null?-1:t>e?1:-1}_$util_81.toSetString=supportsNullProto?identity:function(t){return isProtoString(t)?"$"+t:t},_$util_81.fromSetString=supportsNullProto?identity:function(t){return isProtoString(t)?t.slice(1):t},_$util_81.compareByGeneratedPositionsInflated=function(t,e){let r=t.generatedLine-e.generatedLine;return r!==0||(r=t.generatedColumn-e.generatedColumn)!=0||(r=strcmp(t.source,e.source))!==0||(r=t.originalLine-e.originalLine)!=0||(r=t.originalColumn-e.originalColumn)!=0?r:strcmp(t.name,e.name)};const PROTOCOL="http:",PROTOCOL_AND_HOST=PROTOCOL+"//host";function createSafeHandler(t){return e=>{const r=getURLType(e),n=buildSafeBase(e),o=new URL(e,n);t(o);const f=o.toString();return r==="absolute"?f:r==="scheme-relative"?f.slice(PROTOCOL.length):r==="path-absolute"?f.slice(PROTOCOL_AND_HOST.length):computeRelativeURL(n,f)}}function withBase(t,e){return new URL(t,e).toString()}function buildSafeBase(t){const e=t.split("..").length-1,r=function(o,f){let d=0;for(;;){const h="p"+d++;if(f.indexOf(h)===-1)return h}}(0,t);let n=PROTOCOL_AND_HOST+"/";for(let o=0;o<e;o++)n+=r+"/";return n}const ABSOLUTE_SCHEME=/^[A-Za-z0-9\+\-\.]+:/;function getURLType(t){return t[0]==="/"?t[1]==="/"?"scheme-relative":"path-absolute":ABSOLUTE_SCHEME.test(t)?"absolute":"path-relative"}function computeRelativeURL(t,e){typeof t=="string"&&(t=new URL(t)),typeof e=="string"&&(e=new URL(e));const r=e.pathname.split("/"),n=t.pathname.split("/");for(n.length>0&&!n[n.length-1]&&n.pop();r.length>0&&n.length>0&&r[0]===n[0];)r.shift(),n.shift();return n.map(()=>"..").concat(r).join("/")+e.search+e.hash}const ensureDirectory=createSafeHandler(t=>{t.pathname=t.pathname.replace(/\/?$/,"/")}),normalize=createSafeHandler(t=>{});_$util_81.normalize=normalize,_$util_81.join=function(t,e){const r=getURLType(e),n=getURLType(t);if(t=ensureDirectory(t),r==="absolute")return withBase(e,void 0);if(n==="absolute")return withBase(e,t);if(r==="scheme-relative")return normalize(e);if(n==="scheme-relative")return withBase(e,withBase(t,PROTOCOL_AND_HOST)).slice(PROTOCOL.length);if(r==="path-absolute")return normalize(e);if(n==="path-absolute")return withBase(e,withBase(t,PROTOCOL_AND_HOST)).slice(PROTOCOL_AND_HOST.length);const o=buildSafeBase(e+t);return computeRelativeURL(o,withBase(e,withBase(t,o)))},_$util_81.relative=function(t,e){const r=function(n,o){if(getURLType(n)!==getURLType(o))return null;const f=buildSafeBase(n+o),d=new URL(n,f),h=new URL(o,f);try{new URL("",h.toString())}catch{return null}return h.protocol!==d.protocol||h.user!==d.user||h.password!==d.password||h.hostname!==d.hostname||h.port!==d.port?null:computeRelativeURL(d,h)}(t,e);return typeof r=="string"?r:normalize(e)};var _$arraySet_75={};class ArraySet{constructor(){this._array=[],this._set=new Map}static fromArray(e,r){const n=new ArraySet;for(let o=0,f=e.length;o<f;o++)n.add(e[o],r);return n}size(){return this._set.size}add(e,r){const n=this.has(e),o=this._array.length;n&&!r||this._array.push(e),n||this._set.set(e,o)}has(e){return this._set.has(e)}indexOf(e){const r=this._set.get(e);if(r>=0)return r;throw new Error('"'+e+'" is not in the set.')}at(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)}toArray(){return this._array.slice()}}_$arraySet_75.ArraySet=ArraySet;var _$mappingList_78={MappingList:class{constructor(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}unsortedForEach(t,e){this._array.forEach(t,e)}add(t){(function(e,r){const n=e.generatedLine,o=r.generatedLine,f=e.generatedColumn,d=r.generatedColumn;return o>n||o==n&&d>=f||_$util_81.compareByGeneratedPositionsInflated(e,r)<=0})(this._last,t)?(this._last=t,this._array.push(t)):(this._sorted=!1,this._array.push(t))}toArray(){return this._sorted||(this._array.sort(_$util_81.compareByGeneratedPositionsInflated),this._sorted=!0),this._array}}},_$sourceMapGenerator_79={};const __ArraySet_79=_$arraySet_75.ArraySet,MappingList=_$mappingList_78.MappingList;class SourceMapGenerator{constructor(e){e||(e={}),this._file=_$util_81.getArg(e,"file",null),this._sourceRoot=_$util_81.getArg(e,"sourceRoot",null),this._skipValidation=_$util_81.getArg(e,"skipValidation",!1),this._sources=new __ArraySet_79,this._names=new __ArraySet_79,this._mappings=new MappingList,this._sourcesContents=null}static fromSourceMap(e){const r=e.sourceRoot,n=new SourceMapGenerator({file:e.file,sourceRoot:r});return e.eachMapping(function(o){const f={generated:{line:o.generatedLine,column:o.generatedColumn}};o.source!=null&&(f.source=o.source,r!=null&&(f.source=_$util_81.relative(r,f.source)),f.original={line:o.originalLine,column:o.originalColumn},o.name!=null&&(f.name=o.name)),n.addMapping(f)}),e.sources.forEach(function(o){let f=o;r!=null&&(f=_$util_81.relative(r,o)),n._sources.has(f)||n._sources.add(f);const d=e.sourceContentFor(o);d!=null&&n.setSourceContent(o,d)}),n}addMapping(e){const r=_$util_81.getArg(e,"generated"),n=_$util_81.getArg(e,"original",null);let o=_$util_81.getArg(e,"source",null),f=_$util_81.getArg(e,"name",null);this._skipValidation||this._validateMapping(r,n,o,f),o!=null&&(o=String(o),this._sources.has(o)||this._sources.add(o)),f!=null&&(f=String(f),this._names.has(f)||this._names.add(f)),this._mappings.add({generatedLine:r.line,generatedColumn:r.column,originalLine:n&&n.line,originalColumn:n&&n.column,source:o,name:f})}setSourceContent(e,r){let n=e;this._sourceRoot!=null&&(n=_$util_81.relative(this._sourceRoot,n)),r!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[_$util_81.toSetString(n)]=r):this._sourcesContents&&(delete this._sourcesContents[_$util_81.toSetString(n)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))}applySourceMap(e,r,n){let o=r;if(r==null){if(e.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);o=e.file}const f=this._sourceRoot;f!=null&&(o=_$util_81.relative(f,o));const d=this._mappings.toArray().length>0?new __ArraySet_79:this._sources,h=new __ArraySet_79;this._mappings.unsortedForEach(function(y){if(y.source===o&&y.originalLine!=null){const D=e.originalPositionFor({line:y.originalLine,column:y.originalColumn});D.source!=null&&(y.source=D.source,n!=null&&(y.source=_$util_81.join(n,y.source)),f!=null&&(y.source=_$util_81.relative(f,y.source)),y.originalLine=D.line,y.originalColumn=D.column,D.name!=null&&(y.name=D.name))}const k=y.source;k==null||d.has(k)||d.add(k);const A=y.name;A==null||h.has(A)||h.add(A)},this),this._sources=d,this._names=h,e.sources.forEach(function(y){const k=e.sourceContentFor(y);k!=null&&(n!=null&&(y=_$util_81.join(n,y)),f!=null&&(y=_$util_81.relative(f,y)),this.setSourceContent(y,k))},this)}_validateMapping(e,r,n,o){if(r&&typeof r.line!="number"&&typeof r.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!r&&!n&&!o)){if(!(e&&"line"in e&&"column"in e&&r&&"line"in r&&"column"in r&&e.line>0&&e.column>=0&&r.line>0&&r.column>=0&&n))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:n,original:r,name:o}))}}_serializeMappings(){let e,r,n,o,f=0,d=1,h=0,y=0,k=0,A=0,D="";const q=this._mappings.toArray();for(let H=0,z=q.length;H<z;H++){if(e="",(r=q[H]).generatedLine!==d)for(f=0;r.generatedLine!==d;)e+=";",d++;else if(H>0){if(!_$util_81.compareByGeneratedPositionsInflated(r,q[H-1]))continue;e+=","}e+=_$base64Vlq_76.encode(r.generatedColumn-f),f=r.generatedColumn,r.source!=null&&(o=this._sources.indexOf(r.source),e+=_$base64Vlq_76.encode(o-A),A=o,e+=_$base64Vlq_76.encode(r.originalLine-1-y),y=r.originalLine-1,e+=_$base64Vlq_76.encode(r.originalColumn-h),h=r.originalColumn,r.name!=null&&(n=this._names.indexOf(r.name),e+=_$base64Vlq_76.encode(n-k),k=n)),D+=e}return D}_generateSourcesContent(e,r){return e.map(function(n){if(!this._sourcesContents)return null;r!=null&&(n=_$util_81.relative(r,n));const o=_$util_81.toSetString(n);return Object.prototype.hasOwnProperty.call(this._sourcesContents,o)?this._sourcesContents[o]:null},this)}toJSON(){const e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(e.file=this._file),this._sourceRoot!=null&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e}toString(){return JSON.stringify(this.toJSON())}}SourceMapGenerator.prototype._version=3,_$sourceMapGenerator_79.SourceMapGenerator=SourceMapGenerator;var _$sourceNode_80={};const __SourceMapGenerator_80=_$sourceMapGenerator_79.SourceMapGenerator,REGEX_NEWLINE=/(\r?\n)/,NEWLINE_CODE=10,isSourceNode="$$$isSourceNode$$$";class SourceNode{constructor(e,r,n,o,f){this.children=[],this.sourceContents={},this.line=e??null,this.column=r??null,this.source=n??null,this.name=f??null,this[isSourceNode]=!0,o!=null&&this.add(o)}static fromStringWithSourceMap(e,r,n){const o=new SourceNode,f=e.split(REGEX_NEWLINE);let d=0;const h=function(){return H()+(H()||"");function H(){return d<f.length?f[d++]:void 0}};let y,k=1,A=0,D=null;return r.eachMapping(function(H){if(D!==null){if(!(k<H.generatedLine)){const z=(y=f[d]||"").substr(0,H.generatedColumn-A);return f[d]=y.substr(H.generatedColumn-A),A=H.generatedColumn,q(D,z),void(D=H)}q(D,h()),k++,A=0}for(;k<H.generatedLine;)o.add(h()),k++;A<H.generatedColumn&&(y=f[d]||"",o.add(y.substr(0,H.generatedColumn)),f[d]=y.substr(H.generatedColumn),A=H.generatedColumn),D=H},this),d<f.length&&(D&&q(D,h()),o.add(f.splice(d).join(""))),r.sources.forEach(function(H){const z=r.sourceContentFor(H);z!=null&&(n!=null&&(H=_$util_81.join(n,H)),o.setSourceContent(H,z))}),o;function q(H,z){if(H===null||H.source===void 0)o.add(z);else{const Z=n?_$util_81.join(n,H.source):H.source;o.add(new SourceNode(H.originalLine,H.originalColumn,Z,z,H.name))}}}add(e){if(Array.isArray(e))e.forEach(function(r){this.add(r)},this);else{if(!e[isSourceNode]&&typeof e!="string")throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);e&&this.children.push(e)}return this}prepend(e){if(Array.isArray(e))for(let r=e.length-1;r>=0;r--)this.prepend(e[r]);else{if(!e[isSourceNode]&&typeof e!="string")throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);this.children.unshift(e)}return this}walk(e){let r;for(let n=0,o=this.children.length;n<o;n++)(r=this.children[n])[isSourceNode]?r.walk(e):r!==""&&e(r,{source:this.source,line:this.line,column:this.column,name:this.name})}join(e){let r,n;const o=this.children.length;if(o>0){for(r=[],n=0;n<o-1;n++)r.push(this.children[n]),r.push(e);r.push(this.children[n]),this.children=r}return this}replaceRight(e,r){const n=this.children[this.children.length-1];return n[isSourceNode]?n.replaceRight(e,r):typeof n=="string"?this.children[this.children.length-1]=n.replace(e,r):this.children.push("".replace(e,r)),this}setSourceContent(e,r){this.sourceContents[_$util_81.toSetString(e)]=r}walkSourceContents(e){for(let n=0,o=this.children.length;n<o;n++)this.children[n][isSourceNode]&&this.children[n].walkSourceContents(e);const r=Object.keys(this.sourceContents);for(let n=0,o=r.length;n<o;n++)e(_$util_81.fromSetString(r[n]),this.sourceContents[r[n]])}toString(){let e="";return this.walk(function(r){e+=r}),e}toStringWithSourceMap(e){const r={code:"",line:1,column:0},n=new __SourceMapGenerator_80(e);let o=!1,f=null,d=null,h=null,y=null;return this.walk(function(k,A){r.code+=k,A.source!==null&&A.line!==null&&A.column!==null?(f===A.source&&d===A.line&&h===A.column&&y===A.name||n.addMapping({source:A.source,original:{line:A.line,column:A.column},generated:{line:r.line,column:r.column},name:A.name}),f=A.source,d=A.line,h=A.column,y=A.name,o=!0):o&&(n.addMapping({generated:{line:r.line,column:r.column}}),f=null,o=!1);for(let D=0,q=k.length;D<q;D++)k.charCodeAt(D)===NEWLINE_CODE?(r.line++,r.column=0,D+1===q?(f=null,o=!1):o&&n.addMapping({source:A.source,original:{line:A.line,column:A.column},generated:{line:r.line,column:r.column},name:A.name})):r.column++}),this.walkSourceContents(function(k,A){n.setSourceContent(k,A)}),{code:r.code,map:n}}}_$sourceNode_80.SourceNode=SourceNode;var _$sourceMap_82={};_$sourceMap_82.SourceMapGenerator=_$sourceMapGenerator_79.SourceMapGenerator,_$sourceMap_82.SourceNode=_$sourceNode_80.SourceNode;const{stringEscape,regexpClassEscape}=_$utils_69,{SourceNode:__SourceNode_58}=_$sourceMap_82;function toSourceNode(t,e,r){const n=e.start.line,o=e.start.column-1,f=t.split(`
`);return f.length===1?new __SourceNode_58(n,o,e.source,t,r):new __SourceNode_58(null,null,e.source,f.map((d,h)=>new __SourceNode_58(n+h,h===0?o:0,e.source,h===f.length-1?d:[d,`
`],r)))}function wrapInSourceNode(t,e,r,n,o){return r?new __SourceNode_58(null,null,r.source,[t,toSourceNode(e,r,o),new __SourceNode_58(r.end.line,r.end.column-1,r.source,n)]):new __SourceNode_58(null,null,null,[t,e,n])}var _$generateJs_58=function(t,e){function r(k){return k instanceof __SourceNode_58?k:k.replace(/^(.+)$/gm,"  $1")}function n(k){return"peg$c"+k}function o(k){return"peg$r"+k}function f(k){return"peg$e"+k}function d(k){return"peg$f"+k}function h(k){return"peg$parse"+k}function y(k){return k.codeLocation?toSourceNode(k.code,k.codeLocation,"$"+k.type):k.code}t.code=function(k){function A(){return[`// Generated by Peggy ${_$version_74}.`,"//","// https://peggyjs.org/"]}function D(){return e.trace?["{","  SyntaxError: peg$SyntaxError,","  DefaultTracer: peg$DefaultTracer,","  parse: peg$parse","}"].join(`
`):["{","  SyntaxError: peg$SyntaxError,","  parse: peg$parse","}"].join(`
`)}const q={bare:()=>[...A(),"(function() {",'  "use strict";',"",k,"",r("return "+D()+";"),"})()"],commonjs(){const H=Object.keys(e.dependencies),z=A();return z.push("",'"use strict";',""),H.length>0&&(H.forEach(Z=>{z.push("var "+Z+' = require("'+stringEscape(e.dependencies[Z])+'");')}),z.push("")),z.push(k,"","module.exports = "+D()+";"),z},es(){const H=Object.keys(e.dependencies),z=A();return z.push(""),H.length>0&&(H.forEach(Z=>{z.push("import "+Z+' from "'+stringEscape(e.dependencies[Z])+'";')}),z.push("")),z.push(k,"","export {","  peg$SyntaxError as SyntaxError,",e.trace?"  peg$DefaultTracer as DefaultTracer,":"","  peg$parse as parse","};"),z},amd(){const H=Object.keys(e.dependencies),z="["+H.map(j=>e.dependencies[j]).map(j=>'"'+stringEscape(j)+'"').join(", ")+"]",Z=H.join(", ");return[...A(),"define("+z+", function("+Z+") {",'  "use strict";',"",k,"",r("return "+D()+";"),"});"]},globals:()=>[...A(),"(function(root) {",'  "use strict";',"",k,"",r("root."+e.exportVar+" = "+D()+";"),"})(this);"],umd(){const H=Object.keys(e.dependencies),z=H.map(ot=>e.dependencies[ot]),Z="["+z.map(ot=>'"'+stringEscape(ot)+'"').join(", ")+"]",j=z.map(ot=>'require("'+stringEscape(ot)+'")').join(", "),at=H.join(", "),ct=A();return ct.push("(function(root, factory) {",'  if (typeof define === "function" && define.amd) {',"    define("+Z+", factory);",'  } else if (typeof module === "object" && module.exports) {',"    module.exports = factory("+j+");"),e.exportVar!==null&&ct.push("  } else {","    root."+e.exportVar+" = factory();"),ct.push("  }","})(this, function("+at+") {",'  "use strict";',"",k,"",r("return "+D()+";"),"});"),ct}}[e.format]();return new __SourceNode_58(null,null,e.grammarSource,q.map(H=>H instanceof __SourceNode_58?H:H+`
`))}(function(){const k=[];t.topLevelInitializer&&(k.push(y(t.topLevelInitializer)),k.push("")),k.push("function peg$subclass(child, parent) {","  function C() { this.constructor = child; }","  C.prototype = parent.prototype;","  child.prototype = new C();","}","","function peg$SyntaxError(message, expected, found, location) {","  var self = Error.call(this, message);","  // istanbul ignore next Check is a necessary evil to support older environments","  if (Object.setPrototypeOf) {","    Object.setPrototypeOf(self, peg$SyntaxError.prototype);","  }","  self.expected = expected;","  self.found = found;","  self.location = location;",'  self.name = "SyntaxError";',"  return self;","}","","peg$subclass(peg$SyntaxError, Error);","","function peg$padEnd(str, targetLength, padString) {",'  padString = padString || " ";',"  if (str.length > targetLength) { return str; }","  targetLength -= str.length;","  padString += padString.repeat(targetLength);","  return str + padString.slice(0, targetLength);","}","","peg$SyntaxError.prototype.format = function(sources) {",'  var str = "Error: " + this.message;',"  if (this.location) {","    var src = null;","    var k;","    for (k = 0; k < sources.length; k++) {","      if (sources[k].source === this.location.source) {","        src = sources[k].text.split(/\\r\\n|\\n|\\r/g);","        break;","      }","    }","    var s = this.location.start;",'    var loc = this.location.source + ":" + s.line + ":" + s.column;',"    if (src) {","      var e = this.location.end;",`      var filler = peg$padEnd("", s.line.toString().length, ' ');`,"      var line = src[s.line - 1];","      var last = s.line === e.line ? e.column : line.length + 1;","      var hatLen = (last - s.column) || 1;",'      str += "\\n --> " + loc + "\\n"','          + filler + " |\\n"','          + s.line + " | " + line + "\\n"',`          + filler + " | " + peg$padEnd("", s.column - 1, ' ')`,'          + peg$padEnd("", hatLen, "^");',"    } else {",'      str += "\\n at " + loc;',"    }","  }","  return str;","};","","peg$SyntaxError.buildMessage = function(expected, found) {","  var DESCRIBE_EXPECTATION_FNS = {","    literal: function(expectation) {",'      return "\\"" + literalEscape(expectation.text) + "\\"";',"    },","","    class: function(expectation) {","      var escapedParts = expectation.parts.map(function(part) {","        return Array.isArray(part)",'          ? classEscape(part[0]) + "-" + classEscape(part[1])',"          : classEscape(part);","      });","",'      return "[" + (expectation.inverted ? "^" : "") + escapedParts.join("") + "]";',"    },","","    any: function() {",'      return "any character";',"    },","","    end: function() {",'      return "end of input";',"    },","","    other: function(expectation) {","      return expectation.description;","    }","  };","","  function hex(ch) {","    return ch.charCodeAt(0).toString(16).toUpperCase();","  }","","  function literalEscape(s) {","    return s",'      .replace(/\\\\/g, "\\\\\\\\")','      .replace(/"/g,  "\\\\\\"")','      .replace(/\\0/g, "\\\\0")','      .replace(/\\t/g, "\\\\t")','      .replace(/\\n/g, "\\\\n")','      .replace(/\\r/g, "\\\\r")','      .replace(/[\\x00-\\x0F]/g,          function(ch) { return "\\\\x0" + hex(ch); })','      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return "\\\\x"  + hex(ch); });',"  }","","  function classEscape(s) {","    return s",'      .replace(/\\\\/g, "\\\\\\\\")','      .replace(/\\]/g, "\\\\]")','      .replace(/\\^/g, "\\\\^")','      .replace(/-/g,  "\\\\-")','      .replace(/\\0/g, "\\\\0")','      .replace(/\\t/g, "\\\\t")','      .replace(/\\n/g, "\\\\n")','      .replace(/\\r/g, "\\\\r")','      .replace(/[\\x00-\\x0F]/g,          function(ch) { return "\\\\x0" + hex(ch); })','      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return "\\\\x"  + hex(ch); });',"  }","","  function describeExpectation(expectation) {","    return DESCRIBE_EXPECTATION_FNS[expectation.type](expectation);","  }","","  function describeExpected(expected) {","    var descriptions = expected.map(describeExpectation);","    var i, j;","","    descriptions.sort();","","    if (descriptions.length > 0) {","      for (i = 1, j = 1; i < descriptions.length; i++) {","        if (descriptions[i - 1] !== descriptions[i]) {","          descriptions[j] = descriptions[i];","          j++;","        }","      }","      descriptions.length = j;","    }","","    switch (descriptions.length) {","      case 1:","        return descriptions[0];","","      case 2:",'        return descriptions[0] + " or " + descriptions[1];',"","      default:",'        return descriptions.slice(0, -1).join(", ")','          + ", or "',"          + descriptions[descriptions.length - 1];","    }","  }","","  function describeFound(found) {",'    return found ? "\\"" + literalEscape(found) + "\\"" : "end of input";',"  }","",'  return "Expected " + describeExpected(expected) + " but " + describeFound(found) + " found.";',"};",""),e.trace&&k.push("function peg$DefaultTracer() {","  this.indentLevel = 0;","}","","peg$DefaultTracer.prototype.trace = function(event) {","  var that = this;","","  function log(event) {","    function repeat(string, n) {",'       var result = "", i;',"","       for (i = 0; i < n; i++) {","         result += string;","       }","","       return result;","    }","","    function pad(string, length) {",'      return string + repeat(" ", length - string.length);',"    }","",'    if (typeof console === "object") {',"      console.log(",'        event.location.start.line + ":" + event.location.start.column + "-"','          + event.location.end.line + ":" + event.location.end.column + " "','          + pad(event.type, 10) + " "','          + repeat("  ", that.indentLevel) + event.rule',"      );","    }","  }","","  switch (event.type) {",'    case "rule.enter":',"      log(event);","      this.indentLevel++;","      break;","",'    case "rule.match":',"      this.indentLevel--;","      log(event);","      break;","",'    case "rule.fail":',"      this.indentLevel--;","      log(event);","      break;","","    default:",'      throw new Error("Invalid event type: " + event.type + ".");',"  }","};","");const A="{ "+e.allowedStartRules.map(q=>q+": "+h(q)).join(", ")+" }",D=h(e.allowedStartRules[0]);return k.push("function peg$parse(input, options) {","  options = options !== undefined ? options : {};","","  var peg$FAILED = {};","  var peg$source = options.grammarSource;","","  var peg$startRuleFunctions = "+A+";","  var peg$startRuleFunction = "+D+";","",new __SourceNode_58(null,null,e.grammarSource,[t.literals.map((q,H)=>"  var "+n(H)+' = "'+stringEscape(q)+'";').concat("",t.classes.map((q,H)=>{return"  var "+o(H)+" = /^["+((z=q).inverted?"^":"")+z.value.map(Z=>Array.isArray(Z)?regexpClassEscape(Z[0])+"-"+regexpClassEscape(Z[1]):regexpClassEscape(Z)).join("")+"]/"+(z.ignoreCase?"i":"")+";";var z})).concat("",t.expectations.map((q,H)=>"  var "+f(H)+" = "+function(z){switch(z.type){case"rule":return'peg$otherExpectation("'+stringEscape(z.value)+'")';case"literal":return'peg$literalExpectation("'+stringEscape(z.value)+'", '+z.ignoreCase+")";case"class":return"peg$classExpectation(["+z.value.map(Z=>Array.isArray(Z)?'["'+stringEscape(Z[0])+'", "'+stringEscape(Z[1])+'"]':'"'+stringEscape(Z)+'"').join(", ")+"], "+z.inverted+", "+z.ignoreCase+")";case"any":return"peg$anyExpectation()";default:throw new Error("Unknown expectation type ("+JSON.stringify(z)+")")}}(q)+";")).concat("").join(`
`),t.functions.map(function(q,H){return wrapInSourceNode(`
  var ${d(H)} = function(${q.params.join(", ")}) {`,q.body,q.location,"};")})]),"","  var peg$currPos = 0;","  var peg$savedPos = 0;","  var peg$posDetailsCache = [{ line: 1, column: 1 }];","  var peg$maxFailPos = 0;","  var peg$maxFailExpected = [];","  var peg$silentFails = 0;",""),e.cache&&k.push("  var peg$resultsCache = {};",""),e.trace&&k.push('  var peg$tracer = "tracer" in options ? options.tracer : new peg$DefaultTracer();',""),k.push("  var peg$result;","",'  if ("startRule" in options) {',"    if (!(options.startRule in peg$startRuleFunctions)) {",`      throw new Error("Can't start parsing from rule \\"" + options.startRule + "\\".");`,"    }","","    peg$startRuleFunction = peg$startRuleFunctions[options.startRule];","  }","","  function text() {","    return input.substring(peg$savedPos, peg$currPos);","  }","","  function offset() {","    return peg$savedPos;","  }","","  function range() {","    return {","      source: peg$source,","      start: peg$savedPos,","      end: peg$currPos","    };","  }","","  function location() {","    return peg$computeLocation(peg$savedPos, peg$currPos);","  }","","  function expected(description, location) {","    location = location !== undefined","      ? location","      : peg$computeLocation(peg$savedPos, peg$currPos);","","    throw peg$buildStructuredError(","      [peg$otherExpectation(description)],","      input.substring(peg$savedPos, peg$currPos),","      location","    );","  }","","  function error(message, location) {","    location = location !== undefined","      ? location","      : peg$computeLocation(peg$savedPos, peg$currPos);","","    throw peg$buildSimpleError(message, location);","  }","","  function peg$literalExpectation(text, ignoreCase) {",'    return { type: "literal", text: text, ignoreCase: ignoreCase };',"  }","","  function peg$classExpectation(parts, inverted, ignoreCase) {",'    return { type: "class", parts: parts, inverted: inverted, ignoreCase: ignoreCase };',"  }","","  function peg$anyExpectation() {",'    return { type: "any" };',"  }","","  function peg$endExpectation() {",'    return { type: "end" };',"  }","","  function peg$otherExpectation(description) {",'    return { type: "other", description: description };',"  }","","  function peg$computePosDetails(pos) {","    var details = peg$posDetailsCache[pos];","    var p;","","    if (details) {","      return details;","    } else {","      p = pos - 1;","      while (!peg$posDetailsCache[p]) {","        p--;","      }","","      details = peg$posDetailsCache[p];","      details = {","        line: details.line,","        column: details.column","      };","","      while (p < pos) {","        if (input.charCodeAt(p) === 10) {","          details.line++;","          details.column = 1;","        } else {","          details.column++;","        }","","        p++;","      }","","      peg$posDetailsCache[pos] = details;","","      return details;","    }","  }","","  function peg$computeLocation(startPos, endPos) {","    var startPosDetails = peg$computePosDetails(startPos);","    var endPosDetails = peg$computePosDetails(endPos);","","    return {","      source: peg$source,","      start: {","        offset: startPos,","        line: startPosDetails.line,","        column: startPosDetails.column","      },","      end: {","        offset: endPos,","        line: endPosDetails.line,","        column: endPosDetails.column","      }","    };","  }","","  function peg$fail(expected) {","    if (peg$currPos < peg$maxFailPos) { return; }","","    if (peg$currPos > peg$maxFailPos) {","      peg$maxFailPos = peg$currPos;","      peg$maxFailExpected = [];","    }","","    peg$maxFailExpected.push(expected);","  }","","  function peg$buildSimpleError(message, location) {","    return new peg$SyntaxError(message, null, null, location);","  }","","  function peg$buildStructuredError(expected, found, location) {","    return new peg$SyntaxError(","      peg$SyntaxError.buildMessage(expected, found),","      expected,","      found,","      location","    );","  }",""),t.rules.forEach(q=>{k.push(...function(H){const z=[],Z=new _$stack_68(H.name,"s","var"),j=function at(ct){let ot=0;const tt=ct.length,gt=[];let wt;function ft(l,s){const b=s+3,$=ct[ot+b-2],E=ct[ot+b-1];let rt,_t;Z.checkedIf(ot,()=>{ot+=b,rt=at(ct.slice(ot,ot+$)),ot+=$},E>0?()=>{_t=at(ct.slice(ot,ot+E)),ot+=E}:null),gt.push("if ("+l+") {"),gt.push(...rt.map(r)),E>0&&(gt.push("} else {"),gt.push(..._t.map(r))),gt.push("}")}function yt(l){const s=ct[ot+2-1];let b;Z.checkedLoop(ot,()=>{ot+=2,b=at(ct.slice(ot,ot+s)),ot+=s}),gt.push("while ("+l+") {"),gt.push(...b.map(r)),gt.push("}")}function Ct(){const l=ct[ot+4-1],s=d(ct[ot+1])+"("+ct.slice(ot+4,ot+4+l).map(b=>Z.index(b)).join(", ")+")";Z.pop(ct[ot+2]),gt.push(Z.push(s)),ot+=4+l}for(;ot<tt;)switch(ct[ot]){case _$opcodes_56.PUSH_EMPTY_STRING:gt.push(Z.push("''")),ot++;break;case _$opcodes_56.PUSH_CURR_POS:gt.push(Z.push("peg$currPos")),ot++;break;case _$opcodes_56.PUSH_UNDEFINED:gt.push(Z.push("undefined")),ot++;break;case _$opcodes_56.PUSH_NULL:gt.push(Z.push("null")),ot++;break;case _$opcodes_56.PUSH_FAILED:gt.push(Z.push("peg$FAILED")),ot++;break;case _$opcodes_56.PUSH_EMPTY_ARRAY:gt.push(Z.push("[]")),ot++;break;case _$opcodes_56.POP:Z.pop(),ot++;break;case _$opcodes_56.POP_CURR_POS:gt.push("peg$currPos = "+Z.pop()+";"),ot++;break;case _$opcodes_56.POP_N:Z.pop(ct[ot+1]),ot+=2;break;case _$opcodes_56.NIP:wt=Z.pop(),Z.pop(),gt.push(Z.push(wt)),ot++;break;case _$opcodes_56.APPEND:wt=Z.pop(),gt.push(Z.top()+".push("+wt+");"),ot++;break;case _$opcodes_56.WRAP:gt.push(Z.push("["+Z.pop(ct[ot+1]).join(", ")+"]")),ot+=2;break;case _$opcodes_56.TEXT:gt.push(Z.push("input.substring("+Z.pop()+", peg$currPos)")),ot++;break;case _$opcodes_56.PLUCK:{const s=ct[ot+3-1],b=3+s;wt=ct.slice(ot+3,ot+b),wt=s===1?Z.index(wt[0]):`[ ${wt.map($=>Z.index($)).join(", ")} ]`,Z.pop(ct[ot+1]),gt.push(Z.push(wt)),ot+=b;break}case _$opcodes_56.IF:ft(Z.top(),0);break;case _$opcodes_56.IF_ERROR:ft(Z.top()+" === peg$FAILED",0);break;case _$opcodes_56.IF_NOT_ERROR:ft(Z.top()+" !== peg$FAILED",0);break;case _$opcodes_56.WHILE_NOT_ERROR:yt(Z.top()+" !== peg$FAILED");break;case _$opcodes_56.MATCH_ANY:ft("input.length > peg$currPos",0);break;case _$opcodes_56.MATCH_STRING:ft(t.literals[ct[ot+1]].length>1?"input.substr(peg$currPos, "+t.literals[ct[ot+1]].length+") === "+n(ct[ot+1]):"input.charCodeAt(peg$currPos) === "+t.literals[ct[ot+1]].charCodeAt(0),1);break;case _$opcodes_56.MATCH_STRING_IC:ft("input.substr(peg$currPos, "+t.literals[ct[ot+1]].length+").toLowerCase() === "+n(ct[ot+1]),1);break;case _$opcodes_56.MATCH_CHAR_CLASS:ft(o(ct[ot+1])+".test(input.charAt(peg$currPos))",1);break;case _$opcodes_56.ACCEPT_N:gt.push(Z.push(ct[ot+1]>1?"input.substr(peg$currPos, "+ct[ot+1]+")":"input.charAt(peg$currPos)")),gt.push(ct[ot+1]>1?"peg$currPos += "+ct[ot+1]+";":"peg$currPos++;"),ot+=2;break;case _$opcodes_56.ACCEPT_STRING:gt.push(Z.push(n(ct[ot+1]))),gt.push(t.literals[ct[ot+1]].length>1?"peg$currPos += "+t.literals[ct[ot+1]].length+";":"peg$currPos++;"),ot+=2;break;case _$opcodes_56.FAIL:gt.push(Z.push("peg$FAILED")),gt.push("if (peg$silentFails === 0) { peg$fail("+f(ct[ot+1])+"); }"),ot+=2;break;case _$opcodes_56.LOAD_SAVED_POS:gt.push("peg$savedPos = "+Z.index(ct[ot+1])+";"),ot+=2;break;case _$opcodes_56.UPDATE_SAVED_POS:gt.push("peg$savedPos = peg$currPos;"),ot++;break;case _$opcodes_56.CALL:Ct();break;case _$opcodes_56.RULE:gt.push(Z.push(h(t.rules[ct[ot+1]].name)+"()")),ot+=2;break;case _$opcodes_56.SILENT_FAILS_ON:gt.push("peg$silentFails++;"),ot++;break;case _$opcodes_56.SILENT_FAILS_OFF:gt.push("peg$silentFails--;"),ot++;break;default:throw new Error("Invalid opcode: "+ct[ot]+".")}return gt}(H.bytecode);return z.push(wrapInSourceNode("  function ",h(H.name),H.nameLocation,`() {
`,H.name)),e.trace&&z.push("  var startPos = peg$currPos;"),z.push(r(Z.defines())),z.push(...function(at,ct){const ot=[];return ot.push(""),e.trace&&ot.push("peg$tracer.trace({",'  type: "rule.enter",',"  rule: "+at+",","  location: peg$computeLocation(startPos, startPos)","});",""),e.cache&&(ot.push("var key = peg$currPos * "+t.rules.length+" + "+ct+";","var cached = peg$resultsCache[key];","","if (cached) {","  peg$currPos = cached.nextPos;",""),e.trace&&ot.push("if (cached.result !== peg$FAILED) {","  peg$tracer.trace({",'    type: "rule.match",',"    rule: "+at+",","    result: cached.result,","    location: peg$computeLocation(startPos, peg$currPos)","  });","} else {","  peg$tracer.trace({",'    type: "rule.fail",',"    rule: "+at+",","    location: peg$computeLocation(startPos, startPos)","  });","}",""),ot.push("  return cached.result;","}","")),ot}('"'+stringEscape(H.name)+'"',_$asts_54.indexOfRule(t,H.name)).map(r)),z.push(...j.map(r)),z.push(...function(at,ct){const ot=[];return e.cache&&ot.push("","peg$resultsCache[key] = { nextPos: peg$currPos, result: "+ct+" };"),e.trace&&ot.push("","if ("+ct+" !== peg$FAILED) {","  peg$tracer.trace({",'    type: "rule.match",',"    rule: "+at+",","    result: "+ct+",","    location: peg$computeLocation(startPos, peg$currPos)","  });","} else {","  peg$tracer.trace({",'    type: "rule.fail",',"    rule: "+at+",","    location: peg$computeLocation(startPos, startPos)","  });","}"),ot.push("","return "+ct+";"),ot}('"'+stringEscape(H.name)+'"',Z.result()).map(r)),z.push("}"),z}(q).map(r)),k.push("")}),t.initializer&&(k.push(y(t.initializer)),k.push("")),k.push("  peg$result = peg$startRuleFunction();","","  if (peg$result !== peg$FAILED && peg$currPos === input.length) {","    return peg$result;","  } else {","    if (peg$result !== peg$FAILED && peg$currPos < input.length) {","      peg$fail(peg$endExpectation());","    }","","    throw peg$buildStructuredError(","      peg$maxFailExpected,","      peg$maxFailPos < input.length ? input.charAt(peg$maxFailPos) : null,","      peg$maxFailPos < input.length","        ? peg$computeLocation(peg$maxFailPos, peg$maxFailPos + 1)","        : peg$computeLocation(peg$maxFailPos, peg$maxFailPos)","    );","  }","}"),new __SourceNode_58(null,null,e.grammarSource,k.map(q=>q instanceof __SourceNode_58?q:q+`
`))}())},_$removeProxyRules_60=function(t,e,r){const n=[];t.rules.forEach((o,f)=>{var d;(d=o).type==="rule"&&d.expression.type==="rule_ref"&&(function(h,y,k){_$visitor_70.build({rule_ref(A){A.name===y&&(A.name=k,r.info(`Proxy rule "${y}" replaced by the rule "${k}"`,A.location,[{message:"This rule will be used",location:_$asts_54.findRule(h,k).nameLocation}]))}})(h)}(t,o.name,o.expression.name),e.allowedStartRules.indexOf(o.name)===-1&&n.push(f))}),n.reverse(),n.forEach(o=>{t.rules.splice(o,1)})},_$reportDuplicateLabels_61=function(t,e,r){function n(d){const h={};return Object.keys(d).forEach(y=>{h[y]=d[y]}),h}function o(d,h){f(d.expression,n(h))}const f=_$visitor_70.build({rule(d){f(d.expression,{})},choice(d,h){d.alternatives.forEach(y=>{f(y,n(h))})},action:o,labeled(d,h){const y=d.label;y&&Object.prototype.hasOwnProperty.call(h,y)&&r.error(`Label "${d.label}" is already defined`,d.labelLocation,[{message:"Original label location",location:h[y]}]),f(d.expression,h),h[d.label]=d.labelLocation},text:o,simple_and:o,simple_not:o,optional:o,zero_or_more:o,one_or_more:o,group:o});f(t)},_$reportDuplicateRules_62=function(t,e,r){const n={};_$visitor_70.build({rule(o){Object.prototype.hasOwnProperty.call(n,o.name)?r.error(`Rule "${o.name}" is already defined`,o.nameLocation,[{message:"Original rule location",location:n[o.name]}]):n[o.name]=o.nameLocation}})(t)},_$reportInfiniteRecursion_64=function(t,e,r){const n=[],o=[],f=_$visitor_70.build({rule(d){n.push(d.name),f(d.expression),n.pop()},sequence(d){d.elements.every(h=>(f(h),!_$asts_54.alwaysConsumesOnSuccess(t,h)))},rule_ref(d){o.push(d);const h=_$asts_54.findRule(t,d.name);if(n.indexOf(d.name)!==-1)return n.push(d.name),void r.error("Possible infinite loop when parsing (left recursion: "+n.join(" -> ")+")",h.nameLocation,o.map((y,k,A)=>({message:k+1!==A.length?`Step ${k+1}: call of the rule "${y.name}" without input consumption`:`Step ${k+1}: call itself without input consumption - left recursion`,location:y.location})));h&&f(h),o.pop()}});f(t)},_$reportInfiniteRepetition_65=function(t,e,r){_$visitor_70.build({zero_or_more(n){_$asts_54.alwaysConsumesOnSuccess(t,n.expression)||r.error("Possible infinite loop when parsing (repetition used with an expression that may not consume any input)",n.location)},one_or_more(n){_$asts_54.alwaysConsumesOnSuccess(t,n.expression)||r.error("Possible infinite loop when parsing (repetition used with an expression that may not consume any input)",n.location)}})(t)},_$reportUndefinedRules_66=function(t,e,r){_$visitor_70.build({rule_ref(n){_$asts_54.findRule(t,n.name)||r.error(`Rule "${n.name}" is not defined`,n.location)}})(t)},_$reportIncorrectPlucking_63=function(t,e,r){const n=_$visitor_70.build({action(o){n(o.expression,o)},labeled(o,f){o.pick&&f&&r.error('"@" cannot be used with an action block',o.labelLocation,[{message:"Action block location",location:f.codeLocation}]),n(o.expression)}});n(t)};class Defaults{constructor(e){typeof(e=e!==void 0?e:{}).error=="function"&&(this.error=e.error),typeof e.warning=="function"&&(this.warning=e.warning),typeof e.info=="function"&&(this.info=e.info)}error(){}warning(){}info(){}}var _$session_67=class{constructor(t){this._callbacks=new Defaults(t),this._firstError=null,this.errors=0,this.problems=[],this.stage=null}error(...t){++this.errors,this._firstError===null&&(this._firstError=new _$GrammarError_71(...t),this._firstError.stage=this.stage,this._firstError.problems=this.problems),this.problems.push(["error",...t]),this._callbacks.error(this.stage,...t)}warning(...t){this.problems.push(["warning",...t]),this._callbacks.warning(this.stage,...t)}info(...t){this.problems.push(["info",...t]),this._callbacks.info(this.stage,...t)}checkErrors(){if(this.errors!==0)throw this._firstError}};function processOptions(t,e){const r={};return Object.keys(t).forEach(n=>{r[n]=t[n]}),Object.keys(e).forEach(n=>{Object.prototype.hasOwnProperty.call(r,n)||(r[n]=e[n])}),r}const compiler={visitor:_$visitor_70,passes:{check:[_$reportUndefinedRules_66,_$reportDuplicateRules_62,_$reportDuplicateLabels_61,_$reportInfiniteRecursion_64,_$reportInfiniteRepetition_65,_$reportIncorrectPlucking_63],transform:[_$removeProxyRules_60,_$inferenceMatchResult_59],generate:[_$generateBytecode_57,_$generateJs_58]},compile(ast,passes,options){if(options=options!==void 0?options:{},options=processOptions(options,{allowedStartRules:[ast.rules[0].name],cache:!1,dependencies:{},exportVar:null,format:"bare",output:"parser",trace:!1}),!Array.isArray(options.allowedStartRules))throw new Error("allowedStartRules must be an array");if(options.allowedStartRules.length===0)throw new Error("Must have at least one start rule");const allRules=ast.rules.map(t=>t.name);for(const t of options.allowedStartRules)if(allRules.indexOf(t)===-1)throw new Error(`Unknown start rule "${t}"`);const session=new _$session_67(options);switch(Object.keys(passes).forEach(t=>{session.stage=t,session.info("Process stage "+t),passes[t].forEach(e=>{session.info(`Process pass ${t}.${e.name}`),e(ast,options,session)}),session.checkErrors()}),options.output){case"parser":return eval(ast.code.toString());case"source":return ast.code.toString();case"source-and-map":return ast.code;default:throw new Error("Invalid output format: "+options.output+".")}}};var _$compiler_55=compiler,_$parser_72={};const OPS_TO_PREFIXED_TYPES={$:"text","&":"simple_and","!":"simple_not"},OPS_TO_SUFFIXED_TYPES={"?":"optional","*":"zero_or_more","+":"one_or_more"},OPS_TO_SEMANTIC_PREDICATE_TYPES={"&":"semantic_and","!":"semantic_not"};function peg$SyntaxError(t,e,r,n){var o=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(o,peg$SyntaxError.prototype),o.expected=e,o.found=r,o.location=n,o.name="SyntaxError",o}function peg$padEnd(t,e,r){return r=r||" ",t.length>e?t:(e-=t.length,t+(r+=r.repeat(e)).slice(0,e))}(function(t,e){function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r})(peg$SyntaxError,Error),peg$SyntaxError.prototype.format=function(t){var e="Error: "+this.message;if(this.location){var r,n=null;for(r=0;r<t.length;r++)if(t[r].source===this.location.source){n=t[r].text.split(/\r\n|\n|\r/g);break}var o=this.location.start,f=this.location.source+":"+o.line+":"+o.column;if(n){var d=this.location.end,h=peg$padEnd("",o.line.toString().length," "),y=n[o.line-1],k=(o.line===d.line?d.column:y.length+1)-o.column||1;e+=`
 --> `+f+`
`+h+` |
`+o.line+" | "+y+`
`+h+" | "+peg$padEnd("",o.column-1," ")+peg$padEnd("",k,"^")}else e+=`
 at `+f}return e},peg$SyntaxError.buildMessage=function(t,e){var r={literal:function(h){return'"'+o(h.text)+'"'},class:function(h){var y=h.parts.map(function(k){return Array.isArray(k)?f(k[0])+"-"+f(k[1]):f(k)});return"["+(h.inverted?"^":"")+y.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(h){return h.description}};function n(h){return h.charCodeAt(0).toString(16).toUpperCase()}function o(h){return h.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(y){return"\\x0"+n(y)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(y){return"\\x"+n(y)})}function f(h){return h.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(y){return"\\x0"+n(y)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(y){return"\\x"+n(y)})}function d(h){return r[h.type](h)}return"Expected "+function(h){var y,k,A=h.map(d);if(A.sort(),A.length>0){for(y=1,k=1;y<A.length;y++)A[y-1]!==A[y]&&(A[k]=A[y],k++);A.length=k}switch(A.length){case 1:return A[0];case 2:return A[0]+" or "+A[1];default:return A.slice(0,-1).join(", ")+", or "+A[A.length-1]}}(t)+" but "+function(h){return h?'"'+o(h)+'"':"end of input"}(e)+" found."},_$parser_72={SyntaxError:peg$SyntaxError,parse:function(t,e){var r,n={},o=(e=e!==void 0?e:{}).grammarSource,f={Grammar:jn},d=jn,h=/^[\n\r\u2028\u2029]/,y=/^[0-9]/,k=/^[0-9a-f]/i,A=/^[{}]/,D=/^[a-z\xB5\xDF-\xF6\xF8-\xFF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137-\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148-\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C-\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA-\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9-\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC-\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF-\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F-\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0-\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB-\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE-\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0529\u052B\u052D\u052F\u0561-\u0587\u13F8-\u13FD\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6-\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FC7\u1FD0-\u1FD3\u1FD6-\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6-\u1FF7\u210A\u210E-\u210F\u2113\u212F\u2134\u2139\u213C-\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5E\u2C61\u2C65-\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73-\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3-\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA699\uA69B\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793-\uA795\uA797\uA799\uA79B\uA79D\uA79F\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7B5\uA7B7\uA7FA\uAB30-\uAB5A\uAB60-\uAB65\uAB70-\uABBF\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A]/,q=/^[\u02B0-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0374\u037A\u0559\u0640\u06E5-\u06E6\u07F4-\u07F5\u07FA\u081A\u0824\u0828\u0971\u0E46\u0EC6\u10FC\u17D7\u1843\u1AA7\u1C78-\u1C7D\u1D2C-\u1D6A\u1D78\u1D9B-\u1DBF\u2071\u207F\u2090-\u209C\u2C7C-\u2C7D\u2D6F\u2E2F\u3005\u3031-\u3035\u303B\u309D-\u309E\u30FC-\u30FE\uA015\uA4F8-\uA4FD\uA60C\uA67F\uA69C-\uA69D\uA717-\uA71F\uA770\uA788\uA7F8-\uA7F9\uA9CF\uA9E6\uAA70\uAADD\uAAF3-\uAAF4\uAB5C-\uAB5F\uFF70\uFF9E-\uFF9F]/,H=/^[\xAA\xBA\u01BB\u01C0-\u01C3\u0294\u05D0-\u05EA\u05F0-\u05F2\u0620-\u063F\u0641-\u064A\u066E-\u066F\u0671-\u06D3\u06D5\u06EE-\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u0800-\u0815\u0840-\u0858\u08A0-\u08B4\u0904-\u0939\u093D\u0950\u0958-\u0961\u0972-\u0980\u0985-\u098C\u098F-\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC-\u09DD\u09DF-\u09E1\u09F0-\u09F1\u0A05-\u0A0A\u0A0F-\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32-\u0A33\u0A35-\u0A36\u0A38-\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2-\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0-\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F-\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32-\u0B33\u0B35-\u0B39\u0B3D\u0B5C-\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99-\u0B9A\u0B9C\u0B9E-\u0B9F\u0BA3-\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60-\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0-\u0CE1\u0CF1-\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32-\u0E33\u0E40-\u0E45\u0E81-\u0E82\u0E84\u0E87-\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA-\u0EAB\u0EAD-\u0EB0\u0EB2-\u0EB3\u0EBD\u0EC0-\u0EC4\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065-\u1066\u106E-\u1070\u1075-\u1081\u108E\u10D0-\u10FA\u10FD-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17DC\u1820-\u1842\u1844-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE-\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C77\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5-\u1CF6\u2135-\u2138\u2D30-\u2D67\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3006\u303C\u3041-\u3096\u309F\u30A1-\u30FA\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA014\uA016-\uA48C\uA4D0-\uA4F7\uA500-\uA60B\uA610-\uA61F\uA62A-\uA62B\uA66E\uA6A0-\uA6E5\uA78F\uA7F7\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9E0-\uA9E4\uA9E7-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA6F\uAA71-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5-\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADC\uAAE0-\uAAEA\uAAF2\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF66-\uFF6F\uFF71-\uFF9D\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,z=/^[\u01C5\u01C8\u01CB\u01F2\u1F88-\u1F8F\u1F98-\u1F9F\u1FA8-\u1FAF\u1FBC\u1FCC\u1FFC]/,Z=/^[A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178-\u0179\u017B\u017D\u0181-\u0182\u0184\u0186-\u0187\u0189-\u018B\u018E-\u0191\u0193-\u0194\u0196-\u0198\u019C-\u019D\u019F-\u01A0\u01A2\u01A4\u01A6-\u01A7\u01A9\u01AC\u01AE-\u01AF\u01B1-\u01B3\u01B5\u01B7-\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A-\u023B\u023D-\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E-\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9-\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0-\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E-\u213F\u2145\u2183\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D-\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AD\uA7B0-\uA7B4\uA7B6\uFF21-\uFF3A]/,j=/^[\u0903\u093B\u093E-\u0940\u0949-\u094C\u094E-\u094F\u0982-\u0983\u09BE-\u09C0\u09C7-\u09C8\u09CB-\u09CC\u09D7\u0A03\u0A3E-\u0A40\u0A83\u0ABE-\u0AC0\u0AC9\u0ACB-\u0ACC\u0B02-\u0B03\u0B3E\u0B40\u0B47-\u0B48\u0B4B-\u0B4C\u0B57\u0BBE-\u0BBF\u0BC1-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCC\u0BD7\u0C01-\u0C03\u0C41-\u0C44\u0C82-\u0C83\u0CBE\u0CC0-\u0CC4\u0CC7-\u0CC8\u0CCA-\u0CCB\u0CD5-\u0CD6\u0D02-\u0D03\u0D3E-\u0D40\u0D46-\u0D48\u0D4A-\u0D4C\u0D57\u0D82-\u0D83\u0DCF-\u0DD1\u0DD8-\u0DDF\u0DF2-\u0DF3\u0F3E-\u0F3F\u0F7F\u102B-\u102C\u1031\u1038\u103B-\u103C\u1056-\u1057\u1062-\u1064\u1067-\u106D\u1083-\u1084\u1087-\u108C\u108F\u109A-\u109C\u17B6\u17BE-\u17C5\u17C7-\u17C8\u1923-\u1926\u1929-\u192B\u1930-\u1931\u1933-\u1938\u1A19-\u1A1A\u1A55\u1A57\u1A61\u1A63-\u1A64\u1A6D-\u1A72\u1B04\u1B35\u1B3B\u1B3D-\u1B41\u1B43-\u1B44\u1B82\u1BA1\u1BA6-\u1BA7\u1BAA\u1BE7\u1BEA-\u1BEC\u1BEE\u1BF2-\u1BF3\u1C24-\u1C2B\u1C34-\u1C35\u1CE1\u1CF2-\u1CF3\u302E-\u302F\uA823-\uA824\uA827\uA880-\uA881\uA8B4-\uA8C3\uA952-\uA953\uA983\uA9B4-\uA9B5\uA9BA-\uA9BB\uA9BD-\uA9C0\uAA2F-\uAA30\uAA33-\uAA34\uAA4D\uAA7B\uAA7D\uAAEB\uAAEE-\uAAEF\uAAF5\uABE3-\uABE4\uABE6-\uABE7\uABE9-\uABEA\uABEC]/,at=/^[\u0300-\u036F\u0483-\u0487\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962-\u0963\u0981\u09BC\u09C1-\u09C4\u09CD\u09E2-\u09E3\u0A01-\u0A02\u0A3C\u0A41-\u0A42\u0A47-\u0A48\u0A4B-\u0A4D\u0A51\u0A70-\u0A71\u0A75\u0A81-\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7-\u0AC8\u0ACD\u0AE2-\u0AE3\u0B01\u0B3C\u0B3F\u0B41-\u0B44\u0B4D\u0B56\u0B62-\u0B63\u0B82\u0BC0\u0BCD\u0C00\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55-\u0C56\u0C62-\u0C63\u0C81\u0CBC\u0CBF\u0CC6\u0CCC-\u0CCD\u0CE2-\u0CE3\u0D01\u0D41-\u0D44\u0D4D\u0D62-\u0D63\u0DCA\u0DD2-\u0DD4\u0DD6\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB-\u0EBC\u0EC8-\u0ECD\u0F18-\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86-\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039-\u103A\u103D-\u103E\u1058-\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085-\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752-\u1753\u1772-\u1773\u17B4-\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u1922\u1927-\u1928\u1932\u1939-\u193B\u1A17-\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ABD\u1B00-\u1B03\u1B34\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80-\u1B81\u1BA2-\u1BA5\u1BA8-\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8-\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8-\u1CF9\u1DC0-\u1DF5\u1DFC-\u1DFF\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302D\u3099-\u309A\uA66F\uA674-\uA67D\uA69E-\uA69F\uA6F0-\uA6F1\uA802\uA806\uA80B\uA825-\uA826\uA8C4\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9E5\uAA29-\uAA2E\uAA31-\uAA32\uAA35-\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7-\uAAB8\uAABE-\uAABF\uAAC1\uAAEC-\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/,ct=/^[0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19]/,ot=/^[\u16EE-\u16F0\u2160-\u2182\u2185-\u2188\u3007\u3021-\u3029\u3038-\u303A\uA6E6-\uA6EF]/,tt=/^[_\u203F-\u2040\u2054\uFE33-\uFE34\uFE4D-\uFE4F\uFF3F]/,gt=/^[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,wt=Ie("{",!1),ft=Ie("}",!1),yt=Ie("=",!1),Ct=Ie("/",!1),l=Ie("@",!1),s=Ie(":",!1),b=Ie("$",!1),$=Ie("&",!1),E=Ie("!",!1),rt=Ie("?",!1),_t=Ie("*",!1),xt=Ie("+",!1),St=Ie("(",!1),x=Ie(")",!1),N={type:"any"},V=Ue("whitespace"),S=Ie("	",!1),C=Ie("\v",!1),T=Ie("\f",!1),M=Ie(" ",!1),et=Ie("\xA0",!1),Pt=Ie("\uFEFF",!1),Ut=fr([`
`,"\r","\u2028","\u2029"],!1,!1),Zt=Ue("end of line"),_e=Ie(`
`,!1),me=Ie(`\r
`,!1),de=Ie("\r",!1),Xt=Ie("\u2028",!1),Gt=Ie("\u2029",!1),pe=Ue("comment"),ge=Ie("/*",!1),Dt=Ie("*/",!1),Nt=Ie("//",!1),ie=Ue("identifier"),ee=Ie("_",!1),Kt=Ie("\\",!1),be=Ie("\u200C",!1),v=Ie("\u200D",!1),Be=Ue("literal"),ce=Ie("i",!1),Vt=Ue("string"),ze=Ie('"',!1),We=Ie("'",!1),Je=Ue("character class"),nr=Ie("[",!1),lr=Ie("^",!1),ur=Ie("]",!1),Me=Ie("-",!1),Ke=Ie("0",!1),Ir=Ie("b",!1),Le=Ie("f",!1),qr=Ie("n",!1),hr=Ie("r",!1),Sr=Ie("t",!1),Jr=Ie("v",!1),Kr=Ie("x",!1),tr=Ie("u",!1),Xe=fr([["0","9"]],!1,!1),Qe=fr([["0","9"],["a","f"]],!1,!0),an=Ie(".",!1),Gr=Ue("code block"),Vr=fr(["{","}"],!1,!1),Yr=fr([["a","z"],"\xB5",["\xDF","\xF6"],["\xF8","\xFF"],"\u0101","\u0103","\u0105","\u0107","\u0109","\u010B","\u010D","\u010F","\u0111","\u0113","\u0115","\u0117","\u0119","\u011B","\u011D","\u011F","\u0121","\u0123","\u0125","\u0127","\u0129","\u012B","\u012D","\u012F","\u0131","\u0133","\u0135",["\u0137","\u0138"],"\u013A","\u013C","\u013E","\u0140","\u0142","\u0144","\u0146",["\u0148","\u0149"],"\u014B","\u014D","\u014F","\u0151","\u0153","\u0155","\u0157","\u0159","\u015B","\u015D","\u015F","\u0161","\u0163","\u0165","\u0167","\u0169","\u016B","\u016D","\u016F","\u0171","\u0173","\u0175","\u0177","\u017A","\u017C",["\u017E","\u0180"],"\u0183","\u0185","\u0188",["\u018C","\u018D"],"\u0192","\u0195",["\u0199","\u019B"],"\u019E","\u01A1","\u01A3","\u01A5","\u01A8",["\u01AA","\u01AB"],"\u01AD","\u01B0","\u01B4","\u01B6",["\u01B9","\u01BA"],["\u01BD","\u01BF"],"\u01C6","\u01C9","\u01CC","\u01CE","\u01D0","\u01D2","\u01D4","\u01D6","\u01D8","\u01DA",["\u01DC","\u01DD"],"\u01DF","\u01E1","\u01E3","\u01E5","\u01E7","\u01E9","\u01EB","\u01ED",["\u01EF","\u01F0"],"\u01F3","\u01F5","\u01F9","\u01FB","\u01FD","\u01FF","\u0201","\u0203","\u0205","\u0207","\u0209","\u020B","\u020D","\u020F","\u0211","\u0213","\u0215","\u0217","\u0219","\u021B","\u021D","\u021F","\u0221","\u0223","\u0225","\u0227","\u0229","\u022B","\u022D","\u022F","\u0231",["\u0233","\u0239"],"\u023C",["\u023F","\u0240"],"\u0242","\u0247","\u0249","\u024B","\u024D",["\u024F","\u0293"],["\u0295","\u02AF"],"\u0371","\u0373","\u0377",["\u037B","\u037D"],"\u0390",["\u03AC","\u03CE"],["\u03D0","\u03D1"],["\u03D5","\u03D7"],"\u03D9","\u03DB","\u03DD","\u03DF","\u03E1","\u03E3","\u03E5","\u03E7","\u03E9","\u03EB","\u03ED",["\u03EF","\u03F3"],"\u03F5","\u03F8",["\u03FB","\u03FC"],["\u0430","\u045F"],"\u0461","\u0463","\u0465","\u0467","\u0469","\u046B","\u046D","\u046F","\u0471","\u0473","\u0475","\u0477","\u0479","\u047B","\u047D","\u047F","\u0481","\u048B","\u048D","\u048F","\u0491","\u0493","\u0495","\u0497","\u0499","\u049B","\u049D","\u049F","\u04A1","\u04A3","\u04A5","\u04A7","\u04A9","\u04AB","\u04AD","\u04AF","\u04B1","\u04B3","\u04B5","\u04B7","\u04B9","\u04BB","\u04BD","\u04BF","\u04C2","\u04C4","\u04C6","\u04C8","\u04CA","\u04CC",["\u04CE","\u04CF"],"\u04D1","\u04D3","\u04D5","\u04D7","\u04D9","\u04DB","\u04DD","\u04DF","\u04E1","\u04E3","\u04E5","\u04E7","\u04E9","\u04EB","\u04ED","\u04EF","\u04F1","\u04F3","\u04F5","\u04F7","\u04F9","\u04FB","\u04FD","\u04FF","\u0501","\u0503","\u0505","\u0507","\u0509","\u050B","\u050D","\u050F","\u0511","\u0513","\u0515","\u0517","\u0519","\u051B","\u051D","\u051F","\u0521","\u0523","\u0525","\u0527","\u0529","\u052B","\u052D","\u052F",["\u0561","\u0587"],["\u13F8","\u13FD"],["\u1D00","\u1D2B"],["\u1D6B","\u1D77"],["\u1D79","\u1D9A"],"\u1E01","\u1E03","\u1E05","\u1E07","\u1E09","\u1E0B","\u1E0D","\u1E0F","\u1E11","\u1E13","\u1E15","\u1E17","\u1E19","\u1E1B","\u1E1D","\u1E1F","\u1E21","\u1E23","\u1E25","\u1E27","\u1E29","\u1E2B","\u1E2D","\u1E2F","\u1E31","\u1E33","\u1E35","\u1E37","\u1E39","\u1E3B","\u1E3D","\u1E3F","\u1E41","\u1E43","\u1E45","\u1E47","\u1E49","\u1E4B","\u1E4D","\u1E4F","\u1E51","\u1E53","\u1E55","\u1E57","\u1E59","\u1E5B","\u1E5D","\u1E5F","\u1E61","\u1E63","\u1E65","\u1E67","\u1E69","\u1E6B","\u1E6D","\u1E6F","\u1E71","\u1E73","\u1E75","\u1E77","\u1E79","\u1E7B","\u1E7D","\u1E7F","\u1E81","\u1E83","\u1E85","\u1E87","\u1E89","\u1E8B","\u1E8D","\u1E8F","\u1E91","\u1E93",["\u1E95","\u1E9D"],"\u1E9F","\u1EA1","\u1EA3","\u1EA5","\u1EA7","\u1EA9","\u1EAB","\u1EAD","\u1EAF","\u1EB1","\u1EB3","\u1EB5","\u1EB7","\u1EB9","\u1EBB","\u1EBD","\u1EBF","\u1EC1","\u1EC3","\u1EC5","\u1EC7","\u1EC9","\u1ECB","\u1ECD","\u1ECF","\u1ED1","\u1ED3","\u1ED5","\u1ED7","\u1ED9","\u1EDB","\u1EDD","\u1EDF","\u1EE1","\u1EE3","\u1EE5","\u1EE7","\u1EE9","\u1EEB","\u1EED","\u1EEF","\u1EF1","\u1EF3","\u1EF5","\u1EF7","\u1EF9","\u1EFB","\u1EFD",["\u1EFF","\u1F07"],["\u1F10","\u1F15"],["\u1F20","\u1F27"],["\u1F30","\u1F37"],["\u1F40","\u1F45"],["\u1F50","\u1F57"],["\u1F60","\u1F67"],["\u1F70","\u1F7D"],["\u1F80","\u1F87"],["\u1F90","\u1F97"],["\u1FA0","\u1FA7"],["\u1FB0","\u1FB4"],["\u1FB6","\u1FB7"],"\u1FBE",["\u1FC2","\u1FC4"],["\u1FC6","\u1FC7"],["\u1FD0","\u1FD3"],["\u1FD6","\u1FD7"],["\u1FE0","\u1FE7"],["\u1FF2","\u1FF4"],["\u1FF6","\u1FF7"],"\u210A",["\u210E","\u210F"],"\u2113","\u212F","\u2134","\u2139",["\u213C","\u213D"],["\u2146","\u2149"],"\u214E","\u2184",["\u2C30","\u2C5E"],"\u2C61",["\u2C65","\u2C66"],"\u2C68","\u2C6A","\u2C6C","\u2C71",["\u2C73","\u2C74"],["\u2C76","\u2C7B"],"\u2C81","\u2C83","\u2C85","\u2C87","\u2C89","\u2C8B","\u2C8D","\u2C8F","\u2C91","\u2C93","\u2C95","\u2C97","\u2C99","\u2C9B","\u2C9D","\u2C9F","\u2CA1","\u2CA3","\u2CA5","\u2CA7","\u2CA9","\u2CAB","\u2CAD","\u2CAF","\u2CB1","\u2CB3","\u2CB5","\u2CB7","\u2CB9","\u2CBB","\u2CBD","\u2CBF","\u2CC1","\u2CC3","\u2CC5","\u2CC7","\u2CC9","\u2CCB","\u2CCD","\u2CCF","\u2CD1","\u2CD3","\u2CD5","\u2CD7","\u2CD9","\u2CDB","\u2CDD","\u2CDF","\u2CE1",["\u2CE3","\u2CE4"],"\u2CEC","\u2CEE","\u2CF3",["\u2D00","\u2D25"],"\u2D27","\u2D2D","\uA641","\uA643","\uA645","\uA647","\uA649","\uA64B","\uA64D","\uA64F","\uA651","\uA653","\uA655","\uA657","\uA659","\uA65B","\uA65D","\uA65F","\uA661","\uA663","\uA665","\uA667","\uA669","\uA66B","\uA66D","\uA681","\uA683","\uA685","\uA687","\uA689","\uA68B","\uA68D","\uA68F","\uA691","\uA693","\uA695","\uA697","\uA699","\uA69B","\uA723","\uA725","\uA727","\uA729","\uA72B","\uA72D",["\uA72F","\uA731"],"\uA733","\uA735","\uA737","\uA739","\uA73B","\uA73D","\uA73F","\uA741","\uA743","\uA745","\uA747","\uA749","\uA74B","\uA74D","\uA74F","\uA751","\uA753","\uA755","\uA757","\uA759","\uA75B","\uA75D","\uA75F","\uA761","\uA763","\uA765","\uA767","\uA769","\uA76B","\uA76D","\uA76F",["\uA771","\uA778"],"\uA77A","\uA77C","\uA77F","\uA781","\uA783","\uA785","\uA787","\uA78C","\uA78E","\uA791",["\uA793","\uA795"],"\uA797","\uA799","\uA79B","\uA79D","\uA79F","\uA7A1","\uA7A3","\uA7A5","\uA7A7","\uA7A9","\uA7B5","\uA7B7","\uA7FA",["\uAB30","\uAB5A"],["\uAB60","\uAB65"],["\uAB70","\uABBF"],["\uFB00","\uFB06"],["\uFB13","\uFB17"],["\uFF41","\uFF5A"]],!1,!1),Xr=fr([["\u02B0","\u02C1"],["\u02C6","\u02D1"],["\u02E0","\u02E4"],"\u02EC","\u02EE","\u0374","\u037A","\u0559","\u0640",["\u06E5","\u06E6"],["\u07F4","\u07F5"],"\u07FA","\u081A","\u0824","\u0828","\u0971","\u0E46","\u0EC6","\u10FC","\u17D7","\u1843","\u1AA7",["\u1C78","\u1C7D"],["\u1D2C","\u1D6A"],"\u1D78",["\u1D9B","\u1DBF"],"\u2071","\u207F",["\u2090","\u209C"],["\u2C7C","\u2C7D"],"\u2D6F","\u2E2F","\u3005",["\u3031","\u3035"],"\u303B",["\u309D","\u309E"],["\u30FC","\u30FE"],"\uA015",["\uA4F8","\uA4FD"],"\uA60C","\uA67F",["\uA69C","\uA69D"],["\uA717","\uA71F"],"\uA770","\uA788",["\uA7F8","\uA7F9"],"\uA9CF","\uA9E6","\uAA70","\uAADD",["\uAAF3","\uAAF4"],["\uAB5C","\uAB5F"],"\uFF70",["\uFF9E","\uFF9F"]],!1,!1),sn=fr(["\xAA","\xBA","\u01BB",["\u01C0","\u01C3"],"\u0294",["\u05D0","\u05EA"],["\u05F0","\u05F2"],["\u0620","\u063F"],["\u0641","\u064A"],["\u066E","\u066F"],["\u0671","\u06D3"],"\u06D5",["\u06EE","\u06EF"],["\u06FA","\u06FC"],"\u06FF","\u0710",["\u0712","\u072F"],["\u074D","\u07A5"],"\u07B1",["\u07CA","\u07EA"],["\u0800","\u0815"],["\u0840","\u0858"],["\u08A0","\u08B4"],["\u0904","\u0939"],"\u093D","\u0950",["\u0958","\u0961"],["\u0972","\u0980"],["\u0985","\u098C"],["\u098F","\u0990"],["\u0993","\u09A8"],["\u09AA","\u09B0"],"\u09B2",["\u09B6","\u09B9"],"\u09BD","\u09CE",["\u09DC","\u09DD"],["\u09DF","\u09E1"],["\u09F0","\u09F1"],["\u0A05","\u0A0A"],["\u0A0F","\u0A10"],["\u0A13","\u0A28"],["\u0A2A","\u0A30"],["\u0A32","\u0A33"],["\u0A35","\u0A36"],["\u0A38","\u0A39"],["\u0A59","\u0A5C"],"\u0A5E",["\u0A72","\u0A74"],["\u0A85","\u0A8D"],["\u0A8F","\u0A91"],["\u0A93","\u0AA8"],["\u0AAA","\u0AB0"],["\u0AB2","\u0AB3"],["\u0AB5","\u0AB9"],"\u0ABD","\u0AD0",["\u0AE0","\u0AE1"],"\u0AF9",["\u0B05","\u0B0C"],["\u0B0F","\u0B10"],["\u0B13","\u0B28"],["\u0B2A","\u0B30"],["\u0B32","\u0B33"],["\u0B35","\u0B39"],"\u0B3D",["\u0B5C","\u0B5D"],["\u0B5F","\u0B61"],"\u0B71","\u0B83",["\u0B85","\u0B8A"],["\u0B8E","\u0B90"],["\u0B92","\u0B95"],["\u0B99","\u0B9A"],"\u0B9C",["\u0B9E","\u0B9F"],["\u0BA3","\u0BA4"],["\u0BA8","\u0BAA"],["\u0BAE","\u0BB9"],"\u0BD0",["\u0C05","\u0C0C"],["\u0C0E","\u0C10"],["\u0C12","\u0C28"],["\u0C2A","\u0C39"],"\u0C3D",["\u0C58","\u0C5A"],["\u0C60","\u0C61"],["\u0C85","\u0C8C"],["\u0C8E","\u0C90"],["\u0C92","\u0CA8"],["\u0CAA","\u0CB3"],["\u0CB5","\u0CB9"],"\u0CBD","\u0CDE",["\u0CE0","\u0CE1"],["\u0CF1","\u0CF2"],["\u0D05","\u0D0C"],["\u0D0E","\u0D10"],["\u0D12","\u0D3A"],"\u0D3D","\u0D4E",["\u0D5F","\u0D61"],["\u0D7A","\u0D7F"],["\u0D85","\u0D96"],["\u0D9A","\u0DB1"],["\u0DB3","\u0DBB"],"\u0DBD",["\u0DC0","\u0DC6"],["\u0E01","\u0E30"],["\u0E32","\u0E33"],["\u0E40","\u0E45"],["\u0E81","\u0E82"],"\u0E84",["\u0E87","\u0E88"],"\u0E8A","\u0E8D",["\u0E94","\u0E97"],["\u0E99","\u0E9F"],["\u0EA1","\u0EA3"],"\u0EA5","\u0EA7",["\u0EAA","\u0EAB"],["\u0EAD","\u0EB0"],["\u0EB2","\u0EB3"],"\u0EBD",["\u0EC0","\u0EC4"],["\u0EDC","\u0EDF"],"\u0F00",["\u0F40","\u0F47"],["\u0F49","\u0F6C"],["\u0F88","\u0F8C"],["\u1000","\u102A"],"\u103F",["\u1050","\u1055"],["\u105A","\u105D"],"\u1061",["\u1065","\u1066"],["\u106E","\u1070"],["\u1075","\u1081"],"\u108E",["\u10D0","\u10FA"],["\u10FD","\u1248"],["\u124A","\u124D"],["\u1250","\u1256"],"\u1258",["\u125A","\u125D"],["\u1260","\u1288"],["\u128A","\u128D"],["\u1290","\u12B0"],["\u12B2","\u12B5"],["\u12B8","\u12BE"],"\u12C0",["\u12C2","\u12C5"],["\u12C8","\u12D6"],["\u12D8","\u1310"],["\u1312","\u1315"],["\u1318","\u135A"],["\u1380","\u138F"],["\u1401","\u166C"],["\u166F","\u167F"],["\u1681","\u169A"],["\u16A0","\u16EA"],["\u16F1","\u16F8"],["\u1700","\u170C"],["\u170E","\u1711"],["\u1720","\u1731"],["\u1740","\u1751"],["\u1760","\u176C"],["\u176E","\u1770"],["\u1780","\u17B3"],"\u17DC",["\u1820","\u1842"],["\u1844","\u1877"],["\u1880","\u18A8"],"\u18AA",["\u18B0","\u18F5"],["\u1900","\u191E"],["\u1950","\u196D"],["\u1970","\u1974"],["\u1980","\u19AB"],["\u19B0","\u19C9"],["\u1A00","\u1A16"],["\u1A20","\u1A54"],["\u1B05","\u1B33"],["\u1B45","\u1B4B"],["\u1B83","\u1BA0"],["\u1BAE","\u1BAF"],["\u1BBA","\u1BE5"],["\u1C00","\u1C23"],["\u1C4D","\u1C4F"],["\u1C5A","\u1C77"],["\u1CE9","\u1CEC"],["\u1CEE","\u1CF1"],["\u1CF5","\u1CF6"],["\u2135","\u2138"],["\u2D30","\u2D67"],["\u2D80","\u2D96"],["\u2DA0","\u2DA6"],["\u2DA8","\u2DAE"],["\u2DB0","\u2DB6"],["\u2DB8","\u2DBE"],["\u2DC0","\u2DC6"],["\u2DC8","\u2DCE"],["\u2DD0","\u2DD6"],["\u2DD8","\u2DDE"],"\u3006","\u303C",["\u3041","\u3096"],"\u309F",["\u30A1","\u30FA"],"\u30FF",["\u3105","\u312D"],["\u3131","\u318E"],["\u31A0","\u31BA"],["\u31F0","\u31FF"],["\u3400","\u4DB5"],["\u4E00","\u9FD5"],["\uA000","\uA014"],["\uA016","\uA48C"],["\uA4D0","\uA4F7"],["\uA500","\uA60B"],["\uA610","\uA61F"],["\uA62A","\uA62B"],"\uA66E",["\uA6A0","\uA6E5"],"\uA78F","\uA7F7",["\uA7FB","\uA801"],["\uA803","\uA805"],["\uA807","\uA80A"],["\uA80C","\uA822"],["\uA840","\uA873"],["\uA882","\uA8B3"],["\uA8F2","\uA8F7"],"\uA8FB","\uA8FD",["\uA90A","\uA925"],["\uA930","\uA946"],["\uA960","\uA97C"],["\uA984","\uA9B2"],["\uA9E0","\uA9E4"],["\uA9E7","\uA9EF"],["\uA9FA","\uA9FE"],["\uAA00","\uAA28"],["\uAA40","\uAA42"],["\uAA44","\uAA4B"],["\uAA60","\uAA6F"],["\uAA71","\uAA76"],"\uAA7A",["\uAA7E","\uAAAF"],"\uAAB1",["\uAAB5","\uAAB6"],["\uAAB9","\uAABD"],"\uAAC0","\uAAC2",["\uAADB","\uAADC"],["\uAAE0","\uAAEA"],"\uAAF2",["\uAB01","\uAB06"],["\uAB09","\uAB0E"],["\uAB11","\uAB16"],["\uAB20","\uAB26"],["\uAB28","\uAB2E"],["\uABC0","\uABE2"],["\uAC00","\uD7A3"],["\uD7B0","\uD7C6"],["\uD7CB","\uD7FB"],["\uF900","\uFA6D"],["\uFA70","\uFAD9"],"\uFB1D",["\uFB1F","\uFB28"],["\uFB2A","\uFB36"],["\uFB38","\uFB3C"],"\uFB3E",["\uFB40","\uFB41"],["\uFB43","\uFB44"],["\uFB46","\uFBB1"],["\uFBD3","\uFD3D"],["\uFD50","\uFD8F"],["\uFD92","\uFDC7"],["\uFDF0","\uFDFB"],["\uFE70","\uFE74"],["\uFE76","\uFEFC"],["\uFF66","\uFF6F"],["\uFF71","\uFF9D"],["\uFFA0","\uFFBE"],["\uFFC2","\uFFC7"],["\uFFCA","\uFFCF"],["\uFFD2","\uFFD7"],["\uFFDA","\uFFDC"]],!1,!1),se=fr(["\u01C5","\u01C8","\u01CB","\u01F2",["\u1F88","\u1F8F"],["\u1F98","\u1F9F"],["\u1FA8","\u1FAF"],"\u1FBC","\u1FCC","\u1FFC"],!1,!1),ye=fr([["A","Z"],["\xC0","\xD6"],["\xD8","\xDE"],"\u0100","\u0102","\u0104","\u0106","\u0108","\u010A","\u010C","\u010E","\u0110","\u0112","\u0114","\u0116","\u0118","\u011A","\u011C","\u011E","\u0120","\u0122","\u0124","\u0126","\u0128","\u012A","\u012C","\u012E","\u0130","\u0132","\u0134","\u0136","\u0139","\u013B","\u013D","\u013F","\u0141","\u0143","\u0145","\u0147","\u014A","\u014C","\u014E","\u0150","\u0152","\u0154","\u0156","\u0158","\u015A","\u015C","\u015E","\u0160","\u0162","\u0164","\u0166","\u0168","\u016A","\u016C","\u016E","\u0170","\u0172","\u0174","\u0176",["\u0178","\u0179"],"\u017B","\u017D",["\u0181","\u0182"],"\u0184",["\u0186","\u0187"],["\u0189","\u018B"],["\u018E","\u0191"],["\u0193","\u0194"],["\u0196","\u0198"],["\u019C","\u019D"],["\u019F","\u01A0"],"\u01A2","\u01A4",["\u01A6","\u01A7"],"\u01A9","\u01AC",["\u01AE","\u01AF"],["\u01B1","\u01B3"],"\u01B5",["\u01B7","\u01B8"],"\u01BC","\u01C4","\u01C7","\u01CA","\u01CD","\u01CF","\u01D1","\u01D3","\u01D5","\u01D7","\u01D9","\u01DB","\u01DE","\u01E0","\u01E2","\u01E4","\u01E6","\u01E8","\u01EA","\u01EC","\u01EE","\u01F1","\u01F4",["\u01F6","\u01F8"],"\u01FA","\u01FC","\u01FE","\u0200","\u0202","\u0204","\u0206","\u0208","\u020A","\u020C","\u020E","\u0210","\u0212","\u0214","\u0216","\u0218","\u021A","\u021C","\u021E","\u0220","\u0222","\u0224","\u0226","\u0228","\u022A","\u022C","\u022E","\u0230","\u0232",["\u023A","\u023B"],["\u023D","\u023E"],"\u0241",["\u0243","\u0246"],"\u0248","\u024A","\u024C","\u024E","\u0370","\u0372","\u0376","\u037F","\u0386",["\u0388","\u038A"],"\u038C",["\u038E","\u038F"],["\u0391","\u03A1"],["\u03A3","\u03AB"],"\u03CF",["\u03D2","\u03D4"],"\u03D8","\u03DA","\u03DC","\u03DE","\u03E0","\u03E2","\u03E4","\u03E6","\u03E8","\u03EA","\u03EC","\u03EE","\u03F4","\u03F7",["\u03F9","\u03FA"],["\u03FD","\u042F"],"\u0460","\u0462","\u0464","\u0466","\u0468","\u046A","\u046C","\u046E","\u0470","\u0472","\u0474","\u0476","\u0478","\u047A","\u047C","\u047E","\u0480","\u048A","\u048C","\u048E","\u0490","\u0492","\u0494","\u0496","\u0498","\u049A","\u049C","\u049E","\u04A0","\u04A2","\u04A4","\u04A6","\u04A8","\u04AA","\u04AC","\u04AE","\u04B0","\u04B2","\u04B4","\u04B6","\u04B8","\u04BA","\u04BC","\u04BE",["\u04C0","\u04C1"],"\u04C3","\u04C5","\u04C7","\u04C9","\u04CB","\u04CD","\u04D0","\u04D2","\u04D4","\u04D6","\u04D8","\u04DA","\u04DC","\u04DE","\u04E0","\u04E2","\u04E4","\u04E6","\u04E8","\u04EA","\u04EC","\u04EE","\u04F0","\u04F2","\u04F4","\u04F6","\u04F8","\u04FA","\u04FC","\u04FE","\u0500","\u0502","\u0504","\u0506","\u0508","\u050A","\u050C","\u050E","\u0510","\u0512","\u0514","\u0516","\u0518","\u051A","\u051C","\u051E","\u0520","\u0522","\u0524","\u0526","\u0528","\u052A","\u052C","\u052E",["\u0531","\u0556"],["\u10A0","\u10C5"],"\u10C7","\u10CD",["\u13A0","\u13F5"],"\u1E00","\u1E02","\u1E04","\u1E06","\u1E08","\u1E0A","\u1E0C","\u1E0E","\u1E10","\u1E12","\u1E14","\u1E16","\u1E18","\u1E1A","\u1E1C","\u1E1E","\u1E20","\u1E22","\u1E24","\u1E26","\u1E28","\u1E2A","\u1E2C","\u1E2E","\u1E30","\u1E32","\u1E34","\u1E36","\u1E38","\u1E3A","\u1E3C","\u1E3E","\u1E40","\u1E42","\u1E44","\u1E46","\u1E48","\u1E4A","\u1E4C","\u1E4E","\u1E50","\u1E52","\u1E54","\u1E56","\u1E58","\u1E5A","\u1E5C","\u1E5E","\u1E60","\u1E62","\u1E64","\u1E66","\u1E68","\u1E6A","\u1E6C","\u1E6E","\u1E70","\u1E72","\u1E74","\u1E76","\u1E78","\u1E7A","\u1E7C","\u1E7E","\u1E80","\u1E82","\u1E84","\u1E86","\u1E88","\u1E8A","\u1E8C","\u1E8E","\u1E90","\u1E92","\u1E94","\u1E9E","\u1EA0","\u1EA2","\u1EA4","\u1EA6","\u1EA8","\u1EAA","\u1EAC","\u1EAE","\u1EB0","\u1EB2","\u1EB4","\u1EB6","\u1EB8","\u1EBA","\u1EBC","\u1EBE","\u1EC0","\u1EC2","\u1EC4","\u1EC6","\u1EC8","\u1ECA","\u1ECC","\u1ECE","\u1ED0","\u1ED2","\u1ED4","\u1ED6","\u1ED8","\u1EDA","\u1EDC","\u1EDE","\u1EE0","\u1EE2","\u1EE4","\u1EE6","\u1EE8","\u1EEA","\u1EEC","\u1EEE","\u1EF0","\u1EF2","\u1EF4","\u1EF6","\u1EF8","\u1EFA","\u1EFC","\u1EFE",["\u1F08","\u1F0F"],["\u1F18","\u1F1D"],["\u1F28","\u1F2F"],["\u1F38","\u1F3F"],["\u1F48","\u1F4D"],"\u1F59","\u1F5B","\u1F5D","\u1F5F",["\u1F68","\u1F6F"],["\u1FB8","\u1FBB"],["\u1FC8","\u1FCB"],["\u1FD8","\u1FDB"],["\u1FE8","\u1FEC"],["\u1FF8","\u1FFB"],"\u2102","\u2107",["\u210B","\u210D"],["\u2110","\u2112"],"\u2115",["\u2119","\u211D"],"\u2124","\u2126","\u2128",["\u212A","\u212D"],["\u2130","\u2133"],["\u213E","\u213F"],"\u2145","\u2183",["\u2C00","\u2C2E"],"\u2C60",["\u2C62","\u2C64"],"\u2C67","\u2C69","\u2C6B",["\u2C6D","\u2C70"],"\u2C72","\u2C75",["\u2C7E","\u2C80"],"\u2C82","\u2C84","\u2C86","\u2C88","\u2C8A","\u2C8C","\u2C8E","\u2C90","\u2C92","\u2C94","\u2C96","\u2C98","\u2C9A","\u2C9C","\u2C9E","\u2CA0","\u2CA2","\u2CA4","\u2CA6","\u2CA8","\u2CAA","\u2CAC","\u2CAE","\u2CB0","\u2CB2","\u2CB4","\u2CB6","\u2CB8","\u2CBA","\u2CBC","\u2CBE","\u2CC0","\u2CC2","\u2CC4","\u2CC6","\u2CC8","\u2CCA","\u2CCC","\u2CCE","\u2CD0","\u2CD2","\u2CD4","\u2CD6","\u2CD8","\u2CDA","\u2CDC","\u2CDE","\u2CE0","\u2CE2","\u2CEB","\u2CED","\u2CF2","\uA640","\uA642","\uA644","\uA646","\uA648","\uA64A","\uA64C","\uA64E","\uA650","\uA652","\uA654","\uA656","\uA658","\uA65A","\uA65C","\uA65E","\uA660","\uA662","\uA664","\uA666","\uA668","\uA66A","\uA66C","\uA680","\uA682","\uA684","\uA686","\uA688","\uA68A","\uA68C","\uA68E","\uA690","\uA692","\uA694","\uA696","\uA698","\uA69A","\uA722","\uA724","\uA726","\uA728","\uA72A","\uA72C","\uA72E","\uA732","\uA734","\uA736","\uA738","\uA73A","\uA73C","\uA73E","\uA740","\uA742","\uA744","\uA746","\uA748","\uA74A","\uA74C","\uA74E","\uA750","\uA752","\uA754","\uA756","\uA758","\uA75A","\uA75C","\uA75E","\uA760","\uA762","\uA764","\uA766","\uA768","\uA76A","\uA76C","\uA76E","\uA779","\uA77B",["\uA77D","\uA77E"],"\uA780","\uA782","\uA784","\uA786","\uA78B","\uA78D","\uA790","\uA792","\uA796","\uA798","\uA79A","\uA79C","\uA79E","\uA7A0","\uA7A2","\uA7A4","\uA7A6","\uA7A8",["\uA7AA","\uA7AD"],["\uA7B0","\uA7B4"],"\uA7B6",["\uFF21","\uFF3A"]],!1,!1),Re=fr(["\u0903","\u093B",["\u093E","\u0940"],["\u0949","\u094C"],["\u094E","\u094F"],["\u0982","\u0983"],["\u09BE","\u09C0"],["\u09C7","\u09C8"],["\u09CB","\u09CC"],"\u09D7","\u0A03",["\u0A3E","\u0A40"],"\u0A83",["\u0ABE","\u0AC0"],"\u0AC9",["\u0ACB","\u0ACC"],["\u0B02","\u0B03"],"\u0B3E","\u0B40",["\u0B47","\u0B48"],["\u0B4B","\u0B4C"],"\u0B57",["\u0BBE","\u0BBF"],["\u0BC1","\u0BC2"],["\u0BC6","\u0BC8"],["\u0BCA","\u0BCC"],"\u0BD7",["\u0C01","\u0C03"],["\u0C41","\u0C44"],["\u0C82","\u0C83"],"\u0CBE",["\u0CC0","\u0CC4"],["\u0CC7","\u0CC8"],["\u0CCA","\u0CCB"],["\u0CD5","\u0CD6"],["\u0D02","\u0D03"],["\u0D3E","\u0D40"],["\u0D46","\u0D48"],["\u0D4A","\u0D4C"],"\u0D57",["\u0D82","\u0D83"],["\u0DCF","\u0DD1"],["\u0DD8","\u0DDF"],["\u0DF2","\u0DF3"],["\u0F3E","\u0F3F"],"\u0F7F",["\u102B","\u102C"],"\u1031","\u1038",["\u103B","\u103C"],["\u1056","\u1057"],["\u1062","\u1064"],["\u1067","\u106D"],["\u1083","\u1084"],["\u1087","\u108C"],"\u108F",["\u109A","\u109C"],"\u17B6",["\u17BE","\u17C5"],["\u17C7","\u17C8"],["\u1923","\u1926"],["\u1929","\u192B"],["\u1930","\u1931"],["\u1933","\u1938"],["\u1A19","\u1A1A"],"\u1A55","\u1A57","\u1A61",["\u1A63","\u1A64"],["\u1A6D","\u1A72"],"\u1B04","\u1B35","\u1B3B",["\u1B3D","\u1B41"],["\u1B43","\u1B44"],"\u1B82","\u1BA1",["\u1BA6","\u1BA7"],"\u1BAA","\u1BE7",["\u1BEA","\u1BEC"],"\u1BEE",["\u1BF2","\u1BF3"],["\u1C24","\u1C2B"],["\u1C34","\u1C35"],"\u1CE1",["\u1CF2","\u1CF3"],["\u302E","\u302F"],["\uA823","\uA824"],"\uA827",["\uA880","\uA881"],["\uA8B4","\uA8C3"],["\uA952","\uA953"],"\uA983",["\uA9B4","\uA9B5"],["\uA9BA","\uA9BB"],["\uA9BD","\uA9C0"],["\uAA2F","\uAA30"],["\uAA33","\uAA34"],"\uAA4D","\uAA7B","\uAA7D","\uAAEB",["\uAAEE","\uAAEF"],"\uAAF5",["\uABE3","\uABE4"],["\uABE6","\uABE7"],["\uABE9","\uABEA"],"\uABEC"],!1,!1),ar=fr([["\u0300","\u036F"],["\u0483","\u0487"],["\u0591","\u05BD"],"\u05BF",["\u05C1","\u05C2"],["\u05C4","\u05C5"],"\u05C7",["\u0610","\u061A"],["\u064B","\u065F"],"\u0670",["\u06D6","\u06DC"],["\u06DF","\u06E4"],["\u06E7","\u06E8"],["\u06EA","\u06ED"],"\u0711",["\u0730","\u074A"],["\u07A6","\u07B0"],["\u07EB","\u07F3"],["\u0816","\u0819"],["\u081B","\u0823"],["\u0825","\u0827"],["\u0829","\u082D"],["\u0859","\u085B"],["\u08E3","\u0902"],"\u093A","\u093C",["\u0941","\u0948"],"\u094D",["\u0951","\u0957"],["\u0962","\u0963"],"\u0981","\u09BC",["\u09C1","\u09C4"],"\u09CD",["\u09E2","\u09E3"],["\u0A01","\u0A02"],"\u0A3C",["\u0A41","\u0A42"],["\u0A47","\u0A48"],["\u0A4B","\u0A4D"],"\u0A51",["\u0A70","\u0A71"],"\u0A75",["\u0A81","\u0A82"],"\u0ABC",["\u0AC1","\u0AC5"],["\u0AC7","\u0AC8"],"\u0ACD",["\u0AE2","\u0AE3"],"\u0B01","\u0B3C","\u0B3F",["\u0B41","\u0B44"],"\u0B4D","\u0B56",["\u0B62","\u0B63"],"\u0B82","\u0BC0","\u0BCD","\u0C00",["\u0C3E","\u0C40"],["\u0C46","\u0C48"],["\u0C4A","\u0C4D"],["\u0C55","\u0C56"],["\u0C62","\u0C63"],"\u0C81","\u0CBC","\u0CBF","\u0CC6",["\u0CCC","\u0CCD"],["\u0CE2","\u0CE3"],"\u0D01",["\u0D41","\u0D44"],"\u0D4D",["\u0D62","\u0D63"],"\u0DCA",["\u0DD2","\u0DD4"],"\u0DD6","\u0E31",["\u0E34","\u0E3A"],["\u0E47","\u0E4E"],"\u0EB1",["\u0EB4","\u0EB9"],["\u0EBB","\u0EBC"],["\u0EC8","\u0ECD"],["\u0F18","\u0F19"],"\u0F35","\u0F37","\u0F39",["\u0F71","\u0F7E"],["\u0F80","\u0F84"],["\u0F86","\u0F87"],["\u0F8D","\u0F97"],["\u0F99","\u0FBC"],"\u0FC6",["\u102D","\u1030"],["\u1032","\u1037"],["\u1039","\u103A"],["\u103D","\u103E"],["\u1058","\u1059"],["\u105E","\u1060"],["\u1071","\u1074"],"\u1082",["\u1085","\u1086"],"\u108D","\u109D",["\u135D","\u135F"],["\u1712","\u1714"],["\u1732","\u1734"],["\u1752","\u1753"],["\u1772","\u1773"],["\u17B4","\u17B5"],["\u17B7","\u17BD"],"\u17C6",["\u17C9","\u17D3"],"\u17DD",["\u180B","\u180D"],"\u18A9",["\u1920","\u1922"],["\u1927","\u1928"],"\u1932",["\u1939","\u193B"],["\u1A17","\u1A18"],"\u1A1B","\u1A56",["\u1A58","\u1A5E"],"\u1A60","\u1A62",["\u1A65","\u1A6C"],["\u1A73","\u1A7C"],"\u1A7F",["\u1AB0","\u1ABD"],["\u1B00","\u1B03"],"\u1B34",["\u1B36","\u1B3A"],"\u1B3C","\u1B42",["\u1B6B","\u1B73"],["\u1B80","\u1B81"],["\u1BA2","\u1BA5"],["\u1BA8","\u1BA9"],["\u1BAB","\u1BAD"],"\u1BE6",["\u1BE8","\u1BE9"],"\u1BED",["\u1BEF","\u1BF1"],["\u1C2C","\u1C33"],["\u1C36","\u1C37"],["\u1CD0","\u1CD2"],["\u1CD4","\u1CE0"],["\u1CE2","\u1CE8"],"\u1CED","\u1CF4",["\u1CF8","\u1CF9"],["\u1DC0","\u1DF5"],["\u1DFC","\u1DFF"],["\u20D0","\u20DC"],"\u20E1",["\u20E5","\u20F0"],["\u2CEF","\u2CF1"],"\u2D7F",["\u2DE0","\u2DFF"],["\u302A","\u302D"],["\u3099","\u309A"],"\uA66F",["\uA674","\uA67D"],["\uA69E","\uA69F"],["\uA6F0","\uA6F1"],"\uA802","\uA806","\uA80B",["\uA825","\uA826"],"\uA8C4",["\uA8E0","\uA8F1"],["\uA926","\uA92D"],["\uA947","\uA951"],["\uA980","\uA982"],"\uA9B3",["\uA9B6","\uA9B9"],"\uA9BC","\uA9E5",["\uAA29","\uAA2E"],["\uAA31","\uAA32"],["\uAA35","\uAA36"],"\uAA43","\uAA4C","\uAA7C","\uAAB0",["\uAAB2","\uAAB4"],["\uAAB7","\uAAB8"],["\uAABE","\uAABF"],"\uAAC1",["\uAAEC","\uAAED"],"\uAAF6","\uABE5","\uABE8","\uABED","\uFB1E",["\uFE00","\uFE0F"],["\uFE20","\uFE2F"]],!1,!1),he=fr([["0","9"],["\u0660","\u0669"],["\u06F0","\u06F9"],["\u07C0","\u07C9"],["\u0966","\u096F"],["\u09E6","\u09EF"],["\u0A66","\u0A6F"],["\u0AE6","\u0AEF"],["\u0B66","\u0B6F"],["\u0BE6","\u0BEF"],["\u0C66","\u0C6F"],["\u0CE6","\u0CEF"],["\u0D66","\u0D6F"],["\u0DE6","\u0DEF"],["\u0E50","\u0E59"],["\u0ED0","\u0ED9"],["\u0F20","\u0F29"],["\u1040","\u1049"],["\u1090","\u1099"],["\u17E0","\u17E9"],["\u1810","\u1819"],["\u1946","\u194F"],["\u19D0","\u19D9"],["\u1A80","\u1A89"],["\u1A90","\u1A99"],["\u1B50","\u1B59"],["\u1BB0","\u1BB9"],["\u1C40","\u1C49"],["\u1C50","\u1C59"],["\uA620","\uA629"],["\uA8D0","\uA8D9"],["\uA900","\uA909"],["\uA9D0","\uA9D9"],["\uA9F0","\uA9F9"],["\uAA50","\uAA59"],["\uABF0","\uABF9"],["\uFF10","\uFF19"]],!1,!1),Zr=fr([["\u16EE","\u16F0"],["\u2160","\u2182"],["\u2185","\u2188"],"\u3007",["\u3021","\u3029"],["\u3038","\u303A"],["\uA6E6","\uA6EF"]],!1,!1),Ar=fr(["_",["\u203F","\u2040"],"\u2054",["\uFE33","\uFE34"],["\uFE4D","\uFE4F"],"\uFF3F"],!1,!1),un=fr([" ","\xA0","\u1680",["\u2000","\u200A"],"\u202F","\u205F","\u3000"],!1,!1),or=Ie(";",!1),J=0,xe=0,Tr=[{line:1,column:1}],gr=0,Ge=[],Lt=0;if("startRule"in e){if(!(e.startRule in f))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');d=f[e.startRule]}function sr(){return Te(xe,J)}function _n(X,dt){throw function(mt,Rt){return new peg$SyntaxError(mt,null,null,Rt)}(X,dt=dt!==void 0?dt:Te(xe,J))}function Ie(X,dt){return{type:"literal",text:X,ignoreCase:dt}}function fr(X,dt,mt){return{type:"class",parts:X,inverted:dt,ignoreCase:mt}}function Ue(X){return{type:"other",description:X}}function Yt(X){var dt,mt=Tr[X];if(mt)return mt;for(dt=X-1;!Tr[dt];)dt--;for(mt={line:(mt=Tr[dt]).line,column:mt.column};dt<X;)t.charCodeAt(dt)===10?(mt.line++,mt.column=1):mt.column++,dt++;return Tr[X]=mt,mt}function Te(X,dt){var mt=Yt(X),Rt=Yt(dt);return{source:o,start:{offset:X,line:mt.line,column:mt.column},end:{offset:dt,line:Rt.line,column:Rt.column}}}function Jt(X){J<gr||(J>gr&&(gr=J,Ge=[]),Ge.push(X))}function jn(){var X,dt,mt,Rt,Ft,jt;if(X=J,Ht(),dt=J,(mt=function(){var re,te,Et,kt;return re=J,t.charCodeAt(J)===123?(te="{",J++):(te=n,Lt===0&&Jt(wt)),te!==n&&(Et=Wt())!==n?(t.charCodeAt(J)===125?(kt="}",J++):(kt=n,Lt===0&&Jt(ft)),kt!==n&&Se()!==n?(xe=re,re=function(Tt){return{type:"top_level_initializer",code:Tt[0],codeLocation:Tt[1],location:sr()}}(Et)):(J=re,re=n)):(J=re,re=n),re}())!==n?(Rt=Ht(),dt=mt):(J=dt,dt=n),dt===n&&(dt=null),mt=J,(Rt=function(){var re,te;return re=J,(te=Wt())!==n&&Se()!==n?(xe=re,re=function(Et){return{type:"initializer",code:Et[0],codeLocation:Et[1],location:sr()}}(te)):(J=re,re=n),re}())!==n?(Ft=Ht(),mt=Rt):(J=mt,mt=n),mt===n&&(mt=null),Rt=[],Ft=J,(jt=Pn())!==n?(Ht(),Ft=jt):(J=Ft,Ft=n),Ft!==n)for(;Ft!==n;)Rt.push(Ft),Ft=J,(jt=Pn())!==n?(Ht(),Ft=jt):(J=Ft,Ft=n);else Rt=n;return Rt!==n?(xe=X,X={type:"grammar",topLevelInitializer:dt,initializer:mt,rules:Rt,location:sr()}):(J=X,X=n),X}function Pn(){var X,dt,mt,Rt,Ft;return X=J,(dt=U())!==n?(Ht(),mt=J,(Rt=st())!==n?(Ht(),mt=Rt):(J=mt,mt=n),mt===n&&(mt=null),t.charCodeAt(J)===61?(Rt="=",J++):(Rt=n,Lt===0&&Jt(yt)),Rt!==n?(Ht(),(Ft=Ee())!==n&&Se()!==n?(xe=X,X=function(jt,re,te){return{type:"rule",name:jt[0],nameLocation:jt[1],expression:re!==null?{type:"named",name:re,expression:te,location:sr()}:te,location:sr()}}(dt,mt,Ft)):(J=X,X=n)):(J=X,X=n)):(J=X,X=n),X}function Ee(){var X,dt,mt,Rt,Ft,jt,re,te;if(X=J,(dt=a())!==n){for(mt=[],Rt=J,Ht(),t.charCodeAt(J)===47?(Ft="/",J++):(Ft=n,Lt===0&&Jt(Ct)),Ft!==n?(Ht(),(jt=a())!==n?Rt=jt:(J=Rt,Rt=n)):(J=Rt,Rt=n);Rt!==n;)mt.push(Rt),Rt=J,Ht(),t.charCodeAt(J)===47?(Ft="/",J++):(Ft=n,Lt===0&&Jt(Ct)),Ft!==n?(Ht(),(jt=a())!==n?Rt=jt:(J=Rt,Rt=n)):(J=Rt,Rt=n);xe=X,re=dt,X=(te=mt).length>0?{type:"choice",alternatives:[re].concat(te),location:sr()}:re}else J=X,X=n;return X}function a(){var X,dt,mt,Rt;return X=J,(dt=function(){var Ft,jt,re,te,Et,kt,Tt;if(Ft=J,(jt=u())!==n){for(re=[],te=J,Ht(),(Et=u())!==n?te=Et:(J=te,te=n);te!==n;)re.push(te),te=J,Ht(),(Et=u())!==n?te=Et:(J=te,te=n);xe=Ft,kt=jt,Ft=(Tt=re).length>0||kt.type==="labeled"&&kt.pick?{type:"sequence",elements:[kt].concat(Tt),location:sr()}:kt}else J=Ft,Ft=n;return Ft}())!==n?(mt=J,Ht(),(Rt=Wt())!==n?mt=Rt:(J=mt,mt=n),mt===n&&(mt=null),xe=X,X=function(Ft,jt){return jt!==null?{type:"action",expression:Ft,code:jt[0],codeLocation:jt[1],location:sr()}:Ft}(dt,mt)):(J=X,X=n),X}function u(){var X,dt,mt,Rt,Ft,jt,re;return X=J,(dt=function(){var te,Et;return te=J,t.charCodeAt(J)===64?(Et="@",J++):(Et=n,Lt===0&&Jt(l)),Et!==n&&(xe=te,Et=sr()),Et}())!==n?((mt=p())===n&&(mt=null),(Rt=g())!==n?(xe=X,Ft=dt,jt=mt,(re=Rt).type.startsWith("semantic_")&&_n('"@" cannot be used on a semantic predicate',Ft),X={type:"labeled",label:jt!==null?jt[0]:null,labelLocation:jt!==null?jt[1]:Ft,pick:!0,expression:re,location:sr()}):(J=X,X=n)):(J=X,X=n),X===n&&(X=J,(dt=p())!==n?(mt=Ht(),(Rt=g())!==n?(xe=X,X=function(te,Et){return{type:"labeled",label:te[0],labelLocation:te[1],expression:Et,location:sr()}}(dt,Rt)):(J=X,X=n)):(J=X,X=n),X===n&&(X=g())),X}function p(){var X,dt,mt,Rt;return X=J,(dt=U())!==n?(Ht(),t.charCodeAt(J)===58?(mt=":",J++):(mt=n,Lt===0&&Jt(s)),mt!==n?(xe=X,Rt=dt,zt.indexOf(Rt[0])>=0&&_n(`Label can't be a reserved word "${Rt[0]}"`,Rt[1]),X=Rt):(J=X,X=n)):(J=X,X=n),X}function g(){var X,dt,mt,Rt;return X=J,(dt=function(){var Ft;return t.charCodeAt(J)===36?(Ft="$",J++):(Ft=n,Lt===0&&Jt(b)),Ft===n&&(t.charCodeAt(J)===38?(Ft="&",J++):(Ft=n,Lt===0&&Jt($)),Ft===n&&(t.charCodeAt(J)===33?(Ft="!",J++):(Ft=n,Lt===0&&Jt(E)))),Ft}())!==n?(Ht(),(mt=m())!==n?(xe=X,Rt=mt,X={type:OPS_TO_PREFIXED_TYPES[dt],expression:Rt,location:sr()}):(J=X,X=n)):(J=X,X=n),X===n&&(X=m()),X}function m(){var X,dt,mt,Rt;return X=J,(dt=w())!==n?(Ht(),(mt=function(){var Ft;return t.charCodeAt(J)===63?(Ft="?",J++):(Ft=n,Lt===0&&Jt(rt)),Ft===n&&(t.charCodeAt(J)===42?(Ft="*",J++):(Ft=n,Lt===0&&Jt(_t)),Ft===n&&(t.charCodeAt(J)===43?(Ft="+",J++):(Ft=n,Lt===0&&Jt(xt)))),Ft}())!==n?(xe=X,Rt=dt,X={type:OPS_TO_SUFFIXED_TYPES[mt],expression:Rt,location:sr()}):(J=X,X=n)):(J=X,X=n),X===n&&(X=w()),X}function w(){var X,dt,mt,Rt,Ft;return(X=function(){var jt,re,te;return Lt++,jt=J,(re=st())!==n?(t.charCodeAt(J)===105?(te="i",J++):(te=n,Lt===0&&Jt(ce)),te===n&&(te=null),xe=jt,jt={type:"literal",value:re,ignoreCase:te!==null,location:sr()}):(J=jt,jt=n),Lt--,jt===n&&(re=n,Lt===0&&Jt(Be)),jt}())===n&&(X=function(){var jt,re,te,Et,kt,Tt,Qt,le;if(Lt++,jt=J,t.charCodeAt(J)===91?(re="[",J++):(re=n,Lt===0&&Jt(nr)),re!==n){for(t.charCodeAt(J)===94?(te="^",J++):(te=n,Lt===0&&Jt(lr)),te===n&&(te=null),Et=[],(kt=Mt())===n&&(kt=Bt());kt!==n;)Et.push(kt),(kt=Mt())===n&&(kt=Bt());t.charCodeAt(J)===93?(kt="]",J++):(kt=n,Lt===0&&Jt(ur)),kt!==n?(t.charCodeAt(J)===105?(Tt="i",J++):(Tt=n,Lt===0&&Jt(ce)),Tt===n&&(Tt=null),xe=jt,Qt=te,le=Tt,jt={type:"class",parts:Et.filter($e=>$e!==""),inverted:Qt!==null,ignoreCase:le!==null,location:sr()}):(J=jt,jt=n)}else J=jt,jt=n;return Lt--,jt===n&&(re=n,Lt===0&&Jt(Je)),jt}())===n&&(X=function(){var jt,re;return jt=J,t.charCodeAt(J)===46?(re=".",J++):(re=n,Lt===0&&Jt(an)),re!==n&&(xe=jt,re={type:"any",location:sr()}),re}())===n&&(X=function(){var jt,re,te,Et,kt,Tt,Qt;return jt=J,(re=U())!==n?(te=J,Lt++,Et=J,kt=Ht(),Tt=J,(Qt=st())!==n?Tt=Qt=[Qt,Ht()]:(J=Tt,Tt=n),Tt===n&&(Tt=null),t.charCodeAt(J)===61?(Qt="=",J++):(Qt=n,Lt===0&&Jt(yt)),Qt!==n?Et=kt=[kt,Tt,Qt]:(J=Et,Et=n),Lt--,Et===n?te=void 0:(J=te,te=n),te!==n?(xe=jt,jt=function(le){return{type:"rule_ref",name:le[0],location:sr()}}(re)):(J=jt,jt=n)):(J=jt,jt=n),jt}())===n&&(X=function(){var jt,re,te;return jt=J,(re=function(){var Et;return t.charCodeAt(J)===38?(Et="&",J++):(Et=n,Lt===0&&Jt($)),Et===n&&(t.charCodeAt(J)===33?(Et="!",J++):(Et=n,Lt===0&&Jt(E))),Et}())!==n?(Ht(),(te=Wt())!==n?(xe=jt,jt=function(Et,kt){return{type:OPS_TO_SEMANTIC_PREDICATE_TYPES[Et],code:kt[0],codeLocation:kt[1],location:sr()}}(re,te)):(J=jt,jt=n)):(J=jt,jt=n),jt}())===n&&(X=J,t.charCodeAt(J)===40?(dt="(",J++):(dt=n,Lt===0&&Jt(St)),dt!==n?(Ht(),(mt=Ee())!==n?(Ht(),t.charCodeAt(J)===41?(Rt=")",J++):(Rt=n,Lt===0&&Jt(x)),Rt!==n?(xe=X,X=(Ft=mt).type==="labeled"||Ft.type==="sequence"?{type:"group",expression:Ft,location:sr()}:Ft):(J=X,X=n)):(J=X,X=n)):(J=X,X=n)),X}function F(){var X;return t.length>J?(X=t.charAt(J),J++):(X=n,Lt===0&&Jt(N)),X}function R(){var X;return Lt++,t.charCodeAt(J)===9?(X="	",J++):(X=n,Lt===0&&Jt(S)),X===n&&(t.charCodeAt(J)===11?(X="\v",J++):(X=n,Lt===0&&Jt(C)),X===n&&(t.charCodeAt(J)===12?(X="\f",J++):(X=n,Lt===0&&Jt(T)),X===n&&(t.charCodeAt(J)===32?(X=" ",J++):(X=n,Lt===0&&Jt(M)),X===n&&(t.charCodeAt(J)===160?(X="\xA0",J++):(X=n,Lt===0&&Jt(et)),X===n&&(t.charCodeAt(J)===65279?(X="\uFEFF",J++):(X=n,Lt===0&&Jt(Pt)),X===n&&(X=function(){var dt;return gt.test(t.charAt(J))?(dt=t.charAt(J),J++):(dt=n,Lt===0&&Jt(un)),dt}())))))),Lt--,X===n&&Lt===0&&Jt(V),X}function P(){var X;return h.test(t.charAt(J))?(X=t.charAt(J),J++):(X=n,Lt===0&&Jt(Ut)),X}function B(){var X;return Lt++,t.charCodeAt(J)===10?(X=`
`,J++):(X=n,Lt===0&&Jt(_e)),X===n&&(t.substr(J,2)===`\r
`?(X=`\r
`,J+=2):(X=n,Lt===0&&Jt(me)),X===n&&(t.charCodeAt(J)===13?(X="\r",J++):(X=n,Lt===0&&Jt(de)),X===n&&(t.charCodeAt(J)===8232?(X="\u2028",J++):(X=n,Lt===0&&Jt(Xt)),X===n&&(t.charCodeAt(J)===8233?(X="\u2029",J++):(X=n,Lt===0&&Jt(Gt)))))),Lt--,X===n&&Lt===0&&Jt(Zt),X}function K(){var X;return Lt++,(X=function(){var dt,mt,Rt,Ft,jt,re;if(dt=J,t.substr(J,2)==="/*"?(mt="/*",J+=2):(mt=n,Lt===0&&Jt(ge)),mt!==n){for(Rt=[],Ft=J,jt=J,Lt++,t.substr(J,2)==="*/"?(re="*/",J+=2):(re=n,Lt===0&&Jt(Dt)),Lt--,re===n?jt=void 0:(J=jt,jt=n),jt!==n&&(re=F())!==n?Ft=jt=[jt,re]:(J=Ft,Ft=n);Ft!==n;)Rt.push(Ft),Ft=J,jt=J,Lt++,t.substr(J,2)==="*/"?(re="*/",J+=2):(re=n,Lt===0&&Jt(Dt)),Lt--,re===n?jt=void 0:(J=jt,jt=n),jt!==n&&(re=F())!==n?Ft=jt=[jt,re]:(J=Ft,Ft=n);t.substr(J,2)==="*/"?(Ft="*/",J+=2):(Ft=n,Lt===0&&Jt(Dt)),Ft!==n?dt=mt=[mt,Rt,Ft]:(J=dt,dt=n)}else J=dt,dt=n;return dt}())===n&&(X=O()),Lt--,X===n&&Lt===0&&Jt(pe),X}function L(){var X,dt,mt,Rt,Ft,jt;if(X=J,t.substr(J,2)==="/*"?(dt="/*",J+=2):(dt=n,Lt===0&&Jt(ge)),dt!==n){for(mt=[],Rt=J,Ft=J,Lt++,t.substr(J,2)==="*/"?(jt="*/",J+=2):(jt=n,Lt===0&&Jt(Dt)),jt===n&&(jt=P()),Lt--,jt===n?Ft=void 0:(J=Ft,Ft=n),Ft!==n&&(jt=F())!==n?Rt=Ft=[Ft,jt]:(J=Rt,Rt=n);Rt!==n;)mt.push(Rt),Rt=J,Ft=J,Lt++,t.substr(J,2)==="*/"?(jt="*/",J+=2):(jt=n,Lt===0&&Jt(Dt)),jt===n&&(jt=P()),Lt--,jt===n?Ft=void 0:(J=Ft,Ft=n),Ft!==n&&(jt=F())!==n?Rt=Ft=[Ft,jt]:(J=Rt,Rt=n);t.substr(J,2)==="*/"?(Rt="*/",J+=2):(Rt=n,Lt===0&&Jt(Dt)),Rt!==n?X=dt=[dt,mt,Rt]:(J=X,X=n)}else J=X,X=n;return X}function O(){var X,dt,mt,Rt,Ft,jt;if(X=J,t.substr(J,2)==="//"?(dt="//",J+=2):(dt=n,Lt===0&&Jt(Nt)),dt!==n){for(mt=[],Rt=J,Ft=J,Lt++,jt=P(),Lt--,jt===n?Ft=void 0:(J=Ft,Ft=n),Ft!==n&&(jt=F())!==n?Rt=Ft=[Ft,jt]:(J=Rt,Rt=n);Rt!==n;)mt.push(Rt),Rt=J,Ft=J,Lt++,jt=P(),Lt--,jt===n?Ft=void 0:(J=Ft,Ft=n),Ft!==n&&(jt=F())!==n?Rt=Ft=[Ft,jt]:(J=Rt,Rt=n);X=dt=[dt,mt]}else J=X,X=n;return X}function U(){var X,dt,mt,Rt;if(Lt++,X=J,(dt=W())!==n){for(mt=[],Rt=Y();Rt!==n;)mt.push(Rt),Rt=Y();xe=X,X=[dt+mt.join(""),sr()]}else J=X,X=n;return Lt--,X===n&&(dt=n,Lt===0&&Jt(ie)),X}function W(){var X,dt,mt;return(X=function(){var Rt;return(Rt=function(){var Ft;return Z.test(t.charAt(J))?(Ft=t.charAt(J),J++):(Ft=n,Lt===0&&Jt(ye)),Ft}())===n&&(Rt=function(){var Ft;return D.test(t.charAt(J))?(Ft=t.charAt(J),J++):(Ft=n,Lt===0&&Jt(Yr)),Ft}())===n&&(Rt=function(){var Ft;return z.test(t.charAt(J))?(Ft=t.charAt(J),J++):(Ft=n,Lt===0&&Jt(se)),Ft}())===n&&(Rt=function(){var Ft;return q.test(t.charAt(J))?(Ft=t.charAt(J),J++):(Ft=n,Lt===0&&Jt(Xr)),Ft}())===n&&(Rt=function(){var Ft;return H.test(t.charAt(J))?(Ft=t.charAt(J),J++):(Ft=n,Lt===0&&Jt(sn)),Ft}())===n&&(Rt=function(){var Ft;return ot.test(t.charAt(J))?(Ft=t.charAt(J),J++):(Ft=n,Lt===0&&Jt(Zr)),Ft}()),Rt}())===n&&(t.charCodeAt(J)===36?(X="$",J++):(X=n,Lt===0&&Jt(b)),X===n&&(t.charCodeAt(J)===95?(X="_",J++):(X=n,Lt===0&&Jt(ee)),X===n&&(X=J,t.charCodeAt(J)===92?(dt="\\",J++):(dt=n,Lt===0&&Jt(Kt)),dt!==n&&(mt=it())!==n?X=mt:(J=X,X=n)))),X}function Y(){var X;return(X=W())===n&&(X=function(){var dt;return(dt=function(){var mt;return at.test(t.charAt(J))?(mt=t.charAt(J),J++):(mt=n,Lt===0&&Jt(ar)),mt}())===n&&(dt=function(){var mt;return j.test(t.charAt(J))?(mt=t.charAt(J),J++):(mt=n,Lt===0&&Jt(Re)),mt}()),dt}())===n&&(X=function(){var dt;return ct.test(t.charAt(J))?(dt=t.charAt(J),J++):(dt=n,Lt===0&&Jt(he)),dt}())===n&&(X=function(){var dt;return tt.test(t.charAt(J))?(dt=t.charAt(J),J++):(dt=n,Lt===0&&Jt(Ar)),dt}())===n&&(t.charCodeAt(J)===8204?(X="\u200C",J++):(X=n,Lt===0&&Jt(be)),X===n&&(t.charCodeAt(J)===8205?(X="\u200D",J++):(X=n,Lt===0&&Jt(v)))),X}function st(){var X,dt,mt,Rt;if(Lt++,X=J,t.charCodeAt(J)===34?(dt='"',J++):(dt=n,Lt===0&&Jt(ze)),dt!==n){for(mt=[],Rt=vt();Rt!==n;)mt.push(Rt),Rt=vt();t.charCodeAt(J)===34?(Rt='"',J++):(Rt=n,Lt===0&&Jt(ze)),Rt!==n?(xe=X,X=mt.join("")):(J=X,X=n)}else J=X,X=n;if(X===n)if(X=J,t.charCodeAt(J)===39?(dt="'",J++):(dt=n,Lt===0&&Jt(We)),dt!==n){for(mt=[],Rt=At();Rt!==n;)mt.push(Rt),Rt=At();t.charCodeAt(J)===39?(Rt="'",J++):(Rt=n,Lt===0&&Jt(We)),Rt!==n?(xe=X,X=function(Ft){return Ft.join("")}(mt)):(J=X,X=n)}else J=X,X=n;return Lt--,X===n&&(dt=n,Lt===0&&Jt(Vt)),X}function vt(){var X,dt,mt,Rt;return X=J,dt=J,mt=J,Lt++,t.charCodeAt(J)===34?(Rt='"',J++):(Rt=n,Lt===0&&Jt(ze)),Rt===n&&(t.charCodeAt(J)===92?(Rt="\\",J++):(Rt=n,Lt===0&&Jt(Kt)),Rt===n&&(Rt=P())),Lt--,Rt===n?mt=void 0:(J=mt,mt=n),mt!==n&&(Rt=F())!==n?dt=mt=[mt,Rt]:(J=dt,dt=n),(X=dt!==n?t.substring(X,J):dt)===n&&(X=J,t.charCodeAt(J)===92?(dt="\\",J++):(dt=n,Lt===0&&Jt(Kt)),dt!==n&&(mt=ut())!==n?X=mt:(J=X,X=n),X===n&&(X=Q())),X}function At(){var X,dt,mt,Rt;return X=J,dt=J,mt=J,Lt++,t.charCodeAt(J)===39?(Rt="'",J++):(Rt=n,Lt===0&&Jt(We)),Rt===n&&(t.charCodeAt(J)===92?(Rt="\\",J++):(Rt=n,Lt===0&&Jt(Kt)),Rt===n&&(Rt=P())),Lt--,Rt===n?mt=void 0:(J=mt,mt=n),mt!==n&&(Rt=F())!==n?dt=mt=[mt,Rt]:(J=dt,dt=n),(X=dt!==n?t.substring(X,J):dt)===n&&(X=J,t.charCodeAt(J)===92?(dt="\\",J++):(dt=n,Lt===0&&Jt(Kt)),dt!==n&&(mt=ut())!==n?X=mt:(J=X,X=n),X===n&&(X=Q())),X}function Mt(){var X,dt,mt,Rt,Ft,jt;return X=J,(dt=Bt())!==n?(t.charCodeAt(J)===45?(mt="-",J++):(mt=n,Lt===0&&Jt(Me)),mt!==n&&(Rt=Bt())!==n?(xe=X,jt=Rt,(Ft=dt).charCodeAt(0)>jt.charCodeAt(0)&&_n("Invalid character range: "+t.substring(xe,J)+"."),X=[Ft,jt]):(J=X,X=n)):(J=X,X=n),X}function Bt(){var X,dt,mt,Rt;return X=J,dt=J,mt=J,Lt++,t.charCodeAt(J)===93?(Rt="]",J++):(Rt=n,Lt===0&&Jt(ur)),Rt===n&&(t.charCodeAt(J)===92?(Rt="\\",J++):(Rt=n,Lt===0&&Jt(Kt)),Rt===n&&(Rt=P())),Lt--,Rt===n?mt=void 0:(J=mt,mt=n),mt!==n&&(Rt=F())!==n?dt=mt=[mt,Rt]:(J=dt,dt=n),(X=dt!==n?t.substring(X,J):dt)===n&&(X=J,t.charCodeAt(J)===92?(dt="\\",J++):(dt=n,Lt===0&&Jt(Kt)),dt!==n&&(mt=ut())!==n?X=mt:(J=X,X=n),X===n&&(X=Q())),X}function Q(){var X,dt;return X=J,t.charCodeAt(J)===92?(dt="\\",J++):(dt=n,Lt===0&&Jt(Kt)),dt!==n&&B()!==n?(xe=X,X=""):(J=X,X=n),X}function ut(){var X,dt,mt,Rt;return(X=function(){var Ft;return(Ft=pt())===n&&(Ft=function(){var jt,re,te,Et;return jt=J,re=J,te=J,Lt++,(Et=function(){var kt;return(kt=pt())===n&&(kt=bt())===n&&(t.charCodeAt(J)===120?(kt="x",J++):(kt=n,Lt===0&&Jt(Kr)),kt===n&&(t.charCodeAt(J)===117?(kt="u",J++):(kt=n,Lt===0&&Jt(tr)))),kt}())===n&&(Et=P()),Lt--,Et===n?te=void 0:(J=te,te=n),te!==n&&(Et=F())!==n?re=te=[te,Et]:(J=re,re=n),re!==n?t.substring(jt,J):re}()),Ft}())===n&&(X=J,t.charCodeAt(J)===48?(dt="0",J++):(dt=n,Lt===0&&Jt(Ke)),dt!==n?(mt=J,Lt++,Rt=bt(),Lt--,Rt===n?mt=void 0:(J=mt,mt=n),mt!==n?(xe=X,X="\0"):(J=X,X=n)):(J=X,X=n),X===n&&(X=function(){var Ft,jt,re,te,Et,kt,Tt;return Ft=J,t.charCodeAt(J)===120?(jt="x",J++):(jt=n,Lt===0&&Jt(Kr)),jt!==n?(re=J,te=J,(Et=$t())!==n&&(kt=$t())!==n?te=Et=[Et,kt]:(J=te,te=n),(re=te!==n?t.substring(re,J):te)!==n?(xe=Ft,Tt=re,Ft=String.fromCharCode(parseInt(Tt,16))):(J=Ft,Ft=n)):(J=Ft,Ft=n),Ft}())===n&&(X=it())),X}function pt(){var X,dt;return t.charCodeAt(J)===39?(X="'",J++):(X=n,Lt===0&&Jt(We)),X===n&&(t.charCodeAt(J)===34?(X='"',J++):(X=n,Lt===0&&Jt(ze)),X===n&&(t.charCodeAt(J)===92?(X="\\",J++):(X=n,Lt===0&&Jt(Kt)),X===n&&(X=J,t.charCodeAt(J)===98?(dt="b",J++):(dt=n,Lt===0&&Jt(Ir)),dt!==n&&(xe=X,dt="\b"),(X=dt)===n&&(X=J,t.charCodeAt(J)===102?(dt="f",J++):(dt=n,Lt===0&&Jt(Le)),dt!==n&&(xe=X,dt="\f"),(X=dt)===n&&(X=J,t.charCodeAt(J)===110?(dt="n",J++):(dt=n,Lt===0&&Jt(qr)),dt!==n&&(xe=X,dt=`
`),(X=dt)===n&&(X=J,t.charCodeAt(J)===114?(dt="r",J++):(dt=n,Lt===0&&Jt(hr)),dt!==n&&(xe=X,dt="\r"),(X=dt)===n&&(X=J,t.charCodeAt(J)===116?(dt="t",J++):(dt=n,Lt===0&&Jt(Sr)),dt!==n&&(xe=X,dt="	"),(X=dt)===n&&(X=J,t.charCodeAt(J)===118?(dt="v",J++):(dt=n,Lt===0&&Jt(Jr)),dt!==n&&(xe=X,dt="\v"),X=dt)))))))),X}function it(){var X,dt,mt,Rt,Ft,jt,re,te,Et;return X=J,t.charCodeAt(J)===117?(dt="u",J++):(dt=n,Lt===0&&Jt(tr)),dt!==n?(mt=J,Rt=J,(Ft=$t())!==n&&(jt=$t())!==n&&(re=$t())!==n&&(te=$t())!==n?Rt=Ft=[Ft,jt,re,te]:(J=Rt,Rt=n),(mt=Rt!==n?t.substring(mt,J):Rt)!==n?(xe=X,Et=mt,X=String.fromCharCode(parseInt(Et,16))):(J=X,X=n)):(J=X,X=n),X}function bt(){var X;return y.test(t.charAt(J))?(X=t.charAt(J),J++):(X=n,Lt===0&&Jt(Xe)),X}function $t(){var X;return k.test(t.charAt(J))?(X=t.charAt(J),J++):(X=n,Lt===0&&Jt(Qe)),X}function Wt(){var X,dt,mt,Rt;return Lt++,X=J,t.charCodeAt(J)===123?(dt="{",J++):(dt=n,Lt===0&&Jt(wt)),dt!==n?(mt=function(){var Ft,jt;return Ft=J,jt=function re(){var te,Et,kt,Tt,Qt,le;if(te=J,Et=[],kt=[],Tt=J,Qt=J,Lt++,A.test(t.charAt(J))?(le=t.charAt(J),J++):(le=n,Lt===0&&Jt(Vr)),Lt--,le===n?Qt=void 0:(J=Qt,Qt=n),Qt!==n&&(le=F())!==n?Tt=Qt=[Qt,le]:(J=Tt,Tt=n),Tt!==n)for(;Tt!==n;)kt.push(Tt),Tt=J,Qt=J,Lt++,A.test(t.charAt(J))?(le=t.charAt(J),J++):(le=n,Lt===0&&Jt(Vr)),Lt--,le===n?Qt=void 0:(J=Qt,Qt=n),Qt!==n&&(le=F())!==n?Tt=Qt=[Qt,le]:(J=Tt,Tt=n);else kt=n;for(kt===n&&(kt=J,t.charCodeAt(J)===123?(Tt="{",J++):(Tt=n,Lt===0&&Jt(wt)),Tt!==n?(Qt=re(),t.charCodeAt(J)===125?(le="}",J++):(le=n,Lt===0&&Jt(ft)),le!==n?kt=Tt=[Tt,Qt,le]:(J=kt,kt=n)):(J=kt,kt=n));kt!==n;){if(Et.push(kt),kt=[],Tt=J,Qt=J,Lt++,A.test(t.charAt(J))?(le=t.charAt(J),J++):(le=n,Lt===0&&Jt(Vr)),Lt--,le===n?Qt=void 0:(J=Qt,Qt=n),Qt!==n&&(le=F())!==n?Tt=Qt=[Qt,le]:(J=Tt,Tt=n),Tt!==n)for(;Tt!==n;)kt.push(Tt),Tt=J,Qt=J,Lt++,A.test(t.charAt(J))?(le=t.charAt(J),J++):(le=n,Lt===0&&Jt(Vr)),Lt--,le===n?Qt=void 0:(J=Qt,Qt=n),Qt!==n&&(le=F())!==n?Tt=Qt=[Qt,le]:(J=Tt,Tt=n);else kt=n;kt===n&&(kt=J,t.charCodeAt(J)===123?(Tt="{",J++):(Tt=n,Lt===0&&Jt(wt)),Tt!==n?(Qt=re(),t.charCodeAt(J)===125?(le="}",J++):(le=n,Lt===0&&Jt(ft)),le!==n?kt=Tt=[Tt,Qt,le]:(J=kt,kt=n)):(J=kt,kt=n))}return t.substring(te,J)}(),xe=Ft,jt=function(re){return[re,sr()]}(jt)}(),t.charCodeAt(J)===125?(Rt="}",J++):(Rt=n,Lt===0&&Jt(ft)),Rt!==n?X=mt:(J=X,X=n)):(J=X,X=n),Lt--,X===n&&(dt=n,Lt===0&&Jt(Gr)),X}function Ht(){var X,dt;for(X=[],(dt=R())===n&&(dt=B())===n&&(dt=K());dt!==n;)X.push(dt),(dt=R())===n&&(dt=B())===n&&(dt=K());return X}function Se(){var X,dt,mt,Rt;return X=J,dt=Ht(),t.charCodeAt(J)===59?(mt=";",J++):(mt=n,Lt===0&&Jt(or)),mt!==n?X=dt=[dt,mt]:(J=X,X=n),X===n&&(X=J,dt=function(){var Ft,jt;for(Ft=[],(jt=R())===n&&(jt=L());jt!==n;)Ft.push(jt),(jt=R())===n&&(jt=L());return Ft}(),(mt=O())===n&&(mt=null),(Rt=B())!==n?X=dt=[dt,mt,Rt]:(J=X,X=n),X===n&&(X=J,dt=Ht(),(mt=function(){var Ft,jt;return Ft=J,Lt++,t.length>J?(jt=t.charAt(J),J++):(jt=n,Lt===0&&Jt(N)),Lt--,jt===n?Ft=void 0:(J=Ft,Ft=n),Ft}())!==n?X=dt=[dt,mt]:(J=X,X=n))),X}const zt=e.reservedWords||[];if((r=d())!==n&&J===t.length)return r;throw r!==n&&J<t.length&&Jt({type:"end"}),function(X,dt,mt){return new peg$SyntaxError(peg$SyntaxError.buildMessage(X,dt),X,dt,mt)}(Ge,gr<t.length?t.charAt(gr):null,gr<t.length?Te(gr,gr+1):Te(gr,gr))}};const peg={VERSION:_$version_74,RESERVED_WORDS:["break","case","catch","class","const","continue","debugger","default","delete","do","else","export","extends","finally","for","function","if","import","in","instanceof","new","return","super","switch","this","throw","try","typeof","var","void","while","with","null","true","false","enum","implements","interface","let","package","private","protected","public","static","yield","await"],GrammarError:_$GrammarError_71,parser:_$parser_72,compiler:_$compiler_55,generate(t,e){const r="plugins"in(e=e!==void 0?e:{})?e.plugins:[],n={parser:peg.parser,passes:function(o){const f={};return Object.keys(o).forEach(d=>{f[d]=o[d].slice()}),f}(peg.compiler.passes),reservedWords:peg.RESERVED_WORDS.slice()};return r.forEach(o=>{o.use(n,e)}),peg.compiler.compile(n.parser.parse(t,{grammarSource:e.grammarSource,reservedWords:n.reservedWords}),n.passes,e)}};var _$peg_73=peg,_$surge_92={};function ___typeof_92(t){return(___typeof_92=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$surge_92,"__esModule",{value:!0}),_$surge_92.default=function(){return __parser_92||(__parser_92=peggy.generate(grammars)),__parser_92};var _templateObject,peggy=function(t,e){if(t&&t.__esModule)return t;if(t===null||___typeof_92(t)!=="object"&&typeof t!="function")return{default:t};var r=___getRequireWildcardCache_92(void 0);if(r&&r.has(t))return r.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var d=o?Object.getOwnPropertyDescriptor(t,f):null;d&&(d.get||d.set)?Object.defineProperty(n,f,d):n[f]=t[f]}return n.default=t,r&&r.set(t,n),n}(_$peg_73);function ___getRequireWildcardCache_92(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(___getRequireWildcardCache_92=function(n){return n?r:e})(t)}var strings,raw,__parser_92,grammars=String.raw(_templateObject||(strings=[`
// global initializer
{{
    function $set(obj, path, value) {
      if (Object(obj) !== obj) return obj;
      if (!Array.isArray(path)) path = path.toString().match(/[^.[]]+/g) || [];
      path
        .slice(0, -1)
        .reduce((a, c, i) => (Object(a[c]) === a[c] ? a[c] : (a[c] = Math.abs(path[i + 1]) >> 0 === +path[i + 1] ? [] : {})), obj)[
        path[path.length - 1]
      ] = value;
      return obj;
    }
}}

// per-parser initializer
{
    const proxy = {};
    const obfs = {};
    const $ = {};

    function handleWebsocket() {
        if (obfs.type === "ws") {
            proxy.network = "ws";
            $set(proxy, "ws-opts.path", obfs.path);
            $set(proxy, "ws-opts.headers", obfs['ws-headers']);
            if (proxy['ws-opts'] && proxy['ws-opts']['headers'] && proxy['ws-opts']['headers'].Host) {
                proxy['ws-opts']['headers'].Host = proxy['ws-opts']['headers'].Host.replace(/^"(.*)"$/, '$1')
            }
        }
    }
    function handleShadowTLS() {
        if (proxy['shadow-tls-password'] && !proxy['shadow-tls-version']) {
            proxy['shadow-tls-version'] = 2;
        }
    }
}

start = (shadowsocks/vmess/trojan/https/http/snell/socks5/socks5_tls/tuic/tuic_v5/wireguard/hysteria2/ssh/direct) {
    return proxy;
}

shadowsocks = tag equals "ss" address (method/passwordk/obfs/obfs_host/obfs_uri/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/udp_relay/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/udp_port/others)* {
    proxy.type = "ss";
    // handle obfs
    if (obfs.type == "http" || obfs.type === "tls") {
        proxy.plugin = "obfs";
        $set(proxy, "plugin-opts.mode", obfs.type);
        $set(proxy, "plugin-opts.host", obfs.host);
        $set(proxy, "plugin-opts.path", obfs.path);
    }
    handleShadowTLS();
}
vmess = tag equals "vmess" address (vmess_uuid/vmess_aead/ws/ws_path/ws_headers/method/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/tls/sni/tls_fingerprint/tls_verification/fast_open/udp_relay/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "vmess";
    proxy.cipher = proxy.cipher || "none";
    if (proxy.aead) {
        proxy.alterId = 0;
    } else {
        proxy.alterId = proxy.alterId || 0;
    }
    handleWebsocket();
    handleShadowTLS();
}
trojan = tag equals "trojan" address (passwordk/ws/ws_path/ws_headers/tls/sni/tls_fingerprint/tls_verification/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/udp_relay/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "trojan";
    handleWebsocket();
    handleShadowTLS();
}
https = tag equals "https" address (username password)? (usernamek passwordk)? (sni/tls_fingerprint/tls_verification/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "http";
    proxy.tls = true;
    handleShadowTLS();
}
http = tag equals "http" address (username password)? (usernamek passwordk)? (ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "http";
    handleShadowTLS();
}
ssh = tag equals "ssh" address (username password)? (usernamek passwordk)? (server_fingerprint/idle_timeout/private_key/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "ssh";
    handleShadowTLS();
}
snell = tag equals "snell" address (snell_version/snell_psk/obfs/obfs_host/obfs_uri/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/udp_relay/reuse/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "snell";
    // handle obfs
    if (obfs.type == "http" || obfs.type === "tls") {
        $set(proxy, "obfs-opts.mode", obfs.type);
        $set(proxy, "obfs-opts.host", obfs.host);
        $set(proxy, "obfs-opts.path", obfs.path);
    }
    handleShadowTLS();
}
tuic = tag equals "tuic" address (alpn/token/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/tls_fingerprint/tls_verification/sni/fast_open/tfo/ecn/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/port_hopping_interval/others)* {
    proxy.type = "tuic";
    handleShadowTLS();
}
tuic_v5 = tag equals "tuic-v5" address (alpn/passwordk/uuidk/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/tls_fingerprint/tls_verification/sni/fast_open/tfo/ecn/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/port_hopping_interval/others)* {
    proxy.type = "tuic";
    proxy.version = 5;
    handleShadowTLS();
}
wireguard = tag equals "wireguard" (section_name/no_error_alert/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "wireguard-surge";
    handleShadowTLS();
}
hysteria2 = tag equals "hysteria2" address (no_error_alert/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/sni/tls_verification/passwordk/tls_fingerprint/download_bandwidth/ecn/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/port_hopping_interval/others)* {
    proxy.type = "hysteria2";
    handleShadowTLS();
}
socks5 = tag equals "socks5" address (username password)? (usernamek passwordk)? (udp_relay/no_error_alert/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "socks5";
    handleShadowTLS();
}
socks5_tls = tag equals "socks5-tls" address (username password)? (usernamek passwordk)? (udp_relay/no_error_alert/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/sni/tls_fingerprint/tls_verification/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "socks5";
    proxy.tls = true;
    handleShadowTLS();
}
direct = tag equals "direct" (udp_relay/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/block_quic/others)* {
    proxy.type = "direct";
}
address = comma server:server comma port:port {
    proxy.server = server;
    proxy.port = port;
}

server = ip/domain

ip = & {
    const start = peg$currPos;
    let j = start;
    while (j < input.length) {
        if (input[j] === ",") break;
        j++;
    }
    peg$currPos = j;
    $.ip = input.substring(start, j).trim();
    return true;
} { return $.ip; }

domain = match:[0-9a-zA-z-_.]+ { 
    const domain = match.join(""); 
    if (/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/.test(domain)) {
        return domain;
    }
}

port = digits:[0-9]+ { 
    const port = parseInt(digits.join(""), 10); 
    if (port >= 0 && port <= 65535) {
    	return port;
    }
}

port_hopping_interval = comma "port-hopping-interval" equals match:$[0-9]+ { proxy["hop-interval"] = parseInt(match.trim()); }

username = & {
    let j = peg$currPos; 
    let start, end;
    let first = true;
    while (j < input.length) {
        if (input[j] === ',') {
            if (first) {
                start = j + 1;
                first = false;
            } else {
                end = j;
                break;
            }
        }
        j++;
    }
    const match = input.substring(start, end);
    if (match.indexOf("=") === -1) {
        $.username = match;
        peg$currPos = end;
        return true;
    }
} { proxy.username = $.username; }
password = comma match:[^,]+ { proxy.password = match.join(""); }

tls = comma "tls" equals flag:bool { proxy.tls = flag; }
sni = comma "sni" equals sni:("off"/domain) { 
    if (sni === "off") {
        proxy["disable-sni"] = true;
    } else {
        proxy.sni = sni;
    }
}
tls_verification = comma "skip-cert-verify" equals flag:bool { proxy["skip-cert-verify"] = flag; }
tls_fingerprint = comma "server-cert-fingerprint-sha256" equals tls_fingerprint:$[^,]+ { proxy["tls-fingerprint"] = tls_fingerprint.trim(); }

snell_psk = comma "psk" equals match:[^,]+ { proxy.psk = match.join(""); }
snell_version = comma "version" equals match:$[0-9]+ { proxy.version = parseInt(match.trim()); }

usernamek = comma "username" equals match:[^,]+ { proxy.username = match.join(""); }
passwordk = comma "password" equals match:[^,]+ { proxy.password = match.join("").replace(/^"(.*?)"$/, '$1').replace(/^'(.*?)'$/, '$1'); }
vmess_uuid = comma "username" equals match:[^,]+ { proxy.uuid = match.join(""); }
vmess_aead = comma "vmess-aead" equals flag:bool { proxy.aead = flag; }

method = comma "encrypt-method" equals cipher:cipher {
    proxy.cipher = cipher;
}
cipher = ("aes-128-cfb"/"aes-128-ctr"/"aes-128-gcm"/"aes-192-cfb"/"aes-192-ctr"/"aes-192-gcm"/"aes-256-cfb"/"aes-256-ctr"/"aes-256-gcm"/"bf-cfb"/"camellia-128-cfb"/"camellia-192-cfb"/"camellia-256-cfb"/"cast5-cfb"/"chacha20-ietf-poly1305"/"chacha20-ietf"/"chacha20-poly1305"/"chacha20"/"des-cfb"/"idea-cfb"/"none"/"rc2-cfb"/"rc4-md5"/"rc4"/"salsa20"/"seed-cfb"/"xchacha20-ietf-poly1305"/"2022-blake3-aes-128-gcm"/"2022-blake3-aes-256-gcm");

ws = comma "ws" equals flag:bool { obfs.type = "ws"; }
ws_headers = comma "ws-headers" equals headers:$[^,]+ {
    const pairs = headers.split("|");
    const result = {};
    pairs.forEach(pair => {
        const [key, value] = pair.trim().split(":");
        result[key.trim()] = value.trim();
    })
    obfs["ws-headers"] = result;
}
ws_path = comma "ws-path" equals path:uri { obfs.path = path; }

obfs = comma "obfs" equals type:("http"/"tls") { obfs.type = type; }
obfs_host = comma "obfs-host" equals host:domain { obfs.host = host; };
obfs_uri = comma "obfs-uri" equals path:uri { obfs.path = path }
uri = $[^,]+

udp_relay = comma "udp-relay" equals flag:bool { proxy.udp = flag; }
fast_open = comma "fast-open" equals flag:bool { proxy.tfo = flag; }
reuse = comma "reuse" equals flag:bool { proxy.reuse = flag; }
ecn = comma "ecn" equals flag:bool { proxy.ecn = flag; }
tfo = comma "tfo" equals flag:bool { proxy.tfo = flag; }
ip_version = comma "ip-version" equals match:[^,]+ { proxy["ip-version"] = match.join(""); }
section_name = comma "section-name" equals match:[^,]+ { proxy["section-name"] = match.join(""); }
no_error_alert = comma "no-error-alert" equals match:[^,]+ { proxy["no-error-alert"] = match.join(""); }
underlying_proxy = comma "underlying-proxy" equals match:[^,]+ { proxy["underlying-proxy"] = match.join(""); }
download_bandwidth = comma "download-bandwidth" equals match:[^,]+ { proxy.down = match.join(""); }
test_url = comma "test-url" equals match:[^,]+ { proxy["test-url"] = match.join(""); }
test_udp = comma "test-udp" equals match:[^,]+ { proxy["test-udp"] = match.join(""); }
test_timeout = comma "test-timeout" equals match:$[0-9]+ { proxy["test-timeout"] = parseInt(match.trim()); }
tos = comma "tos" equals match:$[0-9]+ { proxy.tos = parseInt(match.trim()); }
interface = comma "interface" equals match:[^,]+ { proxy.interface = match.join(""); }
allow_other_interface = comma "allow-other-interface" equals flag:bool { proxy["allow-other-interface"] = flag; }
hybrid = comma "hybrid" equals flag:bool { proxy.hybrid = flag; }
idle_timeout = comma "idle-timeout" equals match:$[0-9]+ { proxy["idle-timeout"] = parseInt(match.trim()); }
private_key = comma "private-key" equals match:[^,]+ { proxy["keystore-private-key"] = match.join("").replace(/^"(.*)"$/, '$1'); }
server_fingerprint = comma "server-fingerprint" equals match:[^,]+ { proxy["server-fingerprint"] = match.join("").replace(/^"(.*)"$/, '$1'); }
block_quic = comma "block-quic" equals match:[^,]+ { proxy["block-quic"] = match.join(""); }
udp_port = comma "udp-port" equals match:$[0-9]+ { proxy["udp-port"] = parseInt(match.trim()); }
shadow_tls_version = comma "shadow-tls-version" equals match:$[0-9]+ { proxy["shadow-tls-version"] = parseInt(match.trim()); }
shadow_tls_sni = comma "shadow-tls-sni" equals match:[^,]+ { proxy["shadow-tls-sni"] = match.join(""); }
shadow_tls_password = comma "shadow-tls-password" equals match:[^,]+ { proxy["shadow-tls-password"] = match.join(""); }
token = comma "token" equals match:[^,]+ { proxy.token = match.join(""); }
alpn = comma "alpn" equals match:[^,]+ { proxy.alpn = match.join(""); }
uuidk = comma "uuid" equals match:[^,]+ { proxy.uuid = match.join(""); }

tag = match:[^=,]* { proxy.name = match.join("").trim(); }
comma = _ "," _
equals = _ "=" _
_ = [ \r	]*
bool = b:("true"/"false") { return b === "true" }
others = comma [^=,]+ equals [^=,]+
`],(raw=[`
// global initializer
{{
    function $set(obj, path, value) {
      if (Object(obj) !== obj) return obj;
      if (!Array.isArray(path)) path = path.toString().match(/[^.[\\]]+/g) || [];
      path
        .slice(0, -1)
        .reduce((a, c, i) => (Object(a[c]) === a[c] ? a[c] : (a[c] = Math.abs(path[i + 1]) >> 0 === +path[i + 1] ? [] : {})), obj)[
        path[path.length - 1]
      ] = value;
      return obj;
    }
}}

// per-parser initializer
{
    const proxy = {};
    const obfs = {};
    const $ = {};

    function handleWebsocket() {
        if (obfs.type === "ws") {
            proxy.network = "ws";
            $set(proxy, "ws-opts.path", obfs.path);
            $set(proxy, "ws-opts.headers", obfs['ws-headers']);
            if (proxy['ws-opts'] && proxy['ws-opts']['headers'] && proxy['ws-opts']['headers'].Host) {
                proxy['ws-opts']['headers'].Host = proxy['ws-opts']['headers'].Host.replace(/^"(.*)"$/, '$1')
            }
        }
    }
    function handleShadowTLS() {
        if (proxy['shadow-tls-password'] && !proxy['shadow-tls-version']) {
            proxy['shadow-tls-version'] = 2;
        }
    }
}

start = (shadowsocks/vmess/trojan/https/http/snell/socks5/socks5_tls/tuic/tuic_v5/wireguard/hysteria2/ssh/direct) {
    return proxy;
}

shadowsocks = tag equals "ss" address (method/passwordk/obfs/obfs_host/obfs_uri/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/udp_relay/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/udp_port/others)* {
    proxy.type = "ss";
    // handle obfs
    if (obfs.type == "http" || obfs.type === "tls") {
        proxy.plugin = "obfs";
        $set(proxy, "plugin-opts.mode", obfs.type);
        $set(proxy, "plugin-opts.host", obfs.host);
        $set(proxy, "plugin-opts.path", obfs.path);
    }
    handleShadowTLS();
}
vmess = tag equals "vmess" address (vmess_uuid/vmess_aead/ws/ws_path/ws_headers/method/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/tls/sni/tls_fingerprint/tls_verification/fast_open/udp_relay/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "vmess";
    proxy.cipher = proxy.cipher || "none";
    if (proxy.aead) {
        proxy.alterId = 0;
    } else {
        proxy.alterId = proxy.alterId || 0;
    }
    handleWebsocket();
    handleShadowTLS();
}
trojan = tag equals "trojan" address (passwordk/ws/ws_path/ws_headers/tls/sni/tls_fingerprint/tls_verification/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/udp_relay/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "trojan";
    handleWebsocket();
    handleShadowTLS();
}
https = tag equals "https" address (username password)? (usernamek passwordk)? (sni/tls_fingerprint/tls_verification/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "http";
    proxy.tls = true;
    handleShadowTLS();
}
http = tag equals "http" address (username password)? (usernamek passwordk)? (ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "http";
    handleShadowTLS();
}
ssh = tag equals "ssh" address (username password)? (usernamek passwordk)? (server_fingerprint/idle_timeout/private_key/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "ssh";
    handleShadowTLS();
}
snell = tag equals "snell" address (snell_version/snell_psk/obfs/obfs_host/obfs_uri/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/udp_relay/reuse/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "snell";
    // handle obfs
    if (obfs.type == "http" || obfs.type === "tls") {
        $set(proxy, "obfs-opts.mode", obfs.type);
        $set(proxy, "obfs-opts.host", obfs.host);
        $set(proxy, "obfs-opts.path", obfs.path);
    }
    handleShadowTLS();
}
tuic = tag equals "tuic" address (alpn/token/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/tls_fingerprint/tls_verification/sni/fast_open/tfo/ecn/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/port_hopping_interval/others)* {
    proxy.type = "tuic";
    handleShadowTLS();
}
tuic_v5 = tag equals "tuic-v5" address (alpn/passwordk/uuidk/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/tls_fingerprint/tls_verification/sni/fast_open/tfo/ecn/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/port_hopping_interval/others)* {
    proxy.type = "tuic";
    proxy.version = 5;
    handleShadowTLS();
}
wireguard = tag equals "wireguard" (section_name/no_error_alert/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "wireguard-surge";
    handleShadowTLS();
}
hysteria2 = tag equals "hysteria2" address (no_error_alert/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/sni/tls_verification/passwordk/tls_fingerprint/download_bandwidth/ecn/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/port_hopping_interval/others)* {
    proxy.type = "hysteria2";
    handleShadowTLS();
}
socks5 = tag equals "socks5" address (username password)? (usernamek passwordk)? (udp_relay/no_error_alert/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "socks5";
    handleShadowTLS();
}
socks5_tls = tag equals "socks5-tls" address (username password)? (usernamek passwordk)? (udp_relay/no_error_alert/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/sni/tls_fingerprint/tls_verification/fast_open/shadow_tls_version/shadow_tls_sni/shadow_tls_password/block_quic/others)* {
    proxy.type = "socks5";
    proxy.tls = true;
    handleShadowTLS();
}
direct = tag equals "direct" (udp_relay/ip_version/underlying_proxy/tos/allow_other_interface/interface/test_url/test_udp/test_timeout/hybrid/no_error_alert/fast_open/block_quic/others)* {
    proxy.type = "direct";
}
address = comma server:server comma port:port {
    proxy.server = server;
    proxy.port = port;
}

server = ip/domain

ip = & {
    const start = peg$currPos;
    let j = start;
    while (j < input.length) {
        if (input[j] === ",") break;
        j++;
    }
    peg$currPos = j;
    $.ip = input.substring(start, j).trim();
    return true;
} { return $.ip; }

domain = match:[0-9a-zA-z-_.]+ { 
    const domain = match.join(""); 
    if (/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/.test(domain)) {
        return domain;
    }
}

port = digits:[0-9]+ { 
    const port = parseInt(digits.join(""), 10); 
    if (port >= 0 && port <= 65535) {
    	return port;
    }
}

port_hopping_interval = comma "port-hopping-interval" equals match:$[0-9]+ { proxy["hop-interval"] = parseInt(match.trim()); }

username = & {
    let j = peg$currPos; 
    let start, end;
    let first = true;
    while (j < input.length) {
        if (input[j] === ',') {
            if (first) {
                start = j + 1;
                first = false;
            } else {
                end = j;
                break;
            }
        }
        j++;
    }
    const match = input.substring(start, end);
    if (match.indexOf("=") === -1) {
        $.username = match;
        peg$currPos = end;
        return true;
    }
} { proxy.username = $.username; }
password = comma match:[^,]+ { proxy.password = match.join(""); }

tls = comma "tls" equals flag:bool { proxy.tls = flag; }
sni = comma "sni" equals sni:("off"/domain) { 
    if (sni === "off") {
        proxy["disable-sni"] = true;
    } else {
        proxy.sni = sni;
    }
}
tls_verification = comma "skip-cert-verify" equals flag:bool { proxy["skip-cert-verify"] = flag; }
tls_fingerprint = comma "server-cert-fingerprint-sha256" equals tls_fingerprint:$[^,]+ { proxy["tls-fingerprint"] = tls_fingerprint.trim(); }

snell_psk = comma "psk" equals match:[^,]+ { proxy.psk = match.join(""); }
snell_version = comma "version" equals match:$[0-9]+ { proxy.version = parseInt(match.trim()); }

usernamek = comma "username" equals match:[^,]+ { proxy.username = match.join(""); }
passwordk = comma "password" equals match:[^,]+ { proxy.password = match.join("").replace(/^"(.*?)"$/, '$1').replace(/^'(.*?)'$/, '$1'); }
vmess_uuid = comma "username" equals match:[^,]+ { proxy.uuid = match.join(""); }
vmess_aead = comma "vmess-aead" equals flag:bool { proxy.aead = flag; }

method = comma "encrypt-method" equals cipher:cipher {
    proxy.cipher = cipher;
}
cipher = ("aes-128-cfb"/"aes-128-ctr"/"aes-128-gcm"/"aes-192-cfb"/"aes-192-ctr"/"aes-192-gcm"/"aes-256-cfb"/"aes-256-ctr"/"aes-256-gcm"/"bf-cfb"/"camellia-128-cfb"/"camellia-192-cfb"/"camellia-256-cfb"/"cast5-cfb"/"chacha20-ietf-poly1305"/"chacha20-ietf"/"chacha20-poly1305"/"chacha20"/"des-cfb"/"idea-cfb"/"none"/"rc2-cfb"/"rc4-md5"/"rc4"/"salsa20"/"seed-cfb"/"xchacha20-ietf-poly1305"/"2022-blake3-aes-128-gcm"/"2022-blake3-aes-256-gcm");

ws = comma "ws" equals flag:bool { obfs.type = "ws"; }
ws_headers = comma "ws-headers" equals headers:$[^,]+ {
    const pairs = headers.split("|");
    const result = {};
    pairs.forEach(pair => {
        const [key, value] = pair.trim().split(":");
        result[key.trim()] = value.trim();
    })
    obfs["ws-headers"] = result;
}
ws_path = comma "ws-path" equals path:uri { obfs.path = path; }

obfs = comma "obfs" equals type:("http"/"tls") { obfs.type = type; }
obfs_host = comma "obfs-host" equals host:domain { obfs.host = host; };
obfs_uri = comma "obfs-uri" equals path:uri { obfs.path = path }
uri = $[^,]+

udp_relay = comma "udp-relay" equals flag:bool { proxy.udp = flag; }
fast_open = comma "fast-open" equals flag:bool { proxy.tfo = flag; }
reuse = comma "reuse" equals flag:bool { proxy.reuse = flag; }
ecn = comma "ecn" equals flag:bool { proxy.ecn = flag; }
tfo = comma "tfo" equals flag:bool { proxy.tfo = flag; }
ip_version = comma "ip-version" equals match:[^,]+ { proxy["ip-version"] = match.join(""); }
section_name = comma "section-name" equals match:[^,]+ { proxy["section-name"] = match.join(""); }
no_error_alert = comma "no-error-alert" equals match:[^,]+ { proxy["no-error-alert"] = match.join(""); }
underlying_proxy = comma "underlying-proxy" equals match:[^,]+ { proxy["underlying-proxy"] = match.join(""); }
download_bandwidth = comma "download-bandwidth" equals match:[^,]+ { proxy.down = match.join(""); }
test_url = comma "test-url" equals match:[^,]+ { proxy["test-url"] = match.join(""); }
test_udp = comma "test-udp" equals match:[^,]+ { proxy["test-udp"] = match.join(""); }
test_timeout = comma "test-timeout" equals match:$[0-9]+ { proxy["test-timeout"] = parseInt(match.trim()); }
tos = comma "tos" equals match:$[0-9]+ { proxy.tos = parseInt(match.trim()); }
interface = comma "interface" equals match:[^,]+ { proxy.interface = match.join(""); }
allow_other_interface = comma "allow-other-interface" equals flag:bool { proxy["allow-other-interface"] = flag; }
hybrid = comma "hybrid" equals flag:bool { proxy.hybrid = flag; }
idle_timeout = comma "idle-timeout" equals match:$[0-9]+ { proxy["idle-timeout"] = parseInt(match.trim()); }
private_key = comma "private-key" equals match:[^,]+ { proxy["keystore-private-key"] = match.join("").replace(/^"(.*)"$/, '$1'); }
server_fingerprint = comma "server-fingerprint" equals match:[^,]+ { proxy["server-fingerprint"] = match.join("").replace(/^"(.*)"$/, '$1'); }
block_quic = comma "block-quic" equals match:[^,]+ { proxy["block-quic"] = match.join(""); }
udp_port = comma "udp-port" equals match:$[0-9]+ { proxy["udp-port"] = parseInt(match.trim()); }
shadow_tls_version = comma "shadow-tls-version" equals match:$[0-9]+ { proxy["shadow-tls-version"] = parseInt(match.trim()); }
shadow_tls_sni = comma "shadow-tls-sni" equals match:[^,]+ { proxy["shadow-tls-sni"] = match.join(""); }
shadow_tls_password = comma "shadow-tls-password" equals match:[^,]+ { proxy["shadow-tls-password"] = match.join(""); }
token = comma "token" equals match:[^,]+ { proxy.token = match.join(""); }
alpn = comma "alpn" equals match:[^,]+ { proxy.alpn = match.join(""); }
uuidk = comma "uuid" equals match:[^,]+ { proxy.uuid = match.join(""); }

tag = match:[^=,]* { proxy.name = match.join("").trim(); }
comma = _ "," _
equals = _ "=" _
_ = [ \\r\\t]*
bool = b:("true"/"false") { return b === "true" }
others = comma [^=,]+ equals [^=,]+
`])||(raw=strings.slice(0)),_templateObject=Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}})))),_$loon_90={};function ___typeof_90(t){return(___typeof_90=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$loon_90,"__esModule",{value:!0}),_$loon_90.default=function(){return __parser_90||(__parser_90=__peggy_90.generate(__grammars_90)),__parser_90};var ___templateObject_90,__peggy_90=function(t,e){if(t&&t.__esModule)return t;if(t===null||___typeof_90(t)!=="object"&&typeof t!="function")return{default:t};var r=___getRequireWildcardCache_90(void 0);if(r&&r.has(t))return r.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var d=o?Object.getOwnPropertyDescriptor(t,f):null;d&&(d.get||d.set)?Object.defineProperty(n,f,d):n[f]=t[f]}return n.default=t,r&&r.set(t,n),n}(_$peg_73);function ___getRequireWildcardCache_90(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(___getRequireWildcardCache_90=function(n){return n?r:e})(t)}var __strings_90,__raw_90,__parser_90,__grammars_90=String.raw(___templateObject_90||(__strings_90=[`
// global initializer
{{
    function $set(obj, path, value) {
      if (Object(obj) !== obj) return obj;
      if (!Array.isArray(path)) path = path.toString().match(/[^.[]]+/g) || [];
      path
        .slice(0, -1)
        .reduce((a, c, i) => (Object(a[c]) === a[c] ? a[c] : (a[c] = Math.abs(path[i + 1]) >> 0 === +path[i + 1] ? [] : {})), obj)[
        path[path.length - 1]
      ] = value;
      return obj;
    }
}}

// per-parser initializer
{
    const proxy = {};
    const obfs = {};
    const transport = {};
    const $ = {};

    function handleTransport() {
        if (transport.type === "tcp") { /* do nothing */ }
        else if (transport.type === "ws") {
            proxy.network = "ws";
            $set(proxy, "ws-opts.path", transport.path);
            $set(proxy, "ws-opts.headers.Host", transport.host);
        } else if (transport.type === "http") {
            proxy.network = "http";
            $set(proxy, "http-opts.path", transport.path);
            $set(proxy, "http-opts.headers.Host", transport.host);
        }
    }
}

start = (shadowsocksr/shadowsocks/vmess/vless/trojan/https/http/socks5/hysteria2) {
    return proxy;
}

shadowsocksr = tag equals "shadowsocksr"i address method password (ssr_protocol/ssr_protocol_param/obfs_ssr/obfs_ssr_param/obfs_host/obfs_uri/fast_open/udp_relay/others)*{
    proxy.type = "ssr";
    // handle ssr obfs
    proxy.obfs = obfs.type;
}
shadowsocks = tag equals "shadowsocks"i address method password (obfs_typev obfs_hostv)? (obfs_ss/obfs_host/obfs_uri/fast_open/udp_relay/others)* {
    proxy.type = "ss";
    // handle ss obfs
    if (obfs.type == "http" || obfs.type === "tls") {
        proxy.plugin = "obfs";
        $set(proxy, "plugin-opts.mode", obfs.type);
        $set(proxy, "plugin-opts.host", obfs.host);
        $set(proxy, "plugin-opts.path", obfs.path);
    }
}
vmess = tag equals "vmess"i address method uuid (transport/transport_host/transport_path/over_tls/tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/vmess_alterId/fast_open/udp_relay/others)* {
    proxy.type = "vmess";
    proxy.cipher = proxy.cipher || "none";
    proxy.alterId = proxy.alterId || 0;
    handleTransport();
}
vless = tag equals "vless"i address uuid (transport/transport_host/transport_path/over_tls/tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/fast_open/udp_relay/others)* {
    proxy.type = "vless";
    handleTransport();
}
trojan = tag equals "trojan"i address password (transport/transport_host/transport_path/over_tls/tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/fast_open/udp_relay/others)* {
    proxy.type = "trojan";
    handleTransport();
}
hysteria2 = tag equals "hysteria2"i address password (tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/udp_relay/fast_open/download_bandwidth/salamander_password/ecn/others)* {
    proxy.type = "hysteria2";
}
https = tag equals "https"i address (username password)? (tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/fast_open/udp_relay/others)* {
    proxy.type = "http";
    proxy.tls = true;
}
http = tag equals "http"i address (username password)? (fast_open/udp_relay/others)* {
    proxy.type = "http";
}
socks5 = tag equals "socks5"i address (username password)? (over_tls/tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/fast_open/udp_relay/others)* {
    proxy.type = "socks5";
}

address = comma server:server comma port:port {
    proxy.server = server;
    proxy.port = port;
}

server = ip/domain

ip = & {
    const start = peg$currPos;
    let j = start;
    while (j < input.length) {
        if (input[j] === ",") break;
        j++;
    }
    peg$currPos = j;
    $.ip = input.substring(start, j).trim();
    return true;
} { return $.ip; }

domain = match:[0-9a-zA-z-_.]+ { 
    const domain = match.join(""); 
    if (/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/.test(domain)) {
        return domain;
    }
    throw new Error("Invalid domain: " + domain);
}

port = digits:[0-9]+ { 
    const port = parseInt(digits.join(""), 10); 
    if (port >= 0 && port <= 65535) {
    	return port;
    }
    throw new Error("Invalid port number: " + port);
}

method = comma cipher:cipher { 
    proxy.cipher = cipher;
}
cipher = ("aes-128-cfb"/"aes-128-ctr"/"aes-128-gcm"/"aes-192-cfb"/"aes-192-ctr"/"aes-192-gcm"/"aes-256-cfb"/"aes-256-ctr"/"aes-256-gcm"/"auto"/"bf-cfb"/"camellia-128-cfb"/"camellia-192-cfb"/"camellia-256-cfb"/"chacha20-ietf-poly1305"/"chacha20-ietf"/"chacha20-poly1305"/"chacha20"/"none"/"rc4-md5"/"rc4"/"salsa20"/"xchacha20-ietf-poly1305"/"2022-blake3-aes-128-gcm"/"2022-blake3-aes-256-gcm");

username = & {
    let j = peg$currPos; 
    let start, end;
    let first = true;
    while (j < input.length) {
        if (input[j] === ',') {
            if (first) {
                start = j + 1;
                first = false;
            } else {
                end = j;
                break;
            }
        }
        j++;
    }
    const match = input.substring(start, end);
    if (match.indexOf("=") === -1) {
        $.username = match;
        peg$currPos = end;
        return true;
    }
} { proxy.username = $.username; }
password = comma '"' match:[^"]* '"' { proxy.password = match.join(""); }
uuid = comma '"' match:[^"]+ '"' { proxy.uuid = match.join(""); }

obfs_typev = comma type:("http"/"tls") { obfs.type = type; }
obfs_hostv = comma match:[^,]+ { obfs.host = match.join(""); }

obfs_ss = comma "obfs-name" equals type:("http"/"tls") { obfs.type = type; }

obfs_ssr = comma "obfs" equals type:("plain"/"http_simple"/"http_post"/"random_head"/"tls1.2_ticket_auth"/"tls1.2_ticket_fastauth") { obfs.type = type; }
obfs_ssr_param = comma "obfs-param" equals match:$[^,]+ { proxy["obfs-param"] = match; }

obfs_host = comma "obfs-host" equals host:domain { obfs.host = host; }
obfs_uri = comma "obfs-uri" equals uri:uri { obfs.path = uri; }
uri = $[^,]+

transport = comma "transport" equals type:("tcp"/"ws"/"http") { transport.type = type; }
transport_host = comma "host" equals host:domain { transport.host = host; }
transport_path = comma "path" equals path:uri { transport.path = path; }

ssr_protocol = comma "protocol" equals protocol:("origin"/"auth_sha1_v4"/"auth_aes128_md5"/"auth_aes128_sha1"/"auth_chain_a"/"auth_chain_b") { proxy.protocol = protocol; }
ssr_protocol_param = comma "protocol-param" equals param:$[^=,]+ { proxy["protocol-param"] = param; }

vmess_alterId = comma "alterId" equals alterId:$[0-9]+ { proxy.alterId = parseInt(alterId); } 

over_tls = comma "over-tls" equals flag:bool { proxy.tls = flag; }
tls_host = comma sni:("tls-name"/"sni") equals host:domain { proxy.sni = host; }
tls_verification = comma "skip-cert-verify" equals flag:bool { proxy["skip-cert-verify"] = flag; }
tls_cert_sha256 = comma "tls-cert-sha256" equals match:[^,]+ { proxy["tls-fingerprint"] = match.join("").replace(/^"(.*)"$/, '$1'); }
tls_pubkey_sha256 = comma "tls-pubkey-sha256" equals match:[^,]+ { proxy["tls-pubkey-sha256"] = match.join("").replace(/^"(.*)"$/, '$1'); }

fast_open = comma "fast-open" equals flag:bool { proxy.tfo = flag; }
udp_relay = comma "udp" equals flag:bool { proxy.udp = flag; }

ecn = comma "ecn" equals flag:bool { proxy.ecn = flag; }
download_bandwidth = comma "download-bandwidth" equals match:[^,]+ { proxy.down = match.join(""); }
salamander_password = comma "salamander-password" equals match:[^,]+ { proxy['obfs-password'] = match.join(""); proxy.obfs = 'salamander'; }

tag = match:[^=,]* { proxy.name = match.join("").trim(); }
comma = _ "," _
equals = _ "=" _
_ = [ \r	]*
bool = b:("true"/"false") { return b === "true" }
others = comma [^=,]+ equals [^=,]+
`],(__raw_90=[`
// global initializer
{{
    function $set(obj, path, value) {
      if (Object(obj) !== obj) return obj;
      if (!Array.isArray(path)) path = path.toString().match(/[^.[\\]]+/g) || [];
      path
        .slice(0, -1)
        .reduce((a, c, i) => (Object(a[c]) === a[c] ? a[c] : (a[c] = Math.abs(path[i + 1]) >> 0 === +path[i + 1] ? [] : {})), obj)[
        path[path.length - 1]
      ] = value;
      return obj;
    }
}}

// per-parser initializer
{
    const proxy = {};
    const obfs = {};
    const transport = {};
    const $ = {};

    function handleTransport() {
        if (transport.type === "tcp") { /* do nothing */ }
        else if (transport.type === "ws") {
            proxy.network = "ws";
            $set(proxy, "ws-opts.path", transport.path);
            $set(proxy, "ws-opts.headers.Host", transport.host);
        } else if (transport.type === "http") {
            proxy.network = "http";
            $set(proxy, "http-opts.path", transport.path);
            $set(proxy, "http-opts.headers.Host", transport.host);
        }
    }
}

start = (shadowsocksr/shadowsocks/vmess/vless/trojan/https/http/socks5/hysteria2) {
    return proxy;
}

shadowsocksr = tag equals "shadowsocksr"i address method password (ssr_protocol/ssr_protocol_param/obfs_ssr/obfs_ssr_param/obfs_host/obfs_uri/fast_open/udp_relay/others)*{
    proxy.type = "ssr";
    // handle ssr obfs
    proxy.obfs = obfs.type;
}
shadowsocks = tag equals "shadowsocks"i address method password (obfs_typev obfs_hostv)? (obfs_ss/obfs_host/obfs_uri/fast_open/udp_relay/others)* {
    proxy.type = "ss";
    // handle ss obfs
    if (obfs.type == "http" || obfs.type === "tls") {
        proxy.plugin = "obfs";
        $set(proxy, "plugin-opts.mode", obfs.type);
        $set(proxy, "plugin-opts.host", obfs.host);
        $set(proxy, "plugin-opts.path", obfs.path);
    }
}
vmess = tag equals "vmess"i address method uuid (transport/transport_host/transport_path/over_tls/tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/vmess_alterId/fast_open/udp_relay/others)* {
    proxy.type = "vmess";
    proxy.cipher = proxy.cipher || "none";
    proxy.alterId = proxy.alterId || 0;
    handleTransport();
}
vless = tag equals "vless"i address uuid (transport/transport_host/transport_path/over_tls/tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/fast_open/udp_relay/others)* {
    proxy.type = "vless";
    handleTransport();
}
trojan = tag equals "trojan"i address password (transport/transport_host/transport_path/over_tls/tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/fast_open/udp_relay/others)* {
    proxy.type = "trojan";
    handleTransport();
}
hysteria2 = tag equals "hysteria2"i address password (tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/udp_relay/fast_open/download_bandwidth/salamander_password/ecn/others)* {
    proxy.type = "hysteria2";
}
https = tag equals "https"i address (username password)? (tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/fast_open/udp_relay/others)* {
    proxy.type = "http";
    proxy.tls = true;
}
http = tag equals "http"i address (username password)? (fast_open/udp_relay/others)* {
    proxy.type = "http";
}
socks5 = tag equals "socks5"i address (username password)? (over_tls/tls_host/tls_verification/tls_cert_sha256/tls_pubkey_sha256/fast_open/udp_relay/others)* {
    proxy.type = "socks5";
}

address = comma server:server comma port:port {
    proxy.server = server;
    proxy.port = port;
}

server = ip/domain

ip = & {
    const start = peg$currPos;
    let j = start;
    while (j < input.length) {
        if (input[j] === ",") break;
        j++;
    }
    peg$currPos = j;
    $.ip = input.substring(start, j).trim();
    return true;
} { return $.ip; }

domain = match:[0-9a-zA-z-_.]+ { 
    const domain = match.join(""); 
    if (/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/.test(domain)) {
        return domain;
    }
    throw new Error("Invalid domain: " + domain);
}

port = digits:[0-9]+ { 
    const port = parseInt(digits.join(""), 10); 
    if (port >= 0 && port <= 65535) {
    	return port;
    }
    throw new Error("Invalid port number: " + port);
}

method = comma cipher:cipher { 
    proxy.cipher = cipher;
}
cipher = ("aes-128-cfb"/"aes-128-ctr"/"aes-128-gcm"/"aes-192-cfb"/"aes-192-ctr"/"aes-192-gcm"/"aes-256-cfb"/"aes-256-ctr"/"aes-256-gcm"/"auto"/"bf-cfb"/"camellia-128-cfb"/"camellia-192-cfb"/"camellia-256-cfb"/"chacha20-ietf-poly1305"/"chacha20-ietf"/"chacha20-poly1305"/"chacha20"/"none"/"rc4-md5"/"rc4"/"salsa20"/"xchacha20-ietf-poly1305"/"2022-blake3-aes-128-gcm"/"2022-blake3-aes-256-gcm");

username = & {
    let j = peg$currPos; 
    let start, end;
    let first = true;
    while (j < input.length) {
        if (input[j] === ',') {
            if (first) {
                start = j + 1;
                first = false;
            } else {
                end = j;
                break;
            }
        }
        j++;
    }
    const match = input.substring(start, end);
    if (match.indexOf("=") === -1) {
        $.username = match;
        peg$currPos = end;
        return true;
    }
} { proxy.username = $.username; }
password = comma '"' match:[^"]* '"' { proxy.password = match.join(""); }
uuid = comma '"' match:[^"]+ '"' { proxy.uuid = match.join(""); }

obfs_typev = comma type:("http"/"tls") { obfs.type = type; }
obfs_hostv = comma match:[^,]+ { obfs.host = match.join(""); }

obfs_ss = comma "obfs-name" equals type:("http"/"tls") { obfs.type = type; }

obfs_ssr = comma "obfs" equals type:("plain"/"http_simple"/"http_post"/"random_head"/"tls1.2_ticket_auth"/"tls1.2_ticket_fastauth") { obfs.type = type; }
obfs_ssr_param = comma "obfs-param" equals match:$[^,]+ { proxy["obfs-param"] = match; }

obfs_host = comma "obfs-host" equals host:domain { obfs.host = host; }
obfs_uri = comma "obfs-uri" equals uri:uri { obfs.path = uri; }
uri = $[^,]+

transport = comma "transport" equals type:("tcp"/"ws"/"http") { transport.type = type; }
transport_host = comma "host" equals host:domain { transport.host = host; }
transport_path = comma "path" equals path:uri { transport.path = path; }

ssr_protocol = comma "protocol" equals protocol:("origin"/"auth_sha1_v4"/"auth_aes128_md5"/"auth_aes128_sha1"/"auth_chain_a"/"auth_chain_b") { proxy.protocol = protocol; }
ssr_protocol_param = comma "protocol-param" equals param:$[^=,]+ { proxy["protocol-param"] = param; }

vmess_alterId = comma "alterId" equals alterId:$[0-9]+ { proxy.alterId = parseInt(alterId); } 

over_tls = comma "over-tls" equals flag:bool { proxy.tls = flag; }
tls_host = comma sni:("tls-name"/"sni") equals host:domain { proxy.sni = host; }
tls_verification = comma "skip-cert-verify" equals flag:bool { proxy["skip-cert-verify"] = flag; }
tls_cert_sha256 = comma "tls-cert-sha256" equals match:[^,]+ { proxy["tls-fingerprint"] = match.join("").replace(/^"(.*)"$/, '$1'); }
tls_pubkey_sha256 = comma "tls-pubkey-sha256" equals match:[^,]+ { proxy["tls-pubkey-sha256"] = match.join("").replace(/^"(.*)"$/, '$1'); }

fast_open = comma "fast-open" equals flag:bool { proxy.tfo = flag; }
udp_relay = comma "udp" equals flag:bool { proxy.udp = flag; }

ecn = comma "ecn" equals flag:bool { proxy.ecn = flag; }
download_bandwidth = comma "download-bandwidth" equals match:[^,]+ { proxy.down = match.join(""); }
salamander_password = comma "salamander-password" equals match:[^,]+ { proxy['obfs-password'] = match.join(""); proxy.obfs = 'salamander'; }

tag = match:[^=,]* { proxy.name = match.join("").trim(); }
comma = _ "," _
equals = _ "=" _
_ = [ \\r\\t]*
bool = b:("true"/"false") { return b === "true" }
others = comma [^=,]+ equals [^=,]+
`])||(__raw_90=__strings_90.slice(0)),___templateObject_90=Object.freeze(Object.defineProperties(__strings_90,{raw:{value:Object.freeze(__raw_90)}})))),_$qx_91={};function ___typeof_91(t){return(___typeof_91=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$qx_91,"__esModule",{value:!0}),_$qx_91.default=function(){return __parser_91||(__parser_91=__peggy_91.generate(__grammars_91)),__parser_91};var ___templateObject_91,__peggy_91=function(t,e){if(t&&t.__esModule)return t;if(t===null||___typeof_91(t)!=="object"&&typeof t!="function")return{default:t};var r=___getRequireWildcardCache_91(void 0);if(r&&r.has(t))return r.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var d=o?Object.getOwnPropertyDescriptor(t,f):null;d&&(d.get||d.set)?Object.defineProperty(n,f,d):n[f]=t[f]}return n.default=t,r&&r.set(t,n),n}(_$peg_73);function ___getRequireWildcardCache_91(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(___getRequireWildcardCache_91=function(n){return n?r:e})(t)}var __strings_91,__raw_91,__parser_91,__grammars_91=String.raw(___templateObject_91||(__strings_91=[`
// global initializer
{{
    function $set(obj, path, value) {
      if (Object(obj) !== obj) return obj;
      if (!Array.isArray(path)) path = path.toString().match(/[^.[]]+/g) || [];
      path
        .slice(0, -1)
        .reduce((a, c, i) => (Object(a[c]) === a[c] ? a[c] : (a[c] = Math.abs(path[i + 1]) >> 0 === +path[i + 1] ? [] : {})), obj)[
        path[path.length - 1]
      ] = value;
      return obj;
    }
}}

// per-parse initializer
{
	const proxy = {};
    const obfs = {};
    const $ = {};

    function handleObfs() {
        if (obfs.type === "ws" || obfs.type === "wss") {
            proxy.network = "ws";
            if (obfs.type === 'wss') {
                proxy.tls = true;
            }
            $set(proxy, "ws-opts.path", obfs.path);
            $set(proxy, "ws-opts.headers.Host", obfs.host);
        } else if (obfs.type === "over-tls") {
            proxy.tls = true;
        } else if (obfs.type === "http") {
            proxy.network = "http";
            $set(proxy, "http-opts.path", obfs.path);
            $set(proxy, "http-opts.headers.Host", obfs.host);
        }
    }
}

start = (trojan/shadowsocks/vmess/vless/http/socks5) {
    return proxy
}

trojan = "trojan" equals address
    (password/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/obfs/obfs_host/obfs_uri/tag/udp_relay/udp_over_tcp/fast_open/server_check_url/others)* {
    proxy.type = "trojan";
    handleObfs();
}

shadowsocks = "shadowsocks" equals address
    (password/method/obfs_ssr/obfs_ss/obfs_host/obfs_uri/ssr_protocol/ssr_protocol_param/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/udp_relay/udp_over_tcp/fast_open/tag/server_check_url/others)* {
    if (proxy.protocol || proxy.type === "ssr") {
        proxy.type = "ssr";
        if (!proxy.protocol) {
            proxy.protocol = "origin";
        }
        // handle ssr obfs
        if (obfs.host) proxy["obfs-param"] = obfs.host;
        if (obfs.type) proxy.obfs = obfs.type;
    } else {
        proxy.type = "ss";
        // handle ss obfs
        if (obfs.type == "http" || obfs.type === "tls") {
            proxy.plugin = "obfs";
            $set(proxy, "plugin-opts", {
                mode: obfs.type
            });
        } else if (obfs.type === "ws" || obfs.type === "wss") {
            proxy.plugin = "v2ray-plugin";
            $set(proxy, "plugin-opts.mode", "websocket");
            if (obfs.type === "wss") {
                $set(proxy, "plugin-opts.tls", true);
            }
        } else if (obfs.type === 'over-tls') {
            throw new Error('ss over-tls is not supported');
        }
        if (obfs.type) {
            $set(proxy, "plugin-opts.host", obfs.host);
            $set(proxy, "plugin-opts.path", obfs.path);
        }
    }
}

vmess = "vmess" equals address
    (uuid/method/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/tag/obfs/obfs_host/obfs_uri/udp_relay/udp_over_tcp/fast_open/aead/server_check_url/others)* {
    proxy.type = "vmess";
    proxy.cipher = proxy.cipher || "none";
    if (proxy.aead) {
        proxy.alterId = 0;
    } else {
        proxy.alterId = proxy.alterId || 0;
    }
    handleObfs();
}

vless = "vless" equals address
    (uuid/method/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/tag/obfs/obfs_host/obfs_uri/udp_relay/udp_over_tcp/fast_open/aead/server_check_url/others)* {
    proxy.type = "vless";
    proxy.cipher = proxy.cipher || "none";
    handleObfs();
}

http = "http" equals address 
    (username/password/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/tag/fast_open/udp_relay/udp_over_tcp/server_check_url/others)*{
    proxy.type = "http";
}

socks5 = "socks5" equals address
    (username/password/password/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/tag/fast_open/udp_relay/udp_over_tcp/server_check_url/others)* {
    proxy.type = "socks5";
}
    
address = server:server ":" port:port {
    proxy.server = server;
    proxy.port = port;
}
server = ip/domain

domain = match:[0-9a-zA-z-_.]+ { 
    const domain = match.join(""); 
    if (/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/.test(domain)) {
        return domain;
    }
}

ip = & {
    const start = peg$currPos;
    let end;
    let j = start;
    while (j < input.length) {
        if (input[j] === ",") break;
        if (input[j] === ":") end = j;
        j++;
    }
    peg$currPos = end || j;
    $.ip = input.substring(start, end).trim();
    return true;
} { return $.ip; }

port = digits:[0-9]+ { 
    const port = parseInt(digits.join(""), 10); 
    if (port >= 0 && port <= 65535) {
    	return port;
    }
}

username = comma "username" equals username:[^=,]+ { proxy.username = username.join("").trim(); }
password = comma "password" equals password:[^=,]+ { proxy.password = password.join("").trim(); }
uuid = comma "password" equals uuid:[^=,]+ { proxy.uuid = uuid.join("").trim(); }

method = comma "method" equals cipher:cipher { 
    proxy.cipher = cipher;
};
cipher = ("aes-128-cfb"/"aes-128-ctr"/"aes-128-gcm"/"aes-192-cfb"/"aes-192-ctr"/"aes-192-gcm"/"aes-256-cfb"/"aes-256-ctr"/"aes-256-gcm"/"bf-cfb"/"cast5-cfb"/"chacha20-ietf-poly1305"/"chacha20-ietf"/"chacha20-poly1305"/"chacha20"/"des-cfb"/"none"/"rc2-cfb"/"rc4-md5-6"/"rc4-md5"/"salsa20"/"xchacha20-ietf-poly1305");
aead = comma "aead" equals flag:bool { proxy.aead = flag; }

udp_relay = comma "udp-relay" equals flag:bool { proxy.udp = flag; }
udp_over_tcp = comma "udp-over-tcp" equals flag:bool { throw new Error("UDP over TCP is not supported"); }
fast_open = comma "fast-open" equals flag:bool { proxy.tfo = flag; }

over_tls = comma "over-tls" equals flag:bool { proxy.tls = flag; }
tls_host = comma "tls-host" equals sni:domain { proxy.sni = sni; }
tls_verification = comma "tls-verification" equals flag:bool { 
    proxy["skip-cert-verify"] = !flag;
}
tls_fingerprint = comma "tls-cert-sha256" equals tls_fingerprint:$[^,]+ { proxy["tls-fingerprint"] = tls_fingerprint.trim(); }
tls_pubkey_sha256 = comma "tls-pubkey-sha256" equals param:$[^=,]+ { proxy["tls-pubkey-sha256"] = param; }
tls_alpn = comma "tls-alpn" equals param:$[^=,]+ { proxy["tls-alpn"] = param; }
tls_no_session_ticket = comma "tls-no-session-ticket" equals flag:bool { 
    proxy["tls-no-session-ticket"] = flag;
}
tls_no_session_reuse = comma "tls-no-session-reuse" equals flag:bool { 
    proxy["tls-no-session-reuse"] = flag;
}

obfs_ss = comma "obfs" equals type:("http"/"tls"/"wss"/"ws"/"over-tls") { obfs.type = type; return type; }
obfs_ssr = comma "obfs" equals type:("plain"/"http_simple"/"http_post"/"random_head"/"tls1.2_ticket_auth"/"tls1.2_ticket_fastauth") { proxy.type = "ssr"; obfs.type = type; return type; }
obfs = comma "obfs" equals type:("wss"/"ws"/"over-tls"/"http") { obfs.type = type; return type; };

obfs_host = comma "obfs-host" equals host:domain { obfs.host = host; }
obfs_uri = comma "obfs-uri" equals uri:uri { obfs.path = uri; }

ssr_protocol = comma "ssr-protocol" equals protocol:("origin"/"auth_sha1_v4"/"auth_aes128_md5"/"auth_aes128_sha1"/"auth_chain_a"/"auth_chain_b") { proxy.protocol = protocol; return protocol; }
ssr_protocol_param = comma "ssr-protocol-param" equals param:$[^=,]+ { proxy["protocol-param"] = param; }

server_check_url = comma "server_check_url" equals param:$[^=,]+ { proxy["test-url"] = param; }

uri = $[^,]+

tag = comma "tag" equals tag:[^=,]+ { proxy.name = tag.join(""); }
others = comma [^=,]+ equals [^=,]+
comma = _ "," _
equals = _ "=" _
_ = [ \r	]*
bool = b:("true"/"false") { return b === "true" }
`],(__raw_91=[`
// global initializer
{{
    function $set(obj, path, value) {
      if (Object(obj) !== obj) return obj;
      if (!Array.isArray(path)) path = path.toString().match(/[^.[\\]]+/g) || [];
      path
        .slice(0, -1)
        .reduce((a, c, i) => (Object(a[c]) === a[c] ? a[c] : (a[c] = Math.abs(path[i + 1]) >> 0 === +path[i + 1] ? [] : {})), obj)[
        path[path.length - 1]
      ] = value;
      return obj;
    }
}}

// per-parse initializer
{
	const proxy = {};
    const obfs = {};
    const $ = {};

    function handleObfs() {
        if (obfs.type === "ws" || obfs.type === "wss") {
            proxy.network = "ws";
            if (obfs.type === 'wss') {
                proxy.tls = true;
            }
            $set(proxy, "ws-opts.path", obfs.path);
            $set(proxy, "ws-opts.headers.Host", obfs.host);
        } else if (obfs.type === "over-tls") {
            proxy.tls = true;
        } else if (obfs.type === "http") {
            proxy.network = "http";
            $set(proxy, "http-opts.path", obfs.path);
            $set(proxy, "http-opts.headers.Host", obfs.host);
        }
    }
}

start = (trojan/shadowsocks/vmess/vless/http/socks5) {
    return proxy
}

trojan = "trojan" equals address
    (password/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/obfs/obfs_host/obfs_uri/tag/udp_relay/udp_over_tcp/fast_open/server_check_url/others)* {
    proxy.type = "trojan";
    handleObfs();
}

shadowsocks = "shadowsocks" equals address
    (password/method/obfs_ssr/obfs_ss/obfs_host/obfs_uri/ssr_protocol/ssr_protocol_param/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/udp_relay/udp_over_tcp/fast_open/tag/server_check_url/others)* {
    if (proxy.protocol || proxy.type === "ssr") {
        proxy.type = "ssr";
        if (!proxy.protocol) {
            proxy.protocol = "origin";
        }
        // handle ssr obfs
        if (obfs.host) proxy["obfs-param"] = obfs.host;
        if (obfs.type) proxy.obfs = obfs.type;
    } else {
        proxy.type = "ss";
        // handle ss obfs
        if (obfs.type == "http" || obfs.type === "tls") {
            proxy.plugin = "obfs";
            $set(proxy, "plugin-opts", {
                mode: obfs.type
            });
        } else if (obfs.type === "ws" || obfs.type === "wss") {
            proxy.plugin = "v2ray-plugin";
            $set(proxy, "plugin-opts.mode", "websocket");
            if (obfs.type === "wss") {
                $set(proxy, "plugin-opts.tls", true);
            }
        } else if (obfs.type === 'over-tls') {
            throw new Error('ss over-tls is not supported');
        }
        if (obfs.type) {
            $set(proxy, "plugin-opts.host", obfs.host);
            $set(proxy, "plugin-opts.path", obfs.path);
        }
    }
}

vmess = "vmess" equals address
    (uuid/method/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/tag/obfs/obfs_host/obfs_uri/udp_relay/udp_over_tcp/fast_open/aead/server_check_url/others)* {
    proxy.type = "vmess";
    proxy.cipher = proxy.cipher || "none";
    if (proxy.aead) {
        proxy.alterId = 0;
    } else {
        proxy.alterId = proxy.alterId || 0;
    }
    handleObfs();
}

vless = "vless" equals address
    (uuid/method/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/tag/obfs/obfs_host/obfs_uri/udp_relay/udp_over_tcp/fast_open/aead/server_check_url/others)* {
    proxy.type = "vless";
    proxy.cipher = proxy.cipher || "none";
    handleObfs();
}

http = "http" equals address 
    (username/password/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/tag/fast_open/udp_relay/udp_over_tcp/server_check_url/others)*{
    proxy.type = "http";
}

socks5 = "socks5" equals address
    (username/password/password/over_tls/tls_host/tls_pubkey_sha256/tls_alpn/tls_no_session_ticket/tls_no_session_reuse/tls_fingerprint/tls_verification/tag/fast_open/udp_relay/udp_over_tcp/server_check_url/others)* {
    proxy.type = "socks5";
}
    
address = server:server ":" port:port {
    proxy.server = server;
    proxy.port = port;
}
server = ip/domain

domain = match:[0-9a-zA-z-_.]+ { 
    const domain = match.join(""); 
    if (/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/.test(domain)) {
        return domain;
    }
}

ip = & {
    const start = peg$currPos;
    let end;
    let j = start;
    while (j < input.length) {
        if (input[j] === ",") break;
        if (input[j] === ":") end = j;
        j++;
    }
    peg$currPos = end || j;
    $.ip = input.substring(start, end).trim();
    return true;
} { return $.ip; }

port = digits:[0-9]+ { 
    const port = parseInt(digits.join(""), 10); 
    if (port >= 0 && port <= 65535) {
    	return port;
    }
}

username = comma "username" equals username:[^=,]+ { proxy.username = username.join("").trim(); }
password = comma "password" equals password:[^=,]+ { proxy.password = password.join("").trim(); }
uuid = comma "password" equals uuid:[^=,]+ { proxy.uuid = uuid.join("").trim(); }

method = comma "method" equals cipher:cipher { 
    proxy.cipher = cipher;
};
cipher = ("aes-128-cfb"/"aes-128-ctr"/"aes-128-gcm"/"aes-192-cfb"/"aes-192-ctr"/"aes-192-gcm"/"aes-256-cfb"/"aes-256-ctr"/"aes-256-gcm"/"bf-cfb"/"cast5-cfb"/"chacha20-ietf-poly1305"/"chacha20-ietf"/"chacha20-poly1305"/"chacha20"/"des-cfb"/"none"/"rc2-cfb"/"rc4-md5-6"/"rc4-md5"/"salsa20"/"xchacha20-ietf-poly1305");
aead = comma "aead" equals flag:bool { proxy.aead = flag; }

udp_relay = comma "udp-relay" equals flag:bool { proxy.udp = flag; }
udp_over_tcp = comma "udp-over-tcp" equals flag:bool { throw new Error("UDP over TCP is not supported"); }
fast_open = comma "fast-open" equals flag:bool { proxy.tfo = flag; }

over_tls = comma "over-tls" equals flag:bool { proxy.tls = flag; }
tls_host = comma "tls-host" equals sni:domain { proxy.sni = sni; }
tls_verification = comma "tls-verification" equals flag:bool { 
    proxy["skip-cert-verify"] = !flag;
}
tls_fingerprint = comma "tls-cert-sha256" equals tls_fingerprint:$[^,]+ { proxy["tls-fingerprint"] = tls_fingerprint.trim(); }
tls_pubkey_sha256 = comma "tls-pubkey-sha256" equals param:$[^=,]+ { proxy["tls-pubkey-sha256"] = param; }
tls_alpn = comma "tls-alpn" equals param:$[^=,]+ { proxy["tls-alpn"] = param; }
tls_no_session_ticket = comma "tls-no-session-ticket" equals flag:bool { 
    proxy["tls-no-session-ticket"] = flag;
}
tls_no_session_reuse = comma "tls-no-session-reuse" equals flag:bool { 
    proxy["tls-no-session-reuse"] = flag;
}

obfs_ss = comma "obfs" equals type:("http"/"tls"/"wss"/"ws"/"over-tls") { obfs.type = type; return type; }
obfs_ssr = comma "obfs" equals type:("plain"/"http_simple"/"http_post"/"random_head"/"tls1.2_ticket_auth"/"tls1.2_ticket_fastauth") { proxy.type = "ssr"; obfs.type = type; return type; }
obfs = comma "obfs" equals type:("wss"/"ws"/"over-tls"/"http") { obfs.type = type; return type; };

obfs_host = comma "obfs-host" equals host:domain { obfs.host = host; }
obfs_uri = comma "obfs-uri" equals uri:uri { obfs.path = uri; }

ssr_protocol = comma "ssr-protocol" equals protocol:("origin"/"auth_sha1_v4"/"auth_aes128_md5"/"auth_aes128_sha1"/"auth_chain_a"/"auth_chain_b") { proxy.protocol = protocol; return protocol; }
ssr_protocol_param = comma "ssr-protocol-param" equals param:$[^=,]+ { proxy["protocol-param"] = param; }

server_check_url = comma "server_check_url" equals param:$[^=,]+ { proxy["test-url"] = param; }

uri = $[^,]+

tag = comma "tag" equals tag:[^=,]+ { proxy.name = tag.join(""); }
others = comma [^=,]+ equals [^=,]+
comma = _ "," _
equals = _ "=" _
_ = [ \\r\\t]*
bool = b:("true"/"false") { return b === "true" }
`])||(__raw_91=__strings_91.slice(0)),___templateObject_91=Object.freeze(Object.defineProperties(__strings_91,{raw:{value:Object.freeze(__raw_91)}})))),_$trojanUri_93={};function ___typeof_93(t){return(___typeof_93=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$trojanUri_93,"__esModule",{value:!0}),_$trojanUri_93.default=function(){return __parser_93||(__parser_93=__peggy_93.generate(__grammars_93)),__parser_93};var ___templateObject_93,__peggy_93=function(t,e){if(t&&t.__esModule)return t;if(t===null||___typeof_93(t)!=="object"&&typeof t!="function")return{default:t};var r=___getRequireWildcardCache_93(void 0);if(r&&r.has(t))return r.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var d=o?Object.getOwnPropertyDescriptor(t,f):null;d&&(d.get||d.set)?Object.defineProperty(n,f,d):n[f]=t[f]}return n.default=t,r&&r.set(t,n),n}(_$peg_73);function ___getRequireWildcardCache_93(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(___getRequireWildcardCache_93=function(n){return n?r:e})(t)}var __strings_93,__raw_93,__parser_93,__grammars_93=String.raw(___templateObject_93||(__strings_93=[`
// global initializer
{{
  function $set(obj, path, value) {
    if (Object(obj) !== obj) return obj;
    if (!Array.isArray(path)) path = path.toString().match(/[^.[]]+/g) || [];
    path
      .slice(0, -1)
      .reduce((a, c, i) => (Object(a[c]) === a[c] ? a[c] : (a[c] = Math.abs(path[i + 1]) >> 0 === +path[i + 1] ? [] : {})), obj)[
      path[path.length - 1]
    ] = value;
    return obj;
  }

  function toBool(str) {
    if (typeof str === 'undefined' || str === null) return undefined;
    return /(TRUE)|1/i.test(str);
  }
}}

{
  const proxy = {};
  const obfs = {};
  const $ = {};
  const params = {};
}

start = (trojan) {
  return proxy
}

trojan = "trojan://" password:password "@" server:server ":" port:port "/"? params? name:name?{
  proxy.type = "trojan";
  proxy.password = password;
  proxy.server = server;
  proxy.port = port;
  proxy.name = name;

  // name may be empty
  if (!proxy.name) {
    proxy.name = server + ":" + port;
  }
};

password = match:$[^@]+ {
  return decodeURIComponent(match);
};

server = ip/domain;

domain = match:[0-9a-zA-z-_.]+ { 
  const domain = match.join(""); 
  if (/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/.test(domain)) {
    return domain;
  }
}

ip = & {
  const start = peg$currPos;
  let end;
  let j = start;
  while (j < input.length) {
    if (input[j] === ",") break;
    if (input[j] === ":") end = j;
    j++;
  }
  peg$currPos = end || j;
  $.ip = input.substring(start, end).trim();
  return true;
} { return $.ip; }

port = digits:[0-9]+ { 
  const port = parseInt(digits.join(""), 10); 
  if (port >= 0 && port <= 65535) {
    return port;
  } else {
    throw new Error("Invalid port: " + port);
  }
}

params = "?" head:param tail:("&"@param)* {
  proxy["skip-cert-verify"] = toBool(params["allowInsecure"]);
  proxy.sni = params["sni"] || params["peer"];
  proxy['client-fingerprint'] = params.fp;
  proxy.alpn = params.alpn ? decodeURIComponent(params.alpn).split(',') : undefined;

  if (toBool(params["ws"])) {
    proxy.network = "ws";
    $set(proxy, "ws-opts.path", params["wspath"]);
  }
  
  if (params["type"]) {
    let httpupgrade
    proxy.network = params["type"]
    if(proxy.network === 'httpupgrade') {
      proxy.network = 'ws'
      httpupgrade = true
    }
    if (['grpc'].includes(proxy.network)) {
        proxy[proxy.network + '-opts'] = {
            'grpc-service-name': params["serviceName"],
            '_grpc-type': params["mode"],
            '_grpc-authority': params["authority"],
        };
    } else {
      if (params["path"]) {
        $set(proxy, proxy.network+"-opts.path", decodeURIComponent(params["path"]));  
      }
      if (params["host"]) {
        $set(proxy, proxy.network+"-opts.headers.Host", decodeURIComponent(params["host"])); 
      }
      if (httpupgrade) {
        $set(proxy, proxy.network+"-opts.v2ray-http-upgrade", true); 
        $set(proxy, proxy.network+"-opts.v2ray-http-upgrade-fast-open", true); 
      }
    }
  }

  proxy.udp = toBool(params["udp"]);
  proxy.tfo = toBool(params["tfo"]);
}

param = kv/single;

kv = key:$[a-z]i+ "=" value:$[^&#]i* {
  params[key] = value;
}

single = key:$[a-z]i+ {
  params[key] = true;
};

name = "#" + match:$.* {
  return decodeURIComponent(match);
}
`],(__raw_93=[`
// global initializer
{{
  function $set(obj, path, value) {
    if (Object(obj) !== obj) return obj;
    if (!Array.isArray(path)) path = path.toString().match(/[^.[\\]]+/g) || [];
    path
      .slice(0, -1)
      .reduce((a, c, i) => (Object(a[c]) === a[c] ? a[c] : (a[c] = Math.abs(path[i + 1]) >> 0 === +path[i + 1] ? [] : {})), obj)[
      path[path.length - 1]
    ] = value;
    return obj;
  }

  function toBool(str) {
    if (typeof str === 'undefined' || str === null) return undefined;
    return /(TRUE)|1/i.test(str);
  }
}}

{
  const proxy = {};
  const obfs = {};
  const $ = {};
  const params = {};
}

start = (trojan) {
  return proxy
}

trojan = "trojan://" password:password "@" server:server ":" port:port "/"? params? name:name?{
  proxy.type = "trojan";
  proxy.password = password;
  proxy.server = server;
  proxy.port = port;
  proxy.name = name;

  // name may be empty
  if (!proxy.name) {
    proxy.name = server + ":" + port;
  }
};

password = match:$[^@]+ {
  return decodeURIComponent(match);
};

server = ip/domain;

domain = match:[0-9a-zA-z-_.]+ { 
  const domain = match.join(""); 
  if (/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/.test(domain)) {
    return domain;
  }
}

ip = & {
  const start = peg$currPos;
  let end;
  let j = start;
  while (j < input.length) {
    if (input[j] === ",") break;
    if (input[j] === ":") end = j;
    j++;
  }
  peg$currPos = end || j;
  $.ip = input.substring(start, end).trim();
  return true;
} { return $.ip; }

port = digits:[0-9]+ { 
  const port = parseInt(digits.join(""), 10); 
  if (port >= 0 && port <= 65535) {
    return port;
  } else {
    throw new Error("Invalid port: " + port);
  }
}

params = "?" head:param tail:("&"@param)* {
  proxy["skip-cert-verify"] = toBool(params["allowInsecure"]);
  proxy.sni = params["sni"] || params["peer"];
  proxy['client-fingerprint'] = params.fp;
  proxy.alpn = params.alpn ? decodeURIComponent(params.alpn).split(',') : undefined;

  if (toBool(params["ws"])) {
    proxy.network = "ws";
    $set(proxy, "ws-opts.path", params["wspath"]);
  }
  
  if (params["type"]) {
    let httpupgrade
    proxy.network = params["type"]
    if(proxy.network === 'httpupgrade') {
      proxy.network = 'ws'
      httpupgrade = true
    }
    if (['grpc'].includes(proxy.network)) {
        proxy[proxy.network + '-opts'] = {
            'grpc-service-name': params["serviceName"],
            '_grpc-type': params["mode"],
            '_grpc-authority': params["authority"],
        };
    } else {
      if (params["path"]) {
        $set(proxy, proxy.network+"-opts.path", decodeURIComponent(params["path"]));  
      }
      if (params["host"]) {
        $set(proxy, proxy.network+"-opts.headers.Host", decodeURIComponent(params["host"])); 
      }
      if (httpupgrade) {
        $set(proxy, proxy.network+"-opts.v2ray-http-upgrade", true); 
        $set(proxy, proxy.network+"-opts.v2ray-http-upgrade-fast-open", true); 
      }
    }
  }

  proxy.udp = toBool(params["udp"]);
  proxy.tfo = toBool(params["tfo"]);
}

param = kv/single;

kv = key:$[a-z]i+ "=" value:$[^&#]i* {
  params[key] = value;
}

single = key:$[a-z]i+ {
  params[key] = true;
};

name = "#" + match:$.* {
  return decodeURIComponent(match);
}
`])||(__raw_93=__strings_93.slice(0)),___templateObject_93=Object.freeze(Object.defineProperties(__strings_93,{raw:{value:Object.freeze(__raw_93)}})))),_$parsers_89={};Object.defineProperty(_$parsers_89,"__esModule",{value:!0}),_$parsers_89.default=void 0;var ___surge_89=___interopRequireDefault_89(_$surge_92),___loon_89=___interopRequireDefault_89(_$loon_90),___qx_89=___interopRequireDefault_89(_$qx_91),_trojanUri=___interopRequireDefault_89(_$trojanUri_93);function ___interopRequireDefault_89(t){return t&&t.__esModule?t:{default:t}}function __ownKeys_89(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function ___objectSpread_89(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_89(Object(r),!0).forEach(function(n){___defineProperty_89(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):__ownKeys_89(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ___defineProperty_89(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ___createForOfIteratorHelper_89(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=___unsupportedIterableToArray_89(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){r=r.call(t)},n:function(){var y=r.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||r.return==null||r.return()}finally{if(h)throw f}}}}function ___slicedToArray_89(t,e){return function(r){if(Array.isArray(r))return r}(t)||function(r,n){var o=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o!=null){var f,d,h=[],y=!0,k=!1;try{for(o=o.call(r);!(y=(f=o.next()).done)&&(h.push(f.value),!n||h.length!==n);y=!0);}catch(A){k=!0,d=A}finally{try{y||o.return==null||o.return()}finally{if(k)throw d}}return h}}(t,e)||___unsupportedIterableToArray_89(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ___unsupportedIterableToArray_89(t,e){if(t){if(typeof t=="string")return ___arrayLikeToArray_89(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?___arrayLikeToArray_89(t,e):void 0}}function ___arrayLikeToArray_89(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function surge_port_hopping(t){var e=___slicedToArray_89(t.match(/,\s*?port-hopping\s*?=\s*?["']?\s*?((\d+(-\d+)?)([,;]\d+(-\d+)?)*)\s*?["']?\s*?/)||[],2),r=e[0],n=e[1];return{port_hopping:n?n.replace(/;/g,","):void 0,line:r?t.replace(r,""):t}}function __isIP_89(t){return(0,_$utils_141.isIPv4)(t)||(0,_$utils_141.isIPv6)(t)}var ___default_89=[{name:"URI PROXY Parser",test:function(t){return/^(socks5\+tls|socks5|http|https):\/\//.test(t)},parse:function(t){var e=___slicedToArray_89(t.match(/^(socks5|http|http)(\+tls|s)?:\/\/(?:(.*?):(.*?)@)?(.*?):(\d+?)(\?.*?)?(?:#(.*?))?$/),9),r=(e[0],e[1]),n=e[2],o=e[3],f=e[4],d=e[5],h=e[6],y=(e[7],e[8]);return{name:y!=null?decodeURIComponent(y):"".concat(r," ").concat(d,":").concat(h),type:r,tls:!!n,server:d,port:h,username:o!=null?decodeURIComponent(o):void 0,password:f!=null?decodeURIComponent(f):void 0}}},{name:"URI SS Parser",test:function(t){return/^ss:\/\//.test(t)},parse:function(t){var e,r,n=t.split("ss://")[1],o={name:decodeURIComponent(t.split("#")[1]),type:"ss"},f=(n=n.split("#")[0]).match(/@([^/]*)(\/|$)/),d=decodeURIComponent(n.split("@")[0]);r=d!=null&&d.startsWith("2022-blake3-")?d:_$base64_20.Base64.decode(d);var h="";if(!f){if(n.includes("?")){var y=n.match(/^(.*)(\?.*)$/);n=y[1],h=y[2]}if(n=_$base64_20.Base64.decode(n),h){if(/(&|\?)v2ray-plugin=/.test(h)){var k=h.match(/(&|\?)v2ray-plugin=(.*?)(&|$)/)[2];k&&(o.plugin="v2ray-plugin",o["plugin-opts"]=JSON.parse(_$base64_20.Base64.decode(k)))}n="".concat(n).concat(h)}r=n.split("@")[0],f=n.match(/@([^/]*)(\/|$)/)}var A=f[1],D=A.lastIndexOf(":");o.server=A.substring(0,D),o.port=(e="".concat(A.substring(D+1)).match(/\d+/))===null||e===void 0?void 0:e[0];var q=r.match(/(^.*?):(.*$)/);if(o.cipher=q?.[1],o.password=q?.[2],n.indexOf("?plugin=")!==-1){var H,z={},Z=___createForOfIteratorHelper_89(("plugin="+decodeURIComponent(n.split("?plugin=")[1].split("&")[0])).split(";"));try{for(Z.s();!(H=Z.n()).done;){var j=___slicedToArray_89(H.value.split("="),2),at=j[0],ct=j[1];at&&(z[at]=ct||!0)}}catch(ot){Z.e(ot)}finally{Z.f()}switch(z.plugin){case"obfs-local":case"simple-obfs":o.plugin="obfs",o["plugin-opts"]={mode:z.obfs,host:(0,_$utils_141.getIfNotBlank)(z["obfs-host"])};break;case"v2ray-plugin":o.plugin="v2ray-plugin",o["plugin-opts"]={mode:"websocket",host:(0,_$utils_141.getIfNotBlank)(z["obfs-host"]),path:(0,_$utils_141.getIfNotBlank)(z.path),tls:(0,_$utils_141.getIfPresent)(z.tls)};break;default:throw new Error("Unsupported plugin option: ".concat(z.plugin))}}return/(&|\?)uot=(1|true)/i.test(h)&&(o["udp-over-tcp"]=!0),/(&|\?)tfo=(1|true)/i.test(h)&&(o.tfo=!0),o}},{name:"URI SSR Parser",test:function(t){return/^ssr:\/\//.test(t)},parse:function(t){var e=(t=_$base64_20.Base64.decode(t.split("ssr://")[1])).indexOf(":origin");e===-1&&(e=t.indexOf(":auth_"));var r=t.substring(0,e),n=r.substring(0,r.lastIndexOf(":")),o=r.substring(r.lastIndexOf(":")+1),f=t.substring(e+1).split("/?")[0].split(":"),d={type:"ssr",server:n,port:o,protocol:f[0],cipher:f[1],obfs:f[2],password:_$base64_20.Base64.decode(f[3])},h={};if((t=t.split("/?")[1].split("&")).length>1){var y,k=___createForOfIteratorHelper_89(t);try{for(k.s();!(y=k.n()).done;){var A=___slicedToArray_89(y.value.split("="),2),D=A[0],q=A[1];(q=q.trim()).length>0&&q!=="(null)"&&(h[D]=q)}}catch(H){k.e(H)}finally{k.f()}}return ___objectSpread_89(___objectSpread_89({},d),{},{name:h.remarks?_$base64_20.Base64.decode(h.remarks):d.server,"protocol-param":(0,_$utils_141.getIfNotBlank)(_$base64_20.Base64.decode(h.protoparam||"").replace(/\s/g,"")),"obfs-param":(0,_$utils_141.getIfNotBlank)(_$base64_20.Base64.decode(h.obfsparam||"").replace(/\s/g,""))})}},{name:"URI VMess Parser",test:function(t){return/^vmess:\/\//.test(t)},parse:function(t){t=t.split("vmess://")[1];var e=_$base64_20.Base64.decode(t);if(/=\s*vmess/.test(e)){var r,n=e.split(",").map(function(M){return M.trim()}),o={},f=___createForOfIteratorHelper_89(n);try{for(f.s();!(r=f.n()).done;){var d=r.value;if(d.indexOf("=")!==-1){var h=___slicedToArray_89(d.split("="),2),y=h[0],k=h[1];o[y.trim()]=k.trim()}}}catch(M){f.e(M)}finally{f.f()}var A={name:n[0].split("=")[0].trim(),type:"vmess",server:n[1],port:n[2],cipher:(0,_$utils_141.getIfNotBlank)(n[3],"auto"),uuid:n[4].match(/^"(.*)"$/)[1],tls:o.obfs==="wss",udp:(0,_$utils_141.getIfPresent)(o["udp-relay"]),tfo:(0,_$utils_141.getIfPresent)(o["fast-open"]),"skip-cert-verify":(0,_$utils_141.isPresent)(o["tls-verification"])?!o["tls-verification"]:void 0};if((0,_$utils_141.isPresent)(o.obfs)){if(o.obfs!=="ws"&&o.obfs!=="wss")throw new Error("Unsupported obfs: ".concat(o.obfs));A.network="ws",A["ws-opts"].path=((0,_$utils_141.getIfNotBlank)(o["obfs-path"])||'"/"').match(/^"(.*)"$/)[1];var D=o["obfs-header"];D&&D.indexOf("Host")!==-1&&(D=D.match(/Host:\s*([a-zA-Z0-9-.]*)/)[1]),(0,_$utils_141.isNotBlank)(D)&&(A["ws-opts"].headers={Host:D})}return A}var q,H,z,Z,j={};try{j=JSON.parse(e)}catch{var at=___slicedToArray_89(/(^[^?]+?)\/?\?(.*)$/.exec(t),3),ct=(at[0],at[1]),ot=at[2];e=_$base64_20.Base64.decode(ct);var tt,gt=___createForOfIteratorHelper_89(ot.split("&"));try{for(gt.s();!(tt=gt.n()).done;){var wt=___slicedToArray_89(tt.value.split("="),2),ft=wt[0],yt=wt[1],Ct=yt;(Ct=decodeURIComponent(yt)).indexOf(",")===-1?j[ft]=Ct:j[ft]=Ct.split(",")}}catch(et){gt.e(et)}finally{gt.f()}var l=___slicedToArray_89(/(^[^:]+?):([^:]+?)@(.*):(\d+)$/.exec(e),5),s=(l[0],l[1]),b=l[2],$=l[3],E=l[4];j.scy=s,j.id=b,j.port=E,j.add=$}var rt=j.add,_t=parseInt((0,_$utils_141.getIfPresent)(j.port),10),xt={name:(q=(H=(z=j.ps)!==null&&z!==void 0?z:j.remarks)!==null&&H!==void 0?H:j.remark)!==null&&q!==void 0?q:"VMess ".concat(rt,":").concat(_t),type:"vmess",server:rt,port:_t,cipher:(0,_$utils_141.getIfPresent)(j.scy,"auto"),uuid:j.id,alterId:parseInt((0,_$utils_141.getIfPresent)((Z=j.aid)!==null&&Z!==void 0?Z:j.alterId,0),10),tls:["tls",!0,1,"1"].includes(j.tls),"skip-cert-verify":(0,_$utils_141.isPresent)(j.verify_cert)?!j.verify_cert:void 0};!xt["skip-cert-verify"]&&(0,_$utils_141.isPresent)(j.allowInsecure)&&(xt["skip-cert-verify"]=/(TRUE)|1/i.test(j.allowInsecure)),xt.tls&&j.sni&&j.sni!==""&&(xt.sni=j.sni);var St=!1;if(j.net==="ws"||j.obfs==="websocket"?xt.network="ws":["http"].includes(j.net)||["http"].includes(j.obfs)||["http"].includes(j.type)?xt.network="http":["grpc"].includes(j.net)?xt.network="grpc":j.net==="httpupgrade"||xt.network==="httpupgrade"?(xt.network="ws",St=!0):j.net!=="h2"&&xt.network!=="h2"||(xt.network="h2"),xt.network){var x,N=(x=j.host)!==null&&x!==void 0?x:j.obfsParam;try{var V=JSON.parse(N),S=V?.Host;S&&(N=S)}catch{}var C=j.path;if(xt.network==="http"&&(N&&(N=N.split(",").map(function(M){return M.trim()}),N=Array.isArray(N)?N[0]:N),C=C?Array.isArray(C)?C[0]:C:"/"),C||N)if(["grpc"].includes(xt.network))xt["".concat(xt.network,"-opts")]={"grpc-service-name":(0,_$utils_141.getIfNotBlank)(C),"_grpc-type":(0,_$utils_141.getIfNotBlank)(j.type),"_grpc-authority":(0,_$utils_141.getIfNotBlank)(j.authority)};else{var T={path:(0,_$utils_141.getIfNotBlank)(C),headers:{Host:(0,_$utils_141.getIfNotBlank)(N)}};St&&(T["v2ray-http-upgrade"]=!0,T["v2ray-http-upgrade-fast-open"]=!0),xt["".concat(xt.network,"-opts")]=T}else delete xt.network}return xt}},{name:"URI VLESS Parser",test:function(t){return/^vless:\/\//.test(t)},parse:function(t){var e,r,n,o;t=t.split("vless://")[1];var f=/^(.*?)@(.*?):(\d+)\/?(\?(.*?))?(?:#(.*?))?$/.exec(t);if(!f){var d=___slicedToArray_89(/^(.*?)(\?.*?$)/.exec(t),3),h=(d[0],d[1]),y=d[2];t="".concat(_$base64_20.Base64.decode(h)).concat(y),f=/^(.*?)@(.*?):(\d+)\/?(\?(.*?))?(?:#(.*?))?$/.exec(t),o=!0}var k=___slicedToArray_89(f,7),A=(k[0],k[1]),D=k[2],q=k[3],H=(k[4],k[5]),z=H===void 0?"":H,Z=k[6];o&&(A=A.replace(/^.*?:/g,"")),q=parseInt("".concat(q),10),A=decodeURIComponent(A),Z!=null&&(Z=decodeURIComponent(Z));var j,at,ct={type:"vless",name:Z,server:D,port:q,uuid:A},ot={},tt=___createForOfIteratorHelper_89(z.split("&"));try{for(tt.s();!(j=tt.n()).done;){var gt,wt=___slicedToArray_89(j.value.split("="),2),ft=wt[0],yt=wt[1];gt=decodeURIComponent(yt),ot[ft]=gt}}catch(_t){tt.e(_t)}finally{tt.f()}if(ct.name=(e=(r=(n=Z)!==null&&n!==void 0?n:ot.remarks)!==null&&r!==void 0?r:ot.remark)!==null&&e!==void 0?e:"VLESS ".concat(D,":").concat(q),ct.tls=ot.security&&ot.security!=="none",o&&/TRUE|1/i.test(ot.tls)&&(ct.tls=!0,ot.security=(at=ot.security)!==null&&at!==void 0?at:"reality"),ct.sni=ot.sni||ot.peer,ct.flow=ot.flow,!ct.flow&&o&&ot.xtls){var Ct=[void 0,"xtls-rprx-direct","xtls-rprx-vision"][ot.xtls];Ct&&(ct.flow=Ct)}if(ct["client-fingerprint"]=ot.fp,ct.alpn=ot.alpn?ot.alpn.split(","):void 0,ct["skip-cert-verify"]=/(TRUE)|1/i.test(ot.allowInsecure),["reality"].includes(ot.security)){var l={};ot.pbk&&(l["public-key"]=ot.pbk),ot.sid&&(l["short-id"]=ot.sid),Object.keys(l).length>0&&(ct["".concat(ot.security,"-opts")]=l)}var s=!1;if(ct.network=ot.type,ct.network==="tcp"&&ot.headerType==="http"?ct.network="http":ct.network==="httpupgrade"&&(ct.network="ws",s=!0),!ct.network&&o&&ot.obfs&&(ct.network=ot.obfs),["websocket"].includes(ct.network)&&(ct.network="ws"),ct.network&&!["tcp","none"].includes(ct.network)){var b,$={},E=(b=ot.host)!==null&&b!==void 0?b:ot.obfsParam;if(E)if(ot.obfsParam)try{var rt=JSON.parse(E);$.headers=rt}catch{$.headers={Host:E}}else $.headers={Host:E};ot.serviceName?($["".concat(ct.network,"-service-name")]=ot.serviceName,["grpc"].includes(ct.network)&&ot.authority&&($["_grpc-authority"]=ot.authority)):o&&ot.path&&(["ws","http","h2"].includes(ct.network)||($["".concat(ct.network,"-service-name")]=ot.path,delete ot.path)),ot.path&&($.path=ot.path),["grpc"].includes(ct.network)&&($["_grpc-type"]=ot.mode||"gun"),s&&($["v2ray-http-upgrade"]=!0,$["v2ray-http-upgrade-fast-open"]=!0),Object.keys($).length>0&&(ct["".concat(ct.network,"-opts")]=$),ct.network==="kcp"&&(ot.seed&&(ct.seed=ot.seed),ct.headerType=ot.headerType||"none")}return ct}},{name:"URI TUIC Parser",test:function(t){return/^tuic:\/\//.test(t)},parse:function(t){var e;t=t.split(/tuic:\/\//)[1];var r=___slicedToArray_89(/^(.*?):(.*?)@(.*?)(:(\d+))?\/?(\?(.*?))?(?:#(.*?))?$/.exec(t),9),n=(r[0],r[1]),o=r[2],f=r[3],d=(r[4],r[5]),h=(r[6],r[7]),y=h===void 0?"":h,k=r[8];d=parseInt("".concat(d),10),isNaN(d)&&(d=443),o=decodeURIComponent(o),k!=null&&(k=decodeURIComponent(k));var A,D={type:"tuic",name:k=(e=k)!==null&&e!==void 0?e:"TUIC ".concat(f,":").concat(d),server:f,port:d,password:o,uuid:n},q=___createForOfIteratorHelper_89(y.split("&"));try{for(q.s();!(A=q.n()).done;){var H=___slicedToArray_89(A.value.split("="),2),z=H[0],Z=H[1];z=z.replace(/_/,"-"),Z=decodeURIComponent(Z),["alpn"].includes(z)?D[z]=Z?Z.split(","):void 0:["allow-insecure"].includes(z)?D["skip-cert-verify"]=/(TRUE)|1/i.test(Z):["disable-sni","reduce-rtt"].includes(z)?D[z]=/(TRUE)|1/i.test(Z):D[z]=Z}}catch(j){q.e(j)}finally{q.f()}return D}},{name:"URI WireGuard Parser",test:function(t){return/^(wireguard|wg):\/\//.test(t)},parse:function(t){var e;t=t.split(/(wireguard|wg):\/\//)[2];var r=___slicedToArray_89(/^((.*?)@)?(.*?)(:(\d+))?\/?(\?(.*?))?(?:#(.*?))?$/.exec(t),9),n=(r[0],r[1],r[2]),o=r[3],f=(r[4],r[5]),d=(r[6],r[7]),h=d===void 0?"":d,y=r[8];f=parseInt("".concat(f),10),isNaN(f)&&(f=51820),n=decodeURIComponent(n),y!=null&&(y=decodeURIComponent(y));var k,A={type:"wireguard",name:y=(e=y)!==null&&e!==void 0?e:"WireGuard ".concat(o,":").concat(f),server:o,port:f,"private-key":n,udp:!0},D=___createForOfIteratorHelper_89(h.split("&"));try{for(D.s();!(k=D.n()).done;){var q=___slicedToArray_89(k.value.split("="),2),H=q[0],z=q[1];if(H=H.replace(/_/,"-"),z=decodeURIComponent(z),["reserved"].includes(H)){var Z=z.split(",").map(function(at){return parseInt(at.trim(),10)}).filter(function(at){return Number.isInteger(at)});Z.length===3&&(A[H]=Z)}else if(["address","ip"].includes(H))z.split(",").map(function(at){var ct=at.trim().replace(/\/\d+$/,"").replace(/^\[/,"").replace(/\]$/,"");(0,_$utils_141.isIPv4)(ct)?A.ip=ct:(0,_$utils_141.isIPv6)(ct)&&(A.ipv6=ct)});else if(["mtu"].includes(H)){var j=parseInt(z.trim(),10);Number.isInteger(j)&&(A[H]=j)}else/publickey/i.test(H)?A["public-key"]=z:/privatekey/i.test(H)?A["private-key"]=z:["udp"].includes(H)?A[H]=/(TRUE)|1/i.test(z):["flag"].includes(H)||(A[H]=z)}}catch(at){D.e(at)}finally{D.f()}return A}},{name:"URI Hysteria Parser",test:function(t){return/^(hysteria|hy):\/\//.test(t)},parse:function(t){var e;t=t.split(/(hysteria|hy):\/\//)[2];var r=___slicedToArray_89(/^(.*?)(:(\d+))?\/?(\?(.*?))?(?:#(.*?))?$/.exec(t),7),n=(r[0],r[1]),o=(r[2],r[3]),f=(r[4],r[5]),d=f===void 0?"":f,h=r[6];o=parseInt("".concat(o),10),isNaN(o)&&(o=443),h!=null&&(h=decodeURIComponent(h));var y,k={type:"hysteria",name:h=(e=h)!==null&&e!==void 0?e:"Hysteria ".concat(n,":").concat(o),server:n,port:o},A={},D=___createForOfIteratorHelper_89(d.split("&"));try{for(D.s();!(y=D.n()).done;){var q=___slicedToArray_89(y.value.split("="),2),H=q[0],z=q[1];H=H.replace(/_/,"-"),z=decodeURIComponent(z),["alpn"].includes(H)?k[H]=z?z.split(","):void 0:["insecure"].includes(H)?k["skip-cert-verify"]=/(TRUE)|1/i.test(z):["auth"].includes(H)?k["auth-str"]=z:["mport"].includes(H)?k.ports=z:["obfsParam"].includes(H)?k.obfs=z:["upmbps"].includes(H)?k.up=z:["downmbps"].includes(H)?k.down=z:["obfs"].includes(H)?k._obfs=z||"":["fast-open","peer"].includes(H)?A[H]=z:k[H]=z}}catch(Z){D.e(Z)}finally{D.f()}return!k.sni&&A.peer&&(k.sni=A.peer),!k["fast-open"]&&A.fastopen&&(k["fast-open"]=!0),k.protocol||(k.protocol="udp"),k}},{name:"URI Hysteria2 Parser",test:function(t){return/^(hysteria2|hy2):\/\//.test(t)},parse:function(t){var e,r;t=t.split(/(hysteria2|hy2):\/\//)[2];var n=___slicedToArray_89(/^(.*?)@(.*?)(:((\d+(-\d+)?)([,;]\d+(-\d+)?)*))?\/?(\?(.*?))?(?:#(.*?))?$/.exec(t),12),o=(n[0],n[1]),f=n[2],d=(n[3],n[4]),h=(n[5],n[6],n[7],n[8],n[9],n[10]),y=h===void 0?"":h,k=n[11];/^\d+$/.test(d)?(d=parseInt("".concat(d),10),isNaN(d)&&(d=443)):d?(r=d,d=(0,_$utils_141.getRandomPort)(r)):d=443,o=decodeURIComponent(o),k!=null&&(k=decodeURIComponent(k));var A,D={type:"hysteria2",name:k=(e=k)!==null&&e!==void 0?e:"Hysteria2 ".concat(f,":").concat(d),server:f,port:d,ports:r,password:o},q={},H=___createForOfIteratorHelper_89(y.split("&"));try{for(H.s();!(A=H.n()).done;){var z,Z=___slicedToArray_89(A.value.split("="),2),j=Z[0],at=Z[1];z=decodeURIComponent(at),q[j]=z}}catch(ct){H.e(ct)}finally{H.f()}return D.sni=q.sni,!D.sni&&q.peer&&(D.sni=q.peer),q.obfs&&q.obfs!=="none"&&(D.obfs=q.obfs),D.ports=q.mport,D["obfs-password"]=q["obfs-password"],D["skip-cert-verify"]=/(TRUE)|1/i.test(q.insecure),D.tfo=/(TRUE)|1/i.test(q.fastopen),D["tls-fingerprint"]=q.pinSHA256,D}},{name:"URI Trojan Parser",test:function(t){return/^trojan:\/\//.test(t)},parse:function(t){var e=/^(trojan:\/\/.*?@.*?)(:(\d+))?\/?(\?.*?)?$/.exec(t);e?.[2]||(t=t.replace(e[1],"".concat(e[1],":443")));var r=___slicedToArray_89(t.split(/#(.+)/,2),2),n=r[0],o=r[1],f=(0,_trojanUri.default)().parse(n);if((0,_$utils_141.isNotBlank)(o))try{f.name=decodeURIComponent(o)}catch{}return f}},{name:"Clash Parser",test:function(t){try{JSON.parse(t)}catch{return!1}return!0},parse:function(t){var e=JSON.parse(t);if(!["ss","ssr","vmess","socks5","http","snell","trojan","tuic","vless","hysteria","hysteria2","wireguard","ssh","direct"].includes(e.type))throw new Error("Clash does not support proxy with type: ".concat(e.type));return["vmess","vless"].includes(e.type)&&(e.sni=e.servername,delete e.servername),e["server-cert-fingerprint"]&&(e["tls-fingerprint"]=e["server-cert-fingerprint"]),e.fingerprint&&(e["tls-fingerprint"]=e.fingerprint),e["dialer-proxy"]&&(e["underlying-proxy"]=e["dialer-proxy"]),e["benchmark-url"]&&(e["test-url"]=e["benchmark-url"]),e["benchmark-timeout"]&&(e["test-timeout"]=e["benchmark-timeout"]),e}},{name:"Surge Direct Parser",test:function(t){return/^.*=\s*direct/.test(t.split(",")[0])},parse:function(t){return(0,___surge_89.default)().parse(t)}},{name:"Surge SSH Parser",test:function(t){return/^.*=\s*ssh/.test(t.split(",")[0])},parse:function(t){return(0,___surge_89.default)().parse(t)}},{name:"Surge SS Parser",test:function(t){return/^.*=\s*ss/.test(t.split(",")[0])},parse:function(t){return(0,___surge_89.default)().parse(t)}},{name:"Surge VMess Parser",test:function(t){return/^.*=\s*vmess/.test(t.split(",")[0])&&t.indexOf("username")!==-1},parse:function(t){return(0,___surge_89.default)().parse(t)}},{name:"Surge Trojan Parser",test:function(t){return/^.*=\s*trojan/.test(t.split(",")[0])},parse:function(t){return(0,___surge_89.default)().parse(t)}},{name:"Surge HTTP Parser",test:function(t){return/^.*=\s*https?/.test(t.split(",")[0])},parse:function(t){return(0,___surge_89.default)().parse(t)}},{name:"Surge Snell Parser",test:function(t){return/^.*=\s*snell/.test(t.split(",")[0])},parse:function(t){return(0,___surge_89.default)().parse(t)}},{name:"Surge Tuic Parser",test:function(t){return/^.*=\s*tuic(-v5)?/.test(t.split(",")[0])},parse:function(t){var e=surge_port_hopping(t),r=e.port_hopping,n=e.line,o=(0,___surge_89.default)().parse(n);return o.ports=r,o}},{name:"Surge WireGuard Parser",test:function(t){return/^.*=\s*wireguard/.test(t.split(",")[0])},parse:function(t){return(0,___surge_89.default)().parse(t)}},{name:"Surge Hysteria2 Parser",test:function(t){return/^.*=\s*hysteria2/.test(t.split(",")[0])},parse:function(t){var e=surge_port_hopping(t),r=e.port_hopping,n=e.line,o=(0,___surge_89.default)().parse(n);return o.ports=r,o}},{name:"Surge Socks5 Parser",test:function(t){return/^.*=\s*socks5(-tls)?/.test(t.split(",")[0])},parse:function(t){return(0,___surge_89.default)().parse(t)}},{name:"Surge External Parser",test:function(t){return/^.*=\s*external/.test(t.split(",")[0])},parse:function(t){var e,r,n,o=___slicedToArray_89(/^\s*(.*?)\s*?=\s*?external\s*?,\s*(.*?)\s*$/.exec(t),3),f=(o[0],o[1]),d=o[2],h=(e=/(,|^)\s*?exec\s*?=\s*"(.*?)"\s*?(,|$)/.exec(t=d))===null||e===void 0?void 0:e[2];h||(h=(n=/(,|^)\s*?exec\s*?=\s*(.*?)\s*?(,|$)/.exec(t))===null||n===void 0?void 0:n[2]);var y,k=(r=/(,|^)\s*?local-port\s*?=\s*"(.*?)"\s*?(,|$)/.exec(t))===null||r===void 0?void 0:r[2];k||(k=(y=/(,|^)\s*?local-port\s*?=\s*(.*?)\s*?(,|$)/.exec(t))===null||y===void 0?void 0:y[2]);for(var A,D=/(,|^)\s*?args\s*?=\s*("(.*?)"|(.*?))(?=\s*?(,|$))/g,q=[];(A=D.exec(t))!==null;)A[3]!=null?q.push(A[3]):A[4]!=null&&q.push(A[4]);for(var H,z=/(,|^)\s*?addresses\s*?=\s*("(.*?)"|(.*?))(?=\s*?(,|$))/g,Z=[];(H=z.exec(t))!==null;){var j=void 0;H[3]!=null?j=H[3]:H[4]!=null&&(j=H[4]),j!=null&&(j="".concat(j).trim().replace(/^\[/,"").replace(/\]$/,"")),__isIP_89(j)&&Z.push(j)}return{type:"external",name:f,exec:h,"local-port":k,args:q,addresses:Z}}},{name:"Loon SS Parser",test:function(t){return t.split(",")[0].split("=")[1].trim().toLowerCase()==="shadowsocks"},parse:function(t){return(0,___loon_89.default)().parse(t)}},{name:"Loon SSR Parser",test:function(t){return t.split(",")[0].split("=")[1].trim().toLowerCase()==="shadowsocksr"},parse:function(t){return(0,___loon_89.default)().parse(t)}},{name:"Loon VMess Parser",test:function(t){return/^.*=\s*vmess/i.test(t.split(",")[0])&&t.indexOf("username")===-1},parse:function(t){return(0,___loon_89.default)().parse(t)}},{name:"Loon Vless Parser",test:function(t){return/^.*=\s*vless/i.test(t.split(",")[0])},parse:function(t){return(0,___loon_89.default)().parse(t)}},{name:"Loon Hysteria2 Parser",test:function(t){return/^.*=\s*Hysteria2/i.test(t.split(",")[0])},parse:function(t){return(0,___loon_89.default)().parse(t)}},{name:"Loon Trojan Parser",test:function(t){return/^.*=\s*trojan/i.test(t.split(",")[0])},parse:function(t){return(0,___loon_89.default)().parse(t)}},{name:"Loon HTTP Parser",test:function(t){return/^.*=\s*http/i.test(t.split(",")[0])},parse:function(t){return(0,___loon_89.default)().parse(t)}},{name:"Loon SOCKS5 Parser",test:function(t){return/^.*=\s*socks5/i.test(t.split(",")[0])},parse:function(t){return(0,___loon_89.default)().parse(t)}},{name:"Loon WireGuard Parser",test:function(t){return/^.*=\s*wireguard/i.test(t.split(",")[0])},parse:function(t){var e,r,n,o,f,d,h,y,k,A,D,q,H,z,Z=(e=t.match(/(^.*?)\s*?=\s*?wireguard\s*?,.+?\s*?=\s*?.+?/i))===null||e===void 0?void 0:e[1],j=(r=(t=t.replace(Z,"").replace(/^\s*?=\s*?wireguard\s*/i,"")).match(/,\s*?peers\s*?=\s*?\[\s*?\{\s*?(.+?)\s*?\}\s*?\]/i))===null||r===void 0?void 0:r[1],at=j.match(/(,|^)\s*?endpoint\s*?=\s*?"?(.+?):(\d+)"?\s*?(,|$)/i),ct=at?.[2],ot=parseInt(at?.[3],10),tt=(n=t.match(/(,|^)\s*?mtu\s*?=\s*?"?(\d+?)"?\s*?(,|$)/i))===null||n===void 0?void 0:n[2];tt&&(tt=parseInt(tt,10));var gt=(o=t.match(/(,|^)\s*?keepalive\s*?=\s*?"?(\d+?)"?\s*?(,|$)/i))===null||o===void 0?void 0:o[2];gt&&(gt=parseInt(gt,10));var wt,ft=(f=j.match(/(,|^)\s*?reserved\s*?=\s*?"?(\[\s*?.+?\s*?\])"?\s*?(,|$)/i))===null||f===void 0?void 0:f[2];ft&&(ft=JSON.parse(ft));var yt=(d=t.match(/(,|^)\s*?dns\s*?=\s*?"?(.+?)"?\s*?(,|$)/i))===null||d===void 0?void 0:d[2],Ct=(h=t.match(/(,|^)\s*?dnsv6\s*?=\s*?"?(.+?)"?\s*?(,|$)/i))===null||h===void 0?void 0:h[2];(yt||Ct)&&(wt=[],yt&&wt.push(yt),Ct&&wt.push(Ct));var l=(y=j.match(/(,|^)\s*?allowed-ips\s*?=\s*?"(.+?)"\s*?(,|$)/i))===null||y===void 0||(k=y[2])===null||k===void 0?void 0:k.split(",").map(function(_t){return _t.trim()}),s=(A=j.match(/(,|^)\s*?preshared-key\s*?=\s*?"?(.+?)"?\s*?(,|$)/i))===null||A===void 0?void 0:A[2],b=(D=t.match(/(,|^)\s*?interface-ip\s*?=\s*?"?(.+?)"?\s*?(,|$)/i))===null||D===void 0?void 0:D[2],$=(q=t.match(/(,|^)\s*?interface-ipv6\s*?=\s*?"?(.+?)"?\s*?(,|$)/i))===null||q===void 0?void 0:q[2],E=(H=j.match(/(,|^)\s*?public-key\s*?=\s*?"?(.+?)"?\s*?(,|$)/i))===null||H===void 0?void 0:H[2],rt={type:"wireguard",name:Z,server:ct,port:ot,ip:b,ipv6:$,"private-key":(z=t.match(/(,|^)\s*?private-key\s*?=\s*?"?(.+?)"?\s*?(,|$)/i))===null||z===void 0?void 0:z[2],"public-key":E,mtu:tt,keepalive:gt,reserved:ft,"allowed-ips":l,"preshared-key":s,dns:wt,udp:!0,peers:[{server:ct,port:ot,ip:b,ipv6:$,"public-key":E,"pre-shared-key":s,"allowed-ips":l,reserved:ft}]};return Array.isArray(rt.dns)&&rt.dns.length>0&&(rt["remote-dns-resolve"]=!0),rt}},{name:"QX SS Parser",test:function(t){return/^shadowsocks\s*=/.test(t.split(",")[0].trim())&&t.indexOf("ssr-protocol")===-1},parse:function(t){return(0,___qx_89.default)().parse(t)}},{name:"QX SSR Parser",test:function(t){return/^shadowsocks\s*=/.test(t.split(",")[0].trim())&&t.indexOf("ssr-protocol")!==-1},parse:function(t){return(0,___qx_89.default)().parse(t)}},{name:"QX VMess Parser",test:function(t){return/^vmess\s*=/.test(t.split(",")[0].trim())},parse:function(t){return(0,___qx_89.default)().parse(t)}},{name:"QX VLESS Parser",test:function(t){return/^vless\s*=/.test(t.split(",")[0].trim())},parse:function(t){return(0,___qx_89.default)().parse(t)}},{name:"QX Trojan Parser",test:function(t){return/^trojan\s*=/.test(t.split(",")[0].trim())},parse:function(t){return(0,___qx_89.default)().parse(t)}},{name:"QX HTTP Parser",test:function(t){return/^http\s*=/.test(t.split(",")[0].trim())},parse:function(t){return(0,___qx_89.default)().parse(t)}},{name:"QX Socks5 Parser",test:function(t){return/^socks5\s*=/.test(t.split(",")[0].trim())},parse:function(t){return(0,___qx_89.default)().parse(t)}}];_$parsers_89.default=___default_89;var _$gist_139={};function ___typeof_139(t){return(___typeof_139=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$gist_139,"__esModule",{value:!0}),_$gist_139.default=void 0;var ___app_139=___interopRequireDefault_139(_$app_87);function ___interopRequireDefault_139(t){return t&&t.__esModule?t:{default:t}}function ___slicedToArray_139(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||___unsupportedIterableToArray_139(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArrayLimit(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,f=[],d=!0,h=!1;try{for(r=r.call(t);!(d=(n=r.next()).done)&&(f.push(n.value),!e||f.length!==e);d=!0);}catch(y){h=!0,o=y}finally{try{d||r.return==null||r.return()}finally{if(h)throw o}}return f}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function ___regeneratorRuntime_139(){___regeneratorRuntime_139=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=typeof Symbol=="function"?Symbol:{},o=n.iterator||"@@iterator",f=n.asyncIterator||"@@asyncIterator",d=n.toStringTag||"@@toStringTag";function h(l,s,b){return Object.defineProperty(l,s,{value:b,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,b,$){return s[b]=$}}function y(l,s,b,$){var E=s&&s.prototype instanceof D?s:D,rt=Object.create(E.prototype),_t=new ft($||[]);return rt._invoke=function(xt,St,x){var N="suspendedStart";return function(V,S){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(V==="throw")throw S;return{value:void 0,done:!0}}for(x.method=V,x.arg=S;;){var C=x.delegate;if(C){var T=tt(C,x);if(T){if(T===A)continue;return T}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var M=k(xt,St,x);if(M.type==="normal"){if(N=x.done?"completed":"suspendedYield",M.arg===A)continue;return{value:M.arg,done:x.done}}M.type==="throw"&&(N="completed",x.method="throw",x.arg=M.arg)}}}(l,b,_t),rt}function k(l,s,b){try{return{type:"normal",arg:l.call(s,b)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var A={};function D(){}function q(){}function H(){}var z={};h(z,o,function(){return this});var Z=Object.getPrototypeOf,j=Z&&Z(Z(yt([])));j&&j!==e&&r.call(j,o)&&(z=j);var at=H.prototype=D.prototype=Object.create(z);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(b){return this._invoke(s,b)})})}function ot(l,s){var b;this._invoke=function($,E){function rt(){return new s(function(_t,xt){(function St(x,N,V,S){var C=k(l[x],l,N);if(C.type!=="throw"){var T=C.arg,M=T.value;return M&&___typeof_139(M)=="object"&&r.call(M,"__await")?s.resolve(M.__await).then(function(et){St("next",et,V,S)},function(et){St("throw",et,V,S)}):s.resolve(M).then(function(et){T.value=et,V(T)},function(et){return St("throw",et,V,S)})}S(C.arg)})($,E,_t,xt)})}return b=b?b.then(rt,rt):rt()}}function tt(l,s){var b=l.iterator[s.method];if(b===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,tt(l,s),s.method==="throw"))return A;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var $=k(b,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,A;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,A):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,A)}function gt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function wt(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function ft(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(gt,this),this.reset(!0)}function yt(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var b=-1,$=function E(){for(;++b<l.length;)if(r.call(l,b))return E.value=l[b],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:Ct}}function Ct(){return{value:void 0,done:!0}}return q.prototype=H,h(at,"constructor",H),h(H,"constructor",q),q.displayName=h(H,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===q||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,H):(l.__proto__=H,h(l,d,"GeneratorFunction")),l.prototype=Object.create(at),l},t.awrap=function(l){return{__await:l}},ct(ot.prototype),h(ot.prototype,f,function(){return this}),t.AsyncIterator=ot,t.async=function(l,s,b,$,E){E===void 0&&(E=Promise);var rt=new ot(y(l,s,b,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(_t){return _t.done?_t.value:rt.next()})},ct(at),h(at,d,"Generator"),h(at,o,function(){return this}),h(at,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var b in l)s.push(b);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=yt,ft.prototype={constructor:ft,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(wt),!l)for(var s in this)s.charAt(0)==="t"&&r.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function b(St,x){return rt.type="throw",rt.arg=l,s.next=St,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return b("end");if(E.tryLoc<=this.prev){var _t=r.call(E,"catchLoc"),xt=r.call(E,"finallyLoc");if(_t&&xt){if(this.prev<E.catchLoc)return b(E.catchLoc,!0);if(this.prev<E.finallyLoc)return b(E.finallyLoc)}else if(_t){if(this.prev<E.catchLoc)return b(E.catchLoc,!0)}else{if(!xt)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return b(E.finallyLoc)}}}},abrupt:function(l,s){for(var b=this.tryEntries.length-1;b>=0;--b){var $=this.tryEntries[b];if($.tryLoc<=this.prev&&r.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,A):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),A},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.finallyLoc===l)return this.complete(b.completion,b.afterLoc),wt(b),A}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.tryLoc===l){var $=b.completion;if($.type==="throw"){var E=$.arg;wt(b)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,b){return this.delegate={iterator:yt(l),resultName:s,nextLoc:b},this.method==="next"&&(this.arg=void 0),A}},t}function ___createForOfIteratorHelper_139(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=___unsupportedIterableToArray_139(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){r=r.call(t)},n:function(){var y=r.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||r.return==null||r.return()}finally{if(h)throw f}}}}function ___unsupportedIterableToArray_139(t,e){if(t){if(typeof t=="string")return ___arrayLikeToArray_139(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?___arrayLikeToArray_139(t,e):void 0}}function ___arrayLikeToArray_139(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function __asyncGeneratorStep_139(t,e,r,n,o,f,d){try{var h=t[f](d),y=h.value}catch(k){return void r(k)}h.done?e(y):Promise.resolve(y).then(n,o)}function ___asyncToGenerator_139(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var f=t.apply(e,r);function d(y){__asyncGeneratorStep_139(f,n,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_139(f,n,o,d,h,"throw",y)}d(void 0)})}}function __ownKeys_139(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function ___objectSpread_139(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_139(Object(r),!0).forEach(function(n){___defineProperty_139(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):__ownKeys_139(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ___defineProperty_139(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ___classCallCheck_139(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ___defineProperties_139(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ___createClass_139(t,e,r){return e&&___defineProperties_139(t.prototype,e),r&&___defineProperties_139(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var Gist=function(){function Gist(_ref){var token=_ref.token,key=_ref.key,syncPlatform=_ref.syncPlatform;___classCallCheck_139(this,Gist);var _ENV=(0,_$openApi_151.ENV)(),isStash=_ENV.isStash,isLoon=_ENV.isLoon,isShadowRocket=_ENV.isShadowRocket,isQX=_ENV.isQX,_$$read=___app_139.default.read(_$constants_86.SETTINGS_KEY),defaultProxy=_$$read.defaultProxy,timeout=_$$read.defaultTimeout,proxy=defaultProxy;___app_139.default.env.isNode&&(proxy=proxy||eval("process.env.SUB_STORE_BACKEND_DEFAULT_PROXY")),syncPlatform==="gitlab"?(this.headers={"PRIVATE-TOKEN":"".concat(token),"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.141 Safari/537.36"},this.http=(0,_$openApi_151.HTTP)(___objectSpread_139(___objectSpread_139(___objectSpread_139(___objectSpread_139(___objectSpread_139({baseURL:"https://gitlab.com/api/v4",headers:___objectSpread_139(___objectSpread_139(___objectSpread_139({},this.headers),isStash&&proxy?{"X-Stash-Selected-Proxy":encodeURIComponent(proxy)}:{}),isShadowRocket&&proxy?{"X-Surge-Policy":proxy}:{})},proxy?{proxy}:{}),isLoon&&proxy?{node:proxy}:{}),isQX&&proxy?{opts:{policy:proxy}}:{}),proxy?(0,_$utils_141.getPolicyDescriptor)(proxy):{}),{},{timeout:timeout||8e3,events:{onResponse:function(t){if(/^[45]/.test(String(t.statusCode))){var e,r,n=JSON.parse(t.body);return Promise.reject("ERROR: ".concat((e=(r=n.message)===null||r===void 0?void 0:r.error)!==null&&e!==void 0?e:n.message))}return t}}}))):(this.headers={Authorization:"token ".concat(token),"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.141 Safari/537.36"},this.http=(0,_$openApi_151.HTTP)(___objectSpread_139(___objectSpread_139(___objectSpread_139(___objectSpread_139(___objectSpread_139({baseURL:"https://api.github.com",headers:___objectSpread_139(___objectSpread_139(___objectSpread_139({},this.headers),isStash&&proxy?{"X-Stash-Selected-Proxy":encodeURIComponent(proxy)}:{}),isShadowRocket&&proxy?{"X-Surge-Policy":proxy}:{})},proxy?{proxy}:{}),isLoon&&proxy?{node:proxy}:{}),isQX&&proxy?{opts:{policy:proxy}}:{}),proxy?(0,_$utils_141.getPolicyDescriptor)(proxy):{}),{},{timeout:timeout||8e3,events:{onResponse:function(t){return/^[45]/.test(String(t.statusCode))?Promise.reject("ERROR: ".concat(JSON.parse(t.body).message)):t}}}))),this.key=key,this.syncPlatform=syncPlatform}return ___createClass_139(Gist,[{key:"locate",value:(_locate=___asyncToGenerator_139(___regeneratorRuntime_139().mark(function t(){var e=this;return ___regeneratorRuntime_139().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(this.syncPlatform!=="gitlab"){r.next=4;break}return r.abrupt("return",this.http.get("/snippets").then(function(n){var o,f=___createForOfIteratorHelper_139(JSON.parse(n.body));try{for(f.s();!(o=f.n()).done;){var d=o.value;if(d.title===e.key)return d}}catch(h){f.e(h)}finally{f.f()}}));case 4:return r.abrupt("return",this.http.get("/gists").then(function(n){var o,f=___createForOfIteratorHelper_139(JSON.parse(n.body));try{for(f.s();!(o=f.n()).done;){var d=o.value;if(d.description===e.key)return d}}catch(h){f.e(h)}finally{f.f()}}));case 5:case"end":return r.stop()}},t,this)})),function(){return _locate.apply(this,arguments)})},{key:"upload",value:(_upload=___asyncToGenerator_139(___regeneratorRuntime_139().mark(function t(e){var r,n,o,f;return ___regeneratorRuntime_139().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(Object.keys(e).length!==0){d.next=2;break}return d.abrupt("return",Promise.reject("\u672A\u63D0\u4F9B\u9700\u4E0A\u4F20\u7684\u6587\u4EF6"));case 2:return d.next=4,this.locate();case 4:if(r=d.sent,n=e,r==null||!r.id){d.next=25;break}if(this.syncPlatform==="gitlab"&&(r.files=r.files.reduce(function(h,y){return h[y.path]=y,h},{})),o=[],f=___objectSpread_139({},r.files),Object.keys(n).map(function(h){f[h]?n[h].content==null||n[h].content===""?(delete f[h],o.push({action:"delete",file_path:h})):(f[h]=n[h],o.push({action:"update",file_path:h,content:n[h].content})):n[h].content==null||n[h].content===""?(delete f[h],delete n[h]):(f[h]=n[h],o.push({action:"create",file_path:h,content:n[h].content}))}),this.syncPlatform!=="gitlab"){d.next=20;break}if(Object.keys(f).length!==0){d.next=14;break}return d.abrupt("return",Promise.reject("\u672C\u6B21\u64CD\u4F5C\u5C06\u5BFC\u81F4\u6240\u6709\u6587\u4EF6\u7684\u5185\u5BB9\u90FD\u4E3A\u7A7A, \u65E0\u6CD5\u66F4\u65B0 snippet"));case 14:if(!(Object.keys(f).length>10)){d.next=16;break}return d.abrupt("return",Promise.reject("\u672C\u6B21\u64CD\u4F5C\u5C06\u5BFC\u81F4 snippet \u7684\u6587\u4EF6\u6570\u8D85\u8FC7 10, \u65E0\u6CD5\u66F4\u65B0 snippet"));case 16:return n=o,d.abrupt("return",this.http.put({headers:___objectSpread_139(___objectSpread_139({},this.headers),{},{"Content-Type":"application/json"}),url:"/snippets/".concat(r.id),body:JSON.stringify({files:n})}));case 20:if(Object.keys(f).length!==0){d.next=22;break}return d.abrupt("return",Promise.reject("\u672C\u6B21\u64CD\u4F5C\u5C06\u5BFC\u81F4\u6240\u6709\u6587\u4EF6\u7684\u5185\u5BB9\u90FD\u4E3A\u7A7A, \u65E0\u6CD5\u66F4\u65B0 gist"));case 22:return d.abrupt("return",this.http.patch({url:"/gists/".concat(r.id),body:JSON.stringify({files:n})}));case 23:d.next=36;break;case 25:if(n=Object.entries(n).reduce(function(h,y){var k=___slicedToArray_139(y,2),A=k[0],D=k[1];return D.content!==null&&D.content!==""&&(h[A]=D),h},{}),this.syncPlatform!=="gitlab"){d.next=33;break}if(Object.keys(n).length!==0){d.next=29;break}return d.abrupt("return",Promise.reject("\u6240\u6709\u6587\u4EF6\u7684\u5185\u5BB9\u90FD\u4E3A\u7A7A, \u65E0\u6CD5\u521B\u5EFA snippet"));case 29:return n=Object.keys(n).map(function(h){return{file_path:h,content:n[h].content}}),d.abrupt("return",this.http.post({headers:___objectSpread_139(___objectSpread_139({},this.headers),{},{"Content-Type":"application/json"}),url:"/snippets",body:JSON.stringify({title:this.key,visibility:"private",files:n})}));case 33:if(Object.keys(n).length!==0){d.next=35;break}return d.abrupt("return",Promise.reject("\u6240\u6709\u6587\u4EF6\u7684\u5185\u5BB9\u90FD\u4E3A\u7A7A, \u65E0\u6CD5\u521B\u5EFA gist"));case 35:return d.abrupt("return",this.http.post({url:"/gists",body:JSON.stringify({description:this.key,public:!1,files:n})}));case 36:case"end":return d.stop()}},t,this)})),function(t){return _upload.apply(this,arguments)})},{key:"download",value:function(){var t=___asyncToGenerator_139(___regeneratorRuntime_139().mark(function e(r){var n,o,f,d;return ___regeneratorRuntime_139().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.locate();case 2:if((n=h.sent)==null||!n.id){h.next=20;break}return h.prev=4,h.next=7,this.http.get("/gists/".concat(n.id)).then(function(y){return JSON.parse(y.body)});case 7:return o=h.sent,f=o.files,d=f[r].raw_url,h.next=12,this.http.get(d).then(function(y){return y.body});case 12:return h.abrupt("return",h.sent);case 15:return h.prev=15,h.t0=h.catch(4),h.abrupt("return",Promise.reject(h.t0));case 18:h.next=21;break;case 20:return h.abrupt("return",Promise.reject("\u627E\u4E0D\u5230 Sub-Store Gist"));case 21:case"end":return h.stop()}},e,this,[[4,15]])}));return function(e){return t.apply(this,arguments)}}()}]),Gist;var _upload,_locate}();_$gist_139.default=Gist;var _$preprocessors_113={};Object.defineProperty(_$preprocessors_113,"__esModule",{value:!0}),_$preprocessors_113.default=void 0;var ___default_113=[{name:"HTML",test:function(t){return/^<!DOCTYPE html>/.test(t)},parse:function(){return""}},{name:"Clash Provider",test:function(t){return/^payload:/gm.exec(t).index>=0},parse:function(t){return t.replace("payload:","").replace(/^\s*-\s*/gm,"")}}];_$preprocessors_113.default=___default_113;var _$producers_114={};Object.defineProperty(_$producers_114,"__esModule",{value:!0}),_$producers_114.default=void 0;var __obj_114,___yaml_114=(__obj_114=_$yaml_148)&&__obj_114.__esModule?__obj_114:{default:__obj_114},___default_114={QX:{type:"SINGLE",func:function(t){return["URL-REGEX","DEST-PORT","SRC-IP","IN-PORT","PROTOCOL","GEOSITE","GEOIP"].indexOf(t.type)!==-1?null:"".concat({"DOMAIN-KEYWORD":"HOST-KEYWORD","DOMAIN-SUFFIX":"HOST-SUFFIX",DOMAIN:"HOST","IP-CIDR6":"IP6-CIDR"}[t.type]||t.type,",").concat(t.content,",SUB-STORE")}},Surge:{type:"SINGLE",func:function(t){if(["GEOSITE","GEOIP"].indexOf(t.type)!==-1)return null;var e,r="".concat(t.type,",").concat(t.content);return["IP-CIDR","IP-CIDR6"].includes(t.type)&&(r+=((e=t.options)===null||e===void 0?void 0:e.length)>0?",".concat(t.options.join(",")):""),r}},Loon:{type:"SINGLE",func:function(t){return["SRC-IP","GEOSITE","GEOIP"].indexOf(t.type)!==-1?null:(["IP-CIDR","IP-CIDR6"].includes(t.type)&&t.options&&(t.options=t.options.filter(function(e){return["no-resolve"].includes(e)})),function(e){if(["GEOSITE","GEOIP"].indexOf(e.type)!==-1)return null;var r,n="".concat(e.type,",").concat(e.content);return["IP-CIDR","IP-CIDR6"].includes(e.type)&&(n+=((r=e.options)===null||r===void 0?void 0:r.length)>0?",".concat(e.options.join(",")):""),n}(t))}},Clash:{type:"ALL",func:function(t){var e={"DEST-PORT":"DST-PORT","SRC-IP":"SRC-IP-CIDR","IN-PORT":"SRC-PORT"},r={payload:t.map(function(n){var o,f="".concat(e[n.type]||n.type,",").concat(n.content);return["IP-CIDR","IP-CIDR6","GEOIP"].includes(n.type)&&(n.options&&(n.options=n.options.filter(function(d){return["no-resolve"].includes(d)})),f+=((o=n.options)===null||o===void 0?void 0:o.length)>0?",".concat(n.options.join(",")):""),f})};return ___yaml_114.default.dump(r)}}};_$producers_114.default=___default_114;var _$parsers_112={};function ___createForOfIteratorHelper_112(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(y,k){if(y){if(typeof y=="string")return ___arrayLikeToArray_112(y,void 0);var A=Object.prototype.toString.call(y).slice(8,-1);return A==="Object"&&y.constructor&&(A=y.constructor.name),A==="Map"||A==="Set"?Array.from(y):A==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(A)?___arrayLikeToArray_112(y,void 0):void 0}}(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){r=r.call(t)},n:function(){var y=r.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||r.return==null||r.return()}finally{if(h)throw f}}}}function ___arrayLikeToArray_112(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}Object.defineProperty(_$parsers_112,"__esModule",{value:!0}),_$parsers_112.default=void 0;var RULE_TYPES_MAPPING=[[/^(DOMAIN|host|HOST)$/,"DOMAIN"],[/^(DOMAIN-KEYWORD|host-keyword|HOST-KEYWORD)$/,"DOMAIN-KEYWORD"],[/^(DOMAIN-SUFFIX|host-suffix|HOST-SUFFIX)$/,"DOMAIN-SUFFIX"],[/^USER-AGENT$/i,"USER-AGENT"],[/^PROCESS-NAME$/,"PROCESS-NAME"],[/^(DEST-PORT|DST-PORT)$/,"DST-PORT"],[/^SRC-IP(-CIDR)?$/,"SRC-IP"],[/^(IN|SRC)-PORT$/,"IN-PORT"],[/^PROTOCOL$/,"PROTOCOL"],[/^IP-CIDR$/i,"IP-CIDR"],[/^(IP-CIDR6|ip6-cidr|IP6-CIDR)$/,"IP-CIDR6"],[/^GEOIP$/i,"GEOIP"],[/^GEOSITE$/i,"GEOSITE"]],___default_112=[{name:"Universal Rule Parser",test:function(){return!0},parse:function(t){var e,r=[],n=___createForOfIteratorHelper_112(t.split(`
`));try{for(n.s();!(e=n.n()).done;){var o=e.value;if((o=o.trim()).length!==0&&!/\s*#/.test(o))try{var f,d=o.split(",").map(function(q){return q.trim()}),h=d[0],y=!1,k=___createForOfIteratorHelper_112(RULE_TYPES_MAPPING);try{for(k.s();!(f=k.n()).done;){var A=f.value;if(A[0].test(h)){y=!0;var D={type:A[1],content:d[1]};["IP-CIDR","IP-CIDR6","GEOIP"].includes(D.type)&&(D.options=d.slice(2)),r.push(D)}}}catch(q){k.e(q)}finally{k.f()}if(!y)throw new Error("Invalid rule type: "+h)}catch{}}}catch(q){n.e(q)}finally{n.f()}return r}}];_$parsers_112.default=___default_112;var _$ruleUtils_111={};Object.defineProperty(_$ruleUtils_111,"__esModule",{value:!0}),_$ruleUtils_111.RuleUtils=void 0;var ___preprocessors_111=___interopRequireDefault_111(_$preprocessors_113),___producers_111=___interopRequireDefault_111(_$producers_114),___parsers_111=___interopRequireDefault_111(_$parsers_112),___app_111=___interopRequireDefault_111(_$app_87);function ___interopRequireDefault_111(t){return t&&t.__esModule?t:{default:t}}function ___createForOfIteratorHelper_111(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(y,k){if(y){if(typeof y=="string")return ___arrayLikeToArray_111(y,void 0);var A=Object.prototype.toString.call(y).slice(8,-1);return A==="Object"&&y.constructor&&(A=y.constructor.name),A==="Map"||A==="Set"?Array.from(y):A==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(A)?___arrayLikeToArray_111(y,void 0):void 0}}(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){r=r.call(t)},n:function(){var y=r.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||r.return==null||r.return()}finally{if(h)throw f}}}}function ___arrayLikeToArray_111(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var RuleUtils={parse:function(t){t=function(f){var d,h=___createForOfIteratorHelper_111(___preprocessors_111.default);try{for(h.s();!(d=h.n()).done;){var y=d.value;try{if(y.test(f))return ___app_111.default.info("Pre-processor [".concat(y.name,"] activated")),y.parse(f)}catch(k){___app_111.default.error("Parser [".concat(y.name,`] failed
 Reason: `).concat(k))}}}catch(k){h.e(k)}finally{h.f()}return f}(t);var e,r=___createForOfIteratorHelper_111(___parsers_111.default);try{for(r.s();!(e=r.n()).done;){var n=e.value,o=void 0;try{o=n.test(t)}catch{o=!1}if(o)return ___app_111.default.info("Rule parser [".concat(n.name,"] is activated!")),n.parse(t)}}catch(f){r.e(f)}finally{r.f()}},produce:function(t,e){var r=___producers_111.default[e];if(!r)throw new Error("Target platform: ".concat(e," is not supported!"));return r.type===void 0||r.type==="SINGLE"?t.map(function(n){try{return r.func(n)}catch{return""}}).filter(function(n){return n.length>0}).join(`
`):r.type==="ALL"?r.func(t):void 0}};_$ruleUtils_111.RuleUtils=RuleUtils;var _$artifacts_116={};function ___typeof_116(t){return(___typeof_116=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$artifacts_116,"__esModule",{value:!0}),_$artifacts_116.default=function(t){___app_116.default.read(_$constants_86.ARTIFACTS_KEY)||___app_116.default.write({},_$constants_86.ARTIFACTS_KEY),t.get("/api/artifacts/restore",restoreArtifacts),t.route("/api/artifacts").get(getAllArtifacts).post(createArtifact).put(replaceArtifact),t.route("/api/artifact/:name").get(getArtifact).patch(updateArtifact).delete(deleteArtifact)},_$artifacts_116.syncToGist=syncToGist;var ___app_116=___interopRequireDefault_116(_$app_87),___gist_116=___interopRequireDefault_116(_$gist_139);function ___interopRequireDefault_116(t){return t&&t.__esModule?t:{default:t}}function ___regeneratorRuntime_116(){___regeneratorRuntime_116=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=typeof Symbol=="function"?Symbol:{},o=n.iterator||"@@iterator",f=n.asyncIterator||"@@asyncIterator",d=n.toStringTag||"@@toStringTag";function h(l,s,b){return Object.defineProperty(l,s,{value:b,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,b,$){return s[b]=$}}function y(l,s,b,$){var E=s&&s.prototype instanceof D?s:D,rt=Object.create(E.prototype),_t=new ft($||[]);return rt._invoke=function(xt,St,x){var N="suspendedStart";return function(V,S){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(V==="throw")throw S;return{value:void 0,done:!0}}for(x.method=V,x.arg=S;;){var C=x.delegate;if(C){var T=tt(C,x);if(T){if(T===A)continue;return T}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var M=k(xt,St,x);if(M.type==="normal"){if(N=x.done?"completed":"suspendedYield",M.arg===A)continue;return{value:M.arg,done:x.done}}M.type==="throw"&&(N="completed",x.method="throw",x.arg=M.arg)}}}(l,b,_t),rt}function k(l,s,b){try{return{type:"normal",arg:l.call(s,b)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var A={};function D(){}function q(){}function H(){}var z={};h(z,o,function(){return this});var Z=Object.getPrototypeOf,j=Z&&Z(Z(yt([])));j&&j!==e&&r.call(j,o)&&(z=j);var at=H.prototype=D.prototype=Object.create(z);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(b){return this._invoke(s,b)})})}function ot(l,s){var b;this._invoke=function($,E){function rt(){return new s(function(_t,xt){(function St(x,N,V,S){var C=k(l[x],l,N);if(C.type!=="throw"){var T=C.arg,M=T.value;return M&&___typeof_116(M)=="object"&&r.call(M,"__await")?s.resolve(M.__await).then(function(et){St("next",et,V,S)},function(et){St("throw",et,V,S)}):s.resolve(M).then(function(et){T.value=et,V(T)},function(et){return St("throw",et,V,S)})}S(C.arg)})($,E,_t,xt)})}return b=b?b.then(rt,rt):rt()}}function tt(l,s){var b=l.iterator[s.method];if(b===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,tt(l,s),s.method==="throw"))return A;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var $=k(b,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,A;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,A):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,A)}function gt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function wt(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function ft(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(gt,this),this.reset(!0)}function yt(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var b=-1,$=function E(){for(;++b<l.length;)if(r.call(l,b))return E.value=l[b],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:Ct}}function Ct(){return{value:void 0,done:!0}}return q.prototype=H,h(at,"constructor",H),h(H,"constructor",q),q.displayName=h(H,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===q||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,H):(l.__proto__=H,h(l,d,"GeneratorFunction")),l.prototype=Object.create(at),l},t.awrap=function(l){return{__await:l}},ct(ot.prototype),h(ot.prototype,f,function(){return this}),t.AsyncIterator=ot,t.async=function(l,s,b,$,E){E===void 0&&(E=Promise);var rt=new ot(y(l,s,b,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(_t){return _t.done?_t.value:rt.next()})},ct(at),h(at,d,"Generator"),h(at,o,function(){return this}),h(at,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var b in l)s.push(b);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=yt,ft.prototype={constructor:ft,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(wt),!l)for(var s in this)s.charAt(0)==="t"&&r.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function b(St,x){return rt.type="throw",rt.arg=l,s.next=St,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return b("end");if(E.tryLoc<=this.prev){var _t=r.call(E,"catchLoc"),xt=r.call(E,"finallyLoc");if(_t&&xt){if(this.prev<E.catchLoc)return b(E.catchLoc,!0);if(this.prev<E.finallyLoc)return b(E.finallyLoc)}else if(_t){if(this.prev<E.catchLoc)return b(E.catchLoc,!0)}else{if(!xt)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return b(E.finallyLoc)}}}},abrupt:function(l,s){for(var b=this.tryEntries.length-1;b>=0;--b){var $=this.tryEntries[b];if($.tryLoc<=this.prev&&r.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,A):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),A},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.finallyLoc===l)return this.complete(b.completion,b.afterLoc),wt(b),A}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.tryLoc===l){var $=b.completion;if($.type==="throw"){var E=$.arg;wt(b)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,b){return this.delegate={iterator:yt(l),resultName:s,nextLoc:b},this.method==="next"&&(this.arg=void 0),A}},t}function __ownKeys_116(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function ___objectSpread_116(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_116(Object(r),!0).forEach(function(n){___defineProperty_116(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):__ownKeys_116(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ___defineProperty_116(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function __asyncGeneratorStep_116(t,e,r,n,o,f,d){try{var h=t[f](d),y=h.value}catch(k){return void r(k)}h.done?e(y):Promise.resolve(y).then(n,o)}function ___asyncToGenerator_116(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var f=t.apply(e,r);function d(y){__asyncGeneratorStep_116(f,n,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_116(f,n,o,d,h,"throw",y)}d(void 0)})}}function restoreArtifacts(t,e){return _restoreArtifacts.apply(this,arguments)}function _restoreArtifacts(){return(_restoreArtifacts=___asyncToGenerator_116(___regeneratorRuntime_116().mark(function t(e,r){var n,o,f,d,h,y,k,A,D,q;return ___regeneratorRuntime_116().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(___app_116.default.info("\u5F00\u59CB\u6062\u590D\u8FDC\u7A0B\u914D\u7F6E..."),H.prev=1,n=___app_116.default.read(_$constants_86.SETTINGS_KEY),o=n.gistToken,f=n.syncPlatform,o){H.next=5;break}return H.abrupt("return",Promise.reject("\u672A\u8BBE\u7F6E GitHub Token\uFF01"));case 5:return d=new ___gist_116.default({token:o,key:_$constants_86.ARTIFACT_REPOSITORY_KEY,syncPlatform:f}),H.prev=6,H.next=9,d.locate();case 9:if((h=H.sent)!=null&&h.files){H.next=12;break}throw new Error("\u627E\u4E0D\u5230 Sub-Store Gist \u6587\u4EF6\u5217\u8868");case 12:y=___app_116.default.read(_$constants_86.ARTIFACTS_KEY),k=[],Object.keys(h.files).map(function(z){var Z,j=(Z=h.files[z])===null||Z===void 0?void 0:Z.filename;if(j)if(encodeURIComponent(j)!==j)___app_116.default.error("\u6587\u4EF6\u540D ".concat(j," \u672A\u7F16\u7801 \u4E0D\u4FDD\u5B58")),k.push(j);else{var at,ct,ot=(0,_$database_133.findByName)(y,j);ot?(0,_$database_133.updateByName)(y,j,___objectSpread_116(___objectSpread_116({},ot),{},{url:(at=h.files[z])===null||at===void 0?void 0:at.raw_url.replace(/\/raw\/[^/]*\/(.*)/,"/raw/$1")})):y.push({name:"".concat(j),url:(ct=h.files[z])===null||ct===void 0?void 0:ct.raw_url.replace(/\/raw\/[^/]*\/(.*)/,"/raw/$1")})}}),___app_116.default.write(y,_$constants_86.ARTIFACTS_KEY),H.next=22;break;case 18:throw H.prev=18,H.t0=H.catch(6),___app_116.default.error("\u67E5\u627E Sub-Store Gist \u65F6\u53D1\u751F\u9519\u8BEF: ".concat((A=H.t0.message)!==null&&A!==void 0?A:H.t0)),H.t0;case 22:(0,_$response_127.success)(r),H.next=29;break;case 25:H.prev=25,H.t1=H.catch(1),___app_116.default.error("\u6062\u590D\u8FDC\u7A0B\u914D\u7F6E\u5931\u8D25\uFF0C\u539F\u56E0\uFF1A".concat((D=H.t1.message)!==null&&D!==void 0?D:H.t1)),(0,_$response_127.failed)(r,new _$errors_119.InternalServerError("FAILED_TO_RESTORE_ARTIFACTS","Failed to restore artifacts","Reason: ".concat((q=H.t1.message)!==null&&q!==void 0?q:H.t1)));case 29:case"end":return H.stop()}},t,null,[[1,25],[6,18]])}))).apply(this,arguments)}function getAllArtifacts(t,e){var r=___app_116.default.read(_$constants_86.ARTIFACTS_KEY);(0,_$response_127.success)(e,r)}function replaceArtifact(t,e){var r=t.body;___app_116.default.write(r,_$constants_86.ARTIFACTS_KEY),(0,_$response_127.success)(e)}function getArtifact(t,e){return _getArtifact.apply(this,arguments)}function _getArtifact(){return(_getArtifact=___asyncToGenerator_116(___regeneratorRuntime_116().mark(function t(e,r){var n,o,f;return ___regeneratorRuntime_116().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:n=e.params.name,n=decodeURIComponent(n),o=___app_116.default.read(_$constants_86.ARTIFACTS_KEY),(f=(0,_$database_133.findByName)(o,n))?(0,_$response_127.success)(r,f):(0,_$response_127.failed)(r,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","Artifact ".concat(n," does not exist!")),404);case 5:case"end":return d.stop()}},t)}))).apply(this,arguments)}function createArtifact(t,e){var r=t.body;if(validateArtifactName(r.name)){___app_116.default.info("\u6B63\u5728\u521B\u5EFA\u8FDC\u7A0B\u914D\u7F6E\uFF1A".concat(r.name));var n=___app_116.default.read(_$constants_86.ARTIFACTS_KEY);(0,_$database_133.findByName)(n,r.name)?(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("DUPLICATE_KEY","Artifact ".concat(r.name," already exists."))):(n.push(r),___app_116.default.write(n,_$constants_86.ARTIFACTS_KEY),(0,_$response_127.success)(e,r,201))}else(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("INVALID_ARTIFACT_NAME","Artifact name ".concat(r.name," is invalid.")))}function updateArtifact(t,e){var r=___app_116.default.read(_$constants_86.ARTIFACTS_KEY),n=t.params.name;n=decodeURIComponent(n);var o=(0,_$database_133.findByName)(r,n);if(o){___app_116.default.info("\u6B63\u5728\u66F4\u65B0\u8FDC\u7A0B\u914D\u7F6E\uFF1A".concat(o.name));var f=___objectSpread_116(___objectSpread_116({},o),t.body);if(!validateArtifactName(f.name))return void(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("INVALID_ARTIFACT_NAME","Artifact name ".concat(f.name," is invalid.")));(0,_$database_133.updateByName)(r,n,f),___app_116.default.write(r,_$constants_86.ARTIFACTS_KEY),(0,_$response_127.success)(e,f)}else(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("DUPLICATE_KEY","Artifact ".concat(n," already exists.")))}function deleteArtifact(t,e){return _deleteArtifact.apply(this,arguments)}function _deleteArtifact(){return(_deleteArtifact=___asyncToGenerator_116(___regeneratorRuntime_116().mark(function t(e,r){var n,o,f,d;return ___regeneratorRuntime_116().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(n=e.params.name,n=decodeURIComponent(n),___app_116.default.info("\u6B63\u5728\u5220\u9664\u8FDC\u7A0B\u914D\u7F6E\uFF1A".concat(n)),o=___app_116.default.read(_$constants_86.ARTIFACTS_KEY),h.prev=4,f=(0,_$database_133.findByName)(o,n)){h.next=8;break}throw new Error("\u8FDC\u7A0B\u914D\u7F6E\uFF1A".concat(n,"\u4E0D\u5B58\u5728\uFF01"));case 8:if(!f.updated){h.next=20;break}return(d={})[encodeURIComponent(f.name)]={content:""},encodeURIComponent(f.name)!==f.name&&(d[f.name]={content:""}),h.prev=12,h.next=15,syncToGist(d);case 15:h.next=20;break;case 17:h.prev=17,h.t0=h.catch(12),___app_116.default.error("Function syncToGist: ".concat(n," : ").concat(h.t0));case 20:(0,_$database_133.deleteByName)(o,n),___app_116.default.write(o,_$constants_86.ARTIFACTS_KEY),(0,_$response_127.success)(r),h.next=29;break;case 25:h.prev=25,h.t1=h.catch(4),___app_116.default.error("\u65E0\u6CD5\u5220\u9664\u8FDC\u7A0B\u914D\u7F6E\uFF1A".concat(n,"\uFF0C\u539F\u56E0\uFF1A").concat(h.t1)),(0,_$response_127.failed)(r,new _$errors_119.InternalServerError("FAILED_TO_DELETE_ARTIFACT","Failed to delete artifact ".concat(n),"Reason: ".concat(h.t1)));case 29:case"end":return h.stop()}},t,null,[[4,25],[12,17]])}))).apply(this,arguments)}function validateArtifactName(t){return/^[a-zA-Z0-9._-]*$/.test(t)}function syncToGist(t){return _syncToGist.apply(this,arguments)}function _syncToGist(){return(_syncToGist=___asyncToGenerator_116(___regeneratorRuntime_116().mark(function t(e){var r,n,o,f,d,h,y,k,A,D,q;return ___regeneratorRuntime_116().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(f=___app_116.default.read(_$constants_86.SETTINGS_KEY),d=f.gistToken,h=f.syncPlatform,d){H.next=3;break}return H.abrupt("return",Promise.reject("\u672A\u8BBE\u7F6E GitHub Token\uFF01"));case 3:return y=new ___gist_116.default({token:d,key:_$constants_86.ARTIFACT_REPOSITORY_KEY,syncPlatform:h}),H.next=6,y.upload(e);case 6:k=H.sent,A={};try{A=JSON.parse(k.body)}catch{}return D=(r=(n=A)===null||n===void 0?void 0:n.html_url)!==null&&r!==void 0?r:(o=A)===null||o===void 0?void 0:o.web_url,q=___app_116.default.read(_$constants_86.SETTINGS_KEY),D?(___app_116.default.log("\u540C\u6B65 Gist \u540E, \u627E\u5230 Sub-Store Gist: ".concat(D)),q.artifactStore=D,q.artifactStoreStatus="VALID"):(___app_116.default.error("\u540C\u6B65 Gist \u540E, \u627E\u4E0D\u5230 Sub-Store Gist"),q.artifactStoreStatus="NOT FOUND"),___app_116.default.write(q,_$constants_86.SETTINGS_KEY),H.abrupt("return",k);case 14:case"end":return H.stop()}},t)}))).apply(this,arguments)}var _$settings_128={};Object.defineProperty(_$settings_128,"__esModule",{value:!0}),_$settings_128.default=function(t){___app_128.default.read(_$constants_86.SETTINGS_KEY)||___app_128.default.write({},_$constants_86.SETTINGS_KEY),t.route("/api/settings").get(getSettings).patch(updateSettings)},_$settings_128.updateArtifactStore=updateArtifactStore,_$settings_128.updateAvatar=updateAvatar;var ___app_128=___interopRequireDefault_128(_$app_87),___gist_128=___interopRequireDefault_128(_$gist_139);function ___interopRequireDefault_128(t){return t&&t.__esModule?t:{default:t}}function ___typeof_128(t){return(___typeof_128=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function __ownKeys_128(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function ___objectSpread_128(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_128(Object(r),!0).forEach(function(n){___defineProperty_128(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):__ownKeys_128(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ___defineProperty_128(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ___regeneratorRuntime_128(){___regeneratorRuntime_128=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=typeof Symbol=="function"?Symbol:{},o=n.iterator||"@@iterator",f=n.asyncIterator||"@@asyncIterator",d=n.toStringTag||"@@toStringTag";function h(l,s,b){return Object.defineProperty(l,s,{value:b,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,b,$){return s[b]=$}}function y(l,s,b,$){var E=s&&s.prototype instanceof D?s:D,rt=Object.create(E.prototype),_t=new ft($||[]);return rt._invoke=function(xt,St,x){var N="suspendedStart";return function(V,S){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(V==="throw")throw S;return{value:void 0,done:!0}}for(x.method=V,x.arg=S;;){var C=x.delegate;if(C){var T=tt(C,x);if(T){if(T===A)continue;return T}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var M=k(xt,St,x);if(M.type==="normal"){if(N=x.done?"completed":"suspendedYield",M.arg===A)continue;return{value:M.arg,done:x.done}}M.type==="throw"&&(N="completed",x.method="throw",x.arg=M.arg)}}}(l,b,_t),rt}function k(l,s,b){try{return{type:"normal",arg:l.call(s,b)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var A={};function D(){}function q(){}function H(){}var z={};h(z,o,function(){return this});var Z=Object.getPrototypeOf,j=Z&&Z(Z(yt([])));j&&j!==e&&r.call(j,o)&&(z=j);var at=H.prototype=D.prototype=Object.create(z);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(b){return this._invoke(s,b)})})}function ot(l,s){var b;this._invoke=function($,E){function rt(){return new s(function(_t,xt){(function St(x,N,V,S){var C=k(l[x],l,N);if(C.type!=="throw"){var T=C.arg,M=T.value;return M&&___typeof_128(M)=="object"&&r.call(M,"__await")?s.resolve(M.__await).then(function(et){St("next",et,V,S)},function(et){St("throw",et,V,S)}):s.resolve(M).then(function(et){T.value=et,V(T)},function(et){return St("throw",et,V,S)})}S(C.arg)})($,E,_t,xt)})}return b=b?b.then(rt,rt):rt()}}function tt(l,s){var b=l.iterator[s.method];if(b===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,tt(l,s),s.method==="throw"))return A;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var $=k(b,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,A;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,A):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,A)}function gt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function wt(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function ft(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(gt,this),this.reset(!0)}function yt(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var b=-1,$=function E(){for(;++b<l.length;)if(r.call(l,b))return E.value=l[b],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:Ct}}function Ct(){return{value:void 0,done:!0}}return q.prototype=H,h(at,"constructor",H),h(H,"constructor",q),q.displayName=h(H,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===q||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,H):(l.__proto__=H,h(l,d,"GeneratorFunction")),l.prototype=Object.create(at),l},t.awrap=function(l){return{__await:l}},ct(ot.prototype),h(ot.prototype,f,function(){return this}),t.AsyncIterator=ot,t.async=function(l,s,b,$,E){E===void 0&&(E=Promise);var rt=new ot(y(l,s,b,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(_t){return _t.done?_t.value:rt.next()})},ct(at),h(at,d,"Generator"),h(at,o,function(){return this}),h(at,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var b in l)s.push(b);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=yt,ft.prototype={constructor:ft,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(wt),!l)for(var s in this)s.charAt(0)==="t"&&r.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function b(St,x){return rt.type="throw",rt.arg=l,s.next=St,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return b("end");if(E.tryLoc<=this.prev){var _t=r.call(E,"catchLoc"),xt=r.call(E,"finallyLoc");if(_t&&xt){if(this.prev<E.catchLoc)return b(E.catchLoc,!0);if(this.prev<E.finallyLoc)return b(E.finallyLoc)}else if(_t){if(this.prev<E.catchLoc)return b(E.catchLoc,!0)}else{if(!xt)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return b(E.finallyLoc)}}}},abrupt:function(l,s){for(var b=this.tryEntries.length-1;b>=0;--b){var $=this.tryEntries[b];if($.tryLoc<=this.prev&&r.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,A):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),A},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.finallyLoc===l)return this.complete(b.completion,b.afterLoc),wt(b),A}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.tryLoc===l){var $=b.completion;if($.type==="throw"){var E=$.arg;wt(b)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,b){return this.delegate={iterator:yt(l),resultName:s,nextLoc:b},this.method==="next"&&(this.arg=void 0),A}},t}function __asyncGeneratorStep_128(t,e,r,n,o,f,d){try{var h=t[f](d),y=h.value}catch(k){return void r(k)}h.done?e(y):Promise.resolve(y).then(n,o)}function ___asyncToGenerator_128(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var f=t.apply(e,r);function d(y){__asyncGeneratorStep_128(f,n,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_128(f,n,o,d,h,"throw",y)}d(void 0)})}}function getSettings(t,e){return _getSettings.apply(this,arguments)}function _getSettings(){return(_getSettings=___asyncToGenerator_128(___regeneratorRuntime_128().mark(function t(e,r){var n,o,f;return ___regeneratorRuntime_128().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(d.prev=0,(n=___app_128.default.read(_$constants_86.SETTINGS_KEY))||(n={},___app_128.default.write(n,_$constants_86.SETTINGS_KEY)),n.avatarUrl){d.next=6;break}return d.next=6,updateAvatar();case 6:if(n.artifactStore){d.next=9;break}return d.next=9,updateArtifactStore();case 9:(0,_$response_127.success)(r,n),d.next=16;break;case 12:d.prev=12,d.t0=d.catch(0),___app_128.default.error("Failed to get settings: ".concat((o=d.t0.message)!==null&&o!==void 0?o:d.t0)),(0,_$response_127.failed)(r,new _$errors_119.InternalServerError("FAILED_TO_GET_SETTINGS","Failed to get settings","Reason: ".concat((f=d.t0.message)!==null&&f!==void 0?f:d.t0)));case 16:case"end":return d.stop()}},t,null,[[0,12]])}))).apply(this,arguments)}function updateSettings(t,e){return _updateSettings.apply(this,arguments)}function _updateSettings(){return(_updateSettings=___asyncToGenerator_128(___regeneratorRuntime_128().mark(function t(e,r){var n,o,f,d;return ___regeneratorRuntime_128().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.prev=0,n=___app_128.default.read(_$constants_86.SETTINGS_KEY),o=___objectSpread_128(___objectSpread_128({},n),e.body),___app_128.default.write(o,_$constants_86.SETTINGS_KEY),h.next=6,updateAvatar();case 6:return h.next=8,updateArtifactStore();case 8:(0,_$response_127.success)(r,o),h.next=15;break;case 11:h.prev=11,h.t0=h.catch(0),___app_128.default.error("Failed to update settings: ".concat((f=h.t0.message)!==null&&f!==void 0?f:h.t0)),(0,_$response_127.failed)(r,new _$errors_119.InternalServerError("FAILED_TO_UPDATE_SETTINGS","Failed to update settings","Reason: ".concat((d=h.t0.message)!==null&&d!==void 0?d:h.t0)));case 15:case"end":return h.stop()}},t,null,[[0,11]])}))).apply(this,arguments)}function updateAvatar(){return _updateAvatar.apply(this,arguments)}function _updateAvatar(){return(_updateAvatar=___asyncToGenerator_128(___regeneratorRuntime_128().mark(function t(){var e,r,n,o,f,d,h;return ___regeneratorRuntime_128().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(e=___app_128.default.read(_$constants_86.SETTINGS_KEY),r=e.githubUser,n=e.syncPlatform,!r){y.next=28;break}if(n!=="gitlab"){y.next=17;break}return y.prev=4,y.next=7,___app_128.default.http.get({url:"https://gitlab.com/api/v4/users?username=".concat(encodeURIComponent(r)),headers:{"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.141 Safari/537.36"}}).then(function(k){return JSON.parse(k.body)});case 7:o=y.sent,e.avatarUrl=o[0].avatar_url.replace(/(\?|&)s=\d+(&|$)/,"$1s=160$2"),___app_128.default.write(e,_$constants_86.SETTINGS_KEY),y.next=15;break;case 12:y.prev=12,y.t0=y.catch(4),___app_128.default.error("Failed to fetch GitLab avatar for User: ".concat(r,". Reason: ").concat((f=y.t0.message)!==null&&f!==void 0?f:y.t0));case 15:y.next=28;break;case 17:return y.prev=17,y.next=20,___app_128.default.http.get({url:"https://api.github.com/users/".concat(encodeURIComponent(r)),headers:{"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.141 Safari/537.36"}}).then(function(k){return JSON.parse(k.body)});case 20:d=y.sent,e.avatarUrl=d.avatar_url,___app_128.default.write(e,_$constants_86.SETTINGS_KEY),y.next=28;break;case 25:y.prev=25,y.t1=y.catch(17),___app_128.default.error("Failed to fetch GitHub avatar for User: ".concat(r,". Reason: ").concat((h=y.t1.message)!==null&&h!==void 0?h:y.t1));case 28:case"end":return y.stop()}},t,null,[[4,12],[17,25]])}))).apply(this,arguments)}function updateArtifactStore(){return _updateArtifactStore.apply(this,arguments)}function _updateArtifactStore(){return(_updateArtifactStore=___asyncToGenerator_128(___regeneratorRuntime_128().mark(function t(){var e,r,n,o,f,d,h,y;return ___regeneratorRuntime_128().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(___app_128.default.log("Updating artifact store"),e=___app_128.default.read(_$constants_86.SETTINGS_KEY),r=e.gistToken,n=e.syncPlatform,!r){k.next=18;break}return o=new ___gist_128.default({token:r,key:_$constants_86.ARTIFACT_REPOSITORY_KEY,syncPlatform:n}),k.prev=5,k.next=8,o.locate();case 8:d=k.sent,(h=(f=d?.html_url)!==null&&f!==void 0?f:d?.web_url)?(___app_128.default.log("\u627E\u5230 Sub-Store Gist: ".concat(h)),e.artifactStore=h,e.artifactStoreStatus="VALID"):(___app_128.default.error("\u627E\u4E0D\u5230 Sub-Store Gist"),e.artifactStoreStatus="NOT FOUND"),k.next=17;break;case 13:k.prev=13,k.t0=k.catch(5),___app_128.default.error("\u67E5\u627E Sub-Store Gist \u65F6\u53D1\u751F\u9519\u8BEF: ".concat((y=k.t0.message)!==null&&y!==void 0?y:k.t0)),e.artifactStoreStatus="ERROR";case 17:___app_128.default.write(e,_$constants_86.SETTINGS_KEY);case 18:case"end":return k.stop()}},t,null,[[5,13]])}))).apply(this,arguments)}var _$miscs_122={};function ___typeof_122(t){return(___typeof_122=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$miscs_122,"__esModule",{value:!0}),_$miscs_122.default=function(t){var e,r;t.get("/api/utils/env",getEnv),t.get("/api/utils/backup",gistBackup),t.get("/api/utils/refresh",refresh),t.route("/api/storage").get(function(n,o){o.set("content-type","application/json").set("content-disposition",'attachment; filename="sub-store.json"').send(___app_122.default.env.isNode?JSON.stringify(___app_122.default.cache):___app_122.default.read("#sub-store"))}).post(function(n,o){var f=n.body.content;___app_122.default.write(f,"#sub-store"),___app_122.default.env.isNode&&(___app_122.default.cache=JSON.parse(f),___app_122.default.persistCache()),(0,_migration.default)(),(0,_$response_127.success)(o)}),t.get("/",(r=___asyncToGenerator_122(___regeneratorRuntime_122().mark(function n(o,f){return ___regeneratorRuntime_122().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:f.set("location","https://sub-store.vercel.app/").status(302).end();case 1:case"end":return d.stop()}},n)})),function(n,o){return r.apply(this,arguments)})),(0,_$openApi_151.ENV)().isQX&&t.options("/",(e=___asyncToGenerator_122(___regeneratorRuntime_122().mark(function n(o,f){return ___regeneratorRuntime_122().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:f.status(200).end();case 1:case"end":return d.stop()}},n)})),function(n,o){return e.apply(this,arguments)})),t.all("/",function(n,o){o.send("Hello from sub-store, made with \u2764\uFE0F by Peng-YM")})},_$miscs_122.gistBackupAction=gistBackupAction;var ___app_122=___interopRequireDefault_122(_$app_87),___resourceCache_122=___interopRequireDefault_122(_$resourceCache_144),___scriptResourceCache_122=___interopRequireDefault_122(_$scriptResourceCache_146),___headersResourceCache_122=___interopRequireDefault_122(_$headersResourceCache_140),___gist_122=___interopRequireDefault_122(_$gist_139),_migration=___interopRequireDefault_122(_$migration_143),___env_122=___interopRequireDefault_122(_$env_136);function ___interopRequireDefault_122(t){return t&&t.__esModule?t:{default:t}}function ___regeneratorRuntime_122(){___regeneratorRuntime_122=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=typeof Symbol=="function"?Symbol:{},o=n.iterator||"@@iterator",f=n.asyncIterator||"@@asyncIterator",d=n.toStringTag||"@@toStringTag";function h(l,s,b){return Object.defineProperty(l,s,{value:b,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,b,$){return s[b]=$}}function y(l,s,b,$){var E=s&&s.prototype instanceof D?s:D,rt=Object.create(E.prototype),_t=new ft($||[]);return rt._invoke=function(xt,St,x){var N="suspendedStart";return function(V,S){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(V==="throw")throw S;return{value:void 0,done:!0}}for(x.method=V,x.arg=S;;){var C=x.delegate;if(C){var T=tt(C,x);if(T){if(T===A)continue;return T}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var M=k(xt,St,x);if(M.type==="normal"){if(N=x.done?"completed":"suspendedYield",M.arg===A)continue;return{value:M.arg,done:x.done}}M.type==="throw"&&(N="completed",x.method="throw",x.arg=M.arg)}}}(l,b,_t),rt}function k(l,s,b){try{return{type:"normal",arg:l.call(s,b)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var A={};function D(){}function q(){}function H(){}var z={};h(z,o,function(){return this});var Z=Object.getPrototypeOf,j=Z&&Z(Z(yt([])));j&&j!==e&&r.call(j,o)&&(z=j);var at=H.prototype=D.prototype=Object.create(z);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(b){return this._invoke(s,b)})})}function ot(l,s){var b;this._invoke=function($,E){function rt(){return new s(function(_t,xt){(function St(x,N,V,S){var C=k(l[x],l,N);if(C.type!=="throw"){var T=C.arg,M=T.value;return M&&___typeof_122(M)=="object"&&r.call(M,"__await")?s.resolve(M.__await).then(function(et){St("next",et,V,S)},function(et){St("throw",et,V,S)}):s.resolve(M).then(function(et){T.value=et,V(T)},function(et){return St("throw",et,V,S)})}S(C.arg)})($,E,_t,xt)})}return b=b?b.then(rt,rt):rt()}}function tt(l,s){var b=l.iterator[s.method];if(b===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,tt(l,s),s.method==="throw"))return A;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var $=k(b,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,A;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,A):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,A)}function gt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function wt(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function ft(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(gt,this),this.reset(!0)}function yt(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var b=-1,$=function E(){for(;++b<l.length;)if(r.call(l,b))return E.value=l[b],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:Ct}}function Ct(){return{value:void 0,done:!0}}return q.prototype=H,h(at,"constructor",H),h(H,"constructor",q),q.displayName=h(H,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===q||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,H):(l.__proto__=H,h(l,d,"GeneratorFunction")),l.prototype=Object.create(at),l},t.awrap=function(l){return{__await:l}},ct(ot.prototype),h(ot.prototype,f,function(){return this}),t.AsyncIterator=ot,t.async=function(l,s,b,$,E){E===void 0&&(E=Promise);var rt=new ot(y(l,s,b,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(_t){return _t.done?_t.value:rt.next()})},ct(at),h(at,d,"Generator"),h(at,o,function(){return this}),h(at,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var b in l)s.push(b);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=yt,ft.prototype={constructor:ft,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(wt),!l)for(var s in this)s.charAt(0)==="t"&&r.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function b(St,x){return rt.type="throw",rt.arg=l,s.next=St,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return b("end");if(E.tryLoc<=this.prev){var _t=r.call(E,"catchLoc"),xt=r.call(E,"finallyLoc");if(_t&&xt){if(this.prev<E.catchLoc)return b(E.catchLoc,!0);if(this.prev<E.finallyLoc)return b(E.finallyLoc)}else if(_t){if(this.prev<E.catchLoc)return b(E.catchLoc,!0)}else{if(!xt)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return b(E.finallyLoc)}}}},abrupt:function(l,s){for(var b=this.tryEntries.length-1;b>=0;--b){var $=this.tryEntries[b];if($.tryLoc<=this.prev&&r.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,A):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),A},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.finallyLoc===l)return this.complete(b.completion,b.afterLoc),wt(b),A}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.tryLoc===l){var $=b.completion;if($.type==="throw"){var E=$.arg;wt(b)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,b){return this.delegate={iterator:yt(l),resultName:s,nextLoc:b},this.method==="next"&&(this.arg=void 0),A}},t}function __asyncGeneratorStep_122(t,e,r,n,o,f,d){try{var h=t[f](d),y=h.value}catch(k){return void r(k)}h.done?e(y):Promise.resolve(y).then(n,o)}function ___asyncToGenerator_122(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var f=t.apply(e,r);function d(y){__asyncGeneratorStep_122(f,n,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_122(f,n,o,d,h,"throw",y)}d(void 0)})}}function getEnv(t,e){t.query.share&&(___env_122.default.feature.share=!0),(0,_$response_127.success)(e,___env_122.default)}function refresh(t,e){return _refresh.apply(this,arguments)}function _refresh(){return(_refresh=___asyncToGenerator_122(___regeneratorRuntime_122().mark(function t(e,r){return ___regeneratorRuntime_122().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,_$settings_128.updateAvatar)();case 2:return n.next=4,(0,_$settings_128.updateArtifactStore)();case 4:___resourceCache_122.default.revokeAll(),___scriptResourceCache_122.default.revokeAll(),___headersResourceCache_122.default.revokeAll(),(0,_$response_127.success)(r);case 8:case"end":return n.stop()}},t)}))).apply(this,arguments)}function gistBackupAction(t){return _gistBackupAction.apply(this,arguments)}function _gistBackupAction(){return(_gistBackupAction=___asyncToGenerator_122(___regeneratorRuntime_122().mark(function t(e){var r,n,o,f,d,h,y,k;return ___regeneratorRuntime_122().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(r=___app_122.default.read(_$constants_86.SETTINGS_KEY),n=r.gistToken,o=r.syncPlatform,n){A.next=3;break}throw new Error("GitHub Token is required for backup!");case 3:f=new ___gist_122.default({token:n,key:_$constants_86.GIST_BACKUP_KEY,syncPlatform:o}),h=___app_122.default.read(_$constants_86.SETTINGS_KEY),y=h.syncTime,A.t0=e,A.next=A.t0==="upload"?9:A.t0==="download"?26:46;break;case 9:return h.syncTime=new Date().getTime(),___app_122.default.write(h,_$constants_86.SETTINGS_KEY),d=___app_122.default.read("#sub-store"),___app_122.default.env.isNode&&(d=JSON.stringify(___app_122.default.cache,null,"  ")),___app_122.default.info("\u4E0A\u4F20\u5907\u4EFD\u4E2D..."),A.prev=14,A.next=17,f.upload((D={},q=_$constants_86.GIST_BACKUP_FILE_NAME,H={content:d},q in D?Object.defineProperty(D,q,{value:H,enumerable:!0,configurable:!0,writable:!0}):D[q]=H,D));case 17:___app_122.default.info("\u4E0A\u4F20\u5907\u4EFD\u5B8C\u6210"),A.next=25;break;case 20:throw A.prev=20,A.t1=A.catch(14),h.syncTime=y,___app_122.default.write(h,_$constants_86.SETTINGS_KEY),A.t1;case 25:return A.abrupt("break",46);case 26:return ___app_122.default.info("\u8FD8\u539F\u5907\u4EFD\u4E2D..."),A.next=29,f.download(_$constants_86.GIST_BACKUP_FILE_NAME);case 29:if(d=A.sent,A.prev=30,Object.keys(JSON.parse(d).settings).length!==0){A.next=33;break}throw new Error("\u5907\u4EFD\u6587\u4EF6\u5E94\u8BE5\u81F3\u5C11\u5305\u542B settings \u5B57\u6BB5");case 33:A.next=39;break;case 35:throw A.prev=35,A.t2=A.catch(30),___app_122.default.error(`Gist \u5907\u4EFD\u6587\u4EF6\u6821\u9A8C\u5931\u8D25, \u65E0\u6CD5\u8FD8\u539F
Reason: `.concat((k=A.t2.message)!==null&&k!==void 0?k:A.t2)),new Error("Gist \u5907\u4EFD\u6587\u4EF6\u6821\u9A8C\u5931\u8D25, \u65E0\u6CD5\u8FD8\u539F");case 39:return ___app_122.default.write(d,"#sub-store"),___app_122.default.env.isNode&&(d=JSON.parse(d),___app_122.default.cache=d,___app_122.default.persistCache()),___app_122.default.info("perform migration after restoring from gist..."),(0,_migration.default)(),___app_122.default.info("migration completed"),___app_122.default.info("\u8FD8\u539F\u5907\u4EFD\u5B8C\u6210"),A.abrupt("break",46);case 46:case"end":return A.stop()}var D,q,H},t,null,[[14,20],[30,35]])}))).apply(this,arguments)}function gistBackup(t,e){return _gistBackup.apply(this,arguments)}function _gistBackup(){return(_gistBackup=___asyncToGenerator_122(___regeneratorRuntime_122().mark(function t(e,r){var n,o,f;return ___regeneratorRuntime_122().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(n=e.query.action,___app_122.default.read(_$constants_86.SETTINGS_KEY).gistToken){d.next=6;break}(0,_$response_127.failed)(r,new _$errors_119.RequestInvalidError("GIST_TOKEN_NOT_FOUND","GitHub Token is required for backup!")),d.next=16;break;case 6:return d.prev=6,d.next=9,gistBackupAction(n);case 9:(0,_$response_127.success)(r),d.next=16;break;case 12:d.prev=12,d.t0=d.catch(6),___app_122.default.error("Failed to ".concat(n,` gist data.
Reason: `).concat((o=d.t0.message)!==null&&o!==void 0?o:d.t0)),(0,_$response_127.failed)(r,new _$errors_119.InternalServerError("BACKUP_FAILED","Failed to ".concat(n," gist data!"),"Reason: ".concat((f=d.t0.message)!==null&&f!==void 0?f:d.t0)));case 16:case"end":return d.stop()}},t,null,[[6,12]])}))).apply(this,arguments)}var _$subscriptions_130={};function ___typeof_130(t){return(___typeof_130=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$subscriptions_130,"__esModule",{value:!0}),_$subscriptions_130.default=function(t){t.get("/api/sub/flow/:name",getFlowInfo),t.route("/api/sub/:name").get(getSubscription).patch(updateSubscription).delete(deleteSubscription),t.route("/api/subs").get(getAllSubscriptions).post(createSubscription).put(replaceSubscriptions)};var __obj_130,___app_130=(__obj_130=_$app_87)&&__obj_130.__esModule?__obj_130:{default:__obj_130};function ___regeneratorRuntime_130(){___regeneratorRuntime_130=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=typeof Symbol=="function"?Symbol:{},o=n.iterator||"@@iterator",f=n.asyncIterator||"@@asyncIterator",d=n.toStringTag||"@@toStringTag";function h(l,s,b){return Object.defineProperty(l,s,{value:b,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,b,$){return s[b]=$}}function y(l,s,b,$){var E=s&&s.prototype instanceof D?s:D,rt=Object.create(E.prototype),_t=new ft($||[]);return rt._invoke=function(xt,St,x){var N="suspendedStart";return function(V,S){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(V==="throw")throw S;return{value:void 0,done:!0}}for(x.method=V,x.arg=S;;){var C=x.delegate;if(C){var T=tt(C,x);if(T){if(T===A)continue;return T}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var M=k(xt,St,x);if(M.type==="normal"){if(N=x.done?"completed":"suspendedYield",M.arg===A)continue;return{value:M.arg,done:x.done}}M.type==="throw"&&(N="completed",x.method="throw",x.arg=M.arg)}}}(l,b,_t),rt}function k(l,s,b){try{return{type:"normal",arg:l.call(s,b)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var A={};function D(){}function q(){}function H(){}var z={};h(z,o,function(){return this});var Z=Object.getPrototypeOf,j=Z&&Z(Z(yt([])));j&&j!==e&&r.call(j,o)&&(z=j);var at=H.prototype=D.prototype=Object.create(z);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(b){return this._invoke(s,b)})})}function ot(l,s){var b;this._invoke=function($,E){function rt(){return new s(function(_t,xt){(function St(x,N,V,S){var C=k(l[x],l,N);if(C.type!=="throw"){var T=C.arg,M=T.value;return M&&___typeof_130(M)=="object"&&r.call(M,"__await")?s.resolve(M.__await).then(function(et){St("next",et,V,S)},function(et){St("throw",et,V,S)}):s.resolve(M).then(function(et){T.value=et,V(T)},function(et){return St("throw",et,V,S)})}S(C.arg)})($,E,_t,xt)})}return b=b?b.then(rt,rt):rt()}}function tt(l,s){var b=l.iterator[s.method];if(b===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,tt(l,s),s.method==="throw"))return A;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var $=k(b,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,A;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,A):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,A)}function gt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function wt(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function ft(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(gt,this),this.reset(!0)}function yt(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var b=-1,$=function E(){for(;++b<l.length;)if(r.call(l,b))return E.value=l[b],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:Ct}}function Ct(){return{value:void 0,done:!0}}return q.prototype=H,h(at,"constructor",H),h(H,"constructor",q),q.displayName=h(H,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===q||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,H):(l.__proto__=H,h(l,d,"GeneratorFunction")),l.prototype=Object.create(at),l},t.awrap=function(l){return{__await:l}},ct(ot.prototype),h(ot.prototype,f,function(){return this}),t.AsyncIterator=ot,t.async=function(l,s,b,$,E){E===void 0&&(E=Promise);var rt=new ot(y(l,s,b,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(_t){return _t.done?_t.value:rt.next()})},ct(at),h(at,d,"Generator"),h(at,o,function(){return this}),h(at,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var b in l)s.push(b);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=yt,ft.prototype={constructor:ft,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(wt),!l)for(var s in this)s.charAt(0)==="t"&&r.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function b(St,x){return rt.type="throw",rt.arg=l,s.next=St,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return b("end");if(E.tryLoc<=this.prev){var _t=r.call(E,"catchLoc"),xt=r.call(E,"finallyLoc");if(_t&&xt){if(this.prev<E.catchLoc)return b(E.catchLoc,!0);if(this.prev<E.finallyLoc)return b(E.finallyLoc)}else if(_t){if(this.prev<E.catchLoc)return b(E.catchLoc,!0)}else{if(!xt)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return b(E.finallyLoc)}}}},abrupt:function(l,s){for(var b=this.tryEntries.length-1;b>=0;--b){var $=this.tryEntries[b];if($.tryLoc<=this.prev&&r.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,A):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),A},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.finallyLoc===l)return this.complete(b.completion,b.afterLoc),wt(b),A}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.tryLoc===l){var $=b.completion;if($.type==="throw"){var E=$.arg;wt(b)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,b){return this.delegate={iterator:yt(l),resultName:s,nextLoc:b},this.method==="next"&&(this.arg=void 0),A}},t}function ___createForOfIteratorHelper_130(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(y,k){if(y){if(typeof y=="string")return ___arrayLikeToArray_130(y,void 0);var A=Object.prototype.toString.call(y).slice(8,-1);return A==="Object"&&y.constructor&&(A=y.constructor.name),A==="Map"||A==="Set"?Array.from(y):A==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(A)?___arrayLikeToArray_130(y,void 0):void 0}}(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){r=r.call(t)},n:function(){var y=r.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||r.return==null||r.return()}finally{if(h)throw f}}}}function ___arrayLikeToArray_130(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function __ownKeys_130(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function ___objectSpread_130(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_130(Object(r),!0).forEach(function(n){___defineProperty_130(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):__ownKeys_130(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ___defineProperty_130(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function __asyncGeneratorStep_130(t,e,r,n,o,f,d){try{var h=t[f](d),y=h.value}catch(k){return void r(k)}h.done?e(y):Promise.resolve(y).then(n,o)}function getFlowInfo(t,e){return _getFlowInfo.apply(this,arguments)}function _getFlowInfo(){var t;return t=___regeneratorRuntime_130().mark(function e(r,n){var o,f,d,h,y,k,A,D,q,H,z,Z,j,at,ct,ot,tt,gt;return ___regeneratorRuntime_130().wrap(function(wt){for(;;)switch(wt.prev=wt.next){case 0:if(o=r.params.name,o=decodeURIComponent(o),(f=r.query.url)&&(f=decodeURIComponent(f),___app_130.default.info("\u6307\u5B9A\u8FDC\u7A0B\u8BA2\u9605 URL: ".concat(f))),d=___app_130.default.read(_$constants_86.SUBS_KEY),h=(0,_$database_133.findByName)(d,o)){wt.next=9;break}return(0,_$response_127.failed)(n,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","Subscription ".concat(o," does not exist!")),404),wt.abrupt("return");case 9:if(h.source!=="local"||["localFirst","remoteFirst"].includes(h.mergeSources)){wt.next=12;break}if(h.subUserinfo)try{(0,_$response_127.success)(n,___objectSpread_130({},(0,_$flow_137.parseFlowHeaders)(h.subUserinfo)))}catch(ft){___app_130.default.error("Failed to parse flow info for local subscription ".concat(o,": ").concat((y=ft.message)!==null&&y!==void 0?y:ft)),(0,_$response_127.failed)(n,new _$errors_119.RequestInvalidError("NO_FLOW_INFO","N/A","Failed to parse flow info"))}else(0,_$response_127.failed)(n,new _$errors_119.RequestInvalidError("NO_FLOW_INFO","N/A","Local subscription ".concat(o," has no flow information!")));return wt.abrupt("return");case 12:if(wt.prev=12,f=((k="".concat(f||h.url).split(/[\r\n]+/).map(function(ft){return ft.trim()}).filter(function(ft){return ft.length}))===null||k===void 0?void 0:k[0])||"",D={},q=f.split("#"),f=f.split("#")[0],q.length>1)try{D=JSON.parse(decodeURIComponent(q[1]))}catch{H=___createForOfIteratorHelper_130(q[1].split("&"));try{for(H.s();!(z=H.n()).done;)Z=z.value,j=Z.split("=")[0],at=Z.split("=")[1],D[j]=at==null||at===""||decodeURIComponent(at)}catch(yt){H.e(yt)}finally{H.f()}}if(!D.noFlow){wt.next=21;break}return(0,_$response_127.failed)(n,new _$errors_119.RequestInvalidError("NO_FLOW_INFO","N/A","Subscription ".concat(o,": noFlow"))),wt.abrupt("return");case 21:return wt.next=23,(0,_$flow_137.getFlowHeaders)((A=D)!==null&&A!==void 0&&A.insecure?"".concat(f,"#insecure"):f,D.flowUserAgent,void 0,h.proxy,D.flowUrl);case 23:if((ct=wt.sent)||h.subUserinfo){wt.next=27;break}return(0,_$response_127.failed)(n,new _$errors_119.InternalServerError("NO_FLOW_INFO","No flow info","Failed to fetch flow headers")),wt.abrupt("return");case 27:try{ot=(0,_$flow_137.getRmainingDays)({resetDay:D.resetDay,startDate:D.startDate,cycleDays:D.cycleDays}),tt=___objectSpread_130({},(0,_$flow_137.parseFlowHeaders)([h.subUserinfo,ct].filter(function(ft){return ft}).join("; "))),ot!=null&&(tt.remainingDays=ot),(0,_$response_127.success)(n,tt)}catch(ft){___app_130.default.error("Failed to parse flow info for local subscription ".concat(o,": ").concat((gt=ft.message)!==null&&gt!==void 0?gt:ft)),(0,_$response_127.failed)(n,new _$errors_119.RequestInvalidError("NO_FLOW_INFO","N/A","Failed to parse flow info"))}wt.next=33;break;case 30:wt.prev=30,wt.t0=wt.catch(12),(0,_$response_127.failed)(n,new _$errors_119.NetworkError("URL_NOT_ACCESSIBLE","The URL for subscription ".concat(o," is inaccessible.")));case 33:case"end":return wt.stop()}},e,null,[[12,30]])}),(_getFlowInfo=function(){var e=this,r=arguments;return new Promise(function(n,o){var f=t.apply(e,r);function d(y){__asyncGeneratorStep_130(f,n,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_130(f,n,o,d,h,"throw",y)}d(void 0)})}).apply(this,arguments)}function createSubscription(t,e){var r=t.body;if(___app_130.default.info("\u6B63\u5728\u521B\u5EFA\u8BA2\u9605\uFF1A ".concat(r.name)),/\//.test(r.name))(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("INVALID_NAME","Subscription ".concat(r.name," is invalid")));else{var n=___app_130.default.read(_$constants_86.SUBS_KEY);(0,_$database_133.findByName)(n,r.name)?(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("DUPLICATE_KEY","Subscription ".concat(r.name," already exists."))):(n.push(r),___app_130.default.write(n,_$constants_86.SUBS_KEY),(0,_$response_127.success)(e,r,201))}}function getSubscription(t,e){var r=t.params.name,n=t.query.raw;r=decodeURIComponent(r);var o=___app_130.default.read(_$constants_86.SUBS_KEY),f=(0,_$database_133.findByName)(o,r);f?n?e.set("content-type","application/json").set("content-disposition",'attachment; filename="'.concat(encodeURIComponent(r),'.json"')).send(JSON.stringify(f)):(0,_$response_127.success)(e,f):(0,_$response_127.failed)(e,new _$errors_119.ResourceNotFoundError("SUBSCRIPTION_NOT_FOUND","Subscription ".concat(r," does not exist"),404))}function updateSubscription(t,e){var r=t.params.name;r=decodeURIComponent(r);var n=t.body,o=___app_130.default.read(_$constants_86.SUBS_KEY),f=(0,_$database_133.findByName)(o,r);if(f){var d=___objectSpread_130(___objectSpread_130({},f),n);if(___app_130.default.info("\u6B63\u5728\u66F4\u65B0\u8BA2\u9605\uFF1A ".concat(r)),r!==n.name){var h,y=___app_130.default.read(_$constants_86.COLLECTIONS_KEY)||[],k=___createForOfIteratorHelper_130(y);try{for(k.s();!(h=k.n()).done;){var A=h.value,D=A.subscriptions.indexOf(r);D!==-1&&(A.subscriptions[D]=n.name)}}catch(j){k.e(j)}finally{k.f()}var q,H=___app_130.default.read(_$constants_86.ARTIFACTS_KEY)||[],z=___createForOfIteratorHelper_130(H);try{for(z.s();!(q=z.n()).done;){var Z=q.value;Z.type==="subscription"&&Z.source==r&&(Z.source=n.name)}}catch(j){z.e(j)}finally{z.f()}___app_130.default.write(y,_$constants_86.COLLECTIONS_KEY),___app_130.default.write(H,_$constants_86.ARTIFACTS_KEY)}(0,_$database_133.updateByName)(o,r,d),___app_130.default.write(o,_$constants_86.SUBS_KEY),(0,_$response_127.success)(e,d)}else(0,_$response_127.failed)(e,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","Subscription ".concat(r," does not exist!")),404)}function deleteSubscription(t,e){var r=t.params.name;r=decodeURIComponent(r),___app_130.default.info("\u5220\u9664\u8BA2\u9605\uFF1A".concat(r,"..."));var n=___app_130.default.read(_$constants_86.SUBS_KEY);(0,_$database_133.deleteByName)(n,r),___app_130.default.write(n,_$constants_86.SUBS_KEY);var o,f=___app_130.default.read(_$constants_86.COLLECTIONS_KEY),d=___createForOfIteratorHelper_130(f);try{for(d.s();!(o=d.n()).done;){var h=o.value;h.subscriptions=h.subscriptions.filter(function(y){return y!==r})}}catch(y){d.e(y)}finally{d.f()}___app_130.default.write(f,_$constants_86.COLLECTIONS_KEY),(0,_$response_127.success)(e)}function getAllSubscriptions(t,e){var r=___app_130.default.read(_$constants_86.SUBS_KEY);(0,_$response_127.success)(e,r)}function replaceSubscriptions(t,e){var r=t.body;___app_130.default.write(r,_$constants_86.SUBS_KEY),(0,_$response_127.success)(e)}___app_130.default.read(_$constants_86.SUBS_KEY)||___app_130.default.write({},_$constants_86.SUBS_KEY);var _$collections_117={};Object.defineProperty(_$collections_117,"__esModule",{value:!0}),_$collections_117.default=function(t){___app_117.default.read(_$constants_86.COLLECTIONS_KEY)||___app_117.default.write({},_$constants_86.COLLECTIONS_KEY),t.route("/api/collection/:name").get(getCollection).patch(updateCollection).delete(deleteCollection),t.route("/api/collections").get(getAllCollections).post(createCollection).put(replaceCollection)};var __obj_117,___app_117=(__obj_117=_$app_87)&&__obj_117.__esModule?__obj_117:{default:__obj_117};function ___createForOfIteratorHelper_117(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(y,k){if(y){if(typeof y=="string")return ___arrayLikeToArray_117(y,void 0);var A=Object.prototype.toString.call(y).slice(8,-1);return A==="Object"&&y.constructor&&(A=y.constructor.name),A==="Map"||A==="Set"?Array.from(y):A==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(A)?___arrayLikeToArray_117(y,void 0):void 0}}(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){r=r.call(t)},n:function(){var y=r.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||r.return==null||r.return()}finally{if(h)throw f}}}}function ___arrayLikeToArray_117(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function __ownKeys_117(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function ___objectSpread_117(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_117(Object(r),!0).forEach(function(n){___defineProperty_117(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):__ownKeys_117(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ___defineProperty_117(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function createCollection(t,e){var r=t.body;if(___app_117.default.info("\u6B63\u5728\u521B\u5EFA\u7EC4\u5408\u8BA2\u9605\uFF1A".concat(r.name)),/\//.test(r.name))(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("INVALID_NAME","Collection ".concat(r.name," is invalid")));else{var n=___app_117.default.read(_$constants_86.COLLECTIONS_KEY);(0,_$database_133.findByName)(n,r.name)?(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("DUPLICATE_KEY","Collection ".concat(r.name," already exists."))):(n.push(r),___app_117.default.write(n,_$constants_86.COLLECTIONS_KEY),(0,_$response_127.success)(e,r,201))}}function getCollection(t,e){var r=t.params.name;r=decodeURIComponent(r);var n=___app_117.default.read(_$constants_86.COLLECTIONS_KEY),o=(0,_$database_133.findByName)(n,r);o?(0,_$response_127.success)(e,o):(0,_$response_127.failed)(e,new _$errors_119.ResourceNotFoundError("SUBSCRIPTION_NOT_FOUND","Collection ".concat(r," does not exist"),404))}function updateCollection(t,e){var r=t.params.name;r=decodeURIComponent(r);var n=t.body,o=___app_117.default.read(_$constants_86.COLLECTIONS_KEY),f=(0,_$database_133.findByName)(o,r);if(f){var d=___objectSpread_117(___objectSpread_117({},f),n);if(___app_117.default.info("\u6B63\u5728\u66F4\u65B0\u7EC4\u5408\u8BA2\u9605\uFF1A".concat(r,"...")),r!==d.name){var h,y=___app_117.default.read(_$constants_86.ARTIFACTS_KEY)||[],k=___createForOfIteratorHelper_117(y);try{for(k.s();!(h=k.n()).done;){var A=h.value;A.type==="collection"&&A.source===f.name&&(A.source=d.name)}}catch(D){k.e(D)}finally{k.f()}___app_117.default.write(y,_$constants_86.ARTIFACTS_KEY)}(0,_$database_133.updateByName)(o,r,d),___app_117.default.write(o,_$constants_86.COLLECTIONS_KEY),(0,_$response_127.success)(e,d)}else(0,_$response_127.failed)(e,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","Collection ".concat(r," does not exist!")),404)}function deleteCollection(t,e){var r=t.params.name;r=decodeURIComponent(r),___app_117.default.info("\u6B63\u5728\u5220\u9664\u7EC4\u5408\u8BA2\u9605\uFF1A".concat(r));var n=___app_117.default.read(_$constants_86.COLLECTIONS_KEY);(0,_$database_133.deleteByName)(n,r),___app_117.default.write(n,_$constants_86.COLLECTIONS_KEY),(0,_$response_127.success)(e)}function getAllCollections(t,e){var r=___app_117.default.read(_$constants_86.COLLECTIONS_KEY);(0,_$response_127.success)(e,r)}function replaceCollection(t,e){var r=t.body;___app_117.default.write(r,_$constants_86.COLLECTIONS_KEY),(0,_$response_127.success)(e)}var _$file_120={};function ___typeof_120(t){return(___typeof_120=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$file_120,"__esModule",{value:!0}),_$file_120.default=function(t){___app_120.default.read(_$constants_86.FILES_KEY)||___app_120.default.write([],_$constants_86.FILES_KEY),t.get("/share/file/:name",getFile),t.route("/api/file/:name").get(getFile).patch(updateFile).delete(deleteFile),t.route("/api/wholeFile/:name").get(getWholeFile),t.route("/api/files").get(getAllFiles).post(createFile).put(replaceFile),t.route("/api/wholeFiles").get(getAllWholeFiles)};var __obj_120,___app_120=(__obj_120=_$app_87)&&__obj_120.__esModule?__obj_120:{default:__obj_120},___sync_120=_$sync_131({}),_excluded=["content"];function ___regeneratorRuntime_120(){___regeneratorRuntime_120=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=typeof Symbol=="function"?Symbol:{},o=n.iterator||"@@iterator",f=n.asyncIterator||"@@asyncIterator",d=n.toStringTag||"@@toStringTag";function h(l,s,b){return Object.defineProperty(l,s,{value:b,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,b,$){return s[b]=$}}function y(l,s,b,$){var E=s&&s.prototype instanceof D?s:D,rt=Object.create(E.prototype),_t=new ft($||[]);return rt._invoke=function(xt,St,x){var N="suspendedStart";return function(V,S){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(V==="throw")throw S;return{value:void 0,done:!0}}for(x.method=V,x.arg=S;;){var C=x.delegate;if(C){var T=tt(C,x);if(T){if(T===A)continue;return T}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var M=k(xt,St,x);if(M.type==="normal"){if(N=x.done?"completed":"suspendedYield",M.arg===A)continue;return{value:M.arg,done:x.done}}M.type==="throw"&&(N="completed",x.method="throw",x.arg=M.arg)}}}(l,b,_t),rt}function k(l,s,b){try{return{type:"normal",arg:l.call(s,b)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var A={};function D(){}function q(){}function H(){}var z={};h(z,o,function(){return this});var Z=Object.getPrototypeOf,j=Z&&Z(Z(yt([])));j&&j!==e&&r.call(j,o)&&(z=j);var at=H.prototype=D.prototype=Object.create(z);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(b){return this._invoke(s,b)})})}function ot(l,s){var b;this._invoke=function($,E){function rt(){return new s(function(_t,xt){(function St(x,N,V,S){var C=k(l[x],l,N);if(C.type!=="throw"){var T=C.arg,M=T.value;return M&&___typeof_120(M)=="object"&&r.call(M,"__await")?s.resolve(M.__await).then(function(et){St("next",et,V,S)},function(et){St("throw",et,V,S)}):s.resolve(M).then(function(et){T.value=et,V(T)},function(et){return St("throw",et,V,S)})}S(C.arg)})($,E,_t,xt)})}return b=b?b.then(rt,rt):rt()}}function tt(l,s){var b=l.iterator[s.method];if(b===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,tt(l,s),s.method==="throw"))return A;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var $=k(b,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,A;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,A):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,A)}function gt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function wt(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function ft(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(gt,this),this.reset(!0)}function yt(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var b=-1,$=function E(){for(;++b<l.length;)if(r.call(l,b))return E.value=l[b],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:Ct}}function Ct(){return{value:void 0,done:!0}}return q.prototype=H,h(at,"constructor",H),h(H,"constructor",q),q.displayName=h(H,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===q||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,H):(l.__proto__=H,h(l,d,"GeneratorFunction")),l.prototype=Object.create(at),l},t.awrap=function(l){return{__await:l}},ct(ot.prototype),h(ot.prototype,f,function(){return this}),t.AsyncIterator=ot,t.async=function(l,s,b,$,E){E===void 0&&(E=Promise);var rt=new ot(y(l,s,b,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(_t){return _t.done?_t.value:rt.next()})},ct(at),h(at,d,"Generator"),h(at,o,function(){return this}),h(at,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var b in l)s.push(b);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=yt,ft.prototype={constructor:ft,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(wt),!l)for(var s in this)s.charAt(0)==="t"&&r.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function b(St,x){return rt.type="throw",rt.arg=l,s.next=St,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return b("end");if(E.tryLoc<=this.prev){var _t=r.call(E,"catchLoc"),xt=r.call(E,"finallyLoc");if(_t&&xt){if(this.prev<E.catchLoc)return b(E.catchLoc,!0);if(this.prev<E.finallyLoc)return b(E.finallyLoc)}else if(_t){if(this.prev<E.catchLoc)return b(E.catchLoc,!0)}else{if(!xt)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return b(E.finallyLoc)}}}},abrupt:function(l,s){for(var b=this.tryEntries.length-1;b>=0;--b){var $=this.tryEntries[b];if($.tryLoc<=this.prev&&r.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,A):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),A},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.finallyLoc===l)return this.complete(b.completion,b.afterLoc),wt(b),A}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.tryLoc===l){var $=b.completion;if($.type==="throw"){var E=$.arg;wt(b)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,b){return this.delegate={iterator:yt(l),resultName:s,nextLoc:b},this.method==="next"&&(this.arg=void 0),A}},t}function ___createForOfIteratorHelper_120(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(y,k){if(y){if(typeof y=="string")return ___arrayLikeToArray_120(y,void 0);var A=Object.prototype.toString.call(y).slice(8,-1);return A==="Object"&&y.constructor&&(A=y.constructor.name),A==="Map"||A==="Set"?Array.from(y):A==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(A)?___arrayLikeToArray_120(y,void 0):void 0}}(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){r=r.call(t)},n:function(){var y=r.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||r.return==null||r.return()}finally{if(h)throw f}}}}function ___arrayLikeToArray_120(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _objectWithoutProperties(t,e){if(t==null)return{};var r,n,o=function(d,h){if(d==null)return{};var y,k,A={},D=Object.keys(d);for(k=0;k<D.length;k++)y=D[k],h.indexOf(y)>=0||(A[y]=d[y]);return A}(t,e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(t);for(n=0;n<f.length;n++)r=f[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function __ownKeys_120(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function ___objectSpread_120(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_120(Object(r),!0).forEach(function(n){___defineProperty_120(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):__ownKeys_120(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ___defineProperty_120(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function __asyncGeneratorStep_120(t,e,r,n,o,f,d){try{var h=t[f](d),y=h.value}catch(k){return void r(k)}h.done?e(y):Promise.resolve(y).then(n,o)}function createFile(t,e){var r,n=t.body;n.name="".concat((r=n.name)!==null&&r!==void 0?r:Date.now()),___app_120.default.info("\u6B63\u5728\u521B\u5EFA\u6587\u4EF6\uFF1A".concat(n.name));var o=___app_120.default.read(_$constants_86.FILES_KEY);if((0,_$database_133.findByName)(o,n.name))return(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("DUPLICATE_KEY",t.body.name?"\u5DF2\u5B58\u5728 name \u4E3A ".concat(n.name," \u7684\u6587\u4EF6"):"\u65E0\u6CD5\u540C\u65F6\u521B\u5EFA\u76F8\u540C\u7684\u6587\u4EF6 \u53EF\u7A0D\u540E\u91CD\u8BD5"));o.push(n),___app_120.default.write(o,_$constants_86.FILES_KEY),(0,_$response_127.success)(e,n,201)}function getFile(t,e){return _getFile.apply(this,arguments)}function _getFile(){var t;return t=___regeneratorRuntime_120().mark(function e(r,n){var o,f,d,h,y,k,A,D,q,H,z,Z,j,at,ct,ot,tt,gt,wt,ft,yt,Ct,l;return ___regeneratorRuntime_120().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(o=r.params.name,o=decodeURIComponent(o),___app_120.default.info("\u6B63\u5728\u4E0B\u8F7D\u6587\u4EF6\uFF1A".concat(o)),f=r.query,d=f.url,h=f.subInfoUrl,y=f.subInfoUserAgent,k=f.ua,A=f.content,D=f.mergeSources,q=f.ignoreFailedRemoteFile,H=f.proxy,z={},r.query.$options){try{z=JSON.parse(decodeURIComponent(r.query.$options))}catch{Z=___createForOfIteratorHelper_120(r.query.$options.split("&"));try{for(Z.s();!(j=Z.n()).done;)at=j.value,ct=at.split("=")[0],ot=at.split("=")[1],z[ct]=ot==null||ot===""||decodeURIComponent(ot)}catch($){Z.e($)}finally{Z.f()}}___app_120.default.info("\u4F20\u5165 $options: ".concat(JSON.stringify(z)))}if(d&&(d=decodeURIComponent(d),___app_120.default.info("\u6307\u5B9A\u8FDC\u7A0B\u6587\u4EF6 URL: ".concat(d))),H&&(H=decodeURIComponent(H),___app_120.default.info("\u6307\u5B9A\u8FDC\u7A0B\u8BA2\u9605\u4F7F\u7528\u4EE3\u7406/\u7B56\u7565 proxy: ".concat(H))),k&&(k=decodeURIComponent(k),___app_120.default.info("\u6307\u5B9A\u8FDC\u7A0B\u6587\u4EF6 User-Agent: ".concat(k))),h&&(h=decodeURIComponent(h),___app_120.default.info("\u6307\u5B9A\u83B7\u53D6\u6D41\u91CF\u7684 subInfoUrl: ".concat(h))),y&&(y=decodeURIComponent(y),___app_120.default.info("\u6307\u5B9A\u83B7\u53D6\u6D41\u91CF\u7684 subInfoUserAgent: ".concat(y))),A&&(A=decodeURIComponent(A),___app_120.default.info("\u6307\u5B9A\u672C\u5730\u6587\u4EF6: ".concat(A))),D&&(D=decodeURIComponent(D),___app_120.default.info("\u6307\u5B9A\u5408\u5E76\u6765\u6E90: ".concat(D))),q!=null&&q!==""&&(q=decodeURIComponent(q),___app_120.default.info("\u6307\u5B9A\u5FFD\u7565\u5931\u8D25\u7684\u8FDC\u7A0B\u6587\u4EF6: ".concat(q))),tt=___app_120.default.read(_$constants_86.FILES_KEY),!(gt=(0,_$database_133.findByName)(tt,o))){s.next=44;break}return s.prev=17,s.next=20,(0,___sync_120.produceArtifact)({type:"file",name:o,url:d,ua:k,content:A,mergeSources:D,ignoreFailedRemoteFile:q,$options:z,proxy:H});case 20:if(wt=s.sent,s.prev=21,!(h=h||gt.subInfoUrl)){s.next=28;break}return s.next=26,(0,_$flow_137.getFlowHeaders)(h,y||gt.subInfoUserAgent,void 0,H||gt.proxy);case 26:(ft=s.sent)&&n.set("subscription-userinfo",ft);case 28:s.next=33;break;case 30:s.prev=30,s.t0=s.catch(21),___app_120.default.error("\u6587\u4EF6 ".concat(o," \u83B7\u53D6\u6D41\u91CF\u4FE1\u606F\u65F6\u53D1\u751F\u9519\u8BEF: ").concat(JSON.stringify(s.t0)));case 33:gt.download&&n.set("Content-Disposition","attachment; filename*=UTF-8''".concat(encodeURIComponent(gt.displayName||gt.name))),n.set("Content-Type","text/plain; charset=utf-8").send(wt??""),s.next=42;break;case 37:s.prev=37,s.t1=s.catch(17),___app_120.default.notify("\u{1F30D} Sub-Store \u4E0B\u8F7D\u6587\u4EF6\u5931\u8D25","\u274C \u65E0\u6CD5\u4E0B\u8F7D\u6587\u4EF6\uFF1A".concat(o,"\uFF01"),"\u{1F914} \u539F\u56E0\uFF1A".concat((yt=s.t1.message)!==null&&yt!==void 0?yt:s.t1)),___app_120.default.error((Ct=s.t1.message)!==null&&Ct!==void 0?Ct:s.t1),(0,_$response_127.failed)(n,new _$errors_119.InternalServerError("INTERNAL_SERVER_ERROR","Failed to download file: ".concat(o),"Reason: ".concat((l=s.t1.message)!==null&&l!==void 0?l:s.t1)));case 42:s.next=46;break;case 44:___app_120.default.error("\u{1F30D} Sub-Store \u4E0B\u8F7D\u6587\u4EF6\u5931\u8D25","\u274C \u672A\u627E\u5230\u6587\u4EF6\uFF1A".concat(o,"\uFF01")),(0,_$response_127.failed)(n,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","File ".concat(o," does not exist!")),404);case 46:case"end":return s.stop()}},e,null,[[17,37],[21,30]])}),(_getFile=function(){var e=this,r=arguments;return new Promise(function(n,o){var f=t.apply(e,r);function d(y){__asyncGeneratorStep_120(f,n,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_120(f,n,o,d,h,"throw",y)}d(void 0)})}).apply(this,arguments)}function getWholeFile(t,e){var r=t.params.name;r=decodeURIComponent(r);var n=___app_120.default.read(_$constants_86.FILES_KEY),o=(0,_$database_133.findByName)(n,r);o?(0,_$response_127.success)(e,o):(0,_$response_127.failed)(e,new _$errors_119.ResourceNotFoundError("FILE_NOT_FOUND","File ".concat(r," does not exist"),404))}function updateFile(t,e){var r=t.params.name;r=decodeURIComponent(r);var n=t.body,o=___app_120.default.read(_$constants_86.FILES_KEY),f=(0,_$database_133.findByName)(o,r);if(f){var d=___objectSpread_120(___objectSpread_120({},f),n);___app_120.default.info("\u6B63\u5728\u66F4\u65B0\u6587\u4EF6\uFF1A".concat(r,"...")),(0,_$database_133.updateByName)(o,r,d),___app_120.default.write(o,_$constants_86.FILES_KEY),(0,_$response_127.success)(e,d)}else(0,_$response_127.failed)(e,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","File ".concat(r," does not exist!")),404)}function deleteFile(t,e){var r=t.params.name;r=decodeURIComponent(r),___app_120.default.info("\u6B63\u5728\u5220\u9664\u6587\u4EF6\uFF1A".concat(r));var n=___app_120.default.read(_$constants_86.FILES_KEY);(0,_$database_133.deleteByName)(n,r),___app_120.default.write(n,_$constants_86.FILES_KEY),(0,_$response_127.success)(e)}function getAllFiles(t,e){var r=___app_120.default.read(_$constants_86.FILES_KEY);(0,_$response_127.success)(e,r.map(function(n){return n.content,_objectWithoutProperties(n,_excluded)}))}function getAllWholeFiles(t,e){var r=___app_120.default.read(_$constants_86.FILES_KEY);(0,_$response_127.success)(e,r)}function replaceFile(t,e){var r=t.body;___app_120.default.write(r,_$constants_86.FILES_KEY),(0,_$response_127.success)(e)}var _$token_132={};Object.defineProperty(_$token_132,"__esModule",{value:!0}),_$token_132.default=register;var ___app_132=___interopRequireDefault_132(_$app_87);function ___interopRequireDefault_132(t){return t&&t.__esModule?t:{default:t}}function ___regeneratorRuntime_132(){___regeneratorRuntime_132=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=typeof Symbol=="function"?Symbol:{},o=n.iterator||"@@iterator",f=n.asyncIterator||"@@asyncIterator",d=n.toStringTag||"@@toStringTag";function h(l,s,b){return Object.defineProperty(l,s,{value:b,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,b,$){return s[b]=$}}function y(l,s,b,$){var E=s&&s.prototype instanceof D?s:D,rt=Object.create(E.prototype),_t=new ft($||[]);return rt._invoke=function(xt,St,x){var N="suspendedStart";return function(V,S){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(V==="throw")throw S;return{value:void 0,done:!0}}for(x.method=V,x.arg=S;;){var C=x.delegate;if(C){var T=tt(C,x);if(T){if(T===A)continue;return T}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var M=k(xt,St,x);if(M.type==="normal"){if(N=x.done?"completed":"suspendedYield",M.arg===A)continue;return{value:M.arg,done:x.done}}M.type==="throw"&&(N="completed",x.method="throw",x.arg=M.arg)}}}(l,b,_t),rt}function k(l,s,b){try{return{type:"normal",arg:l.call(s,b)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var A={};function D(){}function q(){}function H(){}var z={};h(z,o,function(){return this});var Z=Object.getPrototypeOf,j=Z&&Z(Z(yt([])));j&&j!==e&&r.call(j,o)&&(z=j);var at=H.prototype=D.prototype=Object.create(z);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(b){return this._invoke(s,b)})})}function ot(l,s){var b;this._invoke=function($,E){function rt(){return new s(function(_t,xt){(function St(x,N,V,S){var C=k(l[x],l,N);if(C.type!=="throw"){var T=C.arg,M=T.value;return M&&___typeof_132(M)=="object"&&r.call(M,"__await")?s.resolve(M.__await).then(function(et){St("next",et,V,S)},function(et){St("throw",et,V,S)}):s.resolve(M).then(function(et){T.value=et,V(T)},function(et){return St("throw",et,V,S)})}S(C.arg)})($,E,_t,xt)})}return b=b?b.then(rt,rt):rt()}}function tt(l,s){var b=l.iterator[s.method];if(b===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,tt(l,s),s.method==="throw"))return A;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var $=k(b,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,A;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,A):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,A)}function gt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function wt(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function ft(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(gt,this),this.reset(!0)}function yt(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var b=-1,$=function E(){for(;++b<l.length;)if(r.call(l,b))return E.value=l[b],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:Ct}}function Ct(){return{value:void 0,done:!0}}return q.prototype=H,h(at,"constructor",H),h(H,"constructor",q),q.displayName=h(H,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===q||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,H):(l.__proto__=H,h(l,d,"GeneratorFunction")),l.prototype=Object.create(at),l},t.awrap=function(l){return{__await:l}},ct(ot.prototype),h(ot.prototype,f,function(){return this}),t.AsyncIterator=ot,t.async=function(l,s,b,$,E){E===void 0&&(E=Promise);var rt=new ot(y(l,s,b,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(_t){return _t.done?_t.value:rt.next()})},ct(at),h(at,d,"Generator"),h(at,o,function(){return this}),h(at,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var b in l)s.push(b);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=yt,ft.prototype={constructor:ft,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(wt),!l)for(var s in this)s.charAt(0)==="t"&&r.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function b(St,x){return rt.type="throw",rt.arg=l,s.next=St,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return b("end");if(E.tryLoc<=this.prev){var _t=r.call(E,"catchLoc"),xt=r.call(E,"finallyLoc");if(_t&&xt){if(this.prev<E.catchLoc)return b(E.catchLoc,!0);if(this.prev<E.finallyLoc)return b(E.finallyLoc)}else if(_t){if(this.prev<E.catchLoc)return b(E.catchLoc,!0)}else{if(!xt)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return b(E.finallyLoc)}}}},abrupt:function(l,s){for(var b=this.tryEntries.length-1;b>=0;--b){var $=this.tryEntries[b];if($.tryLoc<=this.prev&&r.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,A):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),A},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.finallyLoc===l)return this.complete(b.completion,b.afterLoc),wt(b),A}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.tryLoc===l){var $=b.completion;if($.type==="throw"){var E=$.arg;wt(b)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,b){return this.delegate={iterator:yt(l),resultName:s,nextLoc:b},this.method==="next"&&(this.arg=void 0),A}},t}function ___typeof_132(t){return(___typeof_132=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function __ownKeys_132(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function ___objectSpread_132(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_132(Object(r),!0).forEach(function(n){___defineProperty_132(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):__ownKeys_132(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ___defineProperty_132(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function __asyncGeneratorStep_132(t,e,r,n,o,f,d){try{var h=t[f](d),y=h.value}catch(k){return void r(k)}h.done?e(y):Promise.resolve(y).then(n,o)}function ___asyncToGenerator_132(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var f=t.apply(e,r);function d(y){__asyncGeneratorStep_132(f,n,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_132(f,n,o,d,h,"throw",y)}d(void 0)})}}function register(t){___app_132.default.read(_$constants_86.TOKENS_KEY)||___app_132.default.write([],_$constants_86.TOKENS_KEY),t.post("/api/token",signToken),t.route("/api/token/:token").delete(deleteToken),t.route("/api/tokens").get(getAllTokens)}function deleteToken(t,e){var r=t.params.token;r=decodeURIComponent(r),___app_132.default.info("\u6B63\u5728\u5220\u9664\uFF1A".concat(r));var n=___app_132.default.read(_$constants_86.TOKENS_KEY);(0,_$database_133.deleteByName)(n,r,"token"),___app_132.default.write(n,_$constants_86.TOKENS_KEY),(0,_$response_127.success)(e)}function getAllTokens(t,e){var r=t.query,n=r.type,o=r.name,f=___app_132.default.read(_$constants_86.TOKENS_KEY)||[];(0,_$response_127.success)(e,n||o?f.filter(function(d){return!(n&&d.type!==n||o&&d.name!==o)}):f)}function signToken(t,e){return _signToken.apply(this,arguments)}function _signToken(){return _signToken=___asyncToGenerator_132(___regeneratorRuntime_132().mark(function t(e,r){var n,o;return ___regeneratorRuntime_132().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if((0,_$openApi_151.ENV)().isNode){d.next=2;break}return d.abrupt("return",(0,_$response_127.failed)(r,new _$errors_119.RequestInvalidError("INVALID_ENV","This endpoint is only available in Node.js environment")));case 2:if(d.prev=2,n=function(){var h=e.body,y=h.payload,k=h.options,A=require("ms"),D=y?.token;if(D!=null){if(typeof D!="string"||D.length<1)return{v:(0,_$response_127.failed)(r,new _$errors_119.RequestInvalidError("INVALID_CUSTOM_TOKEN","Invalid custom token: ".concat(D)))};var q=___app_132.default.read(_$constants_86.TOKENS_KEY)||[];if(q.find(function(yt){return yt.token===D}))return{v:(0,_$response_127.failed)(r,new _$errors_119.RequestInvalidError("DUPLICATE_TOKEN","Token ".concat(D," already exists")))}}var H=y?.type,z=y?.name;if(!H||!z)return{v:(0,_$response_127.failed)(r,new _$errors_119.RequestInvalidError("INVALID_PAYLOAD","payload type and name are required"))};if(H==="col"){var Z=___app_132.default.read(_$constants_86.COLLECTIONS_KEY)||[],j=Z.find(function(yt){return yt.name===z});if(!j)return{v:(0,_$response_127.failed)(r,new _$errors_119.RequestInvalidError("INVALID_COLLECTION","collection ".concat(z," not found")))}}else if(H==="file"){var at=___app_132.default.read(_$constants_86.FILES_KEY)||[],ct=at.find(function(yt){return yt.name===z});if(!ct)return{v:(0,_$response_127.failed)(r,new _$errors_119.RequestInvalidError("INVALID_FILE","file ".concat(z," not found")))}}else{if(H!=="sub")return{v:(0,_$response_127.failed)(r,new _$errors_119.RequestInvalidError("INVALID_TYPE","type ".concat(z," not supported")))};var ot=___app_132.default.read(_$constants_86.SUBS_KEY)||[],tt=ot.find(function(yt){return yt.name===z});if(!tt)return{v:(0,_$response_127.failed)(r,new _$errors_119.RequestInvalidError("INVALID_SUB","sub ".concat(z," not found")))}}var gt=k?.expiresIn;if(k?.expiresIn!=null&&(gt=A(k.expiresIn),gt==null||isNaN(gt)||gt<=0))return{v:(0,_$response_127.failed)(r,new _$errors_119.RequestInvalidError("INVALID_EXPIRES_IN","Invalid expiresIn option: ".concat(k.expiresIn)))};var wt=require("nanoid"),ft=___app_132.default.read(_$constants_86.TOKENS_KEY)||[];if(!D)do D=wt.customAlphabet(wt.urlAlphabet)();while(ft.find(function(yt){return yt.token===D}));return ft.push(___objectSpread_132(___objectSpread_132({},y),{},{token:D,createdAt:Date.now(),expiresIn:gt>0?k?.expiresIn:void 0,exp:gt>0?Date.now()+gt:void 0})),___app_132.default.write(ft,_$constants_86.TOKENS_KEY),{v:(0,_$response_127.success)(r,{token:D})}}(),___typeof_132(n)!=="object"){d.next=6;break}return d.abrupt("return",n.v);case 6:d.next=11;break;case 8:return d.prev=8,d.t0=d.catch(2),d.abrupt("return",(0,_$response_127.failed)(r,new _$errors_119.InternalServerError("TOKEN_SIGN_FAILED","Failed to sign token","Reason: ".concat((o=d.t0.message)!==null&&o!==void 0?o:d.t0))));case 11:case"end":return d.stop()}},t,null,[[2,8]])})),_signToken.apply(this,arguments)}var _$module_123={};Object.defineProperty(_$module_123,"__esModule",{value:!0}),_$module_123.default=function(t){___app_123.default.read(_$constants_86.MODULES_KEY)||___app_123.default.write([],_$constants_86.MODULES_KEY),t.route("/api/module/:name").get(getModule).patch(updateModule).delete(deleteModule),t.route("/api/modules").get(getAllModules).post(createModule).put(replaceModule)};var __obj_123,___app_123=(__obj_123=_$app_87)&&__obj_123.__esModule?__obj_123:{default:__obj_123},___excluded_123=["content"];function ___objectWithoutProperties_123(t,e){if(t==null)return{};var r,n,o=function(d,h){if(d==null)return{};var y,k,A={},D=Object.keys(d);for(k=0;k<D.length;k++)y=D[k],h.indexOf(y)>=0||(A[y]=d[y]);return A}(t,e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(t);for(n=0;n<f.length;n++)r=f[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function __ownKeys_123(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function ___objectSpread_123(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?__ownKeys_123(Object(r),!0).forEach(function(n){___defineProperty_123(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):__ownKeys_123(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ___defineProperty_123(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function createModule(t,e){var r,n=t.body;n.name="".concat((r=n.name)!==null&&r!==void 0?r:(0,_$md5_150.hex_md5)(JSON.stringify(n))),___app_123.default.info("\u6B63\u5728\u521B\u5EFA\u6A21\u5757\uFF1A".concat(n.name));var o=___app_123.default.read(_$constants_86.MODULES_KEY);if((0,_$database_133.findByName)(o,n.name))return(0,_$response_127.failed)(e,new _$errors_119.RequestInvalidError("DUPLICATE_KEY",t.body.name?"\u5DF2\u5B58\u5728 name \u4E3A ".concat(n.name," \u7684\u6A21\u5757"):"\u5DF2\u5B58\u5728\u76F8\u540C\u7684\u6A21\u5757 \u8BF7\u52FF\u91CD\u590D\u6DFB\u52A0"));o.push(n),___app_123.default.write(o,_$constants_86.MODULES_KEY),(0,_$response_127.success)(e,n,201)}function getModule(t,e){var r=t.params.name;r=decodeURIComponent(r);var n=___app_123.default.read(_$constants_86.MODULES_KEY),o=(0,_$database_133.findByName)(n,r);o?e.set("Content-Type","text/plain; charset=utf-8").send(o.content):(0,_$response_127.failed)(e,new _$errors_119.ResourceNotFoundError("MODULE_NOT_FOUND","Module ".concat(r," does not exist"),404))}function updateModule(t,e){var r=t.params.name;r=decodeURIComponent(r);var n=t.body,o=___app_123.default.read(_$constants_86.MODULES_KEY),f=(0,_$database_133.findByName)(o,r);if(f){var d=___objectSpread_123(___objectSpread_123({},f),n);___app_123.default.info("\u6B63\u5728\u66F4\u65B0\u6A21\u5757\uFF1A".concat(r,"...")),(0,_$database_133.updateByName)(o,r,d),___app_123.default.write(o,_$constants_86.MODULES_KEY),(0,_$response_127.success)(e,d)}else(0,_$response_127.failed)(e,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","Module ".concat(r," does not exist!")),404)}function deleteModule(t,e){var r=t.params.name;r=decodeURIComponent(r),___app_123.default.info("\u6B63\u5728\u5220\u9664\u6A21\u5757\uFF1A".concat(r));var n=___app_123.default.read(_$constants_86.MODULES_KEY);(0,_$database_133.deleteByName)(n,r),___app_123.default.write(n,_$constants_86.MODULES_KEY),(0,_$response_127.success)(e)}function getAllModules(t,e){var r=___app_123.default.read(_$constants_86.MODULES_KEY);(0,_$response_127.success)(e,r.map(function(n){return n.content,___objectWithoutProperties_123(n,___excluded_123)}))}function replaceModule(t,e){var r=t.body;___app_123.default.write(r,_$constants_86.MODULES_KEY),(0,_$response_127.success)(e)}var _$userAgent_147={};function getUserAgentFromHeaders(t){for(var e="",r="",n="",o=0,f=Object.keys(t);o<f.length;o++){var d=f[o],h=d.toLowerCase();h==="user-agent"?r=(e=t[d]).toLowerCase():h==="accept"&&(n=t[d])}return{UA:e,ua:r,accept:n}}function getPlatformFromUserAgent(t){var e=t.ua,r=t.UA,n=t.accept;return r.indexOf("Quantumult%20X")!==-1?"QX":e.indexOf("egern")!==-1?"Egern":r.indexOf("Surfboard")!==-1?"Surfboard":r.indexOf("Surge Mac")!==-1?"SurgeMac":r.indexOf("Surge")!==-1?"Surge":r.indexOf("Decar")!==-1||r.indexOf("Loon")!==-1?"Loon":r.indexOf("Shadowrocket")!==-1?"Shadowrocket":r.indexOf("Stash")!==-1?"Stash":e==="meta"||e.indexOf("clash")!==-1&&e.indexOf("meta")!==-1||e.indexOf("clash-verge")!==-1||e.indexOf("flclash")!==-1?"ClashMeta":e.indexOf("clash")!==-1?"Clash":e.indexOf("v2ray")!==-1?"V2Ray":e.indexOf("sing-box")!==-1?"sing-box":n.indexOf("application/json")===0?"JSON":"V2Ray"}Object.defineProperty(_$userAgent_147,"__esModule",{value:!0}),_$userAgent_147.getPlatformFromHeaders=function(t){var e=getUserAgentFromHeaders(t),r=e.UA;return getPlatformFromUserAgent({ua:e.ua,UA:r,accept:e.accept})},_$userAgent_147.getPlatformFromUserAgent=getPlatformFromUserAgent,_$userAgent_147.getUserAgentFromHeaders=getUserAgentFromHeaders;var _$download_118={};function ___typeof_118(t){return(___typeof_118=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$download_118,"__esModule",{value:!0}),_$download_118.default=function(t){var e,r,n,o;t.get("/share/col/:name",downloadCollection),t.get("/share/sub/:name",downloadSubscription),t.get("/download/collection/:name",downloadCollection),t.get("/download/:name",downloadSubscription),t.get("/download/collection/:name/api/v1/server/details",(o=___asyncToGenerator_118(___regeneratorRuntime_118().mark(function f(d,h){return ___regeneratorRuntime_118().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return d.query.platform="JSON",d.query.produceType="internal",d.query.resultFormat="nezha",y.next=5,downloadCollection(d,h);case 5:case"end":return y.stop()}},f)})),function(f,d){return o.apply(this,arguments)})),t.get("/download/:name/api/v1/server/details",(n=___asyncToGenerator_118(___regeneratorRuntime_118().mark(function f(d,h){return ___regeneratorRuntime_118().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return d.query.platform="JSON",d.query.produceType="internal",d.query.resultFormat="nezha",y.next=5,downloadSubscription(d,h);case 5:case"end":return y.stop()}},f)})),function(f,d){return n.apply(this,arguments)})),t.get("/download/collection/:name/api/v1/monitor/:nezhaIndex",(r=___asyncToGenerator_118(___regeneratorRuntime_118().mark(function f(d,h){return ___regeneratorRuntime_118().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return d.query.platform="JSON",d.query.produceType="internal",d.query.resultFormat="nezha-monitor",y.next=5,downloadCollection(d,h);case 5:case"end":return y.stop()}},f)})),function(f,d){return r.apply(this,arguments)})),t.get("/download/:name/api/v1/monitor/:nezhaIndex",(e=___asyncToGenerator_118(___regeneratorRuntime_118().mark(function f(d,h){return ___regeneratorRuntime_118().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return d.query.platform="JSON",d.query.produceType="internal",d.query.resultFormat="nezha-monitor",y.next=5,downloadSubscription(d,h);case 5:case"end":return y.stop()}},f)})),function(f,d){return e.apply(this,arguments)}))};var ___proxyUtils_118=_$proxyUtils_88({}),___app_118=___interopRequireDefault_118(_$app_87),___sync_118=_$sync_131({}),___env_118=___interopRequireDefault_118(_$env_136);function ___interopRequireDefault_118(t){return t&&t.__esModule?t:{default:t}}function ___toConsumableArray_118(t){return function(e){if(Array.isArray(e))return ___arrayLikeToArray_118(e)}(t)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(t)||___unsupportedIterableToArray_118(t)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ___createForOfIteratorHelper_118(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=___unsupportedIterableToArray_118(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,d=!0,h=!1;return{s:function(){r=r.call(t)},n:function(){var y=r.next();return d=y.done,y},e:function(y){h=!0,f=y},f:function(){try{d||r.return==null||r.return()}finally{if(h)throw f}}}}function ___unsupportedIterableToArray_118(t,e){if(t){if(typeof t=="string")return ___arrayLikeToArray_118(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?___arrayLikeToArray_118(t,e):void 0}}function ___arrayLikeToArray_118(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ___regeneratorRuntime_118(){___regeneratorRuntime_118=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=typeof Symbol=="function"?Symbol:{},o=n.iterator||"@@iterator",f=n.asyncIterator||"@@asyncIterator",d=n.toStringTag||"@@toStringTag";function h(l,s,b){return Object.defineProperty(l,s,{value:b,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,b,$){return s[b]=$}}function y(l,s,b,$){var E=s&&s.prototype instanceof D?s:D,rt=Object.create(E.prototype),_t=new ft($||[]);return rt._invoke=function(xt,St,x){var N="suspendedStart";return function(V,S){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(V==="throw")throw S;return{value:void 0,done:!0}}for(x.method=V,x.arg=S;;){var C=x.delegate;if(C){var T=tt(C,x);if(T){if(T===A)continue;return T}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var M=k(xt,St,x);if(M.type==="normal"){if(N=x.done?"completed":"suspendedYield",M.arg===A)continue;return{value:M.arg,done:x.done}}M.type==="throw"&&(N="completed",x.method="throw",x.arg=M.arg)}}}(l,b,_t),rt}function k(l,s,b){try{return{type:"normal",arg:l.call(s,b)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var A={};function D(){}function q(){}function H(){}var z={};h(z,o,function(){return this});var Z=Object.getPrototypeOf,j=Z&&Z(Z(yt([])));j&&j!==e&&r.call(j,o)&&(z=j);var at=H.prototype=D.prototype=Object.create(z);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(b){return this._invoke(s,b)})})}function ot(l,s){var b;this._invoke=function($,E){function rt(){return new s(function(_t,xt){(function St(x,N,V,S){var C=k(l[x],l,N);if(C.type!=="throw"){var T=C.arg,M=T.value;return M&&___typeof_118(M)=="object"&&r.call(M,"__await")?s.resolve(M.__await).then(function(et){St("next",et,V,S)},function(et){St("throw",et,V,S)}):s.resolve(M).then(function(et){T.value=et,V(T)},function(et){return St("throw",et,V,S)})}S(C.arg)})($,E,_t,xt)})}return b=b?b.then(rt,rt):rt()}}function tt(l,s){var b=l.iterator[s.method];if(b===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,tt(l,s),s.method==="throw"))return A;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var $=k(b,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,A;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,A):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,A)}function gt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function wt(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function ft(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(gt,this),this.reset(!0)}function yt(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var b=-1,$=function E(){for(;++b<l.length;)if(r.call(l,b))return E.value=l[b],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:Ct}}function Ct(){return{value:void 0,done:!0}}return q.prototype=H,h(at,"constructor",H),h(H,"constructor",q),q.displayName=h(H,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===q||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,H):(l.__proto__=H,h(l,d,"GeneratorFunction")),l.prototype=Object.create(at),l},t.awrap=function(l){return{__await:l}},ct(ot.prototype),h(ot.prototype,f,function(){return this}),t.AsyncIterator=ot,t.async=function(l,s,b,$,E){E===void 0&&(E=Promise);var rt=new ot(y(l,s,b,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(_t){return _t.done?_t.value:rt.next()})},ct(at),h(at,d,"Generator"),h(at,o,function(){return this}),h(at,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var b in l)s.push(b);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=yt,ft.prototype={constructor:ft,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(wt),!l)for(var s in this)s.charAt(0)==="t"&&r.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function b(St,x){return rt.type="throw",rt.arg=l,s.next=St,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return b("end");if(E.tryLoc<=this.prev){var _t=r.call(E,"catchLoc"),xt=r.call(E,"finallyLoc");if(_t&&xt){if(this.prev<E.catchLoc)return b(E.catchLoc,!0);if(this.prev<E.finallyLoc)return b(E.finallyLoc)}else if(_t){if(this.prev<E.catchLoc)return b(E.catchLoc,!0)}else{if(!xt)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return b(E.finallyLoc)}}}},abrupt:function(l,s){for(var b=this.tryEntries.length-1;b>=0;--b){var $=this.tryEntries[b];if($.tryLoc<=this.prev&&r.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,A):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),A},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.finallyLoc===l)return this.complete(b.completion,b.afterLoc),wt(b),A}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.tryLoc===l){var $=b.completion;if($.type==="throw"){var E=$.arg;wt(b)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,b){return this.delegate={iterator:yt(l),resultName:s,nextLoc:b},this.method==="next"&&(this.arg=void 0),A}},t}function __asyncGeneratorStep_118(t,e,r,n,o,f,d){try{var h=t[f](d),y=h.value}catch(k){return void r(k)}h.done?e(y):Promise.resolve(y).then(n,o)}function ___asyncToGenerator_118(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var f=t.apply(e,r);function d(y){__asyncGeneratorStep_118(f,n,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_118(f,n,o,d,h,"throw",y)}d(void 0)})}}function downloadSubscription(t,e){return _downloadSubscription.apply(this,arguments)}function _downloadSubscription(){return(_downloadSubscription=___asyncToGenerator_118(___regeneratorRuntime_118().mark(function t(e,r){var n,o,f,d,h,y,k,A,D,q,H,z,Z,j,at,ct,ot,tt,gt,wt,ft,yt,Ct,l,s,b,$,E,rt,_t,xt,St,x,N,V,S,C,T;return ___regeneratorRuntime_118().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(n=e.params,o=n.name,f=n.nezhaIndex,o=decodeURIComponent(o),f=decodeURIComponent(f),d=e.query.target==="SurgeMac",h=e.query.target||(0,_$userAgent_147.getPlatformFromHeaders)(e.headers)||"JSON",___app_118.default.info("\u6B63\u5728\u4E0B\u8F7D\u8BA2\u9605\uFF1A".concat(o,`
\u8BF7\u6C42 User-Agent: `).concat(e.headers["user-agent"]||e.headers["User-Agent"])),y=e.query,k=y.url,A=y.ua,D=y.content,q=y.mergeSources,H=y.ignoreFailedRemoteSub,z=y.produceType,Z=y.includeUnsupportedProxy,j=y.resultFormat,at=y.proxy,ct=y.noCache,ot={},e.query.$options){try{ot=JSON.parse(decodeURIComponent(e.query.$options))}catch{tt=___createForOfIteratorHelper_118(e.query.$options.split("&"));try{for(tt.s();!(gt=tt.n()).done;)wt=gt.value,ft=wt.split("=")[0],yt=wt.split("=")[1],ot[ft]=yt==null||yt===""||decodeURIComponent(yt)}catch(Pt){tt.e(Pt)}finally{tt.f()}}___app_118.default.info("\u4F20\u5165 $options: ".concat(JSON.stringify(ot)))}if(k&&(k=decodeURIComponent(k),___app_118.default.info("\u6307\u5B9A\u8FDC\u7A0B\u8BA2\u9605 URL: ".concat(k))),at&&(at=decodeURIComponent(at),___app_118.default.info("\u6307\u5B9A\u8FDC\u7A0B\u8BA2\u9605\u4F7F\u7528\u4EE3\u7406/\u7B56\u7565 proxy: ".concat(at))),A&&(A=decodeURIComponent(A),___app_118.default.info("\u6307\u5B9A\u8FDC\u7A0B\u8BA2\u9605 User-Agent: ".concat(A))),D&&(D=decodeURIComponent(D),___app_118.default.info("\u6307\u5B9A\u672C\u5730\u8BA2\u9605: ".concat(D))),q&&(q=decodeURIComponent(q),___app_118.default.info("\u6307\u5B9A\u5408\u5E76\u6765\u6E90: ".concat(q))),H!=null&&H!==""&&(H=decodeURIComponent(H),___app_118.default.info("\u6307\u5B9A\u5FFD\u7565\u5931\u8D25\u7684\u8FDC\u7A0B\u8BA2\u9605: ".concat(H))),z&&(z=decodeURIComponent(z),___app_118.default.info("\u6307\u5B9A\u751F\u4EA7\u7C7B\u578B: ".concat(z))),Z&&(Z=decodeURIComponent(Z),___app_118.default.info("\u5305\u542B\u4E0D\u652F\u6301\u7684\u8282\u70B9: ".concat(Z))),d&&___app_118.default.info("\u624B\u52A8\u6307\u5B9A\u4E86 target \u4E3A SurgeMac, \u5C06\u4F7F\u7528 Mihomo External"),ct&&___app_118.default.info("\u6307\u5B9A\u4E0D\u4F7F\u7528\u7F13\u5B58: ".concat(ct)),Ct=___app_118.default.read(_$constants_86.SUBS_KEY),!(l=(0,_$database_133.findByName)(Ct,o))){M.next=67;break}return M.prev=22,M.next=25,(0,___sync_118.produceArtifact)({type:"subscription",name:o,platform:h,url:k,ua:A,content:D,mergeSources:q,ignoreFailedRemoteSub:H,produceType:z,produceOpts:{"include-unsupported-proxy":Z,useMihomoExternal:d},$options:ot,proxy:at,noCache:ct});case 25:if(s=M.sent,l.source==="local"&&!["localFirst","remoteFirst"].includes(l.mergeSources)){M.next=43;break}if(M.prev=27,k=(($="".concat(k||l.url).split(/[\r\n]+/).map(function(et){return et.trim()}).filter(function(et){return et.length}))===null||$===void 0?void 0:$[0])||"",E={},rt=k.split("#"),k=k.split("#")[0],rt.length>1)try{E=JSON.parse(decodeURIComponent(rt[1]))}catch{_t=___createForOfIteratorHelper_118(rt[1].split("&"));try{for(_t.s();!(xt=_t.n()).done;)St=xt.value,x=St.split("=")[0],N=St.split("=")[1],E[x]=N==null||N===""||decodeURIComponent(N)}catch(Pt){_t.e(Pt)}finally{_t.f()}}if(E.noFlow){M.next=38;break}return M.next=36,(0,_$flow_137.getFlowHeaders)((V=E)!==null&&V!==void 0&&V.insecure?"".concat(k,"#insecure"):k,E.flowUserAgent,void 0,at||l.proxy,E.flowUrl);case 36:(b=M.sent)&&r.set("subscription-userinfo",b);case 38:M.next=43;break;case 40:M.prev=40,M.t0=M.catch(27),___app_118.default.error("\u8BA2\u9605 ".concat(o," \u83B7\u53D6\u6D41\u91CF\u4FE1\u606F\u65F6\u53D1\u751F\u9519\u8BEF: ").concat(JSON.stringify(M.t0)));case 43:if(l.subUserinfo&&r.set("subscription-userinfo",[l.subUserinfo,b].filter(function(et){return et}).join("; ")),h!=="JSON"){M.next=57;break}if(j!=="nezha"){M.next=49;break}s=nezhaTransform(s),M.next=54;break;case 49:if(j!=="nezha-monitor"){M.next=54;break}return f=/^\d+$/.test(f)?parseInt(f,10):s.findIndex(function(et){return et.name===f}),M.next=53,nezhaMonitor(s[f],f,e.query);case 53:s=M.sent;case 54:r.set("Content-Type","application/json;charset=utf-8").send(s),M.next=58;break;case 57:r.send(s);case 58:M.next=65;break;case 60:M.prev=60,M.t1=M.catch(22),___app_118.default.notify("\u{1F30D} Sub-Store \u4E0B\u8F7D\u8BA2\u9605\u5931\u8D25","\u274C \u65E0\u6CD5\u4E0B\u8F7D\u8BA2\u9605\uFF1A".concat(o,"\uFF01"),"\u{1F914} \u539F\u56E0\uFF1A".concat((S=M.t1.message)!==null&&S!==void 0?S:M.t1)),___app_118.default.error((C=M.t1.message)!==null&&C!==void 0?C:M.t1),(0,_$response_127.failed)(r,new _$errors_119.InternalServerError("INTERNAL_SERVER_ERROR","Failed to download subscription: ".concat(o),"Reason: ".concat((T=M.t1.message)!==null&&T!==void 0?T:M.t1)));case 65:M.next=69;break;case 67:___app_118.default.error("\u{1F30D} Sub-Store \u4E0B\u8F7D\u8BA2\u9605\u5931\u8D25","\u274C \u672A\u627E\u5230\u8BA2\u9605\uFF1A".concat(o,"\uFF01")),(0,_$response_127.failed)(r,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","Subscription ".concat(o," does not exist!")),404);case 69:case"end":return M.stop()}},t,null,[[22,60],[27,40]])}))).apply(this,arguments)}function downloadCollection(t,e){return _downloadCollection.apply(this,arguments)}function _downloadCollection(){return(_downloadCollection=___asyncToGenerator_118(___regeneratorRuntime_118().mark(function t(e,r){var n,o,f,d,h,y,k,A,D,q,H,z,Z,j,at,ct,ot,tt,gt,wt,ft,yt,Ct,l,s,b,$,E,rt,_t,xt,St,x,N,V,S,C;return ___regeneratorRuntime_118().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(n=e.params,o=n.name,f=n.nezhaIndex,o=decodeURIComponent(o),f=decodeURIComponent(f),d=e.query.target==="SurgeMac",h=e.query.target||(0,_$userAgent_147.getPlatformFromHeaders)(e.headers)||"JSON",y=___app_118.default.read(_$constants_86.COLLECTIONS_KEY),k=(0,_$database_133.findByName)(y,o),___app_118.default.info("\u6B63\u5728\u4E0B\u8F7D\u7EC4\u5408\u8BA2\u9605\uFF1A".concat(o,`
\u8BF7\u6C42 User-Agent: `).concat(e.headers["user-agent"]||e.headers["User-Agent"])),A=e.query,D=A.ignoreFailedRemoteSub,q=A.produceType,H=A.includeUnsupportedProxy,z=A.resultFormat,Z=A.proxy,j=A.noCache,at={},e.query.$options){try{at=JSON.parse(decodeURIComponent(e.query.$options))}catch{ct=___createForOfIteratorHelper_118(e.query.$options.split("&"));try{for(ct.s();!(ot=ct.n()).done;)tt=ot.value,gt=tt.split("=")[0],wt=tt.split("=")[1],at[gt]=wt==null||wt===""||decodeURIComponent(wt)}catch(et){ct.e(et)}finally{ct.f()}}___app_118.default.info("\u4F20\u5165 $options: ".concat(JSON.stringify(at)))}if(Z&&(Z=decodeURIComponent(Z),___app_118.default.info("\u6307\u5B9A\u8FDC\u7A0B\u8BA2\u9605\u4F7F\u7528\u4EE3\u7406/\u7B56\u7565 proxy: ".concat(Z))),D!=null&&D!==""&&(D=decodeURIComponent(D),___app_118.default.info("\u6307\u5B9A\u5FFD\u7565\u5931\u8D25\u7684\u8FDC\u7A0B\u8BA2\u9605: ".concat(D))),q&&(q=decodeURIComponent(q),___app_118.default.info("\u6307\u5B9A\u751F\u4EA7\u7C7B\u578B: ".concat(q))),H&&(H=decodeURIComponent(H),___app_118.default.info("\u5305\u542B\u4E0D\u652F\u6301\u7684\u8282\u70B9: ".concat(H))),d&&___app_118.default.info("\u624B\u52A8\u6307\u5B9A\u4E86 target \u4E3A SurgeMac, \u5C06\u4F7F\u7528 Mihomo External"),j&&___app_118.default.info("\u6307\u5B9A\u4E0D\u4F7F\u7528\u7F13\u5B58: ".concat(j)),!k){T.next=66;break}return T.prev=18,T.next=21,(0,___sync_118.produceArtifact)({type:"collection",name:o,platform:h,ignoreFailedRemoteSub:D,produceType:q,produceOpts:{"include-unsupported-proxy":H,useMihomoExternal:d},$options:at,proxy:Z,noCache:j});case 21:if(ft=T.sent,yt=___app_118.default.read(_$constants_86.SUBS_KEY),!((Ct=k.subscriptions).length>0)){T.next=44;break}if((l=(0,_$database_133.findByName)(yt,Ct[0])).source==="local"&&!["localFirst","remoteFirst"].includes(l.mergeSources)){T.next=43;break}if(T.prev=27,$=((b="".concat(l.url).split(/[\r\n]+/).map(function(M){return M.trim()}).filter(function(M){return M.length}))===null||b===void 0?void 0:b[0])||"",E={},rt=$.split("#"),$=$.split("#")[0],rt.length>1)try{E=JSON.parse(decodeURIComponent(rt[1]))}catch{_t=___createForOfIteratorHelper_118(rt[1].split("&"));try{for(_t.s();!(xt=_t.n()).done;)St=xt.value,x=St.split("=")[0],N=St.split("=")[1],E[x]=N==null||N===""||decodeURIComponent(N)}catch(et){_t.e(et)}finally{_t.f()}}if(E.noFlow){T.next=38;break}return T.next=36,(0,_$flow_137.getFlowHeaders)((V=E)!==null&&V!==void 0&&V.insecure?"".concat($,"#insecure"):$,E.flowUserAgent,void 0,Z||l.proxy||k.proxy,E.flowUrl);case 36:(s=T.sent)&&r.set("subscription-userinfo",s);case 38:T.next=43;break;case 40:T.prev=40,T.t0=T.catch(27),___app_118.default.error("\u7EC4\u5408\u8BA2\u9605 ".concat(o," \u4E2D\u7684\u5B50\u8BA2\u9605 ").concat(l.name," \u83B7\u53D6\u6D41\u91CF\u4FE1\u606F\u65F6\u53D1\u751F\u9519\u8BEF: ").concat((S=T.t0.message)!==null&&S!==void 0?S:T.t0));case 43:l.subUserinfo&&r.set("subscription-userinfo",[l.subUserinfo,s].filter(function(M){return M}).join("; "));case 44:if(h!=="JSON"){T.next=57;break}if(z!=="nezha"){T.next=49;break}ft=nezhaTransform(ft),T.next=54;break;case 49:if(z!=="nezha-monitor"){T.next=54;break}return f=/^\d+$/.test(f)?parseInt(f,10):ft.findIndex(function(M){return M.name===f}),T.next=53,nezhaMonitor(ft[f],f,e.query);case 53:ft=T.sent;case 54:r.set("Content-Type","application/json;charset=utf-8").send(ft),T.next=58;break;case 57:r.send(ft);case 58:T.next=64;break;case 60:T.prev=60,T.t1=T.catch(18),___app_118.default.notify("\u{1F30D} Sub-Store \u4E0B\u8F7D\u7EC4\u5408\u8BA2\u9605\u5931\u8D25","\u274C \u4E0B\u8F7D\u7EC4\u5408\u8BA2\u9605\u9519\u8BEF\uFF1A".concat(o,"\uFF01"),"\u{1F914} \u539F\u56E0\uFF1A".concat(T.t1)),(0,_$response_127.failed)(r,new _$errors_119.InternalServerError("INTERNAL_SERVER_ERROR","Failed to download collection: ".concat(o),"Reason: ".concat((C=T.t1.message)!==null&&C!==void 0?C:T.t1)));case 64:T.next=68;break;case 66:___app_118.default.error("\u{1F30D} Sub-Store \u4E0B\u8F7D\u7EC4\u5408\u8BA2\u9605\u5931\u8D25","\u274C \u672A\u627E\u5230\u7EC4\u5408\u8BA2\u9605\uFF1A".concat(o,"\uFF01")),(0,_$response_127.failed)(r,new _$errors_119.ResourceNotFoundError("RESOURCE_NOT_FOUND","Collection ".concat(o," does not exist!")),404);case 68:case"end":return T.stop()}},t,null,[[18,60],[27,40]])}))).apply(this,arguments)}function nezhaMonitor(t,e,r){return _nezhaMonitor.apply(this,arguments)}function _nezhaMonitor(){return(_nezhaMonitor=___asyncToGenerator_118(___regeneratorRuntime_118().mark(function t(e,r,n){var o,f,d,h,y,k,A,D,q,H,z,Z,j,at,ct,ot;return ___regeneratorRuntime_118().wrap(function(tt){for(;;)switch(tt.prev=tt.next){case 0:if(o={code:0,message:"success",result:[]},tt.prev=1,f=___app_118.default.env,d=f.isLoon,h=f.isSurge,d||h){tt.next=5;break}throw new Error("\u4EC5\u652F\u6301 Loon \u548C Surge(ability=http-client-policy)");case 5:if(y=___proxyUtils_118.ProxyUtils.produce([e],d?"Loon":"Surge")){tt.next=8;break}throw new Error("\u5F53\u524D\u5BA2\u6237\u7AEF\u4E0D\u517C\u5BB9\u6B64\u8282\u70B9");case 8:k=e._monitors||[{name:"Cloudflare",url:"http://cp.cloudflare.com/generate_204",method:"HEAD",number:3,timeout:2e3},{name:"Google",url:"http://www.google.com/generate_204",method:"HEAD",number:3,timeout:2e3}],A=n.number||Math.max.apply(Math,___toConsumableArray_118(k.map(function(gt){return gt.number})))||3,D=___createForOfIteratorHelper_118(k),tt.prev=11,D.s();case 13:if((q=D.n()).done){tt.next=39;break}H=q.value,z=6e5,Z={monitor_id:k.indexOf(H),server_id:r,monitor_name:H.name,server_name:e.name,created_at:[],avg_delay:[]},j=0;case 18:if(!(j<A)){tt.next=36;break}return at=Date.now(),tt.prev=20,tt.next=23,___app_118.default.http[(H.method||"HEAD").toLowerCase()]({timeout:H.timeout||2e3,url:H.url,"policy-descriptor":y,node:y});case 23:ct=Date.now()-at,___app_118.default.info("".concat(H.name," latency: ").concat(ct)),Z.avg_delay.push(ct),tt.next=32;break;case 28:tt.prev=28,tt.t0=tt.catch(20),___app_118.default.error(tt.t0),Z.avg_delay.push(0);case 32:Z.created_at.push(Date.now()-z*(H.number-j-1));case 33:j++,tt.next=18;break;case 36:o.result.push(Z);case 37:tt.next=13;break;case 39:tt.next=44;break;case 41:tt.prev=41,tt.t1=tt.catch(11),D.e(tt.t1);case 44:return tt.prev=44,D.f(),tt.finish(44);case 47:tt.next=53;break;case 49:tt.prev=49,tt.t2=tt.catch(1),___app_118.default.error(tt.t2),o.result.push({monitor_id:0,server_id:0,monitor_name:"\u274C ".concat((ot=tt.t2.message)!==null&&ot!==void 0?ot:tt.t2),server_name:e.name,created_at:[Date.now()],avg_delay:[0]});case 53:return tt.abrupt("return",JSON.stringify(o,null,2));case 54:case"end":return tt.stop()}},t,null,[[1,49],[11,41,44,47],[20,28]])}))).apply(this,arguments)}function nezhaTransform(t){var e={code:0,message:"success",result:[]};return t.map(function(r,n){var o,f,d=((o=r._geo)===null||o===void 0?void 0:o.countryCode)||((f=r._geo)===null||f===void 0?void 0:f.country);if(/^[a-z]{2}$/i.test(d)||(d=(0,_$geo_138.getISO)(r.name)),/^[a-z]{2}$/i.test(d)){var h,y=Math.round(new Date().getTime()/1e3),k=r._unavailable?0:y,A=parseInt(r._uptime||0,10);e.result.push({id:n,name:r.name,tag:"".concat((h=r._tag)!==null&&h!==void 0?h:""),last_active:k,valid_ip:r._IP||r.server,ipv4:r._IPv4||r.server,ipv6:r._IPv6||((0,_$utils_141.isIPv6)(r.server)?r.server:""),host:{Platform:"Sub-Store",PlatformVersion:___env_118.default.version,CPU:[],MemTotal:1024,DiskTotal:1024,SwapTotal:1024,Arch:"",Virtualization:"",BootTime:y-A,CountryCode:d,Version:"0.0.1"},status:{CPU:0,MemUsed:0,SwapUsed:0,DiskUsed:0,NetInTransfer:0,NetOutTransfer:0,NetInSpeed:0,NetOutSpeed:0,Uptime:A,Load1:0,Load5:0,Load15:0,TcpConnCount:0,UdpConnCount:0,ProcessCount:0}})}}),JSON.stringify(e,null,2)}var _$preview_126={};Object.defineProperty(_$preview_126,"__esModule",{value:!0}),_$preview_126.default=function(t){t.post("/api/preview/sub",compareSub),t.post("/api/preview/collection",compareCollection),t.post("/api/preview/file",previewFile)};var ___proxyUtils_126=_$proxyUtils_88({}),___download_126=___interopRequireDefault_126(_$download_135),___app_126=___interopRequireDefault_126(_$app_87);function ___interopRequireDefault_126(t){return t&&t.__esModule?t:{default:t}}function ___typeof_126(t){return(___typeof_126=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function ___toConsumableArray_126(t){return function(e){if(Array.isArray(e))return ___arrayLikeToArray_126(e)}(t)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(t)||function(e,r){if(e){if(typeof e=="string")return ___arrayLikeToArray_126(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?___arrayLikeToArray_126(e,void 0):void 0}}(t)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ___arrayLikeToArray_126(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ___defineProperty_126(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ___regeneratorRuntime_126(){___regeneratorRuntime_126=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=typeof Symbol=="function"?Symbol:{},o=n.iterator||"@@iterator",f=n.asyncIterator||"@@asyncIterator",d=n.toStringTag||"@@toStringTag";function h(l,s,b){return Object.defineProperty(l,s,{value:b,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,b,$){return s[b]=$}}function y(l,s,b,$){var E=s&&s.prototype instanceof D?s:D,rt=Object.create(E.prototype),_t=new ft($||[]);return rt._invoke=function(xt,St,x){var N="suspendedStart";return function(V,S){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(V==="throw")throw S;return{value:void 0,done:!0}}for(x.method=V,x.arg=S;;){var C=x.delegate;if(C){var T=tt(C,x);if(T){if(T===A)continue;return T}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var M=k(xt,St,x);if(M.type==="normal"){if(N=x.done?"completed":"suspendedYield",M.arg===A)continue;return{value:M.arg,done:x.done}}M.type==="throw"&&(N="completed",x.method="throw",x.arg=M.arg)}}}(l,b,_t),rt}function k(l,s,b){try{return{type:"normal",arg:l.call(s,b)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var A={};function D(){}function q(){}function H(){}var z={};h(z,o,function(){return this});var Z=Object.getPrototypeOf,j=Z&&Z(Z(yt([])));j&&j!==e&&r.call(j,o)&&(z=j);var at=H.prototype=D.prototype=Object.create(z);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(b){return this._invoke(s,b)})})}function ot(l,s){var b;this._invoke=function($,E){function rt(){return new s(function(_t,xt){(function St(x,N,V,S){var C=k(l[x],l,N);if(C.type!=="throw"){var T=C.arg,M=T.value;return M&&___typeof_126(M)=="object"&&r.call(M,"__await")?s.resolve(M.__await).then(function(et){St("next",et,V,S)},function(et){St("throw",et,V,S)}):s.resolve(M).then(function(et){T.value=et,V(T)},function(et){return St("throw",et,V,S)})}S(C.arg)})($,E,_t,xt)})}return b=b?b.then(rt,rt):rt()}}function tt(l,s){var b=l.iterator[s.method];if(b===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,tt(l,s),s.method==="throw"))return A;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var $=k(b,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,A;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,A):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,A)}function gt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function wt(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function ft(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(gt,this),this.reset(!0)}function yt(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var b=-1,$=function E(){for(;++b<l.length;)if(r.call(l,b))return E.value=l[b],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:Ct}}function Ct(){return{value:void 0,done:!0}}return q.prototype=H,h(at,"constructor",H),h(H,"constructor",q),q.displayName=h(H,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===q||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,H):(l.__proto__=H,h(l,d,"GeneratorFunction")),l.prototype=Object.create(at),l},t.awrap=function(l){return{__await:l}},ct(ot.prototype),h(ot.prototype,f,function(){return this}),t.AsyncIterator=ot,t.async=function(l,s,b,$,E){E===void 0&&(E=Promise);var rt=new ot(y(l,s,b,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(_t){return _t.done?_t.value:rt.next()})},ct(at),h(at,d,"Generator"),h(at,o,function(){return this}),h(at,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var b in l)s.push(b);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=yt,ft.prototype={constructor:ft,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(wt),!l)for(var s in this)s.charAt(0)==="t"&&r.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function b(St,x){return rt.type="throw",rt.arg=l,s.next=St,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return b("end");if(E.tryLoc<=this.prev){var _t=r.call(E,"catchLoc"),xt=r.call(E,"finallyLoc");if(_t&&xt){if(this.prev<E.catchLoc)return b(E.catchLoc,!0);if(this.prev<E.finallyLoc)return b(E.finallyLoc)}else if(_t){if(this.prev<E.catchLoc)return b(E.catchLoc,!0)}else{if(!xt)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return b(E.finallyLoc)}}}},abrupt:function(l,s){for(var b=this.tryEntries.length-1;b>=0;--b){var $=this.tryEntries[b];if($.tryLoc<=this.prev&&r.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,A):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),A},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.finallyLoc===l)return this.complete(b.completion,b.afterLoc),wt(b),A}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.tryLoc===l){var $=b.completion;if($.type==="throw"){var E=$.arg;wt(b)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,b){return this.delegate={iterator:yt(l),resultName:s,nextLoc:b},this.method==="next"&&(this.arg=void 0),A}},t}function __asyncGeneratorStep_126(t,e,r,n,o,f,d){try{var h=t[f](d),y=h.value}catch(k){return void r(k)}h.done?e(y):Promise.resolve(y).then(n,o)}function ___asyncToGenerator_126(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var f=t.apply(e,r);function d(y){__asyncGeneratorStep_126(f,n,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_126(f,n,o,d,h,"throw",y)}d(void 0)})}}function previewFile(t,e){return _previewFile.apply(this,arguments)}function _previewFile(){return(_previewFile=___asyncToGenerator_126(___regeneratorRuntime_126().mark(function t(e,r){var n,o,f,d,h,y,k,A,D;return ___regeneratorRuntime_126().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(q.prev=0,(o=e.body).source!=="local"||["localFirst","remoteFirst"].includes(o.mergeSources)){q.next=6;break}f=o.content,q.next=13;break;case 6:return d={},q.next=9,Promise.all(o.url.split(/[\r\n]+/).map(function(H){return H.trim()}).filter(function(H){return H.length}).map(function(){var H=___asyncToGenerator_126(___regeneratorRuntime_126().mark(function z(Z){return ___regeneratorRuntime_126().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.prev=0,j.next=3,(0,___download_126.default)(Z,o.ua);case 3:return j.abrupt("return",j.sent);case 6:return j.prev=6,j.t0=j.catch(0),d[Z]=j.t0,___app_126.default.error("\u6587\u4EF6 ".concat(o.name," \u7684\u8FDC\u7A0B\u6587\u4EF6 ").concat(Z," \u53D1\u751F\u9519\u8BEF: ").concat(j.t0)),j.abrupt("return","");case 11:case"end":return j.stop()}},z,null,[[0,6]])}));return function(z){return H.apply(this,arguments)}}()));case 9:if(f=q.sent,o.ignoreFailedRemoteFile||!(Object.keys(d).length>0)){q.next=12;break}throw new Error("\u6587\u4EF6 ".concat(o.name," \u7684\u8FDC\u7A0B\u6587\u4EF6 ").concat(Object.keys(d).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 12:o.mergeSources==="localFirst"?f.unshift(o.content):o.mergeSources==="remoteFirst"&&f.push(o.content);case 13:if(h=(Array.isArray(f)?f:[f]).flat(),y=h.filter(function(H){return H!=null&&H!==""}).join(`
`),!(Array.isArray(o.process)&&o.process.length>0)){q.next=21;break}return q.next=18,___proxyUtils_126.ProxyUtils.process({$files:h,$content:y},o.process);case 18:q.t0=q.sent,q.next=22;break;case 21:q.t0={$content:y,$files:h};case 22:k=q.t0,(0,_$response_127.success)(r,{original:y,processed:(n=k?.$content)!==null&&n!==void 0?n:""}),q.next=30;break;case 26:q.prev=26,q.t1=q.catch(0),___app_126.default.error((A=q.t1.message)!==null&&A!==void 0?A:q.t1),(0,_$response_127.failed)(r,new _$errors_119.InternalServerError("INTERNAL_SERVER_ERROR","Failed to preview file","Reason: ".concat((D=q.t1.message)!==null&&D!==void 0?D:q.t1)));case 30:case"end":return q.stop()}},t,null,[[0,26]])}))).apply(this,arguments)}function compareSub(t,e){return _compareSub.apply(this,arguments)}function _compareSub(){return(_compareSub=___asyncToGenerator_126(___regeneratorRuntime_126().mark(function t(e,r){var n,o,f,d,h,y,k,A;return ___regeneratorRuntime_126().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(D.prev=0,n=e.body,o=e.query.target||"JSON",n.source!=="local"||["localFirst","remoteFirst"].includes(n.mergeSources)){D.next=7;break}f=n.content,D.next=14;break;case 7:return d={},D.next=10,Promise.all(n.url.split(/[\r\n]+/).map(function(q){return q.trim()}).filter(function(q){return q.length}).map(function(){var q=___asyncToGenerator_126(___regeneratorRuntime_126().mark(function H(z){return ___regeneratorRuntime_126().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.prev=0,Z.next=3,(0,___download_126.default)(z,n.ua,void 0,n.proxy);case 3:return Z.abrupt("return",Z.sent);case 6:return Z.prev=6,Z.t0=Z.catch(0),d[z]=Z.t0,___app_126.default.error("\u8BA2\u9605 ".concat(n.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(z," \u53D1\u751F\u9519\u8BEF: ").concat(Z.t0)),Z.abrupt("return","");case 11:case"end":return Z.stop()}},H,null,[[0,6]])}));return function(H){return q.apply(this,arguments)}}()));case 10:if(f=D.sent,n.ignoreFailedRemoteSub||!(Object.keys(d).length>0)){D.next=13;break}throw new Error("\u8BA2\u9605 ".concat(n.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(Object.keys(d).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 13:n.mergeSources==="localFirst"?f.unshift(n.content):n.mergeSources==="remoteFirst"&&f.push(n.content);case 14:return(h=(Array.isArray(f)?f:[f]).map(function(q){return ___proxyUtils_126.ProxyUtils.parse(q)}).flat()).forEach(function(q,H){q.id=H,q._subName=n.name,q._subDisplayName=n.displayName}),D.next=18,___proxyUtils_126.ProxyUtils.process(h,n.process||[],o,___defineProperty_126({},n.name,n));case 18:y=D.sent,(0,_$response_127.success)(r,{original:h,processed:y}),D.next=26;break;case 22:D.prev=22,D.t0=D.catch(0),___app_126.default.error((k=D.t0.message)!==null&&k!==void 0?k:D.t0),(0,_$response_127.failed)(r,new _$errors_119.InternalServerError("INTERNAL_SERVER_ERROR","Failed to preview subscription","Reason: ".concat((A=D.t0.message)!==null&&A!==void 0?A:D.t0)));case 26:case"end":return D.stop()}},t,null,[[0,22]])}))).apply(this,arguments)}function compareCollection(t,e){return _compareCollection.apply(this,arguments)}function _compareCollection(){return(_compareCollection=___asyncToGenerator_126(___regeneratorRuntime_126().mark(function t(e,r){var n,o,f,d,h,y,k,A,D,q;return ___regeneratorRuntime_126().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.prev=0,n=___app_126.default.read(_$constants_86.SUBS_KEY),o=e.body,f=___toConsumableArray_126(o.subscriptions),d=o.subscriptionTags,Array.isArray(d)&&d.length>0&&n.forEach(function(z){Array.isArray(z.tag)&&z.tag.length>0&&!f.includes(z.name)&&z.tag.some(function(Z){return d.includes(Z)})&&f.push(z.name)}),h={},y={},H.next=10,Promise.all(f.map(function(){var z=___asyncToGenerator_126(___regeneratorRuntime_126().mark(function Z(j){var at,ct,ot,tt,gt;return ___regeneratorRuntime_126().wrap(function(wt){for(;;)switch(wt.prev=wt.next){case 0:if(at=(0,_$database_133.findByName)(n,j),wt.prev=1,at.source!=="local"||["localFirst","remoteFirst"].includes(at.mergeSources)){wt.next=6;break}ot=at.content,wt.next=13;break;case 6:return tt={},wt.next=9,Promise.all(at.url.split(/[\r\n]+/).map(function(ft){return ft.trim()}).filter(function(ft){return ft.length}).map(function(){var ft=___asyncToGenerator_126(___regeneratorRuntime_126().mark(function yt(Ct){return ___regeneratorRuntime_126().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,(0,___download_126.default)(Ct,at.ua,void 0,at.proxy);case 3:return l.abrupt("return",l.sent);case 6:return l.prev=6,l.t0=l.catch(0),tt[Ct]=l.t0,___app_126.default.error("\u8BA2\u9605 ".concat(at.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(Ct," \u53D1\u751F\u9519\u8BEF: ").concat(l.t0)),l.abrupt("return","");case 11:case"end":return l.stop()}},yt,null,[[0,6]])}));return function(yt){return ft.apply(this,arguments)}}()));case 9:if(ot=wt.sent,at.ignoreFailedRemoteSub||!(Object.keys(tt).length>0)){wt.next=12;break}throw new Error("\u8BA2\u9605 ".concat(at.name," \u7684\u8FDC\u7A0B\u8BA2\u9605 ").concat(Object.keys(tt).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 12:at.mergeSources==="localFirst"?ot.unshift(at.content):at.mergeSources==="remoteFirst"&&ot.push(at.content);case 13:return(gt=(Array.isArray(ot)?ot:[ot]).map(function(ft){return ___proxyUtils_126.ProxyUtils.parse(ft)}).flat()).forEach(function(ft){ft._subName=at.name,ft._subDisplayName=at.displayName,ft._collectionName=o.name,ft._collectionDisplayName=o.displayName}),wt.next=17,___proxyUtils_126.ProxyUtils.process(gt,at.process||[],"JSON",(___defineProperty_126(ct={},at.name,at),___defineProperty_126(ct,"_collection",o),ct));case 17:gt=wt.sent,h[j]=gt,wt.next=25;break;case 21:wt.prev=21,wt.t0=wt.catch(1),y[j]=wt.t0,___app_126.default.error("\u274C \u5904\u7406\u7EC4\u5408\u8BA2\u9605 ".concat(o.name," \u4E2D\u7684\u5B50\u8BA2\u9605: ").concat(at.name,"\u65F6\u51FA\u73B0\u9519\u8BEF\uFF1A").concat(wt.t0,"\uFF01"));case 25:case"end":return wt.stop()}},Z,null,[[1,21]])}));return function(Z){return z.apply(this,arguments)}}()));case 10:if(o.ignoreFailedRemoteSub||!(Object.keys(y).length>0)){H.next=12;break}throw new Error("\u7EC4\u5408\u8BA2\u9605 ".concat(o.name," \u4E2D\u7684\u5B50\u8BA2\u9605 ").concat(Object.keys(y).join(", ")," \u53D1\u751F\u9519\u8BEF, \u8BF7\u67E5\u770B\u65E5\u5FD7"));case 12:return(k=Array.prototype.concat.apply([],f.map(function(z){return h[z]||[]}))).forEach(function(z,Z){z.id=Z,z._collectionName=o.name,z._collectionDisplayName=o.displayName}),H.next=16,___proxyUtils_126.ProxyUtils.process(k,o.process||[],"JSON",{_collection:o});case 16:A=H.sent,(0,_$response_127.success)(r,{original:k,processed:A}),H.next=24;break;case 20:H.prev=20,H.t0=H.catch(0),___app_126.default.error((D=H.t0.message)!==null&&D!==void 0?D:H.t0),(0,_$response_127.failed)(r,new _$errors_119.InternalServerError("INTERNAL_SERVER_ERROR","Failed to preview collection","Reason: ".concat((q=H.t0.message)!==null&&q!==void 0?q:H.t0)));case 24:case"end":return H.stop()}},t,null,[[0,20]])}))).apply(this,arguments)}var _$sort_129={};Object.defineProperty(_$sort_129,"__esModule",{value:!0}),_$sort_129.default=function(t){t.post("/api/sort/subs",sortSubs),t.post("/api/sort/collections",sortCollections),t.post("/api/sort/artifacts",sortArtifacts),t.post("/api/sort/files",sortFiles)};var __obj_129,___app_129=(__obj_129=_$app_87)&&__obj_129.__esModule?__obj_129:{default:__obj_129};function sortSubs(t,e){var r=t.body,n=___app_129.default.read(_$constants_86.SUBS_KEY);n.sort(function(o,f){return r.indexOf(o.name)-r.indexOf(f.name)}),___app_129.default.write(n,_$constants_86.SUBS_KEY),(0,_$response_127.success)(e,n)}function sortCollections(t,e){var r=t.body,n=___app_129.default.read(_$constants_86.COLLECTIONS_KEY);n.sort(function(o,f){return r.indexOf(o.name)-r.indexOf(f.name)}),___app_129.default.write(n,_$constants_86.COLLECTIONS_KEY),(0,_$response_127.success)(e,n)}function sortArtifacts(t,e){var r=t.body,n=___app_129.default.read(_$constants_86.ARTIFACTS_KEY);n.sort(function(o,f){return r.indexOf(o.name)-r.indexOf(f.name)}),___app_129.default.write(n,_$constants_86.ARTIFACTS_KEY),(0,_$response_127.success)(e,n)}function sortFiles(t,e){var r=t.body,n=___app_129.default.read(_$constants_86.FILES_KEY);n.sort(function(o,f){return r.indexOf(o.name)-r.indexOf(f.name)}),___app_129.default.write(n,_$constants_86.FILES_KEY),(0,_$response_127.success)(e,n)}var _$nodeInfo_124={};Object.defineProperty(_$nodeInfo_124,"__esModule",{value:!0}),_$nodeInfo_124.default=function(t){t.post("/api/utils/node-info",getNodeInfo)};var __obj_124,___producers_124=(__obj_124=_$producers_99)&&__obj_124.__esModule?__obj_124:{default:__obj_124};function ___typeof_124(t){return(___typeof_124=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function ___regeneratorRuntime_124(){___regeneratorRuntime_124=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=typeof Symbol=="function"?Symbol:{},o=n.iterator||"@@iterator",f=n.asyncIterator||"@@asyncIterator",d=n.toStringTag||"@@toStringTag";function h(l,s,b){return Object.defineProperty(l,s,{value:b,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,b,$){return s[b]=$}}function y(l,s,b,$){var E=s&&s.prototype instanceof D?s:D,rt=Object.create(E.prototype),_t=new ft($||[]);return rt._invoke=function(xt,St,x){var N="suspendedStart";return function(V,S){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(V==="throw")throw S;return{value:void 0,done:!0}}for(x.method=V,x.arg=S;;){var C=x.delegate;if(C){var T=tt(C,x);if(T){if(T===A)continue;return T}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var M=k(xt,St,x);if(M.type==="normal"){if(N=x.done?"completed":"suspendedYield",M.arg===A)continue;return{value:M.arg,done:x.done}}M.type==="throw"&&(N="completed",x.method="throw",x.arg=M.arg)}}}(l,b,_t),rt}function k(l,s,b){try{return{type:"normal",arg:l.call(s,b)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var A={};function D(){}function q(){}function H(){}var z={};h(z,o,function(){return this});var Z=Object.getPrototypeOf,j=Z&&Z(Z(yt([])));j&&j!==e&&r.call(j,o)&&(z=j);var at=H.prototype=D.prototype=Object.create(z);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(b){return this._invoke(s,b)})})}function ot(l,s){var b;this._invoke=function($,E){function rt(){return new s(function(_t,xt){(function St(x,N,V,S){var C=k(l[x],l,N);if(C.type!=="throw"){var T=C.arg,M=T.value;return M&&___typeof_124(M)=="object"&&r.call(M,"__await")?s.resolve(M.__await).then(function(et){St("next",et,V,S)},function(et){St("throw",et,V,S)}):s.resolve(M).then(function(et){T.value=et,V(T)},function(et){return St("throw",et,V,S)})}S(C.arg)})($,E,_t,xt)})}return b=b?b.then(rt,rt):rt()}}function tt(l,s){var b=l.iterator[s.method];if(b===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,tt(l,s),s.method==="throw"))return A;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var $=k(b,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,A;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,A):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,A)}function gt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function wt(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function ft(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(gt,this),this.reset(!0)}function yt(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var b=-1,$=function E(){for(;++b<l.length;)if(r.call(l,b))return E.value=l[b],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:Ct}}function Ct(){return{value:void 0,done:!0}}return q.prototype=H,h(at,"constructor",H),h(H,"constructor",q),q.displayName=h(H,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===q||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,H):(l.__proto__=H,h(l,d,"GeneratorFunction")),l.prototype=Object.create(at),l},t.awrap=function(l){return{__await:l}},ct(ot.prototype),h(ot.prototype,f,function(){return this}),t.AsyncIterator=ot,t.async=function(l,s,b,$,E){E===void 0&&(E=Promise);var rt=new ot(y(l,s,b,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(_t){return _t.done?_t.value:rt.next()})},ct(at),h(at,d,"Generator"),h(at,o,function(){return this}),h(at,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var b in l)s.push(b);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=yt,ft.prototype={constructor:ft,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(wt),!l)for(var s in this)s.charAt(0)==="t"&&r.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function b(St,x){return rt.type="throw",rt.arg=l,s.next=St,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return b("end");if(E.tryLoc<=this.prev){var _t=r.call(E,"catchLoc"),xt=r.call(E,"finallyLoc");if(_t&&xt){if(this.prev<E.catchLoc)return b(E.catchLoc,!0);if(this.prev<E.finallyLoc)return b(E.finallyLoc)}else if(_t){if(this.prev<E.catchLoc)return b(E.catchLoc,!0)}else{if(!xt)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return b(E.finallyLoc)}}}},abrupt:function(l,s){for(var b=this.tryEntries.length-1;b>=0;--b){var $=this.tryEntries[b];if($.tryLoc<=this.prev&&r.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,A):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),A},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.finallyLoc===l)return this.complete(b.completion,b.afterLoc),wt(b),A}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.tryLoc===l){var $=b.completion;if($.type==="throw"){var E=$.arg;wt(b)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,b){return this.delegate={iterator:yt(l),resultName:s,nextLoc:b},this.method==="next"&&(this.arg=void 0),A}},t}function __asyncGeneratorStep_124(t,e,r,n,o,f,d){try{var h=t[f](d),y=h.value}catch(k){return void r(k)}h.done?e(y):Promise.resolve(y).then(n,o)}function getNodeInfo(t,e){return _getNodeInfo.apply(this,arguments)}function _getNodeInfo(){var t;return t=___regeneratorRuntime_124().mark(function e(r,n){var o,f,d,h,y;return ___regeneratorRuntime_124().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:o=r.body,f=r.query.lang||"zh-CN";try{d=___producers_124.default.URI.produce(o)}catch{}return k.prev=3,h=(0,_$openApi_151.HTTP)(),k.next=7,h.get({url:"http://ip-api.com/json/".concat(encodeURIComponent("".concat(o.server).trim().replace(/^\[/,"").replace(/\]$/,"")),"?lang=").concat(f),headers:{"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 12_4) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Safari/605.1.15"}}).then(function(A){var D=JSON.parse(A.body);if(D.status!=="success")throw new Error(D.message);return delete D.status,D});case 7:y=k.sent,(0,_$response_127.success)(n,{shareUrl:d,info:y}),k.next=14;break;case 11:k.prev=11,k.t0=k.catch(3),(0,_$response_127.failed)(n,new _$errors_119.NetworkError("FAILED_TO_GET_NODE_INFO","Failed to get node info","Reason: ".concat(k.t0)));case 14:case"end":return k.stop()}},e,null,[[3,11]])}),(_getNodeInfo=function(){var e=this,r=arguments;return new Promise(function(n,o){var f=t.apply(e,r);function d(y){__asyncGeneratorStep_124(f,n,o,d,h,"next",y)}function h(y){__asyncGeneratorStep_124(f,n,o,d,h,"throw",y)}d(void 0)})}).apply(this,arguments)}var _$parser_125={};Object.defineProperty(_$parser_125,"__esModule",{value:!0}),_$parser_125.default=function(t){t.route("/api/proxy/parse").post(proxy_parser),t.route("/api/rule/parse").post(rule_parser)};var ___proxyUtils_125=_$proxyUtils_88({});function proxy_parser(t,e){var r=t.body,n=r.data,o=r.client,f=r.content,d=r.platform,h={};try{var y=___proxyUtils_125.ProxyUtils.parse(n??f),k=___proxyUtils_125.ProxyUtils.produce(y,o??d);h.par_res=k}catch(A){return void(0,_$response_127.failed)(e,A)}(0,_$response_127.success)(e,h)}function rule_parser(t,e){var r=t.body,n=r.data,o=r.client,f=r.content,d=r.platform,h={};try{var y=_$ruleUtils_111.RuleUtils.parse(n??f),k=_$ruleUtils_111.RuleUtils.produce(y,o??d);h.par_res=k}catch(A){return void(0,_$response_127.failed)(e,A)}(0,_$response_127.success)(e,h)}var _$restful_121={};(function(__dirname){(function(){"use strict";function _typeof(t){return(_typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(_$restful_121,"__esModule",{value:!0}),_$restful_121.default=serve;var _express=_interopRequireDefault(_$express_149),_app=_interopRequireDefault(_$app_87),_migration=_interopRequireDefault(_$migration_143),_download=_interopRequireDefault(_$download_135),_sync=_interopRequireWildcard(_$sync_131({})),_miscs=_interopRequireWildcard(_$miscs_122),_subscriptions=_interopRequireDefault(_$subscriptions_130),_collections=_interopRequireDefault(_$collections_117),_artifacts=_interopRequireDefault(_$artifacts_116),_file=_interopRequireDefault(_$file_120),_token=_interopRequireDefault(_$token_132),_module=_interopRequireDefault(_$module_123),_download2=_interopRequireDefault(_$download_118),_settings=_interopRequireDefault(_$settings_128),_preview=_interopRequireDefault(_$preview_126),_sort=_interopRequireDefault(_$sort_129),_nodeInfo=_interopRequireDefault(_$nodeInfo_124),_parser=_interopRequireDefault(_$parser_125);function _getRequireWildcardCache(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(n){return n?r:e})(t)}function _interopRequireWildcard(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||_typeof(t)!=="object"&&typeof t!="function")return{default:t};var r=_getRequireWildcardCache(e);if(r&&r.has(t))return r.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var d=o?Object.getOwnPropertyDescriptor(t,f):null;d&&(d.get||d.set)?Object.defineProperty(n,f,d):n[f]=t[f]}return n.default=t,r&&r.set(t,n),n}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=typeof Symbol=="function"?Symbol:{},o=n.iterator||"@@iterator",f=n.asyncIterator||"@@asyncIterator",d=n.toStringTag||"@@toStringTag";function h(l,s,b){return Object.defineProperty(l,s,{value:b,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{h({},"")}catch{h=function(s,b,$){return s[b]=$}}function y(l,s,b,$){var E=s&&s.prototype instanceof D?s:D,rt=Object.create(E.prototype),_t=new ft($||[]);return rt._invoke=function(xt,St,x){var N="suspendedStart";return function(V,S){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(V==="throw")throw S;return{value:void 0,done:!0}}for(x.method=V,x.arg=S;;){var C=x.delegate;if(C){var T=tt(C,x);if(T){if(T===A)continue;return T}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(N==="suspendedStart")throw N="completed",x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);N="executing";var M=k(xt,St,x);if(M.type==="normal"){if(N=x.done?"completed":"suspendedYield",M.arg===A)continue;return{value:M.arg,done:x.done}}M.type==="throw"&&(N="completed",x.method="throw",x.arg=M.arg)}}}(l,b,_t),rt}function k(l,s,b){try{return{type:"normal",arg:l.call(s,b)}}catch($){return{type:"throw",arg:$}}}t.wrap=y;var A={};function D(){}function q(){}function H(){}var z={};h(z,o,function(){return this});var Z=Object.getPrototypeOf,j=Z&&Z(Z(yt([])));j&&j!==e&&r.call(j,o)&&(z=j);var at=H.prototype=D.prototype=Object.create(z);function ct(l){["next","throw","return"].forEach(function(s){h(l,s,function(b){return this._invoke(s,b)})})}function ot(l,s){var b;this._invoke=function($,E){function rt(){return new s(function(_t,xt){(function St(x,N,V,S){var C=k(l[x],l,N);if(C.type!=="throw"){var T=C.arg,M=T.value;return M&&_typeof(M)=="object"&&r.call(M,"__await")?s.resolve(M.__await).then(function(et){St("next",et,V,S)},function(et){St("throw",et,V,S)}):s.resolve(M).then(function(et){T.value=et,V(T)},function(et){return St("throw",et,V,S)})}S(C.arg)})($,E,_t,xt)})}return b=b?b.then(rt,rt):rt()}}function tt(l,s){var b=l.iterator[s.method];if(b===void 0){if(s.delegate=null,s.method==="throw"){if(l.iterator.return&&(s.method="return",s.arg=void 0,tt(l,s),s.method==="throw"))return A;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var $=k(b,l.iterator,s.arg);if($.type==="throw")return s.method="throw",s.arg=$.arg,s.delegate=null,A;var E=$.arg;return E?E.done?(s[l.resultName]=E.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=void 0),s.delegate=null,A):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,A)}function gt(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function wt(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function ft(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(gt,this),this.reset(!0)}function yt(l){if(l){var s=l[o];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var b=-1,$=function E(){for(;++b<l.length;)if(r.call(l,b))return E.value=l[b],E.done=!1,E;return E.value=void 0,E.done=!0,E};return $.next=$}}return{next:Ct}}function Ct(){return{value:void 0,done:!0}}return q.prototype=H,h(at,"constructor",H),h(H,"constructor",q),q.displayName=h(H,d,"GeneratorFunction"),t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return!!s&&(s===q||(s.displayName||s.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,H):(l.__proto__=H,h(l,d,"GeneratorFunction")),l.prototype=Object.create(at),l},t.awrap=function(l){return{__await:l}},ct(ot.prototype),h(ot.prototype,f,function(){return this}),t.AsyncIterator=ot,t.async=function(l,s,b,$,E){E===void 0&&(E=Promise);var rt=new ot(y(l,s,b,$),E);return t.isGeneratorFunction(s)?rt:rt.next().then(function(_t){return _t.done?_t.value:rt.next()})},ct(at),h(at,d,"Generator"),h(at,o,function(){return this}),h(at,"toString",function(){return"[object Generator]"}),t.keys=function(l){var s=[];for(var b in l)s.push(b);return s.reverse(),function $(){for(;s.length;){var E=s.pop();if(E in l)return $.value=E,$.done=!1,$}return $.done=!0,$}},t.values=yt,ft.prototype={constructor:ft,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(wt),!l)for(var s in this)s.charAt(0)==="t"&&r.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var l=this.tryEntries[0].completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function b(St,x){return rt.type="throw",rt.arg=l,s.next=St,x&&(s.method="next",s.arg=void 0),!!x}for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$],rt=E.completion;if(E.tryLoc==="root")return b("end");if(E.tryLoc<=this.prev){var _t=r.call(E,"catchLoc"),xt=r.call(E,"finallyLoc");if(_t&&xt){if(this.prev<E.catchLoc)return b(E.catchLoc,!0);if(this.prev<E.finallyLoc)return b(E.finallyLoc)}else if(_t){if(this.prev<E.catchLoc)return b(E.catchLoc,!0)}else{if(!xt)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return b(E.finallyLoc)}}}},abrupt:function(l,s){for(var b=this.tryEntries.length-1;b>=0;--b){var $=this.tryEntries[b];if($.tryLoc<=this.prev&&r.call($,"finallyLoc")&&this.prev<$.finallyLoc){var E=$;break}}E&&(l==="break"||l==="continue")&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var rt=E?E.completion:{};return rt.type=l,rt.arg=s,E?(this.method="next",this.next=E.finallyLoc,A):this.complete(rt)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),A},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.finallyLoc===l)return this.complete(b.completion,b.afterLoc),wt(b),A}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var b=this.tryEntries[s];if(b.tryLoc===l){var $=b.completion;if($.type==="throw"){var E=$.arg;wt(b)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,b){return this.delegate={iterator:yt(l),resultName:s,nextLoc:b},this.method==="next"&&(this.arg=void 0),A}},t}function asyncGeneratorStep(t,e,r,n,o,f,d){try{var h=t[f](d),y=h.value}catch(k){return void r(k)}h.done?e(y):Promise.resolve(y).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var f=t.apply(e,r);function d(y){asyncGeneratorStep(f,n,o,d,h,"next",y)}function h(y){asyncGeneratorStep(f,n,o,d,h,"throw",y)}d(void 0)})}}function serve(){var port,host;_app.default.env.isNode&&(port=eval("process.env.SUB_STORE_BACKEND_API_PORT")||3e3,host=eval("process.env.SUB_STORE_BACKEND_API_HOST")||"::");var $app=(0,_express.default)({substore:_app.default,port,host});if((0,_collections.default)($app),(0,_subscriptions.default)($app),(0,_download2.default)($app),(0,_preview.default)($app),(0,_sort.default)($app),(0,_settings.default)($app),(0,_artifacts.default)($app),(0,_file.default)($app),(0,_token.default)($app),(0,_module.default)($app),(0,_sync.default)($app),(0,_nodeInfo.default)($app),(0,_miscs.default)($app),(0,_parser.default)($app),$app.start(),_app.default.env.isNode){var backend_sync_cron=eval("process.env.SUB_STORE_BACKEND_SYNC_CRON")||eval("process.env.SUB_STORE_BACKEND_CRON");if(backend_sync_cron){_app.default.info("[SYNC CRON] ".concat(backend_sync_cron," enabled"));var _eval=require("cron"),CronJob=_eval.CronJob;new CronJob(backend_sync_cron,_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,_app.default.info("[SYNC CRON] ".concat(backend_sync_cron," started")),r.next=4,(0,_sync.syncArtifacts)();case 4:_app.default.info("[SYNC CRON] ".concat(backend_sync_cron," finished")),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),_app.default.error("[SYNC CRON] ".concat(backend_sync_cron," error: ").concat((e=r.t0.message)!==null&&e!==void 0?e:r.t0));case 10:case"end":return r.stop()}},t,null,[[0,7]])})),null,!0)}var backend_download_cron=eval("process.env.SUB_STORE_BACKEND_DOWNLOAD_CRON");if(backend_download_cron){_app.default.info("[DOWNLOAD CRON] ".concat(backend_download_cron," enabled"));var _eval2=require("cron"),_CronJob=_eval2.CronJob;new _CronJob(backend_download_cron,_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,_app.default.info("[DOWNLOAD CRON] ".concat(backend_download_cron," started")),r.next=4,(0,_miscs.gistBackupAction)("download");case 4:_app.default.info("[DOWNLOAD CRON] ".concat(backend_download_cron," finished")),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),_app.default.error("[DOWNLOAD CRON] ".concat(backend_download_cron," error: ").concat((e=r.t0.message)!==null&&e!==void 0?e:r.t0));case 10:case"end":return r.stop()}},t,null,[[0,7]])})),null,!0)}var backend_upload_cron=eval("process.env.SUB_STORE_BACKEND_UPLOAD_CRON");if(backend_upload_cron){_app.default.info("[UPLOAD CRON] ".concat(backend_upload_cron," enabled"));var _eval3=require("cron"),_CronJob2=_eval3.CronJob;new _CronJob2(backend_upload_cron,_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,_app.default.info("[UPLOAD CRON] ".concat(backend_upload_cron," started")),r.next=4,(0,_miscs.gistBackupAction)("upload");case 4:_app.default.info("[UPLOAD CRON] ".concat(backend_upload_cron," finished")),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),_app.default.error("[UPLOAD CRON] ".concat(backend_upload_cron," error: ").concat((e=r.t0.message)!==null&&e!==void 0?e:r.t0));case 10:case"end":return r.stop()}},t,null,[[0,7]])})),null,!0)}var path=require("path"),fs=require("fs"),data_url=eval("process.env.SUB_STORE_DATA_URL"),fe_be_path=eval("process.env.SUB_STORE_FRONTEND_BACKEND_PATH"),fe_port=eval("process.env.SUB_STORE_FRONTEND_PORT")||3001,fe_host=eval("process.env.SUB_STORE_FRONTEND_HOST")||host||"::",fe_path=eval("process.env.SUB_STORE_FRONTEND_PATH"),fe_abs_path=path.resolve(fe_path||path.join(__dirname,"frontend"));if(fe_path){try{fs.accessSync(path.join(fe_abs_path,"index.html"))}catch{_app.default.error("[FRONTEND] index.html file not found in ".concat(fe_abs_path))}var express_=require("express"),history=require("connect-history-api-fallback"),_eval4=require("http-proxy-middleware"),createProxyMiddleware=_eval4.createProxyMiddleware,app=express_(),staticFileMiddleware=express_.static(fe_path),be_share_rewrite="/share/:type/:name",be_api_rewrite="",be_download_rewrite="",be_api="/api/",be_download="/download/";if(fe_be_path){if(!fe_be_path.startsWith("/"))throw new Error("SUB_STORE_FRONTEND_BACKEND_PATH should start with /");be_api_rewrite="".concat(fe_be_path==="/"?"":fe_be_path).concat(be_api),be_download_rewrite="".concat(fe_be_path==="/"?"":fe_be_path).concat(be_download),app.use(be_share_rewrite,createProxyMiddleware({target:"http://127.0.0.1:".concat(port),changeOrigin:!0,pathRewrite:function(t,e){if(e.method.toLowerCase()!=="get")throw new Error("Method not allowed");if(!(_app.default.read(_$constants_86.TOKENS_KEY)||[]).find(function(r){return r.token===e.query.token&&r.type===e.params.type&&r.name===e.params.name&&(r.exp==null||r.exp>Date.now())}))throw new Error("Forbbiden");return t}})),app.use(be_api_rewrite,createProxyMiddleware({target:"http://127.0.0.1:".concat(port),pathRewrite:function(t){var e=t.startsWith(be_api_rewrite)?t.replace(be_api_rewrite,be_api):t;return e.includes("?")?"".concat(e,"&share=true"):"".concat(e,"?share=true")}})),app.use(be_download_rewrite,createProxyMiddleware({target:"http://127.0.0.1:".concat(port),changeOrigin:!0,pathRewrite:function(t){return t.startsWith(be_download_rewrite)?t.replace(be_download_rewrite,be_download):t}}))}app.use(staticFileMiddleware),app.use(history({disableDotRule:!0,verbose:!1})),app.use(staticFileMiddleware);var listener=app.listen(fe_port,fe_host,function(){var t=listener.address(),e=t.address,r=t.port;_app.default.info("[FRONTEND] ".concat(e,":").concat(r)),fe_be_path&&(_app.default.info("[FRONTEND -> BACKEND] ".concat(e,":").concat(r).concat(be_api_rewrite," -> http://127.0.0.1:").concat(port).concat(be_api)),_app.default.info("[FRONTEND -> BACKEND] ".concat(e,":").concat(r).concat(be_download_rewrite," -> http://127.0.0.1:").concat(port).concat(be_download)),_app.default.info("[SHARE BACKEND] ".concat(e,":").concat(r).concat(be_share_rewrite)))})}data_url&&(_app.default.info("[BACKEND] downloading data from ".concat(data_url)),(0,_download.default)(data_url).then(function(t){_app.default.write(t,"#sub-store"),_app.default.cache=JSON.parse(t),_app.default.persistCache(),(0,_migration.default)(),_app.default.info("[BACKEND] restored data from ".concat(data_url))}).catch(function(t){throw _app.default.error("[BACKEND] restore data failed"),t}))}}}).call(this)}).call(this,"/src/restful");var _$main_115={},___migration_115=___interopRequireDefault_115(_$migration_143),_restful=___interopRequireDefault_115(_$restful_121);function ___interopRequireDefault_115(t){return t&&t.__esModule?t:{default:t}}(0,___migration_115.default)(),(0,_restful.default)()})();
